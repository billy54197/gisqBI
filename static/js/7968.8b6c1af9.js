"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[7968],{56279:function(k,S,g){g.d(S,{P:function(){return w}});var v=g(86892),b=g(49500);const w={mixins:[v.D],created(){},methods:{lifecycleBeforeChartsLoad(x){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&b.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),b.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let C=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[x]);if(C)return C}return x},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&b.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),b.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},15909:function(k,S){var g=Symbol();function v(a,r){a[g]||(a[g]=r,Object.defineProperty(a,"parentNode",{get:function(){return this[g]||this.parentElement}}))}var b=function(a,r){var c=a.splice(0);r.append.apply(r,c),c.forEach(function(u){u[g]=void 0})};function w(a,r){var c,u=this,y=a.frag||[a];if(this.frag){var m,p=this.frag.indexOf(r);p>-1&&(m=this.frag).splice.apply(m,[p,0].concat(y))}if(this[I]){var T=this[I].get(r);T&&(r=T[0])}r?(c=r).before.apply(c,y):this.append.apply(this,y),y.forEach(function(E){return v(E,u)})}function x(a){if(this.frag){var r=this.frag.indexOf(a);if(r>-1){var c,u=[r,1];if(this.frag.length===1){var y=this[N];this.frag[0].before(y),u.push(y)}(c=this.frag).splice.apply(c,u)}}var m=this[I];if(m){var p=m.get(a);if(p)return b(p,a),m.delete(a),void(a[g]=void 0)}a.remove()}var I=Symbol(),C={insertBefore:w,removeChild:x},N=Symbol(),B={insertBefore:w,before:function(a){this.frag[0].before(a)},remove:function(){var a=this[N],r=this.frag,c=r.splice(0,r.length,a);c[0].before(this[N]),c.forEach(function(u){return u.remove()})},removeChild:x,appendChild:function(a){var r=this.frag.length;this.frag[r-1].after(a);var c=this[N];this.frag[0]===c&&(this.frag.splice(0,1),c.remove()),v(a,this),this.frag.push(a)}},$={inserted:function(a){var r=Array.from(a.childNodes),c=a.parentNode,u=document.createComment("");a[N]=u,r.length===0&&r.push(u);var y=document.createDocumentFragment();y.append.apply(y,r),a.replaceWith(y),a.frag=r,function(m,p,T){m[I]||(m[I]=new Map,Object.assign(m,C)),m[I].set(p,T)}(c,a,r),v(a,c),r.forEach(function(m){return v(m,a)}),Object.defineProperty(a,"innerHTML",{set:function(m){var p=document.createElement("div");p.innerHTML=m;var T=a.frag.length;Array.from(p.childNodes).forEach(function(E){return a.appendChild(E)}),p.append.apply(p,a.frag.splice(0,T))},get:function(){return""}}),Object.assign(a,B)},unbind:function(a){b(a.frag,a),a[N].remove()}};S.Z=$},44513:function(k,S,g){g.d(S,{Z:function(){return B}});var v=function(){var a=this,r=a._self._c;return a.attr.buttonHide?r("div",{style:{position:"absolute",right:a.attr.buttonHideRight+"px",top:a.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(c){return a.onHide()}}},[a.openTooltip?r("el-tooltip",{attrs:{"open-delay":1e3,content:a.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[r("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):a._e()},b=[],w=g(52246),x={props:["attr"],name:"hide-button",data(){return{isPc:w.b}},computed:{openTooltip:function(){let $=!1,a=this.attr.buttonHideTooltipContent;return w.b&&a&&a!=null&&a.trim()!=""&&($=!0),$}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},I=x,C=g(68141),N=(0,C.Z)(I,v,b,!1,null,"bf399b9a",null),B=N.exports},87968:function(k,S,g){g.r(S),g.d(S,{default:function(){return z}});var v=function(){var t=this,i=t._self._c;return i("div",{class:[t.widgetInfo.config.global.closeScroll||t.widgetInfo.config.global.mode!="vertical"?"hideScroll":""],style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px",overflow:"auto"}},[i("hide-button",{attrs:{attr:t.widgetInfo.attr}}),i("div",[i("el-menu",{ref:"platformMenu",staticClass:"platform_menu",style:t.setStyle(t.widgetInfo.config),attrs:{mode:t.widgetInfo.config.global.mode,collapse:t.widgetInfo.config.global.collapse,"unique-opened":t.widgetInfo.config.global.uniqueOpened,"menu-trigger":t.widgetInfo.config.global.menuTrigger,collapseTransition:t.widgetInfo.config.global.collapseTransition,"text-color":t.widgetInfo.config.global.textColor,"active-text-color":t.widgetInfo.config.active.activeTextColor},on:{select:t.selectMenu}},[i("platform-menu-item",{ref:"platformMenuItem",attrs:{platformMenus:t.treeSelectData,widgetInfo:t.widgetInfo}})],1)],1)],1)},b=[],w=g(21300),x=g(87580),I=g(42160),C=g(27966),N=function(){var t=this,i=t._self._c;return t.platformMenus&&t.platformMenus.length>0?i("div",{directives:[{name:"frag",rawName:"v-frag"}]},[t._l(t.platformMenus,function(o){return[o.children?i("el-submenu",{key:"key"+o.id,style:t.heightStyleMenu(t.widgetInfo),attrs:{data:o,index:o.id,disabled:t.toBoolean(o.disabled),"popper-append-to-body":!0}},[i("template",{slot:"title"},[o.icon&&o.icon.indexOf("el-icon")>-1?i("i",{class:o.icon}):o.icon&&o.icon.indexOf("iconfont")>-1&&o.icon.length>9?i("i",[i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#"+o.icon.substring(9,o.icon.length)}})])]):o.icon?i("img",{staticClass:"icon-svg",staticStyle:{width:"24px",height:"18px"},attrs:{src:t.getImageUrl(o.icon),alt:""}}):t._e(),i("span",{style:t.setStyle(t.widgetInfo.config),attrs:{slot:"title"},slot:"title"},[t._v(t._s(o.name))])]),i("PlatformMenuItem",{attrs:{platformMenus:o.children,widgetInfo:t.widgetInfo}})],2):i("el-menu-item",{key:o.id,style:t.heightStyle(t.widgetInfo),attrs:{data:o,index:o.id,disabled:t.toBoolean(o.disabled)},nativeOn:{mouseenter:function(n){return t.nav_hover(n)},mouseleave:function(n){return t.nav_leave(n)},click:function(n){return t.nav_click(n)}}},[o.icon&&o.icon.indexOf("el-icon")>-1?i("i",{class:o.icon}):o.icon&&o.icon.indexOf("iconfont")>-1&&o.icon.length>9?i("i",[i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#"+o.icon.substring(9,o.icon.length)}})])]):o.icon?i("img",{staticClass:"icon-svg",staticStyle:{width:"24px",height:"18px"},attrs:{src:t.getImageUrl(o.icon),alt:""}}):t._e(),i("span",{style:t.setStyle(t.widgetInfo.config),attrs:{slot:"title"},slot:"title"},[t._v(t._s(o.name))])])]})],2):t._e()},B=[],$=g(15909),a=g(26711),r={name:"PlatformMenuItem",props:["platformMenus","widgetInfo"],mixins:[a.H],directives:{frag:$.Z},watch:{platformMenus:function(){this.$forceUpdate()}},data(){return{}},methods:{getImageUrl(e){return e&&e!=""?e:null},setStyle(e){return{border:"none",paddingLeft:e.global.paddingLeft+"px",fontFamily:e.fontStyle.fontFamily,fontWeight:e.fontStyle.fontWeight,fontStyle:e.fontStyle.fontStyle,fontSize:e.fontStyle.fontSize+"px",textDecoration:e.fontStyle.textDecoration,textAlign:e.global.textAlign,backgroundSize:e.global.backgroundSize}},nav_hover(e){if(e.target.style.color=this.widgetInfo.config.hover.hoverTextColor,e.target.style.backgroundColor=this.widgetInfo.config.hover.backgroundColor||"none",e.target.getElementsByTagName("i")&&e.target.getElementsByTagName("i").length>0)e.target.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.hover.hoverTextIconColor;else if(e.target.getElementsByTagName("img")&&e.target.getElementsByTagName("img").length>0){let t=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;e.target.style.overflow="hidden",e.target.getElementsByTagName("img")[0].style.transform="translate(-"+t+"px)",e.target.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.hover.hoverTextIconColor+" "+t+"px 0)"}},colorHex(e){var t=e,i=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgba|RGBA)/.test(t)){var o=t.replace(/(?:\(|\)|rgba|RGBA)*/g,"").split(","),n="#";for(let d=0;d<3;d++){var l=Number(o[d]).toString(16);l.length<2&&(l="0"+l),n+=l}return n.length!==7&&(n=t),n}else if(i.test(t)){var s=t.replace(/#/,"").split("");if(s.length===6)return t;if(s.length===3){var f="#";for(let d=0;d<s.length;d+=1)f+=s[d]+s[d];return f}}return t},nav_click(e){let t=e.target.parentElement;if(t.className.indexOf("is-active")>-1){if(t.getElementsByTagName("i")&&t.getElementsByTagName("i").length>0)t.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.active.activeTextIconColor;else if(t.getElementsByTagName("img")&&t.getElementsByTagName("img").length>0){let i=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;t.style.overflow="hidden",t.getElementsByTagName("img")[0].style.transform="translate(-"+i+"px)",t.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.active.activeTextIconColor+" "+i+"px 0)"}}},nav_leave(e){if(e.target.className.indexOf("is-active")>-1){if(e.target.style.color=this.widgetInfo.config.active.activeTextColor,e.target.getElementsByTagName("i")&&e.target.getElementsByTagName("i").length>0)e.target.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.active.activeTextIconColor;else if(e.target.getElementsByTagName("img")&&e.target.getElementsByTagName("img").length>0){let t=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;e.target.style.overflow="hidden",e.target.getElementsByTagName("img")[0].style.transform="translate(-"+t+"px)",e.target.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.active.activeTextIconColor+" "+t+"px 0)"}}else if(e.target.style.backgroundColor=this.widgetInfo.config.global.backgroundColor||"none",e.target.style.color=this.widgetInfo.config.global.textColor,e.target.getElementsByTagName("i")&&e.target.getElementsByTagName("i").length>0)e.target.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.global.textIconColor;else if(e.target.getElementsByTagName("img")&&e.target.getElementsByTagName("img").length>0){let t=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;e.target.style.overflow="hidden",e.target.getElementsByTagName("img")[0].style.transform="translate(-"+t+"px)",e.target.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+t+"px 0)"}},heightStyle(e){let t=e.attr.hh;if(e.config.global.mode==="horizontal"){let i={height:t+"px",lineHeight:t+"px"};return e.config.global.widthType==="fixedWidth"?e.config.global.width&&(i.width=e.config.global.width+"px"):e.config.global.itemPadding&&(i.paddingLeft=e.config.global.itemPadding+"px",i.paddingRight=e.config.global.itemPadding+"px"),i}else return t=e.config.global.height,{height:t+"px",lineHeight:t+"px"}},heightStyleMenu(e){if(e.config.global.mode==="horizontal")return this.heightStyle(e);{let t=e.config.global.height;return{minHeight:t+"px",lineHeight:t+"px"}}},toBoolean(e){return w.stringToBoolean(e)}}},c=r,u=g(68141),y=(0,u.Z)(c,N,B,!1,null,null,null),m=y.exports,p=g(44513),T=g(45061),E=g(55616),M=g(48836),P=g(35051),A=g(56279),D=g(67157);const L={mixins:[D.c],data(){return{config_extend:{config:{global:{backgroundColor:"#4C84FF",textColor:"#ffffff"},activeParent:{activeTextIconColor:"#ffffff"},childConfig:{backgroundColor:"#4C84FF"}}},filter_config:{global:{backgroundColor:"#4C84FF",textColor:"#ffffff",textIconColor:"#ffffff"},activeParent:{activeTextColor:"#ffffff",backgroundColor:"#070D2A",activeTextIconColor:"#ffffff"},active:{activeTextColor:"#ffffff",backgroundColor:"#070D2A",activeTextIconColor:"#ffffff"},hover:{hoverTextColor:"#ffffff",backgroundColor:"#070D2A",hoverTextIconColor:"#ffffff"},fontStyle:{fontFamily:"alibabaPuHuiTiRegular"},childConfig:{backgroundColor:"#4C84FF"}}}},methods:{filterPredefineColoursSchemeConfig(e,t){this.getNewConfigWithArrary(e,t,this.filter_config)}}};var _=g(49500),F={name:"platform-menu",props:["widgetInfo"],mixins:[T.u,a.H,x.u,L,A.P],components:{PlatformMenuItem:m,HideButton:p.Z},computed:{...(0,M.Se)(["getCanvasSetting","getURLParams","getApplicationId"])},data(){return{lastActiveMenu:null,treeSelectData:[]}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{initMenuMore(){this.treeSelectData.length!==0&&this.widgetInfo.config.global.menuDropdown&&(this.treeSelectData.push({icon:"el-icon iconfont bi_more2",id:this.treeSelectData[this.treeSelectData.length-1].id+1,name:""}),this.$nextTick(()=>{let e=this.$refs.platformMenuItem.$children[this.$refs.platformMenuItem.$children.length-1].$el.offsetWidth+20,t=0,i=-1;for(let n=0;n<this.$refs.platformMenuItem.$children.length;n++)if(t+=Math.ceil(this.$refs.platformMenuItem.$children[n].$el.offsetWidth),parseInt(t+e)>this.widgetInfo.attr.w){i=n;break}if(i==-1||i>=this.treeSelectData.length){this.treeSelectData.pop();return}let o=this.treeSelectData.slice(i,this.treeSelectData.length-1);this.treeSelectData.splice(i,this.treeSelectData.length-i-1),this.treeSelectData[this.treeSelectData.length-1].children=o,this.$nextTick(()=>{this.$refs.platformMenuItem.$children[this.treeSelectData.length-1].$el.style.float="right",this.$refs.platformMenuItem.$children[this.treeSelectData.length-1].$el.childNodes[0].childNodes[0].style.color=this.widgetInfo.config.global.textIconColor,this.$refs.platformMenuItem.$children[this.treeSelectData.length-1].$el.childNodes[0].childNodes[2].style.display="none";for(let n in this.$refs.platformMenu.items)this.setInactiveStyle(n)})}))},createImage(e){let t=document.createElement("canvas");t.height=5,t.width=5;var i=t.getContext("2d");return i.fillStyle=e,i.fillRect(0,0,5,5),t.toDataURL("image/png",.5)},openSubMenu(e){for(let t in this.$refs.platformMenu.submenus)if(e==="all"||e==="first"){if(this.$refs.platformMenu.open(t),e==="first")break}else this.$refs.platformMenu.close(t)},autoActive(e){if(this.$refs.platformMenu.items)if(e==="first")for(let t in this.$refs.platformMenu.items){this.$refs.platformMenu.activeIndex=t,this.selectMenu(t);break}else if(e==="fixed")this.$refs.platformMenu.activeIndex=this.widgetInfo.config.global.fixed_value,this.selectMenu(this.widgetInfo.config.global.fixed_value);else if(e==="global"){let t=this.getGlobalParamsValue(this.widgetInfo.config.global.global_param);this.$refs.platformMenu.activeIndex=t,this.selectMenu(t)}else for(let t in this.$refs.platformMenu.items)this.setInactiveStyle(t)},colorHex(e){var t=e,i=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgba|RGBA)/.test(t)){for(var o=t.replace(/(?:\(|\)|rgba|RGBA)*/g,"").split(","),n="#",l=0;l<3;l++){var s=Number(o[l]).toString(16);s.length<2&&(s="0"+s),n+=s}return n.length!==7&&(n=t),n}else if(i.test(t)){var f=t.replace(/#/,"").split("");if(f.length===6)return t;if(f.length===3){for(var d="#",h=0;h<f.length;h+=1)d+=f[h]+f[h];return d}}return t},setParentInactiveStyle(e,t){let i=t.$el;if(this.widgetInfo.config.global.textIconColor)if(e.getElementsByTagName("img")&&e.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;i.style.overflow="hidden",i.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",i.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+o+"px 0)"}else if(i.getElementsByTagName("img")&&i.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;i.style.overflow="hidden",i.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",i.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+o+"px 0)"}else e.getElementsByTagName("i")&&e.getElementsByTagName("i").length>0&&(i.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.global.textIconColor);i&&i.querySelector(".el-submenu__title")&&(i.querySelector(".el-submenu__title").style.color=this.widgetInfo.config.global.textColor),this.widgetInfo.config.global.backgroundImage!=""?i.attributes.role.value!="menubar"&&(i.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.global.backgroundImage),i.style.backgroundSize=this.widgetInfo.config.global.backgroundSize):i.attributes.role.value!="menubar"&&(i.style.backgroundColor=this.widgetInfo.config.global.backgroundColor,i.style.backgroundImage=""),t.parentMenu&&t.parentMenu.$el&&t.parentMenu.$el.nodeName=="LI"&&this.setParentInactiveStyle(e,t.parentMenu)},setInactiveStyle(e){let t=this.$refs.platformMenu.items[e],i=t.$el;if(t.parentMenu.$el.nodeName=="LI"&&this.setParentInactiveStyle(i,t.parentMenu),this.widgetInfo.config.global.textIconColor)if(i.getElementsByTagName("img")&&i.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;i.style.overflow="hidden",i.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",i.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+o+"px 0)"}else i.getElementsByTagName("i")&&i.getElementsByTagName("i").length>0&&(i.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.global.textIconColor);this.widgetInfo.config.global.backgroundImage!=""?(i.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.global.backgroundImage),i.style.backgroundSize=this.widgetInfo.config.global.backgroundSize):i.style.backgroundColor=this.widgetInfo.config.global.backgroundColor},setMenuPopup(){if(this.widgetInfo.config.childConfig.disabled&&this.widgetInfo.config.childConfig){let e=this.widgetInfo.config.childConfig.totalWidth,t=this.widgetInfo.config.childConfig.totalHeight,i=this.widgetInfo.config.childConfig.columnWidth,o=this.widgetInfo.config.childConfig.rowHeight,n=this.widgetInfo.config.childConfig.backgroundColor,l=document.querySelectorAll(".el-menu--popup");for(let s=0;s<l.length;s++){l[s].style.overflowY="auto",e>0&&(l[s].style.width=e+"px",l[s].style.minWidth="auto"),t>0&&this.widgetInfo.config.childConfig.mode=="multi"&&(l[s].style.height=t+"px"),n&&(l[s].style.backgroundColor=n);let f=l[s].querySelectorAll(".el-submenu");for(let h=0;h<f.length;h++)this.widgetInfo.config.childConfig.mode=="multi"&&(f[h].style.float="left",f[h].style.display="block"),i>0&&(f[h].style.width=i+"px"),o>0&&(f[h].style.height=o+"px");let d=l[s].querySelectorAll(".el-menu-item");for(let h=0;h<d.length;h++)this.widgetInfo.config.childConfig.mode=="multi"&&(d[h].style.float="left",d[h].style.display="block"),i>0&&(d[h].style.width=i+"px"),o>0&&(d[h].style.height=o+"px")}}},selectMenu(e){for(let l in this.$refs.platformMenu.items)this.setInactiveStyle(l);let t=this.$refs.platformMenu.items[e],i=this;if(this.lastActiveMenu){let l=[this.$refs.platformMenu.items[this.lastActiveMenu]];l&&l[0]&&l[0].parentMenu&&l[0].parentMenu!=t.parentMenu&&l[0].parentMenu.$el.className.indexOf("el-submenu")>-1&&l.push(l[0].parentMenu),l.forEach(s=>{if(s&&s.$el){if(s.$el.className.indexOf("el-submenu")>-1)return;s.$el.style.backgroundColor=i.widgetInfo.config.global.backgroundColor,s.$el.style.backgroundImage=i.getImageUrl(i.widgetInfo.config.global.backgroundImage),s.$el.style.backgroundSize=i.widgetInfo.config.global.backgroundSize,s.$el.style.color=i.widgetInfo.config.global.textColor,i.widgetInfo.config.active.borderWidth-0>=0&&(i.widgetInfo.config.global.mode=="vertical"?(s.$el.style.borderRightColor="",s.$el.style.borderRightWidth="",s.$el.style.borderRightStyle=""):(s.$el.style.borderBottomColor="",s.$el.style.borderBottomWidth="",s.$el.style.borderBottomStyle=""))}})}if(this.lastActiveMenu=e,t){let l=t.$el;if(this.widgetInfo.config.active.backgroundImage?(l.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.active.backgroundImage),l.style.backgroundSize=this.widgetInfo.config.active.backgroundSize):this.widgetInfo.config.active.backgroundColor&&(l.style.backgroundImage=this.getImageUrl(this.createImage(this.widgetInfo.config.active.backgroundColor)),l.style.backgroundSize="cover"),this.widgetInfo.config.active.borderWidth-0>=0&&(this.widgetInfo.config.global.mode=="vertical"?(l.style.borderRightColor=this.widgetInfo.config.active.activeTextColor,l.style.borderRightWidth=`${this.widgetInfo.config.active.borderWidth}px`,l.style.borderRightStyle="solid"):(l.style.borderBottomColor=this.widgetInfo.config.active.activeTextColor,l.style.borderBottomWidth=`${this.widgetInfo.config.active.borderWidth}px`,l.style.borderBottomStyle="solid")),this.widgetInfo.config.active.activeTextIconColor){if(l.getElementsByTagName("i")&&l.getElementsByTagName("i").length>0)l.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.active.activeTextIconColor;else if(l.getElementsByTagName("img")&&l.getElementsByTagName("img").length>0){let s=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;l.style.overflow="hidden",l.getElementsByTagName("img")[0].style.transform="translate(-"+s+"px)",l.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.active.activeTextIconColor+" "+s+"px 0)"}}}this.$nextTick(()=>{this.setActiveParentStyle(t)});let o=this,n=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(n,l=>{if(l.enabled&&l.code==o.$$global_editor.actionType.click.code){let s=l.code+"_"+o.widgetInfo.id,f={value:e};if(l.paramsExtend&&l.paramsExtend.length>0&&o.getExtendParams(f,l.paramsExtend,o.getSelectSource(e),o.widgetInfo.dataset[o.widgetInfo.dataset.type].dimensions),l.script&&l.script.enabled){if(_.log("Execute script for "+l.name+" component to "+l.script.title+" component"),l.script.content==""){E.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param",l.script.content);let d=this.customScript_actionSend_clickParam(f);d&&(f=d)}C.Z.$emit(s,f),o.actionNameList.push(s),l.postMessage&&this.doPostMessage(f)}}),this.$nextTick(function(){this.setMenuPopup()})},setActiveParentStyle(e){if(e&&e.parentMenu&&e.parentMenu.$el.className.indexOf("el-submenu")>-1){let t=e.parentMenu.$el,i=t.getElementsByTagName("div")[0];if(this.widgetInfo.config.activeParent.backgroundImage?(t.style.backgroundColor="",t.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.activeParent.backgroundImage),t.style.backgroundSize=this.widgetInfo.config.activeParent.backgroundSize):this.widgetInfo.config.activeParent.backgroundColor&&(t.style.backgroundColor="",t.style.backgroundImage=this.getImageUrl(this.createImage(this.widgetInfo.config.activeParent.backgroundColor)),t.style.backgroundSize="cover"),this.widgetInfo.config.activeParent.borderWidth-0>=0&&(this.widgetInfo.config.global.mode=="vertical"?i.style.borderRightWidth=this.widgetInfo.config.activeParent.borderWidth+"px":i.style.borderBottomWidth=this.widgetInfo.config.activeParent.borderWidth+"px"),this.widgetInfo.config.activeParent.activeTextColor){let o=this.widgetInfo.config.activeParent.activeTextColor;i.style.color=o,this.widgetInfo.config.global.mode=="vertical"?i.style.borderRightColor=o:i.style.borderBottomColor=o;let n=this.widgetInfo.config.global.mode;setTimeout(function(){n=="vertical"?i.style.borderRightColor=o:i.style.borderBottomColor=o},100)}if(this.widgetInfo.config.activeParent.activeTextIconColor){if(t.getElementsByTagName("i")&&t.getElementsByTagName("i")[0].className.indexOf("el-submenu__icon-arrow")==-1)t.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.activeParent.activeTextIconColor;else if(t.getElementsByTagName("img")&&t.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;t.style.overflow="hidden",t.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",t.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.activeParent.activeTextIconColor+" "+o+"px 0)"}}}e.parentMenu.parentMenu&&e.parentMenu.parentMenu.$el.className.indexOf("el-submenu")>-1&&this.setActiveParentStyle(e.parentMenu)},getSelectSource(e){let t,i=this.widgetInfo.dataset[this.widgetInfo.dataset.type].dimensions;for(let n=0;n<i.length;n++)i[n]==this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode.id&&(t=i[n]);let o=this.$$lib__.find(this.widgetInfo.dataset[this.widgetInfo.dataset.type].source,n=>n[t]==e);return o||null},sortSelectData(e){if(e){let t=[],i=[];for(let o=0;o<e.length;o++)e[o].children&&e[o].children.length>0?(e[o].children=this.sortSelectData(e[o].children),t.push(e[o])):i.push(e[o]);if(t.length>0||i.length>0){e=[];for(let o in t)e.push(t[o]);for(let o in i)e.push(i[o])}}return e},loadMenuData(e){e.dataset.newType=="first"?this.loadFirstMenuData(e):this.loadAllMenuData(e)},loadFirstMenuData(e){let t=this.getApplicationId,i={subGuid:t},o="/identity/base/funcmgr/funcgroups-all",n;(0,P.platformPostRequest)(o,i).then(l=>{for(let f=0;f<l.data.length;f++)if(!l.data[f].parentFuncgroupId){n=l.data[f].id;break}let s={parentFuncgroupId:n,subGuid:t};o="/identity/base/funcmgr/getAppFuncGroupAndItem",(0,P.platformPostRequest)(o,s).then(f=>{if(e.dataset[e.dataset.type].encode.firstPid=n,f.data.length>0)for(let d=f.data.length-1;d>=0;d--)n!=f.data[d].parentFuncgroupId&&f.data.splice(d,1);e.dataset[e.dataset.type].source=f.data,this.setInfo(e)})})},loadAllMenuData(e){let i={subGuid:this.getApplicationId},o="/identity/base/funcmgr/getAppFuncGroupAndItem";(0,P.platformPostRequest)(o,i).then(n=>{e.dataset[e.dataset.type].source=n.data,this.setInfo(e)})},loadInfo(e){this.loadMenuData(e),this.lifecycleAfterLoad()},setInfo(e){this.treeSelectData=this.getTreeData(e.dataset[e.dataset.type].encode,e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].source),this.setIconPosition(e),this.$nextTick(function(){this.widgetInfo.config.global.mode=="vertical"&&this.openSubMenu(this.widgetInfo.config.global.expand),this.autoActive(this.widgetInfo.config.global.autoActive),this.setMenuPopup()}),this.initMenuMore()},reLoadInfo(e){_.log("menu reLoadInfo"),this.loadInfo(e)},setStyle(e){return{border:"none",paddingLeft:e.global.paddingLeft+"px",fontFamily:e.fontStyle.fontFamily,fontWeight:e.fontStyle.fontWeight,fontStyle:e.fontStyle.fontStyle,fontSize:e.fontStyle.fontSize+"px",textDecoration:e.fontStyle.textDecoration,textAlign:e.global.textAlign,backgroundSize:e.global.backgroundSize}},setIconPosition(e){this.$nextTick(()=>{let t=this.$refs.platformMenu.$el.children;if(e.config.global.iconPosition=="top")for(let i=0;i<t.length;i++)e.config.global.mode=="horizontal"&&t[i]&&t[i].style&&(t[i].style.height=e.attr.hh+"px",t[i].style.lineHeight=e.attr.hh+"px"),t[i].className.indexOf("el-menu-item")>-1?t[i].childNodes[0].nodeName=="I"?(t[i].childNodes[0].style.position="absolute",t[i].childNodes[0].style.left=(t[i].offsetWidth-t[i].childNodes[0].offsetWidth)/2+"px",t[i].childNodes[0].style.top="5px"):t[i].childNodes[0].nodeName=="IMG"&&(t[i].childNodes[0].style.position="absolute",t[i].childNodes[0].style.left=(t[i].offsetWidth-parseInt(t[i].childNodes[0].style.width))/2+"px",t[i].childNodes[0].style.top="5px"):t[i].className.indexOf("el-submenu")>-1&&(t[i].childNodes[0].className=="el-submenu__title"&&t[i].childNodes[0].childNodes[0].nodeName=="I"?(t[i].childNodes[0].childNodes[0].style.position="absolute",t[i].childNodes[0].childNodes[0].style.left=(t[i].childNodes[0].offsetWidth-t[i].childNodes[0].childNodes[0].offsetWidth)/2+"px",t[i].childNodes[0].childNodes[0].style.top="5px"):t[i].childNodes[0].childNodes[0].nodeName=="IMG"&&(t[i].childNodes[0].childNodes[0].style.position="absolute",t[i].childNodes[0].childNodes[0].style.left=(t[i].childNodes[0].offsetWidth-parseInt(t[i].childNodes[0].childNodes[0].style.width))/2+"px",t[i].childNodes[0].childNodes[0].style.top="5px")),e.config.global.mode=="vertical"&&(t[i].style.minHeight="80px");else for(let i=0;i<t.length;i++)e.config.global.mode=="horizontal"&&t[i]&&t[i].style&&(t[i].style.height=e.attr.hh+"px",t[i].style.lineHeight=e.attr.hh+"px"),t[i].className.indexOf("el-menu-item")>-1?(t[i].childNodes[0].nodeName=="I"||t[i].childNodes[0].nodeName=="IMG")&&(t[i].childNodes[0].style.position="static"):t[i].className.indexOf("el-submenu")>-1&&(t[i].childNodes[0].className=="el-submenu__title"&&t[i].childNodes[0].childNodes[0].nodeName=="I"||t[i].childNodes[0].childNodes[0].nodeName=="IMG")&&(t[i].childNodes[0].childNodes[0].style.position="static"),e.config.global.mode=="vertical"&&(t[i].style.minHeight="40px")})},initAction(e){let t=e.action.receive.replaceFirstPid;t&&t.enabled&&t.replaceList&&t.replaceList.length>0&&this.doReplaceFirstPid(t.replaceList),this.actionReceive(e)},doReplaceFirstPid(e){let t=this;this.$$lib__.each(e,i=>{let o=i[0][1]+"_"+i[0][0];i[0][1].indexOf("_")>-1&&(o=i[0][1]),C.Z.$on(o,n=>{let l=i[0][2],s=l.indexOf("|");s>-1&&(l=i[0][2].substring(s+1)),t.widgetInfo.dataset[t.widgetInfo.dataset.type].encode.firstPid=n[l],t.reLoadInfo(t.widgetInfo)})})},getTreeData(e,t,i){let o=[];if(e.id&&e.pid&&e.name){let n=this.listToObj(t,i);if(n.length==0)return o;o=this.handleDataTree(n,e)}return this.getHideList(o)},getHideList(e){let t=JSON.parse(JSON.stringify(e));for(let i=e.length-1;i>=0;i--)e[i].hide&&(e[i].hide=="true"||e[i].hide>=1)?t.splice(i,1):e[i].children&&e[i].children.length>0&&(t[i].children=this.getHideList(e[i].children));return t},listToObj(e,t){let i=[];for(let o=0;o<t.length;o++){let n={};for(let l=0;l<e.length;l++)I.default.set(n,e[l],t[o][e[l]]);i.push(JSON.parse(JSON.stringify(n)))}return i},handleDataTree(e,t){let i={},o=[];if(!t.firstPid){let n=e[0][t.pid],l=n;this.$$lib__.each(e,s=>{s[t.pid]!=n&&(l=s[t.pid])}),l==n&&(t.firstPid=n)}return this.$$lib__.each(e,n=>{let l={};l.id=n[t.id],l.name=n[t.name],l.icon=n[t.icon],l.disabled=n[t.disabled],l.hide=n[t.hide],l.sort=n[t.sort],n[t.pid]!=null&&n[t.pid]!=""&&n[t.pid]!=t.firstPid?(i[n[t.pid]]||(i[n[t.pid]]=[]),i[n[t.pid]].push(l)):o.push(l)}),this.transferFl(o,i,t.id,t),JSON.parse(JSON.stringify(o))},transferFl(e,t,i,o){o.sort&&e.sort(this.compare("sort")),this.$$lib__.each(e,n=>{let l=t[n[i]];l&&(n.children=l,this.transferFl(l,t,i,o))})},compare(e){return function(t,i){let o=t[e],n=i[e];return!isNaN(Number(o))&&!isNaN(Number(n))&&(o=Number(o),n=Number(n)),o<n?-1:o>n?1:0}},getImageUrl(e){return e&&e!=""?e.indexOf("data:")==0?`url(${e})`:"url("+w.appendImageBaseURL(e)+")":""},getGlobalParamsValue(e){if(this.getCanvasSetting==null||this.getCanvasSetting.data==null||this.getCanvasSetting.data.globalParams==null||this.getCanvasSetting.data.globalParams.paramsValue==null||this.getCanvasSetting.data.globalParams.paramsValue.length<1)return"";let t=this.$$lib__.find(this.getCanvasSetting.data.globalParams.paramsValue,o=>o.paramName==e);if(!t)return this.getCanvasSetting.data.globalParams.params[e];let i=this.getURLParams[t.urlParams];return i||(i=this.getCanvasSetting.data.globalParams.params[e]),i}}},O=F,W=(0,u.Z)(O,v,b,!1,null,"0bf11d14",null),z=W.exports}}]);
