"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[75630],{56279:function(O,m,a){a.d(m,{P:function(){return c}});var f=a(386892),h=a(149500);const c={mixins:[f.D],created(){},methods:{lifecycleBeforeChartsLoad(u){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&h.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),h.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let y=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[u]);if(y)return y}return u},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&h.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),h.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(O,m,a){a.d(m,{X:function(){return f},b:function(){return h}});let f={versions:function(){var c=navigator.userAgent;return{trident:c.indexOf("Trident")>-1,presto:c.indexOf("Presto")>-1,webKit:c.indexOf("AppleWebKit")>-1,gecko:c.indexOf("Gecko")>-1&&c.indexOf("KHTML")==-1,mobile:!!c.match(/AppleWebKit.*Mobile.*/),ios:!!c.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:c.indexOf("Android")>-1,iPhone:c.indexOf("iPhone")>-1,iPad:c.indexOf("iPad")>-1,webApp:c.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},h;f.versions.mobile||f.versions.ios||f.versions.android||f.versions.iPhone||f.versions.iPad?h=!1:h=!0},675630:function(O,m,a){a.r(m),a.d(m,{default:function(){return K}});var f=function(){var o=this,n=o._self._c;return n("div",{style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}},[n("hide-button",{attrs:{attr:o.widgetInfo.attr}}),n("div",{ref:"scatterCartesian",style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}})],1)},h=[],c=a(844513),u=a(927966),L=a(778323),y=a(723400),E=a(56279),N=a(445061),S=a(126711),l=a(99349),b=a(555616),P=a(275770),F=a(67157),I=a(150813);const R={mixins:[F.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(I.Z.charts.title)),legend:JSON.parse(JSON.stringify(I.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(I.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(I.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(I.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(I.Z.charts.yAxis)),series:[{label:{color:"#4B7EFE"},markLine:{lineStyle:{color:"#5FB2FF"}},itemStyle:{colorInfo:{type:"pureColor",pureColor:"rgba(76, 132, 255, 0.2)",gradation:{}},opacity:1,borderColor:"rgba(76, 132, 255, 0.5)"}}]}}},methods:{filterPredefineColoursSchemeConfig(i,o){this.getNewConfigWithArrary(i,o,this.filter_config)}}};var $=a(149500);const Z=a(954255);var D={name:"ScatterCartesian",components:{HideButton:c.Z},mixins:[L.baseConfig,l.P,y.j,E.P,N.u,S.H,R],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null,seriesAttr:{x:"",y:[],label:[],size:[]}}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=Z.init(this.$refs.scatterCartesian,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(i){let o=[],n=[],s=[],r=[];i.dataset[i.dataset.type]&&(n=i.dataset[i.dataset.type].source,s=i.dataset[i.dataset.type].dimensions,r=i.dataset[i.dataset.type].dimensionsAlias,o=i.dataset[i.dataset.type].encode);let t=JSON.parse(JSON.stringify(i.config.series));this.dimensionsEx=s,this.dimensionsAliasEx=r,this.seriesAttr.x=o.x;let p=this.getTitle(i.config.title),g=this.getLegend(i.config.legend),d=this.getGrid(i.config.grid),k=this.getTooltip(i.config.tooltip),G=JSON.parse(JSON.stringify(i.config.toolbox)),w=this.getxAxis(i.config.xAxis),C=this.getyAxis(i.config.yAxis);w.axisTick.lineStyle.color=this.getColorInfo(w.axisTick.lineStyle.colorInfo),C.axisTick.lineStyle.color=this.getColorInfo(C.axisTick.lineStyle.colorInfo),w.axisLine.lineStyle.color=this.getColorInfo(w.axisLine.lineStyle.colorInfo),C.axisLine.lineStyle.color=this.getColorInfo(C.axisLine.lineStyle.colorInfo);for(let e=0;e<t.length;e++){if(this.seriesAttr.y.push(t[e].encodeEx.y),this.seriesAttr.label.push(t[e].encodeEx.name),this.seriesAttr.size.push(t[e].encodeEx.value),t[e].dimensions=s,t[e].encode={x:o.x,y:t[e].encodeEx.y},t[e].symbolURL&&t[e].symbolURL!=""&&(t[e].symbol=this.getSymbolURL(t[e].symbolURL)),t[e].itemStyle&&t[e].itemStyle.colorInfo&&(t[e].itemStyle.color=this.getColorInfo(t[e].itemStyle.colorInfo)),t[e].encodeEx.value&&t[e].encodeEx.value!=""){let v=[],M=0,H=0;t[e].isShowMax&&t[e].isShowMin?(t[e].max=60,t[e].min=20):!t[e].isShowMax&&t[e].isShowMin?(t[e].min=20,Number(t[e].max)<=Number(t[e].min)&&(t[e].max=Number(t[e].min)+1)):t[e].isShowMax&&!t[e].isShowMin&&(t[e].max=60,Number(t[e].max)<=Number(t[e].min)&&(t[e].min=Number(t[e].max)-1));let X=t[e].max,J=t[e].min,T=this.getFieldIndex(s,t[e].encodeEx.value);for(let x=0;x<n.length;x++)n[x][T]>0&&v.push(n[x][T]);v.sort(function(x,A){return x-A}),v.length>0&&(M=v[v.length-1],H=v[0]),t[e].symbolSize=x=>{let A=this.getFieldIndex(s,t[e].encodeEx.value);return x[A]==0?0:Number((X-J)*(x[A]-H)/(M-H))+Number(J)}}t[e].encodeEx.name!=""&&(t[e].encode.itemName=t[e].encodeEx.name,t[e].name||(t[e].name=this.getLegendData(r,t[e].encodeEx.name))),t[e].label=this.getLabelStyle(t[e].label),t[e].encodeEx.name!=""?t[e].label.formatter="{@"+t[e].encodeEx.name+"}":t[e].label.formatter="";let V=this.getTooltip(t[e].tooltip);t[e].tooltip=V,t[e].markLine.label.formatter=this.getFormatterString(t[e].markLine.label.formatter),t[e].emphasis.itemStyle&&t[e].emphasis.itemStyle.colorInfo&&(t[e].emphasis.itemStyle.color=this.getColorInfo(t[e].emphasis.itemStyle.colorInfo))}let z={legend:g,title:p,grid:d,tooltip:k,toolbox:G,xAxis:w,yAxis:C,dataset:{source:n,sourceHeader:!1},series:t};this.getAnimation(z,i),this.setOption(z),this.setAnimationLoop(i,()=>{this.setOption(z,i)})},setOption(i){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(i),{notMerge:!0})},reLoadInfo(i){this.mergeConfig(i),i&&(this.$refs.scatterCartesian.style.width=i.attr.w+"px",this.$refs.scatterCartesian.style.height=i.attr.hh+"px"),this.loadInfo(i),this.echarts.resize()},getSerData(i,o,n,s){let r=[],t=-1,p=-1;return this.$$lib__.each(n,(g,d)=>{g==o.x&&(t=d),g==i.encodeEx.y&&(p=d)}),this.$$lib__.each(s,g=>{r.push([g[t],g[p]])}),r},getDataDim(i,o){let n=[];return this.$$lib__.each(i,s=>{n.indexOf(s.encodeEx.value)==-1&&n.push(s.encodeEx.value),n.indexOf(s.encodeEx.y)==-1&&n.push(s.encodeEx.y)}),this.$$lib__.each(o,s=>{n.indexOf(s)==-1&&n.push(s)}),n},getFieldIndex(i,o){for(let n=0;n<i.length;n++)if(i[n]==o)return n},getLegendData(i,o){let n=this.$$lib__.find(i,s=>s.name==o);return n?n.alias&&n.alias!=""?n.alias:n.name:""},initAction(i){this.actionSendout(i),this.actionReceive(i)},actionSendout(i){$.log(i);let o=this;this.$$lib__.each(i.action.sendOut.actionList,n=>{if(n.enabled){let s=n.code+"_"+i.id;if(n.paramsExtend&&n.paramsExtend.length>0){let r={};this.getParamsExtend(r,n.paramsExtend,i)}n.code==P.default.click.code&&o.onClick(s,n)}})},onClick(i,o){let n=this;n.echarts.on("click",s=>{let r={},t=n.getVal(s.data,n.dimensionsEx,{x:n.seriesAttr.x,y:n.seriesAttr.y[s.componentIndex],label:n.seriesAttr.label[s.componentIndex],size:n.seriesAttr.size[s.componentIndex]});if(r.x=t.x,r.y=t.y,r.label=t.label,r.size=t.size,o.script&&o.script.enabled){if($.log("Execute script for "+n.widgetInfo.name+" component to "+o.name+" component1111111111111111111"),o.script.content==""){b.Message.warning({message:o.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",o.script.content),r=this.customScript(r)}u.Z.$emit(i,r),o.postMessage&&n.doPostMessage(r),n.actionNameList.push(i)})},getVal(i,o,n){let s={x:null,y:null,label:null,size:null},r=-1,t=-1,p=-1,g=-1;if(i&&i.length>0){for(let d=0;d<o.length;d++)o[d]==n.x&&(r=d),o[d]==n.y&&(t=d),o[d]==n.label&&(p=d),o[d]==n.size&&(g=d);s.x=i[r],s.y=i[t],s.label=i[p],s.size=i[g]}return s}}},j=D,B=a(768141),U=(0,B.Z)(j,f,h,!1,null,"8b92e788",null),K=U.exports},844513:function(O,m,a){a.d(m,{Z:function(){return N}});var f=function(){var l=this,b=l._self._c;return l.attr.buttonHide?b("div",{style:{position:"absolute",right:l.attr.buttonHideRight+"px",top:l.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(P){return l.onHide()}}},[l.openTooltip?b("el-tooltip",{attrs:{"open-delay":1e3,content:l.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[b("el-button",{class:l.attr.buttonHideIconClass&&l.attr.buttonHideIconClass!=""?l.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:l.attr.buttonHideColor,fontSize:l.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):b("el-button",{class:l.attr.buttonHideIconClass&&l.attr.buttonHideIconClass!=""?l.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:l.attr.buttonHideColor,fontSize:l.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):l._e()},h=[],c=a(752246),u={props:["attr"],name:"hide-button",data(){return{isPc:c.b}},computed:{openTooltip:function(){let S=!1,l=this.attr.buttonHideTooltipContent;return c.b&&l&&l!=null&&l.trim()!=""&&(S=!0),S}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},L=u,y=a(768141),E=(0,y.Z)(L,f,h,!1,null,"bf399b9a",null),N=E.exports}}]);
