"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[8271],{56279:function(F,w,s){s.d(w,{P:function(){return L}});var v=s(86892),d=s(49500);const L={mixins:[v.D],created(){},methods:{lifecycleBeforeChartsLoad(y){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&d.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),d.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let I=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[y]);if(I)return I}return y},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&d.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),d.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},58271:function(F,w,s){s.r(w),s.d(w,{default:function(){return j}});var v=function(){var o=this,i=o._self._c;return i("div",{style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:o.widgetInfo.attr}}),i("div",{ref:"lineSimple",style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}})],1)},d=[],L=s(44513),y=s(27966),C=s(4617),I=s(56279),Z=s(45061),z=s(26711),$=s(99349),O=s(75770),P=s(55616),W=s(67157),h=s(50666);const R={mixins:[W.c],data(){return{config_extend:{config:{series:{symbolSize:4,symbol:"emptyCircle",itemStyle:{width:2}}}},filter_config:{title:JSON.parse(JSON.stringify(h.Z.charts.title)),legend:JSON.parse(JSON.stringify(h.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(h.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(h.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(h.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(h.Z.charts.yAxis)),series:{itemStyle:{opacity:1,color:"#4C84FF"}}}}},methods:{filterPredefineColoursSchemeConfig(t,o){this.getNewConfigWithArrary(t,o,this.filter_config)}}};var N=s(49500);const T=s(29426);var B={name:"LineSimple",components:{HideButton:L.Z},mixins:[C.u,I.P,Z.u,z.H,$.P,R],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=T.init(this.$refs.lineSimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let o=[],i=[],r=[],l=[];o=t.dataset[t.dataset.type].source,i=t.dataset[t.dataset.type].dimensions,r=t.dataset[t.dataset.type].dimensionsAlias,l=t.dataset[t.dataset.type].encode,this.dimensionsEx=i,this.dimensionsAliasEx=r;let A=this.getTooltip(t.config.tooltip),G=JSON.parse(JSON.stringify(t.config.toolbox)),n=JSON.parse(JSON.stringify(t.config.legend)),c=JSON.parse(JSON.stringify(t.config.title)),f=JSON.parse(JSON.stringify(t.config.grid)),m=this.getxAxis(t.config.xAxis),p=this.getyAxis(t.config.yAxis);m.axisTick.lineStyle.color=this.getColorInfo(m.axisTick.lineStyle.colorInfo),p.axisTick.lineStyle.color=this.getColorInfo(p.axisTick.lineStyle.colorInfo),m.axisLine.lineStyle.color=this.getColorInfo(m.axisLine.lineStyle.colorInfo),p.axisLine.lineStyle.color=this.getColorInfo(p.axisLine.lineStyle.colorInfo);let e=JSON.parse(JSON.stringify(t.config.series));e.name||(e.name=this.getLegendData(r,l));let b={},J=[],E=[];for(let a=i.length-1;a>-1;--a)b[i[a]]=a;for(let a=0;a<o.length;++a){let x=o[a];J.push({name:x[b[l.x]]||"",value:x[b[l.y]]||"",source:o}),E.push(x[b[l.x]]||"")}e.data=J,m.data=E;let S={color:this.$$global_editor.predefineColors,tooltip:A,toolbox:G,title:{show:c.show,text:c.text,link:c.link,textAlign:c.textAlign,left:c.left+"%",right:c.right+"%",top:c.top+"%",bottom:c.bottom+"%",textStyle:{fontSize:c.textStyle.fontSize,fontFamily:c.textStyle.fontFamily,fontWeight:c.textStyle.fontWeight,color:c.textStyle.color}},legend:{show:n.show,type:n.type,itemWidth:n.itemWidth,itemHeight:n.itemHeight,icon:n.icon,orient:n.orient,align:n.align,itemGap:n.itemGap,left:n.left+"%",right:n.right+"%",top:n.top+"%",bottom:n.bottom+"%",textStyle:{color:n.textStyle.color,fontWeight:n.textStyle.fontWeight}},textStyle:{fontSize:n.textStyle.fontSize,fontFamily:n.textStyle.fontFamily,color:n.textStyle.color},grid:{left:f.left+"%",right:f.right+"%",top:f.top+"%",bottom:f.bottom+"%",dx:f.dx+"%",dy:f.dy+"%"},xAxis:m,yAxis:p,dataset:{source:o,sourceHeader:!1},series:[{name:e.name,symbol:e.symbol,symbolSize:e.symbolSize,type:"line",dimensions:i,encode:l,data:e.data,barWidth:e.barWidth+"%",label:{show:e.label.show,position:e.label.position,rotate:e.label.rotate,color:e.label.color,fontSize:e.label.fontSize,fontWeight:e.label.fontWeight},itemStyle:{color:e.itemStyle.color},emphasis:{itemStyle:e.emphasis.itemStyle},lineStyle:{width:e.itemStyle.width,color:e.itemStyle.color,opacity:e.itemStyle.opacity,barBorderRadius:[e.itemStyle.barBorderRadius,e.itemStyle.barBorderRadius,0,0],type:e.itemStyle.type},markLine:e.markLine,smooth:e.smooth,step:e.step}]};if(e.emphasis)try{let a=e.emphasis;if(a.script&&a.script.enabled){if(a.script.content){let x=new Function("index","item","data",a.script.content),g=S.series[0].data;if(g&&g.length>0)for(let u=0;u<g.length;++u)try{g[u].emphasis=x.call(this,u,g[u],g)}catch(K){N.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",K)}}}else e.emphasis.itemStyle&&e.emphasis.itemStyle.color&&(S.series[0].emphasis={itemStyle:{...e.emphasis.itemStyle}})}catch(a){N.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",a)}this.getAnimation(S,t),this.setOption(S),this.setAnimationLoop(t,()=>{this.setOption(S,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),setTimeout(()=>{this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},0)},reLoadInfo(t){t&&(this.$refs.lineSimple.style.width=t.attr.w+"px",this.$refs.lineSimple.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,o){let i=this.$$lib__.find(t,r=>r.name==o.y);return i?i.alias&&i.alias!=""?i.alias:i.name:""},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let o=this;this.$$lib__.each(t.action.sendOut.actionList,i=>{if(i.enabled){let r=i.code+"_"+t.id;if(i.paramsExtend&&i.paramsExtend.length>0){let l={};this.getParamsExtend(l,i.paramsExtend,t)}i.code==O.Z.click.code&&o.onClick(r,i)}})},onClick(t,o){let i=this;i.echarts.on("click",r=>{let l={},A=i.getValue(r.seriesName,r.data);if(l.x=r.name||r.value,l.y=A,o.script&&o.script.enabled){if(N.log("Execute script for "+i.widgetInfo.name+" component to "+O.Z[o.code].name+" component"),o.script.content==""){P.Message.warning({message:O.Z[o.code].name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",o.script.content),l=this.customScript(l)}y.Z.$emit(t,l),o.postMessage&&i.doPostMessage(l),i.actionNameList.push(t)})}}},D=B,H=s(68141),M=(0,H.Z)(D,v,d,!1,null,"634be961",null),j=M.exports}}]);
