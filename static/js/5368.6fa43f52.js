"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[5368],{805368:function(x,r,n){n.r(r),n.d(r,{default:function(){return m}});var c=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form-addChild",attrs:{size:"mini","label-width":"70px","label-position":"right",model:e.currentWidget}},[t("el-form-item",{attrs:{label:"\u53EF\u9009\u7EC4\u4EF6"}},[t("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",clearable:"",placeholder:"\u4ECE\u770B\u677F\u4E2D\u7684\u7EC4\u4EF6\u9009\u62E9"},model:{value:e.selectWidget,callback:function(a){e.selectWidget=a},expression:"selectWidget"}},e._l(e.widgetsList,function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})}),1),t("el-tooltip",{attrs:{"open-delay":1e3,content:"\u6DFB\u52A0\u7EC4\u4EF6",effect:"dark",placement:"top"}},[t("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(a){return e.addWidgetParent(e.currentWidget.config.container.widgets)}}})],1)],1),e._l(e.currentWidget.config.container?e.currentWidget.config.container.widgets:[],function(a,s){return t("el-form-item",{key:s,attrs:{label:"\u7EC4\u4EF6\u540D\u79F0"}},[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"\u7EC4\u4EF6\u540D\u79F0",disabled:!0},model:{value:a.name,callback:function(d){e.$set(a,"name",d)},expression:"item.name"}}),t("el-tooltip",{attrs:{"open-delay":1e3,content:"\u79FB\u9664\u5230\u770B\u677F",effect:"dark",placement:"top"}},[t("el-button",{staticStyle:{color:"#409EFF","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-back"},on:{click:function(d){return e.removeWidgetParent(s)}}})],1),t("el-tooltip",{attrs:{"open-delay":1e3,content:"\u5220\u9664\u7EC4\u4EF6",effect:"dark",placement:"top"}},[t("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(d){return e.deleteWidgetParent(s)}}})],1)],1)})],2),t("el-form",{ref:"form-dataset",attrs:{size:"mini","label-width":"70px","label-position":"right",model:e.currentWidget.dataset}},[t("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[t("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B"},on:{change:e.changeDatasetType},model:{value:e.currentWidget.dataset.type,callback:function(a){e.$set(e.currentWidget.dataset,"type",a)},expression:"currentWidget.dataset.type"}},e._l(this.$$global_editor.dataSourcTypeList3,function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})}),1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.currentWidget.config.list.selectType&&e.currentWidget.config.list.selectType!=="none",expression:"currentWidget.config.list.selectType && currentWidget.config.list.selectType !== 'none'"}],attrs:{label:"\u6807\u5FD7\u7ED1\u5B9A\u5B57\u6BB5","label-width":"120px"}},[t("el-select",{attrs:{size:"mini",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6807\u7B7E\u6587\u672C\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:e.getConfigData},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.value,callback:function(a){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"value",a)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.value"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(a){return t("el-option",{key:a.name,attrs:{label:a.alias!==""?a.alias:a.name,value:a.name}})}),1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.currentWidget.config.list.selectType&&e.currentWidget.config.list.selectType!=="none",expression:"currentWidget.config.list.selectType && currentWidget.config.list.selectType !== 'none'"}],attrs:{label:"\u7981\u7528\u7ED1\u5B9A\u5B57\u6BB5","label-width":"120px"}},[t("el-select",{attrs:{size:"mini",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6807\u7B7E\u6587\u672C\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:e.getConfigData},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.disabled,callback:function(a){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"disabled",a)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.disabled"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(a){return t("el-option",{key:a.name,attrs:{label:a.alias!==""?a.alias:a.name,value:a.name}})}),1)],1),t("setting-dataset",{ref:"settingDataset",attrs:{currentWidget:e.currentWidget},on:{getDataSetData:e.getConfigData,clearDynamicEncode:e.clearDynamicEncode}})],1)],1)},o=[],g=n(589908),u=n(723400),p=n(663778),l=n(148836),h={name:"mobile-container-list-data",components:{SettingDataset:g.Z},props:["currentWidget","widgets"],mixins:[u.j,p.a],data(){return{selectWidget:"",widgetsList:this.getWidgetsList()}},watch:{widgets:{deep:!0,handler:function(){this.widgetsList=this.getWidgetsList()}},"currentWidget.dataset":{deep:!0,handler(i){i.type!=="extend"&&this.currentWidget.config.container.widgets.forEach(e=>{let t=null;Object.keys(this.getWidgets).forEach(a=>{a===e.id&&(t=this.getWidgets[a])}),t&&(t.dataset.extend||(t.dataset.extend=JSON.parse(JSON.stringify(t.dataset.static))),t.dataset.extend.dimensions=JSON.parse(JSON.stringify(this.currentWidget.dataset[this.currentWidget.dataset.type].dimensions)),t.dataset.extend.dimensionsAlias=JSON.parse(JSON.stringify(this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias)),t.dataset.extend.columnList=JSON.parse(JSON.stringify(this.currentWidget.dataset[this.currentWidget.dataset.type].columnList)),t.dataset.extend.source=JSON.parse(JSON.stringify(this.currentWidget.dataset[this.currentWidget.dataset.type].source)),t.dataset.extend.dimensions.indexOf("LIST_INDEX")===-1&&(t.dataset.extend.dimensions.push("LIST_INDEX"),t.dataset.extend.dimensionsAlias.push({name:"LIST_INDEX",alias:"\u5E8F\u53F7",type:"NUMBER"}),t.dataset.extend.columnList.push({index:t.dataset.extend.columnList.length,aggType:null,name:"LIST_INDEX"}),t.dataset.extend.source.forEach((a,s)=>{a.push(s+1)})),t.dataset.extend.encode&&Object.keys(t.dataset.static.encode).forEach(a=>{t.dataset.extend.encode[a]||(t.dataset.extend.encode[a]=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensions[0])}),this.updateWidgetInfoById(JSON.parse(JSON.stringify(t))))})}}},computed:{...(0,l.Se)(["getWidgets"])},methods:{...(0,l.nv)(["updateWidgetInfoById","setCurrentWidget"]),changeDatasetType(){this.$refs.settingDataset.loadPreview(),this.getConfigData()},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.value="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.label="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.disabled=""},addWidgetParent(i){let e=this.$$lib__.find(this.widgetsList,t=>t.value==this.selectWidget);if(e){let t=this.widgets[e.value];t.dataset.extend=JSON.parse(JSON.stringify(t.dataset.static)),t.dataset.extend.dimensions=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensions,t.dataset.extend.dimensionsAlias=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias,t.dataset.extend.columnList=this.currentWidget.dataset[this.currentWidget.dataset.type].columnList,t.dataset.extend.source=this.currentWidget.dataset[this.currentWidget.dataset.type].source,t.dataset.extend.encode&&Object.keys(t.dataset.static.encode).forEach(a=>{t.dataset.extend.encode[a]||(t.dataset.extend.encode[a]=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensions[0])}),i.push({id:e.value,name:e.label}),this.updateWidgetParentId({widgetId:this.selectWidget,parentId:this.currentWidget.id}),this.selectWidget="",this.getConfigData(),this.updateWidgetInfoById(JSON.parse(JSON.stringify(t)))}},removeWidgetParent(i){let e=JSON.parse(JSON.stringify(this.currentWidget.config.container.widgets[i].id));this.updateWidgetParentId({widgetId:e,parentId:null});let t=this.currentWidget.config.container.widgets.splice(i,1),a;Object.keys(this.getWidgets).forEach(s=>{s===t[0].id&&(a=this.getWidgets[s])}),a.dataset.type==="extend"&&(a.dataset.type="static"),delete a.dataset.extend,this.updateWidgetInfoById(JSON.parse(JSON.stringify(a))),this.getConfigData()},deleteWidgetParent(i){let t={widgetId:JSON.parse(JSON.stringify(this.currentWidget.config.container.widgets[i].id)),parentWidgetId:this.currentWidget.id};this.containerDeleteWidget(t),this.getConfigData()}}},f=h,W=n(768141),y=(0,W.Z)(f,c,o,!1,null,"a8226fc6",null),m=y.exports}}]);
