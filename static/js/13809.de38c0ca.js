"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[13809],{56279:function(y,f,s){s.d(f,{P:function(){return n}});var l=s(386892),c=s(149500);const n={mixins:[l.D],created(){},methods:{lifecycleBeforeChartsLoad(u){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&c.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let m=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[u]);if(m)return m}return u},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&c.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(y,f,s){s.d(f,{X:function(){return l},b:function(){return c}});let l={versions:function(){var n=navigator.userAgent;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")==-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1,iPhone:n.indexOf("iPhone")>-1,iPad:n.indexOf("iPad")>-1,webApp:n.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},c;l.versions.mobile||l.versions.ios||l.versions.android||l.versions.iPhone||l.versions.iPad?c=!1:c=!0},844513:function(y,f,s){s.d(f,{Z:function(){return g}});var l=function(){var i=this,x=i._self._c;return i.attr.buttonHide?x("div",{style:{position:"absolute",right:i.attr.buttonHideRight+"px",top:i.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(w){return i.onHide()}}},[i.openTooltip?x("el-tooltip",{attrs:{"open-delay":1e3,content:i.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[x("el-button",{class:i.attr.buttonHideIconClass&&i.attr.buttonHideIconClass!=""?i.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:i.attr.buttonHideColor,fontSize:i.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):x("el-button",{class:i.attr.buttonHideIconClass&&i.attr.buttonHideIconClass!=""?i.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:i.attr.buttonHideColor,fontSize:i.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):i._e()},c=[],n=s(752246),u={props:["attr"],name:"hide-button",data(){return{isPc:n.b}},computed:{openTooltip:function(){let b=!1,i=this.attr.buttonHideTooltipContent;return n.b&&i&&i!=null&&i.trim()!=""&&(b=!0),b}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},v=u,m=s(768141),I=(0,m.Z)(v,l,c,!1,null,"bf399b9a",null),g=I.exports},213809:function(y,f,s){s.r(f),s.d(f,{default:function(){return E}});var l=function(){var o=this,e=o._self._c;return e("div",{ref:"comFixedboxDom"},[e("hide-button",{attrs:{attr:o.widgetInfo.attr}}),e("div",{ref:"comFixedbox",staticClass:"com-fixedbox",style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:o.widgetInfo.config.tooltip.show&&o.hover,expression:"widgetInfo.config.tooltip.show && hover"}],ref:"fixedboxPopup",attrs:{id:"fixedbox-popup"}},[e("div",{staticClass:"popper-arrow"})]),e("div",{ref:"fixedbox",attrs:{id:"fixedbox"},on:{mouseover:o.mouseover,mouseleave:o.mouseleave,mousedown:o.mousedown,mousemove:o.mousemove,mouseup:o.mouseup,touchstart:o.touchstart,touchmove:o.touchmove,touchend:o.touchend}},[o._v(" "+o._s(o.widgetInfo.config.fixedbox.text)+" ")])])],1)},c=[],n=s(844513),u=s(445061),v=s(126711),m=s(56279),I=s(148836),g=s(752246),b=s(321300),i=s(555616),x=s(927966),w=s(149500),S={name:"ComFixedbox",components:{HideButton:n.Z},mixins:[u.u,v.H,m.P],props:["widgetInfo"],data(){return{hover:!1,startX:0,startY:0,endX:0,endY:0,mousedownStatus:!1,mouseMove:!1,touchMove:!1,touch:1,timmer:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),window.addEventListener("mousemove",t=>{this.mousedownStatus&&this.mousemove(t)})},computed:{...(0,I.Se)(["getWidgets"])},methods:{loadInfo(t){let o=document.getElementById("myBoardArea"),e=0,r=0;if(!o){let h=this.$refs.comFixedboxDom.parentNode.parentNode.parentNode;h.style.position="fixed",h.style.left=e+t.attr.x+"px",h.style.top=r+t.attr.y+"px",h.style.display=t.attr.hide?"none":"",document.getElementsByTagName("body")[0].appendChild(h)}let a=this.$refs.fixedbox;a.style.width=t.config.fixedbox.width+"px",a.style.height=t.config.fixedbox.height+"px",a.style.borderRadius=t.config.fixedbox.borderRadius+"px",a.style.backgroundColor=t.config.fixedbox.backgroundColor,a.style.backgroundImage=this.getImageUrl(t.config.fixedbox.backgroundImage),a.style.backgroundSize=t.config.fixedbox.backgroundSize;let d=this.$refs.fixedboxPopup.querySelector(".popper-arrow"),C=(t.config.tooltip.shadowOffsetX||0)+"px "+(t.config.tooltip.shadowOffsetY||0)+"px "+(t.config.tooltip.shadowBlur||0)+"px "+t.config.tooltip.shadowColor||"rgba(0,0,0,0)";if(C+=t.config.tooltip.inset?" inset":"",t.config.tooltip.show&&!o&&t.config.tooltip.bindWidgetId){let h=this.$refs.fixedboxPopup,p=document.querySelector("#widget_"+t.config.tooltip.bindWidgetId);h.style.right=t.config.tooltip.right+"px",h.style.bottom=t.config.tooltip.bottom+t.attr.h+"px",h.style.boxShadow=C,p&&(h.style.borderRadius=p.style.borderRadius,p.style.position="static",h.appendChild(p),d.style.right=parseInt(p.style.width)*.2+"px",d.style.borderTopColor=p.style.backgroundColor,d.style.display=p?"inline-block":"none",d.style.bottom="-16px")}else t.config.tooltip.show&&!o&&(d.style.display="none");this.lifecycleAfterLoad()},reLoadInfo(t){t&&(this.$refs.comFixedbox.style.width=t.attr.w+"px",this.$refs.comFixedbox.style.height=t.attr.hh+"px"),this.loadInfo(t)},initAction(t){this.actionSendout(t),this.actionReceive(t)},getImageUrl(t){if(t&&t!="")return"url("+b.appendImageBaseURL(t)+")"},mouseover(){g.b&&(this.hover=!0)},mouseleave(){g.b&&(this.hover=!1)},mousedown(t){if(g.b){this.mousedownStatus=!0;let o=document.getElementById("fixedbox"),e=t.clientX,r=t.clientY,a=o.offsetLeft,d=o.offsetTop;this.startX=e-a,this.startY=r-d}},mousemove(t){if(this.mousedownStatus&&this.widgetInfo.config.fixedbox&&this.widgetInfo.config.fixedbox.draggable){this.mouseMove=!0;let o=t.clientX,e=t.clientY;this.endX=o,this.endY=e;let r=this.endX-this.startX,a=this.endY-this.startY;this.widgetInfo.attr.x=this.widgetInfo.attr.x+r,this.widgetInfo.attr.y=this.widgetInfo.attr.y+a,this.startX=this.endX,this.startY=this.endY}},mouseup(){g.b&&(this.mousedownStatus=!1,this.mouseMove?(this.startX=this.startY=this.endX=this.endY=0,this.mouseMove=!1):this.clickEvent())},touchstart(t){var o=t.targetTouches[0];this.startX=o.pageX,this.startY=o.pageY},touchmove(t){if(this.widgetInfo.config.fixedbox&&this.widgetInfo.config.fixedbox.draggable){t.preventDefault(),this.touchMove=!0;var o=t.targetTouches[0];this.endX=o.pageX,this.endY=o.pageY;let e=this.endX-this.startX,r=this.endY-this.startY;(this.startY!=Math.abs(r)||this.startX!=Math.abs(e))&&(this.widgetInfo.attr.x=this.widgetInfo.attr.x+e,this.widgetInfo.attr.y=this.widgetInfo.attr.y+r,this.startX=this.endX,this.startY=this.endY)}},touchend(){this.touchMove?(this.startX=this.startY=this.endX=this.endY=0,this.touchMove=!1):this.touch==1?(this.touch++,this.timmer=setTimeout(()=>{this.touch=1,this.hover=!this.hover},300)):this.touch==2&&(clearTimeout(this.timmer),this.touch=1,this.clickEvent())},clickEvent(){let t=this,o=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(o,e=>{if(e.enabled&&e.code==t.$$global_editor.actionType.click.code){document.getElementById("my_bi_screen").parentNode.scroll({top:0,behavior:"smooth"});let a=e.code+"_"+this.widgetInfo.id,d={};if(e.paramsExtend&&e.paramsExtend.length>0&&this.getExtendParams(d,e.paramsExtend),e.script&&e.script.enabled)if(w.log("Execute script for "+this.widgetInfo.name+" component to "+e.name+" component"),e.script.content)this.customScript=new Function("param",e.script.content),d=this.customScript(d);else{i.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}x.Z.$emit(a,d),e.postMessage&&this.doPostMessage(d),this.actionNameList.push(a)}else if(e.enabled&&e.code==this.$$global_editor.actionType.openLink.code){let r={};e.paramsExtend&&e.paramsExtend.length>0&&this.getExtendParams(r,e.paramsExtend);try{if(e.script&&e.script.enabled)if(w.log("Execute script for "+e.name+" action"),e.script.content)this.customScript=new Function("param",e.script.content),r=this.customScript(r);else{i.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}}catch(a){w.error("\u81EA\u5B9A\u4E49\u811A\u672C\u51FA\u9519\uFF1A",a)}this.openLinkAction(e,r)}})}}},L=S,X=s(768141),Y=(0,X.Z)(L,l,c,!1,null,"4cc2410a",null),E=Y.exports}}]);
