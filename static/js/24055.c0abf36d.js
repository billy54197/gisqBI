"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[24055],{56279:function(M,y,a){a.d(y,{P:function(){return d}});var h=a(386892),f=a(149500);const d={mixins:[h.D],created(){},methods:{lifecycleBeforeChartsLoad(x){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&f.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let b=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[x]);if(b)return b}return x},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&f.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(M,y,a){a.d(y,{X:function(){return h},b:function(){return f}});let h={versions:function(){var d=navigator.userAgent;return{trident:d.indexOf("Trident")>-1,presto:d.indexOf("Presto")>-1,webKit:d.indexOf("AppleWebKit")>-1,gecko:d.indexOf("Gecko")>-1&&d.indexOf("KHTML")==-1,mobile:!!d.match(/AppleWebKit.*Mobile.*/),ios:!!d.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:d.indexOf("Android")>-1,iPhone:d.indexOf("iPhone")>-1,iPad:d.indexOf("iPad")>-1,webApp:d.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},f;h.versions.mobile||h.versions.ios||h.versions.android||h.versions.iPhone||h.versions.iPad?f=!1:f=!0},924055:function(M,y,a){a.r(y),a.d(y,{default:function(){return E}});var h=function(){var e=this,i=e._self._c;return i("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:e.widgetInfo.attr}}),i("div",{ref:"scatterThreeDimensional",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},f=[],d=a(844513),x=a(927966),O=a(461366),b=a(67157),m=a(150813);const I={mixins:[b.c],data(){return{config_extend:{config:{series:[{itemStyle:{color:"#222227"}},{itemStyle:{color:"#29CC97"}}]}},filter_config:{title:JSON.parse(JSON.stringify(m.Z.charts.title)),legend:JSON.parse(JSON.stringify(m.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(m.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(m.Z.charts.toolbox)),visualMap:JSON.parse(JSON.stringify(m.Z.charts.visualMap)),dataZoom:JSON.parse(JSON.stringify(m.Z.charts.dataZoom)),xAxis3D:JSON.parse(JSON.stringify(m.Z.charts.xAxis3D)),yAxis3D:JSON.parse(JSON.stringify(m.Z.charts.yAxis3D)),zAxis3D:JSON.parse(JSON.stringify(m.Z.charts.zAxis3D)),series:{label:{textStyle:{color:""}},itemStyle:{opacity:1,color:""},emphasis:{itemStyle:{color:""},label:{textStyle:{color:""}}}}}}},methods:{filterPredefineColoursSchemeConfig(t,e){if(this.getNewConfig(t,e,this.filter_config),this.getNewConfig_charts_visualMap_inRange_color(t.visualMap,e.visualMap),e.color&&e.color instanceof Array&&e.color.length>0)if(t.color&&t.color instanceof Array&&t.color.length>0)for(let i=0;i<t.color.length;i++)t.color[i]=e.color[i];else t.color=JSON.parse(JSON.stringify(e.color))}}};var N=a(56279),s=a(445061),D=a(126711),J=a(99349),R=a(179966),L=a(555616),H=a(275770),z=a(149500);const C=a(954255);var P={props:["widgetInfo"],name:"scatter-three-dimensional",components:{HideButton:d.Z},mixins:[O.baseConfig,I,N.P,s.u,D.H,J.P],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},destroyed(){this.echarts.dispose()},mounted(){this.echarts=C.init(this.$refs.scatterThreeDimensional,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{loadInfo(t){let e=this.getData(t.dataset[t.dataset.type].encode,t.dataset[t.dataset.type].dimensionsAlias,t.dataset[t.dataset.type].source),i=this.getTooltip(t.config.tooltip),l=JSON.parse(JSON.stringify(t.config.xAxis3D));l.data=Array.from(new Set(e.xData));let o=JSON.parse(JSON.stringify(t.config.yAxis3D));o.data=Array.from(new Set(e.yData));let p=JSON.parse(JSON.stringify(t.config.zAxis3D));p.data=Array.from(new Set(e.zData));let c=JSON.parse(JSON.stringify(t.config.grid3D)),n=JSON.parse(JSON.stringify(t.config.series)),r=JSON.parse(JSON.stringify(t.config.visualMap));r.seriesIndex=r.show?0:-1;let A=JSON.parse(JSON.stringify(t.config.toolbox)),S=t.dataset[t.dataset.type].encode;t.config.visualMap.visualMapMin=="dataMin"&&(r.min=this.getVisualmapData(t,S.z)[0]),t.config.visualMap.visualMapMax=="dataMax"&&(r.max=this.getVisualmapData(t,S.z)[1]);let g={dataMax:0,dataMin:0,max:0,min:0};g=this.getPointSymbolSize(n,e.zData);let w={tooltip:i,toolbox:A,visualMap:this.getVisualMap(r),xAxis3D:l,yAxis3D:o,zAxis3D:p,grid3D:c,series:[{type:"scatter3D",coordinateSystem:"cartesian3D",symbol:"circle",symbolSize:function(u){let v=u[2]>0?Number((g.max-g.min)*(u[2]-g.dataMin)/(g.dataMax-g.dataMin))+Number(g.min):0;return Math.ceil(v)},animationDurationUpdate:500,blendMode:"source-over",progressive:1e5,progressiveThreshold:1e5,data:e.data.map(function(u){return{value:[u[0],u[1],u[2]]}}),shading:"lambert",label:this.getLabelStyle(n.label),itemStyle:n.itemStyle,emphasis:n.emphasis}]};z.log(w),this.echarts.dispose(),this.echarts=C.init(this.$refs.scatterThreeDimensional,null,{devicePixelRatio:2}),this.echarts.setOption(this.lifecycleBeforeChartsLoad(w),{notMerge:!0})},reLoadInfo(t){t&&(this.$refs.scatterThreeDimensional.style.width=t.attr.w+"px",this.$refs.scatterThreeDimensional.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getData(t,e,i){let l,o,p,c={xData:[],yData:[],zData:[],data:[]};return this.$$lib__.each(e,(n,r)=>{t.x&&n.name==t.x&&(l=r),t.y&&n.name==t.y&&(o=r),t.z&&n.name==t.z&&(p=r)}),this.$$lib__.each(i,n=>{l>=0?c.xData.push(n[l]):c.xData.push(0),o>=0?c.yData.push(n[o]):c.xData.push(0),p>=0?c.zData.push(n[p]):c.xData.push(0);let r=[];l>=0?r.push(n[l]):r.push(0),o>=0?r.push(n[o]):r.push(0),p>=0?r.push(n[p]):r.push(0),c.data.push(r)}),c.data=this.changeSourceType(c.data,c.xData,c.yData,c.zData),c},changeSourceType(t,e,i,l){let o=Array.from(new Set(e)),p=Array.from(new Set(i)),c=Array.from(new Set(l)),n=this.widgetInfo.config.xAxis3D.type,r=this.widgetInfo.config.yAxis3D.type,A=this.widgetInfo.config.zAxis3D.type,S=JSON.parse(JSON.stringify(t));return this.$$lib__.each(t,(g,w)=>{n=="category"&&this.$$lib__.each(o,(u,v)=>{g[0]==u&&(S[w][0]=v)}),r=="category"&&this.$$lib__.each(p,(u,v)=>{g[1]==u&&(S[w][1]=v)}),A=="category"&&this.$$lib__.each(c,(u,v)=>{g[2]==u&&(S[w][2]=v)})}),S},getPointSymbolSize(t,e){let i=[],l=0,o=0;t.isShowMax&&t.isShowMin?(t.max=20,t.min=5):!t.isShowMax&&t.isShowMin?(t.min=5,Number(t.max)<=Number(t.min)&&(t.max=Number(t.min)+1)):t.isShowMax&&!t.isShowMin&&(t.max=20,Number(t.max)<=Number(t.min)&&(t.min=Number(t.max)-1));let p=t.max,c=t.min;for(let n=0;n<e.length;n++)e[n]>0&&i.push(e[n]);return i.sort(function(n,r){return n-r}),i.length>0&&(l=i[i.length-1],o=i[0]),{dataMax:l,dataMin:o,max:p,min:c}},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let e=this;this.$$lib__.each(t.action.sendOut.actionList,i=>{if(i.enabled){let l=i.code+"_"+t.id;if(i.paramsExtend&&i.paramsExtend.length>0){let o={};this.getParamsExtend(o,i.paramsExtend,t)}i.code==H.default.click.code&&e.onClick(l,i)}})},onClick(t,e){let i=this;i.echarts.on("click",l=>{let o={};if(o.x=l.value[0],o.y=l.value[1],o.z=l.value[2],e.script&&e.script.enabled){if(z.log("Execute script for "+i.widgetInfo.name+" component to "+e.name+" component"),e.script.content==""){L.Message.warning({message:e.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",e.script.content),o=this.customScript(o)}x.Z.$emit(t,o),e.postMessage&&i.doPostMessage(o),i.actionNameList.push(t)})}}},$=P,T=a(768141),Z=(0,T.Z)($,h,f,!1,null,"feeacf6e",null),E=Z.exports},844513:function(M,y,a){a.d(y,{Z:function(){return I}});var h=function(){var s=this,D=s._self._c;return s.attr.buttonHide?D("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(J){return s.onHide()}}},[s.openTooltip?D("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[D("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):D("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},f=[],d=a(752246),x={props:["attr"],name:"hide-button",data(){return{isPc:d.b}},computed:{openTooltip:function(){let N=!1,s=this.attr.buttonHideTooltipContent;return d.b&&s&&s!=null&&s.trim()!=""&&(N=!0),N}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},O=x,b=a(768141),m=(0,b.Z)(O,h,f,!1,null,"bf399b9a",null),I=m.exports}}]);
