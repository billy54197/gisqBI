"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[4357],{59738:function(b,l,o){o.d(l,{OW:function(){return f},m3:function(){return g},nm:function(){return p},vP:function(){return h},xC:function(){return m}});var c=o(53258);function f(e,n,i){let t=e;const s=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(d=>(0,c.mf)(t[d]));if(!(0,c.mf)(t[s]))return!1;do{if(t[s](n))return!0;if(t===i)return!1;t=t.parentNode}while(t);return!1}function p(e){const n=window.getComputedStyle(e);return[parseFloat(n.getPropertyValue("width"),10),parseFloat(n.getPropertyValue("height"),10)]}function h(e,n,i){e&&(e.attachEvent?e.attachEvent("on"+n,i):e.addEventListener?e.addEventListener(n,i,!0):e["on"+n]=i)}function m(e,n,i){e&&(e.detachEvent?e.detachEvent("on"+n,i):e.removeEventListener?e.removeEventListener(n,i,!0):e["on"+n]=null)}function g(e,n,i,t){var s=0,d=setInterval(()=>{s<i?(s++,e()):(clearInterval(d),t&&t())},n);return d}},53258:function(b,l,o){o.d(l,{ew:function(){return h},le:function(){return m},mf:function(){return c},sg:function(){return g},xn:function(){return f}});function c(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function f(e,n,i,t=1){const s=Math.round(n/t/e[0])*e[0],d=Math.round(i/t/e[1])*e[1];return[s,d]}function p(e){const n=e.getBoundingClientRect();return[parseInt(n.width),parseInt(n.height)]}function h(e,n,i){return e-n-i}function m(e,n,i){return e-n-i}function g(e,n,i){return n!==null&&e<n?n:i!==null&&i<e?i:e}},44513:function(b,l,o){o.d(l,{Z:function(){return n}});var c=function(){var t=this,s=t._self._c;return t.attr.buttonHide?s("div",{style:{position:"absolute",right:t.attr.buttonHideRight+"px",top:t.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(d){return t.onHide()}}},[t.openTooltip?s("el-tooltip",{attrs:{"open-delay":1e3,content:t.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[s("el-button",{class:t.attr.buttonHideIconClass&&t.attr.buttonHideIconClass!=""?t.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.attr.buttonHideColor,fontSize:t.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s("el-button",{class:t.attr.buttonHideIconClass&&t.attr.buttonHideIconClass!=""?t.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.attr.buttonHideColor,fontSize:t.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):t._e()},f=[],p=o(52246),h={props:["attr"],name:"hide-button",data(){return{isPc:p.b}},computed:{openTooltip:function(){let i=!1,t=this.attr.buttonHideTooltipContent;return p.b&&t&&t!=null&&t.trim()!=""&&(i=!0),i}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},m=h,g=o(68141),e=(0,g.Z)(m,c,f,!1,null,"bf399b9a",null),n=e.exports},82368:function(b,l,o){o.r(l),o.d(l,{default:function(){return M}});var c=function(){var u=this,v=u._self._c;return v("div",{directives:[{name:"show",rawName:"v-show",value:u.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:u.widgetInfo.attr.w+"px",height:u.widgetInfo.attr.hh+"px"}})},f=[],p=o(44513),h=o(27966),m=o(92918),g=o(45061),e=o(26711),n=o(86892),i=o(59738),t=o(49500),s={name:"GisAnalysis",components:{HideButton:p.Z},mixins:[m.u,n.D,g.u,e.H],props:["widgetInfo"],data(){return{timer:"",map:null,tocConfig:null}},watch:{},beforeDestroy(){},mounted(){this.initAction(this.widgetInfo),this.timer=(0,i.m3)(this.getBindMap,500,50,()=>{t.error("gis-analysis\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")})},methods:{loadInfo(a){},reLoadInfo(a){this.loadInfo(a)},initAction(a){this.registerAction(a,"configMap","mapList",this.doConfigMap),this.actionReceive(a)},analysisFinish(a){let u=this,v=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(v,r=>{if(r.enabled&&r.code==u.$$global_editor.actionType.analyze.code){let I=r.code+"_"+u.widgetInfo.id,y={result:a};r.paramsExtend&&r.paramsExtend.length>0&&this.getExtendParams(y,r.paramsExtend,[],[]),r.script&&r.script.enabled&&r.script.content&&(this.doConfigMap=new Function("data",r.script.content),this.doConfigMap(y)),t.log(y),h.Z.$emit(I,y),r.postMessage&&this.doPostMessage(y),this.actionNameList.push(I)}})},getBindMap(){if(typeof this.widgetInfo.action.gisMapId<"u"){let a=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(a){clearInterval(this.timer);let u=a.$refs.gismap;u&&(t.log("\u83B7\u53D6map\u5BF9\u8C61\u6210\u529F\uFF0C\u56FE\u5C42\u76EE\u5F55\u7ED1\u5B9A\u5730\u56FE\uFF0C\u521D\u59CB\u5316\u56FE\u5C42\u64CD\u4F5C,\u5173\u95ED\u5B9A\u65F6\u5668"),this.map=u.map,this.$refs.analysis.setMap(this.map))}}},doConfigMap(a,u,v){let r=u[v];t.info("======tctocovt========="),t.info(a),t.info(r),this.map=r,t.info("==============="),this.$refs.toc.initLayerManager(this.map)}}},d=s,x=o(68141),C=(0,x.Z)(d,c,f,!1,null,"3d419060",null),M=C.exports}}]);
