"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[14324],{105143:function(m,y,s){s.d(y,{b:function(){return b}});var u=s(148836),g=s(42160),p=s(149500);const b={created(){},computed:{...(0,u.Se)(["getWidgetAllArr"])},data(){return{containerViewSubWidgetList:[]}},methods:{...(0,u.nv)(["updateWidgetParentArrDataset","updateWidgetAllArrDataset"]),reLoadInfo(o){this.widgetInfo.id!=o.id&&this.$refs["comp_"+o.id]&&setTimeout(this.$refs["comp_"+o.id][0].reLoadInfo(o),500),this.loadInfo(o)},orgWidget(o){let d=[];return this.$$lib__.each(o,f=>{let a=this.$$lib__.find(this.getWidgetAllArr,c=>c.parentId==this.widgetInfo.id&&c.id==f.id);a&&(a.dataset&&a.dataset[a.dataset.type]&&(a.dataset.type==this.$$global_editor.dataSourcType.dynamic.code||a.dataset.type==this.$$global_editor.dataSourcType.local.code)&&a.dataset[a.dataset.type].autoUpdate==!0&&(g.default.set(this.dynamicWidgets,a.id,a),a.attr.hide!=!0&&a.dataset[a.dataset.type].autoUpdate==!0&&g.default.set(this.autoUpdateWidget,a.id,a)),d.push(a))}),g.default.set(this,"containerViewSubWidgetList",d),d},setTitleText(o,d){d?this.$$lib__.each(d,f=>{this.$$lib__.each(this.orgWidget(f.widgets),a=>{a.attr.widgetW||(a.attr.widgetW=a.attr.w),this.$refs["title_"+a.id]&&this.$refs["title_"+a.id][0]&&(this.$refs["title_"+a.id][0].innerHTML=this.initTextPosition(a)),a.title.position||(a.title.position="top")})}):this.$$lib__.each(this.orgWidget(o),f=>{this.$refs["title_"+f.id]&&this.$refs["title_"+f.id][0]&&(this.$refs["title_"+f.id][0].innerHTML=this.initTextPosition(f)),f.title.position||(f.title.position="top")})},initTextPosition(o){return o.title.text===void 0||!o.title.text?"":o.title.text&&(o.title.position==="left"||o.title.position==="right")?o.title.text.split("").join("<br />"):o.title.text},updataWidgetSource(o,d,f){try{switch(o.dataset.type){case this.$$global_editor.dataSourcType.dynamic.code:o.dataset.dynamic.source=d.data,d.total&&(o.dataset.dynamic.total=d.total);break;case this.$$global_editor.dataSourcType.local.code:o.dataset.local.dimensionsAlias=[],o.dataset.local.columnList=[],o.dataset.local.source=[],o.dataset.local.dimensions=[],o.dataset.local.dimensionsAlias=d.dimensionsAlias,o.dataset.local.columnList=d.columnList,o.dataset.local.source=d.source,o.dataset.local.dimensions=d.dimensions;break}}catch(c){p&&p.log&&p.log(c)}let a=this.$refs["comp_"+o.id];a&&a.length>0&&(this.updateWidgetAllArrDataset(o),this.updateWidgetParentArrDataset(o),a[0].reLoadInfo(o),this.sendoutDataloadSuccess(o),this.sendoutResponseData(o,d,f))},fit(o,d){if(!this.isView||!/^mobile/.test(this.getCanvasSetting.transformType))return o+"px";let f=this.getCanvasSetting.width/10,a=this.getCanvasSetting.height/window.innerHeight,c="";switch(this.getCanvasSetting.transformType){case"mobileAutoWidth":d?c=o+"px":c=o/f+"rem";break;case"mobileAutoBoth":c=o/f+"rem";break;default:d?c=o/a+"px":c=o/f+"rem"}return c}}}},201616:function(m,y,s){s.r(y),s.d(y,{default:function(){return H}});var u=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-div",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:t.widgetInfo.attr}}),e("tabs",{ref:"myTabs",staticClass:"my-tabs",staticStyle:{width:"auto",height:"100%"},attrs:{type:t.widgetInfo.config.base.type,color:t.widgetInfo.config.base.color,background:t.widgetInfo.config.base.background,"lazy-render":t.widgetInfo.config.base.lazyRender,animated:t.widgetInfo.config.base.animated,duration:t.widgetInfo.config.base.duration,"line-width":t.widgetInfo.config.base.lineWidth+"px","line-height":t.widgetInfo.config.base.lineHeight+"px",border:t.widgetInfo.config.base.border,ellipse:t.widgetInfo.config.base.ellipsis,swipeable:t.widgetInfo.config.base.swipeable,"swipe-threshold":t.widgetInfo.config.base.swipeThreshold,"title-active-color":t.widgetInfo.config.base.titleActiveColor,"title-inactive-color":t.widgetInfo.config.base.titleInactiveColor},on:{click:t.handleClick,change:t.tabsChange},model:{value:t.active,callback:function(n){t.active=n},expression:"active"}},t._l(t.widgetInfo.config.tabPanes,function(n,r){return e("tab",{key:r,staticClass:"my-tabs-line",attrs:{title:n.label,name:n.id,disabled:n.disabled}},[e("template",{slot:"title"},[e("badge",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.config.tabsTitle.badge.show,expression:"widgetInfo.config.tabsTitle.badge.show"}],staticClass:"my-badge",attrs:{content:t.getBadge(r),dot:t.widgetInfo.config.tabsTitle.badge.dot,max:t.widgetInfo.config.tabsTitle.badge.max,color:n.id===t.active?t.widgetInfo.config.tabsTitle.badge.activeBackgroundColor:t.widgetInfo.config.tabsTitle.badge.inActiveBackgroundColor}},[e("div",{style:{display:"flex",height:"100%",flexDirection:t.widgetInfo.config.tabsTitle.flex,justifyContent:t.widgetInfo.config.tabsTitle.justifyContent,alignItems:"center"}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.config.tabsTitle.showIcon,expression:"widgetInfo.config.tabsTitle.showIcon"}],class:`${n.icon} tabs-icon`,style:{fontSize:t.widgetInfo.config.tabsTitle.iconFontStyle.fontSize+"px",fontWeight:t.widgetInfo.config.tabsTitle.iconFontStyle.fontWeight,fontStyle:t.widgetInfo.config.tabsTitle.iconFontStyle.fontStyle,textDecoration:t.widgetInfo.config.tabsTitle.iconFontStyle.textDecoration}}),e("span",{class:t.widgetInfo.config.base.ellipsis?"text-overflow":"",style:{fontSize:t.widgetInfo.config.tabsTitle.fontStyle.fontSize+"px",fontWeight:t.widgetInfo.config.tabsTitle.fontStyle.fontWeight,fontStyle:t.widgetInfo.config.tabsTitle.fontStyle.fontStyle,fontFamily:t.widgetInfo.config.tabsTitle.fontStyle.fontFamily,textDecoration:t.widgetInfo.config.tabsTitle.fontStyle.textDecoration}},[t._v(t._s(n.label))])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.widgetInfo.config.tabsTitle.badge.show,expression:"!widgetInfo.config.tabsTitle.badge.show"}],style:{display:"flex",height:"100%",flexDirection:t.widgetInfo.config.tabsTitle.flex,justifyContent:t.widgetInfo.config.tabsTitle.justifyContent,alignItems:"center"}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.config.tabsTitle.showIcon,expression:"widgetInfo.config.tabsTitle.showIcon"}],class:`${n.icon} tabs-icon`,style:{fontSize:t.widgetInfo.config.tabsTitle.iconFontStyle.fontSize+"px",fontWeight:t.widgetInfo.config.tabsTitle.iconFontStyle.fontWeight,fontStyle:t.widgetInfo.config.tabsTitle.iconFontStyle.fontStyle,textDecoration:t.widgetInfo.config.tabsTitle.iconFontStyle.textDecoration}}),e("span",{class:t.widgetInfo.config.base.ellipsis?"text-overflow":"",style:{fontSize:t.widgetInfo.config.tabsTitle.fontStyle.fontSize+"px",fontWeight:t.widgetInfo.config.tabsTitle.fontStyle.fontWeight,fontStyle:t.widgetInfo.config.tabsTitle.fontStyle.fontStyle,fontFamily:t.widgetInfo.config.tabsTitle.fontStyle.fontFamily,textDecoration:t.widgetInfo.config.tabsTitle.fontStyle.textDecoration}},[t._v(t._s(n.label))])])],1),e("div",{staticClass:"my-screen",style:{height:t.widgetInfo.attr.h-t.widgetInfo.config.base.height+"px"},on:{click:t.onClick}},[n.scroll.show?e("happy-scroll",{attrs:{color:n.scroll.color,size:n.scroll.width,resize:""}},[e("div",{style:{height:t.scrollHeight(n.widgets)+"px",width:t.widgetInfo.attr.w+"px"}},[t._l(t.orgWidget(n.widgets),function(i){return[e("div",{key:"widget_"+i.id,style:(i.attr.deg&&i.attr.deg!=0?"transform: rotate("+i.attr.deg+"deg);":"")+"position: absolute;width: "+i.attr.widgetW+"px;height: "+i.attr.h+"px;left:"+i.attr.x+"px;top:"+i.attr.y+"px"},[e("div",{directives:[{name:"show",rawName:"v-show",value:i.attr.showAnimate||i.attr.hideAnimate?t.first?i.attr.hide!==!0:!0:i.attr.hide!==!0,expression:"(widget.attr.showAnimate || widget.attr.hideAnimate) ? first ? widget.attr.hide !== true : true: widget.attr.hide !== true"}],ref:"widget_"+i.id,refInFor:!0,staticClass:"my-comp",style:t.getBindStyle(i)},[e("div",{staticStyle:{overflow:"hidden",width:"100%"},style:t.getTitleStyle(i),on:{click:function(h){return t.openLink(i)}}},[e("div",{style:{marginLeft:i.title.label.left+"px",marginTop:i.title.label.top+"px"}},[e("span",{style:t.getTitleSpanStyle(i)},[t._v(t._s(i.title.text)+" ")])])]),e("draggable-component-container",{ref:"comp_"+i.id,refInFor:!0,style:t.getInfoStyle(i),attrs:{widgetData:i},on:{attrChange:t.attrChange,doReSetBoardId:t.doReSetBoardId,doGetPreviewData:t.getPreviewData}})],1)])]})],2)]):t._l(t.orgWidget(n.widgets),function(i){return[e("div",{key:"widget_"+i.id,style:(i.attr.deg&&i.attr.deg!=0?"transform: rotate("+i.attr.deg+"deg);":"")+"position: absolute;width: "+i.attr.widgetW+"px;height: "+i.attr.h+"px;left:"+i.attr.x+"px;top:"+i.attr.y+"px"},[e("div",{directives:[{name:"show",rawName:"v-show",value:i.attr.showAnimate||i.attr.hideAnimate?t.first?i.attr.hide!==!0:!0:i.attr.hide!==!0,expression:"(widget.attr.showAnimate || widget.attr.hideAnimate) ? first ? widget.attr.hide !== true : true: widget.attr.hide !== true"}],ref:"widget_"+i.id,refInFor:!0,staticClass:"my-comp",style:t.getBindStyle(i)},[e("div",{staticStyle:{overflow:"hidden",width:"100%"},style:t.getTitleStyle(i),on:{click:function(h){return t.openLink(i)}}},[e("div",{style:{marginLeft:i.title.label.left+"px",marginTop:i.title.label.top+"px"}},[e("span",{style:t.getTitleSpanStyle(i)},[t._v(t._s(i.title.text)+" ")])])]),e("draggable-component-container",{ref:"comp_"+i.id,refInFor:!0,style:t.getInfoStyle(i),attrs:{widgetData:i},on:{attrChange:t.attrChange,doReSetBoardId:t.doReSetBoardId,doGetPreviewData:t.getPreviewData}})],1)])]})],2)],2)}),1)],1)},g=[],p=s(148275),b=s(821382),o=s(654602),d=s(302505),f=s(97238),a=s(416706),c=s(844513),v=s(980512),I=s(670894),w=s(977863),S=s(193575),x=s(105143),T=s(126711),$=s(445061),A=s(56279),C=s(927966),W=s(148836),D=s(555616),B=s(149500),L={name:"mobile-container-tabs-view",props:["widgetInfo","currentWidget"],components:{DraggableComponentContainer:v.Z,HideButton:c.Z,Tab:a.Z,Tabs:d.Z,HappyScroll:w.HappyScroll,Badge:b.Z},mixins:[I.baseConfig,S.E,x.b,T.H,$.u,A.P],data(){return{active:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},computed:{...(0,W.Se)(["getCanvasSetting","isView"])},mounted(){this.initAction(this.widgetInfo),this.setTitleHeight(),this.setTitleActiveBg(),this.setTabsWidth(),this.setLineBarStyle(),this.setBadgeDotSize(),this.loadInfo(this.widgetInfo)},methods:{tabsChange(l){this.setTitleActiveBg(),this.setLineBarStyle(),this.active=l},setBadgeDotSize(){this.$nextTick(()=>{let l=document.querySelectorAll(".my-tabs .van-badge--dot");Array.from(l).forEach(e=>{e.style.width=this.widgetInfo.config.tabsTitle.badge.fontSize+"px",e.style.height=this.widgetInfo.config.tabsTitle.badge.fontSize+"px",e.style.padding=0})})},setTitleHeight(){let l=this.$el.querySelectorAll(".my-tabs .van-tabs__wrap");Array.from(l).forEach(e=>{e.style.height=this.widgetInfo.config.base.height+"px"})},setTitleActiveBg(){this.$nextTick(()=>{let l=this.$el.querySelectorAll(".my-tabs .van-tab--active"),t=this.$el.querySelectorAll(".my-tabs .van-tab"),e=Array.from(l);Array.from(t).forEach(r=>{r.style.background=this.widgetInfo.config.base.background}),e.forEach(r=>{r.style.background=this.widgetInfo.config.base.color})})},setTabsWidth(){this.$nextTick(()=>{let l=this.$el.querySelectorAll(".my-tabs .van-tab");Array.from(l).forEach(e=>{e.style.width=`${100/this.widgetInfo.config.base.swipeThreshold}%`})})},setLineBarStyle(){this.$nextTick(()=>{let l=document.querySelectorAll(".my-tabs .van-tabs__line");Array.from(l).forEach(e=>{e.style.width=this.widgetInfo.config.base.lineWidth+"px",e.style.height=this.widgetInfo.config.base.lineHeight+"px",e.style.background=this.widgetInfo.config.base.lineBg})})},scrollHeight(l){let t=[];return this.orgWidget(l).forEach(e=>{t.push(e.attr.h+e.attr.y)}),t.sort((e,n)=>n-e),t[0]},reLoadInfo(l){this.loadInfo(l)},loadInfo(l){this.active=l.config.base.initActive,this.lifecycleAfterLoad()},attrChange(){},doReSetBoardId(l){this.$emit("doReSetBoardId",l)},initAction(l){this.actionReceive(l)},handleClick(l,t){let e=this,n=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(n,r=>{if(r.enabled&&r.code==e.$$global_editor.actionType.change.code){let i=e.$$global_editor.actionType.change.code+"_"+e.widgetInfo.id,h={name:l,label:t};if(r.paramsExtend&&r.paramsExtend.length>0&&this.getExtendParams(h,r.paramsExtend),r.script&&r.script.enabled){if(B.log("Execute script for "+this.widgetInfo.name+" component to "+r.name+" component"),r.script.content==""){D.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",r.script.content),h=this.customScript(h)}C.Z.$emit(i,h),r.postMessage&&this.doPostMessage(h),this.actionNameList.push(i)}})},getBadge(l){if(!this.widgetInfo.dataset[this.widgetInfo.dataset.type].source||!this.widgetInfo.dataset[this.widgetInfo.dataset.type].source[0])return;let t=this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode[`page${l+1}`],e=this.widgetInfo.dataset[this.widgetInfo.dataset.type].dimensions.findIndex(n=>n===t);if(e>-1){let n=this.widgetInfo.dataset[this.widgetInfo.dataset.type].source[0][e],r="";if(isNaN(Number(n)))r=n;else if(Number(n)>0)r=n;else return;return r}}}},E=L,F=s(768141),N=(0,F.Z)(E,u,g,!1,null,"395e2c2e",null),H=N.exports}}]);
