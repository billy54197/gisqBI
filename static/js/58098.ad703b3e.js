"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[58098],{752246:function(b,l,n){n.d(l,{X:function(){return r},b:function(){return d}});let r={versions:function(){var o=navigator.userAgent;return{trident:o.indexOf("Trident")>-1,presto:o.indexOf("Presto")>-1,webKit:o.indexOf("AppleWebKit")>-1,gecko:o.indexOf("Gecko")>-1&&o.indexOf("KHTML")==-1,mobile:!!o.match(/AppleWebKit.*Mobile.*/),ios:!!o.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:o.indexOf("Android")>-1,iPhone:o.indexOf("iPhone")>-1,iPad:o.indexOf("iPad")>-1,webApp:o.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},d;r.versions.mobile||r.versions.ios||r.versions.android||r.versions.iPhone||r.versions.iPad?d=!1:d=!0},844513:function(b,l,n){n.d(l,{Z:function(){return v}});var r=function(){var t=this,u=t._self._c;return t.attr.buttonHide?u("div",{style:{position:"absolute",right:t.attr.buttonHideRight+"px",top:t.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(w){return t.onHide()}}},[t.openTooltip?u("el-tooltip",{attrs:{"open-delay":1e3,content:t.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[u("el-button",{class:t.attr.buttonHideIconClass&&t.attr.buttonHideIconClass!=""?t.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.attr.buttonHideColor,fontSize:t.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):u("el-button",{class:t.attr.buttonHideIconClass&&t.attr.buttonHideIconClass!=""?t.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.attr.buttonHideColor,fontSize:t.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):t._e()},d=[],o=n(752246),c={props:["attr"],name:"hide-button",data(){return{isPc:o.b}},computed:{openTooltip:function(){let f=!1,t=this.attr.buttonHideTooltipContent;return o.b&&t&&t!=null&&t.trim()!=""&&(f=!0),f}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},p=c,m=n(768141),g=(0,m.Z)(p,r,d,!1,null,"bf399b9a",null),v=g.exports},358098:function(b,l,n){n.r(l),n.d(l,{default:function(){return I}});var r=function(){var i=this,a=i._self._c;return a("div",{directives:[{name:"show",rawName:"v-show",value:i.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[a("hide-button",{attrs:{attr:i.widgetInfo.attr}})],1)},d=[],o=n(844513),c=n(927966),p=n(123166),m=n(445061),g=n(126711),v=n(148836),f=n(149500),t={name:"Gis3dmap",components:{HideButton:o.Z},mixins:[p.baseConfig,m.u,g.H],props:["widgetInfo"],data(){return{layers:null,basemap:null,center:null,zoom:1}},created(){this.initAction(this.widgetInfo)},beforeDestroy(){c.Z.$off("mapInitialized")},computed:{...(0,v.Se)(["getCanvasSetting","bodyFraction"])},watch:{layers(e,i){if(i!=null){for(let a of i)this.$refs.cesiumviewer.remove(a);for(let a of e)this.$refs.cesiumviewer.add(a)}},"widgetInfo.mapLayer.toc":{handler(e){this.widgetInfo.config.options.layers=e}},"getCanvasSetting.screenZoom":{handler:function(){},immediate:!0,deep:!0},bodyFraction:{handler:function(){f.log("-----bodyFraction-----"),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH)},immediate:!0,deep:!0},"widgetInfo.attr.w":{handler:function(){setTimeout(()=>{},100)}},"widgetInfo.attr.hh":{handler:function(){setTimeout(()=>{},100)}}},mounted(){this.zoom=this.widgetInfo.config.options.zoom,this.center=this.widgetInfo.config.options.center,this.layers=this.widgetInfo.mapLayer.toc,this.widgetInfo.config.options.layers=this.layers,c.Z.$emit("register-save-event",{widget:this,handler:this.setMapInfo})},methods:{loadInfo(e){this.$refs.cesiumviewer.resizeMap();let i=!1,a=!1;this.zoom!=e.config.options.zoom&&(i=!0,this.zoom=e.config.options.zoom),this.center!=e.config.options.center&&(a=!0,this.center=e.config.options.center),(i||a)&&this.$refs.cesiumviewer.zoomTo(this.center,this.zoom),c.Z.$emit("gis3dMapReload")},reLoadInfo(e){if(this.loadInfo(e),e.mapLayer.toc){let i=[];for(let a of e.mapLayer.toc)a.url&&(a.isbase=!0,i.push(a));this.layers=i}},initAction(e){this.actionReceive(e)},actionReceive(e){e.action==null||e.action.receive==null},mapConfiged(e){let i=this,a=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(a,s=>{if(s.enabled&&s.code==i.$$global_editor.actionType.mapConfiged.code){let y=s.code+"_"+i.widgetInfo.id,h={map:e};s.paramsExtend&&s.paramsExtend.length>0&&this.getExtendParams(h,s.paramsExtend,[],[]),s.script&&s.script.enabled&&s.script.content&&(this.doConfigMap=new Function("data",s.script.content),this.doConfigMap(h)),c.Z.$emit(y,h),s.postMessage&&this.doPostMessage(h),this.actionNameList.push(y)}}),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH)},actionScale(e,i){e!=null&&i!=null&&(e==1&&i==1)},setMapInfo(){}}},u=t,w=n(768141),x=(0,w.Z)(u,r,d,!1,null,"10269d06",null),I=x.exports}}]);
