"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[56828],{656828:function(N,O,v){var D=v(676910),F=v(211105),C=v(545059),A=v(577767),I=v(587586),P=function(){var R=function(g,y){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,x){p.__proto__=x}||function(p,x){for(var L in x)Object.prototype.hasOwnProperty.call(x,L)&&(p[L]=x[L])},R(g,y)};return function(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");R(g,y);function p(){this.constructor=g}g.prototype=y===null?Object.create(y):(p.prototype=y.prototype,new p)}}(),T={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},S=["#00f","#0ff","#0f0","#ff0","#f00"],M=function(R){P(g,R);function g(y){var p=this,x=y||{},L=(0,C.f0)({},x);delete L.gradient,delete L.radius,delete L.blur,delete L.weight,p=R.call(this,L)||this,p.gradient_=null,p.addChangeListener(T.GRADIENT,p.handleGradientChanged_),p.setGradient(x.gradient?x.gradient:S),p.setBlur(x.blur!==void 0?x.blur:15),p.setRadius(x.radius!==void 0?x.radius:8);var b=x.weight?x.weight:"weight";return typeof b=="string"?p.weightFunction_=function(E){return E.get(b)}:p.weightFunction_=b,p.setRenderOrder(null),p}return g.prototype.getBlur=function(){return this.get(T.BLUR)},g.prototype.getGradient=function(){return this.get(T.GRADIENT)},g.prototype.getRadius=function(){return this.get(T.RADIUS)},g.prototype.handleGradientChanged_=function(){this.gradient_=U(this.getGradient())},g.prototype.setBlur=function(y){this.set(T.BLUR,y)},g.prototype.setGradient=function(y){this.set(T.GRADIENT,y)},g.prototype.setRadius=function(y){this.set(T.RADIUS,y)},g.prototype.createRenderer=function(){return new F.Z(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(y){var p=this.weightFunction_(y);return p!==void 0?(0,A.uZ)(p,0,1):1}.bind(this)}],vertexShader:`
        precision mediump float;
        uniform mat4 u_projectionMatrix;
        uniform mat4 u_offsetScaleMatrix;
        uniform float u_size;
        attribute vec2 a_position;
        attribute float a_index;
        attribute float a_weight;

        varying vec2 v_texCoord;
        varying float v_weight;

        void main(void) {
          mat4 offsetMatrix = u_offsetScaleMatrix;
          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;
          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;
          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;
          v_texCoord = vec2(u, v);
          v_weight = a_weight;
        }`,fragmentShader:`
        precision mediump float;
        uniform float u_blurSlope;

        varying vec2 v_texCoord;
        varying float v_weight;

        void main(void) {
          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);
          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;
          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;
          float alpha = smoothstep(0.0, 1.0, value) * v_weight;
          gl_FragColor = vec4(alpha, alpha, alpha, alpha);
        }`,hitVertexShader:`
        precision mediump float;
        uniform mat4 u_projectionMatrix;
        uniform mat4 u_offsetScaleMatrix;
        uniform float u_size;
        attribute vec2 a_position;
        attribute float a_index;
        attribute float a_weight;
        attribute vec4 a_hitColor;

        varying vec2 v_texCoord;
        varying float v_weight;
        varying vec4 v_hitColor;

        void main(void) {
          mat4 offsetMatrix = u_offsetScaleMatrix;
          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;
          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;
          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;
          v_texCoord = vec2(u, v);
          v_hitColor = a_hitColor;
          v_weight = a_weight;
        }`,hitFragmentShader:`
        precision mediump float;
        uniform float u_blurSlope;

        varying vec2 v_texCoord;
        varying float v_weight;
        varying vec4 v_hitColor;

        void main(void) {
          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);
          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;
          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;
          float alpha = smoothstep(0.0, 1.0, value) * v_weight;
          if (alpha < 0.05) {
            discard;
          }

          gl_FragColor = v_hitColor;
        }`,uniforms:{u_size:function(){return(this.get(T.RADIUS)+this.get(T.BLUR))*2}.bind(this),u_blurSlope:function(){return this.get(T.RADIUS)/Math.max(1,this.get(T.BLUR))}.bind(this)},postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this),u_opacity:function(){return this.getOpacity()}.bind(this)}}]})},g.prototype.renderDeclutter=function(){},g}(D.Z);function U(R){for(var g=1,y=256,p=(0,I.E4)(g,y),x=p.createLinearGradient(0,0,g,y),L=1/(R.length-1),b=0,E=R.length;b<E;++b)x.addColorStop(b*L,R[b]);return p.fillStyle=x,p.fillRect(0,0,g,y),p.canvas}O.Z=M},470401:function(N,O,v){v.d(O,{O$:function(){return L},S$:function(){return M},il:function(){return b}});var D=v(194008),F=v(36913),C=v(616569),A=v(683771),I=v(377543),P=v(73226),T=v(776094),S=function(){var E=function(d,h){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,u){_.__proto__=u}||function(_,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(_[f]=u[f])},E(d,h)};return function(d,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");E(d,h);function _(){this.constructor=d}d.prototype=h===null?Object.create(h):(_.prototype=h.prototype,new _)}}(),M={GENERATE_BUFFERS:"GENERATE_BUFFERS"},U=function(E){S(d,E);function d(h,_){var u=E.call(this,h)||this,f=_||{};return u.inversePixelTransform_=(0,P.Ue)(),u.pixelContext_=null,u.postProcesses_=f.postProcesses,u.uniforms_=f.uniforms,u.helper,h.addChangeListener(D.Z.MAP,u.removeHelper.bind(u)),u.dispatchPreComposeEvent=u.dispatchPreComposeEvent.bind(u),u.dispatchPostComposeEvent=u.dispatchPostComposeEvent.bind(u),u}return d.prototype.dispatchPreComposeEvent=function(h,_){var u=this.getLayer();if(u.hasListener(A.Z.PRECOMPOSE)){var f=new C.Z(A.Z.PRECOMPOSE,void 0,_,h);u.dispatchEvent(f)}},d.prototype.dispatchPostComposeEvent=function(h,_){var u=this.getLayer();if(u.hasListener(A.Z.POSTCOMPOSE)){var f=new C.Z(A.Z.POSTCOMPOSE,void 0,_,h);u.dispatchEvent(f)}},d.prototype.reset=function(h){this.uniforms_=h.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},d.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},d.prototype.prepareFrame=function(h){if(this.getLayer().getRenderSource()){for(var _=!0,u=-1,f=void 0,s=0,c=h.layerStatesArray.length;s<c;s++){var i=h.layerStatesArray[s].layer,o=i.getRenderer();if(!(o instanceof d)){_=!0;continue}var e=i.getClassName();if((_||e!==f)&&(u+=1,_=!1),f=e,o===this)break}var t="map/"+h.mapId+"/group/"+u;(!this.helper||!this.helper.canvasCacheKeyMatches(t))&&(this.removeHelper(),this.helper=new I.ZP({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:t}),f&&(this.helper.getCanvas().className=f),this.afterHelperCreated())}return this.prepareFrameInternal(h)},d.prototype.afterHelperCreated=function(){},d.prototype.prepareFrameInternal=function(h){return!0},d.prototype.disposeInternal=function(){this.removeHelper(),E.prototype.disposeInternal.call(this)},d.prototype.dispatchRenderEvent_=function(h,_,u){var f=this.getLayer();if(f.hasListener(h)){(0,P.qC)(this.inversePixelTransform_,0,0,u.pixelRatio,-u.pixelRatio,0,0,-u.size[1]);var s=new C.Z(h,this.inversePixelTransform_,u,_);f.dispatchEvent(s)}},d.prototype.preRender=function(h,_){this.dispatchRenderEvent_(A.Z.PRERENDER,h,_)},d.prototype.postRender=function(h,_){this.dispatchRenderEvent_(A.Z.POSTRENDER,h,_)},d.prototype.getDataAtPixel=function(h,_,u){var f=(0,P.nn)([_.pixelRatio,0,0,_.pixelRatio,0,0],h.slice()),s=this.helper.getGL();if(!s)return null;var c=this.getLayer(),i=c.getExtent();if(i){var o=(0,P.nn)(_.pixelToCoordinateTransform,h.slice());if(!(0,T.containsCoordinate)(i,o))return null}var e=s.getContextAttributes();if(!e||!e.preserveDrawingBuffer)return new Uint8Array;var t=Math.round(f[0]),n=Math.round(f[1]),r=this.pixelContext_;if(!r){var a=document.createElement("canvas");a.width=1,a.height=1,r=a.getContext("2d"),this.pixelContext_=r}r.clearRect(0,0,1,1);var l;try{r.drawImage(s.canvas,t,n,1,1,0,0,1,1),l=r.getImageData(0,0,1,1).data}catch{return l}return l[3]===0?null:l},d}(F.Z),R=null,g={vertexPosition:0,indexPosition:0};function y(E,d,h,_,u){E[d+0]=h,E[d+1]=_,E[d+2]=u}function p(E,d,h,_,u,f){var s=3,c=2,i=s+u,o=E[d+0],e=E[d+1],t=R;t.length=u;for(var n=0;n<t.length;n++)t[n]=E[d+c+n];var r=f?f.vertexPosition:0,a=f?f.indexPosition:0,l=r/i;return y(h,r,o,e,0),t.length&&h.set(t,r+s),r+=i,y(h,r,o,e,1),t.length&&h.set(t,r+s),r+=i,y(h,r,o,e,2),t.length&&h.set(t,r+s),r+=i,y(h,r,o,e,3),t.length&&h.set(t,r+s),r+=i,_[a++]=l,_[a++]=l+1,_[a++]=l+3,_[a++]=l+1,_[a++]=l+2,_[a++]=l+3,g.vertexPosition=r,g.indexPosition=a,g}function x(){var E=document.createElement("canvas"),d=E.getContext("2d").createImageData(1,1);return d.data[0]=255,d.data[1]=255,d.data[2]=255,d.data[3]=255,d}function L(E,d){var h=d||[],_=256,u=_-1;return h[0]=Math.floor(E/_/_/_)/u,h[1]=Math.floor(E/_/_)%_/u,h[2]=Math.floor(E/_)%_/u,h[3]=E%_/u,h}function b(E){var d=0,h=256,_=h-1;return d+=Math.round(E[0]*h*h*h*_),d+=Math.round(E[1]*h*h*_),d+=Math.round(E[2]*h*_),d+=Math.round(E[3]*_),d}O.ZP=U},211105:function(N,O,v){v.d(O,{Z:function(){return _}});var D=v(676910),F=v(468950),C=v(507244),A=v(413584),I=v(470401),P=v(955631),T=new Uint8Array(4),S=function(){function u(f,s){this.helper_=f;var c=f.getGL();this.texture_=c.createTexture(),this.framebuffer_=c.createFramebuffer(),this.size_=s||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return u.prototype.setSize=function(f){(0,P.fS)(f,this.size_)||(this.size_[0]=f[0],this.size_[1]=f[1],this.updateSize_())},u.prototype.getSize=function(){return this.size_},u.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},u.prototype.readAll=function(){if(this.dataCacheDirty_){var f=this.size_,s=this.helper_.getGL();s.bindFramebuffer(s.FRAMEBUFFER,this.framebuffer_),s.readPixels(0,0,f[0],f[1],s.RGBA,s.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},u.prototype.readPixel=function(f,s){if(f<0||s<0||f>this.size_[0]||s>=this.size_[1])return T[0]=0,T[1]=0,T[2]=0,T[3]=0,T;this.readAll();var c=Math.floor(f)+(this.size_[1]-Math.floor(s)-1)*this.size_[0];return T[0]=this.data_[c*4],T[1]=this.data_[c*4+1],T[2]=this.data_[c*4+2],T[3]=this.data_[c*4+3],T},u.prototype.getTexture=function(){return this.texture_},u.prototype.getFramebuffer=function(){return this.framebuffer_},u.prototype.updateSize_=function(){var f=this.size_,s=this.helper_.getGL();this.texture_=this.helper_.createTexture(f,null,this.texture_),s.bindFramebuffer(s.FRAMEBUFFER,this.framebuffer_),s.viewport(0,0,f[0],f[1]),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(f[0]*f[1]*4)},u}(),M=S,U=v(242254),R=v(377543),g=v(73226),y=v(312059),p=v(776094),x=v(755872).Buffer;function L(){var u='const e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1,n=arguments.length;e<n;++e){const n=arguments[e];if(null!=n)for(const e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}return t},n="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";n.indexOf("firefox");-1!==n.indexOf("safari")&&-1==n.indexOf("chrom")&&(n.indexOf("version/15.4")>=0||n.match(/cpu (os|iphone os) 15_4 like mac os x/)),-1!==n.indexOf("webkit")&&n.indexOf("edge"),n.indexOf("macintosh"),"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),function(){let e=!1;try{const n=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,n),window.removeEventListener("_",null,n)}catch(e){}}(),new Array(6);const t="GENERATE_BUFFERS",o=[],r={vertexPosition:0,indexPosition:0};function i(e,n,t,o,r){e[n+0]=t,e[n+1]=o,e[n+2]=r}function s(e,n,t,s,f,c){const l=3+f,a=e[n+0],u=e[n+1],d=o;d.length=f;for(let t=0;t<d.length;t++)d[t]=e[n+2+t];let g=c?c.vertexPosition:0,x=c?c.indexPosition:0;const h=g/l;return i(t,g,a,u,0),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,1),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,2),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,3),d.length&&t.set(d,g+3),g+=l,s[x++]=h,s[x++]=h+1,s[x++]=h+3,s[x++]=h+1,s[x++]=h+2,s[x++]=h+3,r.vertexPosition=g,r.indexPosition=x,r}const f=self;f.onmessage=n=>{const o=n.data;if(o.type===t){const n=3,t=2,r=o.customAttributesCount,i=t+r,c=new Float32Array(o.renderInstructions),l=c.length/i,a=4*l*(r+n),u=new Uint32Array(6*l),d=new Float32Array(a);let g;for(let e=0;e<c.length;e+=i)g=s(c,e,d,u,r,g);const x=e({vertexBuffer:d.buffer,indexBuffer:u.buffer,renderInstructions:c.buffer},o);f.postMessage(x,[d.buffer,u.buffer,c.buffer])}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+x.from(u,"binary").toString("base64"):URL.createObjectURL(new Blob([u],{type:"application/javascript"})))}var b=v(95232),E=v(24918),d=function(){var u=function(f,s){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,i){c.__proto__=i}||function(c,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(c[o]=i[o])},u(f,s)};return function(f,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");u(f,s);function c(){this.constructor=f}f.prototype=s===null?Object.create(s):(c.prototype=s.prototype,new c)}}(),h=function(u){d(f,u);function f(s,c){var i=this,o=c.uniforms||{},e=(0,g.Ue)();o[R.ZC.PROJECTION_MATRIX]=e,i=u.call(this,s,{uniforms:o,postProcesses:c.postProcesses})||this,i.ready=!1,i.sourceRevision_=-1,i.verticesBuffer_=new A.ZP(U.qO,U.kd),i.hitVerticesBuffer_=new A.ZP(U.qO,U.kd),i.indicesBuffer_=new A.ZP(U.cX,U.kd),i.vertexShader_=c.vertexShader,i.fragmentShader_=c.fragmentShader,i.program_,i.hitDetectionEnabled_=!!(c.hitFragmentShader&&c.hitVertexShader),i.hitVertexShader_=c.hitVertexShader,i.hitFragmentShader_=c.hitFragmentShader,i.hitProgram_;var t=c.attributes?c.attributes.map(function(r){return{name:"a_"+r.name,size:1,type:R.GC.FLOAT}}):[];i.attributes=[{name:"a_position",size:2,type:R.GC.FLOAT},{name:"a_index",size:1,type:R.GC.FLOAT}].concat(t),i.hitDetectionAttributes=[{name:"a_position",size:2,type:R.GC.FLOAT},{name:"a_index",size:1,type:R.GC.FLOAT},{name:"a_hitColor",size:4,type:R.GC.FLOAT},{name:"a_featureUid",size:1,type:R.GC.FLOAT}].concat(t),i.customAttributes=c.attributes?c.attributes:[],i.previousExtent_=(0,p.createEmpty)(),i.currentTransform_=e,i.renderTransform_=(0,g.Ue)(),i.invertRenderTransform_=(0,g.Ue)(),i.renderInstructions_=new Float32Array(0),i.hitRenderInstructions_=new Float32Array(0),i.hitRenderTarget_,i.generateBuffersRun_=0,i.worker_=L(),i.worker_.addEventListener("message",function(r){var a=r.data;if(a.type===I.S$.GENERATE_BUFFERS){var l=a.projectionTransform;a.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(a.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(a.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(a.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=l,(0,g.nb)(this.invertRenderTransform_,this.renderTransform_),a.hitDetection?this.hitRenderInstructions_=new Float32Array(r.data.renderInstructions):(this.renderInstructions_=new Float32Array(r.data.renderInstructions),a.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}.bind(i)),i.featureCache_={},i.featureCount_=0;var n=i.getLayer().getSource();return i.sourceListenKeys_=[(0,E.oL)(n,F.Z.ADDFEATURE,i.handleSourceFeatureAdded_,i),(0,E.oL)(n,F.Z.CHANGEFEATURE,i.handleSourceFeatureChanged_,i),(0,E.oL)(n,F.Z.REMOVEFEATURE,i.handleSourceFeatureDelete_,i),(0,E.oL)(n,F.Z.CLEAR,i.handleSourceFeatureClear_,i)],n.forEachFeature(function(r){this.featureCache_[(0,b.sq)(r)]={feature:r,properties:r.getProperties(),geometry:r.getGeometry()},this.featureCount_++}.bind(i)),i}return f.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new M(this.helper))},f.prototype.handleSourceFeatureAdded_=function(s){var c=s.feature;this.featureCache_[(0,b.sq)(c)]={feature:c,properties:c.getProperties(),geometry:c.getGeometry()},this.featureCount_++},f.prototype.handleSourceFeatureChanged_=function(s){var c=s.feature;this.featureCache_[(0,b.sq)(c)]={feature:c,properties:c.getProperties(),geometry:c.getGeometry()}},f.prototype.handleSourceFeatureDelete_=function(s){var c=s.feature;delete this.featureCache_[(0,b.sq)(c)],this.featureCount_--},f.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},f.prototype.renderFrame=function(s){var c=this.helper.getGL();this.preRender(c,s);var i=s.viewState.projection,o=this.getLayer(),e=o.getSource(),t=e.getWrapX()&&i.canWrapX(),n=i.getExtent(),r=s.extent,a=t?(0,p.getWidth)(n):null,l=t?Math.ceil((r[2]-n[2])/a)+1:1,m=t?Math.floor((r[0]-n[0])/a):0,B=m,w=this.indicesBuffer_.getSize();do this.helper.makeProjectionTransform(s,this.currentTransform_),(0,g.Iu)(this.currentTransform_,B*a,0),(0,g.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(s),this.helper.drawElements(0,w);while(++B<l);this.helper.finalizeDraw(s,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);var G=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(s,m,l,a),this.hitRenderTarget_.clearCachedData()),this.postRender(c,s),G},f.prototype.prepareFrameInternal=function(s){var c=this.getLayer(),i=c.getSource(),o=s.viewState,e=!s.viewHints[C.Z.ANIMATING]&&!s.viewHints[C.Z.INTERACTING],t=!(0,p.equals)(this.previousExtent_,s.extent),n=this.sourceRevision_<i.getRevision();if(n&&(this.sourceRevision_=i.getRevision()),e&&(t||n)){var r=o.projection,a=o.resolution,l=c instanceof D.Z?c.getRenderBuffer():0,m=(0,p.buffer)(s.extent,l*a);i.loadFeatures(m,a,r),this.rebuildBuffers_(s),this.previousExtent_=s.extent.slice()}return this.helper.useProgram(this.program_),this.helper.prepareDraw(s),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},f.prototype.rebuildBuffers_=function(s){var c=(0,g.Ue)();this.helper.makeProjectionTransform(s,c);var i=(2+this.customAttributes.length)*this.featureCount_;if((!this.renderInstructions_||this.renderInstructions_.length!==i)&&(this.renderInstructions_=new Float32Array(i)),this.hitDetectionEnabled_){var o=(7+this.customAttributes.length)*this.featureCount_;(!this.hitRenderInstructions_||this.hitRenderInstructions_.length!==o)&&(this.hitRenderInstructions_=new Float32Array(o))}var e,t,n=[],r=[],a=0,l=0,m;for(var B in this.featureCache_)if(e=this.featureCache_[B],t=e.geometry,!(!t||t.getType()!=="Point")){n[0]=t.getFlatCoordinates()[0],n[1]=t.getFlatCoordinates()[1],(0,g.nn)(c,n),m=(0,I.O$)(l+6,r),this.renderInstructions_[a++]=n[0],this.renderInstructions_[a++]=n[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[l++]=n[0],this.hitRenderInstructions_[l++]=n[1],this.hitRenderInstructions_[l++]=m[0],this.hitRenderInstructions_[l++]=m[1],this.hitRenderInstructions_[l++]=m[2],this.hitRenderInstructions_[l++]=m[3],this.hitRenderInstructions_[l++]=Number(B));for(var w=void 0,G=0;G<this.customAttributes.length;G++)w=this.customAttributes[G].callback(e.feature,e.properties),this.renderInstructions_[a++]=w,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[l++]=w)}var z={type:I.S$.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(z.projectionTransform=c,z.generateBuffersRun=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(z,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var W={type:I.S$.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};W.projectionTransform=c,W.hitDetection=!0,this.worker_.postMessage(W,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},f.prototype.forEachFeatureAtCoordinate=function(s,c,i,o,e){if((0,y.h)(this.hitDetectionEnabled_,66),!!this.hitRenderInstructions_){var t=(0,g.nn)(c.coordinateToPixelTransform,s.slice()),n=this.hitRenderTarget_.readPixel(t[0]/2,t[1]/2),r=[n[0]/255,n[1]/255,n[2]/255,n[3]/255],a=(0,I.il)(r),l=this.hitRenderInstructions_[a],m=Math.floor(l).toString(),B=this.getLayer().getSource(),w=B.getFeatureByUid(m);if(w)return o(w,this.getLayer(),null)}},f.prototype.renderHitDetection=function(s,c,i,o){if(this.hitVerticesBuffer_.getSize()){var e=c;this.hitRenderTarget_.setSize([Math.floor(s.size[0]/2),Math.floor(s.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(s,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(s,this.currentTransform_),(0,g.Iu)(this.currentTransform_,e*o,0),(0,g.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(s);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}while(++e<i)}},f.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(s){(0,E.bN)(s)}),this.sourceListenKeys_=null,u.prototype.disposeInternal.call(this)},f}(I.ZP),_=h},17860:function(N,O,v){v.d(O,{U:function(){return D},u:function(){return F}});function D(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function F(C,A){return C[0]=A[0],C[1]=A[1],C[4]=A[2],C[5]=A[3],C[12]=A[4],C[13]=A[5],C}},242254:function(N,O,v){v.d(O,{Ae:function(){return M},F_:function(){return I},MB:function(){return P},RF:function(){return R},cX:function(){return A},fw:function(){return y},kd:function(){return T},qO:function(){return C},r1:function(){return U},wg:function(){return S}});var D=v(102047),F=v(545059),C=34962,A=34963,I=35040,P=35044,T=35048,S=5121,M=5123,U=5125,R=5126,g=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function y(L,b){for(var E=(0,F.f0)({preserveDrawingBuffer:!0,antialias:!D.ME},b),d=g.length,h=0;h<d;++h)try{var _=L.getContext(g[h],E);if(_)return _}catch{}return null}var p;function x(){if(!p){var L=document.createElement("canvas"),b=y(L);b&&(p=b.getSupportedExtensions())}return p}},413584:function(N,O,v){var D=v(242254),F=v(312059),C={STATIC_DRAW:D.MB,STREAM_DRAW:D.F_,DYNAMIC_DRAW:D.kd},A=function(){function P(T,S){this.array=null,this.type=T,(0,F.h)(T===D.qO||T===D.cX,62),this.usage=S!==void 0?S:C.STATIC_DRAW}return P.prototype.ofSize=function(T){this.array=new(I(this.type))(T)},P.prototype.fromArray=function(T){var S=I(this.type);this.array=S.from?S.from(T):new S(T)},P.prototype.fromArrayBuffer=function(T){this.array=new(I(this.type))(T)},P.prototype.getType=function(){return this.type},P.prototype.getArray=function(){return this.array},P.prototype.getUsage=function(){return this.usage},P.prototype.getSize=function(){return this.array?this.array.length:0},P}();function I(P){switch(P){case D.qO:return Float32Array;case D.cX:return Uint32Array;default:return Float32Array}}O.ZP=A},377543:function(N,O,v){v.d(O,{GC:function(){return x},ZC:function(){return p},ZP:function(){return c}});var D={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},F=v(384899),C=v(95232),A=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,I=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`,P=function(){function i(o){this.gl_=o.webGlContext;var e=this.gl_;this.scaleRatio_=o.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer();var t=e.createShader(e.VERTEX_SHADER);e.shaderSource(t,o.vertexShader||A),e.compileShader(t);var n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,o.fragmentShader||I),e.compileShader(n),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,t),e.attachShader(this.renderTargetProgram_,n),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();var r=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],o.uniforms&&Object.keys(o.uniforms).forEach(function(a){this.uniforms_.push({value:o.uniforms[a],location:e.getUniformLocation(this.renderTargetProgram_,a)})}.bind(this))}return i.prototype.getGL=function(){return this.gl_},i.prototype.init=function(o){var e=this.getGL(),t=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,t[0],t[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==t[0]||this.renderTargetTextureSize_[1]!==t[1]){this.renderTargetTextureSize_=t;var n=0,r=e.RGBA,a=0,l=e.RGBA,m=e.UNSIGNED_BYTE,B=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,n,r,t[0],t[1],a,l,m,B),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}},i.prototype.apply=function(o,e,t,n){var r=this.getGL(),a=o.size;if(r.bindFramebuffer(r.FRAMEBUFFER,e?e.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),!e){var l=(0,C.sq)(r.canvas);if(!o.renderTargets[l]){var m=r.getContextAttributes();m&&m.preserveDrawingBuffer&&(r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)),o.renderTargets[l]=!0}}r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),r.uniform1i(this.renderTargetTextureLocation_,0);var B=o.layerStatesArray[o.layerIndex].opacity;r.uniform1f(this.renderTargetOpacityLocation_,B),this.applyUniforms(o),t&&t(r,o),r.drawArrays(r.TRIANGLES,0,6),n&&n(r,o)},i.prototype.getFrameBuffer=function(){return this.frameBuffer_},i.prototype.applyUniforms=function(o){var e=this.getGL(),t,n=1;this.uniforms_.forEach(function(r){if(t=typeof r.value=="function"?r.value(o):r.value,t instanceof HTMLCanvasElement||t instanceof ImageData)r.texture||(r.texture=e.createTexture()),e.activeTexture(e["TEXTURE".concat(n)]),e.bindTexture(e.TEXTURE_2D,r.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,t.width,t.height,0,e.UNSIGNED_BYTE,new Uint8Array(t.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.uniform1i(r.location,n++);else if(Array.isArray(t))switch(t.length){case 2:e.uniform2f(r.location,t[0],t[1]);return;case 3:e.uniform3f(r.location,t[0],t[1],t[2]);return;case 4:e.uniform4f(r.location,t[0],t[1],t[2],t[3]);return;default:return}else typeof t=="number"&&e.uniform1f(r.location,t)})},i}(),T=P,S=v(242254),M=v(545059),U=v(73226),R=v(17860),g=function(){var i=function(o,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},i(o,e)};return function(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),y={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633},p={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},x={UNSIGNED_BYTE:S.wg,UNSIGNED_SHORT:S.Ae,UNSIGNED_INT:S.r1,FLOAT:S.RF},L={};function b(i){return"shared/"+i}var E=0;function d(){var i="unique/"+E;return E+=1,i}function h(i){var o=L[i];if(!o){var e=document.createElement("canvas");e.style.position="absolute",e.style.left="0",o={users:0,canvas:e},L[i]=o}return o.users+=1,o.canvas}function _(i){var o=L[i];if(o&&(o.users-=1,!(o.users>0))){var e=o.canvas,t=(0,S.fw)(e),n=t.getExtension("WEBGL_lose_context");n&&n.loseContext(),delete L[i]}}var u=function(i){g(o,i);function o(e){var t=i.call(this)||this,n=e||{};t.boundHandleWebGLContextLost_=t.handleWebGLContextLost.bind(t),t.boundHandleWebGLContextRestored_=t.handleWebGLContextRestored.bind(t),t.canvasCacheKey_=n.canvasCacheKey?b(n.canvasCacheKey):d(),t.canvas_=h(t.canvasCacheKey_),t.gl_=(0,S.fw)(t.canvas_),t.bufferCache_={},t.extensionCache_={},t.currentProgram_=null,t.canvas_.addEventListener(D.LOST,t.boundHandleWebGLContextLost_),t.canvas_.addEventListener(D.RESTORED,t.boundHandleWebGLContextRestored_),t.offsetRotateMatrix_=(0,U.Ue)(),t.offsetScaleMatrix_=(0,U.Ue)(),t.tmpMat4_=(0,R.U)(),t.uniformLocations_={},t.attribLocations_={},t.uniforms_=[],n.uniforms&&t.setUniforms(n.uniforms);var r=t.getGL();return t.postProcessPasses_=n.postProcesses?n.postProcesses.map(function(a){return new T({webGlContext:r,scaleRatio:a.scaleRatio,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,uniforms:a.uniforms})}):[new T({webGlContext:r})],t.shaderCompileErrors_=null,t.startTime_=Date.now(),t}return o.prototype.setUniforms=function(e){this.uniforms_=[];for(var t in e)this.uniforms_.push({name:t,value:e[t]});this.uniformLocations_={}},o.prototype.canvasCacheKeyMatches=function(e){return this.canvasCacheKey_===b(e)},o.prototype.getExtension=function(e){if(e in this.extensionCache_)return this.extensionCache_[e];var t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t},o.prototype.bindBuffer=function(e){var t=this.getGL(),n=(0,C.sq)(e),r=this.bufferCache_[n];if(!r){var a=t.createBuffer();r={buffer:e,webGlBuffer:a},this.bufferCache_[n]=r}t.bindBuffer(e.getType(),r.webGlBuffer)},o.prototype.flushBufferData=function(e){var t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())},o.prototype.deleteBuffer=function(e){var t=this.getGL(),n=(0,C.sq)(e),r=this.bufferCache_[n];r&&!t.isContextLost()&&t.deleteBuffer(r.webGlBuffer),delete this.bufferCache_[n]},o.prototype.disposeInternal=function(){this.canvas_.removeEventListener(D.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(D.RESTORED,this.boundHandleWebGLContextRestored_),_(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},o.prototype.prepareDraw=function(e,t){var n=this.getGL(),r=this.getCanvas(),a=e.size,l=e.pixelRatio;r.width=a[0]*l,r.height=a[1]*l,r.style.width=a[0]+"px",r.style.height=a[1]+"px",n.useProgram(this.currentProgram_);for(var m=this.postProcessPasses_.length-1;m>=0;m--)this.postProcessPasses_[m].init(e);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,t?n.ZERO:n.ONE_MINUS_SRC_ALPHA),n.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},o.prototype.prepareDrawToRenderTarget=function(e,t,n){var r=this.getGL(),a=t.getSize();r.bindFramebuffer(r.FRAMEBUFFER,t.getFramebuffer()),r.viewport(0,0,a[0],a[1]),r.bindTexture(r.TEXTURE_2D,t.getTexture()),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,n?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},o.prototype.drawElements=function(e,t){var n=this.getGL();this.getExtension("OES_element_index_uint");var r=n.UNSIGNED_INT,a=4,l=t-e,m=e*a;n.drawElements(n.TRIANGLES,l,r,m)},o.prototype.finalizeDraw=function(e,t,n){for(var r=0,a=this.postProcessPasses_.length;r<a;r++)r===a-1?this.postProcessPasses_[r].apply(e,null,t,n):this.postProcessPasses_[r].apply(e,this.postProcessPasses_[r+1])},o.prototype.getCanvas=function(){return this.canvas_},o.prototype.getGL=function(){return this.gl_},o.prototype.applyFrameState=function(e){var t=e.size,n=e.viewState.rotation,r=(0,U.mc)(this.offsetScaleMatrix_);(0,U.bA)(r,2/t[0],2/t[1]);var a=(0,U.mc)(this.offsetRotateMatrix_);n!==0&&(0,U.U1)(a,-n),this.setUniformMatrixValue(p.OFFSET_SCALE_MATRIX,(0,R.u)(this.tmpMat4_,r)),this.setUniformMatrixValue(p.OFFSET_ROTATION_MATRIX,(0,R.u)(this.tmpMat4_,a)),this.setUniformFloatValue(p.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(p.ZOOM,e.viewState.zoom),this.setUniformFloatValue(p.RESOLUTION,e.viewState.resolution)},o.prototype.applyUniforms=function(e){var t=this.getGL(),n,r=0;this.uniforms_.forEach(function(a){if(n=typeof a.value=="function"?a.value(e):a.value,n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof ImageData){a.texture||(a.prevValue=void 0,a.texture=t.createTexture()),t.activeTexture(t["TEXTURE".concat(r)]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);var l=!(n instanceof HTMLImageElement)||n.complete;l&&a.prevValue!==n&&(a.prevValue=n,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),t.uniform1i(this.getUniformLocation(a.name),r++)}else if(Array.isArray(n)&&n.length===6)this.setUniformMatrixValue(a.name,(0,R.u)(this.tmpMat4_,n));else if(Array.isArray(n)&&n.length<=4)switch(n.length){case 2:t.uniform2f(this.getUniformLocation(a.name),n[0],n[1]);return;case 3:t.uniform3f(this.getUniformLocation(a.name),n[0],n[1],n[2]);return;case 4:t.uniform4f(this.getUniformLocation(a.name),n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&t.uniform1f(this.getUniformLocation(a.name),n)}.bind(this))},o.prototype.useProgram=function(e){if(e==this.currentProgram_)return!1;var t=this.getGL();return t.useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},!0},o.prototype.compileShader=function(e,t){var n=this.getGL(),r=n.createShader(t);return n.shaderSource(r,e),n.compileShader(r),r},o.prototype.getProgram=function(e,t){var n=this.getGL(),r=this.compileShader(e,n.FRAGMENT_SHADER),a=this.compileShader(t,n.VERTEX_SHADER),l=n.createProgram();if(n.attachShader(l,r),n.attachShader(l,a),n.linkProgram(l),!n.getShaderParameter(r,n.COMPILE_STATUS)){var m="Fragment shader compliation failed: ".concat(n.getShaderInfoLog(r));throw new Error(m)}if(n.deleteShader(r),!n.getShaderParameter(a,n.COMPILE_STATUS)){var m="Vertex shader compilation failed: ".concat(n.getShaderInfoLog(a));throw new Error(m)}if(n.deleteShader(a),!n.getProgramParameter(l,n.LINK_STATUS)){var m="GL program linking failed: ".concat(n.getShaderInfoLog(a));throw new Error(m)}return l},o.prototype.getUniformLocation=function(e){return this.uniformLocations_[e]===void 0&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]},o.prototype.getAttributeLocation=function(e){return this.attribLocations_[e]===void 0&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]},o.prototype.makeProjectionTransform=function(e,t){var n=e.size,r=e.viewState.rotation,a=e.viewState.resolution,l=e.viewState.center;return(0,U.mc)(t),(0,U.qC)(t,0,0,2/(a*n[0]),2/(a*n[1]),-r,-l[0],-l[1]),t},o.prototype.setUniformFloatValue=function(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)},o.prototype.setUniformFloatVec4=function(e,t){this.getGL().uniform4fv(this.getUniformLocation(e),t)},o.prototype.setUniformMatrixValue=function(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)},o.prototype.enableAttributeArray_=function(e,t,n,r,a){var l=this.getAttributeLocation(e);l<0||(this.getGL().enableVertexAttribArray(l),this.getGL().vertexAttribPointer(l,t,n,!1,r,a))},o.prototype.enableAttributes=function(e){for(var t=f(e),n=0,r=0;r<e.length;r++){var a=e[r];this.enableAttributeArray_(a.name,a.size,a.type||S.RF,t,n),n+=a.size*s(a.type)}},o.prototype.handleWebGLContextLost=function(){(0,M.ZH)(this.bufferCache_),this.currentProgram_=null},o.prototype.handleWebGLContextRestored=function(){},o.prototype.createTexture=function(e,t,n){var r=this.getGL(),a=n||r.createTexture(),l=0,m=r.RGBA,B=0,w=r.RGBA,G=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,a),t?r.texImage2D(r.TEXTURE_2D,l,m,w,G,t):r.texImage2D(r.TEXTURE_2D,l,m,e[0],e[1],B,w,G,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),a},o}(F.Z);function f(i){for(var o=0,e=0;e<i.length;e++){var t=i[e];o+=t.size*s(t.type)}return o}function s(i){switch(i){case x.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case x.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case x.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case x.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var c=u}}]);
