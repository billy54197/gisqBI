"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[8684],{49389:function(E,_,u){u.d(_,{Z:function(){return S}});var b=function(){var r=this,a=r._self._c;return a("div",{staticStyle:{height:"100%","border-right":"1px solid rgba(220, 223, 230, 1)"}},[a("el-tree",{ref:"groupTree",staticStyle:{"background-color":"rgba(248,248,248,1)",height:"calc(100% - 20px)","padding-top":"10px","padding-bottom":"10px"},attrs:{data:r.groupTreeData,"default-expanded-keys":r.defaultExpandedKeys,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!0},on:{"node-click":r.handleNodeClick},scopedSlots:r._u([{key:"default",fn:function({node:l,data:f}){return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"my-del",style:r.styleTreeNode(l),attrs:{title:"\u5206\u7EC4 [ "+l.label+" ]"}},[f.isRoot==!0?a("i",{class:"tree_icon iconfont bi_zxbd_"+(f.restypeCode?f.restypeCode.toLowerCase():"")}):a("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[l.expanded?a("use",{attrs:{"xlink:href":" #bi_fileOpen"}}):a("use",{attrs:{"xlink:href":"#bi_fileClose"}})]),r._v(" "+r._s(l.label)+" ")]),[f.parentId==null?a("span",{staticClass:"custom-tree-node-btn"},[a("el-tooltip",{attrs:{"open-delay":1e3,content:"\u6DFB\u52A0\u5206\u7EC4",effect:"dark",placement:"top"}},[a("i",{staticClass:"iconfont bi_add31 seticon",on:{click:function(m){return m.stopPropagation(),r.addGroup(f)}}})])],1):r._e(),f.parentId!=null?a("span",{staticClass:"custom-tree-node-btn"},[a("el-dropdown",{attrs:{placement:"right-start"},on:{command:function(m){return r.handleCommandCate(m,l)}}},[a("span",{staticClass:"iconfont bi_gengduo seticon",style:{color:r.theme.icon_color}}),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"b"}},[a("i",{staticClass:"iconfont bi_add31 seticon"}),r._v("\u6DFB\u52A0\u5206\u7EC4 ")]),a("el-dropdown-item",{attrs:{command:"a"}},[a("i",{staticClass:"iconfont bi_edit4 seticon"}),r._v("\u7F16\u8F91\u5206\u7EC4 ")]),l.isLeaf?a("el-dropdown-item",{attrs:{command:"c"}},[a("i",{staticClass:"iconfont bi_del3 seticon"}),r._v("\u5220\u9664\u5206\u7EC4 ")]):r._e()],1)],1)],1):r._e()]],2)}}])}),a("el-dialog",{staticClass:"dialog-publish",attrs:{"append-to-body":"",title:r.dialogTitle,"close-on-click-modal":!1,visible:r.dialogVisible,width:"434px"},on:{"update:visible":function(l){r.dialogVisible=l}}},[a("el-form",{ref:"refGroupForm",attrs:{model:r.groupEntity,rules:r.rules,size:"mini","label-width":"120px"}},[a("el-form-item",{attrs:{label:" \u7236\u7EA7\u5206\u7EC4\u540D\u79F0\uFF1A"}},[a("el-select",{ref:"select",staticClass:"white-bgc",staticStyle:{width:"250px"},attrs:{value:r.parentName,"popper-append-to-body":!1,placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u5206\u7EC4\u540D\u79F0"},on:{"visible-change":r.visibleChange}},[a("el-option",{staticStyle:{height:"auto"},attrs:{value:r.groupEntity.parentId,label:r.parentName}},[a("el-tree",{ref:"selectTree",attrs:{data:r.groupTreeData,"node-key":"id","default-expand-all":!0,"highlight-current":"","expand-on-click-node":!1},on:{"node-click":r.handleNodeClick2}})],1)],1)],1),a("el-form-item",{attrs:{label:" \u5206\u7EC4\u7F16\u7801\uFF1A",prop:"groupCode"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:"20",placeholder:"\u8BF7\u8F93\u516520\u5B57\u4EE5\u5185\u7684\u5206\u7EC4\u7F16\u7801"},model:{value:r.groupEntity.groupCode,callback:function(l){r.$set(r.groupEntity,"groupCode",l)},expression:"groupEntity.groupCode"}})],1),a("el-form-item",{attrs:{label:" \u5206\u7EC4\u540D\u79F0\uFF1A",prop:"groupName"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{maxlength:"20",placeholder:"\u8BF7\u8F93\u516520\u5B57\u4EE5\u5185\u7684\u5206\u7EC4\u540D\u79F0"},model:{value:r.groupEntity.groupName,callback:function(l){r.$set(r.groupEntity,"groupName",l)},expression:"groupEntity.groupName"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:r.cancelEidt}},[r._v("\u53D6 \u6D88")]),a("el-button",{style:{backgroundColor:r.theme.btn_bgc,borderColor:r.theme.btn_bgc},attrs:{size:"mini",type:"primary"},on:{click:function(l){return r.saveGroup("refGroupForm")}}},[r._v("\u786E \u5B9A")])],1)],1)],1)},y=[],h=u(48836),g=u(35051);let p="/data/resourceGroup",n={save(i){return(0,g.postRequest)(p+"/save",i)},getResourceGroupList(){return(0,g.getRequest)(p+"/getResourceGroupList")},deleteResourceGroup(i){return(0,g.deleteRequest)(p+"/deleteResourceGroup/"+i)}};var c=u(55616),v={name:"resource-aside",props:{resource_type:{type:Object,default:()=>({})},isSelect:{type:Boolean,default:()=>!1}},data(){return{dialogVisible:!1,dialogTitle:"",parentName:"",groupEntity:{groupId:"",parentId:"",parentProgenitorIds:"",progenitorIds:"",groupCode:"",groupName:"",restypeId:""},rules:{groupCode:[{required:!0,max:20,message:"\u5FC5\u586B\uFF1A\u5206\u7EC4\u7F16\u7801\uFF08\u957F\u5EA6\u9650\u523620\u5B57\u7B26\uFF09",trigger:"blur"}],groupName:[{required:!0,max:20,message:"\u5FC5\u586B\uFF1A\u5206\u7EC4\u540D\u79F0\uFF08\u957F\u5EA6\u9650\u523620\u5B57\u7B26\uFF09",trigger:"blur"}]},groupList:[],groupTreeData:[],defaultExpandedKeys:[]}},computed:{...(0,h.Se)(["getApplication"])},watch:{getApplication:{deep:!0,handler:function(){this.initGroupTreeData()}},resource_type:{deep:!0,handler:function(){this.initGroupTreeData()}}},mounted(){this.initGroupTreeData()},methods:{initGroupTreeData(i){let r=JSON.parse(JSON.stringify(this.resource_type));r.isRoot=!0,r.id=r.restypeId,r.groupId=r.restypeId,r.label=r.restypeName,r.groupName=r.restypeName,r.progenitorIds="",i?this.defaultExpandedKeys=[i]:this.defaultExpandedKeys=[r.restypeId],n.getResourceGroupList().then(a=>{a&&a.status==200?(this.groupList=a.data,this.groupList.push(r),this.groupTreeData=this.rebuildData(),i&&this.currentNode(i)):c.Message.error({message:a.msg,offset:60})})},handleCommandCate(i,r){i=="a"?this.updateGroup(r):i=="b"?this.addGroup(r.data):i=="c"&&this.deleteGroup(r,r.data)},addGroup(i){this.emptyGroup(),this.dialogVisible=!0,this.dialogTitle="\u6DFB\u52A0\u5206\u7EC4",this.groupEntity.parentId=i.groupId,this.groupEntity.parentProgenitorIds=i.progenitorIds,this.parentName=i.groupName},updateGroup(i){this.dialogVisible=!0,this.dialogTitle="\u7F16\u8F91\u5206\u7EC4-"+i.data.groupName,this.groupEntity.groupId=i.data.groupId,this.groupEntity.groupCode=i.data.groupCode,this.groupEntity.groupName=i.data.groupName,this.groupEntity.parentId=i.data.parentId,this.groupEntity.progenitorIds=i.data.progenitorIds,this.parentName=i.parent.data.groupName,this.groupEntity.parentProgenitorIds=i.parent.data.progenitorIds},deleteGroup(i,r){var a=this;this.$confirm("\u5220\u9664\u5206\u7EC4[ "+r.groupName+" ]\uFF0C\u662F\u5426\u7EE7\u7EED \uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",customClass:"deleteBoardC"}).then(()=>{a.$parent.loading=!0,n.deleteResourceGroup(r.groupId).then(l=>{a.$parent.loading=!1,l&&l.status==200?(this.$emit("getResourceFileList",null),this.initGroupTreeData(),c.Message.success({message:l.data,offset:60})):c.Message.warning({message:l.msg,offset:60})})}).catch(()=>{c.Message.info({message:"\u5DF2\u53D6\u6D88\u5220\u9664",offset:60})})},saveGroup(){let i=this;i.$refs.refGroupForm.validate(r=>{if(r){if(i.$parent.loading=!0,this.groupEntity.groupId==this.groupEntity.parentId){c.Message.warning({message:"\u7236\u7EA7\u5206\u7EC4\u4E0D\u80FD\u662F\u5F53\u524D\u5206\u7EC4\uFF0C\u8BF7\u9009\u62E9\u5176\u4ED6\u5206\u7EC4",offset:60});return}if(this.groupEntity.groupCode.trim()==""||this.groupEntity.groupName.trim()==""){c.Message.warning({message:"\u5206\u7EC4\u7F16\u7801\u548C\u5206\u7EC4\u540D\u79F0\u5747\u4E0D\u5141\u8BB8\u4E3A\u7A7A",offset:60});return}i.groupEntity.applicationId=i.getApplication.applicationId,i.groupEntity.groupId&&i.groupEntity.groupId!=""?i.groupEntity.parentProgenitorIds&&i.groupEntity.parentProgenitorIds!=""?i.groupEntity.progenitorIds=i.groupEntity.parentProgenitorIds+i.groupEntity.groupId+"/":i.groupEntity.progenitorIds=i.groupEntity.groupId+"/":i.groupEntity.progenitorIds=i.groupEntity.parentProgenitorIds,n.save(this.groupEntity).then(a=>{i.$parent.loading=!1,a&&a.status==200?(this.dialogVisible=!1,i.groupEntity.groupId!=""?i.groupEntity.id=i.groupEntity.groupId:(i.groupEntity.id=a.data,i.groupEntity.groupId=a.data,i.groupEntity.progenitorIds=i.groupEntity.parentProgenitorIds+i.groupEntity.groupId+"/"),this.initGroupTreeData(i.groupEntity.id),c.Message.success({message:"\u4FDD\u5B58\u6210\u529F",offset:60})):c.Message.error({message:a.msg,offset:60})})}else return!1})},handleNodeClick(i){this.$emit("getResourceFileList",i.isRoot!=!0?i.groupId:null)},visibleChange(i){i&&this.$refs.selectTree.setCurrentKey(this.groupEntity.parentId)},handleNodeClick2(i){if(i.groupId==this.groupEntity.groupId){c.Message.warning({message:"\u4E0D\u5141\u8BB8\u9009\u62E9\u81EA\u8EAB\u5206\u7EC4\u4F5C\u4E3A\u7236\u5206\u7EC4",offset:60});return}else if(i.progenitorIds.indexOf(this.groupEntity.groupId)>-1){c.Message.warning({message:"\u4E0D\u5141\u8BB8\u9009\u62E9\u5B50\u5206\u7EC4\u4F5C\u4E3A\u7236\u5206\u7EC4",offset:60});return}this.groupEntity.parentId=i.groupId,this.groupEntity.parentProgenitorIds=i.progenitorIds,this.parentName=i.groupName,this.$refs.select.blur()},emptyGroup(){this.groupEntity={groupId:"",parentId:"",parentProgenitorIds:"",progenitorIds:"",groupCode:"",groupName:"",restypeId:this.resource_type.restypeId},this.parentName=""},cancelEidt(){this.dialogVisible=!1,this.emptyGroup()},currentNode(i,r){this.$nextTick(()=>{this.$refs.groupTree.setCurrentKey(i),r&&this.handleNodeClick({groupId:i})})},rebuildData(){let i={},r={},a=[];return this.$$lib__.each(this.groupList,l=>{l.id=l.groupId,l.label=l.groupName,l.parentId!=null?(r[l.parentId]||(r[l.parentId]=[]),r[l.parentId].push(l)):a.push(l)}),this.transferFl(a,r,i),a},transferFl(i,r,a){this.$$lib__.each(i,l=>{let f=r[l.groupId];f?(l.children=f,a[l.groupId]&&this.$$lib__.each(a[l.groupId],m=>{l.children.push(m)}),this.transferFl(f,r,a)):a[l.groupId]&&(l.children=a[l.groupId])})},styleTreeNode(i){return{maxWidth:150-(i.level-1)*18+"px"}}}},w=v,I=u(68141),N=(0,I.Z)(w,b,y,!1,null,"c404f9c4",null),S=N.exports},87423:function(E,_,u){u.d(_,{Z:function(){return K}});var b=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"my_resource_content"},[t("div",{staticClass:"exportTop"},[t("el-row",[t("el-col",{attrs:{span:15}},[t("el-input",{staticStyle:{width:"300px",height:"30px",margin:"5px 0 5px 10px"},attrs:{placeholder:"\u8F93\u5165\u8D44\u6E90\u6587\u4EF6\u540D\u79F0\u6216\u6587\u4EF6ID",clearable:"",size:"small"},on:{clear:e.clickButton},nativeOn:{keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.clickButton.apply(null,arguments)}},model:{value:e.keyWords,callback:function(o){e.keyWords=o},expression:"keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:e.clickButton},slot:"suffix"})])],1),e.groupId&&e.groupId!=""?t("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:9}},[t("el-button",{staticStyle:{float:"right","margin-right":"20px"},attrs:{size:"mini",type:"primary"},on:{click:function(o){return e.clickAdd()}}},[e._v("\u65B0\u5EFA ")]),t("el-upload",{ref:"upload",style:{float:"right",marginRight:"20px",marginTop:(e.isSelect==!0||e.isDialog==!0?0:-3)+"px"},attrs:{action:"",multiple:!0,accept:e.resource_type.restypeType,"show-file-list":!1,"before-upload":e.beforeAvatarUpload,"http-request":e.myUpload}},[t("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("\u4E0A\u4F20")])],1)],1):e._e()],1)],1),t("div",{staticClass:"table-nav"},[t("el-table",{staticClass:"my-table-class",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:e.isSelect!=!0,"highlight-current-row":"",height:e.height-(e.isDialog==!0?340:e.isSelect==!0?220:260),"header-align":"center","row-class-name":e.tableRowClassName,"header-cell-style":{background:"#F5F7FA"}},on:{"row-click":e.handleRowClick}},[t("el-table-column",{attrs:{label:"\u5E8F\u53F7",align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v(" "+e._s(e.rowNumber(o))+" ")]}}])}),e.tableData.length>0?t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-descriptions",{attrs:{border:"",column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"\u6587\u4EF6Id"}},[t("el-input",{attrs:{value:o.row.fileId,size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u4E0A\u4F20\u65F6\u95F4"}},[t("el-input",{attrs:{value:e.formatDate(o.row.createdTime),size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u66F4\u65B0\u65F6\u95F4"}},[t("el-input",{attrs:{value:e.formatDate(o.row.updatedTime),size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u6587\u4EF6\u540D\u79F0"}},[t("el-input",{attrs:{value:o.row.fileName,size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u6587\u4EF6\u7C7B\u578B"}},[t("el-input",{attrs:{value:o.row.fileType,size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u6587\u4EF6\u5927\u5C0F"}},[t("el-input",{attrs:{value:e.formatterSize(o.row),size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u5206\u7EC4\u7F16\u7801"}},[t("el-input",{attrs:{value:o.row.groupCode,size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u5206\u7EC4\u540D\u79F0"}},[t("el-input",{attrs:{value:o.row.groupName,size:"small",readonly:""}})],1),t("el-descriptions-item",{attrs:{label:"\u6587\u4EF6\u76F8\u5BF9\u8DEF\u5F84"}},[t("el-input",{attrs:{value:o.row.fileUrlPath,size:"small",readonly:""}})],1)],1)]}}],null,!1,1502282486)}):e._e(),t("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",prop:"fileName",label:"\u6587\u4EF6\u540D\u79F0"}}),t("el-table-column",{attrs:{prop:"fileId",align:"center",label:"\u6587\u4EF6ID",width:"270"}}),t("el-table-column",{attrs:{prop:"fileSize",label:"\u6587\u4EF6\u5927\u5C0F",align:"center",formatter:e.formatterSize,width:"90"}}),t("el-table-column",{attrs:{align:"center",label:"\u64CD\u4F5C",width:e.isSelect!=!0?155:170},scopedSlots:e._u([{key:"default",fn:function(o){return[[t("el-tooltip",{attrs:{"open-delay":1e3,effect:"dark",content:"\u4E0B\u8F7D\u6587\u4EF6",placement:"top"}},[t("el-button",{staticStyle:{float:"left","margin-right":"10px"},attrs:{type:"text",size:"small"},on:{click:function(d){return e.clickDownload(o.row)}}},[t("span",{staticClass:"iconfont bi_kbdr"})])],1),t("el-tooltip",{attrs:{"open-delay":1e3,effect:"dark",content:"\u4E0A\u4F20\u6587\u4EF6\u8986\u76D6",placement:"top"}},[t("el-upload",{staticStyle:{float:"left","margin-right":"10px"},attrs:{action:"",multiple:!1,accept:e.resource_type.restypeType,"show-file-list":!1,"before-upload":e.beforeUpload,"http-request":e.uploadFile}},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(d){return e.clickUpload(o.row)}}},[t("span",{staticClass:"iconfont bi_kbdc"})])],1)],1),t("el-tooltip",{attrs:{"open-delay":1e3,effect:"dark",content:"\u7F16\u8F91\u6587\u4EF6",placement:"top"}},[t("el-button",{staticStyle:{float:"left",color:"#E6A23C"},attrs:{type:"text",size:"small"},on:{click:function(d){return e.clickEditor(o.row)}}},[t("span",{staticClass:"iconfont bi_edit4"})])],1),t("el-tooltip",{attrs:{"open-delay":1e3,effect:"dark",content:"\u4F7F\u7528\u60C5\u51B5",placement:"top"}},[t("el-button",{staticStyle:{float:"left",color:"#E6A23C"},attrs:{type:"text",size:"small"},on:{click:function(d){return e.clickUse(o.row)}}},[t("i",{staticClass:"iconfont bi_material"})])],1),t("el-tooltip",{attrs:{"open-delay":1e3,effect:"dark",content:"\u5220\u9664\u6587\u4EF6",placement:"top"}},[t("el-button",{staticStyle:{float:"left",color:"red"},attrs:{type:"text",size:"small"},on:{click:function(d){return e.clickDelete(o.row)}}},[t("span",{staticClass:"iconfont bi_trash1"})])],1)]]}}])})],1),t("el-pagination",{staticClass:"my-pagination",staticStyle:{float:"right"},attrs:{"current-page":e.pageName,layout:"total,prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}}),e.isSelect==!0?t("div",{staticClass:"my-button"},[t("el-button",{staticStyle:{width:"56px"},attrs:{size:"mini",type:"primary",disabled:!e.isSelectRow()},on:{click:e.confirmRow}},[e._v("\u786E\u5B9A ")]),t("el-button",{attrs:{size:"mini"},on:{click:e.cancelRow}},[e._v("\u53D6\u6D88")])],1):e._e()],1),t("resource-container-dialog",{ref:"ref_resource_container_dialog",attrs:{resource_type:e.resource_type},on:{reloadData:e.initData}}),t("resource-use",{ref:"ref_resource_use"})],1)},y=[],h=u(35051);let g="/data/resourceFile",p={updateInfo(s){return(0,h.postRequest)(g+"/updateInfo",s)},uploadMultipartFile(s,e,t){return(0,h.uploadFileRequest)(g+"/uploadMultipartFile/"+s+"/"+e,t)},saveFile(s){return(0,h.uploadFileRequest)(g+"/saveFile",s)},delete(s){return(0,h.deleteRequest)(g+"/delete/"+s)},getListByPage(s){return(0,h.postRequest)(g+"/getListByPage",s)},download(s){return(0,h.downloadExcelRequest)(g+"/download/"+s)}};var n=u(55616),c=u(48836),v=u(21300),w=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"my-dialog-class",attrs:{title:e.dialog.title,"append-to-body":!0,"modal-append-to-body":!0,"close-on-click-modal":!1,visible:e.dialog.visible,width:e.dialog.width+"px"},on:{"update:visible":function(o){return e.$set(e.dialog,"visible",o)},opened:e.dialogOpened}},[t("div",{style:{height:e.dialog.height+"px"}},[t("my-monaco-editor",{ref:"my_monaco_editor",attrs:{language:e.language},on:{onDidChangeModelContent:e.doChangeModelContent},model:{value:e.file_content,callback:function(o){e.file_content=o},expression:"file_content"}})],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(o){e.dialog.visible=!1}}},[e._v("\u5173\u95ED")]),t("el-button",{attrs:{size:"mini",type:"primary",disabled:e.file_content_old==e.file_content},on:{click:e.confirm}},[e._v("\u4FDD\u5B58")])],1)]),t("el-dialog",{staticClass:"my-dialog-class my-dialog-class-add",attrs:{title:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0","append-to-body":!0,"modal-append-to-body":!0,"close-on-click-modal":!1,visible:e.dialog.visible_add,width:"450px"},on:{"update:visible":function(o){return e.$set(e.dialog,"visible_add",o)}}},[t("div",{staticStyle:{padding:"10px"}},[t("el-form",{ref:"ref_form",attrs:{rules:e.rules,model:e.resourceFile,"label-width":"90px",size:"mini"},nativeOn:{submit:function(o){o.preventDefault()}}},[t("el-form-item",{attrs:{label:"\u6587\u4EF6\u540D\u79F0",prop:"fileName"}},[t("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0(\u5EFA\u8BAE\u5B57\u6BCD\uFF0C\u6570\u5B57\uFF0C\u4E0B\u5212\u7EBF\u7B49\u7EC4\u5408)",maxlength:"50","show-word-limit":""},model:{value:e.resourceFile.fileName,callback:function(o){e.$set(e.resourceFile,"fileName",o)},expression:"resourceFile.fileName"}})],1)],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(o){e.dialog.visible_add=!1}}},[e._v("\u53D6\u6D88")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.confirmAdd}},[e._v("\u786E\u5B9A")])],1)])],1)},I=[],N={name:"resource-container-dialog",components:{MyMonacoEditor:()=>Promise.resolve().then(u.bind(u,80424))},props:{resource_type:{type:Object,default:()=>({})}},data(){return{dialog:{width:0,height:0,visible:!1,visible_add:!1,title:""},language:"css",file_content:"",file_content_old:"",resourceFile:{groupId:null,restypeId:null,fileType:null,fileName:null},rules:{fileName:[{required:!0,message:"\u6587\u4EF6\u540D\u79F0(\u5EFA\u8BAE\u5B57\u6BCD\uFF0C\u6570\u5B57\uFF0C\u4E0B\u5212\u7EBF\u7B49\u7EC4\u5408)",trigger:"blur"},{min:1,max:50,message:"\u957F\u5EA6\u5728 1 \u5230 50 \u4E2A\u5B57\u7B26",trigger:"blur"}]}}},mounted(){this.dialog.height=window.innerHeight-140,this.dialog.width=window.innerWidth-40},methods:{confirm(){this.saveFile({fileId:this.resourceFile.fileId,fileName:this.resourceFile.fileName,fileType:this.resourceFile.fileType},this.file_content,s=>{s&&s.status==200?(this.file_content_old=this.file_content,n.Message.success({message:"\u4FDD\u5B58\u6210\u529F",offset:60})):n.Message.error({message:"\u4FDD\u5B58\u5931\u8D25"+s.msg,offset:60})})},confirmAdd(){this.$refs.ref_form.validate(s=>{if(s){if(!this.resourceFile.groupId||this.resourceFile.groupId==""){n.Message.warning({message:"\u5206\u7EC4\u4E0D\u80FD\u4E3A\u7A7A",offset:60});return}if(!this.resourceFile.restypeId||this.resourceFile.restypeId==""){n.Message.warning({message:"\u8D44\u6E90\u6587\u4EF6\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",offset:60});return}if(this.resourceFile.fileName.trim()==""){n.Message.warning({message:"\u8D44\u6E90\u6587\u4EF6\u540D\u79F0\u5747\u4E0D\u5141\u8BB8\u4E3A\u7A7A",offset:60});return}this.saveFile({restypeId:this.resourceFile.restypeId,groupId:this.resourceFile.groupId,fileType:this.resource_type.restypeType,fileName:this.resourceFile.fileName+"."+this.resource_type.restypeCode.toLowerCase()},"",e=>{e&&e.status==200?(this.dialog.visible_add=!1,n.Message.success({message:"\u65B0\u5EFA\u6210\u529F",offset:60})):n.Message.error({message:"\u65B0\u5EFA\u5931\u8D25"+e.msg,offset:60})})}else return!1})},saveFile(s,e,t){let o=new Blob([e],{type:s.fileType}),d=new FormData;d.append("file",o,s.fileName),d.append("resourceFile",JSON.stringify(s)),this.$parent.loading=!0,p.saveFile(d).then(k=>{this.$parent.loading=!1,t&&t(k),this.$emit("reloadData")})},dialogOpened(){this.file_content="",this.file_content_old="",p.download(this.resourceFile.fileId).then(s=>{if(!s)return;let e=new FileReader;e.readAsText(new Blob([s])),e.onload=()=>{this.file_content=e.result,this.file_content_old=e.result,this.loadTextContent()}})},loadTextContent(){this.$refs.my_monaco_editor&&this.$refs.my_monaco_editor.initEditor()},openAdd(s){this.resourceFile.restypeId=this.resource_type.restypeId,this.resourceFile.groupId=s,this.resourceFile.fileName=null,this.dialog.visible_add=!0},openEditor(s,e){e.toLowerCase()=="css"?this.language="css":e.toLowerCase()=="js"&&(this.language="javascript"),this.resourceFile=s,this.dialog.visible=!0,this.dialog.title=s.fileName},doChangeModelContent(s){this.file_content=s}}},S=N,i=u(68141),r=(0,i.Z)(S,w,I,!1,null,"bbbc6770",null),a=r.exports,l=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"my-dialog-class",attrs:{"append-to-body":!0,"modal-append-to-body":!0,"close-on-click-modal":!1,visible:e.dialog.visible,width:"800px"},on:{"update:visible":function(o){return e.$set(e.dialog,"visible",o)}}},[t("div",{staticClass:"tab-button-list",attrs:{slot:"title"},slot:"title"},[t("el-radio-group",{attrs:{size:"mini"},model:{value:e.usedShow,callback:function(o){e.usedShow=o},expression:"usedShow"}},[t("el-radio-button",{attrs:{label:"board"}},[e._v("\u770B\u677F")]),t("el-radio-button",{attrs:{label:"query"}},[e._v("\u67E5\u8BE2\u5217\u8868")])],1)],1),t("div",[t("resource-use-board",{directives:[{name:"show",rawName:"v-show",value:e.usedShow=="board",expression:"usedShow == 'board'"}],ref:"use_board"}),t("resource-use-query",{directives:[{name:"show",rawName:"v-show",value:e.usedShow=="query",expression:"usedShow == 'query'"}],ref:"use_query"})],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(o){e.dialog.visible=!1}}},[e._v("\u5173 \u95ED")])],1)])],1)},f=[],m=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400","span-method":e.objectSpanMethod,border:""}},[t("el-table-column",{attrs:{prop:"queryListName",label:"\u67E5\u8BE2\u5217\u8868\u540D\u79F0"}}),t("el-table-column",{attrs:{prop:"publishName",label:"\u53D1\u5E03\u7248\u672C\u540D\u79F0"}}),t("el-table-column",{attrs:{prop:"publishTypeName",label:"\u7248\u672C\u7C7B\u578B"}})],1)],1)},F=[],x=u(45890),R=u(49500),T={name:"resource-use-query",data(){return{position:0,rowSpanArr:[],tableData:[]}},methods:{initTableData(s){x.j.getQueryResourceListByResId(s).then(e=>{e&&e.status==200?(this.tableData=e.data,this.getRowSpan()):n.Message.error({message:e.msg,offset:60})})},getRowSpan(){this.rowSpanArr=[],this.tableData.forEach((s,e)=>{s.publishType&&(s.publishTypeName=this.$$global.editType[s.publishType].name),e==0?(this.rowSpanArr.push(1),this.position=0):this.tableData[e].publishName&&this.tableData[e-1].publishName&&this.tableData[e].publishName==this.tableData[e-1].publishName?(this.rowSpanArr[this.position]+=1,this.rowSpanArr.push(0),this.tableData[e].publishName=this.tableData[e-1].publishName):(this.rowSpanArr.push(1),this.position=e)})},objectSpanMethod({row:s,column:e,rowIndex:t,columnIndex:o}){if(R.debug(s),R.debug(e),o===0||o===1)return{rowspan:this.rowSpanArr[t],colspan:1}}}},$=T,M=(0,i.Z)($,m,F,!1,null,"fb6f4a28",null),z=M.exports,A=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400","span-method":e.objectSpanMethod,border:""}},[t("el-table-column",{attrs:{prop:"boardName",label:"\u770B\u677F\u540D\u79F0"}}),t("el-table-column",{attrs:{prop:"publishName",label:"\u53D1\u5E03\u7248\u672C\u540D\u79F0"}}),t("el-table-column",{attrs:{prop:"publishTypeName",label:"\u7248\u672C\u7C7B\u578B"}})],1)],1)},G=[],D=u(49500),B={name:"resource-use-board",data(){return{position:0,rowSpanArr:[],tableData:[]}},methods:{initTableData(s){x.j.getBoardResourceListByResId(s).then(e=>{e&&e.status==200?(this.tableData=e.data,this.getRowSpan()):n.Message.error({message:e.msg,offset:60})})},getRowSpan(){this.rowSpanArr=[],this.tableData.forEach((s,e)=>{s.publishType&&(s.publishTypeName=this.$$global.editType[s.publishType].name),e==0?(this.rowSpanArr.push(1),this.position=0):this.tableData[e].publishName&&this.tableData[e-1].publishName&&this.tableData[e].publishName==this.tableData[e-1].publishName?(this.rowSpanArr[this.position]+=1,this.rowSpanArr.push(0),this.tableData[e].publishName=this.tableData[e-1].publishName):(this.rowSpanArr.push(1),this.position=e)})},objectSpanMethod({row:s,column:e,rowIndex:t,columnIndex:o}){if(D.debug(s),D.debug(e),o===0||o===1)return{rowspan:this.rowSpanArr[t],colspan:1}}}},L=B,j=(0,i.Z)(L,A,G,!1,null,"23dddb40",null),O=j.exports,U={name:"resource-use",components:{ResourceUseBoard:O,ResourceUseQuery:z},data(){return{dialog:{width:0,height:0,visible:!1},usedShow:"board"}},mounted(){this.dialog.height=window.innerHeight-140,this.dialog.width=window.innerWidth-40},methods:{openShow(s){this.dialog.visible=!0,this.$nextTick(()=>{this.$refs.use_board.initTableData(s.fileId),this.$refs.use_query.initTableData(s.fileId)})}}},P=U,q=(0,i.Z)(P,l,f,!1,null,"d83c1b08",null),V=q.exports,W={name:"resource-container-text",components:{ResourceUse:V,ResourceContainerDialog:a},props:{resource_type:{type:Object,default:()=>({})},isSelect:{type:Boolean,default:()=>!1},isDialog:{type:Boolean,default:()=>!1},selectedIds:{type:Array,default:()=>[]}},data(){return{loading:!1,dialogVisible:!1,groupId:null,keyWords:null,tableData:[],currentRow:{},pageName:1,pageSize:10,total:0,marginTop:0,popoverData:{},clickRow:{}}},computed:{...(0,c.Se)(["responseHeaders","getApplication"]),height(){return document.documentElement.clientHeight}},watch:{getApplication:{deep:!0,handler:function(){this.groupId=null,this.initData()}},resource_type:{deep:!0,handler:function(){this.groupId=null,this.initData()}}},mounted(){this.initData()},methods:{initList(s){this.pageName=1,this.groupId=s,this.initData()},initData(){this.currentRow={},this.tableData=[];let s={pageName:this.pageName,pageSize:this.pageSize,resourceFile:JSON.stringify({applicationId:this.getApplication.applicationId,groupId:this.groupId,restypeId:this.resource_type.restypeId,fileName:this.keyWords})};this.loading=!0,p.getListByPage(s).then(e=>{this.loading=!1,e&&e.status==200?(this.tableData=e.data.list,this.total=e.data.total):n.Message.error({message:e.msg,offset:60})})},handleCurrentChange(s){this.pageName=s,this.initData()},handleRowClick(s,e){e.label!="\u64CD\u4F5C"&&(this.$$lib__.contains(this.selectedIds,s.fileId)?(this.currentRow="",this.isSelectRow(),n.Message.warning({message:"\u8BE5\u8D44\u6E90\u5DF2\u88AB\u9009\u62E9\uFF01",offset:60})):this.isClickSameRow&&this.isClickSameRow==s.fileId?(this.currentRow="",this.isClickSameRow=""):(this.currentRow=s,this.isClickSameRow=s.fileId))},handleSelectRow(s){s&&(this.$$lib__.contains(this.selectedIds,s.fileId)?n.Message.warning({message:"\u8BE5\u8D44\u6E90\u5DF2\u88AB\u9009\u62E9\uFF01",offset:60}):this.currentRow=s)},confirmRow(){this.isSelectRow()?this.$emit("selectRow",this.currentRow):n.Message.warning({message:"\u6CA1\u6709\u9009\u62E9\u4EFB\u4F55\u8D44\u6E90\uFF01",offset:60})},cancelRow(){this.$emit("unSelectRow",this.currentRow)},clickAdd(){this.$refs.ref_resource_container_dialog.openAdd(this.groupId)},clickUpload(s){this.clickRow=JSON.parse(JSON.stringify(s))},clickDownload(s){p.download(s.fileId).then(e=>{if(!e)return;let t=this.responseHeaders["content-disposition"],o=new Blob([e]),d=window.URL.createObjectURL(o);if(t){let k=window.decodeURI(t.split("=")[1]);const C=document.createElement("a");C.href=d,C.download=k,C.click(),URL.revokeObjectURL(d)}else window.location.href=d})},clickEditor(s){this.$refs.ref_resource_container_dialog.openEditor(s,this.resource_type.restypeCode)},clickUse(s){this.$refs.ref_resource_use.openShow(s)},clickDelete(s){this.$confirm("\u5C06\u5220\u9664\u201C"+s.fileName+"\u201D\u8D44\u6E90\u6587\u4EF6\uFF0C\u786E\u8BA4\u6267\u884C\u6B64\u64CD\u4F5C\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",customClass:"deleteBoardC"}).then(()=>{p.delete(s.fileId).then(e=>{e&&e.status==200?(n.Message.success({message:"\u5220\u9664\u6210\u529F",offset:60}),this.initData()):n.Message.error({message:e.msg,offset:60})})}).catch(()=>{n.Message.info({message:"\u5DF2\u53D6\u6D88\u5220\u9664",offset:60})})},clickButton(){this.pageName=1,this.initData()},changeIsApplicationFile(s){let e={fileId:s.fileId,isApplicationFile:s.isApplicationFile==!0?1:0};p.updateInfo(e).then(t=>{(!t||t.status!=200)&&n.Message.error({message:t.msg,offset:60})})},rowNumber(s){return(this.pageName-1)*this.pageSize+s.$index+1},formatter(s){return this.formatDate(s.createdTime)},formatterSize(s){let e=s.fileSize;if(e<900)return e+" B";if(e=(e/1024).toFixed(2),e<900)return e+" KB";if(e=(e/1024).toFixed(2),e<900)return e+" MB";if(e=(e/1024).toFixed(2),e<900)return e+" GB"},formatDate(s){return v.formatDate(new Date(s),"")},beforeAvatarUpload(s){let e=s.name;const t=this.resource_type.restypeType.toLowerCase().indexOf(s.type.toLowerCase())>-1;return t||n.Message.error({message:e+"\u6587\u4EF6\u7C7B\u578B\u9519\u8BEF!\u8BF7\u4E0A\u4F20["+this.resource_type.restypeType+"]\u4E2D\u7684\u7C7B\u578B\u6587\u4EF6",offset:60}),t},beforeUpload(s){let e=this.beforeAvatarUpload(s);return e&&this.clickRow.fileName!=s.name&&(n.Message.error({message:"\u9009\u62E9\u7684\u6587\u4EF6[ "+s.name+" ]\u4E0E\u5F53\u524D\u6587\u4EF6[ "+this.clickRow.fileName+" ]\u4E0D\u540C\u540D\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9\uFF01",offset:60}),e=!1),e},myUpload(s){let e=new FormData;e.append("file",s.file),this.loading=!0,p.uploadMultipartFile(this.resource_type.restypeId,this.groupId,e).then(t=>{this.loading=!1,t&&t.status==200?(n.Message.success({message:"\u8D44\u6E90\u6587\u4EF6\u4E0A\u4F20\u6210\u529F",offset:60}),this.initData()):n.Message.error({message:"\u8D44\u6E90\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"+t.msg,offset:60})})},uploadFile(s){let e=new FormData;e.append("file",s.file),e.append("resourceFile",JSON.stringify({fileId:this.clickRow.fileId})),this.loading=!0,p.saveFile(e).then(t=>{this.loading=!1,t&&t.status==200?(n.Message.success({message:"\u66F4\u65B0\u6210\u529F",offset:60}),this.initData()):n.Message.error({message:"\u66F4\u65B0\u5931\u8D25"+t.msg,offset:60})})},isSelectRow(){return!this.$$lib__.isEmpty(this.currentRow)},tableRowClassName({row:s}){if(this.isSelect==!0)return this.$$lib__.contains(this.selectedIds,s.fileId)?"unable-select":this.currentRow&&this.currentRow.fileId==s.fileId?"current-select":"enable-select"},isShowSelected(s){return this.isSelect==!0?this.$$lib__.contains(this.selectedIds,s.fileId)?!0:!!(this.currentRow&&this.currentRow.fileId==s.fileId):!1}}},Z=W,J=(0,i.Z)(Z,b,y,!1,null,"fda8a942",null),K=J.exports}}]);
