(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[36],{4686:function(dt,Q,o){"use strict";o.r(Q)},46057:function(dt,Q,o){"use strict";o.r(Q)},41775:function(dt,Q,o){"use strict";var O=o(29870),n=o(85208),a=o(59791),t=o(22466),e=o(83393),i=o(5077),f=o(87879),I=o(19534);Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var j=I(o(28866)),b=I(o(42579)),R=I(o(43389)),q=I(o(22777)),K=I(o(42762));o(4686),o(46057);var $=X(o(25074)),G=I(o(68119)),_=o(39705),W=o(95031),c=o(59269),M=I(o(56865));function F(H){if(typeof f!="function")return null;var V=new f,m=new f;return(F=function(r){return r?m:V})(H)}function X(H,V){if(!V&&H&&H.__esModule)return H;if(H===null||O(H)!=="object"&&typeof H!="function")return{default:H};var m=F(V);if(m&&m.has(H))return m.get(H);var D={},r=Object.defineProperty&&e;for(var s in H)if(s!=="default"&&Object.prototype.hasOwnProperty.call(H,s)){var d=r?e(H,s):null;d&&(d.get||d.set)?Object.defineProperty(D,s,d):D[s]=H[s]}return D.default=H,m&&m.set(H,D),D}function k(H,V){var m=n(H);if(a){var D=a(H);V&&(D=t(D).call(D,function(r){return e(H,r).enumerable})),m.push.apply(m,D)}return m}function ht(H){for(var V=1;V<arguments.length;V++){var m=arguments[V]!=null?arguments[V]:{};V%2?k(Object(m),!0).forEach(function(D){(0,R.default)(H,D,m[D])}):i?Object.defineProperties(H,i(m)):k(Object(m)).forEach(function(D){Object.defineProperty(H,D,e(m,D))})}return H}var Y=function(){function H(V){var m=this,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,q.default)(this,H);var r=D.center,s=r===void 0?[111.7579,31.6736]:r,d=D.height,x=d===void 0?614914256e-2:d,N=D.projection,u=N===void 0?"EPSG:4490":N,B=D.heading,z=B===void 0?0:B,rt=D.roll,pt=rt===void 0?0:rt,ut=D.pitch,gt=ut===void 0?-90:ut,lt=(0,j.default)(D),Ct=D.duration,mt=(0,_.transformCoordinate)(s,u,"EPSG:4490"),It=ht(ht({},W.earthDefaultConfig),{},{center:{heading:z,roll:pt,x:mt[0],y:mt[1],z:x,pitch:gt},duration:Ct});$.Map.createMap({id:V,data:It,map2d:lt,is2d:lt?1:2,success:function(ct){(0,b.default)(this,m),this.viewer=ct}.bind(this)}),this.layerManager=this.viewer.shine.layerManager}return(0,K.default)(H,[{key:"maskGeoJson",get:function(){return this.viewer.maskGeoJson},set:function(m){this.viewer.maskGeoJson=m}},{key:"resize",value:function(){this.viewer.forceResize()}},{key:"centerAt",value:function(m){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=D.duration,s=D.projection,d=s===void 0?"EPSG:4490":s,x=this.viewer.shine.getCameraView(!0),N=x.x,u=x.y,B=x.z,z=x.heading,rt=x.roll,pt=x.pitch,ut=m.center,gt=ut===void 0?[N,u]:ut,lt=m.height,Ct=lt===void 0?B:lt,mt=m.heading,It=mt===void 0?z:mt,$t=m.roll,ct=$t===void 0?rt:$t,xt=m.pitch,wt=xt===void 0?pt:xt,Et=(0,_.transformCoordinate)(gt,d,"EPSG:4490");this.viewer.shine.centerAt({x:Et[0],y:Et[1],z:Ct,heading:It,roll:ct,pitch:wt},{duration:r!=null?r/1e3:void 0,isWgs84:!0})}},{key:"setExtent",value:function(m){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=D.duration,s=D.projection,d=s===void 0?"EPSG:4490":s,x=m;d!=="EPSG:4490"&&(x=(0,_.transformExtent)(m,d,"EPSG:4490"));var N={xmin:x[0],ymin:x[1],xmax:x[2],ymax:x[3]};this.viewer.shine.centerAt(N,{duration:r!=null?r/1e3:void 0,isWgs84:!0})}},{key:"getExtent",value:function(){var m=this.viewer.shine.getExtent(!0);return[m.xmin,m.ymin,m.xmax,m.ymax]}},{key:"getCenter",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.x,r=m.y;return[D,r]}},{key:"getHeight",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.z;return D}},{key:"getZoom",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.z,r=this.viewer.shine.getLevel(D);return r}},{key:"getOrientation",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.heading,r=m.roll,s=m.pitch;return{heading:D,roll:r,pitch:s}}},{key:"getProjection",value:function(){return"EPSG:4490"}},{key:"addLayer",value:function(m){m.visible=!0,this.viewer.shine.addLayer(m)}},{key:"createDrawLayer",value:function(m){m.visible=!0,m.type="geojson-draw",m.drawLayerType||(m.drawLayerType=c.DRAWLAYER_TYPE),this.viewer.shine.addLayer(m)}},{key:"removeLayer",value:function(m){this.viewer.shine.removeLayer(m)}},{key:"getViewer",value:function(){return this.viewer}},{key:"olcs3dUpdate",value:function(){this.viewer.shine.ol3d.update()}},{key:"groundUnder",value:function(m){this.viewer.shine.groundUnder(m)}},{key:"groundTranslucency",value:function(m){this.viewer.shine.groundTranslucency(m)}},{key:"useTranslucencyRectangle",value:function(m){this.viewer.shine.useTranslucencyRectangle(m)}},{key:"getContainer",value:function(){return this.viewer.container}},{key:"createPopup",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=new G.default(this,m);return D}},{key:"performVideoProjection",value:function(m){this.videoProjection=new M.default(this,m),this.videoProjection.execute()}},{key:"destroyVideoProjection",value:function(){var m;(m=this.videoProjection)===null||m===void 0||m.destroy(),this.videoProjection=null}}]),H}(),it=Y;Q.default=it},68119:function(dt,Q,o){"use strict";var O=o(19534);Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var n=O(o(22777)),a=O(o(42762)),t=o(96789),e=function(){function f(I,j){(0,n.default)(this,f),this.earth=I,this.earthPopup=new t.DivPoint(this.earth.viewer,{html:j.element,offset:j.offset})}return(0,a.default)(f,[{key:"setPosition",value:function(j){this.earthPopup.setLonlat(j)}},{key:"destroy",value:function(){this.earthPopup.destroy()}}]),f}(),i=e;Q.default=i},85002:function(dt,Q,o){"use strict";var O=o(19534);Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var n=O(o(22777)),a=O(o(42762)),t=o(15998),e=function(){function f(I){(0,n.default)(this,f),this.weather=new t.Weather(I.viewer)}return(0,a.default)(f,[{key:"rain",value:function(j){j=Number(j),j===0?this.weather.removeRainStage():this.weather.rainfall(j)}},{key:"snow",value:function(j){j=Number(j),j===0?this.weather.removeSnowStage():this.weather.snowfall(j)}},{key:"removeAll",value:function(){this.weather.removeStage()}}]),f}(),i=e;Q.default=i},21120:function(dt,Q,o){var O=o(49500);dt.exports=function(n){var a={};function t(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return n[e].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=a,t.d=function(e,i,f){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:f})},t.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(i&1&&(e=t(e)),i&8||i&4&&typeof e=="object"&&e&&e.__esModule)return e;var f=Object.create(null);if(t.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:e}),i&2&&typeof e!="string")for(var I in e)t.d(f,I,function(j){return e[j]}.bind(null,I));return f},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="/dist/",t(t.s=767)}({0:function(n,a){n.exports=o(42579)},1:function(n,a){n.exports=o(28866)},10:function(n,a){n.exports=o(42762)},11:function(n,a){n.exports=o(20314)},2:function(n,a,t){"use strict";t.d(a,"a",function(){return e});function e(i,f,I,j,b,R,q,K){var $=typeof i=="function"?i.options:i;f&&($.render=f,$.staticRenderFns=I,$._compiled=!0),j&&($.functional=!0),R&&($._scopeId="data-v-"+R);var G;if(q?(G=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),b&&b.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(q)},$._ssrRegister=G):b&&(G=K?function(){b.call(this,($.functional?this.parent:this).$root.$options.shadowRoot)}:b),G)if($.functional){$._injectStyles=G;var _=$.render;$.render=function(M,F){return G.call(F),_(M,F)}}else{var W=$.beforeCreate;$.beforeCreate=W?[].concat(W,G):[G]}return{exports:i,options:$}}},24:function(n,a){n.exports=o(52909)},27:function(n,a){n.exports=o(78756)},37:function(n,a){n.exports=o(59602)},39:function(n,a){n.exports=o(26352)},4:function(n,a){n.exports=o(55616)},40:function(n,a){n.exports=o(40639)},41:function(n,a){n.exports=o(43586)},45:function(n,a){n.exports=o(11323)},46:function(n,a){n.exports=o(69257)},47:function(n,a){n.exports=o(10563)},5:function(n,a){n.exports=o(5146)},56:function(n,a){n.exports=o(34749)},64:function(n,a){n.exports=o(28954)},767:function(n,a,t){"use strict";t.r(a),t.d(a,"ConfigManager",function(){return mt}),t.d(a,"ConfigManagerGt",function(){return A});var e=function(){var p=this,S=p.$createElement,h=p._self._c||S;return h("div",{staticClass:"sh-config-provider"},[p.loading?h("div",{staticClass:"loading"},[p._t("loading",function(){return[h("div",{directives:[{name:"loading",rawName:"v-loading",value:p.loading,expression:"loading"}],staticClass:"default-loading"})]})],2):p._e(),p.loading?p._e():p._t("default")],2)},i=[];e._withStripped=!0;var f=t(0),I=t.n(f),j=t(11),b=t.n(j),R=t(39),q=t.n(R),K=t(40),$=t.n(K),G=t(41),_=t.n(G),W=t(56),c=t.n(W),M=t(9),F=t.n(M),X=t(10),k=t.n(X),ht=t(45),Y=t.n(ht),it=t(27),H=t.n(it),V=t(24),m=t.n(V),D=t(5),r=t.n(D),s=t(64),d=t.n(s),x=t(1),N=t.n(x),u=t(8),B=t.n(u),z=t(37),rt=t(47);function pt(p,S){var h=typeof $.a<"u"&&_()(p)||p["@@iterator"];if(!h){if(Array.isArray(p)||(h=ut(p))||S&&p&&typeof p.length=="number"){h&&(p=h);var g=0,L=function(){};return{s:L,n:function(){return g>=p.length?{done:!0}:{done:!1,value:p[g++]}},e:function(tt){throw tt},f:L}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,E=!1,Z;return{s:function(){h=h.call(p)},n:function(){var tt=h.next();return v=tt.done,tt},e:function(tt){E=!0,Z=tt},f:function(){try{!v&&h.return!=null&&h.return()}finally{if(E)throw Z}}}}function ut(p,S){var h;if(p){if(typeof p=="string")return gt(p,S);var g=b()(h=Object.prototype.toString.call(p)).call(h,8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return q()(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return gt(p,S)}}function gt(p,S){(S==null||S>p.length)&&(S=p.length);for(var h=0,g=new Array(S);h<S;h++)g[h]=p[h];return g}function lt(p){return"sh-".concat(Object(rt.formatConversion)(p))}var Ct=function(){function p(S,h,g){var L=g.token,v=g.applicationId;F()(this,p),this.url=S,this.params=h,this.schemeId=h.schemeId,this.token=L,this.applicationId=v,this.isLoading=!1,this.widgetInfo=void 0,h&&(this.promise_=this._request())}return k()(p,[{key:"_request",value:function(){var h=this;return new H.a(function(g,L){var v=this;I()(this,h),Object(z.getFromAdmin)(this.url,{params:this.params,token:this.token,applicationId:this.applicationId}).then(function(E){I()(this,v);var Z=Object(z.parseResult)(E);if(Z.success){var w=this._parseWidgetInfo(Z.data);w.schemeId&&(this.schemeId=w.schemeId),g(w)}else L(Z.message)}.bind(this)).catch(function(E){I()(this,v),L(E)}.bind(this))}.bind(this))}},{key:"_parseWidgetInfo",value:function(h){var g,L=this,v,E=h,Z=m()(g=E.components).call(g,function(tt){return I()(this,L),tt.name==="ToolBar"}.bind(this));if(Z){var w=this.getTreeData(E.components,Z.id);Z.stat=!!w.length,Z.config=w}return E.components=r()(v=E.components).call(v,[{stat:!0,name:"Map"},{stat:!0,name:"Earth"},{stat:!0,name:"MapEarth"}]),E}},{key:"getWidgetInfos",value:function(){var S=c()(Y.a.mark(function g(){return Y.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.widgetInfo){v.next=12;break}if(!this.promise_){v.next=12;break}return v.prev=2,v.next=5,this.promise_;case 5:this.widgetInfo=v.sent,v.next=12;break;case 8:throw v.prev=8,v.t0=v.catch(2),O.error(v.t0),new Error(v.t0);case 12:return v.abrupt("return",this.widgetInfo?this.widgetInfo:{});case 13:case"end":return v.stop()}},g,this,[[2,8]])}));function h(){return S.apply(this,arguments)}return h}()},{key:"getConfigByKey",value:function(){var S=c()(Y.a.mark(function g(L){var v,E,Z,w;return Y.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.getWidgetInfos();case 2:if(v=C.sent,!v.config){C.next=23;break}E=pt(v.config),C.prev=5,E.s();case 7:if((Z=E.n()).done){C.next=13;break}if(w=Z.value,w.key!==L){C.next=11;break}return C.abrupt("return",w.value);case 11:C.next=7;break;case 13:C.next=18;break;case 15:C.prev=15,C.t0=C.catch(5),E.e(C.t0);case 18:return C.prev=18,E.f(),C.finish(18);case 21:C.next=24;break;case 23:return C.abrupt("return","");case 24:case"end":return C.stop()}},g,this,[[5,15,18,21]])}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getWidgetInfoByTag",value:function(){var S=c()(Y.a.mark(function g(L){var v,E=this,Z,w,tt;return Y.a.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return at.next=2,this.getWidgetInfos();case 2:return Z=at.sent,w={stat:!1,data:{}},tt=Z==null||(v=Z.components)===null||v===void 0?void 0:m()(v).call(v,function(et){return I()(this,E),et.name===L}.bind(this)),tt&&(w.stat=tt.stat,w.data=tt,L==="LayerManager"&&(w.data.layersInfo=this.widgetInfo.tocs)),at.abrupt("return",w);case 7:case"end":return at.stop()}},g,this)}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getTreeData",value:function(h){var g=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v={};if(h.forEach(function(C){I()(this,g),v[C.id]=C}.bind(this)),L){var w,tt;return d()(w=N()(tt=B()(h).call(h,function(C){return I()(this,g),C.parentId===L}.bind(this))).call(tt,function(C){I()(this,g);var at={key:lt(C.name),name:C.label,sort:d()(C)},et=this.getTreeData(h,C.id);return et.length&&(at.children=et),at}.bind(this))).call(w,function(C,at){return I()(this,g),d()(C)-d()(at)}.bind(this))}else{var E,Z;return d()(E=N()(Z=B()(h).call(h,function(C){return I()(this,g),!v[C.parent]}.bind(this))).call(Z,function(C){I()(this,g);var at={key:lt(C.name),name:C.label,sort:d()(C)},et=this.getTreeData(h,C.id);return et.length&&(at.children=et),at}.bind(this))).call(E,function(C,at){return I()(this,g),d()(C)-d()(at)}.bind(this))}}}],[{key:"getInstance",value:function(h,g,L){var v=L.token,E=L.applicationId;return p.instance||(p.instance=new p(h,g,{token:v,applicationId:E})),p.instance}}]),p}(),mt=Ct,It=t(46),$t=t.n(It),ct=t(4);function xt(p,S){var h=typeof $.a<"u"&&_()(p)||p["@@iterator"];if(!h){if(Array.isArray(p)||(h=wt(p))||S&&p&&typeof p.length=="number"){h&&(p=h);var g=0,L=function(){};return{s:L,n:function(){return g>=p.length?{done:!0}:{done:!1,value:p[g++]}},e:function(tt){throw tt},f:L}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,E=!1,Z;return{s:function(){h=h.call(p)},n:function(){var tt=h.next();return v=tt.done,tt},e:function(tt){E=!0,Z=tt},f:function(){try{!v&&h.return!=null&&h.return()}finally{if(E)throw Z}}}}function wt(p,S){var h;if(p){if(typeof p=="string")return Et(p,S);var g=b()(h=Object.prototype.toString.call(p)).call(h,8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return q()(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Et(p,S)}}function Et(p,S){(S==null||S>p.length)&&(S=p.length);for(var h=0,g=new Array(S);h<S;h++)g[h]=p[h];return g}var P=function(){function p(S,h){F()(this,p),this.url=S,this.params=h,this.token=h.token,this.isLoading=!1,this.widgetInfo=void 0,h&&(this.promise_=this._request(S,h))}return k()(p,[{key:"_request",value:function(h,g){var L=this;return new H.a(function(v){var E=this;I()(this,L),Object(z.get)(h,g).then(function(Z){if(I()(this,E),Z.code===200){var w=this._parseWidgetInfo(Z.data);v(w)}else Z.code===201&&Object(ct.Message)("\u8BF7\u68C0\u67E5\u56FD\u571F\u5E73\u53F0\u767B\u5F55\u7684token"),v({})}.bind(this)),this.params.schemeId=this.params.resourceApplicationId}.bind(this))}},{key:"_parseWidgetInfo",value:function(h){var g=$t()({},h);if(h.components){g.components={};var L=xt(h.components),v;try{for(L.s();!(v=L.n()).done;){var E=v.value;E.code==="BaseMap"&&(E.code="23D-base-map"),g.components[E.code]=E}}catch(Z){L.e(Z)}finally{L.f()}}return h.componentDir&&(g.components.ToolBar={stat:JSON.parse(h.componentDir)[0].isShowToolbar,name:"ToolBar",config:h.componentDir}),g}},{key:"getWidgetInfos",value:function(){var S=c()(Y.a.mark(function g(){var L,v,E;return Y.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.widgetInfo){w.next=11;break}if(!this.promise_){w.next=11;break}return w.next=4,this.promise_;case 4:this.widgetInfo=w.sent,this.widgetInfo.components.map={stat:!0,name:"map"},this.widgetInfo.components.earth={stat:!0,name:"earth"},this.widgetInfo.components.mapEarth={stat:!0,name:"mapEarth"},this.widgetInfo.config=[],this.widgetInfo.custom&&this.widgetInfo.custom.length>0?this.treeConvertToArr(this.widgetInfo.custom):this.widgetInfo.already&&this.widgetInfo.already.length>0&&this.treeConvertToArr(this.widgetInfo.already),(L=this.widgetInfo)!==null&&L!==void 0&&(v=L.application)!==null&&v!==void 0&&v.basicConfiguration&&(E=JSON.parse(this.widgetInfo.application.basicConfiguration),this.widgetInfo.config.push({key:"spatial_data_governance",value:E.GovernAddress}));case 11:return w.abrupt("return",this.widgetInfo?this.widgetInfo:{});case 12:case"end":return w.stop()}},g,this)}));function h(){return S.apply(this,arguments)}return h}()},{key:"getConfigByKey",value:function(){var S=c()(Y.a.mark(function g(L){var v,E,Z,w;return Y.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.getWidgetInfos();case 2:if(v=C.sent,!v.config){C.next=23;break}E=xt(v.config),C.prev=5,E.s();case 7:if((Z=E.n()).done){C.next=13;break}if(w=Z.value,w.key!==L){C.next=11;break}return C.abrupt("return",w.value);case 11:C.next=7;break;case 13:C.next=18;break;case 15:C.prev=15,C.t0=C.catch(5),E.e(C.t0);case 18:return C.prev=18,E.f(),C.finish(18);case 21:C.next=24;break;case 23:return C.abrupt("return","");case 24:case"end":return C.stop()}},g,this,[[5,15,18,21]])}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getWidgetInfoByTag",value:function(){var S=c()(Y.a.mark(function g(L){var v,E,Z,w,tt,C;return Y.a.wrap(function(et){for(;;)switch(et.prev=et.next){case 0:return et.next=2,this.getWidgetInfos();case 2:if(v=et.sent,E={stat:!0,data:{}},!(v!=null&&v.components)){et.next=31;break}if(!v.config){et.next=26;break}Z="",w=xt(v.config),et.prev=8,w.s();case 10:if((tt=w.n()).done){et.next=17;break}if(C=tt.value,C.key!=="spatial_data_governance"){et.next=15;break}return Z=C.value,et.abrupt("break",17);case 15:et.next=10;break;case 17:et.next=22;break;case 19:et.prev=19,et.t0=et.catch(8),w.e(et.t0);case 22:return et.prev=22,w.f(),et.finish(22);case 25:L==="FileImport"?v.components[L].url=Z+"geofile/import":L==="FileExport"&&(v.components[L].url=Z+"geofile/export");case 26:E.data=v.components[L],L==="Toc"&&(E.data.layersInfo=this.flatLayerdata),E.stat=!0,et.next=32;break;case 31:E.stat=!0;case 32:return et.abrupt("return",E);case 33:case"end":return et.stop()}},g,this,[[8,19,22,25]])}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getSchemeById",value:function(){var S=c()(Y.a.mark(function g(L){var v=this,E,Z,w;return Y.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.getWidgetInfoByTag("LayerScheme");case 2:return Z=C.sent,Z.stat&&(w=JSON.parse(Z.data.config),E=m()(w).call(w,function(at){return I()(this,v),at.id===L}.bind(this))),C.abrupt("return",E);case 5:case"end":return C.stop()}},g,this)}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getMaskOptions",value:function(){var S=c()(Y.a.mark(function g(){var L,v,E;return Y.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.getWidgetInfoByTag("Mask");case 2:return v=w.sent,v.stat&&v.data.config&&(E=JSON.parse(v.data.config),L={layer:{url:E.url,visibleLayers:E.layerName,selectLayer:E.layerName,type:E.type},where:E.where}),w.abrupt("return",L);case 5:case"end":return w.stop()}},g,this)}));function h(){return S.apply(this,arguments)}return h}()},{key:"treeConvertToArr",value:function(h){this.flatLayerdata=[],this.baseLayerIds=[],this.recursionFun(h)}},{key:"recursionFun",value:function(h){var g=this;h.forEach(function(L){I()(this,g),L.authkey=JSON.parse(sessionStorage.getItem("authkeytoken")),this.flatLayerdata.push(L),L.isBaseLayer&&this.baseLayerIds.push(L.id),L.child&&L.child.length>0&&this.recursionFun(L.child)}.bind(this))}}],[{key:"getInstance",value:function(h,g){return p.instance||(p.instance=new p(h,g)),p.instance}}]),p}(),A=P,U={name:"ShConfigProvider",provide:function(){var S=this;return{reactiveConfigInstance:function(){return I()(this,S),this.configInstance}.bind(this),reactiveShinegaUrl:function(){return I()(this,S),this.realShinegaUrl}.bind(this),reactiveShinegaDatabaseId:function(){return I()(this,S),this.realShinegaDatabaseId}.bind(this),token:this.token,generalCardThemeStyle:this.generalCardThemeStyle,generalBarThemeStyle:this.generalBarThemeStyle,shinegaInitData:this.shinegaInitData,fastApplicationId:this.fastApplicationId,publishId:this.publishId}},props:{url:{type:String},schemeId:{type:String},type:{type:String,default:"clientAdmin"},applicationId:{type:String},shinegaUrl:{type:String},shinegaDatabaseId:{type:String},token:{type:String},generalCardThemeStyle:{type:Object},generalBarThemeStyle:{type:Object},shinegaInitData:{type:Object},fastApplicationId:{type:String},publishId:{type:String},delay:{type:Number,default:0}},data:function(){return{loading:!1,configInstanceShinegaUrl:"",configInstanceShinegaDatabaseId:""}},computed:{configParams:function(){var S=this.$props,h=S.type,g=S.url,L=S.applicationId,v=S.token,E=S.schemeId;return{type:h,url:g,applicationId:L,token:v,schemeId:E}},configInstance:function(){if(this.type&&this.url)if(this.type==="geoplat"){var S=this.$props,h=S.url,g=S.applicationId,L=S.token;return new A(h,{resourceApplicationId:g,"X-Gisq-Token":L})}else{var v=this.$props,E=v.url,Z=v.schemeId,w=v.token,tt=v.fastApplicationId,C={schemeId:Z,id:this.publishId};return new mt(E,C,{token:w,applicationId:tt})}return null},realShinegaUrl:function(){return this.shinegaUrl?this.shinegaUrl:this.configInstanceShinegaUrl},realShinegaDatabaseId:function(){return this.shinegaDatabaseId?this.shinegaDatabaseId:this.configInstanceShinegaDatabaseId}},watch:{configParams:function(){this.executeRequest()}},mounted:function(){this.executeRequest()},methods:{executeRequest:function(){var S=this;this.configInstance&&(this.loading=!0,this.configInstance.getWidgetInfos().then(function(h){var g,L,v=this;I()(this,S),this.configInstanceShinegaUrl=(g=h.mapConfig)===null||g===void 0?void 0:g.spatial_data_governance,this.configInstanceShinegaDatabaseId=(L=h.mapConfig)===null||L===void 0?void 0:L.spatial_database_id,setTimeout(function(){I()(this,v),this.loading=!1}.bind(this),this.delay)}.bind(this)).catch(function(h){I()(this,S),this.$emit("error",h),ct.Message.error("\u83B7\u53D6\u8FD0\u7EF4\u7AEF\u6570\u636E\u5931\u8D25:"+h.message)}.bind(this)))}}},nt=U,yt=t(2),ft=Object(yt.a)(nt,e,i,!1,null,null,null),St=ft.exports;St.install=function(p){p.component(St.name,St)};var Tt=a.default=St},8:function(n,a){n.exports=o(22466)},9:function(n,a){n.exports=o(22777)}})},99497:function(dt,Q,o){dt.exports=function(O){var n={};function a(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return O[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}return a.m=O,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(e&1&&(t=a(t)),e&8||e&4&&typeof t=="object"&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),e&2&&typeof t!="string")for(var f in t)a.d(i,f,function(I){return t[I]}.bind(null,f));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/dist/",a(a.s=772)}({0:function(O,n){O.exports=o(42579)},102:function(O,n){O.exports=o(70017)},103:function(O,n){O.exports=o(60706)},17:function(O,n){O.exports=o(85208)},18:function(O,n){O.exports=o(59791)},19:function(O,n){O.exports=o(83393)},2:function(O,n,a){"use strict";a.d(n,"a",function(){return t});function t(e,i,f,I,j,b,R,q){var K=typeof e=="function"?e.options:e;i&&(K.render=i,K.staticRenderFns=f,K._compiled=!0),I&&(K.functional=!0),b&&(K._scopeId="data-v-"+b);var $;if(R?($=function(W){W=W||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!W&&typeof __VUE_SSR_CONTEXT__<"u"&&(W=__VUE_SSR_CONTEXT__),j&&j.call(this,W),W&&W._registeredComponents&&W._registeredComponents.add(R)},K._ssrRegister=$):j&&($=q?function(){j.call(this,(K.functional?this.parent:this).$root.$options.shadowRoot)}:j),$)if(K.functional){K._injectStyles=$;var G=K.render;K.render=function(c,M){return $.call(M),G(c,M)}}else{var _=K.beforeCreate;K.beforeCreate=_?[].concat(_,$):[$]}return{exports:e,options:K}}},20:function(O,n){O.exports=o(5077)},22:function(O,n){O.exports=o(69033)},25:function(O,n){O.exports=o(43389)},28:function(O,n){O.exports=o(32726)},38:function(O,n){O.exports=o(26541)},457:function(O,n){O.exports=o(2237)},50:function(O,n){O.exports=o(36583)},6:function(O,n){O.exports=o(83574)},7:function(O,n){O.exports=o(17249)},772:function(O,n,a){"use strict";a.r(n);var t=a(0),e=a.n(t),i=function(){var P=this,A=P.$createElement,U=P._self._c||A;return U("div",{staticClass:"sh-draw-tool"},[U("general-bar",{attrs:{mode:P.mode,theme:P.theme,"drag-enable":P.dragEnable,"is-show":P.visible,position:P.position,options:P.toolOptions,"active-index":P.activeIndex,"theme-style":P.barThemeStyle},on:{"update:isShow":function(nt){P.visible=nt},"update:is-show":function(nt){P.visible=nt},"change:isShow":P.onChangeIsShow,select:P.select,unselect:P.unselect}})],1)},f=[];i._withStripped=!0;var I=a(17),j=a.n(I),b=a(18),R=a.n(b),q=a(8),K=a.n(q),$=a(19),G=a.n($),_=a(20),W=a.n(_),c=a(50),M=a.n(c),F=a(25),X=a.n(F),k=a(38),ht=a.n(k),Y=a(22),it=a.n(Y),H=a(457),V=a.n(H),m=a(6),D=a.n(m),r=a(7),s=a.n(r),d=a(102),x=a.n(d),N=a(103),u=a.n(N),B={cad:!0,drawPoint:!0,drawLine:!0,drawPolygon:!0,modify:!0,clear:!0,rotate:!0,buffer:!0,union:!0,intersection:!0,difference:!0};function z(P){return[{key:"point",name:"\u7ED8\u5236\u70B9",img:"drawPoint",hidden:!P.drawPoint},{key:"polyline",name:"\u7ED8\u5236\u7EBF",img:"drawLine",hidden:!P.drawLine},{key:"polygon",name:"\u7ED8\u5236\u9762",img:"drawPolygon",hidden:!P.drawPolygon},{key:"clear",name:"\u6E05\u9664",img:"clear",hidden:!P.clear},{key:"modify",name:"\u7F16\u8F91",img:"modify",hidden:!P.modify}]}var rt=void 0;function pt(P,A){var U=j()(P);if(R.a){var nt=R()(P);A&&(nt=K()(nt).call(nt,function(yt){return G()(P,yt).enumerable})),U.push.apply(U,nt)}return U}function ut(P){for(var A=1;A<arguments.length;A++){var U=arguments[A]!=null?arguments[A]:{};A%2?pt(Object(U),!0).forEach(function(nt){X()(P,nt,U[nt])}):W.a?Object.defineProperties(P,W()(U)):pt(Object(U)).forEach(function(nt){Object.defineProperty(P,nt,G()(U,nt))})}return P}var gt={name:"ShDrawTool",components:{GeneralBar:x.a},mixins:[D.a,s.a,u.a],props:{returnType:{type:String,default:"geojson"},options:{type:Object,default:function(){return B}},isDrawEndSelected:{type:Boolean,default:!0},defaultStyle:{type:Object,default:function(){return e()(this,rt),{point:{pixelSize:5,color:"#3388ff",opacity:1,outline:!0,outlineColor:"#ffffff",outlineOpacity:.6,outlineWidth:2,clampToGround:!0},polyline:{name:"\u7EBF",lineType:"solid",color:"#3388ff",width:4,clampToGround:!0,opacity:1,zIndex:0},polygon:{fill:!0,fillType:"color",color:"#3388ff",opacity:.6,stRotation:0,outline:!0,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:.6,clampToGround:!0,zIndex:0}}}.bind(void 0)},defaultSelectStyle:{type:Object,default:function(){return e()(this,rt),{point:{pixelSize:5,color:"#FF0000",opacity:1,outline:!1,clampToGround:!0},polyline:{name:"\u7EBF",lineType:"solid",color:"#FF0000",width:4,clampToGround:!0,opacity:1,zIndex:0},polygon:{fill:!0,fillType:"color",color:"rgb(255,0,0)",opacity:.3,stRotation:0,outline:!0,outlineWidth:4,outlineColor:"#FF0000",outlineOpacity:1,clampToGround:!0,zIndex:0}}}.bind(void 0)}},data:function(){return this.drawTool,{activeIndex:[]}},computed:{toolOptions:function(){return z(ut(ut({},B),this.options))}},watch:{currentView:function(A){this.inited&&this.drawTool.setCurrentView(A)},currentInteraction:function(A){A!==this.$options.name&&this.deactivate()}},beforeDestroy:function(){this.deactivate()},mounted:function(){var A=this;(this.$map||this.$earth)&&setTimeout(function(){e()(this,A),this.begin()}.bind(this),0)},methods:{begin:function(){var A=this;this.drawTool&&(this.activeIndex=[],this.drawTool.destory()),this.drawTool=new V.a(this.$map,this.$earth),this.drawTool.on("inited",function(){e()(this,A),this.inited=!0,this.$emit("inited",this.drawTool)}.bind(this)),this.drawTool.on("drawend",function(U){if(e()(this,A),this.isDrawEndSelected){var nt=U.feature.getAttr3d(),yt=nt.style;nt.style=this.defaultSelectStyle[U.feature.type],nt.attr.tempSelected=!0,this.drawTool.updateAttribute(nt,U.feature),U.feature.feature2d&&(U.feature.feature2d.beforeSelectStyle=yt)}this.unselect(U.feature.type),this.$emit("drawend",U.feature)}.bind(this)),this.drawTool.on("change:active",function(U){var nt=this;if(e()(this,A),U.active)this.activeIndex=[U.tool];else{var yt,ft=M()(this.activeIndex),St=ht()(yt=this.activeIndex).call(yt,function(Tt){return e()(this,nt),Tt===U.tool}.bind(this));St>-1&&(it()(ft).call(ft,St,1),this.activeIndex=M()(ft))}this.$emit("change:active",U.active,U.tool,this.activeIndex)}.bind(this))},activate:function(A){this.select(A)},deactivate:function(){this.drawTool&&this.drawTool.deactivate()},removeAll:function(A){this.drawTool.removeAll(A)},select:function(A){A==="clear"?this.drawTool.removeAll():A==="modify"?(this.activeIndex=["modify"],this.drawTool.hasEdit(!0)):this.drawTool.activate(A,this.defaultStyle[A])},unselect:function(A){if(A==="modify"){this.drawTool.hasEdit(!1);for(var U=0;U<this.activeIndex.length;U++)if(this.activeIndex[U]==="modify"){var nt;it()(nt=this.activeIndex).call(nt,U,1);break}}else this.drawTool.deactivate(A)},onChangeIsShow:function(A){this.$emit("change:isShow",A)},setEditLayer:function(A){this.drawTool.setEditLayer(A)},createDrawLayer:function(A){return this.drawTool.createDrawLayer(A)},loadGeoJson:function(A,U){return this.drawTool.loadGeoJson(A,U)},removeFeatures:function(A){this.drawTool.removeFeatures(A)},removeFeature:function(A){this.drawTool.removeFeature(A)},setFeatureStyle:function(A,U){this.drawTool.setFeatureStyle(A,U)}}},lt=gt,Ct=a(2),mt=Object(Ct.a)(lt,i,f,!1,null,null,null),It=mt.exports,$t=a(28),ct=a.n($t),xt=void 0,wt=ct()(It,{transform:function(A){e()(this,xt);var U=A.show,nt=A.position,yt=A.config,ft=yt===void 0?{}:yt,St={cad:ft.cadControl,drawPoint:ft.drawControl,drawLine:ft.drawLineControl,drawPolygon:ft.drawPolyControl,modify:ft.modifyControl,clear:ft.clearControl,rotate:ft.rotateControl,buffer:ft.bufferControl,union:ft.unionControl,intersection:ft.intersectionControl,difference:ft.differenceControl};return{isShow:U,position:nt,options:St}}.bind(void 0)});wt.install=function(P){P.component(wt.name,wt)};var Et=n.default=wt},8:function(O,n){O.exports=o(22466)}})},7819:function(dt,Q,o){var O=o(49500);dt.exports=function(n){var a={};function t(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return n[e].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=a,t.d=function(e,i,f){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:f})},t.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(i&1&&(e=t(e)),i&8||i&4&&typeof e=="object"&&e&&e.__esModule)return e;var f=Object.create(null);if(t.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:e}),i&2&&typeof e!="string")for(var I in e)t.d(f,I,function(j){return e[j]}.bind(null,I));return f},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="/dist/",t(t.s=751)}({0:function(n,a){n.exports=o(42579)},1:function(n,a){n.exports=o(28866)},115:function(n,a){n.exports=o(21830)},136:function(n){n.exports=JSON.parse('{"1.3.12":"1.3","2.0.5":"2.0","2.1.4":"2.1","2.2.0-29":"2.2"}')},17:function(n,a){n.exports=o(85208)},18:function(n,a){n.exports=o(59791)},19:function(n,a){n.exports=o(83393)},2:function(n,a,t){"use strict";t.d(a,"a",function(){return e});function e(i,f,I,j,b,R,q,K){var $=typeof i=="function"?i.options:i;f&&($.render=f,$.staticRenderFns=I,$._compiled=!0),j&&($.functional=!0),R&&($._scopeId="data-v-"+R);var G;if(q?(G=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),b&&b.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(q)},$._ssrRegister=G):b&&(G=K?function(){b.call(this,($.functional?this.parent:this).$root.$options.shadowRoot)}:b),G)if($.functional){$._injectStyles=G;var _=$.render;$.render=function(M,F){return G.call(F),_(M,F)}}else{var W=$.beforeCreate;$.beforeCreate=W?[].concat(W,G):[G]}return{exports:i,options:$}}},20:function(n,a){n.exports=o(5077)},21:function(n,a){n.exports=o(81806)},24:function(n,a){n.exports=o(52909)},25:function(n,a){n.exports=o(43389)},28:function(n,a){n.exports=o(32726)},32:function(n,a){n.exports=o(17745)},354:function(n,a){n.exports=o(2258)},355:function(n,a){n.exports=o(61536)},406:function(n,a){n.exports=o(29406)},446:function(n,a){n.exports=o(41775)},447:function(n,a){n.exports=o(99290)},448:function(n,a){n.exports=o(19563)},449:function(n,a){n.exports=o(95512)},53:function(n,a){n.exports=o(29870)},54:function(n,a){n.exports=o(1117)},57:function(n,a){n.exports=o(32002)},59:function(n,a){n.exports=o(67040)},6:function(n,a){n.exports=o(83574)},7:function(n,a){n.exports=o(17249)},751:function(n,a,t){"use strict";t.r(a);var e=t(0),i=t.n(e),f=function(){var l=this,T=l.$createElement,y=l._self._c||T;return y("div",{staticClass:"sh-earth cesium-container",class:{"sh-base-component":l.$isBaseComponent},attrs:{id:l.earthId}},[y("div",{staticClass:"sh-earth-controls"},[l.isEarthLoad&&l.getControlIsShow("FullFigure")?y("FullFigure",{attrs:{options:l.getControlOption("FullFigure"),"init-position":l.initPosition}},[l._t("earth:FullFigure")],2):l._e(),l.isEarthLoad&&l.getControlIsShow("Zoom")?y("Zoom",{attrs:{options:l.getControlOption("Zoom")},scopedSlots:l._u([{key:"ZoomIn",fn:function(){return[l._t("earth:ZoomIn")]},proxy:!0},{key:"ZoomOut",fn:function(){return[l._t("earth:ZoomOut")]},proxy:!0}],null,!0)}):l._e(),l.isEarthLoad&&l.getControlIsShow("FullScreen")?y("FullScreen",{attrs:{options:l.getControlOption("FullScreen")}},[l._t("earth:FullScreen")],2):l._e(),l.isEarthLoad&&l.getControlIsShow("NavigationHelp")?y("NavigationHelp",{attrs:{options:l.getControlOption("NavigationHelp")}},[l._t("earth:NavigationHelp")],2):l._e(),l.isEarthLoad&&l.getControlIsShow("ScenePick")?y("ScenePick",{attrs:{options:l.getControlOption("ScenePick")}}):l._e()],1),l.isEarthLoad&&l.getControlIsShow("Rotate")?y("Rotate",{attrs:{options:l.getControlOption("Rotate")}}):l._e(),l.isEarthLoad&&l.getControlIsShow("ScaleLine")?y("ScaleLine",{attrs:{options:l.getControlOption("ScaleLine")}}):l._e(),l.isEarthLoad&&l.getControlIsShow("Geolocation")?y("Geolocation",{attrs:{options:l.getControlOption("Geolocation")}}):l._e(),l.isEarthLoad?l._t("default"):l._e()],2)},I=[];f._withStripped=!0;var j=t(53),b=t.n(j),R=t(17),q=t.n(R),K=t(1),$=t.n(K),G=t(21),_=t.n(G),W=t(24),c=t.n(W),M=t(446),F=t.n(M),X=t(7),k=t.n(X),ht=t(115),Y=t.n(ht),it=t(54),H=t(355),V=t.n(H),m=t(354),D=t.n(m),r=t(59),s=t(57),d=function(){var l=this,T=l.$createElement,y=l._self._c||T;return y("div",{staticClass:"sh-earth-zoom"},[y("div",[l.$slots.ZoomIn?y("div",{attrs:{title:"\u653E\u5927"},on:{click:function(J){return J.stopPropagation(),l.onZoomIn.apply(null,arguments)}}},[l._t("ZoomIn")],2):y("div",{staticClass:"zoom-in",attrs:{title:"\u653E\u5927"},on:{click:function(J){return J.stopPropagation(),l.onZoomIn.apply(null,arguments)}}},[y("icon-svg",{attrs:{"icon-class":"zoom-in",width:"16px",height:"16px",theme:"dark"}})],1)]),y("div",[l.$slots.ZoomOut?y("div",{attrs:{title:"\u7F29\u5C0F"},on:{click:function(J){return J.stopPropagation(),l.onZoomOut.apply(null,arguments)}}},[l._t("ZoomOut")],2):y("div",{staticClass:"zoom-out",attrs:{title:"\u7F29\u5C0F"},on:{click:function(J){return J.stopPropagation(),l.onZoomOut.apply(null,arguments)}}},[y("icon-svg",{attrs:{"icon-class":"zoom-out",width:"16px",height:"16px",theme:"dark"}})],1)])])},x=[];d._withStripped=!0;var N=t(6),u=t.n(N),B=t(32),z=t.n(B),rt=t(406),pt=t.n(rt),ut={name:"ShEarthZoom",components:{IconSvg:z.a},mixins:[u.a,k.a],mounted:function(){this.zoomIn=new pt.a(this.$earth.viewer,!0),this.zoomOut=new pt.a(this.$earth.viewer,!1)},methods:{onZoomIn:function(){this.zoomIn.zoom(this.zoomIn.relativeAmount)},onZoomOut:function(){this.zoomOut.zoom(this.zoomOut.relativeAmount)}}},gt=ut,lt=t(2),Ct=Object(lt.a)(gt,d,x,!1,null,null,null),mt=Ct.exports,It=function(){var l=this,T=l.$createElement,y=l._self._c||T;return y("div",{ref:"target",staticClass:"sh-earth-rotate"})},$t=[];It._withStripped=!0;var ct=t(94),xt=t(447),wt=t.n(xt),Et={name:"ShEarthRotate",mixins:[u.a,k.a],mounted:function(){this.$earth.viewer.afterWidgetChanged||(this.$earth.viewer.afterWidgetChanged=new ct.Event),this.$earth.viewer.beforeWidgetChanged||(this.$earth.viewer.beforeWidgetChanged=new ct.Event),this.navigationViewModel=wt.a.create({container:this.$refs.target,terria:this.$earth.viewer,enableZoomControls:!1,enableCompass:!0})}},P=Et,A=Object(lt.a)(P,It,$t,!1,null,null,null),U=A.exports,nt=function(){var l=this,T=l.$createElement,y=l._self._c||T;return y("div",{ref:"target",staticClass:"sh-earth-scale-line"})},yt=[];nt._withStripped=!0;var ft=t(448),St=t.n(ft),Tt={name:"ShEarthScaleLine",mixins:[u.a,k.a],mounted:function(){this.container=document.createElement("div"),this.container.className="cesium-widget-cesiumNavigationContainer",this.container.appendChild(this.$refs.target),this.$refs.target.setAttribute("id","distanceLegendDiv"),this.$earth.viewer.container.appendChild(this.container),this.$earth.viewer.afterWidgetChanged||(this.$earth.viewer.afterWidgetChanged=new ct.Event),this.$earth.viewer.beforeWidgetChanged||(this.$earth.viewer.beforeWidgetChanged=new ct.Event),this.distanceLegendViewModel=St.a.create({container:this.$refs.target,terria:this.$earth.viewer,mapElement:this.container,enableDistanceLegend:!0})},beforeDestroy:function(){this.$earth.viewer.container.removeChild(this.container)}},p=Tt,S=Object(lt.a)(p,nt,yt,!1,null,null,null),h=S.exports,g=t(449),L=void 0,v="<div>\u4FEF\u4EF0\u89D2\uFF1A{pitch}\u5EA6</div><div>\u65B9\u5411\uFF1A{heading}\u5EA6\uFF080\u5EA6\u4E3A\u6B63\u5317\uFF09</div><div>\u89C6\u9AD8\uFF1A{height}\u7C73</div><div>\u7EAC\u5EA6\uFF1A{screenwd})</div><div>\u76F8\u673A (\u7ECF\u5EA6\uFF1A{screenjd}</div>",E={name:"ShEarthGeolocation",mixins:[u.a,k.a],props:{options:{type:Object,default:function(){i()(this,L)}.bind(void 0)}},data:function(){var T,y;return{crs:(T=this.options)===null||T===void 0?void 0:T.crs,format:((y=this.options)===null||y===void 0?void 0:y.format)||v}},mounted:function(){this.location=new g.Location(this.$earth.viewer,{crs:this.crs,format:this.format,bindEvent:!1}),this.$earth.viewer.shine._location=this.location,this.location.updaeCamera()},beforeDestroy:function(){var T;(T=this.location)===null||T===void 0||T.destroy()},render:function(){return null}},Z=E,w,tt,C=Object(lt.a)(Z,w,tt,!1,null,null,null),at=C.exports,et=function(){var l=this,T=l.$createElement,y=l._self._c||T;return y("div",{staticStyle:{position:"relative"}},[l.$slots.default?y("div",{ref:"button"},[l._t("default")],2):y("div",{ref:"button",staticClass:"sh-earth-navigation-help"},[y("IconSvg",{ref:"icon",attrs:{"icon-class":"help",theme:"dark",width:"16px",height:"16px"}})],1)])},Bt=[];et._withStripped=!0;var Pt,Zt={name:"ShNavigationHelp",components:{IconSvg:z.a},mixins:[u.a,k.a],mounted:function(){var T=this.$refs.button;new ct.NavigationHelpButton({container:T}),Pt=T.getElementsByClassName("cesium-navigationHelpButton-wrapper")[0],T.appendChild(Pt)}},Ft=Zt,Vt=Object(lt.a)(Ft,et,Bt,!1,null,null,null),Gt=Vt.exports,jt=function(){var l=this,T=l.$createElement,y=l._self._c||T;return y("div",{ref:"button",staticClass:"sh-earth-scene-pick"},[y("span",{staticClass:"container"},[y("div",{staticClass:"button",attrs:{id:l.item.id,title:l.item.text},on:{click:function(J){return l.handleEvent("open_close_scenePicker")}}},[y("IconSvg",{attrs:{"icon-class":l.item.icon,theme:"dark",width:"16px",height:"16px"}})],1),l._l(l.item.list,function(J,st){return y("div",{directives:[{name:"show",rawName:"v-show",value:!J.hidden,expression:"!factor.hidden"}],key:st,staticClass:"button",attrs:{title:J.text},on:{click:function(ot){return l.handleEvent(J.id)}}},[y("IconSvg",{attrs:{"icon-class":J.icon,width:"16px",height:"16px",theme:"dark"}})],1)})],2)])},Ht=[];jt._withStripped=!0;var Ut=t(25),Kt=t.n(Ut),Jt=t(18),Rt=t.n(Jt),Xt=t(8),Yt=t.n(Xt),Qt=t(19),Wt=t.n(Qt),kt=t(20),At=t.n(kt);function Dt(l,T){var y=q()(l);if(Rt.a){var J=Rt()(l);T&&(J=Yt()(J).call(J,function(st){return Wt()(l,st).enumerable})),y.push.apply(y,J)}return y}function qt(l){for(var T=1;T<arguments.length;T++){var y=arguments[T]!=null?arguments[T]:{};T%2?Dt(Object(y),!0).forEach(function(J){Kt()(l,J,y[J])}):At.a?Object.defineProperties(l,At()(y)):Dt(Object(y)).forEach(function(J){Object.defineProperty(l,J,Wt()(y,J))})}return l}var _t={name:"ShScenePick",components:{IconSvg:z.a},mixins:[u.a,k.a],data:function(){return{item:{id:"scene_3d",icon:"scene-mode-3d",text:"\u4E09\u7EF4\u89C6\u56FE",list:[{id:"scene_2d",icon:"scene-mode-2d",text:"\u4E8C\u7EF4\u89C6\u56FE",hidden:!0},{id:"scene_Columbus",icon:"scene-mode-columbus",text:"\u54E5\u4F26\u5E03\u89C6\u56FE",hidden:!0}]}}},methods:{begin:function(){},handleEvent:function(T){var y=this;if(T==="open_close_scenePicker"){var J=this.item.list;J.forEach(function(Lt){i()(this,y),Lt.hidden=!Lt.hidden}.bind(this));return}else{var st=this.$earth.viewer.scene;switch(T){case"scene_2d":{st.morphTo2D(0);break}case"scene_3d":{st.morphTo3D(0);break}case"scene_Columbus":st.morphToColumbusView(0)}var ot=this.item.list,vt=c()(ot).call(ot,function(Lt){return i()(this,y),Lt.id===T}.bind(this)),bt=qt({},this.item);this.item.icon=vt.icon,this.item.id=vt.id,this.item.text=vt.text,vt.icon=bt.icon,vt.id=bt.id,vt.text=bt.text,this.handleEvent("open_close_scenePicker")}}}},te=_t,ee=Object(lt.a)(te,jt,Ht,!1,null,null,null),ie=ee.exports,Ot=void 0,ne={name:"ShEarth",components:{FullFigure:V.a,Zoom:mt,Rotate:U,ScaleLine:h,Geolocation:at,FullScreen:D.a,NavigationHelp:Gt,ScenePick:ie},mixins:[k.a,Y.a],inject:{reactiveViewMode:{default:function(){var T=this;return function(){return i()(this,T),"3D"}.bind(this)}},reactiveView:{default:function(){var T=this;return function(){return i()(this,T),"earth"}.bind(this)}}},provide:function(){var T=this;return{reactiveViewMode:function(){return i()(this,T),"3D"}.bind(this),reactiveView:function(){return i()(this,T),"earth"}.bind(this),reactiveEarth:function(){return i()(this,T),this.$earth}.bind(this),emitterId:this.emitterId}},props:{map:Object,initLayers:{type:Array,default:function(){return i()(this,Ot),[]}.bind(void 0)},duration:{type:Number,default:0},controls:{type:Array,default:function(){return i()(this,Ot),["FullFigure","Zoom","Geolocation","Rotate","ScaleLine","FullScreen","NavigationHelp"]}.bind(void 0)},projection:{type:String,default:"EPSG:4490"},center:{type:Array,default:function(){return i()(this,Ot),[111.7579,31.6736]}.bind(void 0)},height:{type:Number,default:614914256e-2},zoom:{type:Number},heading:{type:Number,default:0},roll:{type:Number,default:0},pitch:{type:Number,default:-90}},data:function(){return this.$earth=void 0,this.earthId=Object(it.v4)(),{isEarthLoad:!1}},computed:{currentPosition:function(){return{center:this.center,height:this.height,heading:this.heading,roll:this.roll,pitch:this.pitch}}},watch:{currentPosition:function(T,y){var J=this,st,ot={};q()(T).forEach(function(bt){i()(this,J),Object(s.isEqual)(T[bt],y[bt])||(ot[bt]=T[bt])}.bind(this));var vt=this.$el.style.display!=="none";vt&&((st=this.$earth)===null||st===void 0||st.centerAt(ot))}},beforeCreate:function(){var T,y;this.$isBaseComponent=((T=this.$parent)===null||T===void 0||(y=T.$parent.$options)===null||y===void 0?void 0:y.name)!=="ShMapEarth",this.emitterId=this.$isBaseComponent?Object(it.v4)():this.$parent.$parent.emitterId},mounted:function(){var T=this;if(this.$isBaseComponent){var y=q()(t(136)).reverse()[0];O.log("shinegis-client-23d version:",y)}setTimeout(function(){i()(this,T),this.initEarth(),this.setInitLayers()}.bind(this))},methods:{initEarth:function(){var T=this,y=this.reactiveView(),J=this.duration;y==="earth"?J=(J||50)/1e3:J=0,this.$earth=new F.a(this.earthId,{center:this.center,projection:this.projection,height:this.height,heading:this.heading,roll:this.roll,pitch:this.pitch,map:$()(this),duration:J}),this.initPosition={center:this.center,height:this.height,heading:this.heading,roll:this.roll,pitch:this.pitch},this.isEarthLoad=!0,this.$emit("earthInited",this.$earth),y==="earth"&&$()(this)&&this.$earth.viewer.shine.ol3d.setEnabled(!0),this.subscribe.$once("map-earth:change:view",function(vt){if(i()(this,T),vt==="earth"&&$()(this)&&this.duration>0){var bt=$()(this).getCenter(),Lt=$()(this).getZoom();this.$earth.centerAt({center:bt,height:this.$earth.viewer.shine.levelToHeight(Lt),heading:0,roll:0,pitch:-90},{duration:this.duration})}}.bind(this));var st=Object(r.getUrlParams)(decodeURIComponent(window.location.href)),ot={};st.forEach(function(vt){i()(this,T),ot[vt.name]=vt.value}.bind(this)),ot.view==="earth"&&setTimeout(function(){i()(this,T),this.$earth.centerAt({center:[Number(ot.x),Number(ot.y)],height:Number(ot.z),heading:Number(ot.heading),roll:Number(ot.roll),pitch:Number(ot.pitch)},{duration:0,projection:ot.projection})}.bind(this),500)},setInitLayers:function(){for(var T=0;T<this.initLayers.length;T++)this.$earth.viewer.shine.layerManager.addCheckedLayers(this.initLayers[T])},getControlIsShow:function(T){var y,J=this,st=$()(y=this.controls).call(y,function(ot){return i()(this,J),b()(ot)==="object"?ot.name:ot}.bind(this));return _()(st).call(st,T)},getControlOption:function(T){var y,J=this,st=c()(y=this.controls).call(y,function(ot){return i()(this,J),ot.name===T}.bind(this));return st?st.earthOptions:null}}},re=ne,oe=Object(lt.a)(re,f,I,!1,null,null,null),ae=oe.exports,se=t(28),le=t.n(se),he=void 0,Mt=le()(ae,{transform:function(T,y){i()(this,he);var J=y.view,st=y.projection,ot=y.center,vt=y.height,bt=y.controls,Lt=y.heading,Nt=y.roll,zt=y.pitch;return J==="map"&&(Lt=0,Nt=0,zt=-90),{projection:st,center:ot,controls:bt,height:Number(vt),heading:Number(Lt),roll:Number(Nt),pitch:Number(zt)}}.bind(void 0)});Mt.install=function(l){l.component(Mt.name,Mt)};var ue=a.default=Mt},8:function(n,a){n.exports=o(22466)},94:function(n,a){n.exports=o(87647)}})},63632:function(dt,Q,o){var O=o(49500);dt.exports=function(n){var a={};function t(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return n[e].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=a,t.d=function(e,i,f){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:f})},t.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(i&1&&(e=t(e)),i&8||i&4&&typeof e=="object"&&e&&e.__esModule)return e;var f=Object.create(null);if(t.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:e}),i&2&&typeof e!="string")for(var I in e)t.d(f,I,function(j){return e[j]}.bind(null,I));return f},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="/dist/",t(t.s=783)}({0:function(n,a){n.exports=o(42579)},1:function(n,a){n.exports=o(28866)},115:function(n,a){n.exports=o(21830)},136:function(n){n.exports=JSON.parse('{"1.3.12":"1.3","2.0.5":"2.0","2.1.4":"2.1","2.2.0-29":"2.2"}')},17:function(n,a){n.exports=o(85208)},2:function(n,a,t){"use strict";t.d(a,"a",function(){return e});function e(i,f,I,j,b,R,q,K){var $=typeof i=="function"?i.options:i;f&&($.render=f,$.staticRenderFns=I,$._compiled=!0),j&&($.functional=!0),R&&($._scopeId="data-v-"+R);var G;if(q?(G=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),b&&b.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(q)},$._ssrRegister=G):b&&(G=K?function(){b.call(this,($.functional?this.parent:this).$root.$options.shadowRoot)}:b),G)if($.functional){$._injectStyles=G;var _=$.render;$.render=function(M,F){return G.call(F),_(M,F)}}else{var W=$.beforeCreate;$.beforeCreate=W?[].concat(W,G):[G]}return{exports:i,options:$}}},28:function(n,a){n.exports=o(32726)},356:function(n,a){n.exports=o(7819)},450:function(n,a){n.exports=o(79810)},47:function(n,a){n.exports=o(10563)},54:function(n,a){n.exports=o(1117)},59:function(n,a){n.exports=o(67040)},7:function(n,a){n.exports=o(17249)},783:function(n,a,t){"use strict";t.r(a);var e=t(0),i=t.n(e),f=function(){var u=this,B=u.$createElement,z=u._self._c||B;return z("div",{staticClass:"sh-map-earth sh-base-component",class:u.currentView},[u.mapViewMode!="3D"?z("Map",{directives:[{name:"show",rawName:"v-show",value:u.currentView==="map",expression:"currentView === 'map'"}],ref:"map",attrs:{controls:u.controls,"init-layers":u.initLayers,projection:u.projection,center:u.center,zoom:u.zoom,"min-zoom":u.minZoom,"max-zoom":u.maxZoom,"mouse-wheel-zoom-enable":u.mouseWheelZoomEnable,"double-click-zoom-enable":u.doubleClickZoomEnable,"drag-pan-enable":u.dragPanEnable},on:{mapInited:u.mapInited},scopedSlots:u._u([{key:"map:FullFigure",fn:function(){return[u._t("map:FullFigure")]},proxy:!0},{key:"map:FullScreen",fn:function(){return[u._t("map:FullScreen")]},proxy:!0},{key:"map:ZoomIn",fn:function(){return[u._t("map:ZoomIn")]},proxy:!0},{key:"map:ZoomOut",fn:function(){return[u._t("map:ZoomOut")]},proxy:!0}],null,!0)}):u._e(),u.isMapLoad&&u.mapViewMode!="2D"?z("Earth",{directives:[{name:"show",rawName:"v-show",value:u.currentView==="earth",expression:"currentView === 'earth'"}],ref:"earth",attrs:{duration:u.duration,controls:u.controls,"init-layers":u.initLayers,map:u.$map,projection:u.projection,center:u.center,height:u.height,zoom:u.zoom,heading:u.heading,roll:u.roll,pitch:u.pitch},on:{earthInited:u.earthInited},scopedSlots:u._u([{key:"earth:FullFigure",fn:function(){return[u._t("earth:FullFigure")]},proxy:!0},{key:"earth:FullScreen",fn:function(){return[u._t("earth:FullScreen")]},proxy:!0},{key:"earth:ZoomIn",fn:function(){return[u._t("earth:ZoomIn")]},proxy:!0},{key:"earth:ZoomOut",fn:function(){return[u._t("earth:ZoomOut")]},proxy:!0},{key:"earth:NavigationHelp",fn:function(){return[u._t("earth:NavigationHelp")]},proxy:!0}],null,!0)}):u._e(),u.isMapLoad&&u.isEarthLoad?u._t("default"):u._e()],2)},I=[];f._withStripped=!0;var j=t(1),b=t.n(j),R=t(17),q=t.n(R),K=t(450),$=t.n(K),G=t(356),_=t.n(G),W=t(47),c=t(7),M=t.n(c),F=t(115),X=t.n(F),k=t(54),ht=t(59),Y=void 0,it={name:"ShMapEarth",components:{Map:$.a,Earth:_.a},mixins:[M.a,X.a],provide:function(){var B=this;return{reactiveViewMode:function(){return i()(this,B),this.mapViewMode}.bind(this),reactiveView:function(){return i()(this,B),this.currentView}.bind(this),reactiveMap:function(){return i()(this,B),this.$map}.bind(this),reactiveEarth:function(){return i()(this,B),this.$earth}.bind(this),reactiveInitPosition:function(){return i()(this,B),this.initPosition}.bind(this),emitterId:this.emitterId}},props:{viewMode:{type:[String,Number],default:"23D"},view:{type:String,default:"map"},controls:{type:Array,default:function(){return i()(this,Y),["FullFigure","Zoom","Geolocation","Rotate","ScaleLine","FullScreen","NavigationHelp"]}.bind(void 0)},initLayers:{type:Array,default:function(){return i()(this,Y),[]}.bind(void 0)},duration:{type:Number},projection:{type:String},center:{type:Array,default:function(){return i()(this,Y),[111.7579,31.6736]}.bind(void 0)},zoom:{type:Number,default:5},height:{type:Number,default:614914256e-2},heading:{type:Number,default:0},roll:{type:Number,default:0},pitch:{type:Number,default:-90},mouseWheelZoomEnable:{type:Boolean,default:!0},doubleClickZoomEnable:{type:Boolean,default:!0},dragPanEnable:{type:Boolean,default:!0},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:28}},data:function(){return this.$map=void 0,this.$earth=void 0,{currentView:this.getInitView(),isMapLoad:!1,isEarthLoad:!1,initPosition:{}}},computed:{initialized:function(){var B=this.isMapLoad,z=this.isEarthLoad;return B&&z},mapViewMode:function(){return Object(W.getMapViewMode)(this.viewMode)}},watch:{initialized:function(B){var z=this;B&&setTimeout(function(){var rt=this;i()(this,z),this.$emit("mapEarthInited",{map:this.$map,earth:this.$earth,mapRef:b()(this.$refs),earthRef:this.$refs.earth}),this.setInitPosition();var pt=Object(ht.getUrlParams)(decodeURIComponent(window.location.href)),ut={};pt.forEach(function(gt){i()(this,rt),ut[gt.name]=gt.value}.bind(this)),(ut.view==="map"||ut.view==="earth")&&this.toggleViewMode(ut.view)}.bind(this),0)},mapViewMode:{handler:function(B,z){this.currentView=this.getInitView(),this.mapViewMode==="3D"?(this.isMapLoad=!0,this.isEarthLoad=z==="23D"):this.mapViewMode==="2D"?(this.isEarthLoad=!0,this.isMapLoad=z==="23D"):this.mapViewMode==="23D"&&(this.isEarthLoad=!1,this.isMapLoad=z==="2D")},immediate:!0},currentView:function(B){var z=this;B==="earth"?setTimeout(function(){i()(this,z),this.$earth.viewer.shine.ol3d.setEnabled(!0)}.bind(this),10):(this.$earth.viewer.shine.ol3d.setEnabled(!1),this.$nextTick(function(){i()(this,z),this.$map.updateSize()}.bind(this))),this.$emit("change:view",B)},view:function(B){this.mapViewMode==="23D"&&(this.currentView=B)}},beforeCreate:function(){this.emitterId=Object(k.v4)(),this.$isBaseComponent=!0},mounted:function(){var B=q()(t(136)).reverse()[0];O.log("shinegis-client-23d version:",B),this.subscribe.$on("layer-switcher:change:view",this.toggleViewMode)},methods:{mapInited:function(B){var z=this;this.$map=B,this.isMapLoad=!0,this.$map.on("afterAddMapLink",function(rt){i()(this,z),this.$earth&&this.resetEarthElement(rt.element)}.bind(this)),this.$map.on("afterRemoveMapLink",function(rt){i()(this,z),this.$earth&&this.resetEarthElement(rt.element)}.bind(this))},earthInited:function(B){this.$earth=B,this.isEarthLoad=!0},toggleViewMode:function(B){B==="map"||B==="earth"?this.currentView=B:this.currentView=this.currentView==="map"?"earth":"map"},resetEarthElement:function(B){var z=document.getElementById(this.$earth.viewer._container.id);z.style.width=B.style.width,z.style.height=B.style.height},getInitView:function(){return this.mapViewMode==="23D"?this.view:this.mapViewMode==="3D"?"earth":"map"},setInitPosition:function(){this.view==="map"?this.initPosition={center:this.center,zoom:this.zoom,height:this.$earth?this.$earth.viewer.shine.levelToHeight(this.zoom):0,heading:this.heading,roll:this.roll,pitch:this.pitch}:this.initPosition={center:this.center,zoom:this.$earth?this.$earth.viewer.shine.getLevel(this.height):0,height:this.height,heading:0,roll:0,pitch:-90}}}},H=it,V=t(2),m=Object(V.a)(H,f,I,!1,null,null,null),D=m.exports,r=t(28),s=t.n(r),d=void 0,x=s()(D,{transform:function(B,z){i()(this,d);var rt=z.viewMode,pt=z.view,ut=z.projection,gt=z.center,lt=z.controls,Ct=z.zoom,mt=z.height,It=z.heading,$t=z.pitch,ct=z.roll;return{viewMode:rt,view:pt,projection:ut,center:gt,controls:lt,zoom:Number(Ct),height:Number(mt),heading:Number(It),pitch:Number($t),roll:Number(ct)}}.bind(void 0)});x.install=function(u){u.component(x.name,x)};var N=a.default=x}})},95031:function(dt,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0}),Q.earthDefaultConfig=void 0;var o={id:"cesiumContainer555",baseLayerPicker:!1,navigationHelpButton:!1,sceneModePicker:!1,homeButton:!1,fullscreenButton:!1,infoBox:!1,geocoder:!1,navigation:{},controls:[{crs:"",type:"location"},{type:"mousezoom"},{style:{top:"auto",bottom:"240px",right:"2px"},type:"navigation"}],showRenderLoopErrors:!0,center:{heading:360,roll:360,x:120.173619,y:30.247628,z:40113339e-1,pitch:-90},basemaps:[],defaultKey:{www_bing:"AtkX3zhnRe5fyGuLU30uZw8r3sxdBDnpQly7KfFTCB2rGlDgXBG3yr-qEiQEicEc",CesiumionToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmNDEzNmM2ZC02YTVmLTQ5YWEtODI4My1kN2ZkMTZjYWY4MmMiLCJpZCI6MTY4ODIsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NzEyOTE5NDd9.z0SU6f7Ou6381zw8UzAvFGIz6n7X0HNgCpse_kfBJXg",www_tdt:"e8355c4f15927bf3bf73b4801e30611a",geocoderConfig:{key:["f2fedb9b08ae13d22f1692cd472d345e","81825d9f2bafbb14f235d2779be90c0f","b185732970a4487de104fa71ef575f29","2e6ca4aeb6867fb637a5bee8333e5d3a","027187040fa924e56048468aaa77b62c"]}},maxzoom:5e7,minzoom:1,vrButton:!1,operationallayers:[],style:{debugShowFramesPerSecond:!1,resolutionScale:!0,atmosphere:!0,testTerrain:!0,lighting:!1,fog:!0}};Q.earthDefaultConfig=o},83577:function(dt,Q,o){"use strict";o.d(Q,{i:function(){return a}});var O=o(48836),n=o(27966);const a={created(){},computed:{...(0,O.Se)(["getCurrentWidget","getKeydown","getSelectMultiple","getMultipleWidget","getWidgets"])},methods:{...(0,O.nv)(["setCurrentWidget","setCurrentWidgetXYWHR","setActiveScreen","removeMultipleWidget","addMultipleWidget","setSelectMultiple","clearMultipleWidget"]),reLoadInfo(t){this.widgetInfo.id!=t.id&&this.$refs["comp_"+t.id]&&setTimeout(()=>{this.$refs["comp_"+t.id][0].reLoadInfo(t),this.$refs["comp_frame_"+t.id][0].initSvg()},500),this.loadInfo(t)},orgWidget(t,e){let i=[];return this.$$lib__.each(t,f=>{for(let I=0;I<this.widgetArr.length;I++){let j=this.widgetArr[I];j.parentId==this.widgetInfo.id&&j.id==f.id&&(!e||e(j))&&i.push(JSON.parse(JSON.stringify(j)))}}),i},setTitleText(t,e){e?this.$$lib__.each(e,i=>{this.$$lib__.each(this.orgWidget(i.widgets,f=>!f.title.hide&&f.title.text),f=>{f.attr.widgetW||(f.attr.widgetW=f.attr.w),this.$refs["title_"+f.id]&&this.$refs["title_"+f.id][0]&&(this.$refs["title_"+f.id][0].innerHTML=this.initTextPosition(f)),f.title.position||(f.title.position="top")})}):this.$$lib__.each(this.orgWidget(t,i=>!i.title.hide&&i.title.text),i=>{this.$refs["title_"+i.id]&&this.$refs["title_"+i.id][0]&&(this.$refs["title_"+i.id][0].innerHTML=this.initTextPosition(i)),i.title.position||(i.title.position="top")})},initTextPosition(t){return t.title.text===void 0||!t.title.text?"":t.title.text&&(t.title.position==="left"||t.title.position==="right")?t.title.text.split("").join("<br />"):t.title.text},onActive(t){return this.getSelectMultiple?this.getMultipleWidget[t.id]!=null:t.id===this.getCurrentWidget.id},onClicked(t){if(t&&t.currentTarget){let e=t.currentTarget.id;if(e&&e.indexOf(this.prefix.widget)>-1){let i=e.substr(this.prefix.widget.length);if(i!=this.getCurrentWidget.id){this.setActiveScreen(!1),this.setCurrentWidget(i);let f=this.$$lib__.keys(this.getMultipleWidget);this.getKeydown.ctrlKey?(this.setSelectMultiple(!0),this.getMultipleWidget[i]?this.removeMultipleWidget(i):this.addMultipleWidget(i)):this.getMultipleWidget[i]==null?(this.setSelectMultiple(!1),this.clearMultipleWidget(),this.addMultipleWidget(i)):f&&f.length==1&&(this.setSelectMultiple(!1),this.setCurrentWidget(f[0]),this.clearMultipleWidget(),this.addMultipleWidget(f[0]))}n.Z.$emit("autoScrollIntoViewWidgetTree",i)}}},onMouseEnter(t){this.onWidgetLayerMouseOver("push",t)},onMouseLeave(t){this.onWidgetLayerMouseOver("pop",t)},onWidgetLayerMouseOver(t,e){if(e&&e.currentTarget){let i=e.currentTarget.id;if(i&&i.indexOf(this.prefix.widget)>-1){let f=i.substr(this.prefix.widget.length);f&&f!=this.getCurrentWidget.id&&this.getMultipleWidget[f]==null&&t=="push"&&this.widget_layer_mouse_over.push(f),t=="pop"&&(this.widget_layer_mouse_over=this.$$lib__.without(this.widget_layer_mouse_over,f))}}},onDragstop(t,e){let i=this.getCurrentWidget.attr;i&&(i.x!=t||i.y!=e)&&this.setCurrentWidgetXYWHR({x:t,y:e})},dragging(t,e,i,f){if(this.getSelectMultiple){let I=this.getCurrentWidget.attr;I&&(I.x!=t||I.y!=e)&&this.setCurrentWidgetXYWHR({x:t,y:e})}},onResizstop(t,e,i,f){this.setCurrentWidgetXYWHR({x:t,y:e,w:i,h:f})},onRotatestop(t){this.setCurrentWidgetXYWHR({r:t})},getdraggableHW(t){let e={h:t.attr.h,w:t.attr.w?t.attr.widgetW:t.attr.w};return t.border.hide!=!0&&(t.border.type==!1?(t.border.widthT&&t.border.styleT&&t.border.styleT!=="none"&&(e.h=e.h+t.border.widthT),t.border.widthB&&t.border.styleB&&t.border.styleB!=="none"&&(e.h=e.h+t.border.widthB),t.border.widthR&&t.border.styleR&&t.border.styleR!=="none"&&(e.w=e.w+t.border.widthR),t.border.widthL&&t.border.styleL&&t.border.styleL!=="none"&&(e.w=e.w+t.border.widthL)):t.border.type==!0&&(t.border.breadthT&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.h=e.h+t.border.breadthT),t.border.breadthB&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.h=e.h+t.border.breadthB),t.border.breadthR&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.w=e.w+t.border.breadthR),t.border.breadthL&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.w=e.w+t.border.breadthL))),e},getDraggableStyle(t){let e={};return!t.isContainer&&!t.attr.pointerEvents&&(e.pointerEvents="none",t.id===this.getCurrentWidget.id&&(e.backgroundColor="rgba(236, 240, 241, 1)",e.filter="Alpha(Opacity=50)")),typeof t.attr.opacity=="number"&&(e.opacity=t.attr.opacity),t.attr.backgroundColor&&(e.backgroundColor=t.attr.backgroundColor),t.attr.backgroundImage&&(e.backgroundImage=this.getImageUrl(t.attr.backgroundImage)),t.attr.backgroundSize&&(e.backgroundSize=t.attr.backgroundSize),e.overflow=t.border.overflowShow?"hidden":"visible",t.border.hide!=!0&&((t.border.hShadow||t.border.vShadow)&&(e.boxShadow=(t.border.hShadow||0)+"px "+(t.border.vShadow||0)+"px "+(t.border.blur||0)+"px "+t.border.blurColor||"rgba(0,0,0,0)"),t.border.type==!1?(e.borderTopWidth=t.border.widthT+"px",e.borderRightWidth=t.border.widthR+"px",e.borderBottomWidth=t.border.widthB+"px",e.borderLeftWidth=t.border.widthL+"px",e.borderTopStyle=t.border.styleT,e.borderRightStyle=t.border.styleR,e.borderBottomStyle=t.border.styleB,e.borderLeftStyle=t.border.styleL,e.borderTopColor=t.border.colorT,e.borderRightColor=t.border.colorR,e.borderBottomColor=t.border.colorB,e.borderLeftColor=t.border.colorL,e.borderTopLeftRadius=t.border.radiusTL+"px",e.borderTopRightRadius=t.border.radiusTR+"px",e.borderBottomLeftRadius=t.border.radiusBL+"px",e.borderBottomRightRadius=t.border.radiusBR+"px"):t.border.type==!0&&(e.borderStyle=t.border.borderStyle,e.borderTopWidth=t.border.breadthT+"px",e.borderRightWidth=t.border.breadthR+"px",e.borderBottomWidth=t.border.breadthB+"px",e.borderLeftWidth=t.border.breadthL+"px",e.borderImageSource=this.getImageUrl(t.border.borderImage),e.borderImageSlice=t.border.cutT+" "+t.border.cutR+" "+t.border.cutB+" "+t.border.cutL,e.borderImageRepeat=t.border.repeat)),e.float="left !important",e}}}},80512:function(dt,Q,o){"use strict";o.d(Q,{Z:function(){return j}});var O=function(){var R=this,q=R._self._c;return q("div",{class:"container_child_"+R.widgetData.id,attrs:{id:"container_child_"+R.widgetData.id}},[q("keep-alive",[q(R.isView&&R.widgetData.isContainer?R.widgetData.typeName+"-view":R.widgetData.typeName,{ref:"com_"+R.widgetData.id,tag:"component",attrs:{"widget-info":R.widgetData,"widget-arr":R.getWidgetAllArr,"current-widget":R.currentWidget},on:{doGetPreviewData:R.doGetPreviewData,doReSetBoardId:R.doReSetBoardId,attrChange:R.attrChange}})],1)],1)},n=[],a=o(13229),t=o(48836),e={name:"DraggableComponent",extends:a.Z,computed:{...(0,t.Se)(["getWidgetAllArr","isView"])},methods:{reLoadInfo(b){if(b.id){let R=this.$refs["com_"+b.id];R&&R.reLoadInfo(b)}},doReSetBoardId(b){this.$emit("doReSetBoardId",b)},attrChange(b){this.$emit("attrChange",b)}}},i=e,f=o(68141),I=(0,f.Z)(i,O,n,!1,null,"41d16aa2",null),j=I.exports},44513:function(dt,Q,o){"use strict";o.d(Q,{Z:function(){return I}});var O=function(){var b=this,R=b._self._c;return b.attr.buttonHide?R("div",{style:{position:"absolute",right:b.attr.buttonHideRight+"px",top:b.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(q){return b.onHide()}}},[b.openTooltip?R("el-tooltip",{attrs:{"open-delay":1e3,content:b.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[R("el-button",{class:b.attr.buttonHideIconClass&&b.attr.buttonHideIconClass!=""?b.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:b.attr.buttonHideColor,fontSize:b.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):R("el-button",{class:b.attr.buttonHideIconClass&&b.attr.buttonHideIconClass!=""?b.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:b.attr.buttonHideColor,fontSize:b.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):b._e()},n=[],a=o(52246),t={props:["attr"],name:"hide-button",data(){return{isPc:a.b}},computed:{openTooltip:function(){let j=!1,b=this.attr.buttonHideTooltipContent;return a.b&&b&&b!=null&&b.trim()!=""&&(j=!0),j}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},e=t,i=o(68141),f=(0,i.Z)(e,O,n,!1,null,"bf399b9a",null),I=f.exports},9848:function(dt,Q,o){"use strict";o.d(Q,{Z:function(){return D}});var O=function(){var s=this,d=s._self._c;return d("div",{directives:[{name:"show",rawName:"v-show",value:s.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:s.widgetInfo.attr.w+"px",height:s.widgetInfo.attr.hh+"px"}},[d("hide-button",{attrs:{attr:s.widgetInfo.attr}}),d("ConfigProvider",{attrs:{"shinega-url":s.widgetInfo.config.shinegaUrl}},[d("MapEarth",{ref:"gismap",attrs:{controls:s.widgetInfo.config.controls,"init-layers":s.initLayers,center:s.center,zoom:s.widgetInfo.config.zoom,height:s.height,heading:s.widgetInfo.config.heading,roll:s.widgetInfo.config.roll,pitch:s.widgetInfo.config.pitch,"min-zoom":s.widgetInfo.config.minZoom,"max-zoom":s.widgetInfo.config.maxZoom,"mouse-wheel-zoom-enable":s.widgetInfo.config.mouseWheelZoomEnable,"double-click-zoom-enable":s.widgetInfo.config.doubleClickZoomEnable,"drag-pan-enable":s.widgetInfo.config.dragPanEnable,"view-mode":s.widgetInfo.config.viewMode,view:s.widgetInfo.config.view},on:{mapEarthInited:s.mapConfiged,"change:view":s.changeViewMode}},[d("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[d("draw-tool",{ref:"drawTool",on:{mounted:s.drawMounted}})],1),s.isDrawInited?s._t("default",null,{widgetInfo:s.widgetInfo}):s._e()],2)],1)],1)},n=[],a=o(99497),t=o.n(a),e=o(63632),i=o.n(e),f=o(21120),I=o.n(f),j=o(44513),b=o(27966),R=o(16971),q=o(45061),K=o(26711),$=o(86892),G=o(63778),_=o(54583);function W(r,s){if(r.length!==s.length)return!1;const d=r.length;for(let x=0;x<d;x++)if(!M(r[x],s[x]))return!1;return!0}function c(r,s){const d=Object.keys(r),x=Object.keys(s);return d.length!==x.length?!1:d.every(N=>!!M(r[N],s[N]))}function M(r,s){return r===s?!0:typeof r!=typeof s||r===null||s===null?!1:Array.isArray(r)?Array.isArray(s)?W(r,s):!1:typeof r=="object"?c(r,s):!1}var F=o(48836),X=o(10563),k=o(85002),ht=o(23400),Y=o(49500),it={name:"ShineMap",components:{ConfigProvider:I(),MapEarth:i(),DrawTool:t(),HideButton:j.Z},mixins:[R.u,ht.j,$.D,q.u,K.H,G.a],props:["widgetInfo"],data(){return{isEditor:window.location.href.indexOf("editor.html")>0,isDrawInited:!1,layers:null,basemap:null,center:null,zoom:1,lastScaleW:1,lastScaleH:1,isExportPng:!1,translateInteractions:[]}},created(){this.initAction(this.widgetInfo)},beforeDestroy(){b.Z.$off("mapInitialized"),b.Z.$off("bindMap",this.reLoadWidgets)},computed:{...(0,F.Se)(["getCanvasSetting","bodyFraction","getWidgets","getWidgetAllArr"]),initLayers(){let r=[];if(this.widgetInfo.mapLayer.toc)for(let s of this.widgetInfo.mapLayer.toc)s.url&&(s.isInitLayer=!0,r.push(s));return r},height(){return this.getHeight(this.widgetInfo.config.zoom)}},watch:{basemap(r,s){s!==null&&r.id!==s.id&&this.$refs.gismap.changeBaseMap(r)},"widgetInfo.config.center":{handler(r,s){r.length===2&&r.toString()!==s.toString()&&(this.center=r)}},"widgetInfo.mapLayer.toc":{handler(r,s){if(s!=null&&!W(r,s)){for(let d of s)d.url&&(this.$refs.gismap.$map&&this.$refs.gismap.$map.layerManager.removeLayer(d),this.$refs.gismap.$earth&&this.$refs.gismap.$earth.viewer.shine.layerManager.removeLayer(d));for(let d of r)d.url&&(this.$refs.gismap.$map&&this.$refs.gismap.$map.layerManager.addLayer(d),this.$refs.gismap.$earth&&(d.isInitLayer=!0,this.$refs.gismap.$earth.viewer.shine.layerManager.addCheckedLayers(d)))}}},"getCanvasSetting.screenZoom":{handler:function(){},immediate:!0,deep:!0},bodyFraction:{handler:function(){Y.log("bodyFraction",this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting.transformType)},immediate:!0,deep:!0},"widgetInfo.attr.w":{handler:function(){setTimeout(()=>{this.$refs.gismap.$map&&this.$refs.gismap.$map.updateSize()},100)}},"widgetInfo.attr.hh":{handler:function(){setTimeout(()=>{this.$refs.gismap.$map&&this.$refs.gismap.$map.updateSize()},100)}},"widgetInfo.attr.hide":{handler(){let r=this.$refs.gismap.$map;r&&setTimeout(()=>{r.updateSize()},200)}}},mounted(){Y.log("shime-map mounted"),this.widgetInfo.isContainer||this.updatewidgetInfoById({...this.widgetInfo,isContainer:!0}),(this.widgetInfo.config.widgets===null||this.widgetInfo.config.widgets.length===0)&&(this.widgetInfo.config.widgets=this.getMapWidgetsList(this.widgetInfo.id),this.changeCurrentWidget(JSON.parse(JSON.stringify(this.widgetInfo)))),b.Z.$on("bindMap",this.reLoadWidgets),this.zoom=this.widgetInfo.config.zoom,this.center=this.widgetInfo.config.center,b.Z.$emit("register-save-event",{widget:this,handler:this.setMapInfo}),b.Z.$on("gis-map-change-layer-index",r=>{let s=this.$refs.gismap.$map;if(s&&r&&r.length>0)for(let d of r)this.changeLayerZoomById(s,d.id,d.mapIndex)}),b.Z.$on("map:toChangeViewMode",()=>{this.$refs.gismap.toggleViewMode()}),this.widgetInfo.config.isStartTranslate=!1},methods:{...(0,F.nv)(["updatewidgetInfoById","changeCurrentWidget"]),reLoadWidgets(){this.widgetInfo.config.widgets=this.getMapWidgetsList(this.widgetInfo.id),this.changeCurrentWidget(JSON.parse(JSON.stringify(this.widgetInfo)))},reLoadInfo(r){Y.log(r,this.getWidgets),this.refreshFullStyle()},getMapWidgetsList(r){let s=[];for(let d in this.getWidgets){let x=JSON.parse(JSON.stringify(this.getWidgets[d]));x.parentId===r&&s.push({id:x.id,name:x.name})}return s},initAction(r){this.actionReceive(r)},initSendEvent(){this.$refs.gismap.$map&&(this.$refs.gismap.$map.layerManager.on("afterAddLayer",this.layerAdded),this.$refs.gismap.$map.on("click",this.mapClick),this.$refs.gismap.$map.on("moveend",this.mapMoveend),this.$refs.gismap.$map.markerClick(this.markerClick))},actionReceive(r){if(r.action==null||r.action.receive==null)return;let s=r.action.receive.locateTempGraphic;s&&s.enabled&&s.locateList&&s.locateList.length>0&&this.$$lib__.each(s.locateList,N=>{let u=N[0][1];b.Z.$on(u,B=>{r.action.receive.locateTempGraphic.script&&r.action.receive.locateTempGraphic.script.enabled&&(Y.log("Execute the script to locate temp graphic to the "+r.name+" component"),this.actionLocateTempGraphic=new Function("info","data","action",r.action.receive.locateTempGraphic.script.content)),this.actionLocateTempGraphic(r,B,N)})});let d=r.action.receive.show;d&&d.enabled&&d.showList&&d.showList.length>0&&this.doActionShowOrHide(d.showList,d.value,d.script,r.name,"show",d.values?d.values:[]);let x=r.action.receive.hide;x&&x.enabled&&x.hideList&&x.hideList.length>0&&this.doActionShowOrHide(x.hideList,x.value,x.script,r.name,"hide",x.values?x.values:[]),this.layerTocManagerReceive(r),this.setCutReceive(r)},layerTocManagerReceive(r){let s=r.action.receive.tocAction;s&&s.enabled&&s.tocList&&s.tocList.length>0&&this.$$lib__.each(s.tocList,d=>{let x=d[0][1];b.Z.$on(x,N=>{r.action.receive.tocAction.script&&r.action.receive.tocAction.script.enabled&&(Y.log("Execute the script to cutting to the "+r.name+" component"),this.actionToc=new Function("info","data","action",r.action.receive.tocAction.script.content)),this.actionToc(r,N,d)})})},setCutReceive(r){let s=r.action.receive.mapCutting;s&&s.enabled&&s.cutList&&s.cutList.length>0&&this.$$lib__.each(s.cutList,d=>{let x=d[0][1];b.Z.$on(x,N=>{r.action.receive.mapCutting.script&&r.action.receive.mapCutting.script.enabled&&(Y.log("Execute the script to cutting to the "+r.name+" component"),this.actionCutting=new Function("info","data","action",r.action.receive.mapCutting.script.content)),this.actionCutting(r,N,d)})})},actionScale(r,s,d){if(d==this.$$global_editor.transformType.autoWidth.code||d==this.$$global_editor.transformType.mobileAutoWidth.code?s=r:d==this.$$global_editor.transformType.autoHeight.code&&(r=s),r!=null&&s!=null&&!isNaN(r)&&!isNaN(s)&&!(r==this.lastScaleW&&s==this.lastScaleW)){if(this.$refs.gismap&&this.$refs.gismap.$map){let x=this.$refs.gismap.$map,N=this.widgetInfo.attr.w*r,u=this.widgetInfo.attr.h*s,B=1/r,z=1/s,rt=x.getTargetElement().parentElement.style.cssText;rt=rt+";width:"+N+"px",rt=rt+";height:"+u+"px",rt=rt+";transform: scale("+B+","+z+");transform-origin: 0 0 0;",x.getTargetElement().parentElement.style.cssText=rt,setTimeout(()=>{this.$refs.gismap.$map.updateSize()},300),this.lastScaleW=r,this.lastScaleH=s}}else(isNaN(r)||isNaN(s))&&this.$refs.gismap&&this.$refs.gismap.$map&&setTimeout(()=>{this.$refs.gismap.$map.updateSize()},300)},actionLocateTempGraphic(r,s,d){let x={};x.OBJECTID=s.OBJECTID,this.locateTempGraphic(x)},zoomTo(r,s){this.mapRef.zoomTo(r,s)},toggle(r,s,d){this.mapRef.toggle(r,s,d)},centerAt3d(){if(this.widgetInfo.config.viewMode==="3D"){let r=this.widgetInfo.config.center,s=this.widgetInfo.config.zoom;this.earth&&this.earth.viewer&&(Y.log("centerAt3d"),this.earth.viewer.shine.centerAt({x:Number(r[0]),y:Number(r[1]),z:Number(this.getHeight(s))},{isFly:!0}))}},locateTempGraphic(r){this.$refs.gismap.$map&&this.$refs.gismap.$map.locateTempGraphic(r)},layerAdded(r){let s={data:r.layer.values_.info,layer:r.layer};this.biPostMessage([this.$$global_editor.actionType.layerAdded.code],s)},mapConfiged(r){document.body.classList.add("bi-gis-theme-element"),this.changeBodyTheme(this.$refs.gismap.getInitView()),this.isEditor&&this.$refs.gismap.getInitView()==="earth"&&(this.$refs.gisBase.style.width=this.widgetInfo.attr.w+1+"px");let s=r;this.$refs.gismap.toggle=(d,x,N)=>{r.mapRef.toggle(d,x,N)},r.map&&(b.Z.$emit("mapInitialized",r.map),this.initSendEvent(),this.map=r.map,this.mapRef=r.mapRef,this.map.drawTool=this.$refs.drawTool,Y.log("mapConfiged",r),this.$refs.gismap.map=r.map,this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting.transformType)),r.earth&&(this.earth=r.earth,this.earth.weather=new k.default(this.earth),this.earthRef=r.earthRef),this.biPostMessage([this.$$global_editor.actionType.mapConfiged.code,this.$$global_editor.actionType.layerTocManager.code],s),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting.transformType),setTimeout(()=>{this.refreshFullStyle()},200)},refreshFullStyle(){(0,X.changeElementByClassName)("ol-full-screen-false",r=>{let s=this.widgetInfo.config.fullScreenStyle?this.widgetInfo.config.fullScreenStyle.backColor:"";s&&(r.style.backgroundColor=s);let d=this.widgetInfo.config.fullScreenStyle.size;d&&(r.style.width=d+"px",r.style.height=d+"px");let x=this.widgetInfo.config.fullScreenStyle?this.widgetInfo.config.fullScreenStyle.configSrc:"";if(x){let N=document.createElement("img");N.src=x,N.src="/gisqBI/images"+N.src.split("images")[1];let u=this.widgetInfo.config.fullScreenStyle.size?.8*this.widgetInfo.config.fullScreenStyle.size+"px":"1.1em";N.style.width=u,N.style.height=u,r.innerText="",r.innerHTML='<img src="'+N.src+'" style="width:'+u+";height:"+u+'"></img>'}})},drawMounted(){this.isDrawInited=!0},mapClick(r){let s={event:r,point:r.coordinate};this.biPostMessage([this.$$global_editor.actionType.mapClick.code],s)},mapMoveend(){if(this.$refs.gismap.$map){let r={center:this.$refs.gismap.$map.getView().getCenter(),zoom:this.$refs.gismap.$map.getView().getZoom()};this.biPostMessage([this.$$global_editor.actionType.mapMoveend.code],r)}},markerClick(r){let s=[];if(r){for(let x of r){let N=x.getProperties();delete N.geometry,s.push(N)}let d={event:{},data:s};this.biPostMessage([this.$$global_editor.actionType.markerClick.code],d)}},biPostMessage(r,s){let d=this,x=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(x,N=>{if(N.enabled&&r.indexOf(N.code)>-1){let u=N.code+"_"+d.widgetInfo.id;if(N.paramsExtend&&N.paramsExtend.length>0&&this.getExtendParams(s,N.paramsExtend,[],[]),N.script&&N.script.enabled&&N.script.content){this.doConfigMap=new Function("data",N.script.content);let B=this.doConfigMap(s);B&&(s=B)}b.Z.$emit(u,s),N.postMessage&&this.doPostMessage(s),this.actionNameList.push(u)}})},onMapConfig(r,s,d){s.map=this.map,b.Z.$emit(r,s),d&&this.doPostMessage(s)},setMapInfo(){let r=this.$refs.gismap.$map;if(r){let s=r.getView().getCenter(),d=r.getView().getResolution();this.widgetInfo.config.locateConf.center=s,this.widgetInfo.config.locateConf.resolution=d}},changeLayerZoomById(r,s,d){let x=r.getLayerById(s);if(x instanceof _.Z){let N=x.getLayers().getArray();for(let u of N)Number.isInteger(u.values_.info.mapIndex)||(d=d-.001),this._changeLayerZoom(r,u,d)}else this._changeLayerZoom(r,x,d)},_changeLayerZoom(r,s,d){s.setZIndex(d),r.removeLayer(s),r.addLayer(s)},getHeight(r){return 48e6/Math.pow(2,r)},changeBodyTheme(r){r==="map"?(document.body.classList.remove("dark"),document.body.classList.add("light")):(document.body.classList.remove("light"),document.body.classList.add("dark"))},changeViewMode(r){this.changeBodyTheme(r),Y.log("currentViewMode"),b.Z.$emit("map:changeViewMode",r)},getMap(){return this.$refs.gismap.map}}},H=it,V=o(68141),m=(0,V.Z)(H,O,n,!1,null,null,null),D=m.exports},54583:function(dt,Q,o){"use strict";o.d(Q,{V:function(){return K}});var O=o(93843),n=o(55825),a=o(96231),t=o(32450),e=o(2073),i=o(65077),f=o(12059),I=o(45059),j=o(76094),b=o(95232),R=o(24918),q=function(){var _=function(W,c){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,F){M.__proto__=F}||function(M,F){for(var X in F)Object.prototype.hasOwnProperty.call(F,X)&&(M[X]=F[X])},_(W,c)};return function(W,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");_(W,c);function M(){this.constructor=W}W.prototype=c===null?Object.create(c):(M.prototype=c.prototype,new M)}}(),K=function(_){q(W,_);function W(c,M){var F=_.call(this,c)||this;return F.layer=M,F}return W}(t.ZP),$={LAYERS:"layers"},G=function(_){q(W,_);function W(c){var M=this,F=c||{},X=(0,I.f0)({},F);delete X.layers;var k=F.layers;return M=_.call(this,X)||this,M.on,M.once,M.un,M.layersListenerKeys_=[],M.listenerKeys_={},M.addChangeListener($.LAYERS,M.handleLayersChanged_),k?Array.isArray(k)?k=new n.Z(k.slice(),{unique:!0}):(0,f.h)(typeof k.getArray=="function",43):k=new n.Z(void 0,{unique:!0}),M.setLayers(k),M}return W.prototype.handleLayerChange_=function(){this.changed()},W.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(R.bN),this.layersListenerKeys_.length=0;var c=this.getLayers();this.layersListenerKeys_.push((0,R.oL)(c,a.Z.ADD,this.handleLayersAdd_,this),(0,R.oL)(c,a.Z.REMOVE,this.handleLayersRemove_,this));for(var M in this.listenerKeys_)this.listenerKeys_[M].forEach(R.bN);(0,I.ZH)(this.listenerKeys_);for(var F=c.getArray(),X=0,k=F.length;X<k;X++){var ht=F[X];this.registerLayerListeners_(ht),this.dispatchEvent(new K("addlayer",ht))}this.changed()},W.prototype.registerLayerListeners_=function(c){var M=[(0,R.oL)(c,i.Z.PROPERTYCHANGE,this.handleLayerChange_,this),(0,R.oL)(c,e.Z.CHANGE,this.handleLayerChange_,this)];c instanceof W&&M.push((0,R.oL)(c,"addlayer",this.handleLayerGroupAdd_,this),(0,R.oL)(c,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,b.sq)(c)]=M},W.prototype.handleLayerGroupAdd_=function(c){this.dispatchEvent(new K("addlayer",c.layer))},W.prototype.handleLayerGroupRemove_=function(c){this.dispatchEvent(new K("removelayer",c.layer))},W.prototype.handleLayersAdd_=function(c){var M=c.element;this.registerLayerListeners_(M),this.dispatchEvent(new K("addlayer",M)),this.changed()},W.prototype.handleLayersRemove_=function(c){var M=c.element,F=(0,b.sq)(M);this.listenerKeys_[F].forEach(R.bN),delete this.listenerKeys_[F],this.dispatchEvent(new K("removelayer",M)),this.changed()},W.prototype.getLayers=function(){return this.get($.LAYERS)},W.prototype.setLayers=function(c){var M=this.getLayers();if(M)for(var F=M.getArray(),X=0,k=F.length;X<k;++X)this.dispatchEvent(new K("removelayer",F[X]));this.set($.LAYERS,c)},W.prototype.getLayersArray=function(c){var M=c!==void 0?c:[];return this.getLayers().forEach(function(F){F.getLayersArray(M)}),M},W.prototype.getLayerStatesArray=function(c){var M=c!==void 0?c:[],F=M.length;this.getLayers().forEach(function(H){H.getLayerStatesArray(M)});var X=this.getLayerState(),k=X.zIndex;!c&&X.zIndex===void 0&&(k=0);for(var ht=F,Y=M.length;ht<Y;ht++){var it=M[ht];it.opacity*=X.opacity,it.visible=it.visible&&X.visible,it.maxResolution=Math.min(it.maxResolution,X.maxResolution),it.minResolution=Math.max(it.minResolution,X.minResolution),it.minZoom=Math.max(it.minZoom,X.minZoom),it.maxZoom=Math.min(it.maxZoom,X.maxZoom),X.extent!==void 0&&(it.extent!==void 0?it.extent=(0,j.getIntersection)(it.extent,X.extent):it.extent=X.extent),it.zIndex===void 0&&(it.zIndex=k)}return M},W.prototype.getSourceState=function(){return"ready"},W}(O.Z);Q.Z=G}}]);
