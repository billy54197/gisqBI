"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[3809],{56279:function(I,f,s){s.d(f,{P:function(){return u}});var x=s(86892),l=s(49500);const u={mixins:[x.D],created(){},methods:{lifecycleBeforeChartsLoad(c){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&l.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),l.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let p=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[c]);if(p)return p}return c},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&l.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),l.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},44513:function(I,f,s){s.d(f,{Z:function(){return m}});var x=function(){var i=this,g=i._self._c;return i.attr.buttonHide?g("div",{style:{position:"absolute",right:i.attr.buttonHideRight+"px",top:i.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(w){return i.onHide()}}},[i.openTooltip?g("el-tooltip",{attrs:{"open-delay":1e3,content:i.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[g("el-button",{class:i.attr.buttonHideIconClass&&i.attr.buttonHideIconClass!=""?i.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:i.attr.buttonHideColor,fontSize:i.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):g("el-button",{class:i.attr.buttonHideIconClass&&i.attr.buttonHideIconClass!=""?i.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:i.attr.buttonHideColor,fontSize:i.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):i._e()},l=[],u=s(52246),c={props:["attr"],name:"hide-button",data(){return{isPc:u.b}},computed:{openTooltip:function(){let b=!1,i=this.attr.buttonHideTooltipContent;return u.b&&i&&i!=null&&i.trim()!=""&&(b=!0),b}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},v=c,p=s(68141),y=(0,p.Z)(v,x,l,!1,null,"bf399b9a",null),m=y.exports},13809:function(I,f,s){s.r(f),s.d(f,{default:function(){return E}});var x=function(){var o=this,e=o._self._c;return e("div",{ref:"comFixedboxDom"},[e("hide-button",{attrs:{attr:o.widgetInfo.attr}}),e("div",{ref:"comFixedbox",staticClass:"com-fixedbox",style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:o.widgetInfo.config.tooltip.show&&o.hover,expression:"widgetInfo.config.tooltip.show && hover"}],ref:"fixedboxPopup",attrs:{id:"fixedbox-popup"}},[e("div",{staticClass:"popper-arrow"})]),e("div",{ref:"fixedbox",attrs:{id:"fixedbox"},on:{mouseover:o.mouseover,mouseleave:o.mouseleave,mousedown:o.mousedown,mousemove:o.mousemove,mouseup:o.mouseup,touchstart:o.touchstart,touchmove:o.touchmove,touchend:o.touchend}},[o._v(" "+o._s(o.widgetInfo.config.fixedbox.text)+" ")])])],1)},l=[],u=s(44513),c=s(45061),v=s(26711),p=s(56279),y=s(48836),m=s(52246),b=s(21300),i=s(55616),g=s(27966),w=s(49500),S={name:"ComFixedbox",components:{HideButton:u.Z},mixins:[c.u,v.H,p.P],props:["widgetInfo"],data(){return{hover:!1,startX:0,startY:0,endX:0,endY:0,mousedownStatus:!1,mouseMove:!1,touchMove:!1,touch:1,timmer:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),window.addEventListener("mousemove",t=>{this.mousedownStatus&&this.mousemove(t)})},computed:{...(0,y.Se)(["getWidgets"])},methods:{loadInfo(t){let o=document.getElementById("myBoardArea"),e=0,a=0;if(!o){let d=this.$refs.comFixedboxDom.parentNode.parentNode.parentNode;d.style.position="fixed",d.style.left=e+t.attr.x+"px",d.style.top=a+t.attr.y+"px",d.style.display=t.attr.hide?"none":"",document.getElementsByTagName("body")[0].appendChild(d)}let n=this.$refs.fixedbox;n.style.width=t.config.fixedbox.width+"px",n.style.height=t.config.fixedbox.height+"px",n.style.borderRadius=t.config.fixedbox.borderRadius+"px",n.style.backgroundColor=t.config.fixedbox.backgroundColor,n.style.backgroundImage=this.getImageUrl(t.config.fixedbox.backgroundImage),n.style.backgroundSize=t.config.fixedbox.backgroundSize;let r=this.$refs.fixedboxPopup.querySelector(".popper-arrow"),C=(t.config.tooltip.shadowOffsetX||0)+"px "+(t.config.tooltip.shadowOffsetY||0)+"px "+(t.config.tooltip.shadowBlur||0)+"px "+t.config.tooltip.shadowColor||"rgba(0,0,0,0)";if(C+=t.config.tooltip.inset?" inset":"",t.config.tooltip.show&&!o&&t.config.tooltip.bindWidgetId){let d=this.$refs.fixedboxPopup,h=document.querySelector("#widget_"+t.config.tooltip.bindWidgetId);d.style.right=t.config.tooltip.right+"px",d.style.bottom=t.config.tooltip.bottom+t.attr.h+"px",d.style.boxShadow=C,h&&(d.style.borderRadius=h.style.borderRadius,h.style.position="static",d.appendChild(h),r.style.right=parseInt(h.style.width)*.2+"px",r.style.borderTopColor=h.style.backgroundColor,r.style.display=h?"inline-block":"none",r.style.bottom="-16px")}else t.config.tooltip.show&&!o&&(r.style.display="none");this.lifecycleAfterLoad()},reLoadInfo(t){t&&(this.$refs.comFixedbox.style.width=t.attr.w+"px",this.$refs.comFixedbox.style.height=t.attr.hh+"px"),this.loadInfo(t)},initAction(t){this.actionSendout(t),this.actionReceive(t)},getImageUrl(t){if(t&&t!="")return"url("+b.appendImageBaseURL(t)+")"},mouseover(){m.b&&(this.hover=!0)},mouseleave(){m.b&&(this.hover=!1)},mousedown(t){if(m.b){this.mousedownStatus=!0;let o=document.getElementById("fixedbox"),e=t.clientX,a=t.clientY,n=o.offsetLeft,r=o.offsetTop;this.startX=e-n,this.startY=a-r}},mousemove(t){if(this.mousedownStatus&&this.widgetInfo.config.fixedbox&&this.widgetInfo.config.fixedbox.draggable){this.mouseMove=!0;let o=t.clientX,e=t.clientY;this.endX=o,this.endY=e;let a=this.endX-this.startX,n=this.endY-this.startY;this.widgetInfo.attr.x=this.widgetInfo.attr.x+a,this.widgetInfo.attr.y=this.widgetInfo.attr.y+n,this.startX=this.endX,this.startY=this.endY}},mouseup(){m.b&&(this.mousedownStatus=!1,this.mouseMove?(this.startX=this.startY=this.endX=this.endY=0,this.mouseMove=!1):this.clickEvent())},touchstart(t){var o=t.targetTouches[0];this.startX=o.pageX,this.startY=o.pageY},touchmove(t){if(this.widgetInfo.config.fixedbox&&this.widgetInfo.config.fixedbox.draggable){t.preventDefault(),this.touchMove=!0;var o=t.targetTouches[0];this.endX=o.pageX,this.endY=o.pageY;let e=this.endX-this.startX,a=this.endY-this.startY;(this.startY!=Math.abs(a)||this.startX!=Math.abs(e))&&(this.widgetInfo.attr.x=this.widgetInfo.attr.x+e,this.widgetInfo.attr.y=this.widgetInfo.attr.y+a,this.startX=this.endX,this.startY=this.endY)}},touchend(){this.touchMove?(this.startX=this.startY=this.endX=this.endY=0,this.touchMove=!1):this.touch==1?(this.touch++,this.timmer=setTimeout(()=>{this.touch=1,this.hover=!this.hover},300)):this.touch==2&&(clearTimeout(this.timmer),this.touch=1,this.clickEvent())},clickEvent(){let t=this,o=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(o,e=>{if(e.enabled&&e.code==t.$$global_editor.actionType.click.code){document.getElementById("my_bi_screen").parentNode.scroll({top:0,behavior:"smooth"});let n=e.code+"_"+this.widgetInfo.id,r={};if(e.paramsExtend&&e.paramsExtend.length>0&&this.getExtendParams(r,e.paramsExtend),e.script&&e.script.enabled)if(w.log("Execute script for "+this.widgetInfo.name+" component to "+e.name+" component"),e.script.content)this.customScript=new Function("param",e.script.content),r=this.customScript(r);else{i.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}g.Z.$emit(n,r),e.postMessage&&this.doPostMessage(r),this.actionNameList.push(n)}else if(e.enabled&&e.code==this.$$global_editor.actionType.openLink.code){let a={};e.paramsExtend&&e.paramsExtend.length>0&&this.getExtendParams(a,e.paramsExtend);try{if(e.script&&e.script.enabled)if(w.log("Execute script for "+e.name+" action"),e.script.content)this.customScript=new Function("param",e.script.content),a=this.customScript(a);else{i.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}}catch(n){w.error("\u81EA\u5B9A\u4E49\u811A\u672C\u51FA\u9519\uFF1A",n)}this.openLinkAction(e,a)}})}}},L=S,X=s(68141),Y=(0,X.Z)(L,x,l,!1,null,"4cc2410a",null),E=Y.exports}}]);
