"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[87162],{579023:function(P){function _(){return _=Object.assign?Object.assign.bind():function(u){for(var r,f=1;f<arguments.length;f++)for(var i in r=arguments[f],r)Object.prototype.hasOwnProperty.call(r,i)&&(u[i]=r[i]);return u},_.apply(this,arguments)}var s=["attrs","props","domProps"],h=["class","style","directives"],p=["on","nativeOn"],c=function(u){return u.reduce(function(r,f){for(var i in f)if(!r[i])r[i]=f[i];else if(s.indexOf(i)!==-1)r[i]=_({},r[i],f[i]);else if(h.indexOf(i)!==-1){var g=r[i]instanceof Array?r[i]:[r[i]],o=f[i]instanceof Array?f[i]:[f[i]];r[i]=[].concat(g,o)}else if(p.indexOf(i)!==-1)for(var m in f[i])if(r[i][m]){var I=r[i][m]instanceof Array?r[i][m]:[r[i][m]],T=f[i][m]instanceof Array?f[i][m]:[f[i][m]];r[i][m]=[].concat(I,T)}else r[i][m]=f[i][m];else if(i==="hook")for(var S in f[i])r[i][S]=r[i][S]?d(r[i][S],f[i][S]):f[i][S];else r[i]=f[i];return r},{})},d=function(u,r){return function(){u&&u.apply(this,arguments),r&&r.apply(this,arguments)}};P.exports=c},691905:function(){},586569:function(){},56279:function(P,_,s){s.d(_,{P:function(){return c}});var h=s(386892),p=s(149500);const c={mixins:[h.D],created(){},methods:{lifecycleBeforeChartsLoad(d){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&p.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let r=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[d]);if(r)return r}return d},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&p.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(P,_,s){s.d(_,{X:function(){return h},b:function(){return p}});let h={versions:function(){var c=navigator.userAgent;return{trident:c.indexOf("Trident")>-1,presto:c.indexOf("Presto")>-1,webKit:c.indexOf("AppleWebKit")>-1,gecko:c.indexOf("Gecko")>-1&&c.indexOf("KHTML")==-1,mobile:!!c.match(/AppleWebKit.*Mobile.*/),ios:!!c.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:c.indexOf("Android")>-1,iPhone:c.indexOf("iPhone")>-1,iPad:c.indexOf("iPad")>-1,webApp:c.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},p;h.versions.mobile||h.versions.ios||h.versions.android||h.versions.iPhone||h.versions.iPad?p=!1:p=!0},112645:function(P,_,s){var h=s(579023),p=s.n(h),c=s(439733),d=s(281602),u=s(153673),r=(0,c.d)("info"),f=r[0],i=r[1];function g(o,m,I,T){var S=m.dot,A=m.info,B=(0,d.Xq)(A)&&A!=="";if(!(!S&&!B))return o("div",p()([{class:i({dot:S})},(0,u.ED)(T,!0)]),[S?"":m.info])}g.props={dot:Boolean,info:[Number,String]},_.Z=f(g)},656971:function(P,_,s){s.d(_,{Z:function(){return r}});var h=s(42160),p=s(982051),c={name:"\u59D3\u540D",tel:"\u7535\u8BDD",save:"\u4FDD\u5B58",confirm:"\u786E\u8BA4",cancel:"\u53D6\u6D88",delete:"\u5220\u9664",complete:"\u5B8C\u6210",loading:"\u52A0\u8F7D\u4E2D...",telEmpty:"\u8BF7\u586B\u5199\u7535\u8BDD",nameEmpty:"\u8BF7\u586B\u5199\u59D3\u540D",nameInvalid:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u59D3\u540D",confirmDelete:"\u786E\u5B9A\u8981\u5220\u9664\u5417",telInvalid:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7",vanCalendar:{end:"\u7ED3\u675F",start:"\u5F00\u59CB",title:"\u65E5\u671F\u9009\u62E9",confirm:"\u786E\u5B9A",startEnd:"\u5F00\u59CB/\u7ED3\u675F",weekdays:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],monthTitle:function(i,g){return i+"\u5E74"+g+"\u6708"},rangePrompt:function(i){return"\u9009\u62E9\u5929\u6570\u4E0D\u80FD\u8D85\u8FC7 "+i+" \u5929"}},vanCascader:{select:"\u8BF7\u9009\u62E9"},vanContactCard:{addText:"\u6DFB\u52A0\u8054\u7CFB\u4EBA"},vanContactList:{addText:"\u65B0\u5EFA\u8054\u7CFB\u4EBA"},vanPagination:{prev:"\u4E0A\u4E00\u9875",next:"\u4E0B\u4E00\u9875"},vanPullRefresh:{pulling:"\u4E0B\u62C9\u5373\u53EF\u5237\u65B0...",loosing:"\u91CA\u653E\u5373\u53EF\u5237\u65B0..."},vanSubmitBar:{label:"\u5408\u8BA1\uFF1A"},vanCoupon:{unlimited:"\u65E0\u4F7F\u7528\u95E8\u69DB",discount:function(i){return i+"\u6298"},condition:function(i){return"\u6EE1"+i+"\u5143\u53EF\u7528"}},vanCouponCell:{title:"\u4F18\u60E0\u5238",tips:"\u6682\u65E0\u53EF\u7528",count:function(i){return i+"\u5F20\u53EF\u7528"}},vanCouponList:{empty:"\u6682\u65E0\u4F18\u60E0\u5238",exchange:"\u5151\u6362",close:"\u4E0D\u4F7F\u7528\u4F18\u60E0\u5238",enable:"\u53EF\u7528",disabled:"\u4E0D\u53EF\u7528",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u7801"},vanAddressEdit:{area:"\u5730\u533A",postal:"\u90AE\u653F\u7F16\u7801",areaEmpty:"\u8BF7\u9009\u62E9\u5730\u533A",addressEmpty:"\u8BF7\u586B\u5199\u8BE6\u7EC6\u5730\u5740",postalEmpty:"\u90AE\u653F\u7F16\u7801\u683C\u5F0F\u4E0D\u6B63\u786E",defaultAddress:"\u8BBE\u4E3A\u9ED8\u8BA4\u6536\u8D27\u5730\u5740",telPlaceholder:"\u6536\u8D27\u4EBA\u624B\u673A\u53F7",namePlaceholder:"\u6536\u8D27\u4EBA\u59D3\u540D",areaPlaceholder:"\u9009\u62E9\u7701 / \u5E02 / \u533A"},vanAddressEditDetail:{label:"\u8BE6\u7EC6\u5730\u5740",placeholder:"\u8857\u9053\u95E8\u724C\u3001\u697C\u5C42\u623F\u95F4\u53F7\u7B49\u4FE1\u606F"},vanAddressList:{add:"\u65B0\u589E\u5730\u5740"}},d=h.default.prototype,u=h.default.util.defineReactive;u(d,"$vantLang","zh-CN"),u(d,"$vantMessages",{"zh-CN":c});var r={messages:function(){return d.$vantMessages[d.$vantLang]},use:function(i,g){var o;d.$vantLang=i,this.add((o={},o[i]=g,o))},add:function(i){i===void 0&&(i={}),(0,p.n)(d.$vantMessages,i)}}},406053:function(P,_,s){s.d(_,{X:function(){return c}});var h=s(750068),p=0;function c(d){var u="binded_"+p++;function r(){this[u]||(d.call(this,h.on,!0),this[u]=!0)}function f(){this[u]&&(d.call(this,h.S1,!1),this[u]=!1)}return{mounted:r,activated:r,deactivated:f,beforeDestroy:f}}},640654:function(P,_,s){s.d(_,{H:function(){return h}});var h={methods:{slots:function(c,d){c===void 0&&(c="default");var u=this.$slots,r=this.$scopedSlots,f=r[c];return f?f(d):u[c]}}}},734672:function(P,_,s){s.d(_,{D:function(){return d}});var h=s(750068),p=10;function c(u,r){return u>r&&u>p?"horizontal":r>u&&r>p?"vertical":""}var d={data:function(){return{direction:""}},methods:{touchStart:function(r){this.resetTouchStatus(),this.startX=r.touches[0].clientX,this.startY=r.touches[0].clientY},touchMove:function(r){var f=r.touches[0];this.deltaX=f.clientX-this.startX,this.deltaY=f.clientY-this.startY,this.offsetX=Math.abs(this.deltaX),this.offsetY=Math.abs(this.deltaY),this.direction=this.direction||c(this.offsetX,this.offsetY)},resetTouchStatus:function(){this.direction="",this.deltaX=0,this.deltaY=0,this.offsetX=0,this.offsetY=0},bindTouchEvent:function(r){var f=this.onTouchStart,i=this.onTouchMove,g=this.onTouchEnd;(0,h.on)(r,"touchstart",f),(0,h.on)(r,"touchmove",i),g&&((0,h.on)(r,"touchend",g),(0,h.on)(r,"touchcancel",g))}}}},524018:function(P,_,s){s.d(_,{N:function(){return p}});function h(c,d){return d?typeof d=="string"?" "+c+"--"+d:Array.isArray(d)?d.reduce(function(u,r){return u+h(c,r)},""):Object.keys(d).reduce(function(u,r){return u+(d[r]?h(c,r):"")},""):""}function p(c){return function(d,u){return d&&typeof d!="string"&&(u=d,d=""),d=d?c+"__"+d:c,""+d+h(d,u)}}},282519:function(P,_,s){s.d(_,{L:function(){return f}});var h=s(281602),p=s(433303),c=s(640654);function d(i){var g=this.name;i.component(g,this),i.component((0,p._)("-"+g),this)}function u(i){var g=i.scopedSlots||i.data.scopedSlots||{},o=i.slots();return Object.keys(o).forEach(function(m){g[m]||(g[m]=function(){return o[m]})}),g}function r(i){return{functional:!0,props:i.props,model:i.model,render:function(o,m){return i(o,m.props,u(m),m)}}}function f(i){return function(g){return(0,h.mf)(g)&&(g=r(g)),g.functional||(g.mixins=g.mixins||[],g.mixins.push(c.H)),g.name=i,g.install=d,g}}},778412:function(P,_,s){s.d(_,{e:function(){return d}});var h=s(281602),p=s(433303),c=s(656971);function d(u){var r=(0,p._)(u)+".";return function(f){for(var i=c.Z.messages(),g=(0,h.U2)(i,r+f)||(0,h.U2)(i,f),o=arguments.length,m=new Array(o>1?o-1:0),I=1;I<o;I++)m[I-1]=arguments[I];return(0,h.mf)(g)?g.apply(void 0,m):g}}},439733:function(P,_,s){s.d(_,{d:function(){return d}});var h=s(524018),p=s(282519),c=s(778412);function d(u){return u="van-"+u,[(0,p.L)(u),(0,h.N)(u),(0,c.e)(u)]}},982051:function(P,_,s){s.d(_,{n:function(){return d}});var h=s(281602),p=Object.prototype.hasOwnProperty;function c(u,r,f){var i=r[f];(0,h.Xq)(i)&&(!p.call(u,f)||!(0,h.Kn)(i)?u[f]=i:u[f]=d(Object(u[f]),r[f]))}function d(u,r){return Object.keys(r).forEach(function(f){c(u,r,f)}),u}},750068:function(P,_,s){s.d(_,{PF:function(){return f},S1:function(){return u},on:function(){return d}});var h=s(281602),p=!1;if(!h.sk)try{var c={};Object.defineProperty(c,"passive",{get:function(){p=!0}}),window.addEventListener("test-passive",null,c)}catch{}function d(i,g,o,m){m===void 0&&(m=!1),h.sk||i.addEventListener(g,o,p?{capture:!1,passive:m}:!1)}function u(i,g,o){h.sk||i.removeEventListener(g,o)}function r(i){i.stopPropagation()}function f(i,g){(typeof i.cancelable!="boolean"||i.cancelable)&&i.preventDefault(),g&&r(i)}},433303:function(P,_,s){s.d(_,{B:function(){return c},_:function(){return p}});var h=/-(\w)/g;function p(d){return d.replace(h,function(u,r){return r.toUpperCase()})}function c(d,u){u===void 0&&(u=2);for(var r=d+"";r.length<u;)r="0"+r;return r}},395982:function(P,_,s){s.d(_,{L:function(){return g},N:function(){return c}});var h=s(281602),p=s(931710);function c(o){if((0,h.Xq)(o))return o=String(o),(0,p.k)(o)?o+"px":o}var d;function u(){if(!d){var o=document.documentElement,m=o.style.fontSize||window.getComputedStyle(o).fontSize;d=parseFloat(m)}return d}function r(o){return o=o.replace(/rem/g,""),+o*u()}function f(o){return o=o.replace(/vw/g,""),+o*window.innerWidth/100}function i(o){return o=o.replace(/vh/g,""),+o*window.innerHeight/100}function g(o){if(typeof o=="number")return o;if(h._f){if(o.indexOf("rem")!==-1)return r(o);if(o.indexOf("vw")!==-1)return f(o);if(o.indexOf("vh")!==-1)return i(o)}return parseFloat(o)}},153673:function(P,_,s){s.d(_,{ED:function(){return u},LI:function(){return f},j8:function(){return r}});var h=s(604017),p=s(42160),c=["ref","style","class","attrs","refInFor","nativeOn","directives","staticClass","staticStyle"],d={nativeOn:"on"};function u(i,g){var o=c.reduce(function(m,I){return i.data[I]&&(m[d[I]||I]=i.data[I]),m},{});return g&&(o.on=o.on||{},(0,h.Z)(o.on,i.data.on)),o}function r(i,g){for(var o=arguments.length,m=new Array(o>2?o-2:0),I=2;I<o;I++)m[I-2]=arguments[I];var T=i.listeners[g];T&&(Array.isArray(T)?T.forEach(function(S){S.apply(void 0,m)}):T.apply(void 0,m))}function f(i,g){var o=new p.default({el:document.createElement("div"),props:i.props,render:function(I){return I(i,(0,h.Z)({props:this.$props},g))}});return document.body.appendChild(o.$el),o}},281602:function(P,_,s){s.d(_,{Kn:function(){return f},U2:function(){return g},Xq:function(){return u},ZT:function(){return d},_f:function(){return p},mf:function(){return r},sk:function(){return c},tI:function(){return i}});var h=s(42160),p=typeof window<"u",c=h.default.prototype.$isServer;function d(){}function u(o){return o!=null}function r(o){return typeof o=="function"}function f(o){return o!==null&&typeof o=="object"}function i(o){return f(o)&&r(o.then)&&r(o.catch)}function g(o,m){var I=m.split("."),T=o;return I.forEach(function(S){var A;T=(A=T[S])!=null?A:""}),T}},931710:function(P,_,s){s.d(_,{i:function(){return p},k:function(){return h}});function h(c){return/^\d+(\.\d+)?$/.test(c)}function p(c){return Number.isNaN?Number.isNaN(c):c!==c}},844513:function(P,_,s){s.d(_,{Z:function(){return i}});var h=function(){var o=this,m=o._self._c;return o.attr.buttonHide?m("div",{style:{position:"absolute",right:o.attr.buttonHideRight+"px",top:o.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(I){return o.onHide()}}},[o.openTooltip?m("el-tooltip",{attrs:{"open-delay":1e3,content:o.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[m("el-button",{class:o.attr.buttonHideIconClass&&o.attr.buttonHideIconClass!=""?o.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:o.attr.buttonHideColor,fontSize:o.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):m("el-button",{class:o.attr.buttonHideIconClass&&o.attr.buttonHideIconClass!=""?o.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:o.attr.buttonHideColor,fontSize:o.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):o._e()},p=[],c=s(752246),d={props:["attr"],name:"hide-button",data(){return{isPc:c.b}},computed:{openTooltip:function(){let g=!1,o=this.attr.buttonHideTooltipContent;return c.b&&o&&o!=null&&o.trim()!=""&&(g=!0),g}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},u=d,r=s(768141),f=(0,r.Z)(u,h,p,!1,null,"bf399b9a",null),i=f.exports},31133:function(P,_,s){s.r(_),s.d(_,{default:function(){return tt}});var h=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],staticClass:"my-div",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:t.widgetInfo.attr}}),e("div",{staticStyle:{display:"flex"}},[t.widgetInfo.config.prefixAttr.show?e("div",{style:{flex:"none",width:t.widgetInfo.config.prefixAttr.labelWidth+"px",display:"flex",justifyContent:t.widgetInfo.config.prefixAttr.justifyContent,alignItems:t.widgetInfo.config.prefixAttr.alignItems,fontSize:t.widgetInfo.config.prefixAttr.labelStyle.fontSize+"px",color:t.widgetInfo.config.prefixAttr.labelStyle.color,fontWeight:t.widgetInfo.config.prefixAttr.labelStyle.fontWeight,fontStyle:t.widgetInfo.config.prefixAttr.labelStyle.fontStyle,fontFamily:t.widgetInfo.config.prefixAttr.labelStyle.fontFamily,textDecoration:t.widgetInfo.config.prefixAttr.labelStyle.textDecoration}},[e("span",[t._v(" "+t._s(t.widgetInfo.config.prefixAttr.label)+" ")])]):t._e(),e("div",{style:{flex:"none",marginLeft:t.widgetInfo.config.signatureArea.marginLeft+"px",display:"flex",flexDirection:t.widgetInfo.config.feature.featurePoi==="right"?"row":"column"}},[t.show?e("vueSignature",{ref:"signature",staticClass:"signature-canvas",style:{overflow:"hidden",borderRadius:t.widgetInfo.config.signatureArea.borderRadius+"px",border:`solid ${t.widgetInfo.config.signatureArea.borderWidth}px ${t.widgetInfo.config.signatureArea.borderColor}`},attrs:{disabled:t.widgetInfo.config.signatureArea.disabled?t.widgetInfo.config.signatureArea.disabled:t.done,sigOption:t.getOption,w:t.widgetInfo.config.signatureArea.w+"px",h:t.widgetInfo.config.signatureArea.h+"px"},nativeOn:{touchstart:function(n){return t.touchStart.apply(null,arguments)},touchmove:function(n){return t.touchMove.apply(null,arguments)},touchend:function(n){return t.touchEnd.apply(null,arguments)}}}):t._e(),e("div",{style:{display:"flex",flexDirection:t.widgetInfo.config.feature.featurePoi==="right"?"column":"row",justifyContent:t.widgetInfo.config.feature.justifyContent}},t._l(t.featureList,function(n,l){return e("div",{key:n.value,staticClass:"feature-item",style:{textAlign:"center",lineHeight:t.widgetInfo.config.feature.buttonHeight+"px",width:t.widgetInfo.config.feature.buttonWidth+"px",height:t.widgetInfo.config.feature.buttonHeight+"px",border:`solid ${t.widgetInfo.config.feature.buttonBorderColor} ${t.widgetInfo.config.feature.buttonBorderWidth}px`,borderRadius:t.widgetInfo.config.feature.buttonBorderRadius+"px",marginTop:l===0&&t.widgetInfo.config.feature.featurePoi==="right"?0:t.widgetInfo.config.feature.buttonMarginTop+"px",marginLeft:l===0&&t.widgetInfo.config.feature.featurePoi==="bottom"?0:t.widgetInfo.config.feature.buttonMarginLeft+"px",fontSize:t.widgetInfo.config.feature.featureStyle.fontSize+"px",color:t.widgetInfo.config.feature.featureStyle.color,fontWeight:t.widgetInfo.config.feature.featureStyle.fontWeight,fontFamily:t.widgetInfo.config.feature.featureStyle.fontFamily,fontStyle:t.widgetInfo.config.feature.featureStyle.fontStyle,textDecoration:t.widgetInfo.config.feature.featureStyle.textDecoration,backgroundColor:t.widgetInfo.config.feature.buttonBackgroundColor,overflow:"hidden"},on:{click:function(v){return t.buttonClick(n.value)}}},[t._v(t._s(n.value==="save"&&t.done?"\u91CD\u7B7E":n.text))])}),0)],1)])],1)},p=[],c=s(232590),d=s(777714),u=function(){var t=this,e=t._self._c;return e("div",{style:{width:t.w,height:t.h},on:{touchmove:function(n){n.preventDefault()}}},[e("canvas",{staticClass:"canvas",attrs:{id:t.uid,"data-uid":t.uid,disabled:t.disabled}})])},r=[];/*!
 * Signature Pad v3.0.0-beta.4 | https://github.com/szimek/signature_pad
 * (c) 2020 Szymon Nowak | Released under the MIT license
 */class f{constructor(t,e,n){this.x=t,this.y=e,this.time=n||Date.now()}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y&&this.time===t.time}velocityFrom(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):0}}class i{constructor(t,e,n,l,v,y){this.startPoint=t,this.control2=e,this.control1=n,this.endPoint=l,this.startWidth=v,this.endWidth=y}static fromPoints(t,e){const n=this.calculateControlPoints(t[0],t[1],t[2]).c2,l=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new i(t[1],n,l,t[2],e.start,e.end)}static calculateControlPoints(t,e,n){const l=t.x-e.x,v=t.y-e.y,y=e.x-n.x,w=e.y-n.y,M={x:(t.x+e.x)/2,y:(t.y+e.y)/2},C={x:(e.x+n.x)/2,y:(e.y+n.y)/2},E=Math.sqrt(l*l+v*v),O=Math.sqrt(y*y+w*w),L=M.x-C.x,D=M.y-C.y,x=O/(E+O),b={x:C.x+L*x,y:C.y+D*x},W=e.x-b.x,R=e.y-b.y;return{c1:new f(M.x+W,M.y+R),c2:new f(C.x+W,C.y+R)}}length(){let e=0,n,l;for(let v=0;v<=10;v+=1){const y=v/10,w=this.point(y,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),M=this.point(y,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(v>0){const C=w-n,E=M-l;e+=Math.sqrt(C*C+E*E)}n=w,l=M}return e}point(t,e,n,l,v){return e*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*l*(1-t)*t*t+v*t*t*t}}function g(a,t=250){let e=0,n=null,l,v,y;const w=()=>{e=Date.now(),n=null,l=a.apply(v,y),n||(v=null,y=[])};return function(...C){const E=Date.now(),O=t-(E-e);return v=this,y=C,O<=0||O>t?(n&&(clearTimeout(n),n=null),e=E,l=a.apply(v,y),n||(v=null,y=[])):n||(n=window.setTimeout(w,O)),l}}class o{constructor(t,e={}){this.canvas=t,this.options=e,this._handleMouseDown=n=>{n.which===1&&(this._mouseButtonDown=!0,this._strokeBegin(n))},this._handleMouseMove=n=>{this._mouseButtonDown&&this._strokeMoveUpdate(n)},this._handleMouseUp=n=>{n.which===1&&this._mouseButtonDown&&(this._mouseButtonDown=!1,this._strokeEnd(n))},this._handleTouchStart=n=>{if(n.preventDefault(),n.targetTouches.length===1){const l=n.changedTouches[0];this._strokeBegin(l)}},this._handleTouchMove=n=>{n.preventDefault();const l=n.targetTouches[0];this._strokeMoveUpdate(l)},this._handleTouchEnd=n=>{if(n.target===this.canvas){n.preventDefault();const v=n.changedTouches[0];this._strokeEnd(v)}},this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._strokeMoveUpdate=this.throttle?g(o.prototype._strokeUpdate,this.throttle):o.prototype._strokeUpdate,this._ctx=t.getContext("2d"),this.clear(),this.on()}clear(){const{_ctx:t,canvas:e}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0}fromDataURL(t,e={},n){const l=new Image,v=e.ratio||window.devicePixelRatio||1,y=e.width||this.canvas.width/v,w=e.height||this.canvas.height/v;this._reset(),l.onload=()=>{this._ctx.drawImage(l,0,0,y,w),n&&n()},l.onerror=M=>{n&&n(M)},l.src=t,this._isEmpty=!1}toDataURL(t="image/png",e){switch(t){case"image/svg+xml":return this._toSVG();default:return this.canvas.toDataURL(t,e)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",window.PointerEvent?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.removeEventListener("pointerdown",this._handleMouseDown),this.canvas.removeEventListener("pointermove",this._handleMouseMove),document.removeEventListener("pointerup",this._handleMouseUp),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this.canvas.removeEventListener("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t){this.clear(),this._fromData(t,({color:e,curve:n})=>this._drawCurve({color:e,curve:n}),({color:e,point:n})=>this._drawDot({color:e,point:n})),this._data=t}toData(){return this._data}_strokeBegin(t){const e={color:this.penColor,points:[]};typeof this.onBegin=="function"&&this.onBegin(t),this._data.push(e),this._reset(),this._strokeUpdate(t)}_strokeUpdate(t){if(this._data.length===0){this._strokeBegin(t);return}const e=t.clientX,n=t.clientY,l=this._createPoint(e,n),v=this._data[this._data.length-1],y=v.points,w=y.length>0&&y[y.length-1],M=w?l.distanceTo(w)<=this.minDistance:!1,C=v.color;if(!w||!(w&&M)){const E=this._addPoint(l);w?E&&this._drawCurve({color:C,curve:E}):this._drawDot({color:C,point:l}),y.push({time:l.time,x:l.x,y:l.y})}}_strokeEnd(t){this._strokeUpdate(t),typeof this.onEnd=="function"&&this.onEnd(t)}_handlePointerEvents(){this._mouseButtonDown=!1,this.canvas.addEventListener("pointerdown",this._handleMouseDown),this.canvas.addEventListener("pointermove",this._handleMouseMove),document.addEventListener("pointerup",this._handleMouseUp)}_handleMouseEvents(){this._mouseButtonDown=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown),this.canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart),this.canvas.addEventListener("touchmove",this._handleTouchMove),this.canvas.addEventListener("touchend",this._handleTouchEnd)}_reset(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor}_createPoint(t,e){const n=this.canvas.getBoundingClientRect();return new f(t-n.left,e-n.top,new Date().getTime())}_addPoint(t){const{_lastPoints:e}=this;if(e.push(t),e.length>2){e.length===3&&e.unshift(e[0]);const n=this._calculateCurveWidths(e[1],e[2]),l=i.fromPoints(e,n);return e.shift(),l}return null}_calculateCurveWidths(t,e){const n=this.velocityFilterWeight*e.velocityFrom(t)+(1-this.velocityFilterWeight)*this._lastVelocity,l=this._strokeWidth(n),v={end:l,start:this._lastWidth};return this._lastVelocity=n,this._lastWidth=l,v}_strokeWidth(t){return Math.max(this.maxWidth/(t+1),this.minWidth)}_drawCurveSegment(t,e,n){const l=this._ctx;l.moveTo(t,e),l.arc(t,e,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve({color:t,curve:e}){const n=this._ctx,l=e.endWidth-e.startWidth,v=Math.floor(e.length())*2;n.beginPath(),n.fillStyle=t;for(let y=0;y<v;y+=1){const w=y/v,M=w*w,C=M*w,E=1-w,O=E*E,L=O*E;let D=L*e.startPoint.x;D+=3*O*w*e.control1.x,D+=3*E*M*e.control2.x,D+=C*e.endPoint.x;let x=L*e.startPoint.y;x+=3*O*w*e.control1.y,x+=3*E*M*e.control2.y,x+=C*e.endPoint.y;const b=Math.min(e.startWidth+C*l,this.maxWidth);this._drawCurveSegment(D,x,b)}n.closePath(),n.fill()}_drawDot({color:t,point:e}){const n=this._ctx,l=typeof this.dotSize=="function"?this.dotSize():this.dotSize;n.beginPath(),this._drawCurveSegment(e.x,e.y,l),n.closePath(),n.fillStyle=t,n.fill()}_fromData(t,e,n){for(const l of t){const{color:v,points:y}=l;if(y.length>1)for(let w=0;w<y.length;w+=1){const M=y[w],C=new f(M.x,M.y,M.time);this.penColor=v,w===0&&this._reset();const E=this._addPoint(C);E&&e({color:v,curve:E})}else this._reset(),n({color:v,point:y[0]})}}_toSVG(){const t=this._data,e=Math.max(window.devicePixelRatio||1,1),n=0,l=0,v=this.canvas.width/e,y=this.canvas.height/e,w=document.createElementNS("http://www.w3.org/2000/svg","svg");w.setAttribute("width",this.canvas.width.toString()),w.setAttribute("height",this.canvas.height.toString()),this._fromData(t,({color:D,curve:x})=>{const b=document.createElement("path");if(!isNaN(x.control1.x)&&!isNaN(x.control1.y)&&!isNaN(x.control2.x)&&!isNaN(x.control2.y)){const W=`M ${x.startPoint.x.toFixed(3)},${x.startPoint.y.toFixed(3)} C ${x.control1.x.toFixed(3)},${x.control1.y.toFixed(3)} ${x.control2.x.toFixed(3)},${x.control2.y.toFixed(3)} ${x.endPoint.x.toFixed(3)},${x.endPoint.y.toFixed(3)}`;b.setAttribute("d",W),b.setAttribute("stroke-width",(x.endWidth*2.25).toFixed(3)),b.setAttribute("stroke",D),b.setAttribute("fill","none"),b.setAttribute("stroke-linecap","round"),w.appendChild(b)}},({color:D,point:x})=>{const b=document.createElement("circle"),W=typeof this.dotSize=="function"?this.dotSize():this.dotSize;b.setAttribute("r",W.toString()),b.setAttribute("cx",x.x.toString()),b.setAttribute("cy",x.y.toString()),b.setAttribute("fill",D),w.appendChild(b)});const M="data:image/svg+xml;base64,",C=`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="${n} ${l} ${v} ${y}" width="${v}" height="${y}">`;let E=w.innerHTML;if(E===void 0){const D=document.createElement("dummy"),x=w.childNodes;D.innerHTML="";for(let b=0;b<x.length;b+=1)D.appendChild(x[b].cloneNode(!0));E=D.innerHTML}const O="</svg>",L=C+E+O;return M+btoa(L)}}var m=o,I={name:"vueSignature",props:{sigOption:{type:Object,default:()=>({backgroundColor:"rgb(255,255,255)",penColor:"rgb(0, 0, 0)"})},w:{type:String,default:"100%"},h:{type:String,default:"100%"},clearOnResize:{type:Boolean,default:!1},waterMark:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},defaultUrl:{type:String,default:""}},data(){return{sig:()=>{},option:{backgroundColor:"rgb(255,255,255)",penColor:"rgb(0, 0, 0)"},uid:""}},watch:{disabled(a){var t=this;a?t.sig.off():t.sig.on()}},created(){var a=this;this.uid="canvas"+a._uid;var t=Object.keys(a.sigOption);for(var e of t)a.option[e]=a.sigOption[e]},methods:{draw(){var a=this,t=document.getElementById(a.uid);a.sig=new m(t,a.option);function e(n){var l;a.isEmpty()||(l=a.save());var v=Math.max(window.devicePixelRatio||1,1);n.width=n.offsetWidth*v,n.height=n.offsetHeight*v,n.getContext("2d").scale(v,v),a.clear(),!a.clearOnResize&&l!==void 0&&a.fromDataURL(l),Object.keys(a.waterMark).length&&a.addWaterMark(a.waterMark)}window.addEventListener("resize",e(t)),e(t),a.defaultUrl!==""&&a.fromDataURL(a.defaultUrl),a.disabled?a.sig.off():a.sig.on()},clear(){var a=this;a.sig.clear()},save(a){var t=this;return a?t.sig.toDataURL(a):t.sig.toDataURL()},fromDataURL(a){var t=this;t.sig.fromDataURL(a)},isEmpty(){var a=this;return a.sig.isEmpty()},undo(){var a=this,t=a.sig.toData();t&&(t.pop(),a.sig.fromData(t))},addWaterMark(a){var t=this;if(Object.prototype.toString.call(a)!="[object Object]")throw new Error("Expected Object, got "+typeof a+".");var e=document.getElementById(t.uid),n={text:a.text||"",x:a.x||20,y:a.y||20,sx:a.sx||40,sy:a.sy||40},l=e.getContext("2d");l.font=a.font||"20px sans-serif",l.fillStyle=a.fillStyle||"#333",l.strokeStyle=a.strokeStyle||"#333",a.style=="all"?(l.fillText(n.text,n.x,n.y),l.strokeText(n.text,n.sx,n.sx)):a.style=="stroke"?l.strokeText(n.text,n.sx,n.sx):l.fillText(n.text,n.x,n.y),t.sig._isEmpty=!1}},mounted(){var a=this;this.$nextTick().then(()=>{a.draw()})}},T=I,S=s(768141),A=(0,S.Z)(T,u,r,!1,null,null,null),B=A.exports,U=B,$=s(844513),F=s(767467),k=s(67157);const z={mixins:[k.c],data(){return{config_extend:{},filter_config:{prefixAttr:{labelStyle:{fontFamily:"alibabaPuHuiTiRegular",color:"#303133"}},signatureArea:{borderColor:"#DBDFE6",penColor:"rgba(0,0,0,1)",backgroundColor:"rgba(255,255,255,1)"},feature:{waterMartTextStyle:{color:"#4f5053"},featureStyle:{color:"#ffffff",fontFamily:"alibabaPuHuiTiRegular"},buttonBackgroundColor:"#4C84FF",buttonBorderColor:"rgba(122,122,122,1)"}}}},methods:{filterPredefineColoursSchemeConfig(a,t){this.getNewConfigWithArrary(a,t,this.filter_config)}}};var N=s(445061),j=s(723400),H=s(386892),K=s(126711),X=s(56279),Z=s(148836),Y=s(927966),V=s(555616),G=s(149500),J={name:"form-signature",props:["widgetInfo"],components:{HideButton:$.Z,vueSignature:U,Toast:d.Z},mixins:[F.baseConfig,z,N.u,j.j,H.D,K.H,X.P],data(){return{show:!1,done:!1}},watch:{"currentWidget.id":{deep:!0,handler:function(a){if(!a){this.widgetInfo.attr.hide=!0;return}a===this.widgetInfo.id||this.isParent(a,this.widgetInfo.id,this.getWidgetAllArr)?this.widgetInfo.attr.hide=!1:this.widgetInfo.attr.hide=!0}},"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)},"widgetInfo.config.signatureArea.backgroundColor":{deep:!0,handler(){this.show=!1,this.$nextTick(()=>{this.show=!0})}}},methods:{loadInfo(a){this.lifecycleAfterLoad()},reLoadInfo(a){this.loadInfo(a)},clear(){this.done||(this.$refs.signature.clear(),this.widgetInfo.config.feature.clearToast&&(0,d.Z)({type:"success",message:`${this.widgetInfo.config.feature.clearText}\u6210\u529F`}))},undo(){this.done||(this.$refs.signature.undo(),this.widgetInfo.config.feature.undoToast&&(0,d.Z)({type:"success",message:`${this.widgetInfo.config.feature.undoText}\u6210\u529F`}))},waterMark(){this.done||(this.$refs.signature.addWaterMark({text:this.widgetInfo.config.feature.waterMarkContent,font:`${this.widgetInfo.config.feature.waterMartTextStyle.fontSize}px ${this.widgetInfo.config.feature.waterMartTextStyle.fontFamily}`,style:this.widgetInfo.config.feature.waterMarkType,fillStyle:this.widgetInfo.config.feature.waterMartTextStyle.color,strokeStyle:this.widgetInfo.config.feature.waterMartTextStyle.color,x:this.widgetInfo.config.feature.waterMarkPoiX/(this.getCanvasSetting.width/window.innerWidth),y:this.widgetInfo.config.feature.waterMarkPoiY/(this.getCanvasSetting.width/window.innerWidth),sx:this.widgetInfo.config.feature.waterMarkType==="all"?this.widgetInfo.config.feature.waterMarkPoiX/(this.getCanvasSetting.width/window.innerWidth)+30:this.widgetInfo.config.feature.waterMarkPoiX/(this.getCanvasSetting.width/window.innerWidth),sy:this.widgetInfo.config.feature.waterMarkType==="all"?this.widgetInfo.config.feature.waterMarkPoiY/(this.getCanvasSetting.width/window.innerWidth)+30:this.widgetInfo.config.feature.waterMarkPoiY/(this.getCanvasSetting.width/window.innerWidth)}),this.widgetInfo.config.feature.waterMarkToast&&(0,d.Z)({type:"success",message:`${this.widgetInfo.config.feature.waterMarkText}\u6210\u529F`}))},save(){if(this.done)this.done=!1,this.clear();else{const a=this.$refs.signature.save(this.widgetInfo.config.feature.saveType);this.signatureDone(a),this.done=!0,this.widgetInfo.config.feature.saveToast&&(0,d.Z)({type:"success",message:"\u7B7E\u540D\u5B8C\u6210"})}},signatureDone(a){let t=this,e=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(e,n=>{if(n.enabled&&n.code=="done"){let l="done_"+t.widgetInfo.id,v={url:a};if(n.paramsExtend&&n.paramsExtend.length>0&&this.getExtendParams(v,n.paramsExtend),n.script&&n.script.enabled){if(G.log("Execute script for "+this.widgetInfo.name+" component to "+n.name+" component"),n.script.content==""){V.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",n.script.content),v=this.customScript(v)}Y.Z.$emit(l,v),n.postMessage&&this.doPostMessage(v),this.actionNameList.push(l)}})},buttonClick(a){this[a]()},initAction(a){this.actionReceive(a)},touchStart(a){this.widgetInfo.config.signatureArea.stopPropagation&&a.stopPropagation()},touchMove(a){this.widgetInfo.config.signatureArea.stopPropagation&&a.stopPropagation()},touchEnd(a){this.widgetInfo.config.signatureArea.stopPropagation&&a.stopPropagation()}},computed:{...(0,Z.Se)(["isView"]),getOption(){return{penColor:this.widgetInfo.config.signatureArea.penColor,backgroundColor:this.widgetInfo.config.signatureArea.backgroundColor}},featureList(){let a=[];a.push({value:"save",text:this.widgetInfo.config.feature.saveText,sort:this.widgetInfo.config.feature.saveSort,open:this.widgetInfo.config.feature.save}),a.push({value:"undo",text:this.widgetInfo.config.feature.undoText,sort:this.widgetInfo.config.feature.undoSort,open:this.widgetInfo.config.feature.undo}),a.push({value:"clear",text:this.widgetInfo.config.feature.clearText,sort:this.widgetInfo.config.feature.clearSort,open:this.widgetInfo.config.feature.clear});let t=[];return t=a.filter(e=>e.open),t.sort((e,n)=>e.sort-n.sort),t}},mounted(){this.show=!0,this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)}},Q=J,q=(0,S.Z)(Q,h,p,!1,null,"1822586d",null),tt=q.exports},604017:function(P,_,s){s.d(_,{Z:function(){return h}});function h(){return h=Object.assign?Object.assign.bind():function(p){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var u in d)Object.prototype.hasOwnProperty.call(d,u)&&(p[u]=d[u])}return p},h.apply(this,arguments)}}}]);
