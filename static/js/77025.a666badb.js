"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[77025],{598521:function(Z,v,o){var u=o(275770),g=o(927966),l=o(555616),E=o.n(l),P=o(149500);v.Z={autoShow(A,I,O){let r=A;if(r.innerAutoShowInterval&&r.innerAutoShowInterval>-1&&(clearInterval(r.innerAutoShowInterval),r.innerAutoShowInterval=-1,I.dispatchAction({type:"downplay",dataIndex:r.innerAutoShowIndex}),r.innerAutoShowIndex=0),!(A&&I&&O&&O.enabled&&O.interval>0))return;let s=O.showTip;typeof r.innerAutoShowIndex>"u"&&(r.innerAutoShowIndex=0),r.innerAutoShowInterval=setInterval(function(){let c=I.getOption(),f=0,L=0;c.series[f].data?L=c.series[f].data.length:c.dataset&&c.dataset.length>0&&(L=c.dataset[0].source.length),L!=0&&(I.dispatchAction({type:"downplay",dataIndex:r.innerAutoShowIndex}),r.innerAutoShowIndex=(r.innerAutoShowIndex+1)%L,I.dispatchAction({type:"highlight",dataIndex:r.innerAutoShowIndex}),s&&I.dispatchAction({type:"showTip",seriesIndex:f,dataIndex:r.innerAutoShowIndex}),F(r,r.innerAutoShowIndex,f,c))},O.interval*1e3);function F(c,f,L,H){let p=c.widgetInfo;c.$$lib__.each(p.action.sendOut.actionList,x=>{if(x.enabled&&x.code==u.default.autoHighLight.code){let M=p.dataset[p.dataset.type].dimensions,R=x.code+"_"+p.id,C={},J=[];if(p.dataset[p.dataset.type].source&&p.dataset[p.dataset.type].source.length>0&&(J=p.dataset[p.dataset.type].source[f]),C.x=c.getFieldVal(J,M,H.series[L].encode.x),C.y=c.getFieldVal(J,M,H.series[L].encode.y),c.getExtendParams(C,x.paramsExtend,J,M),x.script&&x.script.enabled){if(P.log("Execute script for "+p.name+" component to "+x.name+" component"),x.script.content==""){l.Message.warning({message:x.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}try{C=new Function("param,autoShowIndex,seriesIndex, opts",x.script.content).apply(c,[C,f,L,H])}catch($){P.error($)}}g.Z.$emit(R,C),x.postMessage&&c.doPostMessage(C)}})}}}},56279:function(Z,v,o){o.d(v,{P:function(){return l}});var u=o(386892),g=o(149500);const l={mixins:[u.D],created(){},methods:{lifecycleBeforeChartsLoad(E){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&g.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let A=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[E]);if(A)return A}return E},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&g.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(Z,v,o){o.d(v,{X:function(){return u},b:function(){return g}});let u={versions:function(){var l=navigator.userAgent;return{trident:l.indexOf("Trident")>-1,presto:l.indexOf("Presto")>-1,webKit:l.indexOf("AppleWebKit")>-1,gecko:l.indexOf("Gecko")>-1&&l.indexOf("KHTML")==-1,mobile:!!l.match(/AppleWebKit.*Mobile.*/),ios:!!l.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:l.indexOf("Android")>-1,iPhone:l.indexOf("iPhone")>-1,iPad:l.indexOf("iPad")>-1,webApp:l.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},g;u.versions.mobile||u.versions.ios||u.versions.android||u.versions.iPhone||u.versions.iPad?g=!1:g=!0},877025:function(Z,v,o){o.r(v),o.d(v,{default:function(){return $}});var u=function(){var i=this,n=i._self._c;return n("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[n("hide-button",{attrs:{attr:i.widgetInfo.attr}}),n("div",{ref:"barStack",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},g=[],l=o(844513),E=o(927966),P=o(445061),A=o(126711),I=o(166758),O=o(99349),r=o(598521),s=o(275770),F=o(555616),c=o(67157),f=o(150813);const L={mixins:[c.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(f.Z.charts.title)),legend:JSON.parse(JSON.stringify(f.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(f.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(f.Z.charts.toolbox)),visualMap:{inRange:{color:["#000000"]}},dataZoom:JSON.parse(JSON.stringify(f.Z.charts.dataZoom)),xAxis:JSON.parse(JSON.stringify(f.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(f.Z.charts.yAxis)),series:[{itemStyle:{colorInfo:{type:"gradation",pureColor:"",gradation:{top:"rgba(146, 203, 255, 1)",bottom:"rgba(20, 122, 217, 1)"}},opacity:1}}]}}},methods:{filterPredefineColoursSchemeConfig(t,i){this.getNewConfigWithArrary(t,i,this.filter_config)}}};var H=o(56279),p=o(149500);const x=o(954255);var M={name:"BarStack",components:{HideButton:l.Z},mixins:[I.baseConfig,P.u,A.H,H.P,O.P,L],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},destroyed(){this.echarts.dispose()},mounted(){this.echarts=x.init(this.$refs.barStack,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},methods:{loadInfo(t){let i=[],n=[],S=[],b=[];t.dataset[t.dataset.type]&&(i=t.dataset[t.dataset.type].source,n=t.dataset[t.dataset.type].dimensions,S=t.dataset[t.dataset.type].dimensionsAlias,b=t.dataset[t.dataset.type].encode),this.dimensionsEx=n,this.dimensionsAliasEx=S;let a=JSON.parse(JSON.stringify(t.config.series)),K=this.getTooltip(t.config.tooltip),W=JSON.parse(JSON.stringify(t.config.toolbox)),U=this.getTooltip(t.config.dataZoom),m=JSON.parse(JSON.stringify(t.config.legend)),w=JSON.parse(JSON.stringify(t.config.title)),z=JSON.parse(JSON.stringify(t.config.grid)),d=JSON.parse(JSON.stringify(t.config.xAxis)),h=JSON.parse(JSON.stringify(t.config.yAxis));for(let e=0;e<a.length;e++){a[e].dimensions=n,a[e].type="bar",a[e].barGap&&(a[e].barGap=a[e].barGap+"%"),a[e].barWidth&&(a[e].barWidth=a[e].barWidth+"%"),a[e].itemStyle.barBorderRadiusInfo&&(a[e].itemStyle.barBorderRadius=this.getItemStyleBarBorderRadius(a[e].itemStyle.barBorderRadiusInfo)),a[e].name||(a[e].name=this.getLegendData(S,a[e].encode.y),t.config.series[e].name=a[e].name),a[e].itemStyle.colorInfo.type&&(a[e].itemStyle.color=this.getItemStyleColor(a[e].itemStyle.colorInfo));let T={},_=[],D=[];for(let y=a[e].dimensions.length-1;y>-1;--y)T[n[y]]=y;for(let y=0;y<i.length;++y){let B=i[y];_.push(B[T[b.y[e]]]||""),D.push(B[T[b.x]]||"")}if(a[e].data=_,a[e].emphasis)try{if(a[e].emphasis.script&&a[e].emphasis.script.enabled){if(a[e].emphasis.script.content)try{let y=this,B=new Function("index","item","data",a[e].emphasis.script.content);a[e].data.forEach((G,k)=>{let j=B.call(y,k,G,_);a[e].data[k]={value:G,emphasis:j}})}catch(y){p.error("\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u811A\u672C\u62A5\u9519\uFF1A",y)}}else a[e].emphasis.itemStyle&&a[e].emphasis.itemStyle.color&&(a[e].emphasis={itemStyle:{...a[e].emphasis.itemStyle}})}catch(y){p.error("\u5904\u7406\u9AD8\u4EAE\u6837\u5F0F\u62A5\u9519\uFF1A",y)}d.data=D}let N={color:this.$$global_editor.predefineColors,tooltip:K,toolbox:W,dataZoom:U,visualMap:t.config.visualMap.show?this.getVisualMap(t.config.visualMap):"",title:{show:w.show,text:w.text,link:w.link,textAlign:w.textAlign,left:w.left+"%",right:w.right+"%",top:w.top+"%",bottom:w.bottom+"%",textStyle:{fontSize:w.textStyle.fontSize,fontFamily:w.textStyle.fontFamily,color:w.textStyle.color}},legend:{show:m.show,type:m.type,itemWidth:m.itemWidth,itemHeight:m.itemHeight,icon:m.icon,orient:m.orient,align:m.align,itemGap:m.itemGap,left:m.left+"%",right:m.right+"%",top:m.top+"%",bottom:m.bottom+"%",textStyle:{fontSize:m.textStyle.fontSize,fontFamily:m.textStyle.fontFamily,color:m.textStyle.color}},grid:{left:z.left+"%",right:z.right+"%",top:z.top+"%",bottom:z.bottom+"%",containLabel:!0},xAxis:[{type:"category",show:d.show,name:d.name,data:d.data,nameLocation:d.nameLocation,nameGap:d.nameGap,axisLine:{show:d.axisLine.show,lineStyle:{color:d.axisLine.lineStyle.color}},axisTick:{show:d.axisTick.show},axisLabel:{interval:d.axisLabel.interval,show:d.axisLabel.show,rotate:d.axisLabel.rotate,margin:d.axisLabel.margin,fontSize:d.axisLabel.fontSize,fontFamily:d.axisLabel.fontFamily,color:d.axisLabel.color,formatter:function(e,T){return d.axisLabel.script==!0?new Function("value, index",d.axisLabel.scriptontent).apply(this,[e,T]):d.axisLabel.vertical?e.split("").join(`
`):e}},splitLine:d.splitLine}],yAxis:[{scale:!0,type:"value",show:h.show,name:h.name,nameLocation:h.nameLocation,nameGap:h.nameGap,min:h.min,max:h.max,splitNumber:h.splitNumber,axisLine:{show:h.axisLine.show,lineStyle:{color:h.axisLine.lineStyle.color}},axisTick:{show:h.axisTick.show},axisLabel:{show:h.axisLabel.show,rotate:h.axisLabel.rotate,margin:h.axisLabel.margin,fontSize:h.axisLabel.fontSize,fontFamily:h.axisLabel.fontFamily,color:h.axisLabel.color},splitLine:h.splitLine}],dataset:{source:i,sourceHeader:!1},series:a};(!N.yAxis[0].min||N.yAxis[0].min=="")&&(N.yAxis[0].min=0),(!N.yAxis[0].max||N.yAxis[0].max=="")&&delete N.yAxis[0].max,this.getAnimation(N,t),this.setOption(N,t),this.setAnimationLoop(t,()=>{this.setOption(N,t)})},setOption(t,i){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0}),r.Z.autoShow(this,this.echarts,i.config.autoShow)},reLoadInfo(t){this.mergeConfig(t),t&&(this.$refs.barStack.style.width=t.attr.w+"px",this.$refs.barStack.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,i){let n=this.$$lib__.find(t,S=>S.name==i);return n?n.alias&&n.alias!=""?n.alias:n.name:""},getItemStyleColor(t){let i=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?i=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(i=new x.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),i},getItemStyleBarBorderRadius(t){let i=[];return i.push(t.lt),i.push(t.rt),i.push(t.rb),i.push(t.lb),i},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let i=this;this.$$lib__.each(t.action.sendOut.actionList,n=>{if(n.enabled){let S=n.code+"_"+t.id;if(n.paramsExtend&&n.paramsExtend.length>0){let b={};this.getParamsExtend(b,n.paramsExtend,t)}n.code==s.default.click.code&&i.onClick(S,n)}})},onClick(t,i){let n=this;n.echarts.on("click",S=>{let b={};b.x=S.name,b.y=S.value;let a=[];if(n.widgetInfo.dataset[n.widgetInfo.dataset.type].source&&n.widgetInfo.dataset[n.widgetInfo.dataset.type].source.length>0&&(a=n.widgetInfo.dataset[n.widgetInfo.dataset.type].source[S.dataIndex]),n.getExtendParams(b,i.paramsExtend,a,n.widgetInfo.dataset[n.widgetInfo.dataset.type].dimensions),i.script&&i.script.enabled){if(p.log("Execute script for "+n.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){F.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",i.script.content),b=this.customScript_actionSend_clickParam(b,S)}E.Z.$emit(t,b),i.postMessage&&n.doPostMessage(b)})}}},R=M,C=o(768141),J=(0,C.Z)(R,u,g,!1,null,"026a1afc",null),$=J.exports},844513:function(Z,v,o){o.d(v,{Z:function(){return O}});var u=function(){var s=this,F=s._self._c;return s.attr.buttonHide?F("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(c){return s.onHide()}}},[s.openTooltip?F("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[F("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):F("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},g=[],l=o(752246),E={props:["attr"],name:"hide-button",data(){return{isPc:l.b}},computed:{openTooltip:function(){let r=!1,s=this.attr.buttonHideTooltipContent;return l.b&&s&&s!=null&&s.trim()!=""&&(r=!0),r}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},P=E,A=o(768141),I=(0,A.Z)(P,u,g,!1,null,"bf399b9a",null),O=I.exports}}]);
