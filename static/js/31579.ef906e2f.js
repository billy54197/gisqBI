"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[31579],{56279:function(E,x,r){r.d(x,{P:function(){return c}});var u=r(386892),y=r(149500);const c={mixins:[u.D],created(){},methods:{lifecycleBeforeChartsLoad(N){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&y.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),y.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let S=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[N]);if(S)return S}return N},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&y.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),y.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(E,x,r){r.d(x,{X:function(){return u},b:function(){return y}});let u={versions:function(){var c=navigator.userAgent;return{trident:c.indexOf("Trident")>-1,presto:c.indexOf("Presto")>-1,webKit:c.indexOf("AppleWebKit")>-1,gecko:c.indexOf("Gecko")>-1&&c.indexOf("KHTML")==-1,mobile:!!c.match(/AppleWebKit.*Mobile.*/),ios:!!c.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:c.indexOf("Android")>-1,iPhone:c.indexOf("iPhone")>-1,iPad:c.indexOf("iPad")>-1,webApp:c.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},y;u.versions.mobile||u.versions.ios||u.versions.android||u.versions.iPhone||u.versions.iPad?y=!1:y=!0},315909:function(E,x){var r=Symbol();function u(a,g){a[r]||(a[r]=g,Object.defineProperty(a,"parentNode",{get:function(){return this[r]||this.parentElement}}))}var y=function(a,g){var h=a.splice(0);g.append.apply(g,h),h.forEach(function(b){b[r]=void 0})};function c(a,g){var h,b=this,v=a.frag||[a];if(this.frag){var p,I=this.frag.indexOf(g);I>-1&&(p=this.frag).splice.apply(p,[I,0].concat(v))}if(this[w]){var T=this[w].get(g);T&&(g=T[0])}g?(h=g).before.apply(h,v):this.append.apply(this,v),v.forEach(function(P){return u(P,b)})}function N(a){if(this.frag){var g=this.frag.indexOf(a);if(g>-1){var h,b=[g,1];if(this.frag.length===1){var v=this[C];this.frag[0].before(v),b.push(v)}(h=this.frag).splice.apply(h,b)}}var p=this[w];if(p){var I=p.get(a);if(I)return y(I,a),p.delete(a),void(a[r]=void 0)}a.remove()}var w=Symbol(),S={insertBefore:c,removeChild:N},C=Symbol(),B={insertBefore:c,before:function(a){this.frag[0].before(a)},remove:function(){var a=this[C],g=this.frag,h=g.splice(0,g.length,a);h[0].before(this[C]),h.forEach(function(b){return b.remove()})},removeChild:N,appendChild:function(a){var g=this.frag.length;this.frag[g-1].after(a);var h=this[C];this.frag[0]===h&&(this.frag.splice(0,1),h.remove()),u(a,this),this.frag.push(a)}},$={inserted:function(a){var g=Array.from(a.childNodes),h=a.parentNode,b=document.createComment("");a[C]=b,g.length===0&&g.push(b);var v=document.createDocumentFragment();v.append.apply(v,g),a.replaceWith(v),a.frag=g,function(p,I,T){p[w]||(p[w]=new Map,Object.assign(p,S)),p[w].set(I,T)}(h,a,g),u(a,h),g.forEach(function(p){return u(p,a)}),Object.defineProperty(a,"innerHTML",{set:function(p){var I=document.createElement("div");I.innerHTML=p;var T=a.frag.length;Array.from(I.childNodes).forEach(function(P){return a.appendChild(P)}),I.append.apply(I,a.frag.splice(0,T))},get:function(){return""}}),Object.assign(a,B)},unbind:function(a){y(a.frag,a),a[C].remove()}};x.Z=$},844513:function(E,x,r){r.d(x,{Z:function(){return B}});var u=function(){var a=this,g=a._self._c;return a.attr.buttonHide?g("div",{style:{position:"absolute",right:a.attr.buttonHideRight+"px",top:a.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(h){return a.onHide()}}},[a.openTooltip?g("el-tooltip",{attrs:{"open-delay":1e3,content:a.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[g("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):g("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):a._e()},y=[],c=r(752246),N={props:["attr"],name:"hide-button",data(){return{isPc:c.b}},computed:{openTooltip:function(){let $=!1,a=this.attr.buttonHideTooltipContent;return c.b&&a&&a!=null&&a.trim()!=""&&($=!0),$}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},w=N,S=r(768141),C=(0,S.Z)(w,u,y,!1,null,"bf399b9a",null),B=C.exports},387968:function(E,x,r){r.r(x),r.d(x,{default:function(){return H}});var u=function(){var e=this,i=e._self._c;return i("div",{class:[e.widgetInfo.config.global.closeScroll||e.widgetInfo.config.global.mode!="vertical"?"hideScroll":""],style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px",overflow:"auto"}},[i("hide-button",{attrs:{attr:e.widgetInfo.attr}}),i("div",[i("el-menu",{ref:"platformMenu",staticClass:"platform_menu",style:e.setStyle(e.widgetInfo.config),attrs:{mode:e.widgetInfo.config.global.mode,collapse:e.widgetInfo.config.global.collapse,"unique-opened":e.widgetInfo.config.global.uniqueOpened,"menu-trigger":e.widgetInfo.config.global.menuTrigger,collapseTransition:e.widgetInfo.config.global.collapseTransition,"text-color":e.widgetInfo.config.global.textColor,"active-text-color":e.widgetInfo.config.active.activeTextColor},on:{select:e.selectMenu}},[i("platform-menu-item",{ref:"platformMenuItem",attrs:{platformMenus:e.treeSelectData,widgetInfo:e.widgetInfo}})],1)],1)],1)},y=[],c=r(321300),N=r(987580),w=r(42160),S=r(927966),C=function(){var e=this,i=e._self._c;return e.platformMenus&&e.platformMenus.length>0?i("div",{directives:[{name:"frag",rawName:"v-frag"}]},[e._l(e.platformMenus,function(o){return[o.children?i("el-submenu",{key:"key"+o.id,style:e.heightStyleMenu(e.widgetInfo),attrs:{data:o,index:o.id,disabled:e.toBoolean(o.disabled),"popper-append-to-body":!0}},[i("template",{slot:"title"},[o.icon&&o.icon.indexOf("el-icon")>-1?i("i",{class:o.icon}):o.icon&&o.icon.indexOf("iconfont")>-1&&o.icon.length>9?i("i",[i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#"+o.icon.substring(9,o.icon.length)}})])]):o.icon?i("img",{staticClass:"icon-svg",staticStyle:{width:"24px",height:"18px"},attrs:{src:e.getImageUrl(o.icon),alt:""}}):e._e(),i("span",{style:e.setStyle(e.widgetInfo.config),attrs:{slot:"title"},slot:"title"},[e._v(e._s(o.name))])]),i("PlatformMenuItem",{attrs:{platformMenus:o.children,widgetInfo:e.widgetInfo}})],2):i("el-menu-item",{key:o.id,style:e.heightStyle(e.widgetInfo),attrs:{data:o,index:o.id,disabled:e.toBoolean(o.disabled)},nativeOn:{mouseenter:function(n){return e.nav_hover(n)},mouseleave:function(n){return e.nav_leave(n)},click:function(n){return e.nav_click(n)}}},[o.icon&&o.icon.indexOf("el-icon")>-1?i("i",{class:o.icon}):o.icon&&o.icon.indexOf("iconfont")>-1&&o.icon.length>9?i("i",[i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#"+o.icon.substring(9,o.icon.length)}})])]):o.icon?i("img",{staticClass:"icon-svg",staticStyle:{width:"24px",height:"18px"},attrs:{src:e.getImageUrl(o.icon),alt:""}}):e._e(),i("span",{style:e.setStyle(e.widgetInfo.config),attrs:{slot:"title"},slot:"title"},[e._v(e._s(o.name))])])]})],2):e._e()},B=[],$=r(315909),a=r(126711),g={name:"PlatformMenuItem",props:["platformMenus","widgetInfo"],mixins:[a.H],directives:{frag:$.Z},watch:{platformMenus:function(){this.$forceUpdate()}},data(){return{}},methods:{getImageUrl(t){return t&&t!=""?t:null},setStyle(t){return{border:"none",paddingLeft:t.global.paddingLeft+"px",fontFamily:t.fontStyle.fontFamily,fontWeight:t.fontStyle.fontWeight,fontStyle:t.fontStyle.fontStyle,fontSize:t.fontStyle.fontSize+"px",textDecoration:t.fontStyle.textDecoration,textAlign:t.global.textAlign,backgroundSize:t.global.backgroundSize}},nav_hover(t){if(t.target.style.color=this.widgetInfo.config.hover.hoverTextColor,t.target.style.backgroundColor=this.widgetInfo.config.hover.backgroundColor||"none",t.target.getElementsByTagName("i")&&t.target.getElementsByTagName("i").length>0)t.target.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.hover.hoverTextIconColor;else if(t.target.getElementsByTagName("img")&&t.target.getElementsByTagName("img").length>0){let e=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;t.target.style.overflow="hidden",t.target.getElementsByTagName("img")[0].style.transform="translate(-"+e+"px)",t.target.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.hover.hoverTextIconColor+" "+e+"px 0)"}},colorHex(t){var e=t,i=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgba|RGBA)/.test(e)){var o=e.replace(/(?:\(|\)|rgba|RGBA)*/g,"").split(","),n="#";for(let d=0;d<3;d++){var l=Number(o[d]).toString(16);l.length<2&&(l="0"+l),n+=l}return n.length!==7&&(n=e),n}else if(i.test(e)){var s=e.replace(/#/,"").split("");if(s.length===6)return e;if(s.length===3){var f="#";for(let d=0;d<s.length;d+=1)f+=s[d]+s[d];return f}}return e},nav_click(t){let e=t.target.parentElement;if(e.className.indexOf("is-active")>-1){if(e.getElementsByTagName("i")&&e.getElementsByTagName("i").length>0)e.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.active.activeTextIconColor;else if(e.getElementsByTagName("img")&&e.getElementsByTagName("img").length>0){let i=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;e.style.overflow="hidden",e.getElementsByTagName("img")[0].style.transform="translate(-"+i+"px)",e.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.active.activeTextIconColor+" "+i+"px 0)"}}},nav_leave(t){if(t.target.className.indexOf("is-active")>-1){if(t.target.style.color=this.widgetInfo.config.active.activeTextColor,t.target.getElementsByTagName("i")&&t.target.getElementsByTagName("i").length>0)t.target.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.active.activeTextIconColor;else if(t.target.getElementsByTagName("img")&&t.target.getElementsByTagName("img").length>0){let e=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;t.target.style.overflow="hidden",t.target.getElementsByTagName("img")[0].style.transform="translate(-"+e+"px)",t.target.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.active.activeTextIconColor+" "+e+"px 0)"}}else if(t.target.style.backgroundColor=this.widgetInfo.config.global.backgroundColor||"none",t.target.style.color=this.widgetInfo.config.global.textColor,t.target.getElementsByTagName("i")&&t.target.getElementsByTagName("i").length>0)t.target.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.global.textIconColor;else if(t.target.getElementsByTagName("img")&&t.target.getElementsByTagName("img").length>0){let e=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;t.target.style.overflow="hidden",t.target.getElementsByTagName("img")[0].style.transform="translate(-"+e+"px)",t.target.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+e+"px 0)"}},heightStyle(t){let e=t.attr.hh;if(t.config.global.mode==="horizontal"){let i={height:e+"px",lineHeight:e+"px"};return t.config.global.widthType==="fixedWidth"?t.config.global.width&&(i.width=t.config.global.width+"px"):t.config.global.itemPadding&&(i.paddingLeft=t.config.global.itemPadding+"px",i.paddingRight=t.config.global.itemPadding+"px"),i}else return e=t.config.global.height,{height:e+"px",lineHeight:e+"px"}},heightStyleMenu(t){if(t.config.global.mode==="horizontal")return this.heightStyle(t);{let e=t.config.global.height;return{minHeight:e+"px",lineHeight:e+"px"}}},toBoolean(t){return c.stringToBoolean(t)}}},h=g,b=r(768141),v=(0,b.Z)(h,C,B,!1,null,null,null),p=v.exports,I=r(844513),T=r(445061),P=r(555616),M=r(148836),k=r(935051),A=r(56279),O=r(67157);const L={mixins:[O.c],data(){return{config_extend:{config:{global:{backgroundColor:"#4C84FF",textColor:"#ffffff"},activeParent:{activeTextIconColor:"#ffffff"},childConfig:{backgroundColor:"#4C84FF"}}},filter_config:{global:{backgroundColor:"#4C84FF",textColor:"#ffffff",textIconColor:"#ffffff"},activeParent:{activeTextColor:"#ffffff",backgroundColor:"#070D2A",activeTextIconColor:"#ffffff"},active:{activeTextColor:"#ffffff",backgroundColor:"#070D2A",activeTextIconColor:"#ffffff"},hover:{hoverTextColor:"#ffffff",backgroundColor:"#070D2A",hoverTextIconColor:"#ffffff"},fontStyle:{fontFamily:"alibabaPuHuiTiRegular"},childConfig:{backgroundColor:"#4C84FF"}}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var _=r(149500),D={name:"platform-menu",props:["widgetInfo"],mixins:[T.u,a.H,N.baseConfig,L,A.P],components:{PlatformMenuItem:p,HideButton:I.Z},computed:{...(0,M.Se)(["getCanvasSetting","getURLParams","getApplicationId"])},data(){return{lastActiveMenu:null,treeSelectData:[]}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{initMenuMore(){this.treeSelectData.length!==0&&this.widgetInfo.config.global.menuDropdown&&(this.treeSelectData.push({icon:"el-icon iconfont bi_more2",id:this.treeSelectData[this.treeSelectData.length-1].id+1,name:""}),this.$nextTick(()=>{let t=this.$refs.platformMenuItem.$children[this.$refs.platformMenuItem.$children.length-1].$el.offsetWidth+20,e=0,i=-1;for(let n=0;n<this.$refs.platformMenuItem.$children.length;n++)if(e+=Math.ceil(this.$refs.platformMenuItem.$children[n].$el.offsetWidth),parseInt(e+t)>this.widgetInfo.attr.w){i=n;break}if(i==-1||i>=this.treeSelectData.length){this.treeSelectData.pop();return}let o=this.treeSelectData.slice(i,this.treeSelectData.length-1);this.treeSelectData.splice(i,this.treeSelectData.length-i-1),this.treeSelectData[this.treeSelectData.length-1].children=o,this.$nextTick(()=>{this.$refs.platformMenuItem.$children[this.treeSelectData.length-1].$el.style.float="right",this.$refs.platformMenuItem.$children[this.treeSelectData.length-1].$el.childNodes[0].childNodes[0].style.color=this.widgetInfo.config.global.textIconColor,this.$refs.platformMenuItem.$children[this.treeSelectData.length-1].$el.childNodes[0].childNodes[2].style.display="none";for(let n in this.$refs.platformMenu.items)this.setInactiveStyle(n)})}))},createImage(t){let e=document.createElement("canvas");e.height=5,e.width=5;var i=e.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,5,5),e.toDataURL("image/png",.5)},openSubMenu(t){for(let e in this.$refs.platformMenu.submenus)if(t==="all"||t==="first"){if(this.$refs.platformMenu.open(e),t==="first")break}else this.$refs.platformMenu.close(e)},autoActive(t){if(this.$refs.platformMenu.items)if(t==="first")for(let e in this.$refs.platformMenu.items){this.$refs.platformMenu.activeIndex=e,this.selectMenu(e);break}else if(t==="fixed")this.$refs.platformMenu.activeIndex=this.widgetInfo.config.global.fixed_value,this.selectMenu(this.widgetInfo.config.global.fixed_value);else if(t==="global"){let e=this.getGlobalParamsValue(this.widgetInfo.config.global.global_param);this.$refs.platformMenu.activeIndex=e,this.selectMenu(e)}else for(let e in this.$refs.platformMenu.items)this.setInactiveStyle(e)},colorHex(t){var e=t,i=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgba|RGBA)/.test(e)){for(var o=e.replace(/(?:\(|\)|rgba|RGBA)*/g,"").split(","),n="#",l=0;l<3;l++){var s=Number(o[l]).toString(16);s.length<2&&(s="0"+s),n+=s}return n.length!==7&&(n=e),n}else if(i.test(e)){var f=e.replace(/#/,"").split("");if(f.length===6)return e;if(f.length===3){for(var d="#",m=0;m<f.length;m+=1)d+=f[m]+f[m];return d}}return e},setParentInactiveStyle(t,e){let i=e.$el;if(this.widgetInfo.config.global.textIconColor)if(t.getElementsByTagName("img")&&t.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;i.style.overflow="hidden",i.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",i.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+o+"px 0)"}else if(i.getElementsByTagName("img")&&i.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;i.style.overflow="hidden",i.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",i.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+o+"px 0)"}else t.getElementsByTagName("i")&&t.getElementsByTagName("i").length>0&&(i.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.global.textIconColor);i&&i.querySelector(".el-submenu__title")&&(i.querySelector(".el-submenu__title").style.color=this.widgetInfo.config.global.textColor),this.widgetInfo.config.global.backgroundImage!=""?i.attributes.role.value!="menubar"&&(i.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.global.backgroundImage),i.style.backgroundSize=this.widgetInfo.config.global.backgroundSize):i.attributes.role.value!="menubar"&&(i.style.backgroundColor=this.widgetInfo.config.global.backgroundColor,i.style.backgroundImage=""),e.parentMenu&&e.parentMenu.$el&&e.parentMenu.$el.nodeName=="LI"&&this.setParentInactiveStyle(t,e.parentMenu)},setInactiveStyle(t){let e=this.$refs.platformMenu.items[t],i=e.$el;if(e.parentMenu.$el.nodeName=="LI"&&this.setParentInactiveStyle(i,e.parentMenu),this.widgetInfo.config.global.textIconColor)if(i.getElementsByTagName("img")&&i.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;i.style.overflow="hidden",i.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",i.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.global.textIconColor+" "+o+"px 0)"}else i.getElementsByTagName("i")&&i.getElementsByTagName("i").length>0&&(i.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.global.textIconColor);this.widgetInfo.config.global.backgroundImage!=""?(i.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.global.backgroundImage),i.style.backgroundSize=this.widgetInfo.config.global.backgroundSize):i.style.backgroundColor=this.widgetInfo.config.global.backgroundColor},setMenuPopup(){if(this.widgetInfo.config.childConfig.disabled&&this.widgetInfo.config.childConfig){let t=this.widgetInfo.config.childConfig.totalWidth,e=this.widgetInfo.config.childConfig.totalHeight,i=this.widgetInfo.config.childConfig.columnWidth,o=this.widgetInfo.config.childConfig.rowHeight,n=this.widgetInfo.config.childConfig.backgroundColor,l=document.querySelectorAll(".el-menu--popup");for(let s=0;s<l.length;s++){l[s].style.overflowY="auto",t>0&&(l[s].style.width=t+"px",l[s].style.minWidth="auto"),e>0&&this.widgetInfo.config.childConfig.mode=="multi"&&(l[s].style.height=e+"px"),n&&(l[s].style.backgroundColor=n);let f=l[s].querySelectorAll(".el-submenu");for(let m=0;m<f.length;m++)this.widgetInfo.config.childConfig.mode=="multi"&&(f[m].style.float="left",f[m].style.display="block"),i>0&&(f[m].style.width=i+"px"),o>0&&(f[m].style.height=o+"px");let d=l[s].querySelectorAll(".el-menu-item");for(let m=0;m<d.length;m++)this.widgetInfo.config.childConfig.mode=="multi"&&(d[m].style.float="left",d[m].style.display="block"),i>0&&(d[m].style.width=i+"px"),o>0&&(d[m].style.height=o+"px")}}},selectMenu(t){for(let l in this.$refs.platformMenu.items)this.setInactiveStyle(l);let e=this.$refs.platformMenu.items[t],i=this;if(this.lastActiveMenu){let l=[this.$refs.platformMenu.items[this.lastActiveMenu]];l&&l[0]&&l[0].parentMenu&&l[0].parentMenu!=e.parentMenu&&l[0].parentMenu.$el.className.indexOf("el-submenu")>-1&&l.push(l[0].parentMenu),l.forEach(s=>{if(s&&s.$el){if(s.$el.className.indexOf("el-submenu")>-1)return;s.$el.style.backgroundColor=i.widgetInfo.config.global.backgroundColor,s.$el.style.backgroundImage=i.getImageUrl(i.widgetInfo.config.global.backgroundImage),s.$el.style.backgroundSize=i.widgetInfo.config.global.backgroundSize,s.$el.style.color=i.widgetInfo.config.global.textColor,i.widgetInfo.config.active.borderWidth-0>=0&&(i.widgetInfo.config.global.mode=="vertical"?(s.$el.style.borderRightColor="",s.$el.style.borderRightWidth="",s.$el.style.borderRightStyle=""):(s.$el.style.borderBottomColor="",s.$el.style.borderBottomWidth="",s.$el.style.borderBottomStyle=""))}})}if(this.lastActiveMenu=t,e){let l=e.$el;if(this.widgetInfo.config.active.backgroundImage?(l.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.active.backgroundImage),l.style.backgroundSize=this.widgetInfo.config.active.backgroundSize):this.widgetInfo.config.active.backgroundColor&&(l.style.backgroundImage=this.getImageUrl(this.createImage(this.widgetInfo.config.active.backgroundColor)),l.style.backgroundSize="cover"),this.widgetInfo.config.active.borderWidth-0>=0&&(this.widgetInfo.config.global.mode=="vertical"?(l.style.borderRightColor=this.widgetInfo.config.active.activeTextColor,l.style.borderRightWidth=`${this.widgetInfo.config.active.borderWidth}px`,l.style.borderRightStyle="solid"):(l.style.borderBottomColor=this.widgetInfo.config.active.activeTextColor,l.style.borderBottomWidth=`${this.widgetInfo.config.active.borderWidth}px`,l.style.borderBottomStyle="solid")),this.widgetInfo.config.active.activeTextIconColor){if(l.getElementsByTagName("i")&&l.getElementsByTagName("i").length>0)l.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.active.activeTextIconColor;else if(l.getElementsByTagName("img")&&l.getElementsByTagName("img").length>0){let s=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;l.style.overflow="hidden",l.getElementsByTagName("img")[0].style.transform="translate(-"+s+"px)",l.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.active.activeTextIconColor+" "+s+"px 0)"}}}this.$nextTick(()=>{this.setActiveParentStyle(e)});let o=this,n=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(n,l=>{if(l.enabled&&l.code==o.$$global_editor.actionType.click.code){let s=l.code+"_"+o.widgetInfo.id,f={value:t};if(l.paramsExtend&&l.paramsExtend.length>0&&o.getExtendParams(f,l.paramsExtend,o.getSelectSource(t),o.widgetInfo.dataset[o.widgetInfo.dataset.type].dimensions),l.script&&l.script.enabled){if(_.log("Execute script for "+l.name+" component to "+l.script.title+" component"),l.script.content==""){P.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param",l.script.content);let d=this.customScript_actionSend_clickParam(f);d&&(f=d)}S.Z.$emit(s,f),o.actionNameList.push(s),l.postMessage&&this.doPostMessage(f)}}),this.$nextTick(function(){this.setMenuPopup()})},setActiveParentStyle(t){if(t&&t.parentMenu&&t.parentMenu.$el.className.indexOf("el-submenu")>-1){let e=t.parentMenu.$el,i=e.getElementsByTagName("div")[0];if(this.widgetInfo.config.activeParent.backgroundImage?(e.style.backgroundColor="",e.style.backgroundImage=this.getImageUrl(this.widgetInfo.config.activeParent.backgroundImage),e.style.backgroundSize=this.widgetInfo.config.activeParent.backgroundSize):this.widgetInfo.config.activeParent.backgroundColor&&(e.style.backgroundColor="",e.style.backgroundImage=this.getImageUrl(this.createImage(this.widgetInfo.config.activeParent.backgroundColor)),e.style.backgroundSize="cover"),this.widgetInfo.config.activeParent.borderWidth-0>=0&&(this.widgetInfo.config.global.mode=="vertical"?i.style.borderRightWidth=this.widgetInfo.config.activeParent.borderWidth+"px":i.style.borderBottomWidth=this.widgetInfo.config.activeParent.borderWidth+"px"),this.widgetInfo.config.activeParent.activeTextColor){let o=this.widgetInfo.config.activeParent.activeTextColor;i.style.color=o,this.widgetInfo.config.global.mode=="vertical"?i.style.borderRightColor=o:i.style.borderBottomColor=o;let n=this.widgetInfo.config.global.mode;setTimeout(function(){n=="vertical"?i.style.borderRightColor=o:i.style.borderBottomColor=o},100)}if(this.widgetInfo.config.activeParent.activeTextIconColor){if(e.getElementsByTagName("i")&&e.getElementsByTagName("i")[0].className.indexOf("el-submenu__icon-arrow")==-1)e.getElementsByTagName("i")[0].style.color=this.widgetInfo.config.activeParent.activeTextIconColor;else if(e.getElementsByTagName("img")&&e.getElementsByTagName("img").length>0){let o=this.widgetInfo.config.global.width?this.widgetInfo.config.global.width:106;e.style.overflow="hidden",e.getElementsByTagName("img")[0].style.transform="translate(-"+o+"px)",e.getElementsByTagName("img")[0].style.filter="drop-shadow("+this.widgetInfo.config.activeParent.activeTextIconColor+" "+o+"px 0)"}}}t.parentMenu.parentMenu&&t.parentMenu.parentMenu.$el.className.indexOf("el-submenu")>-1&&this.setActiveParentStyle(t.parentMenu)},getSelectSource(t){let e,i=this.widgetInfo.dataset[this.widgetInfo.dataset.type].dimensions;for(let n=0;n<i.length;n++)i[n]==this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode.id&&(e=i[n]);let o=this.$$lib__.find(this.widgetInfo.dataset[this.widgetInfo.dataset.type].source,n=>n[e]==t);return o||null},sortSelectData(t){if(t){let e=[],i=[];for(let o=0;o<t.length;o++)t[o].children&&t[o].children.length>0?(t[o].children=this.sortSelectData(t[o].children),e.push(t[o])):i.push(t[o]);if(e.length>0||i.length>0){t=[];for(let o in e)t.push(e[o]);for(let o in i)t.push(i[o])}}return t},loadMenuData(t){t.dataset.newType=="first"?this.loadFirstMenuData(t):this.loadAllMenuData(t)},loadFirstMenuData(t){let e=this.getApplicationId,i={subGuid:e},o="/identity/base/funcmgr/funcgroups-all",n;(0,k.platformPostRequest)(o,i).then(l=>{for(let f=0;f<l.data.length;f++)if(!l.data[f].parentFuncgroupId){n=l.data[f].id;break}let s={parentFuncgroupId:n,subGuid:e};o="/identity/base/funcmgr/getAppFuncGroupAndItem",(0,k.platformPostRequest)(o,s).then(f=>{if(t.dataset[t.dataset.type].encode.firstPid=n,f.data.length>0)for(let d=f.data.length-1;d>=0;d--)n!=f.data[d].parentFuncgroupId&&f.data.splice(d,1);t.dataset[t.dataset.type].source=f.data,this.setInfo(t)})})},loadAllMenuData(t){let i={subGuid:this.getApplicationId},o="/identity/base/funcmgr/getAppFuncGroupAndItem";(0,k.platformPostRequest)(o,i).then(n=>{t.dataset[t.dataset.type].source=n.data,this.setInfo(t)})},loadInfo(t){this.loadMenuData(t),this.lifecycleAfterLoad()},setInfo(t){this.treeSelectData=this.getTreeData(t.dataset[t.dataset.type].encode,t.dataset[t.dataset.type].dimensions,t.dataset[t.dataset.type].source),this.setIconPosition(t),this.$nextTick(function(){this.widgetInfo.config.global.mode=="vertical"&&this.openSubMenu(this.widgetInfo.config.global.expand),this.autoActive(this.widgetInfo.config.global.autoActive),this.setMenuPopup()}),this.initMenuMore()},reLoadInfo(t){_.log("menu reLoadInfo"),this.loadInfo(t)},setStyle(t){return{border:"none",paddingLeft:t.global.paddingLeft+"px",fontFamily:t.fontStyle.fontFamily,fontWeight:t.fontStyle.fontWeight,fontStyle:t.fontStyle.fontStyle,fontSize:t.fontStyle.fontSize+"px",textDecoration:t.fontStyle.textDecoration,textAlign:t.global.textAlign,backgroundSize:t.global.backgroundSize}},setIconPosition(t){this.$nextTick(()=>{let e=this.$refs.platformMenu.$el.children;if(t.config.global.iconPosition=="top")for(let i=0;i<e.length;i++)t.config.global.mode=="horizontal"&&e[i]&&e[i].style&&(e[i].style.height=t.attr.hh+"px",e[i].style.lineHeight=t.attr.hh+"px"),e[i].className.indexOf("el-menu-item")>-1?e[i].childNodes[0].nodeName=="I"?(e[i].childNodes[0].style.position="absolute",e[i].childNodes[0].style.left=(e[i].offsetWidth-e[i].childNodes[0].offsetWidth)/2+"px",e[i].childNodes[0].style.top="5px"):e[i].childNodes[0].nodeName=="IMG"&&(e[i].childNodes[0].style.position="absolute",e[i].childNodes[0].style.left=(e[i].offsetWidth-parseInt(e[i].childNodes[0].style.width))/2+"px",e[i].childNodes[0].style.top="5px"):e[i].className.indexOf("el-submenu")>-1&&(e[i].childNodes[0].className=="el-submenu__title"&&e[i].childNodes[0].childNodes[0].nodeName=="I"?(e[i].childNodes[0].childNodes[0].style.position="absolute",e[i].childNodes[0].childNodes[0].style.left=(e[i].childNodes[0].offsetWidth-e[i].childNodes[0].childNodes[0].offsetWidth)/2+"px",e[i].childNodes[0].childNodes[0].style.top="5px"):e[i].childNodes[0].childNodes[0].nodeName=="IMG"&&(e[i].childNodes[0].childNodes[0].style.position="absolute",e[i].childNodes[0].childNodes[0].style.left=(e[i].childNodes[0].offsetWidth-parseInt(e[i].childNodes[0].childNodes[0].style.width))/2+"px",e[i].childNodes[0].childNodes[0].style.top="5px")),t.config.global.mode=="vertical"&&(e[i].style.minHeight="80px");else for(let i=0;i<e.length;i++)t.config.global.mode=="horizontal"&&e[i]&&e[i].style&&(e[i].style.height=t.attr.hh+"px",e[i].style.lineHeight=t.attr.hh+"px"),e[i].className.indexOf("el-menu-item")>-1?(e[i].childNodes[0].nodeName=="I"||e[i].childNodes[0].nodeName=="IMG")&&(e[i].childNodes[0].style.position="static"):e[i].className.indexOf("el-submenu")>-1&&(e[i].childNodes[0].className=="el-submenu__title"&&e[i].childNodes[0].childNodes[0].nodeName=="I"||e[i].childNodes[0].childNodes[0].nodeName=="IMG")&&(e[i].childNodes[0].childNodes[0].style.position="static"),t.config.global.mode=="vertical"&&(e[i].style.minHeight="40px")})},initAction(t){let e=t.action.receive.replaceFirstPid;e&&e.enabled&&e.replaceList&&e.replaceList.length>0&&this.doReplaceFirstPid(e.replaceList),this.actionReceive(t)},doReplaceFirstPid(t){let e=this;this.$$lib__.each(t,i=>{let o=i[0][1]+"_"+i[0][0];i[0][1].indexOf("_")>-1&&(o=i[0][1]),S.Z.$on(o,n=>{let l=i[0][2],s=l.indexOf("|");s>-1&&(l=i[0][2].substring(s+1)),e.widgetInfo.dataset[e.widgetInfo.dataset.type].encode.firstPid=n[l],e.reLoadInfo(e.widgetInfo)})})},getTreeData(t,e,i){let o=[];if(t.id&&t.pid&&t.name){let n=this.listToObj(e,i);if(n.length==0)return o;o=this.handleDataTree(n,t)}return this.getHideList(o)},getHideList(t){let e=JSON.parse(JSON.stringify(t));for(let i=t.length-1;i>=0;i--)t[i].hide&&(t[i].hide=="true"||t[i].hide>=1)?e.splice(i,1):t[i].children&&t[i].children.length>0&&(e[i].children=this.getHideList(t[i].children));return e},listToObj(t,e){let i=[];for(let o=0;o<e.length;o++){let n={};for(let l=0;l<t.length;l++)w.default.set(n,t[l],e[o][t[l]]);i.push(JSON.parse(JSON.stringify(n)))}return i},handleDataTree(t,e){let i={},o=[];if(!e.firstPid){let n=t[0][e.pid],l=n;this.$$lib__.each(t,s=>{s[e.pid]!=n&&(l=s[e.pid])}),l==n&&(e.firstPid=n)}return this.$$lib__.each(t,n=>{let l={};l.id=n[e.id],l.name=n[e.name],l.icon=n[e.icon],l.disabled=n[e.disabled],l.hide=n[e.hide],l.sort=n[e.sort],n[e.pid]!=null&&n[e.pid]!=""&&n[e.pid]!=e.firstPid?(i[n[e.pid]]||(i[n[e.pid]]=[]),i[n[e.pid]].push(l)):o.push(l)}),this.transferFl(o,i,e.id,e),JSON.parse(JSON.stringify(o))},transferFl(t,e,i,o){o.sort&&t.sort(this.compare("sort")),this.$$lib__.each(t,n=>{let l=e[n[i]];l&&(n.children=l,this.transferFl(l,e,i,o))})},compare(t){return function(e,i){let o=e[t],n=i[t];return!isNaN(Number(o))&&!isNaN(Number(n))&&(o=Number(o),n=Number(n)),o<n?-1:o>n?1:0}},getImageUrl(t){return t&&t!=""?t.indexOf("data:")==0?`url(${t})`:"url("+c.appendImageBaseURL(t)+")":""},getGlobalParamsValue(t){if(this.getCanvasSetting==null||this.getCanvasSetting.data==null||this.getCanvasSetting.data.globalParams==null||this.getCanvasSetting.data.globalParams.paramsValue==null||this.getCanvasSetting.data.globalParams.paramsValue.length<1)return"";let e=this.$$lib__.find(this.getCanvasSetting.data.globalParams.paramsValue,o=>o.paramName==t);if(!e)return this.getCanvasSetting.data.globalParams.params[t];let i=this.getURLParams[e.urlParams];return i||(i=this.getCanvasSetting.data.globalParams.params[t]),i}}},W=D,F=(0,b.Z)(W,u,y,!1,null,"0bf11d14",null),H=F.exports}}]);
