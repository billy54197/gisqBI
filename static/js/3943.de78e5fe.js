"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[3943],{56279:function($,N,s){s.d(N,{P:function(){return I}});var O=s(86892),p=s(49500);const I={mixins:[O.D],created(){},methods:{lifecycleBeforeChartsLoad(u){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&p.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let v=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[u]);if(v)return v}return u},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&p.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},11751:function($,N,s){s.r(N),s.d(N,{default:function(){return K}});var O=function(){var e=this,i=e._self._c;return i("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:e.widgetInfo.attr}}),i("div",{ref:"scatterSimple",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},p=[],I=s(44513),u=s(27966),M=s(67163),v=s(56279),P=s(45061),Z=s(26711),B=s(99349),D=s(55616),T=s(75770),Q=s(21300),X=s(31954),W=s(67157),y=s(50666);const R={mixins:[W.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(y.Z.charts.title)),legend:JSON.parse(JSON.stringify(y.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(y.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(y.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(y.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(y.Z.charts.yAxis)),series:{itemStyle:{colorInfo:{type:"pureColor",pureColor:"#54D6AC",gradation:{top:"#7CFAD7",bottom:"#14BEB4"}},opacity:1}}}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var F=s(49500);const z=s(29426);var H={name:"ScatterSimple",components:{HideButton:I.Z},mixins:[M.u,v.P,P.u,Z.H,B.P,R],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},destroyed(){this.echarts.dispose()},mounted(){this.echarts=z.init(this.$refs.scatterSimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},methods:{loadInfo(t){let e=[],i=[],a=[],n=[];e=t.dataset[t.dataset.type].source,i=t.dataset[t.dataset.type].dimensions,a=t.dataset[t.dataset.type].dimensionsAlias,n=t.dataset[t.dataset.type].encode,this.dimensionsEx=i,this.dimensionsAliasEx=a;let x=this.getTooltip(t.config.tooltip),C=JSON.parse(JSON.stringify(t.config.toolbox)),l=JSON.parse(JSON.stringify(t.config.legend)),r=JSON.parse(JSON.stringify(t.config.title)),f=JSON.parse(JSON.stringify(t.config.grid)),d=JSON.parse(JSON.stringify(t.config.xAxis)),h=JSON.parse(JSON.stringify(t.config.yAxis)),o=JSON.parse(JSON.stringify(t.config.series));o.name||(o.name=this.getLegendData(a,n)),o.itemStyle.colorInfo.type&&(o.itemStyle.color=this.getItemStyleColor(o.itemStyle.colorInfo));let m={dataMax:0,dataMin:0,max:0,min:0},A=this.getFieldIndex(i,n);m=this.getPointSymbolSize(o,e,A);let b={},J=[],E=[];for(let c=i.length-1;c>-1;--c)b[i[c]]=c;for(let c=0;c<e.length;++c){let g=e[c];J.push({name:g[b[n.x]]||"",value:g[b[n.y]]||"",source:e,symbolSize:Number((m.max-m.min)*(Number(g[b[n.y]])-m.dataMin)/(m.dataMax-m.dataMin))+Number(m.min)}),E.push(g[b[n.x]]||"")}o.data=J,d.data=E;let w={color:this.$$global_editor.predefineColors,tooltip:x,toolbox:C,title:{show:r.show,text:r.text,link:r.link,textAlign:r.textAlign,left:r.left+"%",right:r.right+"%",top:r.top+"%",bottom:r.bottom+"%",textStyle:{fontSize:r.textStyle.fontSize,fontFamily:r.textStyle.fontFamily,fontWeight:r.textStyle.fontWeight,color:r.textStyle.color}},legend:{show:l.show,type:l.type,itemWidth:l.itemWidth,itemHeight:l.itemHeight,icon:l.icon,orient:l.orient,align:l.align,itemGap:l.itemGap,left:l.left+"%",right:l.right+"%",top:l.top+"%",bottom:l.bottom+"%",textStyle:{color:l.textStyle.color,fontWeight:l.textStyle.fontWeight}},textStyle:{fontSize:l.textStyle.fontSize,fontFamily:l.textStyle.fontFamily,color:l.textStyle.color},grid:{left:f.left+"%",right:f.right+"%",top:f.top+"%",bottom:f.bottom+"%",dx:f.dx+"%",dy:f.dy+"%"},xAxis:[{type:"category",show:d.show,name:d.name,data:d.data,axisLine:{show:d.axisLine.show,lineStyle:{color:d.axisLine.lineStyle.color}},axisTick:{show:d.axisTick.show},axisLabel:{interval:d.axisLabel.interval,show:d.axisLabel.show,rotate:d.axisLabel.rotate,margin:d.axisLabel.margin,fontSize:d.axisLabel.fontSize,fontFamily:d.axisLabel.fontFamily,color:d.axisLabel.color},splitLine:{show:d.splitLine.show}}],yAxis:[{scale:!1,min:h.min,max:h.max,type:"value",show:h.show,name:h.name,axisLine:{show:h.axisLine.show,lineStyle:{color:h.axisLine.lineStyle.color}},axisTick:{show:h.axisTick.show},axisLabel:{show:h.axisLabel.show,rotate:h.axisLabel.rotate,margin:h.axisLabel.margin,fontSize:h.axisLabel.fontSize,fontFamily:h.axisLabel.fontFamily,color:h.axisLabel.color},splitLine:{show:h.splitLine.show}}],dataset:{source:e,sourceHeader:!1},series:[{symbolSize:function(c){return c[A]==0?0:Number((m.max-m.min)*(c[A]-m.dataMin)/(m.dataMax-m.dataMin))+Number(m.min)},name:o.name,type:"scatter",dimensions:i,symbol:o.symbol,encode:n,data:J,barWidth:o.barWidth+"%",label:{show:o.label.show,rotate:o.label.rotate,color:o.label.color,fontSize:o.label.fontSize,fontFamily:o.label.fontFamily,fontWeight:o.label.fontWeight,position:o.label.position},itemStyle:{color:o.itemStyle.color,opacity:o.itemStyle.opacity,barBorderRadius:[o.itemStyle.barBorderRadius,o.itemStyle.barBorderRadius,0,0]},smooth:o.smooth}]};if(o.emphasis)try{let c=o.emphasis;if(c.script&&c.script.enabled){if(c.script.content){let g=new Function("index","item","data",c.script.content),S=w.series[0].data;if(S&&S.length>0)for(let L=0;L<S.length;++L)try{S[L].emphasis=g.call(this,L,S[L],S)}catch(V){F.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",V)}}}else o.emphasis.itemStyle&&o.emphasis.itemStyle.color&&(w.series[0].emphasis={itemStyle:{...o.emphasis.itemStyle}})}catch(c){F.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",c)}this.getAnimation(w,t),this.setOption(w),this.setAnimationLoop(t,()=>{this.setOption(w,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},reLoadInfo(t){t&&(this.$refs.scatterSimple.style.width=t.attr.w+"px",this.$refs.scatterSimple.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,e){let i=this.$$lib__.find(t,a=>a.name==e.y);return i?i.alias&&i.alias!=""?i.alias:i.name:""},getFieldIndex(t,e){let i=0;for(let a=0;a<t.length;a++)if(t[a]==e.y){i=a;break}return i},getPointSymbolSize(t,e,i){let a=[],n=0,x=0;t.isShowMax&&t.isShowMin?(t.max=60,t.min=20):!t.isShowMax&&t.isShowMin?(t.min=20,Number(t.max)<=Number(t.min)&&(t.max=Number(t.min)+1)):t.isShowMax&&!t.isShowMin&&(t.max=60,Number(t.max)<=Number(t.min)&&(t.min=Number(t.max)-1));let C=t.max,l=t.min;for(let r=0;r<e.length;r++)e[r][i]>0&&a.push(e[r][i]);return a.sort(function(r,f){return r-f}),a.length>0&&(n=a[a.length-1],x=a[0]),{dataMax:n,dataMin:x,max:C,min:l}},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let e=this;this.$$lib__.each(t.action.sendOut.actionList,i=>{if(i.enabled){let a=i.code+"_"+t.id;if(i.paramsExtend&&i.paramsExtend.length>0){let n={};this.getParamsExtend(n,i.paramsExtend,t)}i.code==T.Z.click.code&&e.onClick(a,i)}})},onClick(t,e){let i=this;i.echarts.on("click",a=>{let n={},x=i.getValue(a.seriesName,a.data);if(n.x=a.name,n.y=x,e.script&&e.script.enabled){if(F.log("Execute script for "+i.widgetInfo.name+" component to "+e.name+" component"),e.script.content==""){D.Message.warning({message:e.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",e.script.content),n=this.customScript(n)}u.Z.$emit(t,n),e.postMessage&&i.doPostMessage(n),i.actionNameList.push(t)})},getItemStyleColor(t){let e=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?e=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(e=new z.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),e}}},j=H,G=s(68141),U=(0,G.Z)(j,O,p,!1,null,"312c2414",null),K=U.exports}}]);
