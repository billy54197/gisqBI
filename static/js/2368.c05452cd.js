(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2368],{83605:function(r,h,t){"use strict";var s=t(49500),E=t(29870),f=t(87879),O=t(83393),i=t(19534);Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var y=i(t(43939)),L=i(t(22777)),N=i(t(42762)),p=P(t(23675)),d=t(71766),C=i(t(61128));function T(v){if(typeof f!="function")return null;var l=new f,e=new f;return(T=function(n){return n?e:l})(v)}function P(v,l){if(!l&&v&&v.__esModule)return v;if(v===null||E(v)!=="object"&&typeof v!="function")return{default:v};var e=T(l);if(e&&e.has(v))return e.get(v);var o={},n=Object.defineProperty&&O;for(var a in v)if(a!=="default"&&Object.prototype.hasOwnProperty.call(v,a)){var u=n?O(v,a):null;u&&(u.get||u.set)?Object.defineProperty(o,a,u):o[a]=v[a]}return o.default=v,e&&e.set(v,o),o}var x=function(){function v(){(0,L.default)(this,v),this.inPatterns=/ (IN) /i,this.tokens=["PROPERTY","COMPARISON","VALUE","LOGICAL"],this.patterns={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|-?\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(e){var o=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(e);if(o){var n=e.length,a=e.indexOf("(",o[0].length);if(a>-1)for(var u=1;a<n&&u>0;)switch(a++,e.charAt(a)){case"(":u++;break;case")":u--;break;default:}return[e.substring(0,a+1)]}},END:/^$/},this.follows={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},this.operators={"=":p.equalTo,"<>":p.notEqualTo,"<":p.lessThan,"<=":p.lessThanOrEqualTo,">":p.greaterThan,">=":p.greaterThanOrEqualTo,LIKE:p.like,BETWEEN:p.between,"IS NULL":p.isNull},this.operatorReverse={PropertyIsEqualTo:"=",PropertyIsNotEqualTo:"<>",PropertyIsLessThan:"<",PropertyIsLessThanOrEqualTo:"<=",PropertyIsGreaterThan:">",PropertyIsGreaterThanOrEqualTo:">=",PropertyIsLike:"LIKE",PropertyIsNull:"IS NULL",PropertyIsBetween:"BETWEEN"},this.logicals={AND:p.and,OR:p.or},this.precedence={RPAREN:3,LOGICAL:2,COMPARISON:1}}return(0,N.default)(v,[{key:"tryToken",value:function(e,o){return o instanceof RegExp?o.exec(e):o(e)}},{key:"nextToken",value:function(e,o){var n,a,u=o.length;for(n=0;n<u;n++){a=o[n];var I=this.patterns[a],c=this.tryToken(e,I);if(c){var g=c[0],G=e.substring(g.length).replace(/^\s*/,"");return{type:a,text:g,remainder:G}}}var w="ERROR: In parsing: ["+e+"], expected one of: ";for(n=0;n<u;n++)a=o[n],w+=`
    `+a+": "+this.patterns[a];throw new Error(w)}},{key:"tokenize",value:function(e){var o;e=(0,y.default)(o=(0,y.default)(e).call(e,"[","")).call(o,"]","");var n=this.tryToken(e,this.inPatterns);n&&(e=this.parseInToOr(e,n));var a=[],u,I=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{if(u=this.nextToken(e,I),e=u.remainder,I=this.follows[u.type],u.type!=="END"&&!I)throw new Error("No follows list for "+u.type);a.push(u)}while(u.type!=="END");return a}},{key:"parseInToOr",value:function(e,o){var n=this.tryToken(e,/\((.+?)\)/g);if(n){var a=e.substring(0,o.index),u=n[1],I=(0,y.default)(u).call(u," ","").split(","),c="",g="";if(a.indexOf(" ")>-1){var G=a.lastIndexOf(" ");g=a.substring(0,G+1),c=a.substring(G+1,a.length)}else c=a;for(var w=g,A=0;A<I.length;A++){var R=I[A];w+=c+"="+R,A<I.length-1&&(w+=" or ")}return w}return e}},{key:"buildAst",value:function(e){for(var o=this,n=[],a=[];e.length;){var u=e.shift();switch(u.type){case"PROPERTY":case"GEOMETRY":case"VALUE":a.push(u);break;case"COMPARISON":case"BETWEEN":case"IS_NULL":case"LOGICAL":{for(var I=this.precedence[u.type];n.length>0&&this.precedence[n[n.length-1].type]<=I;)a.push(n.pop());n.push(u);break}case"SPATIAL":case"NOT":case"LPAREN":n.push(u);break;case"RPAREN":for(;n.length>0&&n[n.length-1].type!=="LPAREN";)a.push(n.pop());n.pop(),n.length>0&&(n[n.length-1].type==="SPATIAL"||n[n.length-1].type==="NOT")&&a.push(n.pop());break;case"COMMA":case"END":break;default:throw new Error("Unknown token type "+u.type)}}for(;n.length>0;)a.push(n.pop());function c(){var A,R,M=a.pop();switch(M.type){case"LOGICAL":{var B=c(),W=c();return new o.logicals[M.text.toUpperCase()](W,B)}case"NOT":{var D=c();return new p.not(D)}case"BETWEEN":{var b,S;return a.pop(),S=c(),b=c(),R=c(),new p.between(R,b,S)}case"COMPARISON":return A=c(),R=c(),new o.operators[M.text.toUpperCase()](R,A);case"IS_NULL":return R=c(),new o.operators[M.text.toUpperCase()](R);case"VALUE":{var U=M.text.match(/^'(.*)'$/);return U?U[1].replace(/''/g,"'"):Number(M.text)}case"SPATIAL":switch(M.text.toUpperCase()){case"BBOX":{var Y=c(),m=c(),k=c(),F=c(),V=c();return new p.bbox(V,[F,k,m,Y])}case"INTERSECTS":return A=c(),R=c(),new p.intersects(R,A);case"WITHIN":return A=c(),R=c(),new p.within(R,A);case"CONTAINS":return A=c(),R=c(),new p.contains(R,A)}break;case"GEOMETRY":return new d.WKT().readGeometry(M.text,{});default:return M.text}}var g=c();if(a.length>0){for(var G=`\u5269\u4F59\u7684\u8282\u70B9\u65E0\u6CD5\u89E3\u6790: 
`,w=a.length-1;w>=0;w--)G+=a[w].type+": "+a[w].text+`
`;throw new Error(G)}return g}},{key:"read",value:function(e){try{return this.buildAst(this.tokenize(e))}catch(o){s.warn("CQL\u89E3\u6790\u5931\u8D25:"+e),s.warn(o)}}},{key:"write",value:function(e){switch(e.tagName_){case"BBOX":return"BBOX("+e.geometryName+","+e.extent.join(",")+","+e.srsName+")";case"Within":return"WITHIN("+e.geometryName+", "+this.readGeometry(e.geometry)+")";case"Intersects":return"INTERSECTS("+e.geometryName+", "+this.readGeometry(e.geometry)+")";case"Contains":return"CONTAINS("+e.geometryName+", "+this.readGeometry(e.geometry)+")";case"Not":return"NOT ("+this.write(e.condition)+")";case"And":case"Or":{for(var o="(",n=!0,a=0;a<e.conditions.length;a++)n?n=!1:o+=") "+e.tagName_.toLowerCase()+" (",o+=this.write(e.conditions[a]);return o+")"}case"PropertyIsBetween":return e.property+" BETWEEN "+this.write(e.lowerBoundary)+" AND "+this.write(e.upperBoundary);case"PropertyIsEqualTo":case"PropertyIsNotEqualTo":case"PropertyIsLessThan":case"PropertyIsLessThanOrEqualTo":case"PropertyIsGreaterThan":case"PropertyIsGreaterThanOrEqualTo":case"PropertyIsLike":case"PropertyIsNull":return e.expression!==null?e.propertyName+" "+this.operatorReverse[e.tagName_]+" "+this.write(e.expression):e.propertyName+" "+this.operatorReverse[e.tagName_];case void 0:if(typeof e=="string")return"'"+e.replace(/'/g,"''")+"'";if(typeof e=="number")return String(e);break;default:throw new Error("Can't encode: "+e.CLASS_NAME+" "+e)}}},{key:"readGeometry",value:function(e){if(e instanceof C.default)return new d.WKT().writeGeometry(e)}}]),v}();h.default=x},65557:function(r,h,t){r.exports=t(72626)},87507:function(r){function h(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}r.exports=h,r.exports.__esModule=!0,r.exports.default=r.exports},34009:function(r,h,t){var s=t(39155),E=t(1520),f=t(72026);function O(i){var y;return r.exports=O=s?E(y=f).call(y):function(N){return N.__proto__||f(N)},r.exports.__esModule=!0,r.exports.default=r.exports,O(i)}r.exports=O,r.exports.__esModule=!0,r.exports.default=r.exports},30044:function(r,h,t){var s=t(21648),E=t(57448),f=t(39736);function O(i,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=s(y&&y.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),E(i,"prototype",{writable:!1}),y&&f(i,y)}r.exports=O,r.exports.__esModule=!0,r.exports.default=r.exports},99085:function(r,h,t){var s=t(29870).default,E=t(87507);function f(O,i){if(i&&(s(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E(O)}r.exports=f,r.exports.__esModule=!0,r.exports.default=r.exports},39736:function(r,h,t){var s=t(39155),E=t(1520);function f(O,i){var y;return r.exports=f=s?E(y=s).call(y):function(N,p){return N.__proto__=p,N},r.exports.__esModule=!0,r.exports.default=r.exports,f(O,i)}r.exports=f,r.exports.__esModule=!0,r.exports.default=r.exports},44900:function(r,h,t){"use strict";var s=t(56370);r.exports=s},53005:function(r,h,t){"use strict";t(94495);var s=t(18893);r.exports=s("Function","bind")},17086:function(r,h,t){"use strict";var s=t(32242),E=t(53005),f=Function.prototype;r.exports=function(O){var i=O.bind;return O===f||s(f,O)&&i===f.bind?E:i}},60382:function(r,h,t){"use strict";t(30897);var s=t(94388);r.exports=s.Reflect.construct},18691:function(r,h,t){"use strict";t(26625);var s=t(94388);r.exports=s.Reflect.get},1520:function(r,h,t){"use strict";r.exports=t(48691)},48691:function(r,h,t){"use strict";var s=t(44900);r.exports=s},77958:function(r,h,t){"use strict";var s=t(36021),E=t(86735),f=t(42660),O=t(79489),i=t(2529),y=t(82396),L=Function,N=s([].concat),p=s([].join),d={},C=function(T,P,x){if(!O(d,P)){for(var v=[],l=0;l<P;l++)v[l]="a["+l+"]";d[P]=L("C,a","return new C("+p(v,",")+")")}return d[P](T,x)};r.exports=y?L.bind:function(P){var x=E(this),v=x.prototype,l=i(arguments,1),e=function(){var n=N(l,i(arguments));return this instanceof e?C(x,n.length,n):x.apply(P,n)};return f(v)&&(e.prototype=v),e}},40197:function(r,h,t){"use strict";var s=t(79489);r.exports=function(E){return E!==void 0&&(s(E,"value")||s(E,"writable"))}},94495:function(r,h,t){"use strict";var s=t(90434),E=t(77958);s({target:"Function",proto:!0,forced:Function.bind!==E},{bind:E})},30897:function(r,h,t){"use strict";var s=t(90434),E=t(30889),f=t(19522),O=t(77958),i=t(11298),y=t(87934),L=t(42660),N=t(24136),p=t(27909),d=E("Reflect","construct"),C=Object.prototype,T=[].push,P=p(function(){function l(){}return!(d(function(){},[],l)instanceof l)}),x=!p(function(){d(function(){})}),v=P||x;s({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(e,o){i(e),y(o);var n=arguments.length<3?e:i(arguments[2]);if(x&&!P)return d(e,o,n);if(e===n){switch(o.length){case 0:return new e;case 1:return new e(o[0]);case 2:return new e(o[0],o[1]);case 3:return new e(o[0],o[1],o[2]);case 4:return new e(o[0],o[1],o[2],o[3])}var a=[null];return f(T,a,o),new(f(O,e,a))}var u=n.prototype,I=N(L(u)?u:C),c=f(e,I,o);return L(c)?c:I}})},26625:function(r,h,t){"use strict";var s=t(90434),E=t(99556),f=t(42660),O=t(87934),i=t(40197),y=t(68428),L=t(66167);function N(p,d){var C=arguments.length<3?p:arguments[2],T,P;if(O(p)===C)return p[d];if(T=y.f(p,d),T)return i(T)?T.value:T.get===void 0?void 0:E(T.get,C);if(f(P=L(p)))return N(P,d,C)}s({target:"Reflect",stat:!0},{get:N})},56370:function(r,h,t){"use strict";var s=t(17086);r.exports=s},72626:function(r,h,t){"use strict";var s=t(60382);r.exports=s},25538:function(r,h,t){"use strict";var s=t(18691);r.exports=s}}]);
