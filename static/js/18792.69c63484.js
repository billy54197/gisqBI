"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[18792],{56279:function(O,p,a){a.d(p,{P:function(){return c}});var f=a(386892),u=a(149500);const c={mixins:[f.D],created(){},methods:{lifecycleBeforeChartsLoad(y){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&u.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let m=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[y]);if(m)return m}return y},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&u.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(O,p,a){a.d(p,{X:function(){return f},b:function(){return u}});let f={versions:function(){var c=navigator.userAgent;return{trident:c.indexOf("Trident")>-1,presto:c.indexOf("Presto")>-1,webKit:c.indexOf("AppleWebKit")>-1,gecko:c.indexOf("Gecko")>-1&&c.indexOf("KHTML")==-1,mobile:!!c.match(/AppleWebKit.*Mobile.*/),ios:!!c.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:c.indexOf("Android")>-1,iPhone:c.indexOf("iPhone")>-1,iPad:c.indexOf("iPad")>-1,webApp:c.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},u;f.versions.mobile||f.versions.ios||f.versions.android||f.versions.iPhone||f.versions.iPad?u=!1:u=!0},218792:function(O,p,a){a.r(p),a.d(p,{default:function(){return X}});var f=function(){var i=this,e=i._self._c;return e("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:i.widgetInfo.attr}}),e("div",{ref:"ganttChart",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},u=[],c=a(844513),y=a(927966),S=a(56279),m=a(445061),N=a(126711),T=a(99349),C=a(555616),l=a(275770),v=a(930103),P=a(67157),b=a(150813);const Z={mixins:[P.c],data(){return{config_extend:{config:{series:[{nameTxtColor:"rgba(15, 21, 99, 1)",typeTxtColor:"#C4C4C4"}]}},filter_config:{title:JSON.parse(JSON.stringify(b.Z.charts.title)),legend:JSON.parse(JSON.stringify(b.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(b.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(b.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(b.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(b.Z.charts.yAxis)),series:[{color:"#C4C4C4",nameTxtColor:"rgba(15, 21, 29, 1)",typeTxtColor:"#C4C4C4"},{strColor:"#18DEA7",endColor:"#4C84FF",tagColor:"#0F151D"}]}}},methods:{filterPredefineColoursSchemeConfig(t,i){if(this.getNewConfig(t,i,this.filter_config),i.series instanceof Array&&i.series.length>0&&t.series instanceof Array&&t.series.length>0)for(let e=0;e<t.series.length;e++)this.getNewConfig(t.series[e],i.series[e],this.filter_config.series[e])}}};var $=a(149500);const w=a(954255);var M={name:"GanttChart",components:{HideButton:c.Z},mixins:[S.P,m.u,N.H,T.P,v.baseConfig,Z],props:["widgetInfo"],data(){return{heightRatio:.6,dimCategoryIndex:0,dimTimeArrival:1,dimTimeDepature:2,cartesianXBounds:[],cartesianYBounds:[],progressX:1,progressY:0,progressLabel:3,widthScale:1,maxBarLength:180,coordSysWidth:450}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=w.init(this.$refs.ganttChart,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let i={};i=this.getSeriesData(t.dataset[t.dataset.type].source,t.dataset[t.dataset.type].dimensionsAlias,t.dataset[t.dataset.type].encode);let e=this,d=[{id:"progress",type:"custom",renderItem:function(o,s){var g=s.value(e.progressY),L=s.coord([s.value(e.progressX),g]),h=s.coord([s.value(2),g]),n=o.coordSys;e.cartesianXBounds[0]=n.x,e.cartesianXBounds[1]=n.x+n.width,e.cartesianYBounds[0]=n.y,e.cartesianYBounds[1]=n.y+n.height;var x=h[0]-L[0];e.maxBarLength=e.maxBarLength>x?e.maxBarLength:x,e.coordSysWidth=o.coordSys.width;var A=s.size([0,1])[1]*e.heightRatio,I=L[0],F=L[1]-A,H=s.value(e.progressLabel)+"",Y=w.format.getTextRect(H).width,j=x>Y+40&&I+x>=180?H:"",B=e.clipRectByRect(o,{x:I,y:F,width:x,height:A}),R=e.clipRectByRect(o,{x:I,y:F,width:x/2,height:A}),D=e.clipRectByRect(o,{x:I,y:F,width:x,height:A});return{type:"group",children:[{type:"rect",ignore:!B,shape:B,style:s.style({fill:t.config.series[1].endColor})},{type:"rect",ignore:!R&&!s.value(3),shape:R,style:s.style({fill:t.config.series[1].strColor})},{type:"rect",ignore:!D,shape:D,style:s.style({fill:"transparent",stroke:"transparent",text:j,textFill:t.config.series[1].tagColor})}]}},dimensions:["\u7D22\u5F15\u503C"].concat(i.progress.dimensions),data:this.initDataArr(i.progress.list).map(function(o,s){return[s].concat(o)}),encode:{x:[e.progressX,2],y:e.progressY}},{id:"itemList",type:"custom",renderItem:function(o,s){var g=s.coord([0,s.value(0)])[1];if(!(g<o.coordSys.y+5))return{type:"group",position:[10,g],children:[{type:"path",shape:{d:"M0,0 L0,-20 L30,-20 C42,-20 38,-1 50,-1 L70,-1 L70,0 Z",x:0,y:-20,width:90,height:20,layout:"cover"},style:{fill:t.config.series[0].color}},{type:"text",style:{x:24,y:-3,text:s.value(1),textVerticalAlign:"bottom",textAlign:"center",textFill:t.config.series[0].nameTxtColor||"#fff"}},{type:"text",style:{x:75,y:-2,textVerticalAlign:"bottom",textAlign:"center",text:s.value(2),textFill:t.config.series[0].typeTxtColor||"#000"}}]}},encode:{x:-1,y:0},data:this.initDataArr(i.itemList).map(function(o,s){return[s].concat(o)})}];t.config.yAxis.max=this.initDataArr(i.itemList).length,t.config.xAxis.axisPointer=this.getAxisPointer(t.config.xAxis.axisPointer),t.config.xAxis.axisLine.lineStyle.color=this.getColorInfo(t.config.xAxis.axisLine.lineStyle.colorInfo),t.config.yAxis.axisLine.lineStyle.color=this.getColorInfo(t.config.yAxis.axisLine.lineStyle.colorInfo),t.config.xAxis.axisTick.lineStyle.color=this.getColorInfo(t.config.xAxis.axisTick.lineStyle.colorInfo),t.config.yAxis.axisTick.lineStyle.color=this.getColorInfo(t.config.yAxis.axisTick.lineStyle.colorInfo),t.config.xAxis.splitLine.lineStyle.color=this.getColorInfo(t.config.xAxis.splitLine.lineStyle.colorInfo),t.config.yAxis.splitLine.lineStyle.color=this.getColorInfo(t.config.yAxis.splitLine.lineStyle.colorInfo),t.config.xAxis.splitNumber=t.config.xAxis.splitNumber?t.config.xAxis.splitNumber-1:"";let r={animation:!1,dataZoom:[t.config.dataZoomX,t.config.dataZoomY],grid:t.config.grid,series:d,toolbox:t.config.toolbox,tooltip:this.getTooltip(t.config.tooltip),xAxis:Object.assign(this.getxAxis(t.config.xAxis),{max:function(o){return o.max=o.max+(o.max-o.min)*((e.maxBarLength+200)/e.coordSysWidth),o.max},min:function(o){return o.min}}),yAxis:this.getyAxis(t.config.yAxis)};r.xAxis.axisLabel.formatter=t.config.xAxis.axisLabel.formatterArr[0]+`{MM}-{dd}
{yyyy}`+t.config.xAxis.axisLabel.formatterArr[1],this.getAnimation(r,t),this.setOption(r),this.setAnimationLoop(t,()=>{this.setOption(r,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!1})},initDataArr(t){for(var i=this.getMaxLength(t),e=[],d=[],r=0;r<t.length;r++)for(var o=0;o<i;o++)e[o]||(e[o]=[]),e[o].push(t[r][o]),d[o]||(d[o]=[]),d[o].push(t[r][o]);return e},getMaxLength(t){for(var i=0,e=0;e<t.length;e++)t[e].length>i&&(i=t[e].length);return i},unique(t){return t.reduce((i,e)=>i.includes(e)?i:[...i,e],[])},clipRectByRect(t,i){return w.graphic.clipRectByRect(i,{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height})},reLoadInfo(t){t&&(this.$refs.ganttChart.style.width=t.attr.w+"px",this.$refs.ganttChart.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getSeriesData(t,i,e){let d=[];for(let h in e.itemList)for(let n=0;n<i.length;n++)e.itemList[h]==i[n].name&&d.push(this.getSourceData(n,t));let r=[],o=[],s,g;for(let h in e.x)for(let n=0;n<i.length;n++)e.x[h]==i[n].name&&(r.push(this.getSourceData(n,t).map(x=>new Date(x).getTime())),o.push(i[n].alias?i[n].alias:i[n].name));for(let h in e.progress)for(let n=0;n<i.length;n++)e.progress[h]==i[n].name&&(r.push(this.getSourceData(n,t)),o.push(i[n].alias?i[n].alias:i[n].name));return r[1]&&r[1].length>0&&this.$$lib__.each(r[1],h=>{s=s?s>Number(h)?Number(h):s:Number(h),g=g&&g>Number(h)?g:Number(h)}),r[1]=r[1].map((h,n)=>Number(r[0][n])+Number(h*1e3)),this.widthScale=g===s?g:g-s,{itemList:d,progress:{list:r,dimensions:o}}},getSourceData(t,i){let e=[];for(let d=0;d<i.length;d++)e.push(i[d][t]);return e},initAction(t){this.actionSendout(t),this.actionReceive(t)},getItemStyleColor(t){let i=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?i=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(i=new w.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),i},actionSendout(t){let i=this;this.$$lib__.each(t.action.sendOut.actionList,e=>{if(e.enabled){let d=e.code+"_"+t.id;if(e.paramsExtend&&e.paramsExtend.length>0){let r={};this.getParamsExtend(r,e.paramsExtend,t)}e.code==l.default.click.code&&i.onClick(d,e)}})},onClick(t,i){let e=this;e.echarts.on("click",d=>{let r={};if(r.time=d.data[1],r.value=d.data[2],r.target=d.data[3],i.script&&i.script.enabled){if($.log("Execute script for "+e.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){C.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",i.script.content),r=this.customScript(r)}y.Z.$emit(t,r),i.postMessage&&e.doPostMessage(r),e.actionNameList.push(t)})}}},J=M,z=a(768141),E=(0,z.Z)(J,f,u,!1,null,"48d9a3a7",null),X=E.exports},844513:function(O,p,a){a.d(p,{Z:function(){return T}});var f=function(){var l=this,v=l._self._c;return l.attr.buttonHide?v("div",{style:{position:"absolute",right:l.attr.buttonHideRight+"px",top:l.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(P){return l.onHide()}}},[l.openTooltip?v("el-tooltip",{attrs:{"open-delay":1e3,content:l.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[v("el-button",{class:l.attr.buttonHideIconClass&&l.attr.buttonHideIconClass!=""?l.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:l.attr.buttonHideColor,fontSize:l.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):v("el-button",{class:l.attr.buttonHideIconClass&&l.attr.buttonHideIconClass!=""?l.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:l.attr.buttonHideColor,fontSize:l.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):l._e()},u=[],c=a(752246),y={props:["attr"],name:"hide-button",data(){return{isPc:c.b}},computed:{openTooltip:function(){let C=!1,l=this.attr.buttonHideTooltipContent;return c.b&&l&&l!=null&&l.trim()!=""&&(C=!0),C}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},S=y,m=a(768141),N=(0,m.Z)(S,f,u,!1,null,"bf399b9a",null),T=N.exports}}]);
