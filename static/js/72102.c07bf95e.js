"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[72102],{56279:function(y,g,s){s.d(g,{P:function(){return l}});var f=s(386892),c=s(149500);const l={mixins:[f.D],created(){},methods:{lifecycleBeforeChartsLoad(u){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&c.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let p=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[u]);if(p)return p}return u},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&c.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(y,g,s){s.d(g,{X:function(){return f},b:function(){return c}});let f={versions:function(){var l=navigator.userAgent;return{trident:l.indexOf("Trident")>-1,presto:l.indexOf("Presto")>-1,webKit:l.indexOf("AppleWebKit")>-1,gecko:l.indexOf("Gecko")>-1&&l.indexOf("KHTML")==-1,mobile:!!l.match(/AppleWebKit.*Mobile.*/),ios:!!l.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:l.indexOf("Android")>-1,iPhone:l.indexOf("iPhone")>-1,iPad:l.indexOf("iPad")>-1,webApp:l.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},c;f.versions.mobile||f.versions.ios||f.versions.android||f.versions.iPhone||f.versions.iPad?c=!1:c=!0},844513:function(y,g,s){s.d(g,{Z:function(){return x}});var f=function(){var a=this,m=a._self._c;return a.attr.buttonHide?m("div",{style:{position:"absolute",right:a.attr.buttonHideRight+"px",top:a.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(C){return a.onHide()}}},[a.openTooltip?m("el-tooltip",{attrs:{"open-delay":1e3,content:a.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[m("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):m("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):a._e()},c=[],l=s(752246),u={props:["attr"],name:"hide-button",data(){return{isPc:l.b}},computed:{openTooltip:function(){let I=!1,a=this.attr.buttonHideTooltipContent;return l.b&&a&&a!=null&&a.trim()!=""&&(I=!0),I}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},w=u,p=s(768141),v=(0,p.Z)(w,f,c,!1,null,"bf399b9a",null),x=v.exports},972102:function(y,g,s){s.r(g),s.d(g,{default:function(){return A}});var f=function(){var e=this,o=e._self._c;return o("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px",overflow:"auto"}},[o("hide-button",{attrs:{attr:e.widgetInfo.attr}}),o("el-tree",{ref:"tree",style:e.getTreeStyle,attrs:{data:e.treeData,"default-expand-all":e.widgetInfo.config.tree.defaultExpandAll,"show-checkbox":e.widgetInfo.config.tree.showCheckbox,"check-strictly":!e.widgetInfo.config.tree.checkStrictly,indent:e.widgetInfo.config.tree.indent,draggable:e.widgetInfo.config.tree.draggable,"icon-class":e.widgetInfo.config.tree.iconClass,"render-content":e.renderContent},on:{"node-click":e.handleNodeClick,"check-change":e.checkChange}})],1)},c=[],l=s(844513),u=s(445061),w=s(126711),p=s(56279),v=s(723400),x=function(){var e=this,o=e._self._c;return o("div",[e.widgetInfo.config.tree.image==""&&e.widgetInfo.config.tree.icon!=""?o("span",{class:e.widgetInfo.config.tree.icon,style:e.iconStyle}):e.widgetInfo.config.tree.image!=""?o("img",{style:e.imgStyle,attrs:{src:e.getImageUrl(e.widgetInfo.config.tree.image),alt:""}}):e._e(),o("span",[e._v(e._s(e.node.label))])])},I=[],a=s(321300),m={name:"gisqbi-tree-node",props:["node","data","store","widgetInfo"],mounted(){this.setStyle()},data(){return{iconStyle:{},imgStyle:{}}},methods:{setStyle(){if(this.$el.parentElement.style.fontSize=(this.widgetInfo.config.tree.fontSize||25)+"px",this.$el.parentElement.style.height=(this.widgetInfo.config.tree.nodeHeight||(this.widgetInfo.config.tree.fontSize>0?this.widgetInfo.config.tree.fontSize+6:30))+"px",this.widgetInfo.config.tree.fontColor&&(this.$el.parentElement.style.color=this.widgetInfo.config.tree.fontColor),this.widgetInfo.config.tree.nodeConfigEnabled&&this.widgetInfo.config.node&&this.widgetInfo.config.node["level"+this.node.level]){let t=this.widgetInfo.config.node["level"+this.node.level];t&&t.enabled&&(t.fontSize>0&&(this.$el.parentElement.style.fontSize=t.fontSize+"px"),t.nodeHeight>0&&(this.$el.parentElement.style.height=t.nodeHeight+"px"),t.fontColor&&(this.$el.parentElement.style.color=t.fontColor),t.backgroundColor&&(this.$el.parentElement.style.backgroundColor=t.backgroundColor),t.backgroundImage&&(this.$el.parentElement.style.backgroundImage=`url(${this.getImageUrl(t.backgroundImage)})`,t.backgroundSize&&(this.$el.parentElement.style.backgroundSize=t.backgroundSize)),t.hideCheckbox?this.$el.parentElement.childNodes.forEach(e=>{e.className&&e.className.indexOf("el-checkbox")>-1&&(e.style.display="none")}):this.$el.parentElement.childNodes.forEach(e=>{e.className&&e.className.indexOf("el-checkbox")>-1&&(e.style.display="")}))}this.widgetInfo.config.tree.image==""&&this.widgetInfo.config.tree.icon!=""?this.getIconStyle():this.getImgStyle()},getImageUrl(t){if(t&&t!="")return a.appendImageBaseURL(t)},getIconStyle(){this.iconStyle={color:this.widgetInfo.config.tree.color,fontSize:this.widgetInfo.config.tree.fontSize+"px",marginLeft:this.widgetInfo.config.tree.marginLeft+"px",marginRight:this.widgetInfo.config.tree.marginRight+"px"}},getImgStyle(){this.imgStyle={width:this.widgetInfo.config.tree.imageStyle.width+"px",height:this.widgetInfo.config.tree.imageStyle.height+"px",marginLeft:this.widgetInfo.config.tree.imageStyle.marginLeft+"px",marginRight:this.widgetInfo.config.tree.imageStyle.marginRight+"px",marginTop:this.widgetInfo.config.tree.imageStyle.marginTop+"px",marginBottom:this.widgetInfo.config.tree.imageStyle.marginBottom+"px"}}}},C=m,S=s(768141),N=(0,S.Z)(C,x,I,!1,null,"4ddeab5a",null),k=N.exports,_=s(42160),O=s(148836),L=s(927966),P=s(308338),$=s(555616),z=s(67157);const H={mixins:[z.c],data(){return{config_extend:{config:{tree:{fontColor:"#616266"}}},filter_config:{tree:{fontColor:"#616266",backgroundColor:"",clickedBackgroundColor:"",selectedBackgroundColor:""},node:{level1:{backgroundColor:""},level2:{backgroundColor:""},level3:{backgroundColor:""},level4:{backgroundColor:""},level5:{backgroundColor:""}}}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var E=s(149500);_.default.component(k.name,k);var T={name:"tree",props:["widgetInfo"],mixins:[u.u,w.H,p.P,v.j,P.baseConfig,H],components:{HideButton:l.Z},data(){return{treeData:[],iconStyle:{},imgStyle:{}}},computed:{...(0,O.Se)(["viewType"]),getTreeStyle(){let t={};return this.widgetInfo.config.tree.backgroundColor&&(t.backgroundColor=this.widgetInfo.config.tree.backgroundColor),this.widgetInfo.config.tree.backgroundImage&&(t.backgroundImage=`url(${this.getImageUrl(this.widgetInfo.config.tree.backgroundImage)})`,t.backgroundSize=this.widgetInfo.config.tree.backgroundSize),t}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{loadInfo(t){this.treeData=this.getTreeData(t.dataset[t.dataset.type].encode,t.dataset[t.dataset.type].dimensions,t.dataset[t.dataset.type].source),this.lifecycleAfterLoad()},reLoadInfo(t){this.loadInfo(t)},initAction(t){let e=t.action.receive.replaceFirstPid;e&&e.enabled&&e.replaceList&&e.replaceList.length>0&&this.doReplaceFirstPid(e.replaceList),this.actionReceive(t)},getImageUrl(t){if(t&&t!="")return a.appendImageBaseURL(t)},renderContent(t,{node:e,data:o,store:n}){return t("gisqbi-tree-node",{props:{node:e,data:o,store:n,widgetInfo:this.widgetInfo,fontSize:25}})},doReplaceFirstPid(t){if(t&&t.length===0)return;let e=this;this.$$lib__.each(t,o=>{if(o&&!o[0])return;let n=o[0][1]+"_"+o[0][0];o[0][1].indexOf("_")>-1&&(n=o[0][1]),L.Z.$on(n,i=>{let r=o[0][2],d=r.indexOf("|");d>-1&&(r=o[0][2].substring(d+1)),e.widgetInfo.dataset[e.widgetInfo.dataset.type].encode.firstPid=i[r],e.loadInfo(e.widgetInfo)})})},getTreeData(t,e,o){let n=[];if(t.id&&t.pid&&t.label){let i=this.listToObj(e,o);if(i.length==0)return n;n=this.handleDataTree(i,t)}return n},listToObj(t,e){let o=[];for(let n=0;n<e.length;n++){let i={};for(let r=0;r<t.length;r++)_.default.set(i,t[r],e[n][r]);o.push(JSON.parse(JSON.stringify(i)))}return o},handleDataTree(t,e){let o={},n=[];return this.$$lib__.each(t,(i,r)=>{i.id=i[e.id],i.label=i[e.label],i.index=r,this.$$lib__.isUndefined(i[e.disabled])||(this.$$lib__.isBoolean(i[e.disabled])?i.disabled=i[e.disabled]:i[e.disabled]=="1"||i[e.disabled]=="0"?i.disabled=i[e.disabled]=="1"?!0:i[e.disabled]=="0"?!1:null:(i[e.disabled]=="true"||i[e.disabled]=="false")&&(i.disabled=i[e.disabled]=="true"?!0:i[e.disabled]=="false"?!1:null)),(e.disabled==""||e.disabled==null||e.disabled==null)&&(i.disabled=!1),e.firstPid&&i[e.pid]&&i[e.pid]==e.firstPid||e.firstPid&&!i[e.pid]&&!e.disableEmpty||!e.firstPid&&!i[e.pid]?n.push(i):(o[i[e.pid]]||(o[i[e.pid]]=[]),o[i[e.pid]].push(i))}),this.transferFl(n,o,e.id),JSON.parse(JSON.stringify(n))},transferFl(t,e,o){this.$$lib__.each(t,n=>{let i=e[n[o]];i&&(n.children=i,this.transferFl(i,e,o))})},getData(t){let e=[],o=this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode,n=this.widgetInfo.dataset[this.widgetInfo.dataset.type].dimensions,i=this.widgetInfo.dataset[this.widgetInfo.dataset.type].source,r;for(let d=0;d<n.length;d++)n[d]===o.id&&(r=d);for(let d=0;d<i.length;d++)i[d][r]===t&&(e=i[d]);return e},checkChange(t,e,o){let n=this.widgetInfo.action.sendOut.actionList.find(i=>i.enabled&&i.code=="change");if(n){let i=n.code+"_"+this.widgetInfo.id;t.check=e;let r=[],d=this.$refs.tree.getCheckedNodes();d&&d.length>0&&d.forEach(b=>{r.push(b.id)});let h={value:r,node:t};if(n.paramsExtend&&n.paramsExtend.length>0)for(let b=0;b<h.value.length;b++){let R=this.getData(h.value[b]);this.getExtendParams(h,n.paramsExtend,R,this.widgetInfo.dataset[this.widgetInfo.dataset.type].dimensions)}if(n.script&&n.script.enabled){if(E.log("Execute script for "+n.name+" component to "+n.script.title+" component"),n.script.content==""){$.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_checkChange=new Function("param",n.script.content),h=this.customScript_actionSend_checkChange(h,h)}L.Z.$emit(i,h),this.actionNameList.push(i),n.postMessage&&this.doPostMessage(h)}this.setSelectNodeColor(!0)},handleNodeClick(t){let e=this,o=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(o,n=>{if(n.enabled&&n.code.indexOf(e.$$global_editor.actionType.openLink.code)>-1){let i={value:t.label,node:t};if(n.paramsExtend&&n.paramsExtend.length>0&&this.getExtendParams(i,n.paramsExtend,e.widgetInfo.dataset[e.widgetInfo.dataset.type].source[t.index],e.widgetInfo.dataset[e.widgetInfo.dataset.type].dimensions),n.type===this.$$global_editor.linkType.dynamic.code&&(n[n.type].url=this.getActionUrl(n,e.widgetInfo.dataset[e.widgetInfo.dataset.type].source[t.index],e.widgetInfo.dataset[e.widgetInfo.dataset.type].dimensions)),n.script&&n.script.enabled){if(E.log("Execute script for "+n.name+" component to "+n.script.title+" component"),n.script.content==""){$.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_openLink=new Function("param",n.script.content),i=this.customScript_actionSend_openLink(i,i)}this.openLinkAction(n,i)}}),e.setSelectNodeColor(!1)},setSelectNodeColor(t){this.$nextTick(function(){let o=this.$refs.tree.$el.getElementsByClassName("el-tree-node");for(let n=0;n<o.length;n++){let i="";t&&o[n].className.indexOf("is-checked")>-1&&(i=this.widgetInfo.config.tree.selectedBackgroundColor),t||(o[n].className.indexOf("is-current")>-1&&(i=this.widgetInfo.config.tree.clickedBackgroundColor),!(o[n].className.indexOf("is-current")>-1)&&o[n].className.indexOf("is-checked")>-1&&(i=this.widgetInfo.config.tree.selectedBackgroundColor));let r=o[n].getElementsByClassName("el-tree-node__content")[0];r&&(r.style.background=i)}})}}},B=T,F=(0,S.Z)(B,f,c,!1,null,"8437fff4",null),A=F.exports}}]);
