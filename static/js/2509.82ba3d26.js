"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2509],{56279:function(b,m,n){n.d(m,{P:function(){return y}});var p=n(86892),g=n(49500);const y={mixins:[p.D],created(){},methods:{lifecycleBeforeChartsLoad(u){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&g.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let s=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[u]);if(s)return s}return u},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&g.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},5143:function(b,m,n){n.d(m,{b:function(){return u}});var p=n(48836),g=n(42160),y=n(49500);const u={created(){},computed:{...(0,p.Se)(["getWidgetAllArr"])},data(){return{containerViewSubWidgetList:[]}},methods:{...(0,p.nv)(["updateWidgetParentArrDataset","updateWidgetAllArrDataset"]),reLoadInfo(o){this.widgetInfo.id!=o.id&&this.$refs["comp_"+o.id]&&setTimeout(this.$refs["comp_"+o.id][0].reLoadInfo(o),500),this.loadInfo(o)},orgWidget(o){let s=[];return this.$$lib__.each(o,c=>{let l=this.$$lib__.find(this.getWidgetAllArr,f=>f.parentId==this.widgetInfo.id&&f.id==c.id);l&&(l.dataset&&l.dataset[l.dataset.type]&&(l.dataset.type==this.$$global_editor.dataSourcType.dynamic.code||l.dataset.type==this.$$global_editor.dataSourcType.local.code)&&l.dataset[l.dataset.type].autoUpdate==!0&&(g.default.set(this.dynamicWidgets,l.id,l),l.attr.hide!=!0&&l.dataset[l.dataset.type].autoUpdate==!0&&g.default.set(this.autoUpdateWidget,l.id,l)),s.push(l))}),g.default.set(this,"containerViewSubWidgetList",s),s},setTitleText(o,s){s?this.$$lib__.each(s,c=>{this.$$lib__.each(this.orgWidget(c.widgets),l=>{l.attr.widgetW||(l.attr.widgetW=l.attr.w),this.$refs["title_"+l.id]&&this.$refs["title_"+l.id][0]&&(this.$refs["title_"+l.id][0].innerHTML=this.initTextPosition(l)),l.title.position||(l.title.position="top")})}):this.$$lib__.each(this.orgWidget(o),c=>{this.$refs["title_"+c.id]&&this.$refs["title_"+c.id][0]&&(this.$refs["title_"+c.id][0].innerHTML=this.initTextPosition(c)),c.title.position||(c.title.position="top")})},initTextPosition(o){return o.title.text===void 0||!o.title.text?"":o.title.text&&(o.title.position==="left"||o.title.position==="right")?o.title.text.split("").join("<br />"):o.title.text},updataWidgetSource(o,s,c){try{switch(o.dataset.type){case this.$$global_editor.dataSourcType.dynamic.code:o.dataset.dynamic.source=s.data,s.total&&(o.dataset.dynamic.total=s.total);break;case this.$$global_editor.dataSourcType.local.code:o.dataset.local.dimensionsAlias=[],o.dataset.local.columnList=[],o.dataset.local.source=[],o.dataset.local.dimensions=[],o.dataset.local.dimensionsAlias=s.dimensionsAlias,o.dataset.local.columnList=s.columnList,o.dataset.local.source=s.source,o.dataset.local.dimensions=s.dimensions;break}}catch(f){y&&y.log&&y.log(f)}let l=this.$refs["comp_"+o.id];l&&l.length>0&&(this.updateWidgetAllArrDataset(o),this.updateWidgetParentArrDataset(o),l[0].reLoadInfo(o),this.sendoutDataloadSuccess(o),this.sendoutResponseData(o,s,c))},fit(o,s){if(!this.isView||!/^mobile/.test(this.getCanvasSetting.transformType))return o+"px";let c=this.getCanvasSetting.width/10,l=this.getCanvasSetting.height/window.innerHeight,f="";switch(this.getCanvasSetting.transformType){case"mobileAutoWidth":s?f=o+"px":f=o/c+"rem";break;case"mobileAutoBoth":f=o/c+"rem";break;default:s?f=o/l+"px":f=o/c+"rem"}return f}}}},80512:function(b,m,n){n.d(m,{Z:function(){return f}});var p=function(){var d=this,v=d._self._c;return v("div",{class:"container_child_"+d.widgetData.id,attrs:{id:"container_child_"+d.widgetData.id}},[v("keep-alive",[v(d.isView&&d.widgetData.isContainer?d.widgetData.typeName+"-view":d.widgetData.typeName,{ref:"com_"+d.widgetData.id,tag:"component",attrs:{"widget-info":d.widgetData,"widget-arr":d.getWidgetAllArr,"current-widget":d.currentWidget},on:{doGetPreviewData:d.doGetPreviewData,doReSetBoardId:d.doReSetBoardId,attrChange:d.attrChange}})],1)],1)},g=[],y=n(13229),u=n(48836),o={name:"DraggableComponent",extends:y.Z,computed:{...(0,u.Se)(["getWidgetAllArr","isView"])},methods:{reLoadInfo(h){if(h.id){let d=this.$refs["com_"+h.id];d&&d.reLoadInfo(h)}},doReSetBoardId(h){this.$emit("doReSetBoardId",h)},attrChange(h){this.$emit("attrChange",h)}}},s=o,c=n(68141),l=(0,c.Z)(s,p,g,!1,null,"41d16aa2",null),f=l.exports},62509:function(b,m,n){n.r(m),n.d(m,{default:function(){return _}});var p=function(){var t=this,a=t._self._c;return a("div",{staticClass:"my-div",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.attr.buttonHide,expression:"widgetInfo.attr.buttonHide"}],style:{position:"absolute",right:t.widgetInfo.attr.buttonHideRight+"px",top:t.widgetInfo.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"}},[a("el-tooltip",{attrs:{"open-delay":1e3,content:t.widgetInfo.attr.buttonHideTooltipContent,disabled:t.widgetInfo.attr.buttonHideTooltipContent==""||t.widgetInfo.attr.buttonHideTooltipContent==null,effect:"dark",placement:"top"}},[a("el-button",{class:t.widgetInfo.attr.buttonHideIconClass&&t.widgetInfo.attr.buttonHideIconClass!=""?t.widgetInfo.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.widgetInfo.attr.buttonHideColor,fontSize:t.widgetInfo.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"},on:{click:function(r){return t.onHide()}}})],1)],1),a("el-carousel",{ref:"myCarousel",staticClass:"my-carousel",attrs:{height:t.widgetInfo.attr.hh+"px",autoplay:t.widgetInfo.config.carouselAttr.autoplay,interval:t.widgetInfo.config.carouselAttr.interval*1e3,trigger:t.widgetInfo.config.carouselAttr.trigger,"indicator-position":t.widgetInfo.config.carouselAttr.indicatorPosition,arrow:t.widgetInfo.config.carouselAttr.arrow,type:t.widgetInfo.config.carouselAttr.type,loop:t.widgetInfo.config.carouselAttr.loop,direction:t.widgetInfo.config.carouselAttr.direction},on:{change:t.change}},t._l(t.widgetInfo.config.carouselItemAttr,function(r,S){return a("el-carousel-item",{key:S,attrs:{name:r.id,label:r.label}},[a("div",{staticClass:"my-screen",style:t.getCarouselItemStyle(r)},[t._l(t.orgWidget(r.widgets),function(i){return[a("div",{style:t.getWidgetStyle(i)},[a("div",{key:"widget_"+i.id,ref:"widget_"+i.id,refInFor:!0,class:t.getWidgetClass(i),style:t.getBindStyle(i),attrs:{id:"widget_"+i.id}},[a("external-frame-svg",{ref:"comp_frame_"+i.id,refInFor:!0,attrs:{"widget-info":i}}),i.title.position==="top"||i.title.position==="left"?a("div",{staticStyle:{overflow:"hidden",float:"left"},style:t.getWidgetTitleStyle(i),on:{click:function(I){return t.openLink(i)}}},[a("div",{style:{marginLeft:i.title.label.left+"px",marginTop:i.title.label.top+"px"}},[a("span",{ref:"title_"+i.id,refInFor:!0,style:t.getTitleSpanStyle(i)})])]):t._e(),a("draggable-component-container",{ref:"comp_"+i.id,refInFor:!0,staticStyle:{display:"inline-block",float:"left"},style:t.getInfoStyle(i),attrs:{"widget-data":i},on:{doGetPreviewData:t.getPreviewData,doReSetBoardId:t.doReSetBoardId,attrChange:t.attrChange}}),i.title.position==="bottom"||i.title.position==="right"?a("div",{staticStyle:{overflow:"hidden",float:"left"},style:t.getWidgetTitleStyle(i),on:{click:function(I){return t.openLink(i)}}},[a("div",{style:{marginLeft:i.title.label.left+"px",marginTop:i.title.label.top+"px"}},[a("span",{ref:"title_"+i.id,refInFor:!0,style:t.getTitleSpanStyle(i)})])]):t._e()],1)])]})],2)])}),1)],1)},g=[],y=n(27966),u=n(80512),o=n(93575),s=n(5143),c=n(23930),l=n(48836),f=n(21300),h=n(55616),d=n(1783),v=n(45061),x=n(56279),C=n(49500),N={name:"ContainerCarouselView",components:{ExternalFrameSvg:d.Z,DraggableComponentContainer:u.Z},mixins:[c.u,o.E,s.b,v.u,x.P],props:["widgetInfo","currentWidget"],data(){return{timerArr:[],dataSetArr:{},autoUpdateWidget:{},dynamicWidgets:{},prefix:{widget:"widget_"}}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.initAction(this.widgetInfo),this.$nextTick(function(){this.loadInfo(this.widgetInfo),this.setTitleText("widgets",this.widgetInfo.config.carouselItemAttr)})},methods:{...(0,l.nv)(["addChildInitFinish"]),loadInfo(e){this.getDynamicWidgetsSource(this.dynamicWidgets),this.setBtnStyle(e),this.setArrowStyle(e),this.setIndicatorPosition(e),this.lifecycleAfterLoad()},setArrowStyle(e){let t=this.$refs.myCarousel.$el.childNodes[0].childNodes;t[0].nodeName=="BUTTON"&&(t[0].className&&t[0].className.indexOf("el-carousel__arrow--left")>-1&&(e.config.carouselAttr.arrowStyle.leftArrowL&&(t[0].style.left=this.mUtils.getNewPxW(e.config.carouselAttr.arrowStyle.leftArrowL)+"px"),e.config.carouselAttr.arrowStyle.leftArrowT&&(t[0].style.top=this.mUtils.getNewPxH(e.config.carouselAttr.arrowStyle.leftArrowT)+"px"),t[0].style.transform="translateY(0)"),t[1].className&&t[1].className.indexOf("el-carousel__arrow--right")>-1&&(e.config.carouselAttr.arrowStyle.rightArrowL&&(t[1].style.right=this.mUtils.getNewPxW(e.config.carouselAttr.arrowStyle.rightArrowL)+"px"),e.config.carouselAttr.arrowStyle.rightArrowT&&(t[1].style.top=this.mUtils.getNewPxH(e.config.carouselAttr.arrowStyle.rightArrowT)+"px"),t[1].style.transform="translateY(0)"),e.config.carouselAttr.arrowStyle.type==="image"?(e.config.carouselAttr.arrowStyle.img?(t[0].style.backgroundImage=this.getURL(e.config.carouselAttr.arrowStyle.img),t[0].style.backgroundSize="cover",t[0].childNodes[0].className="",t[1].style.background=this.getURL(e.config.carouselAttr.arrowStyle.img),t[1].style.backgroundSize="cover",t[1].childNodes[0].className="",t[1].style.transform="rotateY(181deg)"):(t[0].style.backgroundImage="",t[1].style.backgroundImage="",t[0].childNodes[0].className="el-icon-arrow-left",t[1].childNodes[0].className="el-icon-arrow-right",t[1].childNodes[0].style.transform="rotateY(0deg)"),e.config.carouselAttr.arrowStyle.imgWidth&&(t[0].style.width=e.config.carouselAttr.arrowStyle.imgWidth+"px",t[1].style.width=e.config.carouselAttr.arrowStyle.imgWidth+"px"),e.config.carouselAttr.arrowStyle.imgHeight&&(t[0].style.height=e.config.carouselAttr.arrowStyle.imgHeight+"px",t[1].style.height=e.config.carouselAttr.arrowStyle.imgHeight+"px")):e.config.carouselAttr.arrowStyle.type==="icon"&&(t[0].style.backgroundImage="",t[1].style.backgroundImage="",e.config.carouselAttr.arrowStyle.iconClass?(t[0].childNodes[0].className=e.config.carouselAttr.arrowStyle.iconClass,t[1].childNodes[0].className=e.config.carouselAttr.arrowStyle.iconClass,t[1].childNodes[0].style.transform="rotateY(181deg)"):(t[0].childNodes[0].className="el-icon-arrow-left",t[1].childNodes[0].className="el-icon-arrow-right",t[1].childNodes[0].style.transform="rotateY(0deg)"),e.config.carouselAttr.arrowStyle.iconColor&&(t[0].childNodes[0].style.color=e.config.carouselAttr.arrowStyle.iconColor,t[1].childNodes[0].style.color=e.config.carouselAttr.arrowStyle.iconColor),e.config.carouselAttr.arrowStyle.fontSize&&(t[0].childNodes[0].style.fontSize=e.config.carouselAttr.arrowStyle.fontSize+"px",t[1].childNodes[0].style.fontSize=e.config.carouselAttr.arrowStyle.fontSize+"px")))},setIndicatorPosition(e){let t=this.$refs.myCarousel.$el,a=this.$refs.myCarousel.$el.childNodes[1];t.className&&t.className.indexOf("el-carousel")>-1&&a.className&&a.className.indexOf("el-carousel__indicators")>-1&&(e.config.carouselAttr.indicatorPosition==="custom"?(t.parentNode.style.position="relative",t.style.position="static",a.style.bottom=this.mUtils.getNewPxH(e.config.carouselAttr.indicatorBottom)+"px",a.style.left=this.mUtils.getNewPxW(e.config.carouselAttr.indicatorLeft)+"px",a.style.top="auto",a.style.right="auto",a.style.transform="none",a.style.position="absolute"):a.style="")},getURL(e){if(e&&e!="")return"url("+f.appendImageBaseURL(e)+")"},change(){this.$nextTick(function(){this.loadInfo(this.widgetInfo)})},setBtnStyle(e){let t=this.$refs.myCarousel.$el,a=t.childElementCount,r=e.config.panesAttr;if(a>1&&t.childNodes[1].nodeName=="UL")for(let S=0;S<t.childNodes[1].childNodes.length;S++){let i=t.childNodes[1].childNodes[S].childNodes[0];i.style.padding="2px 2px",i.style.display="inline-block",i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",i.style.width=r.width+"px",i.style.height=r.height+"px",i.style.border=r.border?"1px solid #ccc":"0px",i.style.borderColor=r.borderColor,i.style.borderRadius=r.borderRadius+"px",t.childNodes[1].childNodes[S].className.indexOf("is-active")>-1?(i.style.color=r.activeStyle.activeColor,i.style.backgroundColor=r.activeStyle.background.backgroundColor,i.style.backgroundImage=r.activeStyle.background.backgroundImage?this.getImageUrl(r.activeStyle.background.backgroundImage):"",i.style.backgroundSize=r.activeStyle.background.backgroundSize,i.style.fontFamily=r.activeStyle.fontStyle.fontFamily,i.style.fontSize=r.activeStyle.fontStyle.fontSize+"px",i.style.fontStyle=r.activeStyle.fontStyle.fontStyle,i.style.fontWeight=r.activeStyle.fontStyle.fontWeight,i.style.textAlign=r.activeStyle.fontStyle.horizontalAlignment,i.style.textDecoration=r.activeStyle.fontStyle.textDecoration):(i.style.color=r.inactivatedStyle.initialColor,i.style.backgroundColor=r.inactivatedStyle.background.backgroundColor,i.style.backgroundImage=r.inactivatedStyle.background.backgroundImage?this.getImageUrl(r.inactivatedStyle.background.backgroundImage):"",i.style.backgroundSize=r.inactivatedStyle.background.backgroundSize,i.style.fontFamily=r.inactivatedStyle.fontStyle.fontFamily,i.style.fontSize=r.inactivatedStyle.fontStyle.fontSize+"px",i.style.fontStyle=r.inactivatedStyle.fontStyle.fontStyle,i.style.fontWeight=r.inactivatedStyle.fontStyle.fontWeight,i.style.textAlign=r.inactivatedStyle.fontStyle.horizontalAlignment,i.style.textDecoration=r.inactivatedStyle.fontStyle.textDecoration)}},initAction(e){this.actionReceive(e),this.actionReceiveSelf(e)},actionReceiveSelf(e){e.action==null||e.action.receive==null||(e.action.receive.setActiveItem&&e.action.receive.setActiveItem.enabled&&this.setActiveItem(e.action.receive.setActiveItem,e.name),this.addChildInitFinish())},setActiveItem(e,t){this.$$lib__.each(e.activeItem,a=>{let r=a.activeItem,S=a.itemValue;this.$$lib__.each(r,i=>{let I=i[1]+"_"+i[0];i[1].indexOf("_")>-1&&(I=i[1]),y.Z.$on(I,T=>{let w=i[2],A=w.indexOf("|");if(A>-1&&(w=i[2].substring(A+1)),e.script&&e.script.enabled){if(C.log("Execute script for "+t+" component to "+e.name+" component"),e.script.content==""){h.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.doSetActiveItem=new Function("data","param_key","value","itemId",e.script.content)}this.doSetActiveItem(T,w,S,a.itemId)})})})},doSetActiveItem(e,t,a,r){a==null||a==""||a==null?this.$refs.myCarousel.setActiveItem(r):a==e[t]&&this.$refs.myCarousel.setActiveItem(r)},getCarouselItemStyle(e){return{opacity:e.opacity,backgroundColor:e.backgroundColor,backgroundImage:this.getImageUrl(e.backgroundImage),backgroundSize:e.backgroundSize}},doReSetBoardId(e){this.$emit("doReSetBoardId",e)}},created:function(){this.clear()},destroyed:function(){this.clear()}},$=N,L=n(68141),k=(0,L.Z)($,p,g,!1,null,"169702dd",null),_=k.exports}}]);
