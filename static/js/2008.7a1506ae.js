"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2008],{414666:function(B,C,a){var T=a(149500),A=a(29870),R=a(787879),m=a(183393);Object.defineProperty(C,"__esModule",{value:!![]}),C.BaseLayer=void 0;var S=a(779651),P=O(a(580823));function H(u){if(typeof R!="function")return null;var r=new R,o=new R;return(H=function(d){return d?o:r})(u)}function O(u,r){if(!r&&u&&u.__esModule)return u;if(u===null||A(u)!=="object"&&typeof u!="function")return{default:u};var o=H(r);if(o&&o.has(u))return o.get(u);var p={},d=Object.defineProperty&&m;for(var h in u)if(h!=="default"&&Object.prototype.hasOwnProperty.call(u,h)){var y=d?m(u,h):null;y&&(y.get||y.set)?Object.defineProperty(p,h,y):p[h]=u[h]}return p.default=u,o&&o.set(u,p),p}var s=S.Class.extend({config:{},viewer:null,initialize:function(r,o){this.viewer=o,this.config=r,this.name=r.name,this.config.hasOwnProperty("alpha")?this._opacity=Number(this.config.alpha):this.config.hasOwnProperty("opacity")&&this.config.opacity&&(this._opacity=Number(this.config.opacity)),this.config.hasOwnProperty("hasOpacity")&&(this.hasOpacity=this.config.hasOpacity),this.create(),r.visible?this.setVisible(!![]):this._visible=![],r.visible&&r.flyTo&&this.centerAt(0)},create:function(){},showError:function(r,o){o||(o="\u672A\u77E5\u9519\u8BEF"),this.viewer&&this.viewer.cesiumWidget.showErrorPanel(r,void 0,o),T.error("layer\u9519\u8BEF:"+r+o)},_visible:null,getVisible:function(){return this._visible},setVisible:function(r){this._visible!=null&&this._visible===r||(this._visible=r,r?(this.config.msg&&(0,P.msg)(this.config.msg),this.add()):this.remove())},add:function(){this._visible=!![],this.config.onAdd&&this.config.onAdd()},remove:function(){this._visible=![],this.config.onRemove&&this.config.onRemove()},centerAt:function(r){this.config.extent||this.config.center?this.viewer.shine.centerAt(this.config.extent||this.config.center,{duration:r,isWgs84:!![]}):this.config.onCenterAt&&this.config.onCenterAt(r)},hasOpacity:![],_opacity:1,setOpacity:function(r){this.config.onSetOpacity&&this.config.onSetOpacity(r)},hasZIndex:![],setZIndex:function(r){this.config.onSetZIndex&&this.config.onSetZIndex(r)},destroy:function(){this.setVisible(![])}});C.BaseLayer=s},402008:function(B,C,a){var T=a(29870),A=a(787879),R=a(183393),m=a(419534);Object.defineProperty(C,"__esModule",{value:!![]}),C.GeoJsonLayer=void 0;var S=m(a(611323)),P=m(a(53267)),H=m(a(342579)),O=m(a(934749)),s=E(a(187647)),u=m(a(202692)),r=E(a(580823)),o=E(a(792672)),p=a(414666),d=E(a(980790)),h=E(a(721617)),y=E(a(131490)),g=E(a(669471)),v=E(a(496535));function M(f){if(typeof A!="function")return null;var e=new A,l=new A;return(M=function(t){return t?l:e})(f)}function E(f,e){if(!e&&f&&f.__esModule)return f;if(f===null||T(f)!=="object"&&typeof f!="function")return{default:f};var l=M(e);if(l&&l.has(f))return l.get(f);var i={},t=Object.defineProperty&&R;for(var n in f)if(n!=="default"&&Object.prototype.hasOwnProperty.call(f,n)){var c=t?R(f,n):null;c&&(c.get||c.set)?Object.defineProperty(i,n,c):i[n]=f[n]}return i.default=f,l&&l.set(f,i),i}var $=p.BaseLayer.extend({dataSource:null,loadPromise:null,add:function(){!this.config.reload&&this.dataSource?this.viewer.dataSources.add(this.dataSource):this.queryData()},remove:function(){this.viewer.dataSources.remove(this.dataSource)},centerAt:function(){var f=(0,O.default)(S.default.mark(function l(i){var t=this;return S.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(this.config.extent||this.config.center)){c.next=4;break}this.viewer.shine.centerAt(this.config.extent||this.config.center,{duration:i,isWgs84:!![]}),c.next=6;break;case 4:return c.next=6,this.loadPromise.then(function(){(0,H.default)(this,t),this.viewer.flyTo((0,P.default)(this.dataSource.entities),{duration:i||this.config.duration})}.bind(this));case 6:case"end":return c.stop()}},l,this)}));function e(l){return f.apply(this,arguments)}return e}(),queryData:function(){var e=this,l=r.getProxyUrl(this.config);if(l.symbol&&l.symbol.styleOptions){var i=l.symbol.styleOptions;if(s.defined(i.clampToGround)&&(l.clampToGround=i.clampToGround),s.defined(i.color)){var t=new s.Color.fromCssColorString(s.defaultValue(i.color,"#FFFF00")).withAlpha(Number(s.defaultValue(i.opacity,.5)));l.fill=t}if(s.defined(i.outlineColor)){var n=new s.Color.fromCssColorString(i.outlineColor||"#FFFFFF").withAlpha(s.defaultValue(i.outlineOpacity,s.defaultValue(i.opacity,1)));l.stroke=n}s.defined(i.outlineWidth)&&(l.strokeWidth=i.outlineWidth)}var c=new s.GeoJsonDataSource;this.loadPromise=c.load(l.url,l),this.loadPromise.then(function(w){w.entities.owner.name=l.id,e.showResult(w)}).catch(function(w){e.showError("\u670D\u52A1\u51FA\u9519",w)})},showResult:function(e){this.dataSource&&this.viewer.dataSources.remove(this.dataSource),this.dataSource=e,this.viewer.dataSources.add(e),this.config.flyTo&&this.centerAt();for(var l=(0,P.default)(e.entities),i=0,t=l.length;i<t;i++){var n=l[i];this.config.symbol&&(this.config.symbol==="default"?this.setDefSymbol(n):this.setConfigSymbol(n,this.config.symbol)),this.bindMourseEvnet(n)}this._opacity!==1&&this.setOpacity(this._opacity)},hasOpacity:!![],_opacity:1,setOpacity:function(e){if(this._opacity=e,this.dataSource!=null)for(var l=(0,P.default)(this.dataSource.entities),i=0,t=l.length;i<t;i++){var n=l[i];if(n.polygon&&n.polygon.material&&n.polygon.material.color&&(this._updatEntityAlpha(n.polygon.material.color,this._opacity),n.polygon.outlineColor&&this._updatEntityAlpha(n.polygon.outlineColor,this._opacity)),n.polyline&&n.polyline.material&&n.polyline.material.color&&this._updatEntityAlpha(n.polyline.material.color,this._opacity),n.billboard&&(n.billboard.color=new s.Color.fromCssColorString("#FFFFFF").withAlpha(this._opacity)),n.model&&(n.model.color=new s.Color.fromCssColorString("#FFFFFF").withAlpha(this._opacity)),n.label){var c=this._opacity;n.attribute&&n.attribute.label&&n.attribute.label.opacity&&(c=n.attribute.label.opacity),n.label.fillColor&&this._updatEntityAlpha(n.label.fillColor,c),n.label.outlineColor&&this._updatEntityAlpha(n.label.outlineColor,c),n.label.backgroundColor&&this._updatEntityAlpha(n.label.backgroundColor,c)}}},_updatEntityAlpha:function(e,l){if(e){var i=e.getValue(this.viewer.clock.currentTime);if(!i||!i.withAlpha)return e;i=i.withAlpha(l),e.setValue(i)}},bindMourseEvnet:function(e){var l=this;(this.config.columns||this.config.popup)&&(e.popup={html:function(t){var n=l.getEntityAttr(t);return r.isString(n)?n:r.getPopupForConfig(l.config,n)},anchor:this.config.popupAnchor||[0,-15]}),this.config.tooltip&&(e.tooltip={html:function(t){var n=l.getEntityAttr(t);return r.isString(n)?n:r.getPopupForConfig({popup:l.config.tooltip},n)},anchor:this.config.tooltipAnchor||[0,-15]}),this.config.click&&(e.click=this.config.click),this.config.mouseover&&(e.mouseover=this.config.mouseover),this.config.mouseout&&(e.mouseout=this.config.mouseout)},getEntityAttr:function(e){return r.getAttrVal(e.properties)},colorHash:{},setDefSymbol:function(e){var l=this.getEntityAttr(e)||{};if(e.polygon){var i=l.id||l.OBJECTID||0,t=this.colorHash[i];!t&&(t=s.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:this._opacity}),this.colorHash[i]=t),e.polygon.material=t,e.polygon.outline=!![],e.polygon.outlineColor=s.Color.WHITE}else if(e.polyline){var n=l.id||l.OBJECTID||0,c=this.colorHash[n];!c&&(c=s.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:this._opacity}),this.colorHash[n]=c),e.polyline.material=c,e.polyline.width=2}else e.billboard&&(e.billboard.scale=.5,e.billboard.horizontalOrigin=s.HorizontalOrigin.CENTER,e.billboard.verticalOrigin=s.VerticalOrigin.BOTTOM)},setConfigSymbol:function(e,l){var i=this.getEntityAttr(e)||{},t=l.styleOptions;if(l.styleField){var n=i[l.styleField],c=l.styleFieldOptions[n];c!=null&&(t=r.clone(t),t=u.default.default.extend(t,c))}if(typeof l.calback=="function"){var w=l.calback(i,e,l);if(!w)return;t=r.clone(t),t=u.default.default.extend(t,w)}if(t=t||{},e.polyline&&((0,g.style2Entity)(t,e.polyline),t.label&&t.label.field)){t.label.heightReference=s.defaultValue(t.label.heightReference,s.HeightReference.CLAMP_TO_GROUND);var W=h.style2Entity(t.label);W.text=i[t.label.field]||W.text||"";var b=g.getPositions(e),V=b[Math.floor(b.length/2)];t.label.position&&(t.label.position==="center"?V=o.centerOfMass(b):r.isNumber(t.label.position)&&(V=b[t.label.position]));var K=this.dataSource.entities.add({position:V,label:W,properties:i});this.bindMourseEvnet(K)}if(e.polygon){if((0,v.style2Entity)(t,e.polygon),t.outlineWidth&&t.outlineWidth>1){e.polygon.outline=![];var Q={color:t.outlineColor,width:t.outlineWidth,opacity:t.outlineOpacity,lineType:t.lineType?t.lineType:"solid",clampToGround:t.clampToGround,outline:t.outline?t.outline:![]},U=g.style2Entity(Q);U.positions=v.getPositions(e);var X=this.dataSource.entities.add({polyline:U,properties:i});this.bindMourseEvnet(X)}else if(t.outlineWidth&&t.outlineWidth==1){e.polygon.outline=!![];var Y={color:t.outlineColor,width:1,opacity:t.outlineOpacity,lineType:t.lineType?t.lineType:"solid",clampToGround:t.clampToGround},k=g.style2Entity(Y);k.positions=v.getPositions(e);var q=this.dataSource.entities.add({polyline:k,properties:i});this.bindMourseEvnet(q)}if(t.label&&t.label.field){t.label.heightReference=s.defaultValue(t.label.heightReference,s.HeightReference.CLAMP_TO_GROUND);var L=h.style2Entity(t.label);L.text=i[t.label.field]||L.text||"";var x=t.extrudedHeight?t.extrudedHeight:null,_=this.dataSource.entities.add({position:o.centerOfMass(v.getPositions(e),x),label:L,properties:i});this.bindMourseEvnet(_)}if(l.volumeStyle){var tt=Number(i[l.volumeStyle.cloumn]||1),F=3.5,D=l.volumeStyle.height;r.isNumber(D)?F=D:r.isString(D)&&(F=i[D]||F),e.polygon.extrudedHeight=tt*F}if(t.jzheight){var I=i[t.jzheight];I&&I._value!==0&&(e.polygon.extrudedHeight=I,e.polygon.heightReference=s.HeightReference.CLAMP_TO_GROUND)}if(t.colorty&&window.color_type){var G;this._opacity?G=this._opacity:G=1;var et=t.colorty,it=i[t.proID],j=window.color_type[et].color[it];if(!j)e.polygon.material=new s.Color(1,1,1,G);else{var z,J,Z;z=j[0]/255,J=j[1]/255,Z=j[2]/255,e.polygon.material=new s.Color(z,J,Z,G)}}}if(e.label&&(t.label=t.label||t||{},t.label.heightReference=s.defaultValue(t.label.heightReference,s.HeightReference.CLAMP_TO_GROUND),h.style2Entity(t.label,e.label),t.label.field&&(e.label.text=i[t.label.field]||e.label.text||"")),e.billboard){if(t.heightReference=s.defaultValue(t.heightReference,s.HeightReference.CLAMP_TO_GROUND),d.style2Entity(t,e.billboard),t.label&&t.label.field&&!e.label){t.label.heightReference=s.defaultValue(t.label.heightReference,s.HeightReference.CLAMP_TO_GROUND);var N=h.style2Entity(t.label);N.text=i[t.label.field]||N.text||"";var ot=this.dataSource.entities.add({position:e.position,label:N,properties:i});this.bindMourseEvnet(ot)}if(t.model){t.model.heightReference=s.defaultValue(t.model.heightReference,s.HeightReference.CLAMP_TO_GROUND);var nt=y.style2Entity(t.model),lt=this.dataSource.entities.add({position:e.position,model:nt,properties:i});this.bindMourseEvnet(lt)}}e.attribute=t}});C.GeoJsonLayer=$},779651:function(B,C,a){var T=a(29870),A=a(787879),R=a(183393),m=a(419534);Object.defineProperty(C,"__esModule",{value:!![]}),C.Class=r;var S=m(a(581806)),P=m(a(705146)),H=m(a(520314)),O=u(a(936161));function s(o){if(typeof A!="function")return null;var p=new A,d=new A;return(s=function(y){return y?d:p})(o)}function u(o,p){if(!p&&o&&o.__esModule)return o;if(o===null||T(o)!=="object"&&typeof o!="function")return{default:o};var d=s(p);if(d&&d.has(o))return d.get(o);var h={},y=Object.defineProperty&&R;for(var g in o)if(g!=="default"&&Object.prototype.hasOwnProperty.call(o,g)){var v=y?R(o,g):null;v&&(v.get||v.set)?Object.defineProperty(h,g,v):h[g]=o[g]}return h.default=o,d&&d.set(o,h),h}function r(){}r.extend=function(o){var p=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=p.__super__=this.prototype,h=O.create(d);h.constructor=p,p.prototype=h;for(var y in this)this.hasOwnProperty(y)&&y!=="prototype"&&y!=="__super__"&&(p[y]=this[y]);if(o.statics&&(O.extend(p,o.statics),delete o.statics),(0,S.default)(o)){var g;O.extend.apply(null,(0,P.default)(g=[h]).call(g,(0,S.default)(o))),delete o.includes}return h.options&&(o.options=O.extend(O.create(h.options),o.options)),O.extend(h,o),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!![];for(var v=0,M=h._initHooks.length;v<M;v++)h._initHooks[v].call(this)}},p},r.include=function(o){return O.extend(this.prototype,o),this},r.mergeOptions=function(o){return O.extend(this.prototype.options,o),this},r.addInitHook=function(o){var p=(0,H.default)(Array.prototype).call(arguments,1),d=typeof o=="function"?o:function(){this[o].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this}}}]);
