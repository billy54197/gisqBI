"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[8090],{56279:function(H,m,s){s.d(m,{P:function(){return d}});var f=s(386892),p=s(149500);const d={mixins:[f.D],created(){},methods:{lifecycleBeforeChartsLoad(w){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&p.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let I=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[w]);if(I)return I}return w},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&p.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(H,m,s){s.d(m,{X:function(){return f},b:function(){return p}});let f={versions:function(){var d=navigator.userAgent;return{trident:d.indexOf("Trident")>-1,presto:d.indexOf("Presto")>-1,webKit:d.indexOf("AppleWebKit")>-1,gecko:d.indexOf("Gecko")>-1&&d.indexOf("KHTML")==-1,mobile:!!d.match(/AppleWebKit.*Mobile.*/),ios:!!d.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:d.indexOf("Android")>-1,iPhone:d.indexOf("iPhone")>-1,iPad:d.indexOf("iPad")>-1,webApp:d.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},p;f.versions.mobile||f.versions.ios||f.versions.android||f.versions.iPhone||f.versions.iPad?p=!1:p=!0},208090:function(H,m,s){s.r(m),s.d(m,{default:function(){return W}});var f=function(){var o=this,n=o._self._c;return n("div",{ref:"myBar",style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}},[n("hide-button",{attrs:{attr:o.widgetInfo.attr}}),n("div",{ref:"barNegative",style:{width:o.widgetInfo.attr.w+"px"}})],1)},p=[],d=s(844513),w=s(927966),A=s(994480),I=s(445061),$=s(126711),E=s(99349),O=s(555616),r=s(275770),D=s(67157),y=s(150813);const z={mixins:[D.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(y.Z.charts.title)),legend:JSON.parse(JSON.stringify(y.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(y.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(y.Z.charts.toolbox)),visualMap:{inRange:{color:["#000000"]}},dataZoom:JSON.parse(JSON.stringify(y.Z.charts.dataZoom)),xAxis:JSON.parse(JSON.stringify(y.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(y.Z.charts.yAxis)),series:[{itemStyle:{colorInfo:[{type:"gradation",pureColor:"",gradation:{top:"rgba(146, 203, 255, 1)",bottom:"rgba(20, 122, 217, 1)"}}],opacity:1}}]}}},methods:{filterPredefineColoursSchemeConfig(t,o){this.getNewConfigWithArrary(t,o,this.filter_config)}}};var M=s(56279),x=s(149500);const T=s(954255);var R={name:"BarNegative",components:{HideButton:d.Z},mixins:[A.baseConfig,I.u,$.H,M.P,E.P,z],props:["widgetInfo"],data(){return{dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.setContentAreaStyle(this.widgetInfo),this.echarts=T.init(this.$refs.barNegative,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),this.initClick(this.widgetInfo)},destroyed(){this.echarts.dispose(),this.clearAutoCarousel()},methods:{loadInfo(t){t.dataset[t.dataset.type]&&(this.source=t.dataset[t.dataset.type].source,this.dimensionsEx=t.dataset[t.dataset.type].dimensions),t.config.drillDown&&t.config.drillDown.enable==!0?(this.drillDown=JSON.parse(JSON.stringify(t.config.drillDown)),delete this.drillDown.graphic,this.drillDown.pid_arrary=[],this.doDrillDown(t,!0)):this.beforeRenderEcharts(t,this.source)},renderEcharts(t,o){let n=[],a=[];t.dataset[t.dataset.type]&&(n=t.dataset[t.dataset.type].dimensions,a=t.dataset[t.dataset.type].dimensionsAlias),this.dimensionsAliasEx=a;let e=JSON.parse(JSON.stringify(t.config.series)),h=this.getTooltip(t.config.tooltip),N=JSON.parse(JSON.stringify(t.config.toolbox)),j=this.getTooltip(t.config.dataZoom),c=JSON.parse(JSON.stringify(t.config.legend)),g=JSON.parse(JSON.stringify(t.config.title)),L=JSON.parse(JSON.stringify(t.config.grid)),P=this.getxAxis(t.config.xAxis);P.axisLine.lineStyle.color=this.getColorInfo(P.axisLine.lineStyle.colorInfo);let J=this.getyAxis(t.config.yAxis);J.axisLine.lineStyle.color=this.getColorInfo(J.axisLine.lineStyle.colorInfo);let Z=[];if(t.config.drillDown&&t.config.drillDown.enable==!0){let i=this.getGraphic(t.config.drillDown.graphic);i&&i.elements&&i.elements.length>0&&(i.elements[0].ignore=this.drillDown.pid_arrary.length<1),Z.push(i)}for(let i=0;i<e.length;i++){e[i].dimensions=n,e[i].type="bar",e[i].barGap&&(e[i].barGap=e[i].barGap+"%"),e[i].barWidth&&(e[i].barWidth=e[i].barWidth+"%"),e[i].itemStyle.barBorderRadiusInfo&&(e[i].itemStyle.barBorderRadius=this.getItemStyleBarBorderRadius(e[i].itemStyle.barBorderRadiusInfo)),e[i].name||(e[i].name=this.getLegendData(a,e[i].encode.x),t.config.series[i].name=e[i].name),e[i].itemStyle.colorInfo[0].type&&(e[i].itemStyle.color=this.getItemStyleColor(e[i].itemStyle.colorInfo[0])),e[i].label=this.getLabelStyle(e[i].label);let v={},u=[],B=[];for(let l=e[i].dimensions.length-1;l>-1;--l)v[n[l]]=l;for(let l=0;l<o.length;++l){let C=o[l],b={};for(let F in v)b[F]=C[v[F]]||"";u.push({name:C[v[e[i].encode.y]]||"",value:C[v[e[i].encode.x]]||"",itemStyle:{color:e[i].itemStyle.colorInfo[l]?this.getItemStyleColor(e[i].itemStyle.colorInfo[l]):this.getItemStyleColor(e[i].itemStyle.colorInfo[0])},row:b}),B.push(C[v[e[i].encode.y]]||""),e[i].label.show&&e[i].label.position&&C[v[e[i].encode.x]]<0&&(e[i].label.position==="left"&&(u[l].label={position:"right"}),e[i].label.position==="right"&&(u[l].label={position:"left"}))}if(e[i].data=u,e[i].emphasis)try{let l=e[i].emphasis;if(l.script&&l.script.enabled){if(l.script.content){let C=new Function("index","item","data",l.script.content);if(u&&u.length>0)for(let b=0;b<u.length;++b)try{u[b].emphasis=C.call(this,b,u[b],u)}catch(F){x.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",F)}}}else l.itemStyle&&l.itemStyle.color&&(e[i].emphasis={itemStyle:{...l.itemStyle}})}catch(l){x.error("\u5904\u7406\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",l)}J.data=B}let S={color:this.$$global_editor.predefineColors,tooltip:h,toolbox:N,dataZoom:j,visualMap:t.config.visualMap.show?this.getVisualMap(t.config.visualMap):"",title:{show:g.show,text:g.text,link:g.link,textAlign:g.textAlign,left:g.left+"%",right:g.right+"%",top:g.top+"%",bottom:g.bottom+"%",textStyle:{fontSize:g.textStyle.fontSize,fontFamily:g.textStyle.fontFamily,color:g.textStyle.color}},legend:{show:c.show,type:c.type,itemWidth:c.itemWidth,itemHeight:c.itemHeight,icon:c.icon,orient:c.orient,align:c.align,itemGap:c.itemGap,left:c.left+"%",right:c.right+"%",top:c.top+"%",bottom:c.bottom+"%",textStyle:{fontSize:c.textStyle.fontSize,fontFamily:c.textStyle.fontFamily,color:c.textStyle.color}},graphic:Z,grid:{left:L.left+"%",right:L.right+"%",top:L.top+"%",bottom:L.bottom+"%",containLabel:!0},xAxis:P,yAxis:J,dataset:{source:o,sourceHeader:!1},series:e};S.xAxis.min==""&&delete S.xAxis.min,S.xAxis.max==""&&delete S.xAxis.max,this.getAnimation(S,t),this.setOption(S),this.setAnimationLoop(t,()=>{this.setOption(S,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},reLoadInfo(t){this.mergeConfig(t),this.setContentAreaStyle(t),this.loadInfo(t),this.echarts.resize()},setContentAreaStyle(t){t&&(this.$refs.barNegative.style.width=t.attr.w+"px",this.$refs.myBar.style.overflowX="hidden",t.config.contentArea.show?(this.$refs.barNegative.style.height=t.dataset[t.dataset.type].source.length*t.config.contentArea.barAllW+"px",this.$refs.barNegative.style.marginTop=t.config.contentArea.top+"px",this.$refs.myBar.style.overflowY=t.config.contentArea.scrollAreay?"auto":"hidden"):(this.$refs.barNegative.style.height=t.attr.hh+"px",this.$refs.barNegative.style.marginTop="0px",this.$refs.myBar.style.overflowY="hidden"))},getLegendData(t,o){let n=this.$$lib__.find(t,a=>a.name==o);return n?n.alias&&n.alias!=""?n.alias:n.name:""},getItemStyleColor(t){let o=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?o=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(o=new T.graphic.LinearGradient(1,0,0,0,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),o},getItemStyleBarBorderRadius(t){let o=[];return o.push(t.lt),o.push(t.rt),o.push(t.rb),o.push(t.lb),o},initAction(t){this.actionReceive(t)},doDrillDown(t,o){let n=[];if(this.drillDown.pidValue&&this.drillDown.id&&this.drillDown.pid){let a={};for(let e=this.dimensionsEx.length-1;e>-1;--e)a[this.dimensionsEx[e]]=e;for(let e=0;e<this.source.length;++e){let h=this.source[e];h[a[this.drillDown.pid]]==this.drillDown.pidValue&&n.push(JSON.parse(JSON.stringify(h)))}}else x.error("\u5FC5\u987B\u914D\u7F6E\u4E0B\u94BB\u7684\u3010\u4E0A\u7EA7\u6570\u503C\u3001\u6570\u636E\u5B57\u6BB5\u3001\u4E0A\u7EA7\u5B57\u6BB5\u3011");if(n.length>0)this.beforeRenderEcharts(t,n);else{let a=this.drillDown.pid_arrary.length-1;this.drillDown.pid_arrary.length=a>0?a:0,x.info("\u4E0B\u94BB\u5DF2\u65E0\u6570\u636E"),o&&this.renderEcharts(t,n)}},initClick(t){this.echarts.on("click",o=>{if(o.componentType=="graphic"){if(this.drillDown&&this.drillDown.enable==!0){let n=this.drillDown.pid_arrary.length;n>0?(this.drillDown.pidValue=this.drillDown.pid_arrary[n-1],this.drillDown.pid_arrary.length=n-1,this.drillDown.pidValue?this.doDrillDown(t):x.error("\u4E0B\u94BB\u5B57\u6BB5\u672A\u83B7\u53D6\u5230\u6709\u6548\u503C")):x.error("\u5DF2\u7ECF\u662F\u6700\u9876\u7EA7\uFF0C\u4E0D\u53EF\u4EE5\u518D\u8FD4\u56DE")}}else o.componentType=="series"&&(this.actionOnClick(t,o),this.drillDown&&this.drillDown.enable==!0&&(this.drillDown.pid_arrary.length==0?this.drillDown.pid_arrary.push(t.config.drillDown.pidValue):this.$$lib__.contains(this.drillDown.pid_arrary,this.drillDown.pidValue)||this.drillDown.pid_arrary.push(this.drillDown.pidValue),this.drillDown.pidValue=o.data.row[this.drillDown.id],this.drillDown.pidValue?this.doDrillDown(t):x.error("\u4E0B\u94BB\u5B57\u6BB5\u672A\u83B7\u53D6\u5230\u6709\u6548\u503C")))})},actionOnClick(t,o){let n=this;this.$$lib__.each(t.action.sendOut.actionList,a=>{if(a.enabled){let e=a.code+"_"+t.id;if(a.paramsExtend&&a.paramsExtend.length>0){let h={};this.getParamsExtend(h,a.paramsExtend,t)}if(a.code==r.default.click.code){let h={};h.x=o.name,h.y=o.value;let N=[];if(t.dataset[t.dataset.type].source&&t.dataset[t.dataset.type].source.length>0&&(N=t.dataset[t.dataset.type].source[o.dataIndex]),n.getExtendParams(h,a.paramsExtend,N,t.dataset[t.dataset.type].dimensions),a.script&&a.script.enabled){if(x.log("Execute script for "+t.name+" component to "+a.name+" component"),a.script.content==""){O.Message.warning({message:a.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",a.script.content),h=this.customScript_actionSend_clickParam(h,o)}w.Z.$emit(e,h),a.postMessage&&n.doPostMessage(h)}}})},getFieldIndex(t,o){for(let n=0;n<t.length;n++)if(t[n]==o)return n},beforeRenderEcharts(t,o){this.clearAutoCarousel(),t.config.autoCarousel.enable==!0?this.setAutoCarousel(t,o):this.renderEcharts(t,o)}}},V=R,_=s(768141),G=(0,_.Z)(V,f,p,!1,null,"576c60d7",null),W=G.exports},844513:function(H,m,s){s.d(m,{Z:function(){return E}});var f=function(){var r=this,D=r._self._c;return r.attr.buttonHide?D("div",{style:{position:"absolute",right:r.attr.buttonHideRight+"px",top:r.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(y){return r.onHide()}}},[r.openTooltip?D("el-tooltip",{attrs:{"open-delay":1e3,content:r.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[D("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):D("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r._e()},p=[],d=s(752246),w={props:["attr"],name:"hide-button",data(){return{isPc:d.b}},computed:{openTooltip:function(){let O=!1,r=this.attr.buttonHideTooltipContent;return d.b&&r&&r!=null&&r.trim()!=""&&(O=!0),O}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},A=w,I=s(768141),$=(0,I.Z)(A,f,p,!1,null,"bf399b9a",null),E=$.exports}}]);
