"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[4793],{56279:function(M,u,d){d.d(u,{P:function(){return l}});var m=d(86892),c=d(49500);const l={mixins:[m.D],created(){},methods:{lifecycleBeforeChartsLoad(f){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&c.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let g=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[f]);if(g)return g}return f},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&c.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},44513:function(M,u,d){d.d(u,{Z:function(){return C}});var m=function(){var s=this,p=s._self._c;return s.attr.buttonHide?p("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(z){return s.onHide()}}},[s.openTooltip?p("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[p("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):p("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},c=[],l=d(52246),f={props:["attr"],name:"hide-button",data(){return{isPc:l.b}},computed:{openTooltip:function(){let I=!1,s=this.attr.buttonHideTooltipContent;return l.b&&s&&s!=null&&s.trim()!=""&&(I=!0),I}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},y=f,g=d(68141),v=(0,g.Z)(y,m,c,!1,null,"bf399b9a",null),C=v.exports},54793:function(M,u,d){d.r(u),d.d(u,{default:function(){return A}});var m=function(){var t=this,o=t._self._c;return o("div",{ref:"wordCloud",staticClass:"page",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[o("hide-button",{attrs:{attr:t.widgetInfo.attr}}),o("div",{staticClass:"page"},[o("div",{ref:"Panel",staticClass:"tagsCloud",style:{height:t.mUtils.getNewPxH(t.boxWidth)+"px",width:t.mUtils.getNewPxW(t.boxWidth)+"px"},on:{mousemove:function(i){return t.listener(i)},mouseout:t._out}},t._l(t.useArray,function(i,a){return o("div",{key:a,staticClass:"item",style:[{opacity:(t.boxWidth*.65+i.z)/t.boxWidth},{fontSize:t.mUtils.getNewFontSize((i.z/t.boxWidth/2+.5)*i.fontSize)+"px"},{fontWeight:t.widgetInfo.config.fontWeight},{fontFamily:t.widgetInfo.config.fontFamily},{fontStyle:t.widgetInfo.config.fontStyle},{textDecoration:t.widgetInfo.config.textDecoration},{transform:"translate("+t.mUtils.getNewPxW(i.x)+"px,"+t.mUtils.getNewPxH(i.y)+"px)"},{transformOrigin:"100% 100% 0 "},{zIndex:Math.round(i.zindexVal)},{display:"inline-block"},{color:i.available?i.rcolor:"#c0c4cc"}],on:{mouseenter:function(n){return t.enter(n)},mouseleave:function(n){return t.leave(n)},click:function(n){return t.onClick(i)}}},[t._v(" "+t._s(i.name)+" ")])}),0)])],1)},c=[],l=d(42160),f=d(44513),y=d(45061),g=d(26711),v=d(56279),C=d(68279),I=d(27966),s=d(55616),p=d(67157);const z={mixins:[p.c],data(){return{config_extend:{config:{fontFamily:"alibabaPuHuiTiMedium"}},filter_config:{fontFamily:"alibabaPuHuiTiMedium",color:["#4C84FF"]}}},methods:{filterPredefineColoursSchemeConfig(e,t){this.getNewConfigWithArrary(e,t,this.filter_config)}}};var S=d(49500),L={props:["widgetInfo"],name:"com-wordCloud3d",components:{HideButton:f.Z},mixins:[C.u,y.u,g.H,v.P,z],data(){return{boxWidth:200,speed:200,randomColor:!0,speedX:1,speedY:1,useArray:[],timer:"",color:[]}},computed:{radius(){return this.boxWidth/3},CX(){return this.boxWidth/2-this.widgetInfo.config.fontSize/2},CY(){return this.boxWidth/2-this.widgetInfo.config.fontSize/2}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{loadInfo(e){let t=[],o=[],i=[];t=e.dataset[e.dataset.type].source,o=e.dataset[e.dataset.type].dimensions,i=e.dataset[e.dataset.type].encode,this.useArray=this.getSeriesData(t,o,i),this.fontsize(e),this.boxWidth=e.config.boxWidth,this.randomColor=e.config.randomColor,this.color=e.config.color,this.speed=e.config.speed>0?(101-e.config.speed)*10:e.config.speed,this.speedX=Math.PI/this.speed*Math.sin(e.config.angle*Math.PI/180)*-1,this.speedY=Math.PI/this.speed*Math.cos(e.config.angle*Math.PI/180),this.init(),clearInterval(this.timer),this.timer=setInterval(()=>{this.rotateX(),this.rotateY()},10),this.lifecycleAfterLoad()},fontsize(e){e.dataset[e.dataset.type].encode.fontSize==""&&this.useArray.forEach(t=>{t.fontSize=e.config.fontSize})},reLoadInfo(e){e&&(this.$refs.wordCloud.style.width=e.attr.w+"px",this.$refs.wordCloud.style.height=e.attr.hh+"px"),this.loadInfo(e)},getSeriesData(e,t,o){let i=[],a=-1,n=-1,h=-1;for(let r=0;r<t.length;r++)t[r]==o.txt&&(a=r),t[r]==o.fontSize&&(n=r),t[r]==o.available&&(h=r);let P;if(n>-1){let r=this.widgetInfo.config.fontSizeMin,H=this.widgetInfo.config.fontSizeMax,w=Number(e[0][n]),x=Number(e[0][n]);e.forEach(X=>{let b=Number(X[n]);w=w>b?b:w,x=x<b?b:x}),P=x!==w?(H-r)/(x-w):H-r}for(let r=0;r<e.length;r++)i.push({name:e[r][a],index:r,fontSize:n>-1?e[r][n]*P:this.widgetInfo.config.fontSize,available:h>-1?e[r][h]:!0});return i},init(){let e=Math.min(parseInt(this.$refs.wordCloud.style.width),parseInt(this.$refs.wordCloud.style.height));this.boxWidth>e&&(this.boxWidth=e),this.useArray.forEach((t,o)=>{let i=-1+(2*(o+1)-1)/this.useArray.length,a=Math.acos(i),n=a*Math.sqrt(this.useArray.length*Math.PI);l.default.set(t,"x",this.radius*Math.sin(a)*Math.cos(n)*this.widgetInfo.config.scaleW+this.CX),l.default.set(t,"y",this.radius*Math.sin(a)*Math.sin(n)*this.widgetInfo.config.scaleH+this.CY),l.default.set(t,"z",this.radius*Math.cos(a)),this.randomColor&&this.color[o]?l.default.set(t,"rcolor",this.color[o]):l.default.set(t,"rcolor","rgb("+Math.random()*255+","+Math.random()*255+","+Math.random()*255+")");let h=this.boxWidth/(this.boxWidth-t.z);l.default.set(t,"zindexVal",h*100)})},rotateX(){let e=Math.cos(this.speedX),t=Math.sin(this.speedX);this.useArray.forEach(o=>{let i=(o.y-this.CY)*e-o.z*t+this.CY,a=o.z*e+(o.y-this.CY)*t;o.y=i,o.z=a;let n=this.boxWidth/(this.boxWidth-o.z);o.zindexVal=n*100})},rotateY(){let e=Math.cos(this.speedY),t=Math.sin(this.speedY);this.useArray.forEach(o=>{let i=(o.x-this.CX)*e-o.z*t+this.CX,a=o.z*e+(o.x-this.CX)*t;o.x=i,o.z=a;let n=this.boxWidth/(this.boxWidth-o.z);o.zindexVal=n*100})},listener(e){let t=this.$refs.Panel.getBoundingClientRect().left,o=this.$refs.Panel.getBoundingClientRect().top,i=e.clientX-t-this.CX,a=e.clientY-o-this.CY;this.speedY=i*1e-4>0?Math.min(this.radius*2e-5,i*1e-4):Math.max(-this.radius*2e-5,i*1e-4),this.speedX=a*1e-4>0?Math.min(this.radius*2e-5,a*1e-4):Math.max(-this.radius*2e-5,a*1e-4)},enter(){this.widgetInfo.config.hover&&clearInterval(this.timer)},leave(){this.widgetInfo.config.hover&&(this.timer=setInterval(()=>{this.rotateX(),this.rotateY()},10))},_out(){this.speedX=Math.PI/this.speed*Math.sin(this.widgetInfo.config.angle*Math.PI/180)*-1,this.speedY=Math.PI/this.speed*Math.cos(this.widgetInfo.config.angle*Math.PI/180)},initAction(e){this.actionSendout(e),this.actionReceive(e)},onClick(e){let t=this,o=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(o,i=>{if(i.enabled&&i.code==t.$$global_editor.actionType.click.code&&e.available){let a=t.$$global_editor.actionType.click.code+"_"+t.widgetInfo.id,n={name:e.name};if(i.paramsExtend&&i.paramsExtend.length>0){let h=[];t.widgetInfo.dataset[t.widgetInfo.dataset.type].source&&t.widgetInfo.dataset[t.widgetInfo.dataset.type].source.length>0&&(h=t.widgetInfo.dataset[t.widgetInfo.dataset.type].source[e.index]),this.getExtendParams(n,i.paramsExtend,h,t.widgetInfo.dataset[t.widgetInfo.dataset.type].dimensions)}if(i.script&&i.script.enabled){if(S.log("Execute script for "+t.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){s.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param",i.script.content),n=this.customScript_actionSend_clickParam(n)}I.Z.$emit(a,n),i.postMessage&&this.doPostMessage(n),this.actionNameList.push(a)}else if(i.enabled&&i.code==t.$$global_editor.actionType.openLink.code&&e.available){let a={name:e.name};if(i.paramsExtend&&i.paramsExtend.length>0){let n=[];t.widgetInfo.dataset[t.widgetInfo.dataset.type].source&&t.widgetInfo.dataset[t.widgetInfo.dataset.type].source.length>0&&(n=t.widgetInfo.dataset[t.widgetInfo.dataset.type].source[e.index]),this.getExtendParams(a,i.paramsExtend,n,t.widgetInfo.dataset[t.widgetInfo.dataset.type].dimensions)}if(i.script&&i.script.enabled){if(S.log("Execute script for "+t.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){s.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_openLink=new Function("param",i.script.content),a=this.customScript_actionSend_openLink(a)}this.openLinkAction(i,a)}})}}},W=L,E=d(68141),$=(0,E.Z)(W,m,c,!1,null,"65f99997",null),A=$.exports}}]);
