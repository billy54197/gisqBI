"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[9934],{56279:function(O,x,i){i.d(x,{P:function(){return D}});var v=i(86892),g=i(49500);const D={mixins:[v.D],created(){},methods:{lifecycleBeforeChartsLoad(p){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&g.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let S=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[p]);if(S)return S}return p},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&g.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},19934:function(O,x,i){i.r(x),i.d(x,{default:function(){return B}});var v=function(){var a=this,e=a._self._c;return e("div",{style:{width:a.widgetInfo.attr.w+"px",overflow:"hidden",height:a.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:a.widgetInfo.attr}}),e("div",{ref:"barThreeDimensional",style:{width:a.widgetInfo.attr.w+"px",height:a.widgetInfo.attr.hh+"px"},attrs:{id:"barThreeDimensional"}})],1)},g=[],D=i(44513),p=i(27966),N=i(87798),S=i(45061),I=i(26711),J=i(77403),b=i(99349),F=i(8925),A=i(55616),M=i(75770),L=i(56279),z=i(67157),d=i(50666);const $={mixins:[z.c],data(){return{config_extend:{config:{series:{barWidth:30}}},filter_config:{title:JSON.parse(JSON.stringify(d.Z.charts.title)),legend:JSON.parse(JSON.stringify(d.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(d.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(d.Z.charts.toolbox)),visualMap:JSON.parse(JSON.stringify(d.Z.charts.visualMap)),dataZoom:JSON.parse(JSON.stringify(d.Z.charts.dataZoom)),xAxis3D:JSON.parse(JSON.stringify(d.Z.charts.xAxis3D)),yAxis3D:JSON.parse(JSON.stringify(d.Z.charts.yAxis3D)),zAxis3D:JSON.parse(JSON.stringify(d.Z.charts.zAxis3D))}}},methods:{filterPredefineColoursSchemeConfig(t,a){if(this.getNewConfig(t,a,this.filter_config),this.getNewConfig_charts_visualMap_inRange_color(t.visualMap,a.visualMap),a.color&&a.color instanceof Array&&a.color.length>0)if(t.color&&t.color instanceof Array&&t.color.length>0)for(let e=0;e<t.color.length;e++)t.color[e]=a.color[e];else t.color=JSON.parse(JSON.stringify(a.color))}}};var Z=i(49500);const C=i(29426);var P={props:["widgetInfo"],name:"bar-three-dimensional",components:{HideButton:D.Z},mixins:[S.u,I.H,N.P,L.P,b.P,J.u,$],data(){return{}},mounted(){this.echarts=C.init(this.$refs.barThreeDimensional,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{initAction(t){this.actionSendout(t),this.actionReceive(t)},loadInfo(t){let a=this.getData(t.dataset[t.dataset.type].encode,t.dataset[t.dataset.type].dimensionsAlias,t.dataset[t.dataset.type].source),e=JSON.parse(JSON.stringify(t.config.tooltip)),n=JSON.parse(JSON.stringify(t.config.xAxis3D));n.data=Array.from(new Set(a.xData));let s=JSON.parse(JSON.stringify(t.config.yAxis3D));s.data=Array.from(new Set(a.yData));let c=JSON.parse(JSON.stringify(t.config.zAxis3D));c.data=Array.from(new Set(a.zData));let o=JSON.parse(JSON.stringify(t.config.grid3D)),l=JSON.parse(JSON.stringify(t.config.series)),r=JSON.parse(JSON.stringify(t.config.visualMap));r.seriesIndex=r.show?0:-1;let w=JSON.parse(JSON.stringify(t.config.toolbox)),h=t.dataset[t.dataset.type].encode;t.config.visualMap.visualMapMin=="dataMin"&&(t.config.visualMap.min=this.getVisualmapData(t,h.z)[0]),t.config.visualMap.visualMapMax=="dataMax"&&(t.config.visualMap.max=this.getVisualmapData(t,h.z)[1]);let y={tooltip:e,xAxis3D:n,yAxis3D:s,zAxis3D:c,grid3D:o,toolbox:w,visualMap:this.getVisualMap(r),series:[{type:"bar3D",data:a.data.map(function(f){return{value:[f[0],f[1],f[2]]}}),shading:"lambert",label:this.getLabelStyle(l.label),itemStyle:l.itemStyle,emphasis:l.emphasis}]};this.echarts.setOption(this.lifecycleBeforeChartsLoad(y),{notMerge:!1})},reLoadInfo(t){t&&(this.$refs.barThreeDimensional.style.width=t.attr.w+"px",this.$refs.barThreeDimensional.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getData(t,a,e){let n,s,c,o={xData:[],yData:[],zData:[],data:[]};return this.$$lib__.each(a,(l,r)=>{t.x&&l.name==t.x&&(n=r),t.y&&l.name==t.y&&(s=r),t.z&&l.name==t.z&&(c=r)}),this.$$lib__.each(e,l=>{n>=0?o.xData.push(l[n]):o.xData.push(0),s>=0?o.yData.push(l[s]):o.xData.push(0),c>=0?o.zData.push(l[c]):o.xData.push(0);let r=[];n>=0?r.push(l[n]):r.push(0),s>=0?r.push(l[s]):r.push(0),c>=0?r.push(l[c]):r.push(0),o.data.push(r)}),o.data=this.changeSourceType(o.data,o.xData,o.yData,o.zData),o},changeSourceType(t,a,e,n){let s=Array.from(new Set(a)),c=Array.from(new Set(e)),o=Array.from(new Set(n)),l=this.widgetInfo.config.xAxis3D.type,r=this.widgetInfo.config.yAxis3D.type,w=this.widgetInfo.config.zAxis3D.type,h=JSON.parse(JSON.stringify(t));return this.$$lib__.each(t,(y,f)=>{l=="category"&&this.$$lib__.each(s,(u,m)=>{y[0]==u&&(h[f][0]=m)}),r=="category"&&this.$$lib__.each(c,(u,m)=>{y[1]==u&&(h[f][1]=m)}),w=="category"&&this.$$lib__.each(o,(u,m)=>{y[2]==u&&(h[f][2]=m)})}),h},actionSendout(t){let a=this;this.$$lib__.each(t.action.sendOut.actionList,e=>{if(e.enabled){let n=e.code+"_"+t.id;if(e.paramsExtend&&e.paramsExtend.length>0){let s={};this.getParamsExtend(s,e.paramsExtend,t)}e.code==M.Z.click.code&&a.onClick(n,e)}})},onClick(t,a){let e=this;e.echarts.on("click",n=>{let s={};s.x=n.data.value[0],s.y=n.data.value[1],s.z=n.data.value[2];let c=[];if(e.widgetInfo.dataset[e.widgetInfo.dataset.type].source&&e.widgetInfo.dataset[e.widgetInfo.dataset.type].source.length>0&&(c=e.widgetInfo.dataset[e.widgetInfo.dataset.type].source[n.dataIndex]),e.getExtendParams(s,a.paramsExtend,c,e.widgetInfo.dataset[e.widgetInfo.dataset.type].dimensions),a.script&&a.script.enabled){if(Z.log("Execute script for "+e.widgetInfo.name+" component to "+a.name+" component"),a.script.content==""){A.Message.warning({message:a.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",a.script.content),s=this.customScript_actionSend_clickParam(s,n)}p.Z.$emit(t,s),a.postMessage&&e.doPostMessage(s)})}}},E=P,T=i(68141),R=(0,T.Z)(E,v,g,!1,null,"cb78063a",null),B=R.exports}}]);
