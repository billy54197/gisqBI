"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[7921],{56279:function(w,y,r){r.d(y,{P:function(){return m}});var I=r(86892),u=r(49500);const m={mixins:[I.D],created(){},methods:{lifecycleBeforeChartsLoad(v){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&u.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let c=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[v]);if(c)return c}return v},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&u.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},5143:function(w,y,r){r.d(y,{b:function(){return v}});var I=r(48836),u=r(42160),m=r(49500);const v={created(){},computed:{...(0,I.Se)(["getWidgetAllArr"])},data(){return{containerViewSubWidgetList:[]}},methods:{...(0,I.nv)(["updateWidgetParentArrDataset","updateWidgetAllArrDataset"]),reLoadInfo(o){this.widgetInfo.id!=o.id&&this.$refs["comp_"+o.id]&&setTimeout(this.$refs["comp_"+o.id][0].reLoadInfo(o),500),this.loadInfo(o)},orgWidget(o){let c=[];return this.$$lib__.each(o,f=>{let s=this.$$lib__.find(this.getWidgetAllArr,g=>g.parentId==this.widgetInfo.id&&g.id==f.id);s&&(s.dataset&&s.dataset[s.dataset.type]&&(s.dataset.type==this.$$global_editor.dataSourcType.dynamic.code||s.dataset.type==this.$$global_editor.dataSourcType.local.code)&&s.dataset[s.dataset.type].autoUpdate==!0&&(u.default.set(this.dynamicWidgets,s.id,s),s.attr.hide!=!0&&s.dataset[s.dataset.type].autoUpdate==!0&&u.default.set(this.autoUpdateWidget,s.id,s)),c.push(s))}),u.default.set(this,"containerViewSubWidgetList",c),c},setTitleText(o,c){c?this.$$lib__.each(c,f=>{this.$$lib__.each(this.orgWidget(f.widgets),s=>{s.attr.widgetW||(s.attr.widgetW=s.attr.w),this.$refs["title_"+s.id]&&this.$refs["title_"+s.id][0]&&(this.$refs["title_"+s.id][0].innerHTML=this.initTextPosition(s)),s.title.position||(s.title.position="top")})}):this.$$lib__.each(this.orgWidget(o),f=>{this.$refs["title_"+f.id]&&this.$refs["title_"+f.id][0]&&(this.$refs["title_"+f.id][0].innerHTML=this.initTextPosition(f)),f.title.position||(f.title.position="top")})},initTextPosition(o){return o.title.text===void 0||!o.title.text?"":o.title.text&&(o.title.position==="left"||o.title.position==="right")?o.title.text.split("").join("<br />"):o.title.text},updataWidgetSource(o,c,f){try{switch(o.dataset.type){case this.$$global_editor.dataSourcType.dynamic.code:o.dataset.dynamic.source=c.data,c.total&&(o.dataset.dynamic.total=c.total);break;case this.$$global_editor.dataSourcType.local.code:o.dataset.local.dimensionsAlias=[],o.dataset.local.columnList=[],o.dataset.local.source=[],o.dataset.local.dimensions=[],o.dataset.local.dimensionsAlias=c.dimensionsAlias,o.dataset.local.columnList=c.columnList,o.dataset.local.source=c.source,o.dataset.local.dimensions=c.dimensions;break}}catch(g){m&&m.log&&m.log(g)}let s=this.$refs["comp_"+o.id];s&&s.length>0&&(this.updateWidgetAllArrDataset(o),this.updateWidgetParentArrDataset(o),s[0].reLoadInfo(o),this.sendoutDataloadSuccess(o),this.sendoutResponseData(o,c,f))},fit(o,c){if(!this.isView||!/^mobile/.test(this.getCanvasSetting.transformType))return o+"px";let f=this.getCanvasSetting.width/10,s=this.getCanvasSetting.height/window.innerHeight,g="";switch(this.getCanvasSetting.transformType){case"mobileAutoWidth":c?g=o+"px":g=o/f+"rem";break;case"mobileAutoBoth":g=o/f+"rem";break;default:c?g=o/s+"px":g=o/f+"rem"}return g}}}},80512:function(w,y,r){r.d(y,{Z:function(){return g}});var I=function(){var h=this,S=h._self._c;return S("div",{class:"container_child_"+h.widgetData.id,attrs:{id:"container_child_"+h.widgetData.id}},[S("keep-alive",[S(h.isView&&h.widgetData.isContainer?h.widgetData.typeName+"-view":h.widgetData.typeName,{ref:"com_"+h.widgetData.id,tag:"component",attrs:{"widget-info":h.widgetData,"widget-arr":h.getWidgetAllArr,"current-widget":h.currentWidget},on:{doGetPreviewData:h.doGetPreviewData,doReSetBoardId:h.doReSetBoardId,attrChange:h.attrChange}})],1)],1)},u=[],m=r(13229),v=r(48836),o={name:"DraggableComponent",extends:m.Z,computed:{...(0,v.Se)(["getWidgetAllArr","isView"])},methods:{reLoadInfo(l){if(l.id){let h=this.$refs["com_"+l.id];h&&h.reLoadInfo(l)}},doReSetBoardId(l){this.$emit("doReSetBoardId",l)},attrChange(l){this.$emit("attrChange",l)}}},c=o,f=r(68141),s=(0,f.Z)(c,I,u,!1,null,"41d16aa2",null),g=s.exports},44513:function(w,y,r){r.d(y,{Z:function(){return s}});var I=function(){var l=this,h=l._self._c;return l.attr.buttonHide?h("div",{style:{position:"absolute",right:l.attr.buttonHideRight+"px",top:l.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(S){return l.onHide()}}},[l.openTooltip?h("el-tooltip",{attrs:{"open-delay":1e3,content:l.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[h("el-button",{class:l.attr.buttonHideIconClass&&l.attr.buttonHideIconClass!=""?l.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:l.attr.buttonHideColor,fontSize:l.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):h("el-button",{class:l.attr.buttonHideIconClass&&l.attr.buttonHideIconClass!=""?l.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:l.attr.buttonHideColor,fontSize:l.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):l._e()},u=[],m=r(52246),v={props:["attr"],name:"hide-button",data(){return{isPc:m.b}},computed:{openTooltip:function(){let g=!1,l=this.attr.buttonHideTooltipContent;return m.b&&l&&l!=null&&l.trim()!=""&&(g=!0),g}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},o=v,c=r(68141),f=(0,c.Z)(o,I,u,!1,null,"bf399b9a",null),s=f.exports},27921:function(w,y,r){r.r(y),r.d(y,{default:function(){return E}});var I=function(){var t=this,a=t._self._c;return a("div",{staticClass:"my-div",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[a("hide-button",{attrs:{attr:t.widgetInfo.attr}}),a("el-tabs",{ref:"myTabs",staticClass:"my-tabs",attrs:{type:t.widgetInfo.config.tabsAttr.type,stretch:t.widgetInfo.config.tabsAttr.stretch,"tab-position":t.widgetInfo.config.tabsAttr.tabPosition},on:{"tab-click":t.handleClick},model:{value:t.active,callback:function(i){t.active=i},expression:"active"}},t._l(t.widgetInfo.config.tabPaneAttr,function(i,d){return a("el-tab-pane",{key:d,attrs:{name:i.id,disabled:i.disabled}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("div",{staticClass:"item-label",style:t.getTabPaneStyle(i,t.widgetInfo.config.tabsAttr)},[t._v(" "+t._s(i.label&&i.label!=""?i.label:"\xA0\xA0")+" ")])]),a("div",{staticClass:"my-screen",style:{height:(t.widgetInfo.config.tabsAttr.tabPosition=="right"||t.widgetInfo.config.tabsAttr.tabPosition=="left"?t.widgetInfo.attr.hh:t.widgetInfo.attr.hh-40)+"px"}},[t._l(t.orgWidget(i.widgets),function(n){return[a("div",{style:t.getWidgetStyle(n)},[a("div",{key:"widget_"+n.id,ref:"widget_"+n.id,refInFor:!0,class:t.getWidgetClass(n),style:t.getBindStyle(n),attrs:{id:"widget_"+n.id}},[a("external-frame-svg",{ref:"comp_frame_"+n.id,refInFor:!0,attrs:{"widget-info":n}}),n.title.position==="top"||n.title.position==="left"?a("div",{staticStyle:{overflow:"hidden",float:"left"},style:t.getWidgetTitleStyle(n),on:{click:function(x){return t.openLink(n)}}},[a("div",{style:{marginLeft:n.title.label.left+"px",marginTop:n.title.label.top+"px"}},[a("span",{ref:"title_"+n.id,refInFor:!0,style:t.getTitleSpanStyle(n)})])]):t._e(),a("draggable-component-container",{ref:"comp_"+n.id,refInFor:!0,staticStyle:{display:"inline-block",float:"left"},style:t.getInfoStyle(n),attrs:{"widget-data":n},on:{doGetPreviewData:t.getPreviewData,doReSetBoardId:t.doReSetBoardId,attrChange:t.attrChange}}),n.title.position==="bottom"||n.title.position==="right"?a("div",{staticStyle:{overflow:"hidden",float:"left"},style:t.getWidgetTitleStyle(n),on:{click:function(x){return t.openLink(n)}}},[a("div",{style:{marginLeft:n.title.label.left+"px",marginTop:n.title.label.top+"px"}},[a("span",{ref:"title_"+n.id,refInFor:!0,style:t.getTitleSpanStyle(n)})])]):t._e()],1)])]})],2)])}),1)],1)},u=[],m=r(80512),v=r(93575),o=r(5143),c=r(15577),f=r(44513),s=r(27966),g=r(55616),l=r(1783),h=r(45061),S=r(56279),C=r(49500),T={name:"ContainerTabsView",components:{ExternalFrameSvg:l.Z,DraggableComponentContainer:m.Z,HideButton:f.Z},mixins:[c.u,v.E,o.b,h.u,S.P],props:["widgetInfo"],data(){return{timer:null,active:null,activeIndex:-1,timerArr:[],dataSetArr:{},autoUpdateWidget:{},dynamicWidgets:{},prefix:{widget:"widget_"}}},watch:{"widgetInfo.attr.hide":{deep:!0,handler:function(){this.$emit("attrChange",this.widgetInfo)}}},mounted(){this.active=this.widgetInfo.config.tabsAttr.active,this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),this.$nextTick(()=>{this.setTitleText("widgets",this.widgetInfo.config.tabPaneAttr)})},created:function(){this.clear()},destroyed:function(){this.clear(),this.pauseTimer()},methods:{loadInfo(e){this.setStyle(e.config.tabsAttr),this.getDynamicWidgetsSource(this.dynamicWidgets),this.startTimer(),this.clickEvent=null,e.action&&e.action.sendOut&&e.action.sendOut.actionList&&(this.clickEvent=e.action.sendOut.actionList.find(t=>t.enabled&&t.code=="click"),this.clickEvent&&(this.clickEvent.actionName=this.clickEvent.code+"_"+this.widgetInfo.id)),this.lifecycleAfterLoad()},startTimer(){if(this.widgetInfo.config.tabsAttr.interval<=0||!this.widgetInfo.config.tabsAttr.autoplay||this.timer){this.pauseTimer();return}this.timer=setInterval(this.playSlides,this.widgetInfo.config.tabsAttr.interval*1e3)},initAction(e){this.actionReceive(e);let t=e.action.receive.changeTabPane;t&&t.enabled&&(t.initTrigger&&e.action.receive.changeTabPane.script.enabled&&new Function("globalParams","info","this_",e.action.receive.changeTabPane.script.content)(this.getCanvasSetting.data.globalParams,e,this),t.tabPaneList&&t.tabPaneList.length>0&&this.doActionChangeTabPane(t.tabPaneList,t.script,t.name,e))},doActionChangeTabPane(e,t,a,i){e&&e.length<1||this.$$lib__.each(e,d=>{if(d&&d.length<1)return;let n=d[0][1]+"_"+d[0][0];d[0][1].indexOf("_")>-1&&(n=d[0][1]),s.Z.$on(n,x=>{let p=d[0][2];if(p){let b=p.indexOf("|");b>-1&&(p=d[0][2].substring(b+1))}if(C.log(x),t&&t.enabled){if(C.log("Execute script for "+a+" component to changeTabPane component"),t.content==""){g.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.doChangeTabPane=new Function("data","param_key","info","this_",t.content)}this.doChangeTabPane(x,p,i,this)})})},doChangeTabPane(e,t,a){let i=Math.round(e[t]);i>-1&&a.config.tabPaneAttr.length>i&&(this.active=a.config.tabPaneAttr[i].id,setTimeout(()=>{this.setStyleIsActive(this.widgetInfo.config.tabsAttr.isActive,this.widgetInfo.config.tabsAttr.isInactivated,this.widgetInfo.config.tabsAttr.borderColor)},1)),C.log(i)},pauseTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},playSlides(){this.widgetInfo.config.tabsAttr.order=="desc"?this.activeIndex<1?this.activeIndex=this.widgetInfo.config.tabPaneAttr.length-1:this.activeIndex--:this.activeIndex<this.widgetInfo.config.tabPaneAttr.length-1?this.activeIndex++:this.activeIndex=0,this.widgetInfo.config.tabsAttr.active=this.widgetInfo.config.tabPaneAttr[this.activeIndex].id,this.active=this.widgetInfo.config.tabsAttr.active,setTimeout(()=>{this.setStyleIsActive(this.widgetInfo.config.tabsAttr.isActive,this.widgetInfo.config.tabsAttr.isInactivated,this.widgetInfo.config.tabsAttr.borderColor)},1)},setStyle(e){let t=this.$refs.myTabs,a=this.widgetInfo.config.tabsAttr.tabPosition!="bottom"?0:1,i=this.widgetInfo.config.tabsAttr.tabPosition!="bottom"?1:0;if(t){if(t&&t.$el.style&&(t.$el.style.borderColor=e.borderColor!=""&&e.borderColor!=null&&e.borderColor!=null?e.borderColor:"transparent",this.setHorizontalPosition(t)),t.$el.childNodes&&t.$el.childNodes.length>0&&(t.$el.childNodes[a].style.borderColor=e.borderColor!=""&&e.borderColor!=null&&e.borderColor!=null?e.borderColor:"transparent",this.setBackGround(t.$el.childNodes[a].style,e.navigation)),t.$el.childNodes&&t.$el.childNodes.length>1)for(let d=0;d<t.$el.childNodes[i].childNodes.length;d++)this.setBackGround(t.$el.childNodes[i].childNodes[d].style,e.content);setTimeout(()=>{this.setStyleIsActive(e.isActive,e.isInactivated,e.borderColor)},1)}},handleClick(e){let t=this.orgWidget(this.widgetInfo.config.tabPaneAttr[e.index].widgets),a=this;this.widgetInfo.config.tabsAttr.reload&&t.forEach(i=>{i.id&&a.$refs["comp_"+i.id][0].reLoadInfo(i)}),setTimeout(()=>{this.setStyleIsActive(this.widgetInfo.config.tabsAttr.isActive,this.widgetInfo.config.tabsAttr.isInactivated,this.widgetInfo.config.tabsAttr.borderColor)},1);for(let i=0;i<this.widgetInfo.config.tabPaneAttr.length;i++)if(this.widgetInfo.config.tabsAttr.active==this.widgetInfo.config.tabPaneAttr[i].id){this.activeIndex=i;break}if(this.clickEvent){let i=this.widgetInfo.config.tabPaneAttr[e.index],d={index:e.index-0,label:i.label,id:i.id};if(this.clickEvent.paramsExtend&&this.clickEvent.paramsExtend.length>0&&this.getExtendParams(d,this.clickEvent.paramsExtend,[],[]),this.clickEvent.script&&this.clickEvent.script.enabled&&this.clickEvent.script.content){C.log("Execute script for "+this.widgetInfo.name+" component to "+this.clickEvent.name+" component");try{this.clickEvent.script.func=this.clickEvent.script.func||new Function("param",this.clickEvent.script.content),this.clickEvent.script.func(d)}catch(n){C.log(n)}}this.$event.$emit(this.clickEvent.actionName,d),this.clickEvent.postMessage&&this.doPostMessage(d)}},setStyleIsActive(e,t,a){let i=this.$refs.myTabs,d=this.widgetInfo.config.tabsAttr.tabPosition!="bottom"?0:1,n=i.$el.childNodes[d].childNodes[0].childNodes;if(i.$el.childNodes&&i.$el.childNodes.length>0&&i.$el.childNodes[d].childNodes&&i.$el.childNodes[d].childNodes.length>0&&n&&n.length>0&&n[n.length-1].childNodes&&n[n.length-1].childNodes.length>0&&n[n.length-1].childNodes[0].childNodes&&n[n.length-1].childNodes[0].childNodes.length>0){let x=i.$el.childNodes[d].childNodes[0].childNodes,p=x[x.length-1].childNodes[0];p.style.borderColor=a!=""&&a!=null&&a!=null?a:"transparent";for(let b=0;b<p.childNodes.length;b++)p.childNodes[b].className.indexOf("is-active")>-1?this.setBackGround(p.childNodes[b].style,e):this.setBackGround(p.childNodes[b].style,t),p.childNodes[b].style.borderColor=a!=""&&a!=null&&a!=null?a:"transparent"}this.setHorizontalPosition(i)},setBackGround(e,t){e.padding=0,t.backgroundColor&&t.backgroundColor!=""?e.backgroundColor=t.backgroundColor:e.backgroundColor="transparent",t.backgroundImage&&t.backgroundImage!=""?e.backgroundImage=this.getImageUrl(t.backgroundImage):e.backgroundImage="none",t.backgroundSize&&t.backgroundSize!=""?e.backgroundSize=t.backgroundSize:e.backgroundSize="auto"},getActiveName(e){let t=null;return e.config.tabsAttr.active?t=e.config.tabsAttr.active:e.config.tabPaneAttr.length>0&&(t=e.config.tabPaneAttr[0].id),t},getTabPaneStyle(e,t){let a={},i={};return e.id!=this.active?(a=t.inactivatedStyle.fontStyle,t.initialColor&&t.initialColor!=""&&(i.color=t.initialColor),t.inactivatedStyle.width&&(t.stretch?i.width="auto":i.width=t.inactivatedStyle.width+"px"),t.inactivatedStyle.height&&(i.height=t.inactivatedStyle.height+"px",i.lineHeight=t.inactivatedStyle.height+"px")):(a=t.activeStyle.fontStyle,t.activeColor&&t.activeColor!=""&&(i.color=t.activeColor),t.inactivatedStyle.width&&(t.stretch?i.width="auto":i.width=t.activeStyle.width+"px"),t.inactivatedStyle.height&&(i.height=t.activeStyle.height+"px",i.lineHeight=t.activeStyle.height+"px")),i.textAlign=a.horizontalAlignment,i.fontSize=a.fontSize+"px",i.fontWeight=a.fontWeight,i.fontFamily=a.fontFamily,i.fontStyle=a.fontStyle,i.textDecoration=a.textDecoration,t.tabPosition=="top"||t.tabPosition=="bottom"?t.height&&(i.height=t.height+"px",i.lineHeight=t.height+"px"):t.width&&(i.width=t.width+"px"),i},doReSetBoardId(e){this.$emit("doReSetBoardId",e)},setHorizontalPosition(e){let t=JSON.parse(JSON.stringify(this.widgetInfo.config.tabsAttr));this.$nextTick(function(){if((t.tabPosition=="top"||t.tabPosition=="bottom")&&e.$el.getElementsByClassName("el-tabs__nav").length>0){let n=e.$el.getElementsByClassName("el-tabs__nav")[0],x=this.widgetInfo.attr.w/2,p=n.scrollWidth,b=p/2,_=t.tabHorizontalPosition,$=x-b,P=this.widgetInfo.attr.w-p;t.stretch==!0?n.style.marginLeft="0px":(_=="left"&&(n.style.marginLeft="0px"),$>0&&_=="center"&&(n.style.marginLeft=$+"px"),P>0&&_=="right"&&(n.style.marginLeft=P+"px"))}if(t.tabPosition=="bottom"&&e.$el.getElementsByClassName("el-tabs__header").length>0){let n=e.$el.getElementsByClassName("el-tabs__header")[0];n.style.position="relative",n.style.bottom=t.height-40+"px"}let a=e.$el.getElementsByClassName("el-tabs__item"),i=e.$el.getElementsByClassName("item-label"),d=40;(t.tabPosition=="left"||t.tabPosition=="right")&&(t.stretch==!0&&a.length>0?d=this.widgetInfo.attr.hh/a.length:d=t.height),(t.tabPosition=="top"||t.tabPosition=="bottom")&&(d=t.height);for(let n=0;n<a.length;n++)i[n].style.height=d+"px",i[n].style.lineHeight=d+"px"})}}},N=T,A=r(68141),L=(0,A.Z)(N,I,u,!1,null,"2f034f86",null),E=L.exports}}]);
