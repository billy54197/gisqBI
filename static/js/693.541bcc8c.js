"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[693],{56279:function(w,S,s){s.d(S,{P:function(){return A}});var C=s(86892),I=s(49500);const A={mixins:[C.D],created(){},methods:{lifecycleBeforeChartsLoad(v){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&I.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),I.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let L=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[v]);if(L)return L}return v},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&I.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),I.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},10693:function(w,S,s){s.r(S),s.d(S,{default:function(){return K}});var C=function(){var u=this,d=u._self._c;return d("div",{style:{width:u.widgetInfo.attr.w+"px",height:u.widgetInfo.attr.hh+"px"}},[d("hide-button",{attrs:{attr:u.widgetInfo.attr}}),d("div",{ref:"pieDoughnut",style:{width:u.widgetInfo.attr.w+"px",height:u.widgetInfo.attr.hh+"px"}})],1)},I=[],A=s(44513),v=s(27966),P=s(56279),L=s(45061),F=s(26711),E=s(75770),T=s(43674),$=s(67157),O=s(50666);const D={mixins:[$.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(O.Z.charts.title)),legend:JSON.parse(JSON.stringify(O.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(O.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(O.Z.charts.toolbox))}}},methods:{filterPredefineColoursSchemeConfig(n,u){this.getNewConfigWithArrary(n,u,this.filter_config),this.getNewDoughnutConfigSeries(n.series,u.series)},getNewDoughnutConfigSeries(n,u){let d=0;for(let g in n){let y=n[g],m={};if(d>u.length-1&&(d=0),m=u[d],y.color&&y.color instanceof Array&&m.color&&m.color instanceof Array){let x=0;for(let B in y.color)x>m.color.length-1&&(x=0),y.color[B]=m.color[x],x++}d++}}}};var M=s(99349),U=s(87798),J=s(55616),Z=s(29426),R=s(42160),N=s(49500),z={name:"PieDoughnutMulti",components:{HideButton:A.Z},mixins:[T.u,D,P.P,L.u,F.H,M.P,U.P],props:["widgetInfo"],setup(){const{proxy:n}=(0,R.getCurrentInstance)();let u=Z,d=[],g=null;(0,R.watch)(()=>n.widgetInfo.attr.hide,(t,e)=>{n.$emit("attrChange",n.widgetInfo)}),(0,R.onMounted)(()=>{g=u.init(n.$refs.pieDoughnut,null,{devicePixelRatio:2}),W(n.widgetInfo),y(n.widgetInfo)}),(0,R.onUnmounted)(()=>{if(u.dispose(),d.length>0){for(let t in d)clearInterval(d[t]);d=[]}});const y=t=>{let e=JSON.parse(JSON.stringify(t)),o=B(e),r=X(e),i=e.config.toolbox,f=n.getTooltip(e.config.tooltip),l=n.getLegend(t.config.legend),a={title:o,tooltip:f,toolbox:i,legend:l,series:r};n.getAnimation(a,t),m(a,t,r),n.setAnimationLoop(t,()=>{m(a,t)})},m=(t,e)=>{if(g.getOption()&&g.clear(),setTimeout(()=>{g.setOption(n.lifecycleBeforeChartsLoad(t),{notMerge:!0})},0),d.length>0){for(let r in d)clearInterval(d[r]);d=[]}let o=e.config.series;for(let r in o)if(o[r].auto==!0){let i=5;o[r].showTime&&(i=o[r].showTime),i=i*1e3;let f=0,l=t.series[r].data.length,a=setInterval(function(){g.dispatchAction({type:"downplay",seriesIndex:r,dataIndex:f}),f=(f+1)%l,g.dispatchAction({type:"highlight",seriesIndex:r,dataIndex:f})},i);d.push(a)}},x=t=>{t&&(n.$refs.pieDoughnut.style.width=t.attr.w+"px",n.$refs.pieDoughnut.style.height=t.attr.hh+"px"),y(t),g.resize()},B=t=>({show:t.config.title.show,text:t.config.title.text,subtext:t.config.title.subtext,link:t.config.title.link,textAlign:t.config.title.textAlign,left:t.config.title.left+"%",right:t.config.title.right+"%",top:t.config.title.top+"%",bottom:t.config.title.bottom+"%",label:{fontSize:t.config.title.label.fontSize,fontFamily:t.config.title.label.fontFamily,color:t.config.title.label.color},textStyle:{fontSize:t.config.title.textStyle.fontSize,fontFamily:t.config.title.textStyle.fontFamily,color:t.config.title.textStyle.color},subtextStyle:{fontSize:t.config.title.subtextStyle.fontSize,fontFamily:t.config.title.subtextStyle.fontFamily,color:t.config.title.subtextStyle.color}}),X=t=>{let e=JSON.parse(JSON.stringify(t.config.series));if(e)for(let o in e){let r=e[o].center[t.config.layout][0],i=e[o].center[t.config.layout][1],f=e[o].radius[t.config.layout][0],l=e[o].radius[t.config.layout][1];if(e[o].center=[r+"%",i+"%"],e[o].radius=[f,l],e[o].name=Y(o,t),e[o].data=k(o,t),e[o].label.formatter=n.getFormatterString(e[o].label.formatter),e[o].label.show=G(e[o].label)&&e[o].label.show,e[o].label.emphasis.textStyle={},e[o].label.emphasis.textStyle.fontWeight="bold",e[o].color&&e[o].data)if(e[o].colorCustom==!1){e[o].color=[];for(let a in e[o].data)e[o].color.push(n.$$global_editor.predefineColors[a])}else{let a=e[o].data.length-e[o].color.length,c=[];if(a>0){c=JSON.parse(JSON.stringify(e[o].color));let h="rgba(0, 0, 0, 0)";for(let p=0;p<a;p++)c.push(h);e[o].color=JSON.parse(JSON.stringify(c))}else if(a<0){for(let h in e[o].data)c.push(e[o].color[h]);e[o].color=JSON.parse(JSON.stringify(c))}}if(e[o].itemStyle.borderRadius=Q(e[o].itemStyle),e[o].emphasis)try{let a=e[o].emphasis;if(a.script&&a.script.enabled){if(a.script.content){let c=new Function("index","item","data",a.script.content),h=e[o].data;if(h&&h.length>0)for(let p=0;p<h.length;++p)try{h[p].emphasis=c.call(this,p,h[p],h)}catch(tt){N.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",tt)}}}else e[o].emphasis.itemStyle&&e[o].emphasis.itemStyle.color&&(e[o].emphasis={itemStyle:{...e.emphasis.itemStyle}})}catch(a){N.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",a)}}else e=[];return e},Y=(t,e)=>{let o="",r=e.dataset[e.dataset.type].encode,i=e.dataset[e.dataset.type].dimensionsAlias;if(r&&i)for(let f in i)r[t].value==i[f].name&&(o=i[f].alias?i[f].alias:i[f].name);return o},k=(t,e)=>{let o=[],r=e.dataset[e.dataset.type].encode,i=e.dataset[e.dataset.type].dimensionsAlias,f=-1,l=-1;if(r&&i)for(let c in i)r[t].name==i[c].name&&(f=c),r[t].value==i[c].name&&(l=c);let a=e.dataset[e.dataset.type].source;if(a)for(let c in a){let h={};for(let p in a[c])f==p&&(h.name=a[c][p]),l==p&&(h.value=a[c][p]);o.push(h)}return o},G=t=>t.position!=="center",Q=t=>{let e;return t.borderRadiusType=="one"?e=b(t.barBorderRadiusInfo[0],t.barBorderRadiusInfoUnit[0]):t.borderRadiusType=="tow"?e=[b(t.barBorderRadiusInfo[0],t.barBorderRadiusInfoUnit[0]),b(t.barBorderRadiusInfo[1],t.barBorderRadiusInfoUnit[1])]:t.borderRadiusType=="four"&&(e=[b(t.barBorderRadiusInfo[0],t.barBorderRadiusInfoUnit[0]),b(t.barBorderRadiusInfo[1],t.barBorderRadiusInfoUnit[1]),b(t.barBorderRadiusInfo[2],t.barBorderRadiusInfoUnit[2]),b(t.barBorderRadiusInfo[3],t.barBorderRadiusInfoUnit[3])]),e},b=(t,e)=>(!t||t==""?0:t)+(e=="%"?"%":""),W=t=>{q(t),n.actionReceive(t)},q=t=>{g.on("click",e=>{e.componentType=="graphic"||e.componentType=="series"&&_(t,e)})},_=(t,e)=>{let o=[],r=t.action.sendOut.actionList;n.$$lib__.each(r,i=>{let f=i.code+"_"+t.id,l={};i.paramsExtend&&i.paramsExtend.length>0&&n.getParamsExtend(l,i.paramsExtend,t);let a=i.postMessage;if(l.name=e.data.name,l.value=e.data.value,i.enabled&&i.code==E.Z.click.code){if(t.dataset[t.dataset.type].source&&t.dataset[t.dataset.type].source.length>0&&(o=t.dataset[t.dataset.type].source[e.dataIndex]),n.getExtendParams(l,i.paramsExtend,o,t.dataset[t.dataset.type].dimensions),i.script&&i.script.enabled){if(N.log("Execute script for "+t.name+" component to "+t.name+" component"),i.script.content==""){J.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}n.customScript_actionSend_clickParam=new Function("param,params",i.script.content),l=n.customScript_actionSend_clickParam(l,e)}v.Z.$emit(f,l),a&&n.doPostMessage(l)}else if(i.enabled&&i.code==E.Z.openLink.code){if(i.paramsExtend&&i.paramsExtend.length>0){let c=[];t.dataset[t.dataset.type].source&&t.dataset[t.dataset.type].source.length>0&&(c=t.dataset[t.dataset.type].source[e.dataIndex]),i.type===n.$$global_editor.linkType.dynamic.code&&(i[n.$$global_editor.linkType.dynamic.code].url=n.getActionUrl(i,t.dataset[t.dataset.type].source[e.dataIndex],t.dataset[t.dataset.type].dimensions)),n.getExtendParams(l,i.paramsExtend,c,t.dataset[t.dataset.type].dimensions)}if(i.script&&i.script.enabled){if(N.log("Execute script for "+i.name+" component to "+t.name+" component"),i.script.content==""){J.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}n.customScript_actionSend_clickParam=new Function("param,params",i.script.content),l=n.customScript_actionSend_clickParam(l,e)}n.openLinkAction(i,l,e)}})};return{reLoadInfo:x,getAttribute:t=>n.getAttribute(t)}}},j=z,V=s(68141),H=(0,V.Z)(j,C,I,!1,null,"342b2d62",null),K=H.exports}}]);
