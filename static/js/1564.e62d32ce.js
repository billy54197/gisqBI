"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[1564],{98521:function(H,A,n){var C=n(75770),S=n(27966),D=n(55616),I=n.n(D),E=n(49500);A.Z={autoShow(b,L,v){let r=b;if(r.innerAutoShowInterval&&r.innerAutoShowInterval>-1&&(clearInterval(r.innerAutoShowInterval),r.innerAutoShowInterval=-1,L.dispatchAction({type:"downplay",dataIndex:r.innerAutoShowIndex}),r.innerAutoShowIndex=0),!(b&&L&&v&&v.enabled&&v.interval>0))return;let R=v.showTip;typeof r.innerAutoShowIndex>"u"&&(r.innerAutoShowIndex=0),r.innerAutoShowInterval=setInterval(function(){let h=L.getOption(),w=0,g=0;h.series[w].data?g=h.series[w].data.length:h.dataset&&h.dataset.length>0&&(g=h.dataset[0].source.length),g!=0&&(L.dispatchAction({type:"downplay",dataIndex:r.innerAutoShowIndex}),r.innerAutoShowIndex=(r.innerAutoShowIndex+1)%g,L.dispatchAction({type:"highlight",dataIndex:r.innerAutoShowIndex}),R&&L.dispatchAction({type:"showTip",seriesIndex:w,dataIndex:r.innerAutoShowIndex}),V(r,r.innerAutoShowIndex,w,h))},v.interval*1e3);function V(h,w,g,F){let l=h.widgetInfo;h.$$lib__.each(l.action.sendOut.actionList,f=>{if(f.enabled&&f.code==C.Z.autoHighLight.code){let N=l.dataset[l.dataset.type].dimensions,G=f.code+"_"+l.id,x={},O=[];if(l.dataset[l.dataset.type].source&&l.dataset[l.dataset.type].source.length>0&&(O=l.dataset[l.dataset.type].source[w]),x.x=h.getFieldVal(O,N,F.series[g].encode.x),x.y=h.getFieldVal(O,N,F.series[g].encode.y),h.getExtendParams(x,f.paramsExtend,O,N),f.script&&f.script.enabled){if(E.log("Execute script for "+l.name+" component to "+f.name+" component"),f.script.content==""){D.Message.warning({message:f.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}try{x=new Function("param,autoShowIndex,seriesIndex, opts",f.script.content).apply(h,[x,w,g,F])}catch(T){E.error(T)}}S.Z.$emit(G,x),f.postMessage&&h.doPostMessage(x)}})}}}},56279:function(H,A,n){n.d(A,{P:function(){return D}});var C=n(86892),S=n(49500);const D={mixins:[C.D],created(){},methods:{lifecycleBeforeChartsLoad(I){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&S.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),S.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let b=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[I]);if(b)return b}return I},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&S.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),S.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},1564:function(H,A,n){n.r(A),n.d(A,{default:function(){return T}});var C=function(){var e=this,s=e._self._c;return s("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[s("hide-button",{attrs:{attr:e.widgetInfo.attr}}),s("div",{ref:"lineAreaStack",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},S=[],D=n(44513),I=n(27966),E=n(56279),b=n(45061),L=n(26711),v=n(97490),r=n(99349),R=n(98521),V=n(55616),h=n(75770),w=n(67157),g=n(50666);const F={mixins:[w.c],data(){return{config_extend:{config:{series:[{itemStyle:{color:"#222227"}},{itemStyle:{color:"#29CC97"}}]}},filter_config:{title:JSON.parse(JSON.stringify(g.Z.charts.title)),legend:JSON.parse(JSON.stringify(g.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(g.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(g.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(g.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(g.Z.charts.yAxis)),series:[{areaStyle:{colorInfo:{type:"pureColor",pureColor:"rgba(41, 204, 151, 0.2)",gradation:{top:"rgba(146, 203, 255, 1)",bottom:"rgba(20, 122, 217, 1)"}},opacity:1},itemStyle:{opacity:1,color:"#29CC97"}}]}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var l=n(49500);const f=n(29426);var N={name:"LineAreaStack",components:{HideButton:D.Z},mixins:[v.u,E.P,b.u,L.H,r.P,F],props:["widgetInfo"],data(){return{dimensionsAliasEx:null,innerAutoShowIndex:0}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=f.init(this.$refs.lineAreaStack,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),this.initClick(this.widgetInfo)},destroyed(){this.echarts.dispose(),this.clearAutoCarousel()},methods:{loadInfo(t){t.dataset[t.dataset.type]&&(this.source=t.dataset[t.dataset.type].source,this.dimensionsEx=t.dataset[t.dataset.type].dimensions),t.config.drillDown&&t.config.drillDown.enable==!0?(this.drillDown=JSON.parse(JSON.stringify(t.config.drillDown)),delete this.drillDown.graphic,this.drillDown.pid_arrary=[],this.doDrillDown(t,!0)):this.beforeRenderEcharts(t,this.source)},renderEcharts(t,e){let s=[],o=[],c=[];t.dataset[t.dataset.type]&&(s=t.dataset[t.dataset.type].dimensions,o=t.dataset[t.dataset.type].dimensionsAlias,c=t.dataset[t.dataset.type].encode),this.dimensionsAliasEx=o;let i=JSON.parse(JSON.stringify(t.config.series)),z=this.getTooltip(t.config.tooltip),M=JSON.parse(JSON.stringify(t.config.toolbox)),m=JSON.parse(JSON.stringify(t.config.legend)),y=JSON.parse(JSON.stringify(t.config.title)),Z=JSON.parse(JSON.stringify(t.config.grid)),d=JSON.parse(JSON.stringify(t.config.xAxis)),p=JSON.parse(JSON.stringify(t.config.yAxis)),W=[];if(t.config.drillDown&&t.config.drillDown.enable==!0){let a=this.getGraphic(t.config.drillDown.graphic);a&&a.elements&&a.elements.length>0&&(a.elements[0].ignore=this.drillDown.pid_arrary.length<1),W.push(a)}for(let a=0;a<i.length;a++){i[a].dimensions=s,i[a].type="line",i[a].lineWidth&&(i[a].lineWidth=i[a].lineWidth+"%"),i[a].encode.x=c.x,i[a].encode.y=c.y[a],i[a].name=this.getLegendData(o,i[a].encode.y),i[a].areaStyle.colorInfo.type&&(i[a].areaStyle.color=this.getItemStyleColor(i[a].areaStyle.colorInfo));let J={},B=[],K=[];for(let u=i[a].dimensions.length-1;u>-1;--u)J[s[u]]=u;for(let u=0;u<e.length;++u){let P=e[u],_={};for(let $ in J)_[$]=P[J[$]]||"";B.push({value:P[J[c.y[a]]]||"",row:_}),K.push(P[J[c.x]]||"")}if(i[a].data=B,d.data=K,i[a].emphasis)try{if(i[a].emphasis.script&&i[a].emphasis.script.enabled){if(i[a].emphasis.script.content)try{let u=this,P=new Function("index","item","data",i[a].emphasis.script.content);i[a].data.forEach((_,$)=>{let U=P.call(u,$,_,B);i[a].data[$]={value:_,emphasis:U}})}catch(u){l.error("\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u811A\u672C\u62A5\u9519\uFF1A",u)}}else i[a].emphasis.itemStyle&&i[a].emphasis.itemStyle.color&&(i[a].emphasis={itemStyle:{...i[a].emphasis.itemStyle}})}catch(u){l.error("\u5904\u7406\u9AD8\u4EAE\u6837\u5F0F\u62A5\u9519\uFF1A",u)}}let k={color:this.$$global_editor.predefineColors,tooltip:z,toolbox:M,title:{show:y.show,text:y.text,link:y.link,textAlign:y.textAlign,left:y.left+"%",right:y.right+"%",top:y.top+"%",bottom:y.bottom+"%",textStyle:{fontSize:y.textStyle.fontSize,fontFamily:y.textStyle.fontFamily,color:y.textStyle.color}},legend:{show:m.show,type:m.type,itemWidth:m.itemWidth,itemHeight:m.itemHeight,icon:m.icon,orient:m.orient,align:m.align,itemGap:m.itemGap,left:m.left+"%",right:m.right+"%",top:m.top+"%",bottom:m.bottom+"%",textStyle:{fontSize:m.textStyle.fontSize,fontFamily:m.textStyle.fontFamily,color:m.textStyle.color}},graphic:W,grid:{left:Z.left+"%",right:Z.right+"%",top:Z.top+"%",bottom:Z.bottom+"%"},xAxis:[{type:"category",show:d.show,name:d.name,data:d.data,nameLocation:d.nameLocation,nameGap:d.nameGap,boundaryGap:d.boundaryGap,axisLine:{show:d.axisLine.show,lineStyle:{color:d.axisLine.lineStyle.color}},axisTick:{show:d.axisTick.show},axisLabel:{interval:d.axisLabel.interval,show:d.axisLabel.show,rotate:d.axisLabel.rotate,margin:d.axisLabel.margin,fontSize:d.axisLabel.fontSize,fontFamily:d.axisLabel.fontFamily,color:d.axisLabel.color},splitLine:d.splitLine}],yAxis:[{type:"value",scale:!1,min:p.min,max:p.max,show:p.show,name:p.name,nameLocation:p.nameLocation,nameGap:p.nameGap,axisLine:{show:p.axisLine.show,lineStyle:{color:p.axisLine.lineStyle.color}},axisTick:{show:p.axisTick.show},axisLabel:{show:p.axisLabel.show,rotate:p.axisLabel.rotate,margin:p.axisLabel.margin,fontSize:p.axisLabel.fontSize,fontFamily:p.axisLabel.fontFamily,color:p.axisLabel.color},splitLine:p.splitLine}],dataset:{source:e,sourceHeader:!1},series:i};this.getAnimation(k,t),this.setOption(k,t),this.setAnimationLoop(t,()=>{this.setOption(k,t)})},setOption(t,e){this.echarts.getOption()&&this.echarts.clear(),setTimeout(()=>{this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0}),R.Z.autoShow(this,this.echarts,e.config.autoShow)},0)},reLoadInfo(t){this.mergeConfig(t),t&&(this.$refs.lineAreaStack.style.width=t.attr.w+"px",this.$refs.lineAreaStack.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,e){let s=this.$$lib__.find(t,o=>o.name==e);return s?s.alias&&s.alias!=""?s.alias:s.name:""},getEmphasisStyle(t){let e=null;return t.pureColor&&(e=t.pureColor),e},getItemStyleColor(t){let e=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?e=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&t.position=="levelDec"?e=new f.graphic.LinearGradient(1,0,0,0,[{offset:1,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:0,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}]):t.type==this.$$global_editor.colorType.gradation.code&&t.position!="levelDec"&&(e=new f.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),e},initAction(t){this.actionReceive(t)},doDrillDown(t,e){let s=[];if(this.drillDown.pidValue&&this.drillDown.id&&this.drillDown.pid){let o={};for(let c=this.dimensionsEx.length-1;c>-1;--c)o[this.dimensionsEx[c]]=c;for(let c=0;c<this.source.length;++c){let i=this.source[c];i[o[this.drillDown.pid]]==this.drillDown.pidValue&&s.push(JSON.parse(JSON.stringify(i)))}}else l.error("\u5FC5\u987B\u914D\u7F6E\u4E0B\u94BB\u7684\u3010\u4E0A\u7EA7\u6570\u503C\u3001\u6570\u636E\u5B57\u6BB5\u3001\u4E0A\u7EA7\u5B57\u6BB5\u3011");if(s.length>0)this.beforeRenderEcharts(t,s);else{let o=this.drillDown.pid_arrary.length-1;this.drillDown.pid_arrary.length=o>0?o:0,l.info("\u4E0B\u94BB\u5DF2\u65E0\u6570\u636E"),e&&this.renderEcharts(t,s)}},initClick(t){this.echarts.on("click",e=>{if(e.componentType=="graphic"){if(this.drillDown&&this.drillDown.enable==!0){let s=this.drillDown.pid_arrary.length;s>0?(this.drillDown.pidValue=this.drillDown.pid_arrary[s-1],this.drillDown.pid_arrary.length=s-1,this.drillDown.pidValue?this.doDrillDown(t):l.error("\u4E0B\u94BB\u5B57\u6BB5\u672A\u83B7\u53D6\u5230\u6709\u6548\u503C")):l.error("\u5DF2\u7ECF\u662F\u6700\u9876\u7EA7\uFF0C\u4E0D\u53EF\u4EE5\u518D\u8FD4\u56DE")}}else e.componentType=="series"&&(this.actionOnClick(t,e),this.drillDown&&this.drillDown.enable==!0&&(this.drillDown.pid_arrary.length==0?this.drillDown.pid_arrary.push(t.config.drillDown.pidValue):this.$$lib__.contains(this.drillDown.pid_arrary,this.drillDown.pidValue)||this.drillDown.pid_arrary.push(this.drillDown.pidValue),this.drillDown.pidValue=e.data.row[this.drillDown.id],this.drillDown.pidValue?this.doDrillDown(t):l.error("\u4E0B\u94BB\u5B57\u6BB5\u672A\u83B7\u53D6\u5230\u6709\u6548\u503C")))})},actionOnClick(t,e){let s=this;this.$$lib__.each(t.action.sendOut.actionList,o=>{if(o.enabled){let c=o.code+"_"+t.id;if(o.paramsExtend&&o.paramsExtend.length>0){let i={};this.getParamsExtend(i,o.paramsExtend,t)}if(o.code==h.Z.click.code){t.config.autoShow&&t.config.autoShow.enabled&&t.config.autoShow.interval>0&&(this.echarts.dispatchAction({type:"downplay",dataIndex:this.innerAutoShowIndex}),this.innerAutoShowIndex=e.dataIndex);let i={},z=s.getValue(e.seriesName,e.data.value);i.x=e.name||e.value,i.y=z;let M=[];if(t.dataset[t.dataset.type].source&&t.dataset[t.dataset.type].source.length>0&&(M=t.dataset[t.dataset.type].source[e.dataIndex]),s.getExtendParams(i,o.paramsExtend,M,t.dataset[t.dataset.type].dimensions),o.script&&o.script.enabled){if(l.log("Execute script for "+t.name+" component to "+o.name+" component"),o.script.content==""){V.Message.warning({message:o.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",o.script.content),i=this.customScript_actionSend_clickParam(i,e)}I.Z.$emit(c,i),o.postMessage&&s.doPostMessage(i)}}})},beforeRenderEcharts(t,e){this.clearAutoCarousel(),t.config.autoCarousel.enable==!0?this.setAutoCarousel(t,e):this.renderEcharts(t,e)}}},G=N,x=n(68141),O=(0,x.Z)(G,C,S,!1,null,"4687abef",null),T=O.exports}}]);
