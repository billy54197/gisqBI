"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[93921],{593921:function(p,n,i){i.r(n),i.d(n,{default:function(){return f}});var s=function(){var e=this,a=e._self._c;return a("div",[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"70px","label-position":"right",model:e.currentWidget.dataset},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"\u4E13\u9898\u7C7B\u578B"}},[a("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u4E13\u9898\u56FE\u7C7B\u578B"},on:{change:e.thematicMapTypeChange},model:{value:e.currentWidget.config.thematicMapType,callback:function(t){e.$set(e.currentWidget.config,"thematicMapType",t)},expression:"currentWidget.config.thematicMapType"}},e._l(e.$$global_editor.thematicMapTypeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),a("el-form-item",{attrs:{label:"\u9009\u62E9\u5E95\u56FE"}},[a("layer-directory-single",{attrs:{"layer-id":e.currentWidget.config.baseLayer},on:{"on-layer-change":e.onLayerChangeBase}})],1),a("el-form-item",{attrs:{label:"\u9009\u62E9\u56FE\u5C42"}},[a("layer-directory-single",{attrs:{"layer-id":e.currentWidget.config.layerTag},on:{"on-layer-change":e.onLayerChangeTag}})],1),e.currentWidget.config.thematicMapType?a("div",[a("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[a("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B"},on:{change:e.changeDatasetType},model:{value:e.currentWidget.dataset.type,callback:function(t){e.$set(e.currentWidget.dataset,"type",t)},expression:"currentWidget.dataset.type"}},e._l(e.$$global_editor.dataSourcTypeList3,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),a("div",[a("el-form-item",{attrs:{label:"\u884C\u653F\u533A"}},[a("el-select",{ref:"encodeX",attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u884C\u653F\u533A\u5B57\u6BB5"},on:{change:e.getConfigData},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.x,callback:function(t){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"x",t)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.x"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(t){return a("el-option",{key:t.name,attrs:{label:t.alias!=""?t.alias:t.name,value:t.name}})}),1)],1),a("el-form-item",{attrs:{label:"\u7EDF\u8BA1\u5B57\u6BB5"}},[a("el-select",{ref:"encodeY",attrs:{size:"mini",multiple:!0,"multiple-limit":e.KeyLengthLimit,placeholder:"\u8BF7\u9009\u62E9\u7EDF\u8BA1\u5B57\u6BB5"},on:{change:e.changeDimensionsAlias},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.y,callback:function(t){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"y",t)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.y"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(t){return a("el-option",{key:t.name,attrs:{label:t.alias!=""?t.alias:t.name,value:t.name}})}),1)],1)],1),a("setting-dataset",{ref:"settingDataset",attrs:{"current-widget":e.currentWidget},on:{getDataSetData:e.getConfigData,clearDynamicEncode:e.clearDynamicEncode}})],1):e._e()],1)],1)},l=[],c=i(589908),d=i(723400),o=i(588406),g={name:"GisBaseData",components:{LayerDirectorySingle:o.Z,SettingDataset:c.Z},mixins:[d.j],props:["currentWidget"],data(){return{layerInfo:{baseLayer:{},layerTag:{}}}},computed:{KeyLengthLimit(){return this.currentWidget.config.thematicMapType=="bubble"?2:1}},mounted(){this.mapLayerPop()},created(){this.currentWidget.config.thematicMapType="bubble"},methods:{thematicMapTypeChange(){this.getConfigData()},changeDatasetType(){this.$refs.settingDataset.loadPreview(),this.clearDynamicEncode(),this.getConfigData()},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x="";let r=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y.length;if(r>0)for(let e=0;e<r;e++)this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e]=""},changeDimensionsAlias(r){r.length>=2?this.currentWidget.config.bubble_2_show=!0:(this.currentWidget.config.bubble_2_show=!1,this.currentWidget.config.bubbleColor_2="")},onLayerChangeBase(r){this.currentWidget.config.baseLayer=r.id,this.layerInfo.baseLayer=r,this.mapLayerPush(),this.getConfigData()},onLayerChangeTag(r){this.currentWidget.config.layerTag=r.id,this.layerInfo.layerTag=r,this.mapLayerPush(),this.getConfigData()},mapLayerPush(){this.currentWidget.mapLayer==null&&(this.currentWidget.mapLayer={toc:[]}),this.currentWidget.mapLayer.toc=[],this.$$lib__.isEmpty(this.layerInfo.baseLayer)||this.currentWidget.mapLayer.toc.push(JSON.parse(JSON.stringify(this.layerInfo.baseLayer))),this.$$lib__.isEmpty(this.layerInfo.layerTag)||this.currentWidget.mapLayer.toc.push(JSON.parse(JSON.stringify(this.layerInfo.layerTag)))},mapLayerPop(){if(this.currentWidget.mapLayer&&this.currentWidget.mapLayer.toc&&this.currentWidget.mapLayer.toc.length>0){if(this.currentWidget.config.baseLayer&&this.currentWidget.config.baseLayer!=""){let r=this.$$lib__.find(this.currentWidget.mapLayer.toc,e=>e.id==this.currentWidget.config.baseLayer);r&&(this.layerInfo.baseLayer=r)}if(this.currentWidget.config.layerTag&&this.currentWidget.config.layerTag!=""){let r=this.$$lib__.find(this.currentWidget.mapLayer.toc,e=>e.id==this.currentWidget.config.layerTag);r&&(this.layerInfo.layerTag=r)}}}}},u=g,y=i(768141),h=(0,y.Z)(u,s,l,!1,null,"44c34fa0",null),f=h.exports}}]);
