"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[48897],{56279:function(P,g,i){i.d(g,{P:function(){return r}});var h=i(386892),p=i(149500);const r={mixins:[h.D],created(){},methods:{lifecycleBeforeChartsLoad(y){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&p.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let v=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[y]);if(v)return v}return y},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&p.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(P,g,i){i.d(g,{X:function(){return h},b:function(){return p}});let h={versions:function(){var r=navigator.userAgent;return{trident:r.indexOf("Trident")>-1,presto:r.indexOf("Presto")>-1,webKit:r.indexOf("AppleWebKit")>-1,gecko:r.indexOf("Gecko")>-1&&r.indexOf("KHTML")==-1,mobile:!!r.match(/AppleWebKit.*Mobile.*/),ios:!!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:r.indexOf("Android")>-1,iPhone:r.indexOf("iPhone")>-1,iPad:r.indexOf("iPad")>-1,webApp:r.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},p;h.versions.mobile||h.versions.ios||h.versions.android||h.versions.iPhone||h.versions.iPad?p=!1:p=!0},848897:function(P,g,i){i.r(g),i.d(g,{default:function(){return D}});var h=function(){var t=this,a=t._self._c;return a("div",{style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[a("hide-button",{attrs:{attr:t.widgetInfo.attr}}),a("div",{ref:"graphSimple",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}})],1)},p=[],r=i(844513),y=i(927966),C=i(56279),v=i(445061),N=i(126711),F=i(459499),I=i(99349),n=i(555616),w=i(275770),A=i(67157),L=i(150813);const z={mixins:[A.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(L.Z.charts.title)),legend:JSON.parse(JSON.stringify(L.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(L.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(L.Z.charts.toolbox)),series:{itemStyle:{color:"#DBE6FF",borderColor:"rgba(76, 132, 255, 0.5)",opacity:1},lineStyle:{opacity:1,color:"#B0C9FF"},label:{color:"#4C84FF"}}}}},methods:{filterPredefineColoursSchemeConfig(e,t){this.getNewConfigWithArrary(e,t,this.filter_config)}}};var J=i(149500);const B=i(954255);var E={name:"GraphSimple",components:{HideButton:r.Z},mixins:[C.P,v.u,N.H,I.P,F.baseConfig,z],props:["widgetInfo"],data(){return{}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=B.init(this.$refs.graphSimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(e){let t=JSON.parse(JSON.stringify(e.config.series)),a=e.dataset[e.dataset.type].source,u=e.dataset[e.dataset.type].dimensions,c=e.dataset[e.dataset.type].encode,m=this.getSeriesData(a,u,c,t.positionList),O=JSON.parse(JSON.stringify(e.config.title)),$=this.getTooltip(e.config.tooltip),H=JSON.parse(JSON.stringify(e.config.toolbox));switch(t.label.formatter=this.getFormatterString(t.label.formatter),t.edgeLabel.formatter=this.getFormatterString(t.edgeLabel.formatter),t.label.borderWidth&&t.label.borderWidth>0&&(t.label.textBorderWidth||(t.label.textBorderColor="rgba(0,0,0,0)")),this.getSymbol(t),t.roamType){case"both":t.roam=!0;break;case"none":t.roam=!1;break;default:t.roam=t.roamType}let b=this.$$lib__.find(t.positionList,o=>o.name&&o.name!="");this.$$lib__.each(m.nodesList,(o,s)=>{if(t.layout=="none"){let d={name:o.name,value:m.data[s],symbolSize:m.data[s]};b?(d.x=o.x?o.x:t.data[s-1]?t.data[s-1].x+20:20*s,d.y=o.y?o.y:t.data[s-1]?t.data[s-1].y+20:20*s):(d.x=t.positionList[s]?t.positionList[s].x:10*s,d.y=t.positionList[s]?t.positionList[s].y:10*s),t.data.push(d)}else t.data.push({name:o.name,value:m.data[s],symbolSize:m.data[s]})}),this.$$lib__.each(m.linksList,o=>{t.links.push({source:o.source,target:o.target})}),t.itemStyle.shadowBlur=t.label.shadowBlur,t.itemStyle.shadowColor=t.label.shadowColor,t.itemStyle.shadowOffsetX=t.label.shadowOffsetX,t.itemStyle.shadowOffsetY=t.label.shadowOffsetY;let l={tooltip:$,toolbox:H,title:O,series:t};if(t.emphasis)try{let o=t.emphasis;if(o.script&&o.script.enabled&&o.script.content){let s=new Function("index","item","data",o.script.content),d=l.series.data;if(d&&d.length>0)for(let S=0;S<d.length;++S)try{d[S].emphasis=s.call(this,S,d[S],d)}catch(f){J.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",f)}}}catch(o){J.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",o)}l.series.type="graph",this.getAnimation(l,e),this.setOption(l),this.setAnimationLoop(e,()=>{this.setOption(l,e)})},setOption(e){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(e),{notMerge:!0})},reLoadInfo(e){e&&(this.$refs.graphSimple.style.width=e.attr.w+"px",this.$refs.graphSimple.style.height=e.attr.hh+"px"),this.loadInfo(e),this.echarts.resize()},getSymbol(e){e.symbolType=="img"&&e.symbol!=""&&(e.symbol=this.getSymbolURL(e.symbol)),e.symbolType=="svg"&&e.symbol!=""&&(e.symbol.indexOf("image/")>-1?e.symbol=e.symbol.indexOf("image://")==-1?"image://"+e.symbol:e.symbol:e.symbol=e.symbol.indexOf("path://")==-1?"path://"+e.symbol:e.symbol)},getSeriesData(e,t,a,u){let c=[],m=[],O=[],$=-1,H=-1,b=-1;for(let l=0;l<t.length;l++)t[l]==a.key&&($=l),t[l]==a.linkKey&&(H=l),t[l]==a.value&&(b=l);for(let l=0;l<e.length;l++){let o=e[l][$],s=this.$$lib__.find(c,f=>f.name==o);if(!s){let f={name:o},x=this.$$lib__.find(u,T=>T.name==o);x&&(f.x=x.x,f.y=x.y),c.push(f),b>-1&&O.push(e[l][b])}let d=e[l][H];if(s=this.$$lib__.find(c,f=>f.name==d),!s){let f={name:d},x=this.$$lib__.find(u,T=>T.name==d);x&&(f.x=x.x,f.y=x.y),c.push(f),b>-1&&O.push(e[l][b])}this.$$lib__.find(m,f=>f.source==o&&f.target==d)||m.push({source:o,target:d})}return{nodesList:c,linksList:m,data:O}},initAction(e){this.actionSendout(e),this.actionReceive(e)},actionSendout(e){let t=this;this.$$lib__.each(e.action.sendOut.actionList,a=>{if(a.enabled){let u=a.code+"_"+e.id;if(a.paramsExtend&&a.paramsExtend.length>0){let c={};this.getParamsExtend(c,a.paramsExtend,e)}a.code==w.default.click.code&&t.onClick(u,a)}})},onClick(e,t){let a=this;a.echarts.on("click",u=>{let c={};if(c.tag=u.name,c.value=u.value,t.script&&t.script.enabled){if(J.log("Execute script for "+a.widgetInfo.name+" component to "+t.name+" component"),t.script.content==""){n.Message.warning({message:t.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",t.script.content),c=this.customScript(c)}y.Z.$emit(e,c),t.postMessage&&a.doPostMessage(c),a.actionNameList.push(e)})}}},M=E,Z=i(768141),R=(0,Z.Z)(M,h,p,!1,null,"1f9193df",null),D=R.exports},844513:function(P,g,i){i.d(g,{Z:function(){return F}});var h=function(){var n=this,w=n._self._c;return n.attr.buttonHide?w("div",{style:{position:"absolute",right:n.attr.buttonHideRight+"px",top:n.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(A){return n.onHide()}}},[n.openTooltip?w("el-tooltip",{attrs:{"open-delay":1e3,content:n.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[w("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):w("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):n._e()},p=[],r=i(752246),y={props:["attr"],name:"hide-button",data(){return{isPc:r.b}},computed:{openTooltip:function(){let I=!1,n=this.attr.buttonHideTooltipContent;return r.b&&n&&n!=null&&n.trim()!=""&&(I=!0),I}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},C=y,v=i(768141),N=(0,v.Z)(C,h,p,!1,null,"bf399b9a",null),F=N.exports}}]);
