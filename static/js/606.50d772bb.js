"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[606],{27377:function(x,h,n){n.d(h,{y:function(){return y}});var u=n(31954),f=n(55616),g=n.n(f),s=n(35051);let y={getClientInfo(){return(0,s.getRequest)("/public/getClientInfo")},getCodeValuePropertysByKeys(l){return(0,s.postRequest)("/public/thirdparty/platform/getCodeValuePropertysByKeys",l)},sendMobileCode(l){return u.Z.baseConfig.isPlatform?(0,s.getRequest)("/public/thirdparty/platform/sendMobileCode/"+l):(f.Message.error({message:"\u672A\u4E0E\u7535\u5B50\u653F\u52A1\u5E73\u53F0\u96C6\u6210\u4F7F\u7528\uFF0C\u65E0\u6CD5\u83B7\u53D6\u77ED\u4FE1\u9A8C\u8BC1\u7801",offset:60}),(0,s.getRequest)(""))},sendMobileCodeByUsername(l){return u.Z.baseConfig.isPlatform?(0,s.getRequest)("/public/thirdparty/platform/sendMobileCodeByUsername/"+encodeURIComponent(l)):(f.Message.error({message:"\u672A\u4E0E\u7535\u5B50\u653F\u52A1\u5E73\u53F0\u96C6\u6210\u4F7F\u7528\uFF0C\u65E0\u6CD5\u83B7\u53D6\u77ED\u4FE1\u9A8C\u8BC1\u7801",offset:60}),(0,s.getRequest)(""))}}},56279:function(x,h,n){n.d(h,{P:function(){return g}});var u=n(86892),f=n(49500);const g={mixins:[u.D],created(){},methods:{lifecycleBeforeChartsLoad(s){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&f.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let l=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[s]);if(l)return l}return s},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&f.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},44513:function(x,h,n){n.d(h,{Z:function(){return P}});var u=function(){var a=this,C=a._self._c;return a.attr.buttonHide?C("div",{style:{position:"absolute",right:a.attr.buttonHideRight+"px",top:a.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(b){return a.onHide()}}},[a.openTooltip?C("el-tooltip",{attrs:{"open-delay":1e3,content:a.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[C("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):C("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):a._e()},f=[],g=n(52246),s={props:["attr"],name:"hide-button",data(){return{isPc:g.b}},computed:{openTooltip:function(){let k=!1,a=this.attr.buttonHideTooltipContent;return g.b&&a&&a!=null&&a.trim()!=""&&(k=!0),k}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},y=s,l=n(68141),_=(0,l.Z)(y,u,f,!1,null,"bf399b9a",null),P=_.exports},40606:function(x,h,n){n.r(h),n.d(h,{default:function(){return L}});var u=function(){var e=this,c=e._self._c;return c("div",{ref:"comWatermarkDom"},[c("hide-button",{attrs:{attr:e.widgetInfo.attr}}),c("div",{ref:"comWatermark",staticClass:"com-watermark",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},f=[],g=n(44513),s=n(48836),y=n(49500);const l=t=>{var e={watermark_txt:t.content,watermark_x:t.x!=null?t.x:20,watermark_y:t.y!=null?t.y:20,watermark_rows:t.rows?t.rows:2,watermark_cols:t.cols?t.cols:2,watermark_x_space:t.xSpace?t.xSpace:100,watermark_y_space:t.ySpace?t.ySpace:100,watermark_color:t.fontStyle.color?t.fontStyle.color:"#aaa",watermark_alpha:t.opacity?t.opacity:.4,watermark_fontsize:t.fontStyle.fontSize?t.fontStyle.fontSize+"px":"14px",watermark_font:t.fontStyle.fontFamily?t.fontStyle.fontFamily:"\u5FAE\u8F6F\u96C5\u9ED1",watermark_width:t.singleWidth?t.singleWidth:180,watermark_height:t.singleHeight?t.singleHeight:60,watermark_angle:t.angle!=null?t.angle:20};document.getElementById("watermark")&&document.getElementById("watermark").remove();let c=document.getElementById("boardAreaView");c||(c=document.getElementById("boardArea"),e.watermark_y=e.watermark_y+20);var o=document.createElement("div");o.id="watermark",o.style.overflow="hidden",o.style.position="absolute",o.style.left=e.watermark_x+"px",o.style.top=e.watermark_y+"px",o.style.pointerEvents="none";var d=t.width,m=t.height;o.style.width=d+"px",o.style.height=m+"px",document.getElementById("boardAreaView")&&t.all&&(e.watermark_cols=parseInt((d-e.watermark_x-e.watermark_width)/(e.watermark_width+e.watermark_x_space))+1,e.watermark_rows=parseInt((m-e.watermark_y-e.watermark_height-20)/(e.watermark_height+e.watermark_y_space))+1);for(var i,w,v=0;v<e.watermark_rows;v++){w=(e.watermark_y_space+e.watermark_height)*v;for(var p=0;p<e.watermark_cols;p++){i=(e.watermark_width+e.watermark_x_space)*p;var r=document.createElement("div");r.id="mask_div"+v+p,r.className="mask_div",r.innerHTML=e.watermark_txt,r.style.MozTransform="rotate(-"+e.watermark_angle+"deg)",r.style.msTransform="rotate(-"+e.watermark_angle+"deg)",r.style.OTransform="rotate(-"+e.watermark_angle+"deg)",r.style.transform="rotate(-"+e.watermark_angle+"deg)",r.style.visibility="",r.style.position="absolute",r.style.left=i+"px",r.style.top=w+20+"px",r.style.overflow="hidden",r.style.zIndex="2000",r.style.pointerEvents="none",r.style.opacity=e.watermark_alpha,r.style.fontSize=e.watermark_fontsize,r.style.fontFamily=e.watermark_font,r.style.color=e.watermark_color,r.style.textAlign="center",r.style.width=e.watermark_width+"px",r.style.height=e.watermark_height+"px",r.style.display="block",o.appendChild(r)}}c.appendChild(o)},_=t=>{var e={},c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!c){var o=document.createElement("iframe");o.sandbox="allow-same-origin",o.style.display="none",document.body.appendChild(o);var d=o.contentWindow;window.RTCPeerConnection=d.RTCPeerConnection,window.mozRTCPeerConnection=d.mozRTCPeerConnection,window.webkitRTCPeerConnection=d.webkitRTCPeerConnection,c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection}var m={optional:[{RtpDataChannels:!0}]},I=void 0;window.webkitRTCPeerConnection&&(I={iceServers:[{urls:"stun:stun.services.mozilla.com"}]});var i=new c(I,m);i.onicecandidate=function(w){if(w.candidate){var v=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,p=v.exec(w.candidate.candidate)[1];e[p]===void 0&&t(p),e[p]=!0}},i.createDataChannel(""),i.createOffer(function(w){i.setLocalDescription(w,function(){},function(){})},function(){})},P=t=>{y.log(t);var e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,c=new e({iceServers:[]}),o=function(){},d={},m=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g;function I(i){d[i]||t(i),d[i]=!0}c.createDataChannel(""),c.createOffer().then(function(i){i.sdp.split(`
`).forEach(function(w){w.indexOf("candidate")<0||w.match(m).forEach(I)}),c.setLocalDescription(i,o,o)}).catch(function(){}),c.onicecandidate=function(i){!i||!i.candidate||!i.candidate.candidate||!i.candidate.candidate.match(m)||i.candidate.candidate.match(m).forEach(I)}};var k=n(55616),a=n(27377),C=n(21207),b=n(56279),R={name:"ComWatermark",components:{HideButton:g.Z},mixins:[C.u,b.P],props:["widgetInfo"],data(){return{ip:""}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo),this.widgetInfo.attr.hide?document.getElementById("watermark").remove():l(this.widgetInfo.config.watermark)}},beforeMount(){this.getLocalIp()},mounted(){this.loadInfo(this.widgetInfo)},computed:{...(0,s.Se)(["getWidgets","getCanvasSetting"])},destroyed(){document.getElementById("watermark")&&document.getElementById("watermark").remove()},methods:{loadInfo(t){t.config.watermark.enabled?t.config.watermark.ScriptContent==""?(k.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60}),t.config.watermark.content="null"):(this.scriptFun=new Function("content,ip",t.config.watermark.ScriptContent),t.config.watermark.content=this.scriptFun(t.dataset[t.dataset.type].encode.content,this.ip)):t.config.watermark.content=this.getContent(t);let e=document.getElementById("boardAreaView");e&&t.config.watermark.all?(t.config.watermark.width=e.scrollWidth,t.config.watermark.height=e.scrollHeight,t.config.watermark.x=0,t.config.watermark.y=0):(t.config.watermark.width=this.widgetInfo.attr.w,t.config.watermark.height=this.widgetInfo.attr.hh,t.config.watermark.x=this.widgetInfo.attr.x,t.config.watermark.y=this.widgetInfo.attr.y),l(t.config.watermark),this.lifecycleAfterLoad()},reLoadInfo(t){t&&(this.$refs.comWatermark.style.width=t.attr.w+"px",this.$refs.comWatermark.style.height=t.attr.hh+"px"),this.loadInfo(t)},getLocalIp(){a.y.getClientInfo().then(t=>{t.status===200&&(this.ip=t.data.clientIp,this.loadInfo(this.widgetInfo))})},getContent(t){let e="",c=t.dataset[t.dataset.type].encode.content,o=-1;return this.$$lib__.each(t.dataset[t.dataset.type].dimensions,(d,m)=>{c==d&&(o=m)}),o>-1&&this.$$lib__.each(t.dataset[t.dataset.type].source,d=>{e=d[o]}),e}}},E=R,S=n(68141),T=(0,S.Z)(E,u,f,!1,null,"a721dfbe",null),L=T.exports}}]);
