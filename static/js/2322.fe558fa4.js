"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2322],{5143:function(C,p,a){a.d(p,{b:function(){return f}});var m=a(48836),u=a(42160),y=a(49500);const f={created(){},computed:{...(0,m.Se)(["getWidgetAllArr"])},data(){return{containerViewSubWidgetList:[]}},methods:{...(0,m.nv)(["updateWidgetParentArrDataset","updateWidgetAllArrDataset"]),reLoadInfo(n){this.widgetInfo.id!=n.id&&this.$refs["comp_"+n.id]&&setTimeout(this.$refs["comp_"+n.id][0].reLoadInfo(n),500),this.loadInfo(n)},orgWidget(n){let d=[];return this.$$lib__.each(n,c=>{let r=this.$$lib__.find(this.getWidgetAllArr,g=>g.parentId==this.widgetInfo.id&&g.id==c.id);r&&(r.dataset&&r.dataset[r.dataset.type]&&(r.dataset.type==this.$$global_editor.dataSourcType.dynamic.code||r.dataset.type==this.$$global_editor.dataSourcType.local.code)&&r.dataset[r.dataset.type].autoUpdate==!0&&(u.default.set(this.dynamicWidgets,r.id,r),r.attr.hide!=!0&&r.dataset[r.dataset.type].autoUpdate==!0&&u.default.set(this.autoUpdateWidget,r.id,r)),d.push(r))}),u.default.set(this,"containerViewSubWidgetList",d),d},setTitleText(n,d){d?this.$$lib__.each(d,c=>{this.$$lib__.each(this.orgWidget(c.widgets),r=>{r.attr.widgetW||(r.attr.widgetW=r.attr.w),this.$refs["title_"+r.id]&&this.$refs["title_"+r.id][0]&&(this.$refs["title_"+r.id][0].innerHTML=this.initTextPosition(r)),r.title.position||(r.title.position="top")})}):this.$$lib__.each(this.orgWidget(n),c=>{this.$refs["title_"+c.id]&&this.$refs["title_"+c.id][0]&&(this.$refs["title_"+c.id][0].innerHTML=this.initTextPosition(c)),c.title.position||(c.title.position="top")})},initTextPosition(n){return n.title.text===void 0||!n.title.text?"":n.title.text&&(n.title.position==="left"||n.title.position==="right")?n.title.text.split("").join("<br />"):n.title.text},updataWidgetSource(n,d,c){try{switch(n.dataset.type){case this.$$global_editor.dataSourcType.dynamic.code:n.dataset.dynamic.source=d.data,d.total&&(n.dataset.dynamic.total=d.total);break;case this.$$global_editor.dataSourcType.local.code:n.dataset.local.dimensionsAlias=[],n.dataset.local.columnList=[],n.dataset.local.source=[],n.dataset.local.dimensions=[],n.dataset.local.dimensionsAlias=d.dimensionsAlias,n.dataset.local.columnList=d.columnList,n.dataset.local.source=d.source,n.dataset.local.dimensions=d.dimensions;break}}catch(g){y&&y.log&&y.log(g)}let r=this.$refs["comp_"+n.id];r&&r.length>0&&(this.updateWidgetAllArrDataset(n),this.updateWidgetParentArrDataset(n),r[0].reLoadInfo(n),this.sendoutDataloadSuccess(n),this.sendoutResponseData(n,d,c))},fit(n,d){if(!this.isView||!/^mobile/.test(this.getCanvasSetting.transformType))return n+"px";let c=this.getCanvasSetting.width/10,r=this.getCanvasSetting.height/window.innerHeight,g="";switch(this.getCanvasSetting.transformType){case"mobileAutoWidth":d?g=n+"px":g=n/c+"rem";break;case"mobileAutoBoth":g=n/c+"rem";break;default:d?g=n/r+"px":g=n/c+"rem"}return g}}}},80269:function(C,p,a){a.d(p,{u:function(){return y},w:function(){return m}});function m(f,n,d){return Math.min(Math.max(f,n),d)}function u(f,n,d){var c=f.indexOf(n),r="";return c===-1?f:n==="-"&&c!==0?f.slice(0,c):(n==="."&&f.match(/^(\.|-\.)/)&&(r=c?"-0":"0"),r+f.slice(0,c+1)+f.slice(c).replace(d,""))}function y(f,n,d){n===void 0&&(n=!0),d===void 0&&(d=!0),n?f=u(f,".",/\./g):f=f.split(".")[0],d?f=u(f,"-",/-/g):f=f.replace(/-/,"");var c=n?/[^-0-9.]/g:/[^-0-9]/g;return f.replace(c,"")}},17230:function(C,p,a){a.r(p),a.d(p,{default:function(){return Q}});var m=function(){var t=this,e=t._self._c;return e("div",{ref:"drawer",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:t.widgetInfo.attr}}),e("pull-refresh",{ref:"pullRefresh",staticClass:"refresh",staticStyle:{height:"100%",overflow:"auto !important"},attrs:{disabled:!t.widgetInfo.config.list.pullDownRefresh},on:{refresh:t.onRefresh},nativeOn:{touchstart:function(l){return t.touchStart.apply(null,arguments)},touchmove:function(l){return t.touchMove.apply(null,arguments)},touchend:function(l){return t.touchEnd.apply(null,arguments)}},model:{value:t.refreshing,callback:function(l){t.refreshing=l},expression:"refreshing"}},[t.widgetInfo.config.list.autoLoad?t._e():e("div",{style:{height:"100%",overflow:"auto"}},t._l(t.totalListInfo,function(l,o){return e("div",{key:o,ref:"list",refInFor:!0,style:{position:"relative",overflow:"hidden",width:t.widgetInfo.config.list.listItem.width+"px",height:t.widgetInfo.config.list.listItem.height+"px",background:t.widgetInfo.config.list.listItem.backgroundColor,borderRadius:t.widgetInfo.config.list.listItem.borderRadius+"px",margin:`${t.widgetInfo.config.list.listItem.marginTop+"px"} 0 0 ${t.widgetInfo.config.list.listItem.marginLeft+"px"} `}},[e("swipe-cell",{staticClass:"swipe-cell-action",style:{width:"auto",height:"100%"},attrs:{disabled:!t.widgetInfo.config.list.swipeCellAction},scopedSlots:t._u([t.widgetInfo.config.list.firstActionShow?{key:"left",fn:function(){return[e("Button",{staticClass:"cell-action-left",attrs:{type:"primary"},on:{click:function(s){return t.handleClick("first",l)}}},[t._v(t._s(t.widgetInfo.config.list.firstActionText))])]},proxy:!0}:null,{key:"right",fn:function(){return[t.widgetInfo.config.list.secondActionShow?e("Button",{staticClass:"cell-action-right-left",attrs:{type:"danger"},on:{click:function(s){return t.handleClick("second",l)}}},[t._v(t._s(t.widgetInfo.config.list.secondActionText))]):t._e(),t.widgetInfo.config.list.thirdActionShow?e("Button",{staticClass:"cell-action-right-right",attrs:{type:"primary"},on:{click:function(s){return t.handleClick("third",l)}}},[t._v(t._s(t.widgetInfo.config.list.thirdActionText))]):t._e()]},proxy:!0}],null,!0)},[t._l(t.orgWidget1(t.widgetInfo.config.container.widgets,o),function(s){return[e("div",{key:"widget_"+s.id,style:(s.attr.deg&&s.attr.deg!=0?"transform: rotate("+s.attr.deg+"deg);":"")+"position: absolute;width: "+s.attr.widgetW+"px;height: "+s.attr.h+"px;left:"+s.attr.x+"px;top:"+s.attr.y+"px"},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.attr.showAnimate||s.attr.hideAnimate?t.first?s.attr.hide!==!0:!0:s.attr.hide!==!0,expression:"(widget.attr.showAnimate || widget.attr.hideAnimate) ? first ? widget.attr.hide !== true : true: widget.attr.hide !== true"}],ref:"widget_"+s.id,refInFor:!0,staticClass:"my-comp",style:t.getBindStyle(s)},[e("div",{staticStyle:{overflow:"hidden",width:"100%"},style:t.getTitleStyle(s),on:{click:function(h){return t.openLink(s)}}},[e("div",{style:{marginLeft:s.title.label.left+"px",marginTop:s.title.label.top+"px"}},[e("span",{style:t.getTitleSpanStyle(s)},[t._v(t._s(s.title.text)+" ")])])]),e("draggable-component-container",{ref:"comp_"+s.id,refInFor:!0,style:t.getInfoStyle(s),attrs:{widgetData:s},on:{attrChange:function(h){return t.attrChange(h,o)},doReSetBoardId:t.doReSetBoardId,doGetPreviewData:t.getPreviewData}})],1)])]})],2)],1)}),0),t.widgetInfo.config.list.autoLoad?e("list",{staticClass:"list-container",staticStyle:{height:"auto !important"},attrs:{offset:t.widgetInfo.config.list.offsetHeight===0?1:t.widgetInfo.config.list.offsetHeight,"immediate-check":!1,finished:t.finished,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86"},on:{load:t.onLoad},model:{value:t.listLoading,callback:function(l){t.listLoading=l},expression:"listLoading"}},[e("div",{ref:"listContent",style:{display:t.widgetInfo.config.list.layOut==="single"?"block":"flex",flexFlow:"wrap"}},[!t.widgetInfo.config.list.selectType||t.widgetInfo.config.list.selectType==="none"?t._l(t.totalListInfo,function(l,o){return e("div",{key:o,ref:"list",refInFor:!0,style:{flex:"none",position:"relative",overflow:"hidden",width:t.widgetInfo.config.list.listItem.width+"px",height:t.widgetInfo.config.list.listItem.height+"px",background:t.widgetInfo.config.list.listItem.backgroundColor,borderRadius:t.widgetInfo.config.list.listItem.borderRadius+"px",margin:`${t.widgetInfo.config.list.listItem.marginTop+"px"} 0 0 ${t.widgetInfo.config.list.listItem.marginLeft+"px"} `}},[e("swipe-cell",{staticClass:"swipe-cell-action",style:{width:"auto",height:"100%"},attrs:{disabled:!t.widgetInfo.config.list.swipeCellAction},scopedSlots:t._u([t.widgetInfo.config.list.firstActionShow?{key:"left",fn:function(){return[e("Button",{staticClass:"cell-action-left",attrs:{type:"primary"},on:{click:function(s){return t.handleClick("first",l)}}},[t._v(t._s(t.widgetInfo.config.list.firstActionText))])]},proxy:!0}:null,{key:"right",fn:function(){return[t.widgetInfo.config.list.secondActionShow?e("Button",{staticClass:"cell-action-right-left",attrs:{type:"danger"},on:{click:function(s){return t.handleClick("second",l)}}},[t._v(t._s(t.widgetInfo.config.list.secondActionText))]):t._e(),t.widgetInfo.config.list.thirdActionShow?e("Button",{staticClass:"cell-action-right-right",attrs:{type:"primary"},on:{click:function(s){return t.handleClick("third",l)}}},[t._v(t._s(t.widgetInfo.config.list.thirdActionText))]):t._e()]},proxy:!0}],null,!0)},[t._l(t.orgWidget1(t.widgetInfo.config.container.widgets,o),function(s){return[e("div",{key:"widget_"+s.id,staticClass:"test",style:(s.attr.deg&&s.attr.deg!=0?"transform: rotate("+s.attr.deg+"deg);":"")+"position: absolute;width: "+s.attr.widgetW+"px;height: "+s.attr.h+"px;left:"+s.attr.x+"px;top:"+s.attr.y+"px"},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.attr.showAnimate||s.attr.hideAnimate?t.first?s.attr.hide!==!0:!0:s.attr.hide!==!0,expression:"(widget.attr.showAnimate || widget.attr.hideAnimate) ? first ? widget.attr.hide !== true : true: widget.attr.hide !== true"}],ref:"widget_"+s.id,refInFor:!0,staticClass:"my-comp",style:t.getBindStyle(s)},[e("div",{staticStyle:{overflow:"hidden",width:"100%"},style:t.getTitleStyle(s),on:{click:function(h){return t.openLink(s)}}},[e("div",{style:{marginLeft:s.title.label.left+"px",marginTop:s.title.label.top+"px"}},[e("span",{style:t.getTitleSpanStyle(s)},[t._v(t._s(s.title.text)+" ")])])]),e("draggable-component-container",{ref:"comp_"+s.id,refInFor:!0,style:t.getInfoStyle(s),attrs:{widgetData:s},on:{attrChange:function(h){return t.attrChange(h,o)},doReSetBoardId:t.doReSetBoardId,doGetPreviewData:t.getPreviewData}})],1)])]})],2)],1)}):e(t.widgetInfo.config.list.selectType==="single"?"RadioGroup":"CheckboxGroup",{tag:"component",attrs:{value:t.widgetInfo.config.list.selectType==="single"?t.radioValue:t.checkBoxList},on:{input:t.selectInput,change:t.valueChange}},t._l(t.totalListInfo,function(l,o){return e("div",{key:o,ref:"list",refInFor:!0,style:{flex:"none",position:"relative",overflow:"hidden",width:t.widgetInfo.config.list.listItem.width+"px",height:t.widgetInfo.config.list.listItem.height+"px",background:t.widgetInfo.config.list.listItem.backgroundColor,borderRadius:t.widgetInfo.config.list.listItem.borderRadius+"px",margin:`${t.widgetInfo.config.list.listItem.marginTop+"px"} 0 0 ${t.widgetInfo.config.list.listItem.marginLeft+"px"} `}},[e("swipe-cell",{staticClass:"swipe-cell-action",style:{width:"auto",height:"100%"},attrs:{disabled:!t.widgetInfo.config.list.swipeCellAction},scopedSlots:t._u([t.widgetInfo.config.list.firstActionShow?{key:"left",fn:function(){return[e("Button",{staticClass:"cell-action-left",attrs:{type:"primary"},on:{click:function(s){return t.handleClick("first",l)}}},[t._v(t._s(t.widgetInfo.config.list.firstActionText))])]},proxy:!0}:null,{key:"right",fn:function(){return[t.widgetInfo.config.list.secondActionShow?e("Button",{staticClass:"cell-action-right-left",attrs:{type:"danger"},on:{click:function(s){return t.handleClick("second",l)}}},[t._v(t._s(t.widgetInfo.config.list.secondActionText))]):t._e(),t.widgetInfo.config.list.thirdActionShow?e("Button",{staticClass:"cell-action-right-right",attrs:{type:"primary"},on:{click:function(s){return t.handleClick("third",l)}}},[t._v(t._s(t.widgetInfo.config.list.thirdActionText))]):t._e()]},proxy:!0}],null,!0)},[e(t.widgetInfo.config.list.selectType==="single"?"radio":"checkbox",{tag:"component",style:{position:"absolute",left:t.widgetInfo.config.list.select.left+"px",top:t.widgetInfo.config.list.select.top+"px"},attrs:{name:l[t.valueIndex],shape:t.widgetInfo.config.list.select.shape,"icon-size":t.widgetInfo.config.list.select.fontSize+"px","checked-color":t.widgetInfo.config.list.select.checkedColor,disabled:t.disabledIndex===""?!1:l[t.disabledIndex]==1},scopedSlots:t._u([t.widgetInfo.config.list.select.showIcon?{key:"icon",fn:function(s){return[t.widgetInfo.config.list.select.iconType==="icon"?e("i",{class:`${s.checked?t.widgetInfo.config.list.select.activeIcon:t.widgetInfo.config.list.select.icon} select-icon`,style:{fontSize:t.widgetInfo.config.list.select.fontSize+"px",color:s.checked?t.widgetInfo.config.list.select.checkedColor:t.widgetInfo.config.list.select.color}}):e("van-image",{style:{width:t.widgetInfo.config.list.select.fontSize+"px",height:t.widgetInfo.config.list.select.fontSize+"px"},attrs:{fit:t.widgetInfo.config.list.select.fit,src:s.checked?t.getImageFullUrl(t.widgetInfo.config.list.select.activeUrl):t.getImageFullUrl(t.widgetInfo.config.list.select.url)}})]}}:null],null,!0)}),t._l(t.orgWidget1(t.widgetInfo.config.container.widgets,o),function(s){return[e("div",{key:"widget_"+s.id,staticClass:"test",style:(s.attr.deg&&s.attr.deg!=0?"transform: rotate("+s.attr.deg+"deg);":"")+"position: absolute;width: "+s.attr.widgetW+"px;height: "+s.attr.h+"px;left:"+s.attr.x+"px;top:"+s.attr.y+"px"},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.attr.showAnimate||s.attr.hideAnimate?t.first?s.attr.hide!==!0:!0:s.attr.hide!==!0,expression:"(widget.attr.showAnimate || widget.attr.hideAnimate) ? first ? widget.attr.hide !== true : true: widget.attr.hide !== true"}],ref:"widget_"+s.id,refInFor:!0,staticClass:"my-comp",style:t.getBindStyle(s)},[e("div",{staticStyle:{overflow:"hidden",width:"100%"},style:t.getTitleStyle(s),on:{click:function(h){return t.openLink(s)}}},[e("div",{style:{marginLeft:s.title.label.left+"px",marginTop:s.title.label.top+"px"}},[e("span",{style:t.getTitleSpanStyle(s)},[t._v(t._s(s.title.text)+" ")])])]),e("draggable-component-container",{ref:"comp_"+s.id,refInFor:!0,style:t.getInfoStyle(s),attrs:{widgetData:s},on:{attrChange:function(h){return t.attrChange(h,o)},doReSetBoardId:t.doReSetBoardId,doGetPreviewData:t.getPreviewData}})],1)])]})],2)],1)}),0)],2)]):t._e()],1)],1)},u=[],y=a(95795),f=a(63565),n=a(20946),d=a(2004),c=a(91221),r=a(91692),g=a(95144),A=a(91567),q=a(37735),T=a(83762),_=a(86569),tt=a(91905),et=a(51595),it=a(91508),st=a(99695),k=a(43351),W=a(39733),R=a(80269),$=a(50068),P=a(34672),B=function(t){return{props:{closeOnClickOutside:{type:Boolean,default:!0}},data:function(){var l=this,o=function(h){l.closeOnClickOutside&&!l.$el.contains(h.target)&&l[t.method]()};return{clickOutsideHandler:o}},mounted:function(){(0,$.on)(document,t.event,this.clickOutsideHandler)},beforeDestroy:function(){(0,$.S1)(document,t.event,this.clickOutsideHandler)}}},L=(0,W.d)("swipe-cell"),O=L[0],v=L[1],S=.15,D=O({mixins:[P.D,B({event:"touchstart",method:"onClick"})],props:{onClose:Function,disabled:Boolean,leftWidth:[Number,String],rightWidth:[Number,String],beforeClose:Function,stopPropagation:Boolean,name:{type:[Number,String],default:""}},data:function(){return{offset:0,dragging:!1}},computed:{computedLeftWidth:function(){return+this.leftWidth||this.getWidthByRef("left")},computedRightWidth:function(){return+this.rightWidth||this.getWidthByRef("right")}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{getWidthByRef:function(t){if(this.$refs[t]){var e=this.$refs[t].getBoundingClientRect();return e.width}return 0},open:function(t){var e=t==="left"?this.computedLeftWidth:-this.computedRightWidth;this.opened=!0,this.offset=e,this.$emit("open",{position:t,name:this.name,detail:this.name})},close:function(t){this.offset=0,this.opened&&(this.opened=!1,this.$emit("close",{position:t,name:this.name}))},onTouchStart:function(t){this.disabled||(this.startOffset=this.offset,this.touchStart(t))},onTouchMove:function(t){if(!this.disabled&&(this.touchMove(t),this.direction==="horizontal")){this.dragging=!0,this.lockClick=!0;var e=!this.opened||this.deltaX*this.startOffset<0;e&&(0,$.PF)(t,this.stopPropagation),this.offset=(0,R.w)(this.deltaX+this.startOffset,-this.computedRightWidth,this.computedLeftWidth)}},onTouchEnd:function(){var t=this;this.disabled||this.dragging&&(this.toggle(this.offset>0?"left":"right"),this.dragging=!1,setTimeout(function(){t.lockClick=!1},0))},toggle:function(t){var e=Math.abs(this.offset),l=this.opened?1-S:S,o=this.computedLeftWidth,s=this.computedRightWidth;s&&t==="right"&&e>s*l?this.open("right"):o&&t==="left"&&e>o*l?this.open("left"):this.close()},onClick:function(t){t===void 0&&(t="outside"),this.$emit("click",t),this.opened&&!this.lockClick&&(this.beforeClose?this.beforeClose({position:t,name:this.name,instance:this}):this.onClose?this.onClose(t,this,{name:this.name}):this.close(t))},getClickHandler:function(t,e){var l=this;return function(o){e&&o.stopPropagation(),l.onClick(t)}},genLeftPart:function(){var t=this.$createElement,e=this.slots("left");if(e)return t("div",{ref:"left",class:v("left"),on:{click:this.getClickHandler("left",!0)}},[e])},genRightPart:function(){var t=this.$createElement,e=this.slots("right");if(e)return t("div",{ref:"right",class:v("right"),on:{click:this.getClickHandler("right",!0)}},[e])}},render:function(){var t=arguments[0],e={transform:"translate3d("+this.offset+"px, 0, 0)",transitionDuration:this.dragging?"0s":".6s"};return t("div",{class:v(),on:{click:this.getClickHandler("cell")}},[t("div",{class:v("wrapper"),style:e},[this.genLeftPart(),this.slots(),this.genRightPart()])])}}),nt=a(66780),E=a(75792),ot=a(38575),N=a(77117),M=a(44513),H=a(80512),F=a(81573),b=a(48836),V=a(93575),Z=a(5143),G=a(26711),I=a(27966),U=a(45061),J=a(56279),j=a(34194),x=a(55616),w=a(49500),z={name:"mobile-container-list-view",props:["widgetInfo","currentWidget"],components:{DraggableComponentContainer:H.Z,List:N.Z,PullRefresh:E.Z,SwipeCell:D,Button:k.Z,RadioGroup:T.Z,Radio:A.Z,CheckboxGroup:r.Z,Checkbox:d.Z,HideButton:M.Z,VanImage:f.Z},mixins:[F.u,V.E,Z.b,G.H,U.u,J.P],data(){return{prefix:{widget:"widget_"},png:j,refreshing:!1,finished:!1,pageData:[],listLoading:!1,valueIndex:"",disabledIndex:"",radioValue:"",checkBoxList:[],touchPoint:0}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)},listInfo:function(i,t){this.refreshing?(this.pageData=[],this.listLoading=!1,this.refreshing=!1):this.listLoading?(this.widgetInfo.dataset.type==="dynamic"&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query.page&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query.page.enabled&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query.page.pageNum===1?this.pageData=[]:this.pageData=[...this.pageData,...t],this.listLoading=!1):this.widgetInfo.dataset.type==="dynamic"&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query.page&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query.page.enabled&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].query.page.pageNum===1&&(this.pageData=[])}},computed:{...(0,b.Se)(["getWidgets","getCanvasSetting","isView"]),totalListInfo:function(){return this.widgetInfo.config.list.autoLoad?[...this.pageData,...this.listInfo]:this.listInfo},listInfo:function(){return this.getListInfo(this.widgetInfo.dataset[this.widgetInfo.dataset.type])}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},methods:{...(0,b.nv)(["updateCurrentWidget"]),orgWidget1(i,t){return this.orgWidget(i).map(l=>{let o={...l};if(o.dataset=JSON.parse(JSON.stringify(l.dataset)),o.dataset.extend&&this.totalListInfo.length>0){let s=JSON.parse(JSON.stringify(this.totalListInfo[t]));s.push(t+1),o.dataset.extend.source=[s]}return this.$refs[`comp_${o.id}`]&&this.$nextTick(()=>{let s={...o};delete s.parentId,this.$refs[`comp_${o.id}`][t]&&this.$refs[`comp_${o.id}`][t].reLoadInfo&&this.$refs[`comp_${o.id}`][t].reLoadInfo(s)}),o})},onRefresh(){if(this.widgetInfo.dataset.type===this.$$global_editor.dataSourcType.static.code){this.refreshing=!1,this.finished=!1;return}this.widgetInfo.dataset.dynamic.query.page.pageNum=1,this.listLoading=!0,this.refreshing=!0,this.finished=!1,this.$emit("doGetPreviewData",this.widgetInfo)},onLoad(){if(this.widgetInfo.dataset.type===this.$$global_editor.dataSourcType.static.code){this.listLoading=!1;return}if(this.widgetInfo.dataset.dynamic.query.page.pageNum*this.widgetInfo.dataset.dynamic.query.page.pageSize>=this.widgetInfo.dataset.dynamic.total){this.finished=!0;return}this.widgetInfo.dataset.dynamic.query.page.pageNum+=1,this.$emit("doGetPreviewData",this.widgetInfo)},initAction(i){this.actionReceive(i),this.initReceive(i)},initReceive(i){if(i.action==null||i.action.receive==null)return;let t=i.action.receive.setAll;if(t&&t.enabled){let l=t.widgetList;this.setAll(l,i)}let e=i.action.receive.setOther;if(e&&e.enabled){let l=e.widgetList;this.setOther(l,i)}},setAll(i,t){this.widgetInfo.config.list.selectType!=="single"&&this.$$lib__.each(i,e=>{let l=e[0][1];I.Z.$on(l,o=>{if(t.action.receive.setAll.script&&t.action.receive.setAll.script.enabled){if(w.log("Execute the script to execute model to the "+t.name+" component"),t.action.receive.setAll.script.content==""){x.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.setAllValue=new Function("info","data",t.action.receive.setAll.script.content)}this.setAllValue(t,o)})})},setAllValue(){this.checkBoxList=this.totalListInfo.map(i=>i[this.valueIndex])},setOtherValue(){let i=this.totalListInfo.map(t=>t[this.valueIndex]);this.checkBoxList=i.filter(t=>this.checkBoxList.indexOf(t)===-1)},setOther(i,t){this.widgetInfo.config.list.selectType!=="single"&&this.$$lib__.each(i,e=>{let l=e[0][1];I.Z.$on(l,o=>{if(t.action.receive.setOther.script&&t.action.receive.setOther.script.enabled){if(w.log("Execute the script to execute model to the "+t.name+" component"),t.action.receive.setOther.script.content==""){x.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.setOtherValue=new Function("info","data",t.action.receive.setOther.script.content)}this.setOtherValue(t,o)})})},doReSetBoardId(i){this.$emit("doReSetBoardId",i)},attrChange(i,t){let e=this.$refs["widget_"+i.id][t];i.attr.hide?i.attr.hideAnimate&&i.attr.hideAnimate.length>0?(this.first=!1,e.classList="",e.classList.add("animated"),e.classList.add("my-comp"),e.classList.add(i.attr.hideAnimate[i.attr.hideAnimate.length-1]),setTimeout(()=>{e.style.display="none",e.classList.remove(i.attr.hideAnimate[i.attr.hideAnimate.length-1])},900)):e.style.display="none":i.attr.showAnimate&&i.attr.showAnimate.length>0?(e.style.display="block",this.first=!1,e.classList="",e.classList.add("animated"),e.classList.add("my-comp"),e.classList.add(i.attr.showAnimate[i.attr.showAnimate.length-1])):e.style.display="block"},loadInfo(i){if(i.dataset[i.dataset.type]&&i.dataset[i.dataset.type].dimensions&&i.dataset[i.dataset.type].dimensions.length>0?this.getListInfo(i.dataset[i.dataset.type]):this.getListInfo({source:[]}),this.lifecycleAfterLoad(),!this.widgetInfo.config.list.selectType||this.widgetInfo.config.list.selectType==="none")return;let t=i.dataset[i.dataset.type].columnList.filter(e=>e.name===i.dataset[i.dataset.type].encode.value);if(t.length>0&&(this.valueIndex=t[0].index),i.dataset[i.dataset.type].encode.disabled){let e=i.dataset[i.dataset.type].columnList.filter(l=>l.name===i.dataset[i.dataset.type].encode.disabled);e.length>0&&(this.disabledIndex=e[0].index)}},reLoadInfo(i){this.loadInfo(i)},getListInfo(i){return i.source},handleClick(i,t){let e=this,l=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(l,o=>{if(o.enabled&&o.code==e.$$global_editor.actionType.click.code){let s=e.$$global_editor.actionType.click.code+"_"+e.widgetInfo.id,h={item:t,type:i};if(o.paramsExtend&&o.paramsExtend.length>0&&this.getExtendParams(h,o.paramsExtend),o.script&&o.script.enabled){if(w.log("Execute script for "+this.widgetInfo.name+" component to "+o.name+" component"),o.script.content==""){x.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",o.script.content),h=this.customScript(h)}I.Z.$emit(s,h),o.postMessage&&this.doPostMessage(h),this.actionNameList.push(s)}})},getPosition(){let i=this.$refs.pullRefresh.scrollEl,t=this.$refs.listContent;return i.scrollTop===0?"top":i.offsetHeight+i.scrollTop===t.offsetHeight+this.widgetInfo.config.list.offsetHeight+this.widgetInfo.config.list.listItem.marginTop?"bottom":!1},touchStart(i){this.touchPoint=i.changedTouches[0].screenY},touchMove(i){let t=i.changedTouches[0].screenY-this.touchPoint;this.touchPoint=i.changedTouches[0].screenY;let e=this.getPosition();e==="top"&&t<0&&i.stopPropagation(),e==="bottom"&&t>0&&i.stopPropagation(),e||i.stopPropagation()},touchEnd(){},selectInput(i){this.widgetInfo.config.list.selectType==="single"?this.radioValue=i:this.checkBoxList=i},valueChange(){if(!this.widgetInfo.config.list.selectType||this.widgetInfo.config.list.selectType==="none")return;let i=this,t=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(t,e=>{if(e.enabled&&e.code==i.$$global_editor.actionType.change.code){let l=i.$$global_editor.actionType.change.code+"_"+i.widgetInfo.id,o={value:this.widgetInfo.config.list.selectType==="single"?this.radioValue:this.checkBoxList};if(e.paramsExtend&&e.paramsExtend.length>0&&this.getExtendParams(o,e.paramsExtend),e.script&&e.script.enabled){if(w.log("Execute script for "+this.widgetInfo.name+" component to "+e.name+" component"),e.script.content==""){x.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",e.script.content),o=this.customScript(o)}I.Z.$emit(l,o),e.postMessage&&this.doPostMessage(o),this.actionNameList.push(l)}})}}},Y=z,K=a(68141),X=(0,K.Z)(Y,m,u,!1,null,"0117da67",null),Q=X.exports}}]);
