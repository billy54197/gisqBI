"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[74482],{752246:function(O,f,o){o.d(f,{X:function(){return h},b:function(){return u}});let h={versions:function(){var l=navigator.userAgent;return{trident:l.indexOf("Trident")>-1,presto:l.indexOf("Presto")>-1,webKit:l.indexOf("AppleWebKit")>-1,gecko:l.indexOf("Gecko")>-1&&l.indexOf("KHTML")==-1,mobile:!!l.match(/AppleWebKit.*Mobile.*/),ios:!!l.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:l.indexOf("Android")>-1,iPhone:l.indexOf("iPhone")>-1,iPad:l.indexOf("iPad")>-1,webApp:l.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},u;h.versions.mobile||h.versions.ios||h.versions.android||h.versions.iPhone||h.versions.iPad?u=!1:u=!0},874482:function(O,f,o){o.r(f),o.d(f,{default:function(){return N}});var h=function(){var a=this,t=a._self._c;return t("div",{style:{width:a.widgetInfo.attr.w+"px",height:a.widgetInfo.attr.hh+"px",overflow:"hidden"}},[t("hide-button",{attrs:{attr:a.widgetInfo.attr}}),t("div",{ref:"heatmapCartesian",style:{width:a.widgetInfo.attr.w+"px",height:a.widgetInfo.attr.hh+"px"}})],1)},u=[],l=o(844513),y=o(927966),b=o(349385),I=o(445061),w=o(126711),S=o(99349),m=o(555616),s=o(275770),g=o(149500);const A=o(954255);var C={name:"heatmap-cartesian",props:["widgetInfo"],mixins:[I.u,w.H,S.P,b.baseConfig],components:{HideButton:l.Z},data(){return{}},mounted(){this.echarts=A.init(this.$refs.heatmapCartesian,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{initAction(e){this.actionSendout(e),this.actionReceive(e)},loadInfo(e){let a=[],t={},i={},n=e.dataset[e.dataset.type];if(a=this.sourceInit(n.source,n.dimensions,n.encode,n.xAxis,n.yAxis),t=JSON.parse(JSON.stringify(n.xAxis)),i=JSON.parse(JSON.stringify(n.yAxis)),t.data=t.dataEdit,i.data=i.dataEdit,!t.data||!i.data)return;t=this.getxAxis(t),i=this.getyAxis(i);let d=this.getTitle(e.config.title),p=this.getGrid(e.config.grid),x=this.getTooltip(e.config.tooltip),v=JSON.parse(JSON.stringify(e.config.toolbox)),c=JSON.parse(JSON.stringify(e.config));c.series.label=this.getLabelStyle(c.series.label),c.series.tooltip=this.getTooltip(e.config.series.tooltip),c.series.name=this.getDataName(e);let r=e.dataset[e.dataset.type].encode;e.config.visualMap.visualMapMin=="dataMin"&&(c.visualMap.min=this.getVisualmapData(e,r.data)[0]),e.config.visualMap.visualMapMax=="dataMax"&&(c.visualMap.max=this.getVisualmapData(e,r.data)[1]);let P={title:d,grid:p,tooltip:x,toolbox:v,xAxis:t,yAxis:i,visualMap:c.visualMap,series:[c.series],dataset:{source:a}};this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(P,{notMerge:!0})},getDataName(e){let a=-1,t="";for(let i=0;i<e.dataset[e.dataset.type].dimensions.length;i++)e.dataset[e.dataset.type].dimensions[i]===e.dataset[e.dataset.type].encode.data&&(a=i);return a>-1&&(t=e.dataset[e.dataset.type].dimensionsAlias[a].alias),t},reLoadInfo(e){e&&(this.$refs.heatmapCartesian.style.width=e.attr.w+"px",this.$refs.heatmapCartesian.style.height=e.attr.h+"px"),this.loadInfo(e),this.echarts.resize()},sourceInit(e,a,t,i,n){let d=JSON.parse(JSON.stringify(e)),p=[],x,v,c;for(let r=0;r<a.length;r++)a[r]===t.x&&(x=r),a[r]===t.y&&(v=r),a[r]===t.data&&(c=r);for(let r=0;r<e.length;r++)p[r]=[d[r][x],d[r][v],Number(d[r][c])];return p=this.changeSourceType(p,i,n),p},changeSourceType(e,a,t){let i=JSON.parse(JSON.stringify(e));for(let n=0;n<e.length;n++)if(a.data){for(let d=0;d<a.data.length;d++)e[n][0]==a.data[d]&&(i[n][0]=d);for(let d=0;d<t.data.length;d++)e[n][1]==t.data[d]&&(i[n][1]=d)}return i},numToData(e,a){let t="";for(let i=0;i<a.length;i++)e==i&&(t=a[i]);return t},actionSendout(e){let a=this;this.$$lib__.each(e.action.sendOut.actionList,t=>{if(t.enabled){let i=t.code+"_"+e.id;if(t.paramsExtend&&t.paramsExtend.length>0){let n={};this.getParamsExtend(n,t.paramsExtend,e)}t.code==s.default.click.code&&a.onClick(i,t)}})},onClick(e,a){let t=this;t.echarts.on("click",i=>{let n={};if(t.widgetInfo.dataset.type==t.$$global_editor.dataSourcType.static.code)n.x=t.numToData(i.data[0],t.widgetInfo.dataset.static.xAxis.data),n.y=t.numToData(i.data[1],t.widgetInfo.dataset.static.yAxis.data);else{let p=t.widgetInfo.dataset[t.widgetInfo.dataset.type].source[i.dataIndex],x=t.widgetInfo.dataset[t.widgetInfo.dataset.type].dimensions;for(var d in n)n[d]=p[x.indexOf(d)];n.x=t.numToData(i.data[0],t.widgetInfo.dataset[t.widgetInfo.dataset.type].xAxis.data),n.y=t.numToData(i.data[1],t.widgetInfo.dataset[t.widgetInfo.dataset.type].yAxis.data)}if(n.val=i.data[2],a.script&&a.script.enabled){if(g.log("Execute script for "+t.widgetInfo.name+" component to "+a.name+" component"),a.script.content==""){m.Message.warning({message:a.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",a.script.content),n=this.customScript(n)}y.Z.$emit(e,n),a.postMessage&&t.doPostMessage(n),t.actionNameList.push(e)})}}},H=C,M=o(768141),T=(0,M.Z)(H,h,u,!1,null,"1fd16914",null),N=T.exports},844513:function(O,f,o){o.d(f,{Z:function(){return S}});var h=function(){var s=this,g=s._self._c;return s.attr.buttonHide?g("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(A){return s.onHide()}}},[s.openTooltip?g("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[g("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):g("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},u=[],l=o(752246),y={props:["attr"],name:"hide-button",data(){return{isPc:l.b}},computed:{openTooltip:function(){let m=!1,s=this.attr.buttonHideTooltipContent;return l.b&&s&&s!=null&&s.trim()!=""&&(m=!0),m}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},b=y,I=o(768141),w=(0,I.Z)(b,h,u,!1,null,"bf399b9a",null),S=w.exports}}]);
