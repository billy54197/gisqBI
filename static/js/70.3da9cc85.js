"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[70],{56279:function(L,u,n){n.d(u,{P:function(){return v}});var w=n(86892),f=n(49500);const v={mixins:[w.D],created(){},methods:{lifecycleBeforeChartsLoad(m){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&f.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let p=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[m]);if(p)return p}return m},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&f.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},20070:function(L,u,n){n.r(u),n.d(u,{default:function(){return V}});var w=function(){var i=this,e=i._self._c;return e("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:i.widgetInfo.attr}}),e("div",{ref:"sunburstsimple",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},f=[],v=n(44513),m=n(27966),O=n(58608),p=n(56279),N=n(45061),A=n(26711),E=n(99349),J=n(55616),P=n(75770),F=n(67157),y=n(50666),K=n(25251);const $={mixins:[F.c],data(){return{config_extend:{config:{series:{itemStyle:{borderColor:"#E09900"},label:{color:"#0F151D"}}}},filter_config:{title:JSON.parse(JSON.stringify(y.Z.charts.title)),legend:JSON.parse(JSON.stringify(y.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(y.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(y.Z.charts.toolbox)),color:["#4C84FF"],series:{itemStyle:{type:"pureColor",pureColor:"rgba(30, 144, 255, 1)",opacity:1,gradation:{},borderColor:"#EDEEF0"},label:{color:"#0F151D"},emphasis:{itemStyle:{colorInfo:{type:"pureColor",pureColor:"",gradation:{}},opacity:1}}}}}},methods:{filterPredefineColoursSchemeConfig(t,i){this.getNewConfigWithArrary(t,i,this.filter_config)}}};var D=n(49500);const Z=n(29426);var M={name:"SunburstSimple",components:{HideButton:v.Z},mixins:[O.u,E.P,p.P,N.u,A.H,$],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=Z.init(this.$refs.sunburstsimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let i=[],e=[],o=[],s=[],a=[];i=t.dataset[t.dataset.type].source,e=t.dataset[t.dataset.type].dimensions,o=t.dataset[t.dataset.type].dimensionsAlias,s=t.dataset[t.dataset.type].encode,a=t.dataset[t.dataset.type].encodeList.custom,this.dimensionsEx=e,this.dimensionsAliasEx=o;let d=-1,r=e.length;for(let c=0;c<r;c++)e[c]==s.x&&(d=c);let S=new Array(a.length);for(let c=0;c<a.length;c++)for(let I=0;I<r;I++)e[I]===a[c].model&&(S[c]=I);let g=this.createTree(i,S),x=this.iterator_self(g,[],d,r),b=JSON.parse(JSON.stringify(t.config.title)),H=JSON.parse(JSON.stringify(t.config.toolbox)),h=JSON.parse(JSON.stringify(t.config.grid)),l=JSON.parse(JSON.stringify(t.config.series)),z=JSON.parse(JSON.stringify(t.config.color));l.name||(l.name=this.getLegendData(o,s)),l.itemStyle&&l.itemStyle.colorInfo&&(l.itemStyle.color=this.getColorInfo(l.itemStyle.colorInfo)),l.emphasis.itemStyle&&l.emphasis.itemStyle.colorInfo&&(l.emphasis.itemStyle.color=this.getColorInfo(l.emphasis.itemStyle.colorInfo));let C={color:z,title:b,toolbox:H,grid:{left:h.left+"%",right:h.right+"%",top:h.top+"%",bottom:h.bottom+"%",dx:h.dx+"%",dy:h.dy+"%"},series:{radius:[l.radius.in+"%",l.radius.out+"%"],type:"sunburst",sort:l.sort,highlightPolicy:l.highlightPolicy,data:x,label:l.label,levels:[],itemStyle:l.itemStyle,emphasis:{label:l.emphasis.label,itemStyle:l.emphasis.itemStyle}}};this.getAnimation(C,t),this.setOption(C),this.setAnimationLoop(t,()=>{this.setOption(C,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},reLoadInfo(t){t&&(this.$refs.sunburstsimple.style.width=t.attr.w+"px",this.$refs.sunburstsimple.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,i){let e=this.$$lib__.find(t,o=>o.name==i.y);return e?e.alias&&e.alias!=""?e.alias:e.name:""},createTree(t,i){function e(o,s,a,d){for(let r=0;r<o.length;r++){if(d>=a.length)return(Array.isArray(s)?s:[]).concat(o[r]);let S=a[d],g=o[r][S],x=s[g]?s[g]:{};s[g]=e([o[r]],x,a,d+1)}return s}return e(t,{},i,0)},iterator_self(t,i,e,o){if(t.constructor!==Array)for(let s in t){let a=t[s].length/o,d={name:s,value:t[s].constructor===Array?parseFloat(this.addValue(t[s],e,a)):null,children:this.iterator_self(t[s],[],e,o),itemStyle:s?null:{color:"rgba(255, 255, 255, 0)"}};i.push(d)}return i},addValue(t,i,e){let o=0;for(let s=1;s<=e;s++)o+=t[(i+1)*s-1];return o},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let i=this;this.$$lib__.each(t.action.sendOut.actionList,e=>{if(e.enabled){let o=e.code+"_"+t.id;if(e.paramsExtend&&e.paramsExtend.length>0){let s={};this.getParamsExtend(s,e.paramsExtend,t)}e.code==P.Z.click.code&&i.onClick(o,e)}})},onClick(t,i){let e=this;e.echarts.on("click",o=>{let s={},a=e.getValue(o.seriesName,o.data);if(s.x=o.name,s.y=a,i.script&&i.script.enabled){if(D.log("Execute script for "+e.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){J.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",i.script.content),s=this.customScript(s)}m.Z.$emit(t,s),i.postMessage&&e.doPostMessage(s),e.actionNameList.push(t)})}}},R=M,T=n(68141),B=(0,T.Z)(R,w,f,!1,null,"f63f0cee",null),V=B.exports}}]);
