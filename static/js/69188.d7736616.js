"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[69188],{56279:function(S,b,r){r.d(b,{P:function(){return d}});var g=r(386892),h=r(149500);const d={mixins:[g.D],created(){},methods:{lifecycleBeforeChartsLoad(w){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&h.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),h.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let y=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[w]);if(y)return y}return w},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&h.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),h.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(S,b,r){r.d(b,{X:function(){return g},b:function(){return h}});let g={versions:function(){var d=navigator.userAgent;return{trident:d.indexOf("Trident")>-1,presto:d.indexOf("Presto")>-1,webKit:d.indexOf("AppleWebKit")>-1,gecko:d.indexOf("Gecko")>-1&&d.indexOf("KHTML")==-1,mobile:!!d.match(/AppleWebKit.*Mobile.*/),ios:!!d.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:d.indexOf("Android")>-1,iPhone:d.indexOf("iPhone")>-1,iPad:d.indexOf("iPad")>-1,webApp:d.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},h;g.versions.mobile||g.versions.ios||g.versions.android||g.versions.iPhone||g.versions.iPad?h=!1:h=!0},844513:function(S,b,r){r.d(b,{Z:function(){return v}});var g=function(){var c=this,I=c._self._c;return c.attr.buttonHide?I("div",{style:{position:"absolute",right:c.attr.buttonHideRight+"px",top:c.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function($){return c.onHide()}}},[c.openTooltip?I("el-tooltip",{attrs:{"open-delay":1e3,content:c.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[I("el-button",{class:c.attr.buttonHideIconClass&&c.attr.buttonHideIconClass!=""?c.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:c.attr.buttonHideColor,fontSize:c.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):I("el-button",{class:c.attr.buttonHideIconClass&&c.attr.buttonHideIconClass!=""?c.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:c.attr.buttonHideColor,fontSize:c.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):c._e()},h=[],d=r(752246),w={props:["attr"],name:"hide-button",data(){return{isPc:d.b}},computed:{openTooltip:function(){let m=!1,c=this.attr.buttonHideTooltipContent;return d.b&&c&&c!=null&&c.trim()!=""&&(m=!0),m}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},x=w,y=r(768141),_=(0,y.Z)(x,g,h,!1,null,"bf399b9a",null),v=_.exports},669188:function(S,b,r){r.r(b),r.d(b,{default:function(){return F}});var g=function(){var e=this,o=e._self._c;return o("div",{ref:"comSelect",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[o("hide-button",{attrs:{attr:e.widgetInfo.attr}}),o("div",{staticClass:"select-block",attrs:{id:"id"+e.widgetInfo.id}},[o("label",{staticClass:"select_label",style:e.labelStyle},[e._v(e._s(e.widgetInfo.config.part.label.text))]),o("el-select",{attrs:{slot:"prefix",multiple:e.widgetInfo.config.part.option.multiple,"collapse-tags":e.widgetInfo.config.part.option.collapseTags,"multiple-limit":e.widgetInfo.config.part.option.multipleLimit,"popper-class":"gisqbi-body-popper-scale popperClass"+e.widgetInfo.id,clearable:e.widgetInfo.config.part.option.clearable,filterable:e.widgetInfo.config.part.option.filterable,disabled:e.widgetInfo.config.part.option.disabled,"default-first-option":e.widgetInfo.config.part.option.defaultFirstOption,placeholder:e.widgetInfo.config.part.option.placeholder},on:{"visible-change":e.visibleChange,change:function(n){return e.change()}},slot:"prefix",model:{value:e.selectKey,callback:function(n){e.selectKey=n},expression:"selectKey"}},[o("i",{class:["el-input__icon",e.widgetInfo.config.part.logo.iconClass],style:e.logoStyle,attrs:{slot:"prefix"},slot:"prefix"}),e._l(e.selectList,function(n){return o("el-option",{key:n.value,attrs:{label:n.label,value:n.value,disabled:n.disabled}},[o("el-tooltip",{attrs:{"popper-class":`gisqbi-body-popper-scale tooltip_class_${e.widgetInfo.id}`,content:n.label,placement:e.widgetInfo.config.part.option.tooltip.placement,disabled:!e.tooltipShow}},[o("span",{staticClass:"widget-com-select-content",staticStyle:{width:"100%",display:"inline-block",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},on:{mouseenter:function(l){return e.handleMouse(l)}}},[e._v(e._s(n.label))])])],1)})],2)],1)],1)},h=[],d=r(42160),w=r(321300),x=r(844513),y=r(445061),_=r(126711),v=r(56279),m=r(555616),c=r(927966),I=r(362016),$=r(148836),k=r(275770),L=r(67157);const P={mixins:[L.c],data(){return{config_extend:{config:{part:{select:{borderColor:"#DCDFE5",borderRadius:4,paddingLeft:10,textAlign:"left",color:"#616266",fontFamily:"alibabaPuHuiTiRegular",fontSize:14,background:"#ffffff"},option:{backGround:{backgroundColor:"#ffffff"}}}}},filter_config:{global:{fontFamily:"alibabaPuHuiTiRegular"},part:{label:{fontFamily:"",color:"#333"},logo:{color:"#333",background:"rgba(255,255,255,0)"},select:{borderColor:"#DCDFE5",color:"#616266",fontFamily:"alibabaPuHuiTiRegular",background:"#ffffff"},option:{background:"#0C235B",color:"#3DE0FD",fontStyle:{fontFamily:"alibabaPuHuiTiRegular",color:"#616266"},backGround:{backgroundColor:"#ffffff"}}}}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var C=r(149500),H={name:"com-select",props:["widgetInfo"],mixins:[y.u,_.H,v.P,I.baseConfig,P],components:{HideButton:x.Z},data(){return{selectKey:null,valueIndex:-1,tooltipShow:!1}},computed:{...(0,$.Se)(["getCanvasSettingInfo"]),selectList:function(){let t=this;return t.getListInfo(t.widgetInfo.dataset[t.widgetInfo.dataset.type].encode,t.widgetInfo.dataset[t.widgetInfo.dataset.type].dimensions,t.widgetInfo.dataset[t.widgetInfo.dataset.type].source)},labelStyle:function(){let t=this;return{display:t.widgetInfo.config.part.label.show?"inline-block":"none",width:this.mUtils.getNewPxW(t.widgetInfo.config.part.label.width)+"px",height:this.mUtils.getNewPxH(t.widgetInfo.config.part.label.height)+"px",fontSize:this.mUtils.getNewFontSize(t.widgetInfo.config.part.label.fontSize)+"px",fontFamily:t.widgetInfo.config.part.label.fontFamily,color:t.widgetInfo.config.part.label.color,textAlign:t.widgetInfo.config.part.label.textAlign}},logoStyle:function(){let t=this;return this.$nextTick(()=>{this.$refs.comSelect&&this.$refs.comSelect.querySelector(".el-select__caret.el-input__icon.el-icon-arrow-up")&&(this.$refs.comSelect.querySelector(".el-select__caret.el-input__icon.el-icon-arrow-up").style.lineHeight=this.mUtils.getNewPxH(t.widgetInfo.config.part.select.height-2)+"px")}),{display:t.widgetInfo.config.part.logo.show?"inline-block":"none",width:this.mUtils.getNewPxW(t.widgetInfo.config.part.logo.width)+"px",height:this.mUtils.getNewPxH(t.widgetInfo.config.part.select.height-2)+"px",lineHeight:this.mUtils.getNewPxH(t.widgetInfo.config.part.select.height-2)+"px",fontSize:this.mUtils.getNewFontSize(t.widgetInfo.config.part.logo.fontSize)+"px",color:t.widgetInfo.config.part.logo.color,background:t.widgetInfo.config.part.logo.background,borderTopLeftRadius:t.widgetInfo.config.part.select.borderRadius+"px",borderBottomLeftRadius:t.widgetInfo.config.part.select.borderRadius+"px"}},canvasSetting(){return this.getCanvasSettingInfo}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{loadInfo(t){if(this.setStyle(t),this.selectKey=this.getSelectKey(),this.widgetInfo.config.part.option.tooltip&&this.widgetInfo.config.part.option.tooltip.enabled==!0){let e=JSON.parse(JSON.stringify(this.widgetInfo.config.part.option.tooltip)),o=e.backGround.backgroundColor?e.backGround.backgroundColor:"#333",n=this.getImageUrl(e.backGround.backgroundImage),l="",i="";e.backGround.backgroundSize=="auto"&&(l="auto"),e.backGround.backgroundSize=="contain-no-repeat"&&(l="contain",i="no-repeat"),e.backGround.backgroundSize=="contain"&&(l="contain",i="repeat"),e.backGround.backgroundSize=="cover"&&(l="cover"),e.backGround.backgroundSize=="100% 100%"&&(l="100% 100%"),this.mUtils.appendCss(`tooltipClass_${this.widgetInfo.id}`,`
                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id} {
                        background-color: ${o};
                        background-image: ${n};
                        background-size: ${l};
                        background-repeat: ${i};
                        color: ${e.fontStyle.color?e.fontStyle.color:"#fff"};
                        font-family: ${e.fontStyle.fontFamily};
                        font-weight: ${e.fontStyle.fontWeight};
                        font-style: ${e.fontStyle.fontStyle};
                        font-size: ${e.fontStyle.fontSize+"px"};
                    }

                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=right]  .popper__arrow,
                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=right]  .popper__arrow::after {
                        border-right-color: ${o};
                    }

                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=left]  .popper__arrow,
                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=left]  .popper__arrow::after {
                        border-left-color: ${o};
                    }

                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=top]  .popper__arrow,
                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=top]  .popper__arrow::after {
                        border-top-color: ${o};
                    }

                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=bottom]  .popper__arrow,
                    .el-tooltip__popper.tooltip_class_${this.widgetInfo.id}[x-placement^=bottom]  .popper__arrow::after {
                        border-bottom-color: ${o};
                    }`)}this.lifecycleAfterLoad(),this.initSendChangeValue("loadInfo")},visibleChange(t){t&&setTimeout(()=>{this.setStyle(this.widgetInfo)},5)},resize(){this.setStyle(this.widgetInfo)},setStyle(t){let e=document.querySelector("#id"+t.id+">.el-select>.el-input>input"),o=document.querySelector(".popperClass"+t.id),n=document.querySelector(".popperClass"+t.id+">.el-scrollbar>.el-select-dropdown__wrap"),l=document.querySelector(".popperClass"+t.id+">.el-scrollbar>.el-select-dropdown__wrap>.el-scrollbar__view"),i=t.config.part.select,a=t.config.part.option;e.style.width=this.mUtils.getNewPxW(i.width)+"px",e.style.height=this.mUtils.getNewPxH(i.height)+"px",e.style.paddingLeft=t.config.part.logo.show?this.mUtils.getNewPxW(t.config.part.logo.width+t.config.part.select.paddingLeft)+"px":this.mUtils.getNewPxW(t.config.part.select.paddingLeft)+"px",e.style.color=i.color,e.style.fontSize=this.mUtils.getNewFontSize(i.fontSize)+"px",e.style.fontFamily=i.fontFamily,e.style.textAlign=i.textAlign,e.style.borderRadius=i.borderRadius+"px",e.style.background=i.background,e.style.borderColor=i.borderColor,e.style.borderWidth=`${i.borderTop}px ${i.borderRight}px ${i.borderBottom}px ${i.borderLeft}px`,n.style.maxHeight=this.mUtils.getNewPxH(i.maxHeight)+"px",o.setAttribute("class",o.className+" widget_select"),o.style.width=this.mUtils.getNewPxW(i.width)+"px",o.style.minWidth=this.mUtils.getNewPxW(i.width)+"px";let s=o.getAttribute("style");s=s+"border-color: "+(a.backGround.backgroundColor||"#fff")+"!important;",s=s+"background-color: "+(a.backGround.backgroundColor||"#fff")+"!important;",o.setAttribute("style",s),o.style.backgroundImage=this.getImageUrl(a.backGround.backgroundImage),o.style.backgroundSize=a.backGround.backgroundSize;let p=o.querySelector(".popper__arrow");if(p){let f=p.getAttribute("style");f=f+"border-bottom-color: "+(a.backGround.backgroundColor||"#fff")+"!important;",p.setAttribute("style",f)}let u=o.querySelector(".popper__arrow:after");if(u){let f=u.getAttribute("style");f=f+"border-bottom-color: "+(a.backGround.backgroundColor||"#fff")+"!importantborder-top-color: "+(a.backGround.backgroundColor||"#fff")+"!important",u.setAttribute("style",f)}this.$$lib__.each(l.childNodes,f=>{f.style&&(f.style.color=a.fontStyle.color||"#000",f.style.fontFamily=a.fontStyle.fontFamily,f.style.fontWeight=a.fontStyle.fontWeight,f.style.fontStyle=a.fontStyle.fontStyle,f.style.fontSize=this.mUtils.getNewFontSize(a.fontStyle.fontSize)+"px",f.style.backgroundColor="transparent")})},getGlobalParams(t){let e;return this.$$lib__.each(this.canvasSetting.data.globalParams.params,(o,n)=>{t.split("globalParams_")[1]==n&&(e=o)}),e},getSelectKey(){let t=null,e=this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode.defaultValType,o=this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode.defaultVal,n=this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode.defaultFirst,l=this.widgetInfo.dataset[this.widgetInfo.dataset.type].encode.defaultParams;this.selectList.length>0&&(e=="static"&&o&&o!=""?t=o:(e=="dynamic"||e=="local")&&l&&l!=""?t=this.getGlobalParams(l):e=="first"&&n&&(t=this.selectList[0].value));let i=null;return this.widgetInfo.config.part.option.multiple?(i=[],t&&t.split(",").length>1?i=t.split(","):t&&i.push(t)):t&&t.split(",").length>1?i=t.split(",")[0]:i=t,i},reLoadInfo(t){this.loadInfo(t),this.initSendChangeValue("reLoadInfo")},initSendChangeValue(t){let e=this.$$lib__.find(this.widgetInfo.action.sendOut.actionList,o=>o.code==k.default.change.code);if(e&&e.initSend==!0){let o=!1;t=="loadInfo"?o=this.widgetInfo.dataset.type=="static":t=="reLoadInfo"&&(o=this.widgetInfo.dataset.type!="static"),o&&setTimeout(()=>{this.change()},100)}},initAction(t){this.actionReceive(t),this.actionReceiveReplaceSelect(t)},actionReceiveReplaceSelect(t){t.action&&t.action.receive&&t.action.receive.replaceSelectVal&&t.action.receive.replaceSelectVal.enabled&&this.replaceSelect(t.action.receive.replaceSelectVal.replaceList,t)},replaceSelect(t,e){let o=this,n={};if(this.$$lib__.each(t,l=>{let i=l[0][1]+"_"+l[0][0];l[0][1].indexOf("_")>-1&&(i=l[0][1]);let a=l[0][2],s=a.indexOf("|");s>-1&&(a=l[0][2].substring(s+1)),n[i]||d.default.set(n,i,{}),n[i][a]||d.default.set(n[i],a,a)}),!this.$$lib__.isEmpty(n))for(let l in n)c.Z.$on(l,i=>{let a=!0,s=!1;if(e.action.receive.replaceSelectVal.script&&e.action.receive.replaceSelectVal.script.enabled){if(s=!0,C.log("Execute script for "+e.name+" component to replace dataset parameters"),e.action.receive.replaceSelectVal.script.content==""){m.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60}),a=!1;return}this.doActionRepSelectVal=new Function("param","selectList","param_key","multiple",e.action.receive.replaceSelectVal.script.content)}if(a){let p=this.doActionRepSelectVal(i,o.selectList,n[l],e.config.part.option.multiple);o.selectKey=p,s&&C.log("Replace data set parameter of "+e.name+" component Script execution complete")}})},doActionRepSelectVal(t,e,o,n){let l=[];for(let i in o)for(let a in t)o[i]==a&&this.$$lib__.each(e,s=>{if(Array.isArray(t[a]))for(let p=0;p<t[a].length;p++)t[a][p]==s.value&&l.push(t[a][p]);else t[a]==s.value&&l.push(t[a])});return n?l:l[0]},getListInfo(t,e,o){let n=-1,l=-1,i=-1,a=[];for(let s=0;s<e.length;s++)e[s]==t.label&&(l=s),e[s]==t.value&&(n=s),e[s]==t.disabled&&(i=s);if(n>-1&&l>-1){this.valueIndex=n;for(let s=0;s<o.length;s++){this.valueIndex=n;for(let p=0;p<o.length;p++){let u={};for(let f=0;f<e.length;f++)u[e[f]]=o[p][f];u.label=o[p][l],u.value=o[p][n],u.disabled=o[p][i],a[p]=u}}}return a},change(){if(this.widgetInfo.config.part.option.multiple&&this.selectKey.length>0){let t=this.$refs.comSelect.children[0].children[1].children;for(let e=0;e<t.length;e++)t[e].className=="el-select__tags"&&(t[e].style.top=this.mUtils.getNewPxH(this.widgetInfo.config.part.select.height/2)+"px")}this.onClick()},onClick(){let t=this,e=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(e,o=>{if(o.enabled&&o.code==k.default.change.code){let n=o.code+"_"+t.widgetInfo.id,l={value:JSON.parse(JSON.stringify(this.selectKey))};if(o.paramsExtend&&o.paramsExtend.length>0&&this.$$lib__.each(o.paramsExtend,i=>{if(i.type==this.$$global_editor.dataSourcType.static.code&&i.fieldS&&i.fieldS!="")d.default.set(l,i.fieldS,i.value);else if((i.type==this.$$global_editor.dataSourcType.dynamic.code||i.type==this.$$global_editor.dataSourcType.local.code)&&i.fieldD!=""){let a=this.getDynamicVal(i.fieldD);d.default.set(l,i.fieldD,a)}}),o.script&&o.script.enabled){if(C.log("Execute script for "+this.widgetInfo.name+" component to "+o.name+" component"),o.script.content==""){m.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}t.customScript=new Function("param",o.script.content),l=t.customScript(l)}c.Z.$emit(n,l),o.postMessage&&this.doPostMessage(l),this.actionNameList.push(n)}})},getDynamicVal(t){if(this.valueIndex<0)return null;let e=null;if(!this.$$lib__.isArray(this.selectKey))e=this.getVal(this.selectKey,t);else{e=[];for(let o=0;o<this.selectKey.length;o++)e.push(this.getVal(this.selectKey[o],t))}return e},getVal(t,e){let o=this,n=null;if(o.widgetInfo.dataset[o.widgetInfo.dataset.type].source&&o.widgetInfo.dataset[o.widgetInfo.dataset.type].source.length>0){let l=o.$$lib__.find(o.widgetInfo.dataset[o.widgetInfo.dataset.type].source,i=>i[o.valueIndex]==t);l&&(n=this.getFieldVal(l,o.widgetInfo.dataset[o.widgetInfo.dataset.type].dimensions,e))}return n},getImageUrl(t){return t&&t!==""?"url("+w.appendImageBaseURL(t)+")":null},getValue(){return this.selectKey},handleMouse(t){this.widgetInfo.config.part.option.tooltip.enabled==!0&&(this.tooltipShow=this.isBeyond(t))},isBeyond(t){const e=window.event||t;return(n=>{const l=n,i=l.getBoundingClientRect().width,a=document.createRange();return a.setStart(l,0),a.setEnd(l,l.childNodes.length),a.getBoundingClientRect().width>i})(e.target)}}},z=H,N=r(768141),R=(0,N.Z)(z,g,h,!1,null,"73aef3f1",null),F=R.exports}}]);
