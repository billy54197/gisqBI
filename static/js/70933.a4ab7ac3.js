"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[70933],{320300:function(m,x,a){var w=a(456906);m.exports=function(b){b=b||{};var c=b.reporter,q=w.getOption(b,"async",!0),O=w.getOption(b,"auto",!0);O&&!q&&(c&&c.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),q=!0);var T=C(),$,n=!1;function l(y,k){!n&&O&&q&&T.size()===0&&_(),T.add(y,k)}function d(){for(n=!0;T.size();){var y=T;T=C(),y.process()}n=!1}function u(y){n||(y===void 0&&(y=q),$&&(p($),$=null),y?_():d())}function _(){$=I(d)}function v(){T={},batchSize=0,topLevel=0,bottomLevel=0}function p(y){var k=clearTimeout;return k(y)}function I(y){var k=function(L){return setTimeout(L,0)};return k(y)}return{add:l,force:u}};function C(){var f={},b=0,c=0,q=0;function O(n,l){l||(l=n,n=0),n>c?c=n:n<q&&(q=n),f[n]||(f[n]=[]),f[n].push(l),b++}function T(){for(var n=q;n<=c;n++)for(var l=f[n],d=0;d<l.length;d++){var u=l[d];u()}}function $(){return b}return{add:O,process:T,size:$}}},456906:function(m){var x=m.exports={};x.getOption=a;function a(w,C,f){var b=w[C];return b==null&&f!==void 0?f:b}},883415:function(m){var x=m.exports={};x.isIE=function(a){function w(){var f=navigator.userAgent.toLowerCase();return f.indexOf("msie")!==-1||f.indexOf("trident")!==-1||f.indexOf(" edge/")!==-1}if(!w())return!1;if(!a)return!0;var C=function(){var f,b=3,c=document.createElement("div"),q=c.getElementsByTagName("i");do c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->";while(q[0]);return b>4?b:f}();return a===C},x.isLegacyOpera=function(){return!!window.opera}},577135:function(m){var x=m.exports={};x.forEach=function(a,w){for(var C=0;C<a.length;C++){var f=w(a[C]);if(f)return f}}},164730:function(m,x,a){var w=a(883415);m.exports=function(C){C=C||{};var f=C.reporter,b=C.batchProcessor,c=C.stateHandler.getState;if(!f)throw new Error("Missing required dependency: reporter.");function q(l,d){function u(){d(l)}if(w.isIE(8))c(l).object={proxy:u},l.attachEvent("onresize",u);else{var _=$(l);if(!_)throw new Error("Element is not detectable by this strategy.");_.contentDocument.defaultView.addEventListener("resize",u)}}function O(l){var d=C.important?" !important; ":"; ";return(l.join(d)+d).trim()}function T(l,d,u){u||(u=d,d=l,l=null),l=l||{};var _=l.debug;function v(p,I){var y=O(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),k=!1,L=window.getComputedStyle(p),oe=p.offsetWidth,H=p.offsetHeight;c(p).startSize={width:oe,height:H};function E(){function g(){if(L.position==="static"){p.style.setProperty("position","relative",l.important?"important":"");var R=function(Q,j,K,A){function se(V){return V.replace(/[^-\d\.]/g,"")}var ae=K[A];ae!=="auto"&&se(ae)!=="0"&&(Q.warn("An element that is positioned static has style."+A+"="+ae+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+A+" will be set to 0. Element: ",j),j.style.setProperty(A,"0",l.important?"important":""))};R(f,p,L,"top"),R(f,p,L,"right"),R(f,p,L,"bottom"),R(f,p,L,"left")}}function z(){k||g();function R(j,K){if(!j.contentDocument){var A=c(j);A.checkForObjectDocumentTimeoutId&&window.clearTimeout(A.checkForObjectDocumentTimeoutId),A.checkForObjectDocumentTimeoutId=setTimeout(function(){A.checkForObjectDocumentTimeoutId=0,R(j,K)},100);return}K(j.contentDocument)}var Q=this;R(Q,function(K){I(p)})}L.position!==""&&(g(L),k=!0);var D=document.createElement("object");D.style.cssText=y,D.tabIndex=-1,D.type="text/html",D.setAttribute("aria-hidden","true"),D.onload=z,w.isIE()||(D.data="about:blank"),c(p)&&(p.appendChild(D),c(p).object=D,w.isIE()&&(D.data="about:blank"))}b?b.add(E):E()}w.isIE(8)?u(d):v(d,u)}function $(l){return c(l).object}function n(l){if(c(l)){var d=$(l);d&&(w.isIE(8)?l.detachEvent("onresize",d.proxy):l.removeChild(d),c(l).checkForObjectDocumentTimeoutId&&window.clearTimeout(c(l).checkForObjectDocumentTimeoutId),delete c(l).object)}}return{makeDetectable:T,addListener:q,uninstall:n}}},172446:function(m,x,a){var w=a(577135).forEach;m.exports=function(C){C=C||{};var f=C.reporter,b=C.batchProcessor,c=C.stateHandler.getState,q=C.stateHandler.hasState,O=C.idHandler;if(!b)throw new Error("Missing required dependency: batchProcessor");if(!f)throw new Error("Missing required dependency: reporter.");var T=u(),$="erd_scroll_detection_scrollbar_style",n="erd_scroll_detection_container";function l(E){_(E,$,n)}l(window.document);function d(E){var g=C.important?" !important; ":"; ";return(E.join(g)+g).trim()}function u(){var E=500,g=500,z=document.createElement("div");z.style.cssText=d(["position: absolute","width: "+E*2+"px","height: "+g*2+"px","visibility: hidden","margin: 0","padding: 0"]);var D=document.createElement("div");D.style.cssText=d(["position: absolute","width: "+E+"px","height: "+g+"px","overflow: scroll","visibility: none","top: "+-E*3+"px","left: "+-g*3+"px","visibility: hidden","margin: 0","padding: 0"]),D.appendChild(z),document.body.insertBefore(D,document.body.firstChild);var R=E-D.clientWidth,Q=g-D.clientHeight;return document.body.removeChild(D),{width:R,height:Q}}function _(E,g,z){function D(K,A){A=A||function(ae){E.head.appendChild(ae)};var se=E.createElement("style");return se.innerHTML=K,se.id=g,A(se),se}if(!E.getElementById(g)){var R=z+"_animation",Q=z+"_animation_active",j=`/* Created by the element-resize-detector library. */
`;j+="."+z+" > div::-webkit-scrollbar { "+d(["display: none"])+` }

`,j+="."+Q+" { "+d(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+R,"animation-name: "+R])+` }
`,j+="@-webkit-keyframes "+R+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,j+="@keyframes "+R+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",D(j)}}function v(E){E.className+=" "+n+"_animation_active"}function p(E,g,z){if(E.addEventListener)E.addEventListener(g,z);else if(E.attachEvent)E.attachEvent("on"+g,z);else return f.error("[scroll] Don't know how to add event listeners.")}function I(E,g,z){if(E.removeEventListener)E.removeEventListener(g,z);else if(E.detachEvent)E.detachEvent("on"+g,z);else return f.error("[scroll] Don't know how to remove event listeners.")}function y(E){return c(E).container.childNodes[0].childNodes[0].childNodes[0]}function k(E){return c(E).container.childNodes[0].childNodes[0].childNodes[1]}function L(E,g){var z=c(E).listeners;if(!z.push)throw new Error("Cannot add listener to an element that is not detectable.");c(E).listeners.push(g)}function oe(E,g,z){z||(z=g,g=E,E=null),E=E||{};function D(){if(E.debug){var S=Array.prototype.slice.call(arguments);if(S.unshift(O.get(g),"Scroll: "),f.log.apply)f.log.apply(null,S);else for(var F=0;F<S.length;F++)f.log(S[F])}}function R(S){function F(J){return J===J.ownerDocument.body||J.ownerDocument.body.contains(J)}return!F(S)||window.getComputedStyle(S)===null}function Q(S){var F=c(S).container.childNodes[0],J=window.getComputedStyle(F);return!J.width||J.width.indexOf("px")===-1}function j(){var S=window.getComputedStyle(g),F={};return F.position=S.position,F.width=g.offsetWidth,F.height=g.offsetHeight,F.top=S.top,F.right=S.right,F.bottom=S.bottom,F.left=S.left,F.widthCSS=S.width,F.heightCSS=S.height,F}function K(){var S=j();c(g).startSize={width:S.width,height:S.height},D("Element start size",c(g).startSize)}function A(){c(g).listeners=[]}function se(){if(D("storeStyle invoked."),!c(g)){D("Aborting because element has been uninstalled");return}var S=j();c(g).style=S}function ae(S,F,J){c(S).lastWidth=F,c(S).lastHeight=J}function V(S){return y(S).childNodes[0]}function W(){return 2*T.width+1}function ue(){return 2*T.height+1}function $e(S){return S+10+W()}function ve(S){return S+10+ue()}function _e(S){return S*2+W()}function ye(S){return S*2+ue()}function Ce(S,F,J){var le=y(S),be=k(S),me=$e(F),xe=ve(J),X=_e(F),P=ye(J);le.scrollLeft=me,le.scrollTop=xe,be.scrollLeft=X,be.scrollTop=P}function re(){var S=c(g).container;if(!S){S=document.createElement("div"),S.className=n,S.style.cssText=d(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),c(g).container=S,v(S),g.appendChild(S);var F=function(){c(g).onRendered&&c(g).onRendered()};p(S,"animationstart",F),c(g).onAnimationStart=F}return S}function ge(){function S(){var de=c(g).style;if(de.position==="static"){g.style.setProperty("position","relative",E.important?"important":"");var he=function(Ie,we,ne,Ee){function ze(Ne){return Ne.replace(/[^-\d\.]/g,"")}var Oe=ne[Ee];Oe!=="auto"&&ze(Oe)!=="0"&&(Ie.warn("An element that is positioned static has style."+Ee+"="+Oe+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Ee+" will be set to 0. Element: ",we),we.style[Ee]=0)};he(f,g,de,"top"),he(f,g,de,"right"),he(f,g,de,"bottom"),he(f,g,de,"left")}}function F(de,he,Ie,we){return de=de?de+"px":"0",he=he?he+"px":"0",Ie=Ie?Ie+"px":"0",we=we?we+"px":"0",["left: "+de,"top: "+he,"right: "+we,"bottom: "+Ie]}if(D("Injecting elements"),!c(g)){D("Aborting because element has been uninstalled");return}S();var J=c(g).container;J||(J=re());var le=T.width,be=T.height,me=d(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),xe=d(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(F(-(1+le),-(1+be),-be,-le))),X=d(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),P=d(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),te=d(["position: absolute","left: 0","top: 0"]),pe=d(["position: absolute","width: 200%","height: 200%"]),ce=document.createElement("div"),fe=document.createElement("div"),Se=document.createElement("div"),N=document.createElement("div"),De=document.createElement("div"),Le=document.createElement("div");ce.dir="ltr",ce.style.cssText=me,ce.className=n,fe.className=n,fe.style.cssText=xe,Se.style.cssText=X,N.style.cssText=te,De.style.cssText=P,Le.style.cssText=pe,Se.appendChild(N),De.appendChild(Le),fe.appendChild(Se),fe.appendChild(De),ce.appendChild(fe),J.appendChild(ce);function Fe(){c(g).onExpand&&c(g).onExpand()}function Pe(){c(g).onShrink&&c(g).onShrink()}p(Se,"scroll",Fe),p(De,"scroll",Pe),c(g).onExpandScroll=Fe,c(g).onShrinkScroll=Pe}function Z(){function S(X,P,te){var pe=V(X),ce=$e(P),fe=ve(te);pe.style.setProperty("width",ce+"px",E.important?"important":""),pe.style.setProperty("height",fe+"px",E.important?"important":"")}function F(X){var P=g.offsetWidth,te=g.offsetHeight,pe=P!==c(g).lastWidth||te!==c(g).lastHeight;D("Storing current size",P,te),ae(g,P,te),b.add(0,function(){if(pe){if(!c(g)){D("Aborting because element has been uninstalled");return}if(!J()){D("Aborting because element container has not been initialized");return}if(E.debug){var fe=g.offsetWidth,Se=g.offsetHeight;(fe!==P||Se!==te)&&f.warn(O.get(g),"Scroll: Size changed before updating detector elements.")}S(g,P,te)}}),b.add(1,function(){if(!c(g)){D("Aborting because element has been uninstalled");return}if(!J()){D("Aborting because element container has not been initialized");return}Ce(g,P,te)}),pe&&X&&b.add(2,function(){if(!c(g)){D("Aborting because element has been uninstalled");return}if(!J()){D("Aborting because element container has not been initialized");return}X()})}function J(){return!!c(g).container}function le(){function X(){return c(g).lastNotifiedWidth===void 0}D("notifyListenersIfNeeded invoked");var P=c(g);if(X()&&P.lastWidth===P.startSize.width&&P.lastHeight===P.startSize.height)return D("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(P.lastWidth===P.lastNotifiedWidth&&P.lastHeight===P.lastNotifiedHeight)return D("Not notifying: Size already notified");D("Current size not notified, notifying..."),P.lastNotifiedWidth=P.lastWidth,P.lastNotifiedHeight=P.lastHeight,w(c(g).listeners,function(te){te(g)})}function be(){if(D("startanimation triggered."),Q(g)){D("Ignoring since element is still unrendered...");return}D("Element rendered.");var X=y(g),P=k(g);(X.scrollLeft===0||X.scrollTop===0||P.scrollLeft===0||P.scrollTop===0)&&(D("Scrollbars out of sync. Updating detector elements..."),F(le))}function me(){if(D("Scroll detected."),Q(g)){D("Scroll event fired while unrendered. Ignoring...");return}F(le)}if(D("registerListenersAndPositionElements invoked."),!c(g)){D("Aborting because element has been uninstalled");return}c(g).onRendered=be,c(g).onExpand=me,c(g).onShrink=me;var xe=c(g).style;S(g,xe.width,xe.height)}function U(){if(D("finalizeDomMutation invoked."),!c(g)){D("Aborting because element has been uninstalled");return}var S=c(g).style;ae(g,S.width,S.height),Ce(g,S.width,S.height)}function M(){z(g)}function ee(){D("Installing..."),A(),K(),b.add(0,se),b.add(1,ge),b.add(2,Z),b.add(3,U),b.add(4,M)}D("Making detectable..."),R(g)?(D("Element is detached"),re(),D("Waiting until element is attached..."),c(g).onRendered=function(){D("Element is now attached"),ee()}):ee()}function H(E){var g=c(E);g&&(g.onExpandScroll&&I(y(E),"scroll",g.onExpandScroll),g.onShrinkScroll&&I(k(E),"scroll",g.onShrinkScroll),g.onAnimationStart&&I(g.container,"animationstart",g.onAnimationStart),g.container&&E.removeChild(g.container))}return{makeDetectable:oe,addListener:L,uninstall:H,initDocument:l}}},630352:function(m,x,a){var w=a(577135).forEach,C=a(655274),f=a(763668),b=a(355461),c=a(457105),q=a(669215),O=a(883415),T=a(320300),$=a(366555),n=a(164730),l=a(172446);function d(p){return Array.isArray(p)||p.length!==void 0}function u(p){if(Array.isArray(p))return p;var I=[];return w(p,function(y){I.push(y)}),I}function _(p){return p&&p.nodeType===1}m.exports=function(p){p=p||{};var I;if(p.idHandler)I={get:function(V){return p.idHandler.get(V,!0)},set:p.idHandler.set};else{var y=b(),k=c({idGenerator:y,stateHandler:$});I=k}var L=p.reporter;if(!L){var oe=L===!1;L=q(oe)}var H=v(p,"batchProcessor",T({reporter:L})),E={};E.callOnAdd=!!v(p,"callOnAdd",!0),E.debug=!!v(p,"debug",!1);var g=f(I),z=C({stateHandler:$}),D,R=v(p,"strategy","object"),Q=v(p,"important",!1),j={reporter:L,batchProcessor:H,stateHandler:$,idHandler:I,important:Q};if(R==="scroll"&&(O.isLegacyOpera()?(L.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),R="object"):O.isIE(9)&&(L.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),R="object")),R==="scroll")D=l(j);else if(R==="object")D=n(j);else throw new Error("Invalid strategy name: "+R);var K={};function A(V,W,ue){function $e(ge){var Z=g.get(ge);w(Z,function(M){M(ge)})}function ve(ge,Z,U){g.add(Z,U),ge&&U(Z)}if(ue||(ue=W,W=V,V={}),!W)throw new Error("At least one element required.");if(!ue)throw new Error("Listener required.");if(_(W))W=[W];else if(d(W))W=u(W);else return L.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var _e=0,ye=v(V,"callOnAdd",E.callOnAdd),Ce=v(V,"onReady",function(){}),re=v(V,"debug",E.debug);w(W,function(Z){$.getState(Z)||($.initState(Z),I.set(Z));var U=I.get(Z);if(re&&L.log("Attaching listener to element",U,Z),!z.isDetectable(Z)){if(re&&L.log(U,"Not detectable."),z.isBusy(Z)){re&&L.log(U,"System busy making it detectable"),ve(ye,Z,ue),K[U]=K[U]||[],K[U].push(function(){_e++,_e===W.length&&Ce()});return}return re&&L.log(U,"Making detectable..."),z.markBusy(Z,!0),D.makeDetectable({debug:re,important:Q},Z,function(ee){if(re&&L.log(U,"onElementDetectable"),$.getState(ee)){z.markAsDetectable(ee),z.markBusy(ee,!1),D.addListener(ee,$e),ve(ye,ee,ue);var S=$.getState(ee);if(S&&S.startSize){var F=ee.offsetWidth,J=ee.offsetHeight;(S.startSize.width!==F||S.startSize.height!==J)&&$e(ee)}K[U]&&w(K[U],function(le){le()})}else re&&L.log(U,"Element uninstalled before being detectable.");delete K[U],_e++,_e===W.length&&Ce()})}re&&L.log(U,"Already detecable, adding listener."),ve(ye,Z,ue),_e++}),_e===W.length&&Ce()}function se(V){if(!V)return L.error("At least one element is required.");if(_(V))V=[V];else if(d(V))V=u(V);else return L.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");w(V,function(W){g.removeAllListeners(W),D.uninstall(W),$.cleanState(W)})}function ae(V){D.initDocument&&D.initDocument(V)}return{listenTo:A,removeListener:g.removeListener,removeAllListeners:g.removeAllListeners,uninstall:se,initDocument:ae}};function v(p,I,y){var k=p[I];return k==null&&y!==void 0?y:k}},655274:function(m){m.exports=function(x){var a=x.stateHandler.getState;function w(c){var q=a(c);return q&&!!q.isDetectable}function C(c){a(c).isDetectable=!0}function f(c){return!!a(c).busy}function b(c,q){a(c).busy=!!q}return{isDetectable:w,markAsDetectable:C,isBusy:f,markBusy:b}}},355461:function(m){m.exports=function(){var x=1;function a(){return x++}return{generate:a}}},457105:function(m){m.exports=function(x){var a=x.idGenerator,w=x.stateHandler.getState;function C(b){var c=w(b);return c&&c.id!==void 0?c.id:null}function f(b){var c=w(b);if(!c)throw new Error("setId required the element to have a resize detection state.");var q=a.generate();return c.id=q,q}return{get:C,set:f}}},763668:function(m){m.exports=function(x){var a={};function w(c){var q=x.get(c);return q===void 0?[]:a[q]||[]}function C(c,q){var O=x.get(c);a[O]||(a[O]=[]),a[O].push(q)}function f(c,q){for(var O=w(c),T=0,$=O.length;T<$;++T)if(O[T]===q){O.splice(T,1);break}}function b(c){var q=w(c);q&&(q.length=0)}return{get:w,add:C,removeListener:f,removeAllListeners:b}}},669215:function(m,x,a){var w=a(149500);m.exports=function(C){function f(){}var b={log:f,warn:f,error:f};if(!C&&window.console){var c=function(q,O){q[O]=function(){var $=w[O];if($.apply)$.apply(w,arguments);else for(var n=0;n<arguments.length;n++)$(arguments[n])}};c(b,"log"),c(b,"warn"),c(b,"error")}return b}},366555:function(m){var x="_erd";function a(f){return f[x]={},w(f)}function w(f){return f[x]}function C(f){delete f[x]}m.exports={initState:a,getState:w,cleanState:C}},564009:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _js_query_view_query_view__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(479876),_components_editor_board_digital_scrolling_count_to_count_to__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(134580),vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(42160),_utils_bus__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(927966),console=__webpack_require__(149500);__webpack_exports__.Z={name:"header-description",components:{CountTo:_components_editor_board_digital_scrolling_count_to_count_to__WEBPACK_IMPORTED_MODULE_1__.Z},mixins:[_js_query_view_query_view__WEBPACK_IMPORTED_MODULE_0__.G],data(){return{form_data:{},form_description:{},request_list:[]}},computed:{description_list(){let m={left:[],right:[]};return this.request_list=[],this.$$lib__.each(this.queryConfig.description,x=>{if(m[x.position].push(x),!this.$$lib__.contains(this.request_list,x.request_data)){let a={guid:x.request_data},w=this.$$lib__.find(this.queryConfig.request,C=>C.guid==x.request_data);w&&(a.query_request=w.query_request==!0),this.request_list.push(a)}this.form_description[x.request_data]={start_label:0,label:null,field_name:x.field_name,is_count_to:x.text.is_count_to}}),m.left=this.$$lib__.sortBy(m.left,"order"),m.right=this.$$lib__.sortBy(m.right,"order").reverse(),m}},watch:{request_list:{deep:!0,handler:function(){this.getRequestInfo()}}},methods:{labelStyle(m){let x={};return m.width&&(x.width=m.width+"px"),m.fontSize&&(x.fontSize=m.fontSize+"px"),m.color&&(x.color=m.color),m.fontWeight&&(x.fontWeight=m.fontWeight),m.fontFamily&&(x.fontFamily=m.fontFamily),m.align&&(x.textAlign=m.align),x},getDescriptionText(m){if(!m.text.is_description_text||m.text.is_description_text==""){console.warn("\u7EDF\u8BA1\u8BF4\u660E"+m.name+" \u811A\u672C\u4E3A\u7A7A");return}console.info("\u6267\u884C\u7EDF\u8BA1\u8BF4\u660E"+m.name+" \u811A\u672C");let x=new Function("label","requestData","description_config",m.text.script_description_text),a=this.form_description[m.request_data].label,w=this.requestDataInfo.requestDataJson[m.request_data];return x.apply(this,[a,w,m])},getRequestInfo(){this.busOff(),this.$$lib__.each(this.request_list,m=>{m.guid&&m.guid!=""&&(m.query_request!=!0&&this.getRequestData(m.guid),_utils_bus__WEBPACK_IMPORTED_MODULE_2__.Z.$on("busRequestDataJsonOk"+m.guid,x=>{this.setFormDescription(x)}))})},setFormDescription(result){for(let id in this.form_description)if(result.requestDataId==id)if(this.form_description[id].is_count_to==!0&&this.form_description[id].label==null?vue__WEBPACK_IMPORTED_MODULE_3__.default.set(this.form_description[id],"start_label",0):vue__WEBPACK_IMPORTED_MODULE_3__.default.set(this.form_description[id],"start_label",this.form_description[id].label),result.data&&result.data.length>0&&result.data[0]&&result.data[0][this.form_description[id].field_name]){let field_value=result.data[0][this.form_description[id].field_name];if(field_value&&this.form_description[id].is_count_to==!0)try{field_value=eval(eval(field_value))}catch(m){console.error("\u6570\u636E\u8F6C\u6362\u5931\u8D25\uFF0C\u4E0D\u80FD\u8F6C\u6362\u6210\u6570\u503C\u7C7B\u578B\uFF1A"+m)}vue__WEBPACK_IMPORTED_MODULE_3__.default.set(this.form_description[id],"label",field_value)}else vue__WEBPACK_IMPORTED_MODULE_3__.default.set(this.form_description[id],"label",null);this.$forceUpdate()},isNaN(m){return this.$$lib__.isNaN(m)},busOff(){this.$$lib__.each(this.request_list,m=>{_utils_bus__WEBPACK_IMPORTED_MODULE_2__.Z.$off("busRequestDataJsonOk"+m.guid)})}},beforeDestroy(){this.busOff()}}},56279:function(m,x,a){a.d(x,{P:function(){return f}});var w=a(386892),C=a(149500);const f={mixins:[w.D],created(){},methods:{lifecycleBeforeChartsLoad(b){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&C.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),C.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let q=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[b]);if(q)return q}return b},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&C.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),C.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},745643:function(m,x,a){a.d(x,{E:function(){return l}});var w=a(927966),C=a(555616),f=a.n(C),b=a(42160),c=a(148836),q=a(113067),O=a(975094),T=a(833264),$=a(479876),n=a(149500);const l={mixins:[T.t,$.G],computed:{...(0,c.Se)(["getGlobalParamFun"])},methods:{...(0,c.nv)(["setEnumInfo","setDatasetInfo","updateDatasetInfo","updateRequestDataInfo"]),getFieldEnumJson(){let d=[];this.$$lib__.each(this.queryConfig.field,u=>{u.enum_type==this.global_query.enum_type.field.code?d.push(u.field_enum_name):u.enum_type==this.global_query.enum_type.region.code&&d.push(this.global_query.globalConstantKey.field_enum.system_region_enum_key)}),this.$$lib__.each(this.queryConfig.condition,u=>{(u.control_type==this.global_query.control_type.select.code||u.control_type==this.global_query.control_type.radio.code||u.control_type==this.global_query.control_type.checkbox.code||u.control_type==this.global_query.control_type.selectTree.code||u.control_type==this.global_query.control_type.cascader.code)&&(u.control_enum_type==null||u.control_enum_type==this.global_query.enum_type.field.code)?d.push(u.control_enum_name):u.control_type==this.global_query.control_type.cascaderXzq.code&&d.push(this.global_query.globalConstantKey.field_enum.system_region_enum_key)}),d=this.$$lib__.uniq(d),d=this.$$lib__.without(d,null,"",void 0),d.length>0?this.accessType&&this.accessType==this.global_query.accessType.public.code?this.getEnumByFldExpNameArrForPublic(d).then(u=>{u&&u.status==200?this.setEnumInfo({enumJson:u.data,widgetId:this.widgetId}):C.Message.error({message:u.msg,offset:60})}):O.$.getEnumByFldExpNameArr(d).then(u=>{u&&u.status==200?this.setEnumInfo({enumJson:u.data,widgetId:this.widgetId}):C.Message.error({message:u.msg,offset:60})}):this.setEnumInfo({enumJson:null,widgetId:this.widgetId})},getDataSetJson(){let d={};this.$$lib__.each(this.queryConfig.field,_=>{if(_.enum_type==this.global_query.enum_type.data_set.code&&_.data_set.dataSetId&&_.data_set.dataSetId!=""){let v=JSON.stringify(this.handleDataSetParam(_.data_set));d[v]==null&&b.default.set(d,v,[]),d[v].push(JSON.parse(JSON.stringify(_)))}}),this.$$lib__.each(this.queryConfig.condition,_=>{if((_.control_type==this.global_query.control_type.select.code||_.control_type==this.global_query.control_type.radio.code||_.control_type==this.global_query.control_type.checkbox.code||_.control_type==this.global_query.control_type.selectTree.code||_.control_type==this.global_query.control_type.cascader.code)&&_.control_enum_type==this.global_query.enum_type.data_set.code&&_.data_set.dataSetId&&_.data_set.dataSetId!=""){let v=JSON.stringify(this.handleDataSetParam(_.data_set));d[v]==null&&b.default.set(d,v,[]),d[v].push(JSON.parse(JSON.stringify(_)))}});let u={datasetJson:{},isOk:{},widgetId:this.widgetId};for(let _ in d)this.$$lib__.each(d[_],v=>{let p=v.data_set.dataSetId+"_"+v.guid;b.default.set(u.datasetJson,p,[]),b.default.set(u.isOk,p,!1)});this.setDatasetInfo(u);for(let _ in d){let v={dataSet:_},p=JSON.parse(_),I=d[_];this.getDataSetSource(v,y=>{let k=[];y&&y.status==200?k=this.getDataSetObjectData(y.data,p.query,p.dimensionsAlias,p.dataSetId):C.Message.error({message:"\u6570\u636E\u96C6:[ "+I[0].data_set.dataSetName+" ]\u83B7\u53D6\u5931\u8D25\uFF0C"+y.msg,offset:60}),this.$$lib__.each(I,L=>{let oe=L.data_set.dataSetId+"_"+L.guid;this.updateDatasetInfo({key:oe,data:k,widgetId:this.widgetId})})})}d=void 0},getRequestDataJson(d,u,_){let v=this.$$lib__.find(this.queryConfig.request,p=>p.guid==d);if(v){this.updateRequestDataInfo({key:d,data:[],isOk:!1,widgetId:this.widgetId});let p=this.handleDataSetParam(v.data_set);if(this.$$lib__.isEmpty(p)){n.warn("\u6570\u636E\u8BF7\u6C42\u3010"+v.name+"\u3011\u7684\u6570\u636E\u96C6\u914D\u7F6E\u4E3A\u7A7A"),u&&u();return}let I={dataSet:JSON.stringify(p)};if(_){if(_.params&&_.params instanceof Object)if(_.params instanceof Array)this.$$lib__.each(_.params,y=>{y.name&&y.defaultVal&&this.$$lib__.each(I.query.params,k=>{y.name==k.name&&(k.defaultVal=y.defaultVal)})});else for(let y in _.params)this.$$lib__.each(I.query.params,k=>{y==k.name&&(k.defaultVal=_.params[y])});if(_.page&&_.page instanceof Object&&I.query&&I.query.page&&(_.page.enabled!=null&&(I.query.page.enabled=_.page.enabled),_.page.pageNum!=null&&(I.query.page.pageNum=_.page.pageNum),_.page.pageSize!=null&&(I.query.page.pageSize=_.page.pageSize)),_.orders&&_.orders instanceof Object&&I.orders&&I.query.orders)if(_.orders instanceof Array)this.$$lib__.each(_.orders,y=>{y.sort&&y.order&&"asc,desc".indexOf(y.order)>-1&&this.$$lib__.each(I.query.orders,k=>{y.sort==k.sort&&(k.order=y.order)})});else for(let y in _.orders)"asc,desc".indexOf(_.orders[y])>-1&&this.$$lib__.each(I.query.orders,k=>{y==k.sort&&(k.order=_.orders[y])});for(let y in _)_[y]instanceof Object||this.$$lib__.each(I.query.params,k=>{y==k.name&&(k.defaultVal=_[y])})}this.getDataSetSource(I,y=>{let k=[];y&&y.status==200?k=this.getDataSetObjectData(y.data,v.data_set.query,v.data_set.dimensionsAlias,v.data_set.dataSetId):C.Message.error({message:"\u6570\u636E\u8BF7\u6C42:[ "+v.name+" ]\u83B7\u53D6\u5931\u8D25\uFF0C"+y.msg,offset:60}),this.updateRequestDataInfo({key:d,data:k,widgetId:this.widgetId}),u&&u({data:k,requestConfig:v}),w.Z.$emit("busRequestDataJsonOk"+d,{requestDataId:d,data:k,requestConfig:v})})}else C.Message.error({message:"\u672A\u67E5\u8BE2\u5230\u6570\u636E\u8BF7\u6C42\u3010"+d+"\u3011\u7684\u76F8\u5173\u914D\u7F6E",offset:60}),u&&u()},getDataSetSource(d,u){this.accessType&&this.accessType==this.global_query.accessType.public.code?this.getAggregateDataEx(d).then(_=>{u&&u(_)}):q.o.getAggregateDataEx(d).then(_=>{u&&u(_)})},getDataSetObjectData(d,u,_,v){let p=this.getDataSetData(d,u,_,v);return this.getObjectList(p.columnList,p.data)},getDataSetData(d,u,_,v){if(!u||!u.script||!u.script.enabled||!d.jsonObject&&d.data)return d;if(u.script&&u.script.enabled){let p={columnList:[],data:[],total:null};if(p.columnList=this.getResultColumnList(_),n.log("Execute script for dateSetScript to dataSetId = "+v),u.script.content==""){C.Message.warning({message:"\u6570\u636E\u96C6\u201C"+v+"\u201D\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.formatData=new Function("jsonObject","result",u.script.content);try{let I=this.formatData(d.jsonObject,p);I&&(p=I)}catch(I){n.error('\u6570\u636E\u96C6"'+v+'"\u811A\u672C\u62A5\u9519\uFF1A',I)}return p}},formatData(d,u){return u.data=this.getResultData(u.columnList,d.data),u},getResultData(d,u){if(!d||d.length<1)return[];let _=[],v=d.length;return this.$$lib__.each(u,p=>{let I=[];for(let y=0;y<v;y++)I.push(p[d[y].name]);_.push(I)}),_},getResultColumnList(d){let u=[];if(d&&d.length>0)for(let _=0;_<d.length;_++)u.push({aggType:null,index:_,name:d[_].name});return u},getObjectList(d,u){let _=[];return this.$$lib__.each(u,v=>{let p={};this.$$lib__.each(d,(I,y)=>{p[I.name]=v[y]}),_.push(p)}),_},handleDataSetParam(d){return d&&d.query&&d.query.params&&this.$$lib__.each(d.query.params,u=>{u.globalParamName&&u.globalParamName!=""&&(u.defaultVal=this.getGlobalParamFun(u.globalParamName,this.widgetId))}),d}}}},479876:function(m,x,a){a.d(x,{G:function(){return $}});var w=a(148836),C=a(42160),f=a(321300),b=a(470709),c=a(927966),q=a(555616),O=a.n(q),T=a(149500);const $={props:{widgetId:{type:String}},data(){return{loading:!1,Message:q.Message,global:this.$$global,global_query:this.$$global_query,globalEditor:this.$$global_editor}},computed:{...(0,w.Se)(["queryIdFun","accessTypeFun","queryPublishIdFun","queryConfigFun","requestBodyFun","boardInfoFun","requestDefaultBodyFun","queryDataListFun","defaultQueryConfig","globalParamsFun","getGlobalParamFun","getURLParams","multipleSelectionFun","currentRowFun","enumInfoFun","datasetInfoFun","requestDataInfoFun","customerQueryFun","responseHeaders","customerConditionsFun","customerFieldsFun","customerQueryFun"]),accessType(){return this.accessTypeFun(this.widgetId)},queryId(){return this.queryIdFun(this.widgetId)},queryPublishId(){return this.queryPublishIdFun(this.widgetId)},queryConfig(){return this.queryConfigFun(this.widgetId)},requestBody(){return this.requestBodyFun(this.widgetId)},boardInfo(){return this.boardInfoFun(this.widgetId)},enumInfo(){return this.enumInfoFun(this.widgetId)},datasetInfo(){return this.datasetInfoFun(this.widgetId)},requestDataInfo(){return this.requestDataInfoFun(this.widgetId)},requestDefaultBody(){return this.requestDefaultBodyFun(this.widgetId)},queryDataList(){return this.queryDataListFun(this.widgetId)},multipleSelection(){return this.multipleSelectionFun(this.widgetId)},currentRow(){return this.currentRowFun(this.widgetId)},customerConditions(){return this.customerConditionsFun(this.widgetId)},customerFields(){return this.customerFieldsFun(this.widgetId)},customerQuery(){return this.customerQueryFun(this.widgetId)}},methods:{...(0,w.nv)(["setRequestBodyQueryListId","setRequestBodyKeyValue","setRequestDefaultBodyKeyValue","setRequestBodyPage","setRequestBodyOrders","setRequestBodyOrdersEx","setRequestDefaultBodyOrders","setViewGlobalParam"]),getTableData(n){let l=[];if(n&&n.length>0){let d=null;this.queryConfig.base.table&&this.queryConfig.base.table.lazy==!0&&this.queryConfig.base.table.lazy_config&&(d=this.queryConfig.base.table.lazy_config.children_type==this.global_query.children_type.expand_all.code?this.global_query.children_type.expand_all.code:this.queryConfig.base.table.lazy_config.children_expand_field);let u=this.getColumnList();this.$$lib__.each(n,_=>{let v=JSON.parse(JSON.stringify(_));this.$$lib__.each(u,p=>{v[p.field]!=null&&(v[p.field]=this.getColumnData(p,v[p.field]))}),d&&(v.hasChildren=d==this.global_query.children_type.expand_all.code?!0:this.mUtils.stringToBoolean(v[d])),l.push(v)})}return l},getColumnList(){let n=[];return this.$$lib__.each(this.queryConfig.field,l=>{(l.enum_type==this.global_query.enum_type.field.code||l.enum_type==this.global_query.enum_type.region.code||l.enum_type==this.global_query.enum_type.data_set.code)&&(l.enum_type==this.global_query.enum_type.region.code?l.field_enum_name=this.global_query.globalConstantKey.field_enum.system_region_enum_key:l.enum_type==this.global_query.enum_type.data_set.code&&(l.dataSetId=l.data_set.dataSetId,l.field_value=l.data_set.field_value,l.field_name=l.data_set.field_name)),n.push(l)}),n},getColumnData(n,l){return!l||l==""?l:n.field_enum_name?n.field_enum_name==this.global_query.globalConstantKey.field_enum.system_region_enum_key?this.getMultipleEnumName(n.is_multiple_enum,n.multiple_enum_separator,this.enumInfo.enumJson[n.field_enum_name],l,"xzqCode","xzqName"):this.getMultipleEnumName(n.is_multiple_enum,n.multiple_enum_separator,this.enumInfo.enumJson[n.field_enum_name],l,"enumValue","enumName"):n.guid&&n.guid!=""&&n.dataSetId&&n.dataSetId!=""?this.getMultipleEnumName(n.is_multiple_enum,n.multiple_enum_separator,this.datasetInfo.datasetJson[n.dataSetId+"_"+n.guid],l,n.field_value,n.field_name):l},getMultipleEnumName(n,l,d,u,_,v){if(d&&d.length>0)if(n==!0&&l&&l!=""){let p=(u+"").split(l);if(p&&p.length>0){let I=[];for(let y=0;y<p.length;y++){let k=this.$$lib__.find(d,L=>L[_]==p[y]);k?I.push(k[v]):I.push(p[y])}return I.join(l)}}else{let p=this.$$lib__.find(d,I=>I[_]==u);if(p)return p[v]}return u},setInitRequestBody(n){if(n&&n!=""&&(n=JSON.parse(n)),this.setRequestBodyQueryListId({queryListId:this.queryId,queryListPublishId:this.queryPublishId,widgetId:this.widgetId}),n){if(n.condition){let l={},d=this.$$lib__.pluck(n.field,"field");this.$$lib__.each(n.condition,u=>{(this.$$lib__.contains(d,u.field)||u.type=="param")&&C.default.set(l,u.field,this.getDefaultValue(u))}),this.setRequestBodyKeyValue({keyValue:l,widgetId:this.widgetId}),this.setRequestDefaultBodyKeyValue({keyValue:l,widgetId:this.widgetId})}n.base&&(this.setRequestBodyPage({enabled:n.base.pagination_enable}),n.base.pagination&&n.base.pagination.pageSize&&this.setRequestBodyPage({pageSize:n.base.pagination.pageSize,widgetId:this.widgetId}),n.base.orders_enable&&n.base.orders&&(this.setRequestBodyOrders({orders:n.base.orders,widgetId:this.widgetId}),this.setRequestDefaultBodyOrders({orders:n.base.orders,widgetId:this.widgetId})))}},getDefaultValue(n){let l=null;switch(n.default_value.type){case this.global_query.default_value_type.fixed_value.code:l=n.default_value.fixed_value.value;break;case this.global_query.default_value_type.url.code:l=this.getUrlKey(n.default_value.url.key);break;case this.global_query.default_value_type.local_storage.code:l=f.getStore(n.default_value.local_storage.key);break;case this.global_query.default_value_type.javascript.code:(!n.default_value.javascript.script||n.default_value.javascript.script=="")&&T.warn("\u81EA\u5B9A\u4E49\u9ED8\u8BA4\u503C "+n.label+" \u811A\u672C\u4E3A\u7A7A"),this.scriptFunc=new Function(n.default_value.javascript.script),l=this.scriptFunc();break;case this.global_query.default_value_type.system.code:l=JSON.parse(f.getStoreUserInfo())[n.default_value.system.key];break}return l!=""?l:null},getUrlKey(n){let l=new RegExp("[?|&]"+n+"=([^&;]+?)(&|#|;|$)").exec(location.href);return l?decodeURIComponent(l[1].replace(/\+/g,"%20")):null},scriptFunc(){return null},initBaseGlobalParams(n,l){let d=JSON.parse(JSON.stringify(n.params));this.$$lib__.each(n.param_list,u=>{switch(u.type){case this.globalEditor.globalParamsType.static.code:d[u.paramName]=u.value;break;case this.globalEditor.globalParamsType.systemParams.code:d[u.paramName]=this.getSystemParamValue(u.systemParams);break;case this.globalEditor.globalParamsType.urlParams.code:this.getURLParams[u.urlParams]==null||this.getURLParams[u.urlParams]==null?d[u.paramName]=u.urlParamsValue:d[u.paramName]=this.getURLParams[u.urlParams];break;case this.globalEditor.globalParamsType.configParam.code:d[u.paramName]=this.getConfigParamValue(u,l);break}}),d.widgetId=this.widgetId,this.setViewGlobalParam(d)},getSystemParamValue(n){let l=JSON.parse(f.getStoreUserInfo());switch(n){case this.globalEditor.systemParamsType.tokenNoHead.code:return f.getStoreToken();case this.globalEditor.systemParamsType.userId.code:return l.userId;case this.globalEditor.systemParamsType.userName.code:return l.userCode;case this.globalEditor.systemParamsType.staffName.code:return l.userName}},getConfigParamValue(n,l){let d=n.configParamValue,u=n.configParamName,_=this.$$lib__.find(l,v=>v.paramName==u);return _&&(d=_.paramValue),d},shapeStyle(n,l){if(l==null&&(l={}),n&&(n.padding&&n.padding!=""?l.padding=n.padding+"px":(n.paddingTop&&(l.paddingTop=n.paddingTop+"px"),n.paddingBottom&&(l.paddingBottom=n.paddingBottom+"px"),n.paddingLeft&&(l.paddingLeft=n.paddingLeft+"px"),n.paddingRight&&(l.paddingRight=n.paddingRight+"px")),n.backgroundColor&&(l.backgroundColor=n.backgroundColor),n.lineHeight&&(l.lineHeight=n.lineHeight+"px"),n.height&&(l.height=n.height+"px"),n.is_shape_style&&n.is_shape_style==!0)){if(!n.script_shape_style||n.script_shape_style=="")return T.warn("\u6574\u4F53\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),l;T.info("\u6267\u884C\u6574\u4F53\u6837\u5F0F\u811A\u672C");let d=new Function("shape_config","style",n.script_shape_style),u={};try{u=d.apply(this,[n,l]),u&&(l=u)}catch{T.error("\u6267\u884C\u6574\u4F53\u6837\u5F0F\u811A\u672C\u62A5\u9519\u5F02\u5E38")}}return l},buttonStyle(n){let l={};if(n.marginLeft&&(l.marginLeft=n.marginLeft+"px"),(!n.colorType||n.colorType=="custom")&&(n.backgroundColor&&(l.backgroundColor=n.backgroundColor),n.color&&(l.color=n.color)),n.width&&(l.width=n.width+"px"),n.is_button_style&&n.is_button_style==!0){if(!n.script_button_style||n.script_button_style=="")return T.warn("\u6309\u94AE\u6837\u5F0F "+n.name+" \u811A\u672C\u4E3A\u7A7A"),l;T.info("\u6267\u884C\u6309\u94AE\u6837\u5F0F "+n.name+" \u811A\u672C"),this.scriptButtonStyle=new Function("button_config","style",n.script_button_style);let d=this.scriptButtonStyle(n,l);d&&(l=d)}return l},iconStyle(n){let l={};return(!n.colorType||n.colorType=="custom")&&n.icon_color&&n.icon_color!=""&&(l.color=n.icon_color),l},getQueryListConfigForPublic(n){return(0,b.M0)("/query/queryListPublish/getQueryListConfigForPublic",n)},getDataForPublic(n){return(0,b.M0)("/queryData/tableData/getDataForPublic",n)},exportExcelForQueryListForPublic(n){return(0,b.Fb)("/queryData/tableData/exportExcelForQueryListForPublic",n)},getEnumByFldExpIdArrForPublic(n){return(0,b.M0)("/data/fieldEnum/getEnumByFldExpIdArrForPublic",n)},getEnumByFldExpNameArrForPublic(n){return(0,b.M0)("/data/fieldEnum/getEnumByFldExpNameArrForPublic",n)},setConditionValue(n,l){let d=this.$$lib__.find(this.queryConfig.condition,u=>u.guid==n);if(d){let u={};u[d.field]=l,c.Z.$emit("busSetFormConditionValue"+(this.widgetId?"_"+this.widgetId:""),u)}},getEnumDataSetJson(n){c.Z.$emit("busGetEnumDataSetJson"+(this.widgetId?"_"+this.widgetId:""),n)},getRequestData(n,l,d){c.Z.$emit("busGetRequestDataJson"+(this.widgetId?"_"+this.widgetId:""),n,l,d)},openDialog(n,l){c.Z.$emit("busOpenDialog"+(this.widgetId?"_"+this.widgetId:""),n,l)},closeDialog(n,l){c.Z.$emit("busCloseDialog"+(this.widgetId?"_"+this.widgetId:""),n,l)},doQuery(n){c.Z.$emit("busDoQuery"+(this.widgetId?"_"+this.widgetId:""),n)},emptyHeader(){c.Z.$emit("busEmptyHeader"+(this.widgetId?"_"+this.widgetId:""))},doRefresh(){c.Z.$emit("busDoRefresh"+(this.widgetId?"_"+this.widgetId:""))},previewConditionValue(){c.Z.$emit("busPreviewConditionValue"+(this.widgetId?"_"+this.widgetId:""))},setQueryCustomer(){c.Z.$emit("busSetQueryCustomer"+(this.widgetId?"_"+this.widgetId:""))},updateCustomerFields(n,l){c.Z.$emit("busUpdateCustomerFields"+(this.widgetId?"_"+this.widgetId:""),n,l)},getConditionControlObject(n){let l=null,d=this.getRefQueryView();return d&&d.$refs.refHeader&&(l=d.$refs.refHeader.$refs["ref_condition_control-"+n]),l},getButtonObject(n){let l=null,d=this.getRefQueryView();return d&&(d.$refs.refHeader&&(l=d.$refs.refHeader.$refs["ref_button-"+n]),!l&&d.$refs.refMain&&(l=d.$refs.refMain.$refs["ref_button-"+n])),l},getRefQueryView(){let n=null,l=this.$root;return l&&l.$children&&l.$children[0]&&(l=l.$children[0],l.$refs.view_screen&&l.$refs.view_screen.$refs.query_view&&(n=l.$refs.view_screen.$refs.query_view),n==null&&l.$refs.design_screen&&l.$refs.design_screen.$refs.design_view&&l.$refs.design_screen.$refs.design_view.$refs.query_view&&(n=l.$refs.design_screen.$refs.design_view.$refs.query_view)),n}}}},833264:function(m,x,a){a.d(x,{t:function(){return f}});var w=a(470709),C=a(321300);const f={created(){},methods:{getConfigForPublic(b){return(0,w.M0)("/visual/boardPublish/getConfigForPublic",b)},savePublicWidgetDataApi(b){return(0,w.M0)("/visual/boardPublish/savePublicWidgetData",b)},getAggregateDataEx(b){return(0,w.M0)("/dashboard/editor/getAggregateDataEx",(0,C.enc)(b))},getDataLocalByDatalocalId(b){return(0,w.xV)("/data/local/getDataLocalByDatalocalId/"+b)},getAggregateDataForExcel(b){return(0,w.Fb)("/dashboard/editor/getAggregateDataForExcel",(0,C.enc)(b))}}}},752246:function(m,x,a){a.d(x,{X:function(){return w},b:function(){return C}});let w={versions:function(){var f=navigator.userAgent;return{trident:f.indexOf("Trident")>-1,presto:f.indexOf("Presto")>-1,webKit:f.indexOf("AppleWebKit")>-1,gecko:f.indexOf("Gecko")>-1&&f.indexOf("KHTML")==-1,mobile:!!f.match(/AppleWebKit.*Mobile.*/),ios:!!f.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:f.indexOf("Android")>-1,iPhone:f.indexOf("iPhone")>-1,iPad:f.indexOf("iPad")>-1,webApp:f.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},C;w.versions.mobile||w.versions.ios||w.versions.android||w.versions.iPhone||w.versions.iPad?C=!1:C=!0},459738:function(m,x,a){a.d(x,{OW:function(){return C},m3:function(){return q},nm:function(){return f},vP:function(){return b},xC:function(){return c}});var w=a(153258);function C(O,T,$){let n=O;const l=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(d=>(0,w.mf)(n[d]));if(!(0,w.mf)(n[l]))return!1;do{if(n[l](T))return!0;if(n===$)return!1;n=n.parentNode}while(n);return!1}function f(O){const T=window.getComputedStyle(O);return[parseFloat(T.getPropertyValue("width"),10),parseFloat(T.getPropertyValue("height"),10)]}function b(O,T,$){O&&(O.attachEvent?O.attachEvent("on"+T,$):O.addEventListener?O.addEventListener(T,$,!0):O["on"+T]=$)}function c(O,T,$){O&&(O.detachEvent?O.detachEvent("on"+T,$):O.removeEventListener?O.removeEventListener(T,$,!0):O["on"+T]=null)}function q(O,T,$,n){var l=0,d=setInterval(()=>{l<$?(l++,O()):(clearInterval(d),n&&n())},T);return d}},134580:function(m,x,a){a.d(x,{Z:function(){return d}});var w=function(){var _=this,v=_._self._c;return v("span",[_._v(" "+_._s(_.displayValue)+" ")])},C=[];let f=0;const b="webkit moz ms o".split(" ");let c,q;if(typeof window>"u")c=function(){},q=function(){};else{c=window.requestAnimationFrame,q=window.cancelAnimationFrame;let u;for(let _=0;_<b.length&&!(c&&q);_++)u=b[_],c=c||window[u+"RequestAnimationFrame"],q=q||window[u+"CancelAnimationFrame"]||window[u+"CancelRequestAnimationFrame"];(!c||!q)&&(c=function(_){const v=new Date().getTime(),p=Math.max(0,16-(v-f)),I=window.setTimeout(()=>{_(v+p)},p);return f=v+p,I},q=function(_){window.clearTimeout(_)})}var T={name:"count-to",props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:0},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:2,validator(u){return u>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default(u,_,v,p){return v*(-Math.pow(2,-10*u/p)+1)*1024/1023+_}}},data(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown(){return this.startVal>this.endVal}},watch:{decimals(){this.start()},startVal(){this.autoplay&&this.start()},endVal(){this.autoplay&&this.start()}},mounted(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=c(this.count)},pauseResume(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause(){q(this.rAF)},resume(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,c(this.count)},reset(){this.startTime=null,q(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count(u){this.startTime||(this.startTime=u),this.timestamp=u;const _=u-this.startTime;this.remaining=this.localDuration-_,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(_,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(_,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(_/this.localDuration):this.printVal=this.localStartVal+(this.endVal-this.localStartVal)*(_/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),_<this.localDuration?this.rAF=c(this.count):this.$emit("callback")},isNumber(u){return!isNaN(parseFloat(u))},formatNumber(u){u=u.toFixed(this.decimals),u+="";const _=u.split(".");let v=_[0];const p=_.length>1?this.decimal+_[1]:"",I=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;I.test(v);)v=v.replace(I,"$1"+this.separator+"$2");return this.prefix+v+p+this.suffix}},destroyed(){q(this.rAF)}},$=T,n=a(768141),l=(0,n.Z)($,w,C,!1,null,"696c34af",null),d=l.exports},844513:function(m,x,a){a.d(x,{Z:function(){return T}});var w=function(){var n=this,l=n._self._c;return n.attr.buttonHide?l("div",{style:{position:"absolute",right:n.attr.buttonHideRight+"px",top:n.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(d){return n.onHide()}}},[n.openTooltip?l("el-tooltip",{attrs:{"open-delay":1e3,content:n.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[l("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):l("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):n._e()},C=[],f=a(752246),b={props:["attr"],name:"hide-button",data(){return{isPc:f.b}},computed:{openTooltip:function(){let $=!1,n=this.attr.buttonHideTooltipContent;return f.b&&n&&n!=null&&n.trim()!=""&&($=!0),$}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},c=b,q=a(768141),O=(0,q.Z)(c,w,C,!1,null,"bf399b9a",null),T=O.exports},81744:function(m,x,a){a.r(x),a.d(x,{default:function(){return Ue}});var w=function(){var e=this,s=e._self._c;return s("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px",overflow:"hidden"}},[s("hide-button",{attrs:{attr:e.widgetInfo.attr}}),s("query-view",{ref:"query_view",attrs:{"is-board":!0,"widget-id":e.widgetInfo.id,"query-list-id":e.query_list_id,"application-id":e.getApplication.applicationId,"query-list-publish-id":e.query_list_publish_id,"this-access-type":e.publish_type},on:{queryRequestBody:e.queryRequestBody}})],1)},C=[],f=a(927966),b=a(126265),c=a(445061),q=a(56279),O=function(){var e=this,s=e._self._c;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],ref:"query_view_body"+(this.widgetId?"_"+this.widgetId:""),class:`query_view_body query_view ${this.widgetId?"_"+this.widgetId:""} query-view-theme-${e.queryConfig.base.global_class}`,style:e.shapeStyle(e.queryConfig.base.shape),attrs:{id:"query_view"+(this.widgetId?"_"+this.widgetId:"")}},[s("view-header",{ref:"refHeader",attrs:{"widget-id":e.widgetId},on:{queryDataList:e.getQueryDataList}}),s("view-main-card",{directives:[{name:"show",rawName:"v-show",value:e.queryConfig.base.query_type==e.global_query.query_type.card.code,expression:"queryConfig.base.query_type == global_query.query_type.card.code"}],ref:"refMain",attrs:{"is-design":e.isDesign,"widget-id":e.widgetId}}),s("view-main",{directives:[{name:"show",rawName:"v-show",value:e.queryConfig.base.query_type==e.global_query.query_type.table.code,expression:"queryConfig.base.query_type == global_query.query_type.table.code"}],ref:"refMain",attrs:{"widget-id":e.widgetId}}),s("view-footer",{ref:"refFooter",attrs:{"widget-id":e.widgetId}}),s("view-dialog",{ref:"refDialog",attrs:{"widget-id":e.widgetId}})],1)},T=[],$=a(935051),n=a(231954),l=a(155946),d=a(321300);let u="/queryData/tableData",_={getData(t){let e={};return(0,$.postRequest)(u+"/getData",t,e)},getDataForOriginal(t){let e={};return(0,$.postRequest)(u+"/getDataForOriginal",t,e)},exportExcelForQueryList(t){return(0,$.downloadExcelRequest)(u+"/exportExcelForQueryList",t)}};var v=function(){var e=this,s=e._self._c;return s("div",{class:"view_header view_header"+(this.widgetId?"_"+this.widgetId:""),style:e.topStyle(),attrs:{id:"view_header"+(this.widgetId?"_"+this.widgetId:"")}},[s("el-form",{ref:"form",staticClass:"my-condition-header",attrs:{model:e.form_condition,inline:!0,size:"mini"},nativeOn:{submit:function(i){i.preventDefault()}}},[e._l(e.button_list.left,function(i){return s("el-form-item",{key:i.guid,staticStyle:{float:"left"}},[i.guid==e.global_query.button_system.customer_fields.guid?s("customer-fields",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.customer_conditions.guid?s("customer-conditions",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.customer_query.guid?s("customer-query",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,button_save_query:e.button_save_query,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.exportExcelCurrent.guid||i.guid==e.global_query.button_system.exportExcelAll.guid?s("export-excel",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId},on:{sendAction:e.sendAction}}):i.isDropdown==!0?s("el-dropdown",{attrs:{trigger:i.trigger,placement:i.placement,"hide-on-click":i.hide_on_click},on:{command:function(r){return e.onClickDropdownButton(i,arguments)}}},[s("button-tooltip",{attrs:{button_config:i}},[s("el-button",{class:`gisq-query-button el-button--${i.colorType}`,style:e.buttonStyle(i),attrs:{size:i.size,disabled:i.disabled,type:i.style=="text"?"text":"",plain:i.style=="plain",round:i.style=="round",circle:i.style=="circle"},on:{click:function(r){return e.onClickButton(i)}}},[!i.icon_align||i.icon_align==e.global_query.position.left.code?s("i",{class:i.icon}):e._e(),e._v(" "+e._s(i.label)+" "),i.icon_align==e.global_query.position.right.code?s("i",{class:i.icon}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(i.children,function(r){return s("el-dropdown-item",{key:r.guid,ref:"ref_button-"+r.guid,refInFor:!0,style:e.buttonStyle(r),attrs:{command:r.guid,divided:r.divided,disabled:r.disabled}},[r.guid==e.global_query.button_system.exportExcelCurrent.guid||r.guid==e.global_query.button_system.exportExcelAll.guid?s("export-excel",{ref:"ref_button-"+r.guid,refInFor:!0,attrs:{is_dropdown:!0,button_info:r,"widget-id":e.widgetId},on:{sendAction:e.sendAction}}):[s("button-tooltip",{attrs:{button_config:r}},[s("span",[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),s("span",{style:{color:r.color,marginRight:"5px"}},[e._v(e._s(r.label))]),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])])]],2)}),1)],1):[s("button-tooltip",{attrs:{button_config:i}},[s("el-button",{ref:"ref_button-"+i.guid,refInFor:!0,class:`gisq-query-button el-button--${i.colorType}`,style:e.buttonStyle(i),attrs:{size:i.size,disabled:i.disabled,type:i.style=="text"?"text":"",plain:i.style=="plain",round:i.style=="round",circle:i.style=="circle"},on:{click:function(r){return e.onClickButton(i)}}},[!i.icon_align||i.icon_align==e.global_query.position.left.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e(),e._v(" "+e._s(i.label)+" "),i.icon_align==e.global_query.position.right.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e()])],1)]],2)}),e._l(e.condition_control.header,function(i){return[e.isShow(i)?s("el-form-item",{key:i.guid,attrs:{size:i.attributes.size,"label-width":i.attributes.label_width!=null?i.attributes.label_width+"px":void 0,label:i.attributes.hide_label==!0?"":i.label}},[s("control-"+i.control_type,{ref:"ref_condition_control-"+i.guid,refInFor:!0,tag:"component",attrs:{condition_config:i,"widget-id":e.widgetId},model:{value:e.form_condition[i.field],callback:function(r){e.$set(e.form_condition,i.field,r)},expression:"form_condition[item.field]"}})],1):e._e(),e.isShow(i)&&i.is_br?s("br"):e._e()]}),e._l(e.button_list.center,function(i){return s("el-form-item",{key:i.guid},[i.guid==e.global_query.button_system.customer_fields.guid?s("customer-fields",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.customer_conditions.guid?s("customer-conditions",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.customer_query.guid?s("customer-query",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,button_save_query:e.button_save_query,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.exportExcelCurrent.guid||i.guid==e.global_query.button_system.exportExcelAll.guid?s("export-excel",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId},on:{sendAction:e.sendAction}}):i.isDropdown==!0?s("el-dropdown",{attrs:{trigger:i.trigger,placement:i.placement,"hide-on-click":i.hide_on_click},on:{command:function(r){return e.onClickDropdownButton(i,arguments)}}},[s("button-tooltip",{attrs:{button_config:i}},[s("el-button",{ref:"ref_button-"+i.guid,refInFor:!0,class:`gisq-query-button el-button--${i.colorType}`,style:e.buttonStyle(i),attrs:{size:i.size,disabled:i.disabled,type:i.style=="text"?"text":"",plain:i.style=="plain",round:i.style=="round",circle:i.style=="circle"},on:{click:function(r){return e.onClickButton(i)}}},[!i.icon_align||i.icon_align==e.global_query.position.left.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e(),e._v(" "+e._s(i.label)+" "),i.icon_align==e.global_query.position.right.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(i.children,function(r){return s("el-dropdown-item",{key:r.guid,ref:"ref_button-"+r.guid,refInFor:!0,style:e.buttonStyle(r),attrs:{command:r.guid,divided:r.divided,disabled:r.disabled}},[r.guid==e.global_query.button_system.exportExcelCurrent.guid||r.guid==e.global_query.button_system.exportExcelAll.guid?s("export-excel",{ref:"ref_button-"+r.guid,refInFor:!0,attrs:{is_dropdown:!0,button_info:r,"widget-id":e.widgetId},on:{sendAction:e.sendAction}}):[s("button-tooltip",{attrs:{button_config:r}},[s("span",[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),s("span",{style:{color:r.color,marginRight:"5px"}},[e._v(e._s(r.label))]),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])])]],2)}),1)],1):[s("button-tooltip",{attrs:{button_config:i}},[s("el-button",{ref:"ref_button-"+i.guid,refInFor:!0,class:`gisq-query-button el-button--${i.colorType}`,style:e.buttonStyle(i),attrs:{size:i.size,disabled:i.disabled,type:i.style=="text"?"text":"",plain:i.style=="plain",round:i.style=="round",circle:i.style=="circle"},on:{click:function(r){return e.onClickButton(i)}}},[!i.icon_align||i.icon_align==e.global_query.position.left.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e(),e._v(" "+e._s(i.label)+" "),i.icon_align==e.global_query.position.right.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e()])],1)]],2)}),e.extendVisible==!0?[s("br"),e._l(e.condition_control.extend,function(i){return[e.isShow(i)?s("el-form-item",{key:i.guid,attrs:{size:i.attributes.size,"label-width":i.attributes.label_width!=null?i.attributes.label_width+"px":void 0,label:i.attributes.hide_label==!0?"":i.label}},[s("control-"+i.control_type,{ref:"ref_condition_control-"+i.guid,refInFor:!0,tag:"component",attrs:{condition_config:i,"widget-id":e.widgetId},model:{value:e.form_condition[i.field],callback:function(r){e.$set(e.form_condition,i.field,r)},expression:"form_condition[item.field]"}})],1):e._e(),e.isShow(i)&&i.is_br?s("br"):e._e()]})]:e._e(),s("preview-condition-value",{attrs:{"widget-id":e.widgetId},on:{clearConditionValue:e.clearConditionValue}}),e._l(e.button_list.right,function(i){return s("el-form-item",{key:i.guid,staticStyle:{float:"right"}},[i.guid==e.global_query.button_system.customer_fields.guid?s("customer-fields",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.customer_conditions.guid?s("customer-conditions",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.customer_query.guid?s("customer-query",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,button_save_query:e.button_save_query,"widget-id":e.widgetId}}):i.guid==e.global_query.button_system.exportExcelCurrent.guid||i.guid==e.global_query.button_system.exportExcelAll.guid?s("export-excel",{ref:"ref_button-"+i.guid,refInFor:!0,attrs:{button_info:i,"widget-id":e.widgetId},on:{sendAction:e.sendAction}}):i.isDropdown==!0?s("el-dropdown",{attrs:{trigger:i.trigger,placement:i.placement,"hide-on-click":i.hide_on_click},on:{command:function(r){return e.onClickDropdownButton(i,arguments)}}},[s("button-tooltip",{attrs:{button_config:i}},[s("el-button",{ref:"ref_button-"+i.guid,refInFor:!0,class:`gisq-query-button el-button--${i.colorType}`,style:e.buttonStyle(i),attrs:{size:i.size,disabled:i.disabled,type:i.style=="text"?"text":"",plain:i.style=="plain",round:i.style=="round",circle:i.style=="circle"},on:{click:function(r){return e.onClickButton(i)}}},[!i.icon_align||i.icon_align==e.global_query.position.left.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e(),e._v(" "+e._s(i.label)+" "),i.icon_align==e.global_query.position.right.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(i.children,function(r){return s("el-dropdown-item",{key:r.guid,ref:"ref_button-"+r.guid,refInFor:!0,class:`gisq-query-dropdown el-button--${r?.colorType}`,style:e.buttonStyle(r),attrs:{command:r.guid,divided:r.divided,disabled:r.disabled}},[r.guid==e.global_query.button_system.exportExcelCurrent.guid||r.guid==e.global_query.button_system.exportExcelAll.guid?s("export-excel",{ref:"ref_button-"+r.guid,refInFor:!0,attrs:{is_dropdown:!0,button_info:r,"widget-id":e.widgetId},on:{sendAction:e.sendAction}}):[s("button-tooltip",{attrs:{button_config:r}},[s("span",[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),s("span",{style:{color:r.color,marginRight:"5px"}},[e._v(e._s(r.label))]),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])])]],2)}),1)],1):[s("button-tooltip",{attrs:{button_config:i}},[s("el-button",{ref:"ref_button-"+i.guid,refInFor:!0,class:`button-id-${i.guid} gisq-query-button el-button--${i.colorType}`,style:e.buttonStyle(i),attrs:{size:i.size,disabled:i.disabled,type:i.style=="text"?"text":"",plain:i.style=="plain",round:i.style=="round",circle:i.style=="circle"},on:{click:function(r){return e.onClickButton(i)}}},[!i.icon_align||i.icon_align==e.global_query.position.left.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e(),e._v(" "+e._s(i.label)+" "),i.icon_align==e.global_query.position.right.code?s("i",{class:i.icon,style:e.iconStyle(i)}):e._e()])],1)]],2)})],2),s("el-dialog",{attrs:{title:e.query_title,width:e.dialog_width+"px","close-on-click-modal":!1,"modal-append-to-body":!1,"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(i){e.dialogVisible=i}}},[s("el-form",{ref:"form",attrs:{model:e.form_condition,inline:!0,size:"mini"},nativeOn:{submit:function(i){i.preventDefault()}}},[e._l(e.condition_control.dialog,function(i){return[e.isShow(i)?s("el-form-item",{key:i.guid,attrs:{size:i.attributes.size,"label-width":i.attributes.label_width!=null?i.attributes.label_width+"px":void 0,label:i.attributes.hide_label==!0?"":i.label}},[s("control-"+i.control_type,{ref:"ref_condition_control-"+i.guid,refInFor:!0,tag:"component",attrs:{condition_config:i,"widget-id":e.widgetId},model:{value:e.form_condition[i.field],callback:function(r){e.$set(e.form_condition,i.field,r)},expression:"form_condition[item.field]"}})],1):e._e(),e.isShow(i)&&i.is_br?s("br"):e._e()]})],2),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.superQuery}},[e._v("\u67E5 \u8BE2")]),s("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.empty("dialog")}}},[e._v("\u6E05 \u7A7A")])],1)],1),e.queryConfig.base.orders_header_enable&&e.header_orders_flag?s("el-form",{ref:"form",staticClass:"my-condition-header",attrs:{inline:!0,size:"mini"},nativeOn:{submit:function(i){i.preventDefault()}}},[s("header-orders",{ref:"headerOrders",attrs:{"query-id":null,"widget-id":e.widgetId}})],1):e._e(),s("header-description"),s("save-query",{ref:"saveQuery",attrs:{button_info:e.button_save_query,"widget-id":e.widgetId}})],1)},p=[],I=a(479876),y=a(42160),k=a(148836),L=a(630352),oe=a.n(L),H=a(555616),E=a(452013),g=function(){var e=this,s=e._self._c;return s("div",[s("el-form",{ref:"form",staticClass:"my-description-header",attrs:{inline:!0,model:e.form_data,size:"mini"}},[e._l(e.description_list.left,function(i){return s("el-form-item",{key:i.guid,staticStyle:{float:"left"}},[s("div",{staticClass:"label-class",style:e.labelStyle(i.prefix)},[e._v(" "+e._s(i.prefix.label)+" ")]),s("div",{staticClass:"label-class",style:e.labelStyle(i.text)},[i.text.is_description_text==!0?s("span",{style:e.labelStyle(i.text),domProps:{innerHTML:e._s(e.getDescriptionText(i))}}):i.text.is_count_to?[isNaN(e.form_description[i.request_data].label)?s("span",{style:e.labelStyle(i.text)},[e._v(" - ")]):s("count-to",{style:e.labelStyle(i.text),attrs:{decimals:i.text.decimals,duration:i.text.duration,endVal:e.form_description[i.request_data].label,separator:i.text.separator,startVal:e.form_description[i.request_data].start_label}})]:[e._v(" "+e._s(e.form_description[i.request_data].label))]],2),s("div",{staticClass:"label-class",style:e.labelStyle(i.suffix)},[e._v(" "+e._s(i.suffix.label)+" ")])])}),e._l(e.description_list.right,function(i){return s("el-form-item",{key:i.guid,staticStyle:{float:"right"}},[s("div",{staticClass:"label-class",style:e.labelStyle(i.prefix)},[e._v(" "+e._s(i.prefix.label)+" ")]),s("div",{staticClass:"label-class",style:e.labelStyle(i.text)},[i.text.is_description_text==!0?s("span",{style:e.labelStyle(i.text),domProps:{innerHTML:e._s(e.getDescriptionText(i))}}):i.text.is_count_to?[isNaN(e.form_description[i.request_data].label)?s("span",{style:e.labelStyle(i.text)},[e._v("-")]):s("count-to",{style:e.labelStyle(i.text),attrs:{decimals:i.text.decimals,duration:i.text.duration,endVal:e.form_description[i.request_data].label,separator:i.text.separator,startVal:e.form_description[i.request_data].start_label}})]:[e._v(" "+e._s(e.form_description[i.request_data].label))]],2),s("div",{staticClass:"label-class",style:e.labelStyle(i.suffix)},[e._v(" "+e._s(i.suffix.label)+" ")])])})],2)],1)},z=[],D=a(564009),R=D.Z,Q=a(768141),j=(0,Q.Z)(R,g,z,!1,null,"369363b8",null),K=j.exports,A=a(149500),se={name:"view-header",components:{HeaderDescription:K,ButtonTooltip:E.Z,SaveQuery:()=>a.e(44777).then(a.bind(a,644777)),CustomerQuery:()=>a.e(36968).then(a.bind(a,736968)),PreviewConditionValue:()=>a.e(42019).then(a.bind(a,242019)),ExportExcel:()=>a.e(32654).then(a.bind(a,932654)),CustomerConditions:()=>a.e(41e3).then(a.bind(a,141e3)),CustomerFields:()=>a.e(75201).then(a.bind(a,175201)),ControlCascaderXzq:()=>a.e(97986).then(a.bind(a,897986)),ControlDatePicker:()=>a.e(29936).then(a.bind(a,529936)),ControlInput:()=>a.e(96831).then(a.bind(a,796831)),ControlRadio:()=>a.e(52864).then(a.bind(a,952864)),ControlCheckbox:()=>a.e(15690).then(a.bind(a,215690)),ControlSwitch:()=>a.e(23731).then(a.bind(a,123731)),ControlNumber:()=>a.e(97060).then(a.bind(a,597060)),ControlSelect:()=>a.e(3850).then(a.bind(a,603850)),ControlSelectTree:()=>a.e(7556).then(a.bind(a,707556)),ControlCascader:()=>a.e(14849).then(a.bind(a,814849)),HeaderOrders:()=>a.e(2739).then(a.bind(a,702739))},props:{widgetId:{type:String}},mixins:[I.G],data(){return{query_title:"\u66F4\u591A\u7B5B\u9009",dialog_width:null,condition_control:{},extendVisible:!1,dialogVisible:!1,form_condition:{},button_save_query:null,header_orders_flag:!0}},watch:{"queryConfig.condition":{deep:!0,handler:function(){this.getConditionControl()}}},computed:{...(0,k.Se)(["view_height_fun"]),view_height(){return this.view_height_fun(this.widgetId)},button_list(){let t=this;t.extendVisible=!1,t.dialogVisible=!1;let e={left:[],center:[],right:[],dropdown:[]},s={};return t.$$lib__.each(t.$$lib__.sortBy(t.queryConfig.button,"order"),i=>{i.button_position==this.global_query.button_position.header.code&&i.hide!=!0&&(i.isDropdown?(i.children=[],e.dropdown.push(i)):i.parent&&i.parent!=""?(s[i.parent]||y.default.set(s,i.parent,[]),s[i.parent].push(i)):i.guid==t.global_query.button_system.save_query.guid?t.accessType!=t.$$global_query.accessType.public.code&&(e[i.align].push(i),t.button_save_query=JSON.parse(JSON.stringify(i))):e[i.align].push(i))}),t.$$lib__.each(e.dropdown,i=>{for(let r in s)i.guid==r&&(i.children=s[r]);e[i.align].push(i)}),e.left=t.$$lib__.sortBy(e.left,"order"),e.center=t.$$lib__.sortBy(e.center,"order"),e.right=t.$$lib__.sortBy(e.right,"order").reverse(),e},refTable(){return this.$parent.$refs.refMain.$refs.refTable}},mounted(){const t=this;oe()().listenTo(document.getElementById("view_header"+(this.widgetId?"_"+this.widgetId:"")),s=>{t.setViewHeight({header:s.clientHeight,widgetId:this.widgetId})}),t.getConditionControl(),f.Z.$on("busDoQuery"+(this.widgetId?"_"+this.widgetId:""),s=>{this.doQuery(s)}),f.Z.$on("busEmptyHeader"+(this.widgetId?"_"+this.widgetId:""),()=>{this.emptyHeader()}),f.Z.$on("busDoRefresh"+(this.widgetId?"_"+this.widgetId:""),()=>{this.doRefresh()}),f.Z.$on("busSetQueryCustomer"+(this.widgetId?"_"+this.widgetId:""),()=>{this.doSetCustomerQuery()}),f.Z.$on("busSetFormConditionValue"+(this.widgetId?"_"+this.widgetId:""),s=>{this.doSetFormConditionValue(s)})},methods:{...(0,k.nv)(["setViewHeight"]),getConditionControl(){let t=this;this.condition_control={header:[],dialog:[],extend:[]},t.$$lib__.each(t.queryConfig.condition,e=>{e.hide||(y.default.set(t.form_condition,e.field,t.getDefaultValue(e)),this.condition_control[e.control_position].push(e))}),this.condition_control.header=t.$$lib__.sortBy(this.condition_control.header,"order"),this.condition_control.dialog=t.$$lib__.sortBy(this.condition_control.dialog,"order"),this.condition_control.extend=t.$$lib__.sortBy(this.condition_control.extend,"order")},onClickDropdownButton(t,e){if(t.isDropdown&&e&&e[0]){let s=this.$$lib__.find(t.children,i=>i.guid==e[0]);s&&(t=s)}this.onClickButton(t)},onClickButton(t){if(t.isSys)switch(t.guid){case this.global_query.button_system.query.guid:t.is_click?this.buttonClick(t):this.doQuery();break;case this.global_query.button_system.empty.guid:t.is_click?this.buttonClick(t):this.emptyHeader(t),t.empty_query==!0&&this.queryNow();break;case this.global_query.button_system.query_super.guid:t.is_click?this.buttonClick(t):(this.query_title=t.label,this.dialog_width=t.dialog_width,this.dialogVisible=!this.dialogVisible);break;case this.global_query.button_system.query_extend.guid:t.is_click?this.buttonClick(t):this.extendVisible=!this.extendVisible;break;case this.global_query.button_system.refresh.guid:t.is_click?this.buttonClick(t):this.doRefresh(t);break;case this.global_query.button_system.save_query.guid:t.is_click?this.buttonClick(t):this.$refs.saveQuery.addQuery();break}else this.buttonClick(t)},doQuery(t){let e={keyValue:JSON.parse(JSON.stringify(this.form_condition)),widgetId:this.widgetId};if(!this.$$lib__.isEmpty(t))for(let s in t)e[s]=t[s];this.setRequestBodyKeyValue(e),f.Z.$emit("busQueryDataList"+(this.widgetId?"_"+this.widgetId:"")),this.sendAction(this.global_query.action_system.query_doQuery.code)},superQuery(){this.dialogVisible=!1,this.doQuery()},emptyHeader(t){this.empty("header",t),this.sendAction(this.global_query.action_system.query_emptyHeader.code)},doRefresh(t){this.setRequestBodyOrders({orders:JSON.parse(JSON.stringify(this.requestDefaultBody.orders)),widgetId:this.widgetId}),this.header_orders_flag=!1,this.$nextTick(()=>{this.header_orders_flag=!0}),this.setRequestBodyPage({pageNum:1,widgetId:this.widgetId}),this.refreshCondition(t),this.setRequestBodyKeyValue({keyValue:JSON.parse(JSON.stringify(this.form_condition)),widgetId:this.widgetId}),f.Z.$emit("busTableClearSort"+(this.widgetId?"_"+this.widgetId:"")),f.Z.$emit("busQueryDataList"+(this.widgetId?"_"+this.widgetId:"")),this.sendAction(this.global_query.action_system.query_doRefresh.code)},refreshCondition(t){let e=[];for(let s in this.condition_control)e=this.$$lib__.union(e,JSON.parse(JSON.stringify(this.condition_control[s])));if(t&&t.keep_content)switch(t.keep_content){case this.global_query.empty_content.all.code:this.emptyAll(e);break;case this.global_query.empty_content.keep_defaults.code:this.emptyDefaults(e);break;case this.global_query.empty_content.keep_filter.code:this.emptyFilter(e);break;default:this.emptyDefaults(e)}else this.emptyDefaults(e)},doSetCustomerQuery(){this.requestBody.keyValue&&(this.form_condition=JSON.parse(JSON.stringify(this.requestBody.keyValue)))},empty(t,e){let s=[];if(t=="dialog"?s=JSON.parse(JSON.stringify(this.condition_control.dialog)):t=="header"&&(s=JSON.parse(JSON.stringify(this.condition_control.header)),s=this.$$lib__.union(s,JSON.parse(JSON.stringify(this.condition_control.extend)))),e&&e.empty_content)switch(e.empty_content){case this.global_query.empty_content.all.code:this.emptyAll(s);break;case this.global_query.empty_content.keep_defaults.code:this.emptyDefaults(s);break;case this.global_query.empty_content.keep_filter.code:this.emptyFilter(s);break;default:this.emptyDefaults(s)}else this.emptyDefaults(s)},buttonClick(t){if(t.is_click&&t.is_click==!0){if(!t.script_click||t.script_click==""){A.warn("\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 \u6309\u94AE"+t.name+" \u811A\u672C\u4E3A\u7A7A");return}A.info("\u6267\u884C\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 \u6309\u94AE"+t.name+" \u811A\u672C"),new Function("button_config",t.script_click).apply(this,[t])}else this.scriptClick(t)},scriptClick(t){t.dialog_id&&t.dialog_id!=""&&this.openDialog(t.dialog_id)},cancel(){this.dialogVisible=!1},isShow(t){return this.customerConditions==null?!0:this.$$lib__.contains(this.customerConditions,t.guid)},sendAction(t){let e=this.$$lib__.find(this.queryConfig.action,s=>s.code==t&&s.disabled!=!0);if(e)try{if(e.script_action==""){H.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}let s=t;if(this.boardInfo.isBoard){if(!this.boardInfo.widgetId){A.error("\u5728\u770B\u677F\u4E2D\u7684\u67E5\u8BE2\u5217\u8868\uFF0C\u770B\u677FID\u4E0D\u5141\u8BB8\u4E3A\u7A7A");return}s=s+"_"+this.boardInfo.widgetId}A.info("\u6267\u884C\u67E5\u8BE2\u5217\u8868\u53D1\u9001\u4E8B\u4EF6"+s+" \u811A\u672C");let r=new Function("",e.script_action).apply(this);f.Z.$emit(s,r),e.postMessage&&window.parent.postMessage(r,"*")}catch(s){A.error("\u6267\u884C"+t+"\u81EA\u5B9A\u4E49\u4E8B\u4EF6\u51FA\u9519"),A.error(s)}},clearConditionValue(t){y.default.set(this.form_condition,t,null),this.doQuery()},emptyAll(t){this.$$lib__.each(t,e=>{e.hide!=!0&&y.default.set(this.form_condition,e.field,null)})},emptyFilter(t){let e=null,s=this.$$lib__.find(this.customerQuery,i=>i.default==!0);s&&s.keyValue&&s.keyValue!=""&&(e=JSON.parse(s.keyValue)),this.$$lib__.each(t,i=>{if(i.hide!=!0)if(e){let r=e[i.field];r?y.default.set(this.form_condition,i.field,r):y.default.set(this.form_condition,i.field,null)}else y.default.set(this.form_condition,i.field,null)})},emptyDefaults(t){this.$$lib__.each(t,e=>{e.hide!=!0&&(e.default_value&&e.default_value.type&&e.default_value.type==this.global_query.default_value_type.none.code?y.default.set(this.form_condition,e.field,null):y.default.set(this.form_condition,e.field,this.requestDefaultBody.keyValue[e.field]))})},doSetFormConditionValue(t){let e=this.$$lib__.keys(t);if(e&&e.length>0)for(let s=0;s<e.length;s++)y.default.set(this.form_condition,e[s],t[e[s]])},queryNow(){let t=this.$$lib__.find(this.queryConfig.button,e=>e.guid==this.global_query.button_system.query.guid);t?this.onClickButton(t):H.Message.warning({message:"\u6267\u884C\u67E5\u8BE2\u64CD\u4F5C\uFF0C\u4F46\u672A\u627E\u5230\u67E5\u8BE2\u6309\u94AE\u7684\u76F8\u5173\u914D\u7F6E\uFF0C\u8BF7\u68C0\u67E5\u662F\u5426\u914D\u7F6E\u8FC7\u67E5\u8BE2\u6309\u94AE",offset:60})},topStyle(){let t=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.top)):null;return t&&t.height&&(t.padding?t.height=t.height-t.padding*2:(t.paddingTop&&(t.height=t.height-t.paddingTop),t.paddingBottom&&(t.height=t.height-t.paddingBottom))),this.shapeStyle(t)}}},ae=se,V=(0,Q.Z)(ae,v,p,!1,null,"f4ee92a8",null),W=V.exports,ue=function(){var e=this,s=e._self._c;return s("div",{staticClass:"my-query-table",style:e.tableStyle()},[e.isInit?s("el-table",{ref:"refTable",class:`my-el-table ${e.base?.table?.header_tooltip?"header-tooltip":""}`,attrs:{border:e.base_table.border,data:e.queryDataList.list,"header-cell-style":e.headerRowStyle,height:e.table_height,"highlight-current-row":e.base_table.highlight_current_row,"row-style":e.rowStyle,"show-header":e.base_table.show_header,size:e.base_table.size,stripe:e.base_table.stripe,lazy:e.base_table.lazy,load:e.lazyLoad,"row-key":e.rowKey,"tree-props":{hasChildren:"hasChildren"},"span-method":e.mergeCols,"default-sort":e.defaultSort},on:{"cell-click":e.cellClick,"sort-change":e.sortChange,"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[e.base_table.column_type_selection?s("el-table-column",{attrs:{fixed:e.fixed_both.left,selectable:e.selectable,align:"center","header-align":"center",label:"\u52FE\u9009",type:"selection"}}):e._e(),e.base_table.column_type_index?s("el-table-column",{attrs:{align:e.base_table.column_type_index_align,fixed:e.fixed_both.left,"header-align":e.base_table.column_type_index_header_align,label:e.base_table.column_type_index_label,width:e.base_table.column_type_index_width,type:"index"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.base_table.lazy_config.is_index_formatter!=!0?s("span",[e._v(" "+e._s(e.indexMethod(i.$index))+" ")]):i.row.table_index_is_root==!0?s("span",[e._v(" "+e._s(i.row.table_index_template_level_1)+" ")]):i.row.table_index_template_level_2!=null?s("span",[e._v(" "+e._s(e.indexChildMethod(i.row))+" ")]):e._e()]}}],null,!1,3658346994)}):e._e(),e.isShowColumnOperation(e.global_query.position.left.code)?s("el-table-column",{attrs:{align:e.base.column_button_align,fixed:e.base.column_button_fixed,"header-align":e.base.column_button_header_align,label:e.base.column_button_label,width:e.base.column_button_width,"column-key":"query_table_column_button"},scopedSlots:e._u([{key:"header",fn:function(i){return[e.base.table.header_tooltip?s("el-tooltip",{attrs:{content:i.column.label}},[s("span",{staticClass:"th-label"},[e._v(e._s(i.column.label))])]):s("span",[e._v(e._s(i.column.label))])]}},{key:"default",fn:function(i){return e._l(e.button_list,function(r){return s("a",{key:r.guid+"_"+i.$index},[s("button-tooltip",{attrs:{button_config:r,scope:i}},[r.isDropdown?s("el-dropdown",{attrs:{"hide-on-click":r.hide_on_click,placement:r.placement,trigger:r.trigger},on:{command:function(o){return e.onClickButton(i,r,arguments)}}},[s("button-tooltip",{attrs:{button_config:r,scope:i}},[s("el-button",{ref:"ref_button-"+r.guid,refInFor:!0,class:`gisq-query-button el-button--${r?.colorType}`,style:e.buttonStyle(i,r),attrs:{circle:r.style=="circle",disabled:r.disabled,plain:r.style=="plain",round:r.style=="round",size:r.size,type:r.style=="text"?"text":""},on:{click:function(o){return e.onClickButton(i,r)}}},[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),e._v(" "+e._s(r.label)+" "),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(r.children,function(o){return s("el-dropdown-item",{key:o.guid+"_"+i.$index,ref:"ref_button-"+o.guid,refInFor:!0,class:`gisq-query-theme-${e.base.global_class} gisq-query-button-text el-button--text el-button--${o?.colorType}`,style:e.buttonStyle(i,o),attrs:{command:o.guid,disabled:o.disabled,divided:o.divided}},[s("button-tooltip",{attrs:{button_config:o,scope:i}},[s("span",[!o.icon_align||o.icon_align==e.global_query.position.left.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e(),s("span",{style:{marginRight:"5px"}},[e._v(e._s(o.label))]),o.icon_align==e.global_query.position.right.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e()])])],1)}),1)],1):s("el-button",{ref:"ref_button-"+r.guid,refInFor:!0,class:`gisq-query-button el-button--${r?.colorType}`,style:e.buttonStyle(i,r),attrs:{circle:r.style=="circle",disabled:r.disabled,plain:r.style=="plain",round:r.style=="round",size:r.size,type:r.style=="text"?"text":""},on:{click:function(o){return e.onClickButton(i,r)}}},[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),e._v(" "+e._s(r.label)+" "),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])],1)],1)})}}],null,!1,2977530059)}):e._e(),e._l(e.column_field,function(i,r){return s("my-table-column",{key:r,attrs:{col:i,"orders-header-enable":e.base.orders_header_enable,"widget-id":e.widgetId}})}),e.isShowColumnOperation(e.global_query.position.right.code)?s("el-table-column",{attrs:{"class-name":"table-column-button-option",align:e.base.column_button_align,fixed:e.base.column_button_fixed?"right":!1,"header-align":e.base.column_button_header_align,label:e.base.column_button_label,width:e.base.column_button_width,"column-key":"query_table_column_button"},scopedSlots:e._u([{key:"header",fn:function(i){return[e.base.table.header_tooltip?s("el-tooltip",{attrs:{content:i.column.label}},[s("span",{staticClass:"th-label"},[e._v(e._s(i.column.label))])]):s("span",[e._v(e._s(i.column.label))])]}},{key:"default",fn:function(i){return e._l(e.button_list,function(r){return s("a",{key:r.guid+"_"+i.$index},[s("button-tooltip",{attrs:{button_config:r,scope:i}},[r.isDropdown?s("el-dropdown",{attrs:{"hide-on-click":r.hide_on_click,placement:r.placement,trigger:r.trigger},on:{command:function(o){return e.onClickButton(i,r,arguments)}}},[s("button-tooltip",{attrs:{button_config:r,scope:i}},[s("el-button",{ref:"ref_button-"+r.guid,refInFor:!0,class:`gisq-query-button el-button--${r?.colorType}`,style:e.buttonStyle(i,r),attrs:{circle:r.style=="circle",disabled:r.disabled,plain:r.style=="plain",round:r.style=="round",size:r.size,type:r.style=="text"?"text":""},on:{click:function(o){return e.onClickButton(i,r)}}},[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),e._v(" "+e._s(r.label)+" "),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(r.children,function(o){return s("el-dropdown-item",{key:o.guid+"_"+i.$index,ref:"ref_button-"+o.guid,refInFor:!0,class:`gisq-query-theme-${e.base.global_class} gisq-query-button-text el-button--text el-button--${o?.colorType}`,style:e.buttonStyle(i,o),attrs:{command:o.guid,disabled:o.disabled,divided:o.divided}},[s("button-tooltip",{attrs:{button_config:o,scope:i}},[s("span",[!o.icon_align||o.icon_align==e.global_query.position.left.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e(),s("span",{style:{marginRight:"5px"}},[e._v(e._s(o.label))]),o.icon_align==e.global_query.position.right.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e()])])],1)}),1)],1):s("el-button",{ref:"ref_button-"+r.guid,refInFor:!0,class:`gisq-query-button el-button--${r?.colorType}`,style:e.buttonStyle(i,r),attrs:{circle:r.style=="circle",disabled:r.disabled,plain:r.style=="plain",round:r.style=="round",size:r.size,type:r.style=="text"?"text":""},on:{click:function(o){return e.onClickButton(i,r)}}},[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e(),e._v(" "+e._s(r.label)+" "),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon,style:e.iconStyle(r)}):e._e()])],1)],1)})}}],null,!1,2977530059)}):e._e(),s("template",{slot:"empty"},[e.base_table.is_empty_text!=!0?[e._v(" "+e._s(e.base_table.empty_text)+" ")]:s("div",{domProps:{innerHTML:e._s(e.getEmptyText())}})],2)],2):e._e(),e.base_table.lazy==!0?s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(" \u7528\u4E8E\u83B7\u53D6\u67E5\u8BE2\u5217\u8868\u61D2\u52A0\u8F7D\u65F6\uFF0C\u5C55\u5F00\u548C\u6536\u8D77\u56FE\u6807\u7684\u56FE\u6807\u7F16\u7801 "),s("i",{ref:"ref_icon_packup",class:this.base_table.lazy_config.icon_packup}),s("i",{ref:"ref_icon_expanded",class:this.base_table.lazy_config.icon_expanded})]):e._e()],1)},$e=[],ve=function(){var e=this,s=e._self._c;return s("el-table-column",{attrs:{align:e.col.align,"column-key":e.col.field,fixed:e.col.fixed,"header-align":e.col.header_align,label:e.col.label,prop:e.col.field,"show-overflow-tooltip":e.queryConfig.base.table.row_tooltip||e.col.show_overflow_tooltip,sortable:e.col.sortable==!0&&e.ordersHeaderEnable!=!0?"custom":!1,width:e.col.width},scopedSlots:e._u([{key:"header",fn:function(i){return[e.queryConfig.base.table.header_tooltip?s("el-tooltip",{attrs:{content:i.column.label}},[s("span",{staticClass:"th-label"},[e._v(e._s(i.column.label))])]):s("span",[e._v(e._s(i.column.label))])]}},{key:"default",fn:function(i){return[[e.col.is_cell_slot!=!0&&e.col.is_cell_click!=!0?s("span",{staticClass:"table-column-cell-text-overflow"},[e._v(" "+e._s(i.row[i.column.property])+" ")]):e.col.is_cell_slot!=!0&&e.col.is_cell_click==!0?s("span",{staticClass:"table-column-cell-text-overflow table-column-is-cell-click"},[e._v(" "+e._s(i.row[i.column.property])+" ")]):s("span",{staticClass:"table-column-cell-text-overflow",domProps:{innerHTML:e._s(e.getCellSlot(i,e.col))}})]]}}])},[e.col.children&&e.col.children.length?e._l(e.col.children,function(i,r){return s("my-table-column",{key:r,attrs:{col:i,"orders-header-enable":e.ordersHeaderEnable}})}):e._e()],2)},_e=[],ye=a(149500),Ce={name:"my-table-column",props:{widgetId:{type:String},ordersHeaderEnable:{type:Boolean},col:{type:Object}},computed:{...(0,k.Se)(["queryConfigFun"]),queryConfig(){return this.queryConfigFun(this.widgetId)}},methods:{getCellSlot(t,e){if(!e.script_cell_slot||e.script_cell_slot==""){ye.warn("\u81EA\u5B9A\u4E49\u5185\u5BB9 \u5B57\u6BB5"+t.column.property+" \u811A\u672C\u4E3A\u7A7A");return}return ye.info("\u6267\u884C\u81EA\u5B9A\u4E49\u5185\u5BB9 \u5B57\u6BB5"+t.column.property+" \u811A\u672C"),new Function("row","column","$index","column_config",e.script_cell_slot).apply(this,[t.row,t.column,t.$index,e])},scriptCellSlot(t,e,s,i){return ye.debug(i),t[e.property]}}},re=Ce,ge=(0,Q.Z)(re,ve,_e,!1,null,"2a589286",null),Z=ge.exports,U=a(745643),M=a(149500),ee={name:"view-main",components:{ButtonTooltip:E.Z,MyTableColumn:Z},mixins:[I.G,U.E],props:{widgetId:{type:String}},data(){return{isInit:!0,base:{},base_table:{},defaultSort:{},fieldSortList:[],fixed_both:{left:!1,right:!1},mergeColumns:[],mergeColumnIndex:0,tableMergeData:[]}},computed:{...(0,k.Se)(["view_height_fun"]),view_height(){return this.view_height_fun(this.widgetId)},column_field(){return this.rebuildData()},table_height(){return this.base_table.height&&this.base_table.height!=""&&this.base_table.height!=0?this.base_table.height:this.view_height.page-this.view_height.header-this.view_height.footer-this.getPaddingTopTable()-this.getPaddingTopBody()},button_list(){let t=this,e={button:[],dropdown:[]},s={};return t.$$lib__.each(t.$$lib__.sortBy(t.queryConfig.button,"order"),i=>{i.button_position==this.global_query.button_position.row.code&&i.hide!=!0&&(i.isDropdown?(i.children=[],e.dropdown.push(i)):i.parent&&i.parent!=""?(s[i.parent]||y.default.set(s,i.parent,[]),s[i.parent].push(i)):e.button.push(i))}),t.$$lib__.each(e.dropdown,i=>{for(let r in s)i.guid==r&&(i.children=s[r]);e.button.push(i)}),t.$$lib__.sortBy(e.button,"order")}},watch:{"queryConfig.base.table":{deep:!0,handler:function(){this.initBaseTable(this.queryConfig.base)}},"queryDataList.list":{deep:!0,handler:function(){this.setDefaultSort(),this.createTableMergeData()}},column_field(){this.createTableMergeData()},customerFields(){this.createTableMergeData()}},mounted(){f.Z.$on("busTableClearSort"+(this.widgetId?"_"+this.widgetId:""),()=>{this.clearSort()})},methods:{...(0,k.nv)(["setMultipleSelection","setCurrentRow"]),initBaseTable(t){let e=this.base.column_button_position;this.base=JSON.parse(JSON.stringify(t)),t.table&&(this.base_table=JSON.parse(JSON.stringify(t.table)),this.$nextTick(()=>{this.setLazyExpandedIcon()})),e!=this.base.column_button_position&&this.reInitTable(),this.createTableMergeData()},reInitTable(){this.isInit=!1,setTimeout(()=>{this.isInit=!0},50)},indexMethod(t){return this.requestBody.page.enabled?(this.requestBody.page.pageNum-1)*this.requestBody.page.pageSize+t+1:t+1},indexChildMethod(t){let e="table_index_template_",s=e.length,i={},r=-2;Object.keys(t).forEach(h=>{h.indexOf(e)>-1&&(i[h.substring(s,h.length)]=t[h],r++)});let o="";return this.base_table.lazy_config.index_formatter_arrary&&(o=this.base_table.lazy_config.index_formatter_arrary[r]),this.mUtils.parseStringTemplate(o,i)},buttonStyle(t,e){let s={};if(e.marginLeft&&(s.marginLeft=e.marginLeft+"px"),(!e.colorType||e.colorType=="custom")&&(e.backgroundColor&&(s.backgroundColor=e.backgroundColor),e.color&&(s.color=e.color)),e.width&&(s.width=e.width+"px"),e.is_button_style&&e.is_button_style==!0){if(!e.script_button_style||e.script_button_style=="")return M.warn("\u6309\u94AE\u6837\u5F0F "+e.name+" \u811A\u672C\u4E3A\u7A7A"),s;M.info("\u6267\u884C\u6309\u94AE\u6837\u5F0F "+e.name+" \u811A\u672C");let r=new Function("row","column","$index","button_config","style",e.script_button_style).apply(this,[t.row,t.column,t.$index,e,s]);r&&(s=r)}return s},iconStyle(t){let e={};return(!t.colorType||t.colorType=="custom")&&t.icon_color&&t.icon_color!=""&&(e.color=t.icon_color),e},onClickButton(t,e,s){setTimeout(()=>{if(e.isDropdown&&s&&s[0]){let i=this.$$lib__.find(e.children,r=>r.guid==s[0]);i&&(e=i)}if(e.is_click&&e.is_click==!0){if(!e.script_click||e.script_click==""){M.warn("\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 "+e.name+" \u811A\u672C\u4E3A\u7A7A");return}M.info("\u6267\u884C\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 "+e.name+" \u811A\u672C"),new Function("row","column","$index","button_config",e.script_click).apply(this,[t.row,t.column,t.$index,e])}else this.scriptClickButton(t.row,t.column,t.$index,e)},50)},sortChange({column:t,prop:e,order:s}){M.debug(t),s?this.setOrders({sort:e,order:s.substring(0,s.indexOf("ending"))}):this.setOrders()},setOrders(t){let e=[];t==null||t==null?e=JSON.parse(JSON.stringify(this.requestDefaultBody.orders)):t instanceof Array?e=t:e.push(t),this.setRequestBodyOrdersEx({orders:e,widgetId:this.widgetId}),f.Z.$emit("busQueryDataList"+(this.widgetId?"_"+this.widgetId:""))},setDefaultSort(){if(this.defaultSort={},this.requestBody.orders&&this.requestBody.orders.length==1){let t=this.requestBody.orders[0];this.defaultSort={prop:t.sort,order:t.order+"ending"}}else this.requestBody.orders&&this.requestBody.orders.length>1&&this.$$lib__.each(this.requestBody.orders,t=>{this.$$lib__.contains(this.fieldSortList,t.sort)&&(this.defaultSort={prop:t.sort,order:t.order+"ending"})})},selectable(t,e){let s=!0;if(this.base_table.column_type_selection_field&&this.base_table.column_type_selection_field!=""){let i=t[this.base_table.column_type_selection_field];i&&(i.toString()=="1"||i.toString()=="true")?s=!0:i&&(i.toString()=="0"||i.toString()=="false")&&(s=!1)}if(this.base_table.is_column_type_selection_value){if(!this.base_table.script_column_type_selection_value||this.base_table.script_column_type_selection_value==""){M.warn("\u591A\u9009\u6846\u662F\u5426\u53EF\u7528\u8FD4\u56DE\u503C\u7684\u811A\u672C\u4E3A\u7A7A");return}M.info("\u6267\u884C\u591A\u9009\u6846\u662F\u5426\u53EF\u7528\u8FD4\u56DE\u503C\u7684\u811A\u672C");let i=new Function("row, rowIndex, value",this.base_table.script_column_type_selection_value);try{let r=i.apply(this,[t,e,s]);r!=null&&r!=null&&(s=r)}catch{M.error("\u6267\u884C\u591A\u9009\u6846\u662F\u5426\u53EF\u7528\u8FD4\u56DE\u503C\u7684\u811A\u672C\u62A5\u9519\u5F02\u5E38")}}return s},clearSort(){this.$refs.refTable.clearSort()},cellClick(t,e,s,i){setTimeout(()=>{let r=this.$$lib__.find(this.queryConfig.field,o=>o.field==e.property);if(r)if(r.is_cell_click&&r.is_cell_click==!0){if(!r.script_cell_click||r.script_cell_click==""){M.warn("\u70B9\u51FB\u4E8B\u4EF6 \u5B57\u6BB5"+e.property+" \u811A\u672C\u4E3A\u7A7A");return}M.info("\u6267\u884C\u70B9\u51FB\u4E8B\u4EF6 \u5B57\u6BB5"+e.property+" \u811A\u672C"),new Function("row","column","cell","event","column_config",r.script_cell_click).apply(this,[t,e,s,i,r])}else this.scriptClickCell(t,e,s,i,r)},50)},tableStyle(){let t=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.table)):null;return this.shapeStyle(t,{height:this.table_height+"px"})},getPaddingTopTable(){let t=0,e=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.table)):null;return e&&(e.padding?t=t+e.padding*2:(e.paddingTop&&(t=t+e.paddingTop),e.paddingBottom&&(t=t+e.paddingBottom))),t},getPaddingTopBody(){let t=0,e=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape)):null;return e&&(e.padding?t=t+e.padding*4:(e.paddingTop&&(t=t+e.paddingTop*2),e.paddingBottom&&(t=t+e.paddingBottom*2))),t},scriptClickButton(t,e,s,i){i.dialog_id&&i.dialog_id!=""&&this.openDialog(i.dialog_id)},scriptClickCell(t,e,s,i,r){r.dialog_id&&r.dialog_id!=""&&this.openDialog(r.dialog_id)},headerRowStyle({row:t,column:e,rowIndex:s,columnIndex:i}){let r={};if(this.base_table.header_height&&(r.height=this.base_table.header_height+"px"),this.base_table.header_fontSize&&(r.fontSize=this.base_table.header_fontSize+"px"),this.base_table.header_fontFamily&&(r.fontFamily=this.base_table.header_fontFamily),this.base_table.header_color&&this.base_table.header_color!=""&&(r.color=this.base_table.header_color),this.base_table.header_backgroundColor&&this.base_table.header_backgroundColor!=""&&(r.backgroundColor=this.base_table.header_backgroundColor),!this.base_table.is_header_row_style)return r;if(!this.base_table.script_header_row_style||this.base_table.script_header_row_style=="")return M.warn("\u8868\u5934\u81EA\u5B9A\u4E49\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),r;M.info("\u6267\u884C\u8868\u5934\u81EA\u5B9A\u4E49\u6837\u5F0F\u811A\u672C");let o=new Function("row, column, rowIndex, columnIndex, styleInfo",this.base_table.script_header_row_style);try{let h=o.apply(this,[t,e,s,i,r]);h&&(r=h)}catch{M.error("\u6267\u884C\u8868\u5934\u81EA\u5B9A\u4E49\u6837\u5F0F\u811A\u672C\u62A5\u9519\u5F02\u5E38")}return r},rowStyle({row:t,rowIndex:e}){let s={};if((this.base_table.is_row_click&&this.base_table.is_row_click==!0||this.base_table.dialog_id&&this.base_table.dialog_id!="")&&(s.cursor="pointer"),this.base_table.row_height&&(s.height=this.base_table.row_height+"px"),this.base_table.row_fontSize&&(s.fontSize=this.base_table.row_fontSize+"px"),this.base_table.row_fontFamily&&(s.fontFamily=this.base_table.row_fontFamily),this.base_table.row_color&&this.base_table.row_color!=""&&(s.color=this.base_table.row_color),this.base_table.row_backgroundColor&&this.base_table.row_backgroundColor!=""&&(s.backgroundColor=this.base_table.row_backgroundColor),!this.base_table.is_row_style)return s;if(!this.base_table.script_row_style||this.base_table.script_row_style=="")return M.warn("\u8868\u683C\u884C\u81EA\u5B9A\u4E49\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),s;M.info("\u6267\u884C\u8868\u683C\u884C\u81EA\u5B9A\u4E49\u6837\u5F0F\u811A\u672C");let i=new Function("row, rowIndex, styleInfo",this.base_table.script_row_style);try{let r=i.apply(this,[t,e,s]);r&&(s=r)}catch{M.error("\u6267\u884C\u8868\u683C\u884C\u81EA\u5B9A\u4E49\u6837\u5F0F\u811A\u672C\u62A5\u9519\u5F02\u5E38")}return s},handleSelectionChange(t){this.setMultipleSelection({multipleSelection:t,widgetId:this.widgetId})},handleRowClick(t,e,s){if(this.setCurrentRow({currentRow:{row:t,column:e,event:s},widgetId:this.widgetId}),e.columnKey=="query_table_column_button")return;let i=this.$$lib__.find(this.queryConfig.field,r=>r.field==e.property);if(!(i.is_cell_click&&i.is_cell_click==!0||i.dialog_id&&i.dialog_id!=""))if(this.base_table.is_row_click&&this.base_table.is_row_click==!0){if(!this.base_table.script_row_click||this.base_table.script_row_click==""){M.warn("\u8868\u683C\u884C\u70B9\u51FB\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}M.info("\u6267\u884C\u8868\u683C\u884C\u70B9\u51FB\u4E8B\u4EF6\u811A\u672C"),new Function("row","column","event","table_config",this.base_table.script_row_click).apply(this,[t,e,s,this.base_table])}else this.base_table.dialog_id&&this.base_table.dialog_id!=""&&this.openDialog(this.base_table.dialog_id)},doTableLayout(){this.$nextTick(()=>{this.$refs.refTable&&this.$refs.refTable.doLayout(),setTimeout(()=>{this.defaultExpanded()},50)})},isShowColumnOperation(t){let e=!0;return this.base.column_button_hide==!0&&(e=this.button_list.length>0),e&&this.base.column_button_position==t},rebuildData(){let t=this.$$lib__.filter(JSON.parse(JSON.stringify(this.queryConfig.field)),h=>this.customerFields==null?h.default_display:this.$$lib__.contains(this.customerFields,h.guid)),e=JSON.parse(JSON.stringify(this.queryConfig.fieldHeader)),s={},i={},r=[],o=[];return this.fixed_both.left=!1,this.fixed_both.right=!1,this.fieldSortList=[],this.$$lib__.each(t,h=>{h.hide!=!0&&(h.fixed==this.global_query.position.none.code?h.fixed=!1:(h.fixed==this.global_query.position.left.code||h.fixed==this.global_query.position.right.code)&&(this.fixed_both[h.fixed]=!0),h.id=h.field,h.type="field",h.parent_guid=h.header_id,o.push(h),h.sortable==!0&&this.fieldSortList.push(h.field))}),o=this.$$lib__.union(o,e),o=this.$$lib__.sortBy(o,"order"),this.$$lib__.each(o,h=>{h.type!="field"&&(h.id=h.guid,h.type="header"),h.parent_guid!=null&&h.parent_guid!=""?(i[h.parent_guid]||(i[h.parent_guid]=[]),i[h.parent_guid].push(h)):r.push(h)}),this.transferFl(r,i,s),r},transferFl(t,e,s){this.$$lib__.each(t,i=>{let r=e[i.guid];r?(i.children=r,s[i.guid]&&this.$$lib__.each(s[i.guid],o=>{i.children.push(o)}),this.transferFl(r,e,s)):s[i.guid]&&(i.children=s[i.guid])})},createTableMergeData(){this.mergeColumnIndex=0,this.mergeColumns=[],this.$$lib__.each(this.column_field,B=>{this.pushMergeColumns(B),B.children&&this.ergodicTableMergeData(B.children)});let t=this.getMergeColumnIndex0(),e=[],s=[],i=[],r=this.$$lib__.filter(this.mergeColumns,B=>B.fixed==this.global_query.position.left.code);this.$$lib__.each(r,(B,ie)=>{let Y=JSON.parse(JSON.stringify(B));Y.index=t+ie,e.push(Y)});let o=this.$$lib__.filter(this.mergeColumns,B=>B.fixed!=this.global_query.position.left.code&&B.fixed!=this.global_query.position.right.code&&(B.row==!0||B.column==!0));this.$$lib__.each(o,B=>{let ie=0;this.$$lib__.each(this.mergeColumns,ke=>{ke.fixed==this.global_query.position.left.code&&ke.index>B.index&&ie++});let Y=JSON.parse(JSON.stringify(B));Y.index=t+B.index+ie,s.push(JSON.parse(JSON.stringify(Y)))});let h=this.$$lib__.filter(this.mergeColumns,B=>B.fixed==this.global_query.position.right.code),G=this.mergeColumnIndex-h.length+t;this.$$lib__.each(h,(B,ie)=>{let Y=JSON.parse(JSON.stringify(B));Y.index=G+ie,i.push(JSON.parse(JSON.stringify(Y)))}),this.mergeColumns=this.$$lib__.union(e,s,i),this.generateTableMergeData(),this.reInitTable(),this.doTableLayout()},ergodicTableMergeData(t){this.$$lib__.each(t,e=>{this.pushMergeColumns(e),e.children&&this.ergodicTableMergeData(e.children)})},pushMergeColumns(t){t.type=="field"&&(this.mergeColumns.push({index:this.mergeColumnIndex,name:t.field,row:t.merge=="row",column:t.merge=="column",fixed:t.fixed}),this.mergeColumnIndex++)},getMergeColumnIndex0(){let t=0;return this.base_table.column_type_selection&&t++,this.base_table.column_type_index&&t++,this.isShowColumnOperation(this.global_query.position.left.code)&&t++,t},mergeCols({rowIndex:t,columnIndex:e}){const s=e+"_"+t;if(this.tableMergeData[s])return this.tableMergeData[s]},generateTableMergeData(){this.tableMergeData=[];for(let t=0;t<this.queryDataList.list.length;t++)for(let e=0;e<this.mergeColumns.length;e++){let s=1,i=1;this.mergeColumns[e].column==!0?(e>0&&this.mergeColumns[e-1].column==!0&&this.queryDataList.list[t][this.mergeColumns[e].name]===this.queryDataList.list[t][this.mergeColumns[e-1].name]&&(i=0),i>0&&(i=this.calculateColumnIndex(this.queryDataList.list[t],e,e+1,1,this.mergeColumns.length))):this.mergeColumns[e-1]&&this.mergeColumns[e-1].column==!0&&e>0&&this.mergeColumns[e-1].column==!0&&this.queryDataList.list[t][this.mergeColumns[e].name]===this.queryDataList.list[t][this.mergeColumns[e-1].name]&&(i=0),this.mergeColumns[e].row==!0&&(t>0&&this.queryDataList.list[t][this.mergeColumns[e].name]===this.queryDataList.list[t-1][this.mergeColumns[e].name]&&(s=0),s>0&&(s=this.calculateRowIndex(this.queryDataList.list,t,t+1,1,this.mergeColumns[e].name)));const r=this.mergeColumns[e].index+"_"+t;this.tableMergeData[r]=[s,i]}this.base_table.column_type_index&&this.base_table.lazy_config.is_index_formatter==!0&&this.$$lib__.each(this.queryDataList.list,(t,e)=>{let s=e+1;this.requestBody.page.enabled&&(s=(this.requestBody.page.pageNum-1)*this.requestBody.page.pageSize+e+1),t.table_index_template_level_1=s,t.table_index_is_root=!0})},calculateColumnIndex(t,e,s,i,r){return s<r&&t[this.mergeColumns[e].name]===t[this.mergeColumns[s].name]?this.calculateColumnIndex(t,e,++s,++i,r):i},calculateRowIndex(t,e,s,i,r){return s<t.length&&t[e][r]===t[s][r]?this.calculateRowIndex(t,e,++s,++i,r):i},getEmptyText(){let t="";if(this.base_table.is_empty_text&&this.base_table.is_empty_text==!0){if(!this.base_table.script_empty_text||this.base_table.script_empty_text=="")return M.warn("\u8868\u683C\u81EA\u5B9A\u4E49\u7A7A\u6570\u636E\u65F6\u663E\u793A\u7684\u6587\u672C\u5185\u5BB9\u811A\u672C\u4E3A\u7A7A"),t;M.info("\u6267\u884C\u8868\u683C\u81EA\u5B9A\u4E49\u7A7A\u6570\u636E\u65F6\u663E\u793A\u7684\u6587\u672C\u5185\u5BB9\u811A\u672C");let s=new Function("table_config",this.base_table.script_empty_text).apply(this,[this.base_table]);s&&(t=s)}return t},lazyLoad(t,e,s){let i=null;if(this.base_table.lazy==!0&&this.base_table.lazy_config&&(i=t[this.base_table.lazy_config.children_filter_field]),this.base_table.lazy==!0&&this.base_table.lazy_config&&this.base_table.lazy_config.data_set&&this.base_table.lazy_config.data_set.dataSetId&&this.base_table.lazy_config.data_set.dataSetId!=""){let r=JSON.parse(JSON.stringify(this.base_table.lazy_config.data_set));r&&r.query&&r.query.params&&this.$$lib__.each(r.query.params,h=>{h.name==this.base_table.lazy_config.children_filter_param&&(h.defaultVal=i)});let o={dataSet:JSON.stringify(this.handleDataSetParam(r))};this.getDataSetSource(o,h=>{let G=[];if(h&&h.status==200){if(G=this.getDataSetObjectData(h.data,r.query,r.dimensionsAlias,r.dataSetId),G=this.getTableData(G),this.base_table.column_type_index&&this.base_table.lazy_config.is_index_formatter==!0){let B="table_index_template_level_",ie=0;Object.keys(t).forEach(Y=>{Y.indexOf(B)>-1&&ie++}),this.$$lib__.each(G,(Y,ke)=>{if(ie>0){for(let Te=1;Te<=ie;Te++)Y[B+Te]=t[B+Te];Y[B+(ie+1)]=ke+1}})}}else H.Message.error({message:"\u5B50\u96C6\u6570\u636E\u96C6:[ "+this.base_table.lazy_config.data_set.dataSetName+" ]\u83B7\u53D6\u5931\u8D25\uFF0C"+h.msg,offset:60});s(G)})}},rowKey(t){let e=this.mUtils.randomString(10);return this.base_table.lazy==!0&&this.base_table.lazy_config&&this.base_table.lazy_config.children_filter_field&&this.base_table.lazy_config.children_filter_field!=""?t[this.base_table.lazy_config.children_filter_field]:e},setLazyExpandedIcon(){if(this.base_table.lazy==!0&&this.base_table.lazy_config&&(this.base_table.lazy_config.icon_packup&&this.base_table.lazy_config.icon_packup!=""||this.base_table.lazy_config.icon_expanded&&this.base_table.lazy_config.icon_expanded!=""||this.base_table.lazy_config.icon_color&&this.base_table.lazy_config.icon_color!=""||this.base_table.lazy_config.icon_size||this.base_table.lazy_config.icon_width||this.base_table.lazy_config.icon_height)){let t=[],e="query_view"+(this.widgetId?"_"+this.widgetId:"");if(t.push("#"),t.push(e),t.push(" .el-table__expand-icon { "),this.base_table.lazy_config.icon_color&&(t.push("color: "),t.push(this.base_table.lazy_config.icon_color),t.push("; ")),this.base_table.lazy_config.icon_size&&(t.push("font-size: "),t.push(this.base_table.lazy_config.icon_size),t.push("px; ")),this.base_table.lazy_config.icon_width&&(t.push("width: "),t.push(this.base_table.lazy_config.icon_width),t.push("px; ")),this.base_table.lazy_config.icon_height&&(t.push("height: "),t.push(this.base_table.lazy_config.icon_height),t.push("px; ")),this.base_table.lazy_config.icon_packup&&this.base_table.lazy_config.icon_packup!=""||this.base_table.lazy_config.icon_expanded&&this.base_table.lazy_config.icon_expanded!=""){if(t.push(" -webkit-transform: rotate(0deg); transform: rotate(0deg); }"),this.base_table.lazy_config.icon_packup&&this.base_table.lazy_config.icon_packup!=""){let s=this.getIconContent(this.$refs.ref_icon_packup);s&&(t.push("#"),t.push(e),t.push(" .el-table__expand-icon .el-icon-arrow-right:before { content: '"),t.push(s.replace(/(\")/g,"")),t.push("';}"))}if(this.base_table.lazy_config.icon_expanded&&this.base_table.lazy_config.icon_expanded!=""){let s=this.getIconContent(this.$refs.ref_icon_expanded);s&&(t.push("#"),t.push(e),t.push(" .el-table__expand-icon--expanded .el-icon-arrow-right:before { content: '"),t.push(s.replace(/(\")/g,"")),t.push("';}"))}}else t.push(" }");this.mUtils.appendCss(e+"_lazy_expanded_icon",t.join(""))}},getIconContent(t){let e=window.getComputedStyle(t,":before").getPropertyValue("content"),s=/[^\x00-\xff]/g;return e.replace(s,function(i){return"\\"+i.charCodeAt(0).toString(16)})},defaultExpanded(){if(this.base_table.lazy==!0&&this.base_table.lazy_config&&this.base_table.lazy_config.auto_load==!0){let t=this.$refs.refTable;if(t){const e=t.$el.getElementsByClassName("el-table__expand-icon");e&&e.length>0&&this.$nextTick(()=>{this.$$lib__.each(e,s=>{s.click()})})}}}},beforeDestroy(){f.Z.$off("busTableClearSort"+(this.widgetId?"_"+this.widgetId:""))}},S=ee,F=(0,Q.Z)(S,ue,$e,!1,null,"1b8c4a30",null),J=F.exports,le=function(){var e=this,s=e._self._c;return s("div",{staticClass:"view_footer",style:e.styleFooter(),attrs:{id:"view_footer"+(this.widgetId?"_"+this.widgetId:"")}},[s("el-form",{ref:"form",staticClass:"my-footer",attrs:{model:e.queryConfig.base,inline:!0,size:"mini"},nativeOn:{submit:function(i){i.preventDefault()}}},[e.control_order==1?[e.queryConfig.base.query_time==!0?s("el-form-item",{style:e.styleQueryTime()},[e._v(" \u67E5\u8BE2\u8017\u65F6\uFF1A "+e._s(e.query_time)+" \u79D2 ")]):e._e(),e.queryConfig.base.pagination_enable==!0?s("el-form-item",{style:e.stylePagination()},[s("el-pagination",{attrs:{size:"mini","popper-class":"white-bgc",small:e.base_pagination.small,background:e.base_pagination.background,"current-page":e.requestBody.page.pageNum,"page-size":e.pageSize,"page-sizes":e.base_pagination.pageSizes,"pager-count":e.base_pagination.pageCount,layout:e.base_pagination.layout.toString(),"prev-text":e.base_pagination.prevText,"next-text":e.base_pagination.nextText,"hide-on-single-page":e.base_pagination.hideSinglePage,total:e.queryDataList.total?e.queryDataList.total:0},on:{"update:currentPage":function(i){return e.$set(e.requestBody.page,"pageNum",i)},"update:current-page":function(i){return e.$set(e.requestBody.page,"pageNum",i)},"current-change":e.setPageNum,"size-change":e.setPageSize}})],1):e._e()]:e.control_order==2?[e.queryConfig.base.pagination_enable==!0?s("el-form-item",{style:e.stylePagination()},[s("el-pagination",{attrs:{size:"mini",small:e.base_pagination.small,background:e.base_pagination.background,"current-page":e.requestBody.page.pageNum,"page-size":e.pageSize,"page-sizes":e.base_pagination.pageSizes,"pager-count":e.base_pagination.pageCount,layout:e.base_pagination.layout.toString(),"prev-text":e.base_pagination.prevText,"next-text":e.base_pagination.nextText,"hide-on-single-page":e.base_pagination.hideSinglePage,total:e.queryDataList.total?e.queryDataList.total:0},on:{"update:currentPage":function(i){return e.$set(e.requestBody.page,"pageNum",i)},"update:current-page":function(i){return e.$set(e.requestBody.page,"pageNum",i)},"current-change":e.setPageNum,"size-change":e.setPageSize}})],1):e._e(),e.queryConfig.base.query_time==!0?s("el-form-item",{style:e.styleQueryTime()},[e._v(" \u67E5\u8BE2\u8017\u65F6\uFF1A "+e._s(e.query_time)+" \u79D2 ")]):e._e()]:e._e()],2)],1)},be=[],me=a(149500),xe={name:"view-footer",props:{widgetId:{type:String}},mixins:[I.G],data(){return{base_pagination:{},pageSize:null}},computed:{...(0,k.Se)(["query_time_fun"]),query_time(){return this.query_time_fun(this.widgetId)},control_order(){let t=1,e=this;return e.queryConfig.base.footer&&e.queryConfig.base.footer.control_list&&e.queryConfig.base.footer.control_list.length==2&&e.$$lib__.first(e.queryConfig.base.footer.control_list)=="pagination"&&(t=2),t}},watch:{"queryConfig.base.pagination":{deep:!0,handler:function(){this.initBasePagination(this.queryConfig.base.pagination)}}},created(){this.initBasePagination(this.defaultQueryConfig.base.pagination)},mounted(){const t=this;oe()().listenTo(document.getElementById("view_footer"+(this.widgetId?"_"+this.widgetId:"")),s=>{t.setViewHeight({footer:s.clientHeight,widgetId:this.widgetId})})},methods:{...(0,k.nv)(["setViewHeight"]),initBasePagination(t){t&&(this.base_pagination=JSON.parse(JSON.stringify(t))),this.pageSize=this.base_pagination.pageSize},setPageNum(t){this.setRequestBodyPage({pageNum:t,widgetId:this.widgetId}),f.Z.$emit("busQueryDataList"+(this.widgetId?"_"+this.widgetId:""))},setPageSize(t){this.setRequestBodyPage({pageNum:1,pageSize:t,widgetId:this.widgetId}),f.Z.$emit("busQueryDataList"+(this.widgetId?"_"+this.widgetId:""))},styleFooter(){let t={overflow:"hidden"};if(this.queryConfig.base.footer&&(this.queryConfig.base.footer.lineHeight&&(t.lineHeight=this.queryConfig.base.footer.lineHeight+"px"),this.queryConfig.base.footer.paddingTop&&(t.paddingTop=this.queryConfig.base.footer.paddingTop+"px"),this.queryConfig.base.footer.backgroundColor&&(t.backgroundColor=this.queryConfig.base.footer.backgroundColor),this.queryConfig.base.footer.is_footer_style&&this.queryConfig.base.footer.is_footer_style==!0)){if(!this.queryConfig.base.footer.script_footer_style||this.queryConfig.base.footer.script_footer_style=="")return me.warn("\u5E95\u90E8\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),t;me.info("\u6267\u884C\u5E95\u90E8\u6837\u5F0F\u811A\u672C");let i=new Function("style",this.queryConfig.base.footer.script_footer_style).apply(this,[t]);i&&(t=i)}let e=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.footer)):null;return e&&e.height&&(e.padding?e.height=e.height-e.padding*2:(e.paddingTop&&(e.height=e.height-e.paddingTop),e.paddingBottom&&(e.height=e.height-e.paddingBottom))),this.shapeStyle(e,t)},styleQueryTime(){let t={paddingTop:"3px"};return this.queryConfig.base.footer&&(this.queryConfig.base.footer.query_time_float&&(this.queryConfig.base.footer.query_time_float=="center"?t.textAlign=this.queryConfig.base.footer.query_time_float:t.float=this.queryConfig.base.footer.query_time_float),this.queryConfig.base.footer.query_time_margin_left&&(t.marginLeft=this.queryConfig.base.footer.query_time_margin_left+"px"),this.queryConfig.base.footer.query_time_margin_right&&(t.marginRight=this.queryConfig.base.footer.query_time_margin_right+"px")),t},stylePagination(){let t={};return this.queryConfig.base.footer&&(this.queryConfig.base.footer.pagination_float&&(this.queryConfig.base.footer.pagination_float=="center"?t.textAlign=this.queryConfig.base.footer.pagination_float:t.float=this.queryConfig.base.footer.pagination_float),this.queryConfig.base.footer.pagination_margin_left&&(t.marginLeft=this.queryConfig.base.footer.pagination_margin_left+"px"),this.queryConfig.base.footer.pagination_margin_right&&(t.marginRight=this.queryConfig.base.footer.pagination_margin_right+"px")),t}}},X=xe,P=(0,Q.Z)(X,le,be,!1,null,"38ee8cc6",null),te=P.exports,pe=a(378931),ce=a(350707),fe=function(){var e=this,s=e._self._c;return s("div",{class:"view_dialog"+(this.widgetId?"_"+this.widgetId:""),attrs:{id:"view_dialog"+(this.widgetId?"_"+this.widgetId:"")}},[e._l(e.dialog_list,function(i){return[s("el-dialog",{key:i.guid,ref:"myDialog_"+i.guid,refInFor:!0,staticClass:"query_dialog",attrs:{id:"myDialogId_"+i.guid,width:i.width+(i.width_unit==null?"px":i.width_unit),modal:i.modal,"close-on-click-modal":i.modalClose,"destroy-on-close":i.destroyOnClose,fullscreen:i.fullscreen,showClose:i.showClose,top:i.center_vertically!=!0?i.top+"px":void 0,visible:e.dialogVisible[i.guid],"append-to-body":"","before-close":e.beforeClose},on:{"update:visible":function(r){return e.$set(e.dialogVisible,i.guid,r)},open:function(r){return e.dialogOpen(i)},opened:function(r){return e.dialogOpened(i)},close:function(r){return e.dialogClose(i)},closeed:function(r){return e.dialogClosed(i)}}},[s("div",{ref:"dialogTitle_"+i.guid,refInFor:!0,style:e.getTitleStyle(i),attrs:{slot:"title",id:"dialogTitleId_"+i.guid},slot:"title"},[e._v(" "+e._s(i.title.label)+" ")]),s("div",[s("iframe",{ref:"dialogIframe_"+i.guid,refInFor:!0,style:e.getContainerStyle(i),attrs:{id:"dialog_iframe_"+i.guid,src:e.iframeURL[i.guid],frameborder:"false",scrolling:i.container.scrolling}})]),i.button.length>0?s("div",{style:e.getFooterStyle(i),attrs:{slot:"footer"},slot:"footer"},[e._l(e.getButtonList(i),function(r){return[s("el-button",{key:r.guid,style:e.buttonStyle(r),attrs:{size:r.size,disabled:r.disabled,type:r.style=="text"?"text":"",plain:r.style=="plain",round:r.style=="round",circle:r.style=="circle"},on:{click:function(o){return e.buttonClick(i,r)}}},[!r.icon_align||r.icon_align==e.global_query.position.left.code?s("i",{class:r.icon}):e._e(),e._v(" "+e._s(r.label)+" "),r.icon_align==e.global_query.position.right.code?s("i",{class:r.icon}):e._e()])]})],2):e._e()])]})],2)},Se=[],N=a(149500),De={name:"view-dialog",props:{widgetId:{type:String}},mixins:[I.G],data(){return{globalEditor:this.$$global_editor,dialog_list:[],dialogVisible:{},current_dialog_id:null,iframeURL:{}}},watch:{"queryConfig.dialog":{deep:!0,handler:function(){this.getDialogList()}}},mounted(){this.getDialogList(),f.Z.$on("busOpenDialog"+(this.widgetId?"_"+this.widgetId:""),(t,e)=>{this.doOpenDialog(t,e)}),f.Z.$on("busCloseDialog"+(this.widgetId?"_"+this.widgetId:""),(t,e)=>{this.doCloseDialog(t,e)})},methods:{getDialogList(){this.dialog_list=[],this.$$lib__.each(this.queryConfig.dialog,t=>{let e=JSON.parse(JSON.stringify(t));y.default.set(this.dialogVisible,t.guid,!1),y.default.set(this.iframeURL,t.guid,this.getUrl(t)),this.setListenerPostMessage(e),this.dialog_list.push(e)})},setIframeUrl(t){if(t){let e=this.$$lib__.find(this.queryConfig.dialog,s=>s.guid==t);e&&y.default.set(this.iframeURL,t,this.getUrl(e))}else this.$$lib__.each(this.queryConfig.dialog,e=>{y.default.set(this.iframeURL,e.guid,this.getUrl(e))})},doOpenDialog(t,e){this.setIframeUrl(t),e&&e(this.dialogVisible,this.iframeURL,this.dialog_list),this.dialogVisible[t]=!0},doCloseDialog(t,e){e&&e(this.dialogVisible,this.iframeURL,this.dialog_list),this.dialogVisible[t]=!1},getTitleStyle(t){let e={backgroundColor:"#FFFFFF",textAlign:"left",padding:"16px",overflow:"hidden",wordWrap:"break-word",wordBreak:"break-all",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",borderBottom:"1px solid #E4E8ED",fontSize:"16px",color:"#2E3033",fontStyle:"normal",fontWeight:500};return t.title&&t.title.is_title_style==!0?!t.title.title_style||t.title.title_style==""?(N.warn("\u5F39\u7A97"+t.name+" \u6807\u9898\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),e):(N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u6807\u9898\u6837\u5F0F\u811A\u672C"),new Function("style,dialog_config",t.title.title_style).apply(this,[e,t])):e},getContainerStyle(t){let e={};if(t.fullscreen&&!t.container.height)e.height=document.body.offsetHeight-110+"px";else{let s=t.container.height;t.container.height_unit=="%"&&(s=document.body.offsetHeight*s/100,t.container.height_min&&t.container.height_min!=""&&t.container.height_min>s&&(s=t.container.height_min)),e.height=s+"px"}return e.width="100%",e.display="block",t.container&&t.container.is_container_style==!0?!t.container.container_style||t.container.container_style==""?(N.warn("\u5F39\u7A97"+t.name+" \u5185\u5BB9\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),e):(N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u5185\u5BB9\u6837\u5F0F\u811A\u672C"),new Function("style,dialog_config",t.container.container_style).apply(this,[e,t])):e},getFooterStyle(t){let e={backgroundColor:"#FFFFFF",padding:"10px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px",borderTop:"1px solid #E4E8ED"};return t.footer.align&&t.footer.align!=""&&(e.textAlign=t.footer.align),t.footer&&t.footer.is_footer_style==!0?!t.footer.footer_style||t.footer.footer_style==""?(N.warn("\u5E95\u90E8"+t.name+" \u6309\u94AE\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),e):(N.info("\u6267\u884C\u5E95\u90E8"+t.name+" \u6309\u94AE\u6837\u5F0F\u811A\u672C"),new Function("style,dialog_config",t.footer.footer_style).apply(this,[e,t])):e},getButtonList(t){let e=this.$$lib__.filter(JSON.parse(JSON.stringify(t.button)),s=>s.hide!=!0);return this.$$lib__.sortBy(e,"order")},buttonStyle(t){let e={};return t.backgroundColor&&(e.backgroundColor=t.backgroundColor),t.color&&(e.color=t.color),t.width&&(e.width=t.width+"px"),e},buttonClick(t,e){if(!e.footer_button_click||e.footer_button_click==""){N.warn("\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 \u6309\u94AE"+e.name+" \u811A\u672C\u4E3A\u7A7A");return}N.info("\u6267\u884C\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 \u6309\u94AE"+e.name+" \u811A\u672C"),new Function("dialog_config,button",e.footer_button_click).apply(this,[t,e])},dialogOpen(t){if(t.center_vertically==!0){let e=document.getElementById("myDialogId_"+t.guid);this.$nextTick(()=>{e.style.justifyContent="center",e.style.alignItems="center",e.style.display="flex",e.childNodes&&e.childNodes[0]&&(e.childNodes[0].style.margin="0 auto")})}t.is_dialog_open==!0&&((!t.dialog_open||t.dialog_open=="")&&N.warn("\u5F39\u7A97"+t.name+" \u6253\u5F00\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A"),N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u6253\u5F00\u4E8B\u4EF6\u811A\u672C"),new Function("dialog_config",t.dialog_open).apply(this,[t])),this.current_dialog_id=t.guid},dialogOpened(t){t.title.button_style_enable==!0&&(t.title.is_title_button_style==!0?((!t.title.title_button_style||t.title.title_button_style=="")&&N.warn("\u5F39\u7A97\u6807\u9898\u5185\u7684\u6309\u94AE"+t.name+" \u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),N.info("\u6267\u884C\u5F39\u7A97\u6807\u9898\u5185\u7684\u6309\u94AE"+t.name+" \u6837\u5F0F\u811A\u672C"),new Function("dialog_config",t.title.title_button_style).apply(this,[t])):this.setTitleButtonStyle(t)),t.is_dialog_opened==!0&&((!t.dialog_opened||t.dialog_opened=="")&&N.warn("\u5F39\u7A97"+t.name+" \u6253\u5F00\u540E\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A"),N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u6253\u5F00\u540E\u4E8B\u4EF6\u811A\u672C"),new Function("dialog_config",t.dialog_opened).apply(this,[t])),this.isDraggable(t)},setTitleButtonStyle(t){let e=this.$refs["dialogTitle_"+t.guid];e&&e[0]&&e[0].parentElement&&e[0].children&&this.$$lib__.each(e[0].parentElement.children,s=>{s.tagName&&s.tagName.toLocaleLowerCase()=="button"&&(t.title.button_style_top&&(s.style.top=t.title.button_style_top+"px"),t.title.button_style_right&&(s.style.right=t.title.button_style_right+"px"),s.children&&s.children[0]&&s.children[0].tagName&&s.children[0].tagName.toLocaleLowerCase()=="i"&&(t.title.button_style_color&&(s.children[0].style.color=t.title.button_style_color),t.title.button_style_fontSize&&(s.children[0].style.fontSize=t.title.button_style_fontSize+"px"),t.title.button_style_icon&&(s.children[0].className="el-dialog__close "+t.title.button_style_icon)))})},beforeClose(t){let e=this.$$lib__.find(this.queryConfig.dialog,s=>s.guid==this.current_dialog_id);if(e&&e.is_before_close==!0){if(!e.before_close||e.before_close==""){N.warn("\u5F39\u7A97"+e.name+" \u5173\u95ED\u524D\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}N.info("\u6267\u884C\u5F39\u7A97"+e.name+" \u5173\u95ED\u524D\u4E8B\u4EF6\u811A\u672C"),new Function("done,dialog_config",e.before_close).apply(this,[t,e])}else t()},dialogClose(t){if(t.is_dialog_close==!0){if(!t.dialog_close||t.dialog_close==""){N.warn("\u5F39\u7A97"+t.name+" \u5173\u95ED\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u5173\u95ED\u4E8B\u4EF6\u811A\u672C"),new Function("dialog_config",t.dialog_close).apply(this,[t])}},dialogClosed(t){if(t.is_dialog_closed==!0){if(!t.dialog_closed||t.dialog_closed==""){N.warn("\u5F39\u7A97"+t.name+" \u5173\u95ED\u540E\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u5173\u95ED\u540E\u4E8B\u4EF6\u811A\u672C"),new Function("dialog_config",t.dialog_closed).apply(this,[t])}this.current_dialog_id=null},getUrl(t){let e=t.container.url;return this.$$lib__.each(t.container.url_param,s=>{let i=new RegExp("[${]([^$]"+s.name+")[}]","g");s.type==this.globalEditor.iframeUrlParamsType.static.code?e=e.replace(i,s.staticValue):s.type==this.globalEditor.iframeUrlParamsType.globalParams.code?e=e.replace(i,this.getGlobalParamFun(s.globalParamName,this.widgetId)):s.type==this.globalEditor.iframeUrlParamsType.row.code&&this.currentRow&&this.currentRow.row&&(e=e.replace(i,this.currentRow.row[s.fieldName]))}),e},setListenerPostMessage(t){if(t.container&&t.container.listener_postMessage_enabled==!0){if(N.log("Execute script for \u5F39\u7A97\u76D1\u542CpostMessage "+t.name+" action"),t.container.script_listener_postMessage==""){H.Message.warning({message:"\u5F39\u7A97\u76D1\u542CpostMessage\uFF0C\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}window.addEventListener("message",e=>{if(e.source.self!=window.top&&e.target.self==window.top)if(e.origin==window.origin){if(e.source&&e.source.frameElement&&e.source.frameElement.id=="dialog_iframe_"+t.guid){let s=this.onPostMessage,i=t.container.origin;i&&(i==="*"||i!="*"&&i.indexOf(e.origin)>-1)&&s.apply(this,[t,e])}}else{let s=this.onPostMessage,i=t.container.origin;i&&(i==="*"||i!="*"&&i.indexOf(e.origin)>-1)&&s.apply(this,[t,e])}else if(e.source.self!=window.top&&e.target.self!=window.top){let s=this.onPostMessage,i=t.container.origin;i&&(i==="*"||i!="*"&&i.indexOf(e.origin)>-1)&&s.apply(this,[t,e])}})}},onPostMessage(t,e){let s={data:e.data,source:e};try{N.info("\u6267\u884C\u5F39\u7A97"+t.name+" \u76D1\u542C\u7684postmessage\u4FE1\u606F\u811A\u672C"),new Function("param,dialog_config",t.container.script_listener_postMessage).apply(this,[s,t])}catch(i){N.error("\u6267\u884C\u5F39\u7A97"+t.name+" \u76D1\u542C\u7684postmessage\u4FE1\u606F\u811A\u672C\u51FA\u9519"),N.error(i)}},isDraggable(t){if(t.draggable==!0){let e=document.getElementById("myDialogId_"+t.guid);e.style.top=0,e.style.right=0,e.style.bottom=0,e.style.left=0,e.style.overflow="auto",e.style.width="100%",t.center_vertically==!0&&(e.style.justifyContent="center",e.style.alignItems="center",e.style.display="flex",e.style.position="fixed"),this.onEventDrag(t)}},onEventDrag(t){let e="dialogTitleId_"+t.guid;const s=document.getElementById(e),i=s.parentElement.parentElement;s.style.cursor="move",s.style.userSelect="none",s.onmousedown=r=>{r.stopPropagation();const o=r.clientX,h=r.clientY,G=i.style.left&&i.style.left!=""?parseInt(i.style.left):0,B=i.style.top&&i.style.top!=""?parseInt(i.style.top):0;document.onmousemove=ie=>{const Y=ie.clientX-o,ke=ie.clientY-h,Te=G+Y,Ze=B+ke;i.style.left=Te+"px",i.style.top=Ze+"px"}},document.onmouseup=function(){document.onmousemove=null}}}},Le=De,Fe=(0,Q.Z)(Le,fe,Se,!1,null,"4716cf34",null),Pe=Fe.exports,de=a(857124),he=function(){var e=this,s=e._self._c;return s("div",{staticClass:"my-query-card",style:e.cardStyle(),attrs:{id:"my_query_card"+(this.widgetId?"_"+this.widgetId:"")}},[s("div",{style:{display:"inline-block",width:e.calcInfo.cardDivWidth+"px"}},e._l(e.queryDataList.list,function(i,r){return s("div",{key:r,staticClass:"my-el-card",class:e.base_card.shadow?"is-"+e.base_card.shadow+"-shadow":"is-always-shadow",style:e.MyCardStyle(r)},[e.isShowColumnOperation(e.global_query.position.top.code)?s("div",{staticClass:"my-el-card__header",style:e.MyButtonStyle()},e._l(e.button_list,function(o){return s("a",{key:o.guid+"_"+r},[s("button-tooltip",{attrs:{button_config:o,scope:{row:i,column:null,$index:r}}},[o.isDropdown?s("el-dropdown",{attrs:{trigger:o.trigger,placement:o.placement,"hide-on-click":o.hide_on_click},on:{command:function(h){return e.onClickButton({row:i,column:null,$index:r},o,arguments)}}},[s("button-tooltip",{attrs:{button_config:o,scope:{row:i,column:null,$index:r}}},[s("el-button",{style:e.buttonStyle({row:i,column:null,$index:r},o),attrs:{size:o.size,disabled:o.disabled,type:o.style=="text"?"text":"",plain:o.style=="plain",round:o.style=="round",circle:o.style=="circle"},on:{click:function(h){return e.onClickButton({row:i,column:null,$index:r},o)}}},[!o.icon_align||o.icon_align==e.global_query.position.left.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e(),e._v(" "+e._s(o.label)+" "),o.icon_align==e.global_query.position.right.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(o.children,function(h){return s("el-dropdown-item",{key:h.guid+"_"+r,style:e.buttonStyle({row:i,column:null,$index:r},h),attrs:{command:h.guid,divided:h.divided,disabled:h.disabled}},[s("button-tooltip",{attrs:{button_config:h,scope:{row:i,column:null,$index:r}}},[s("span",[!h.icon_align||h.icon_align==e.global_query.position.left.code?s("i",{class:h.icon,style:e.iconStyle(h)}):e._e(),s("span",{style:{color:h.color,marginRight:"5px"}},[e._v(e._s(h.label))]),h.icon_align==e.global_query.position.right.code?s("i",{class:h.icon,style:e.iconStyle(h)}):e._e()])])],1)}),1)],1):s("el-button",{style:e.buttonStyle({row:i,column:null,$index:r},o),attrs:{size:o.size,disabled:o.disabled,type:o.style=="text"?"text":"",plain:o.style=="plain",round:o.style=="round",circle:o.style=="circle"},on:{click:function(h){return e.onClickButton({row:i,column:null,$index:r},o)}}},[!o.icon_align||o.icon_align==e.global_query.position.left.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e(),e._v(" "+e._s(o.label)+" "),o.icon_align==e.global_query.position.right.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e()])],1)],1)}),0):e._e(),s("div",{staticClass:"cardbackground",style:e.bodyStyle(),on:{click:e.onClick}},[e.base_card.display=="form"?s("el-descriptions",{attrs:{border:e.base_card.form_border,colon:e.base_card.form_colon,size:e.base_card.form_size,column:e.base_card.form_column,direction:e.base_card.form_direction}},e._l(e.column_field,function(o){return s("el-descriptions-item",{key:o.guid,attrs:{label:o.label,labelStyle:e.labelStyle(o),contentStyle:e.contentStyle(o,i[o.field])}},[o.is_cell_slot!=!0&&o.is_cell_click!=!0?s("p",{on:{click:function(h){return e.cellClick(i,o)}}},[e._v(" "+e._s(i[o.field])+" ")]):o.is_cell_slot!=!0&&o.is_cell_click==!0?s("p",{staticStyle:{color:"#409EFF","text-decoration":"underline",cursor:"pointer"},on:{click:function(h){return e.cellClick(i,o)}}},[e._v(" "+e._s(i[o.field])+" ")]):s("p",{domProps:{innerHTML:e._s(e.getCellSlot(i,r,o))},on:{click:function(h){return e.cellClick(i,o)}}})])}),1):e._e(),e.base_card.display=="custom"?[e.isDesign?e._l(e.column_field,function(o,h){return s("vue-draggable-resizable-rotatable",{key:o.guid+"_"+r,style:e.contentStyle(o,i[o.field]),attrs:{id:o.guid+"_id_"+r,rotatable:!1,snap:!0,x:o.x,y:o.y,z:h,r:o.deg,h:o.h,w:o.w,active:e.onActive(o)},on:{onClicked:e.onClicked,rotatestop:e.onRotatestop,dragstop:e.onDragstop,resizestop:e.onResizstop}},[o.is_cell_slot!=!0&&o.is_cell_click!=!0?s("p",[e.base_card.custom_label==!0?[e._v(" "+e._s(o.label)+e._s(e.base_card.custom_label_separator)+" ")]:e._e(),e._v(" "+e._s(i[o.field])+" ")],2):o.is_cell_slot!=!0&&o.is_cell_click==!0?s("p",{staticStyle:{color:"#409EFF","text-decoration":"underline",cursor:"pointer"}},[e.base_card.custom_label==!0?[e._v(" "+e._s(o.label)+e._s(e.base_card.custom_label_separator)+" ")]:e._e(),e._v(" "+e._s(i[o.field])+" ")],2):s("p",{domProps:{innerHTML:e._s(e.getCellSlot(i,r,o))}})])}):e._l(e.column_field,function(o){return s("div",{key:o.guid+"_"+r,style:e.contentStyle(o,i[o.field]),attrs:{id:o.guid+"_id_"+r},on:{click:function(h){return e.cellClick(i,o)}}},[o.is_cell_slot!=!0&&o.is_cell_click!=!0?s("p",[e.base_card.custom_label==!0?[e._v(" "+e._s(o.label)+e._s(e.base_card.custom_label_separator)+" ")]:e._e(),e._v(" "+e._s(i[o.field])+" ")],2):o.is_cell_slot!=!0&&o.is_cell_click==!0?s("p",{staticStyle:{color:"#409EFF","text-decoration":"underline",cursor:"pointer"}},[e.base_card.custom_label==!0?[e._v(" "+e._s(o.label)+e._s(e.base_card.custom_label_separator)+" ")]:e._e(),e._v(" "+e._s(i[o.field])+" ")],2):s("p",{domProps:{innerHTML:e._s(e.getCellSlot(i,r,o))}})])})]:e._e()],2),e.isShowColumnOperation(e.global_query.position.bottom.code)?s("div",{staticClass:"my-el-card__bottom",style:e.MyButtonStyle()},e._l(e.button_list,function(o){return s("a",{key:o.guid+"_"+r},[s("button-tooltip",{attrs:{button_config:o,scope:{row:i,column:null,$index:r}}},[o.isDropdown?s("el-dropdown",{attrs:{trigger:o.trigger,placement:o.placement,"hide-on-click":o.hide_on_click},on:{command:function(h){return e.onClickButton({row:i,column:null,$index:r},o,arguments)}}},[s("button-tooltip",{attrs:{button_config:o,scope:{row:i,column:null,$index:r}}},[s("el-button",{style:e.buttonStyle({row:i,column:null,$index:r},o),attrs:{size:o.size,disabled:o.disabled,type:o.style=="text"?"text":"",plain:o.style=="plain",round:o.style=="round",circle:o.style=="circle"},on:{click:function(h){return e.onClickButton({row:i,column:null,$index:r},o)}}},[!o.icon_align||o.icon_align==e.global_query.position.left.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e(),e._v(" "+e._s(o.label)+" "),o.icon_align==e.global_query.position.right.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e()])],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(o.children,function(h){return s("el-dropdown-item",{key:h.guid+"_"+r,style:e.buttonStyle({row:i,column:null,$index:r},h),attrs:{command:h.guid,divided:h.divided,disabled:h.disabled}},[s("button-tooltip",{attrs:{button_config:h,scope:{row:i,column:null,$index:r}}},[s("span",[!h.icon_align||h.icon_align==e.global_query.position.left.code?s("i",{class:h.icon,style:e.iconStyle(h)}):e._e(),s("span",{style:{color:h.color,marginRight:"5px"}},[e._v(e._s(h.label))]),h.icon_align==e.global_query.position.right.code?s("i",{class:h.icon,style:e.iconStyle(h)}):e._e()])])],1)}),1)],1):s("el-button",{style:e.buttonStyle({row:i,column:null,$index:r},o),attrs:{size:o.size,disabled:o.disabled,type:o.style=="text"?"text":"",plain:o.style=="plain",round:o.style=="round",circle:o.style=="circle"},on:{click:function(h){return e.onClickButton({row:i,column:null,$index:r},o)}}},[!o.icon_align||o.icon_align==e.global_query.position.left.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e(),e._v(" "+e._s(o.label)+" "),o.icon_align==e.global_query.position.right.code?s("i",{class:o.icon,style:e.iconStyle(o)}):e._e()])],1)],1)}),0):e._e()])}),0)])},Ie=[],we=a(787479),ne=a(149500),Ee={name:"view-main-card",components:{VueDraggableResizableRotatable:we.Z,ButtonTooltip:E.Z},mixins:[I.G],props:{widgetId:{type:String},isDesign:{type:Boolean,default:!1}},data(){return{base_card:{},draggable:{current_field:null},calcInfo:{clientWidth:0,rowDivLen:1,cardDivWidth:0,cardWidth:0}}},computed:{...(0,k.Se)(["view_height_fun","customerFieldsFun"]),view_height(){return this.view_height_fun(this.widgetId)},customerFields(){return this.customerFieldsFun(this.widgetId)},column_field(){return this.rebuildData()},card_height(){return this.view_height.page-this.view_height.header-this.view_height.footer-this.getPaddingTopTable()-this.getPaddingTopBody()},button_list(){let t=this,e={button:[],dropdown:[]},s={};return t.$$lib__.each(t.$$lib__.sortBy(t.queryConfig.button,"order"),i=>{i.button_position==this.global_query.button_position.row.code&&i.hide!=!0&&(i.isDropdown?(i.children=[],e.dropdown.push(i)):i.parent&&i.parent!=""?(s[i.parent]||y.default.set(s,i.parent,[]),s[i.parent].push(i)):e.button.push(i))}),t.$$lib__.each(e.dropdown,i=>{for(let r in s)i.guid==r&&(i.children=s[r]);e.button.push(i)}),t.$$lib__.sortBy(e.button,"order")}},watch:{"queryConfig.base.card":{deep:!0,handler:function(){this.initBaseTable(this.queryConfig.base)}},column_field(){this.rebuildData()},customerFields(){this.rebuildData()}},mounted(){const t=this;oe()().listenTo(document.getElementById("my_query_card"+(this.widgetId?"_"+this.widgetId:"")),()=>{t.getCalcInfo()}),this.$nextTick(()=>{this.getCalcInfo()}),f.Z.$on("busSetDraggableCurrentField",s=>{this.draggable.current_field=this.$$lib__.find(this.queryConfig.field,i=>i.guid==s)})},methods:{...(0,k.nv)(["updateQueryConfigField"]),initBaseTable(t){t.card&&(this.base_card=JSON.parse(JSON.stringify(t.card)))},getPaddingTopTable(){let t=0,e=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.table)):null;return e&&(e.padding?t=t+e.padding*2:(e.paddingTop&&(t=t+e.paddingTop),e.paddingBottom&&(t=t+e.paddingBottom))),t},getPaddingTopBody(){let t=0,e=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape)):null;return e&&(e.padding?t=t+e.padding*4:(e.paddingTop&&(t=t+e.paddingTop*2),e.paddingBottom&&(t=t+e.paddingBottom*2))),t},rebuildData(){let t=this.$$lib__.filter(this.queryConfig.field,s=>this.customerFields==null?!0:this.$$lib__.contains(this.customerFields,s.guid)),e=[];return this.$$lib__.each(t,s=>{s.hide!=!0&&(s.id=s.field,s.type="field",s.parent_guid=s.header_id,e.push(s))}),e=this.$$lib__.sortBy(e,"order"),e},cellClick(t,e){if(!e||!e.is_cell_click||e.is_cell_click!=!0)return;if(!e.script_cell_click||e.script_cell_click==""){ne.warn("\u70B9\u51FB\u4E8B\u4EF6 \u5B57\u6BB5"+e.fieldy+" \u811A\u672C\u4E3A\u7A7A");return}ne.info("\u6267\u884C\u70B9\u51FB\u4E8B\u4EF6 \u5B57\u6BB5"+e.field+" \u811A\u672C"),new Function("row","column","cell","event","column_config",e.script_cell_click).apply(this,[t,e,null,null,e])},getCellSlot(t,e,s){if(!s.script_cell_slot||s.script_cell_slot==""){ne.warn("\u81EA\u5B9A\u4E49\u5185\u5BB9 \u5B57\u6BB5"+s.field+" \u811A\u672C\u4E3A\u7A7A");return}return ne.info("\u6267\u884C\u81EA\u5B9A\u4E49\u5185\u5BB9 \u5B57\u6BB5"+s.field+" \u811A\u672C"),new Function("row","column","$index","column_config",s.script_cell_slot).apply(this,[t,s,e,s])},labelStyle(t){let e={};return this.base_card.form_border!=!0&&(e.display="block"),t.width?e.width=t.width+"px":this.base_card.form_label_width&&(e.width=this.base_card.form_label_width+"px"),t.header_align&&(e.textAlign=t.header_align),e},buttonStyle(t,e){let s={};if(e.marginLeft&&(s.marginLeft=e.marginLeft+"px"),e.backgroundColor&&(s.backgroundColor=e.backgroundColor),e.color&&(s.color=e.color),e.width&&(s.width=e.width+"px"),e.is_button_style&&e.is_button_style==!0){if(!e.script_button_style||e.script_button_style=="")return ne.warn("\u6309\u94AE\u6837\u5F0F "+e.name+" \u811A\u672C\u4E3A\u7A7A"),s;ne.info("\u6267\u884C\u6309\u94AE\u6837\u5F0F "+e.name+" \u811A\u672C");let r=new Function("row","column","$index","button_config","style",e.script_button_style).apply(this,[t.row,t.column,t.$index,e,s]);r&&(s=r)}return s},iconStyle(t){let e={};return t.icon_color&&t.icon_color!=""?e.color=t.icon_color:e.color="#99A9BF",e},MyButtonStyle(){let t={};return this.base_card.button_height&&(t.height=this.base_card.button_height+"px"),this.base_card.button_align&&(t.textAlign=this.base_card.button_align),this.base_card.button_padding?t.padding=this.base_card.button_padding+"px":(t.paddingLeft=this.base_card.button_paddingLeft+"px",t.paddingTop=this.base_card.button_paddingTop+"px",t.paddingRight=this.base_card.button_paddingRight+"px",t.paddingBottom=this.base_card.button_paddingBottom+"px"),t},onClickButton(t,e,s){setTimeout(()=>{if(e.isDropdown&&s&&s[0]){let i=this.$$lib__.find(e.children,r=>r.guid==s[0]);i&&(e=i)}if(e.is_click&&e.is_click==!0){if(!e.script_click||e.script_click==""){ne.warn("\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 "+e.name+" \u811A\u672C\u4E3A\u7A7A");return}ne.info("\u6267\u884C\u6309\u94AE\u70B9\u51FB\u4E8B\u4EF6 "+e.name+" \u811A\u672C"),new Function("row","column","$index","button_config",e.script_click).apply(this,[t.row,t.column,t.$index,e])}else this.scriptClick(t.row,t.column,t.$index,e)},50)},scriptClick(t,e,s,i){i.dialog_id&&i.dialog_id!=""&&this.openDialog(i.dialog_id)},isShowColumnOperation(t){let e=!0;return this.base_card.button_hide==!0&&(e=this.button_list.length>0),e&&this.base_card.button_position==t},contentStyle(t,e){let s={};if(t.header_align&&(s.textAlign=t.align),this.base_card.display=="form")this.base_card.form_border!=!0&&(s.display="block");else if(this.base_card.display=="custom"&&(this.isDesign==!1&&(s.position="absolute",s.width=t.w+"px",s.height=t.h+"px",s.top=t.y+"px",s.left=t.x+"px",s.transform="rotate("+t.deg+"deg)"),t.fontFamily&&(s.fontFamily=t.fontFamily),t.fontSize&&(s.fontSize=t.fontSize+"px"),t.color&&(s.color=t.color),t.backgroundColor&&(s.backgroundColor=t.backgroundColor),t.borderRadius&&(s.borderRadius=t.borderRadius+"px"),t.is_card_style&&t.is_card_style==!0)){if(!t.script_card_style||t.script_card_style=="")return ne.warn("\u5185\u5BB9\u6837\u5F0F\u811A\u672C\u4E3A\u7A7A"),s;ne.info("\u6267\u884C\u5185\u5BB9\u6837\u5F0F\u811A\u672C");let i=new Function("field_config","content_value","style",t.script_card_style),r={};try{r=i.apply(this,[t,e,s]),r&&(s=r)}catch{ne.error("\u6267\u884C\u6574\u4F53\u6837\u5F0F\u811A\u672C\u62A5\u9519\u5F02\u5E38")}}return s},bodyStyle(){let t={backgroundColor:this.base_card.backgroundColor};return this.base_card.padding?t.padding=this.base_card.padding+"px":(t.paddingLeft=this.base_card.paddingLeft+"px",t.paddingTop=this.base_card.paddingTop+"px",t.paddingRight=this.base_card.paddingRight+"px",t.paddingBottom=this.base_card.paddingBottom+"px"),this.base_card.display=="custom"&&(t.position="relative",this.base_card.custom_height&&(t.height=this.base_card.custom_height+"px")),t},MyCardStyle(t){let e={float:"left",width:this.base_card.width+"px",marginRight:this.base_card.marginRight+"px",marginBottom:this.base_card.marginBottom+"px"};return this.base_card.width&&this.base_card.width!=0?this.base_card.marginRight&&this.base_card.marginRight!=0&&(this.calcInfo.rowDivLen>1?(t+1)%this.calcInfo.rowDivLen==0&&(e.marginRight=void 0):e.marginRight=void 0):(e.width=this.calcInfo.clientWidth-2+"px",this.base_card.marginRight&&this.base_card.marginRight!=0&&(e.width=this.calcInfo.clientWidth-2-this.base_card.marginRight+"px")),this.base_card.height&&(e.height=this.base_card.height+"px"),e},getCalcInfo(){let t=window.document.getElementById("my_query_card"+(this.widgetId?"_"+this.widgetId:""));if(t){let e=this.getPaddingValue();this.calcInfo.clientWidth=t.clientWidth-e,this.calcInfo.cardDivWidth=this.calcInfo.clientWidth}this.calcInfo.cardWidth=0,this.base_card.width&&this.base_card.width!=0?(this.calcInfo.cardWidth=this.base_card.width,this.base_card.marginRight&&this.base_card.marginRight!=0&&(this.calcInfo.cardWidth=this.base_card.width+this.base_card.marginRight),this.calcInfo.rowDivLen=Math.floor(this.calcInfo.clientWidth/this.calcInfo.cardWidth),this.calcInfo.rowDivLen*(this.calcInfo.cardWidth+2)+this.base_card.width+2<=this.calcInfo.clientWidth&&(this.calcInfo.rowDivLen=this.calcInfo.rowDivLen+1),this.calcInfo.cardDivWidth=(this.calcInfo.rowDivLen-1)*(this.calcInfo.cardWidth+2)+this.base_card.width+2):this.calcInfo.rowDivLen=1},getPaddingValue(){let t=0,e=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.table)):null;return e&&(e.padding&&e.padding!=""&&e.padding!=0?t=e.padding*2:(e.paddingLeft&&(t=t+e.paddingLeft),e.paddingRight&&(t=t+e.paddingRight))),t},cardStyle(){this.$nextTick(()=>{if(this.base_card.display=="form"){let s=this.$el.getElementsByClassName("el-descriptions__table");this.$$lib__.each(s,i=>{this.base_card.fixed_height==!0&&this.base_card.custom_height?i.style.height=this.base_card.custom_height+"px":i.style.height="auto"})}});let t=this.queryConfig.base.shape!=null?JSON.parse(JSON.stringify(this.queryConfig.base.shape.table)):null,e={height:this.card_height+"px"};return this.base_card.text_align&&(e.textAlign=this.base_card.text_align),this.shapeStyle(t,e)},onDragstop(t,e){if(this.draggable.current_field&&(this.draggable.current_field.x!=t||this.draggable.current_field.y!=e)&&this.queryConfig.field&&this.queryConfig.field.length>0){for(let s=0;s<this.queryConfig.field.length;s++)if(this.queryConfig.field[s].guid==this.draggable.current_field.guid){this.queryConfig.field[s].x=t,this.queryConfig.field[s].y=e,this.changeQueryConfigField();break}}},onRotatestop(t){if(this.draggable.current_field&&this.draggable.current_field.x!=t&&this.queryConfig.field&&this.queryConfig.field.length>0){for(let e=0;e<this.queryConfig.field.length;e++)if(this.queryConfig.field[e].guid==this.draggable.current_field.guid){this.queryConfig.field[e].deg=t,this.changeQueryConfigField();break}}},onResizstop(t,e,s,i){if(this.queryConfig.field&&this.queryConfig.field.length>0){for(let r=0;r<this.queryConfig.field.length;r++)if(this.queryConfig.field[r].guid==this.draggable.current_field.guid){this.queryConfig.field[r].x=t,this.queryConfig.field[r].y=e,this.queryConfig.field[r].w=s,this.queryConfig.field[r].h=i,this.changeQueryConfigField();break}}},onClick(t){typeof t.target.className=="string"&&t.target.className.indexOf("cardbackground")>-1&&(this.draggable.current_field=null)},onActive(t){return this.draggable.current_field==null?!1:t.guid==this.draggable.current_field.guid},onClicked(t){if(this.isDesign==!1){this.draggable.current_field=null;return}if(t&&t.currentTarget){let e=t.currentTarget.id;if(e&&e.indexOf("_id_")>-1){let s=e.substr(0,e.indexOf("_id_"));s&&(!this.draggable.current_field||s!=this.draggable.current_field.guid)&&(this.draggable.current_field=this.$$lib__.find(this.queryConfig.field,i=>i.guid==s),f.Z.$emit("busSetCurrentField",s))}}},changeQueryConfigField(){this.updateQueryConfigField(this.queryConfig.field),this.$nextTick(()=>{f.Z.$emit("busReloadCurrentField",this.draggable.current_field.guid)})}},beforeDestroy(){f.Z.$off("busSetDraggableCurrentField")}},ze=Ee,Oe=(0,Q.Z)(ze,he,Ie,!1,null,"2efeb4f1",null),Ne=Oe.exports,Me=a(678481),qe=a(149500),Re={name:"query-view",components:{ViewMainCard:Ne,ViewDialog:Pe,ViewFooter:te,ViewMain:J,ViewHeader:W},mixins:[U.E],props:{isBoard:{type:Boolean,default:!1},widgetId:{type:String},isDesign:{type:Boolean,default:!1},queryListId:{type:String},queryListPublishId:{type:String},thisAccessType:{type:String},applicationId:{type:String}},data(){return{query_result_data:null,fixed_both:{left:!1,right:!1},isInit:!0}},created(){f.Z.$on("busGetFieldEnumJson"+(this.widgetId?"_"+this.widgetId:""),()=>{this.getFieldEnumJson()}),f.Z.$on("busGetDataSetJson"+(this.widgetId?"_"+this.widgetId:""),()=>{this.getDataSetJson()}),f.Z.$on("busGetRequestDataJson"+(this.widgetId?"_"+this.widgetId:""),(t,e,s)=>{this.getRequestDataJson(t,e,s)}),f.Z.$on("busQueryDataList"+(this.widgetId?"_"+this.widgetId:""),()=>{this.getQueryDataList()}),f.Z.$on("busExportExcel"+(this.widgetId?"_"+this.widgetId:""),t=>{this.exportExcel(t)})},computed:{customerQuery(){let t=this.customerQueryFun(this.widgetId);return t&&t.length>0?JSON.parse(JSON.stringify(this.$$lib__.sortBy(t,"number").reverse())):[]}},watch:{"enumInfo.isOk":{deep:!0,handler:function(){this.newQueryDataList()}},"datasetInfo.datasetJson":{deep:!0,handler:function(){this.newQueryDataList()}}},mounted(){const t=this;oe()().listenTo(document.getElementById("query_view"+(this.widgetId?"_"+this.widgetId:"")),s=>{t.setViewHeight({page:s.clientHeight,widgetId:this.widgetId})})},methods:{...(0,k.nv)(["setQueryAppId","setQueryId","setApplicationIdEx","setQueryConfig","setQueryPublishId","setQueryDataList","setQueryTime","setBoardInfo","setViewHeight","updateQueryConfigDialog"]),initQueryInfo(t){this.setBoardInfo({isBoard:this.isBoard,widgetId:this.widgetId}),this.setQueryId({queryId:this.queryListId,widgetId:this.widgetId}),this.setQueryPublishId({queryPublishId:this.queryListPublishId,widgetId:this.widgetId}),this.setQueryAppId({queryAppId:this.applicationId,widgetId:this.widgetId}),this.setApplicationIdEx(this.applicationId),this.setWaterMark(),this.getQueryConfigInfo(()=>{this.getFieldEnumJson(),this.getDataSetJson(),this.getCustomerQuery(),this.getQueryDataList(),this.checkQueryListConfig(),t&&t()})},getQueryConfigInfo(t){if(this.isDesign){if(!this.queryId){H.Message.warning({message:"\u8BF7\u5728\u53F3\u4FA7\u6570\u636E\u914D\u7F6E\u4E2D\uFF0C\u9009\u62E9\u5DF2\u914D\u7F6E\u7684\u67E5\u8BE2\u5217\u8868\uFF0C\u6216\u65B0\u589E\u67E5\u8BE2\u5217\u8868\uFF0C\u5E76\u8FDB\u884C\u914D\u7F6E",offset:60});return}this.loading=!0,pe.y.getQueryListConfigNoButtonAuthorize(this.queryId).then(e=>{this.afterGetQueryListConfig(e,t),f.Z.$emit("busSetAutoSave")})}else if(this.thisAccessType){if(this.queryId==null&&this.queryPublishId==null){qe.error("\u67E5\u8BE2\u5217\u8868ID\u548C\u7248\u672CID  \u81F3\u5C11\u6709\u4E00\u4E2A"),H.Message.error({message:"\u53C2\u6570\u6709\u8BEF\uFF0C\u65E0\u6CD5\u67E5\u770B",offset:60});return}switch(this.thisAccessType){case this.global.editType.original.code:this.loading=!0,ce._.getQueryListConfigForOriginal({queryPublishId:this.queryPublishId,queryId:this.queryId}).then(e=>{this.afterGetQueryListConfig(e,t)});break;case this.global.editType.public.code:this.loading=!0,this.getQueryListConfigForPublic({queryPublishId:this.queryPublishId,queryId:this.queryId}).then(e=>{this.afterGetQueryListConfig(e,t)});break;default:H.Message.error({message:"\u53C2\u6570\u6709\u8BEF\uFF0C\u65E0\u6CD5\u67E5\u770B",offset:60})}}else this.queryId?(this.loading=!0,pe.y.getQueryListConfig(this.queryId).then(e=>{this.afterGetQueryListConfig(e,t)})):H.Message.error({message:"\u53C2\u6570\u6709\u8BEF\uFF0C\u65E0\u8BBE\u67E5\u8BE2\u5217\u8868\u4E3B\u952E\uFF0C\u65E0\u6CD5\u67E5\u770B",offset:60})},afterGetQueryListConfig(t,e){if(this.loading=!1,t&&t.status==200){let s=t.data.queryListWithBLOBs;(!this.queryListId||this.queryListId=="")&&this.setQueryId({queryId:s.queryListId,widgetId:this.widgetId});let i=t.data.paramList;this.isBoard||(s.queryListName?d.setBrowserTitle(s.queryListName):s.publishName&&d.setBrowserTitle(s.publishName)),s.accessType=this.thisAccessType,this.setResource(s,()=>{this.setQueryConfig({queryInfo:s,widgetId:this.widgetId}),this.setGlobalClass(),this.setFonts(),this.initBaseGlobalParams(this.queryConfig.base.global_params,i),this.setInitRequestBody(s.configJson),this.setBoardIconLibrary(),this.setAction(),e&&e()})}else H.Message.error({message:t.msg,offset:60})},checkQueryListConfig(){debugger;this?.queryConfig?.dialog?.findIndex(e=>e?.container?.content?.type==="form"&&e?.container?.content?.publishId)>-1&&(this.isDesign?this.$confirm("\u68C0\u6D4B\u5230\u67E5\u8BE2\u5217\u8868\u4E2D\u7ED1\u5B9A\u4E86\u8868\u5355\u7684\u53D1\u5E03\u7248\u672C\uFF0C\u4F1A\u5BFC\u81F4\u5BFC\u5165\u5BFC\u51FA\u540E\u7ED1\u5B9A\u5931\u6548\uFF0C\u662F\u5426\u8F6C\u6362\u4E3A\u7ED1\u5B9A\u6700\u65B0\u7248\u672C?","\u63D0\u793A",{type:"warning",closeOnClickModal:!1}).then(()=>{let e=this.queryConfig.dialog;for(let s=0;s<e.length;++s){let i=e[s].container.content;if(i.type==="form"&&i.publishId){let r=`publishId=${i.publishId}`,o=`formId=${i.contentId}&formCode=${encodeURIComponent(i.contentCode)}&formName=${encodeURIComponent(i.contentName)}`;i.publishUrl=i.publishUrl.replace(r,o),i.publishId="",i.publishName=`${i.contentName}>\u6700\u65B0\u7248\u672C`,e[s].container.url=e[s].container.url.replace(r,o)}}this.updateQueryConfigDialog(e),this.$message.success("\u66F4\u65B0\u6210\u529F\uFF0C\u8BF7\u4FDD\u5B58\u5E76\u91CD\u65B0\u53D1\u5E03\u67E5\u8BE2\u5217\u8868")}).catch(()=>{qe.log("\u5DF2\u53D6\u6D88\u66F4\u65B0dialog\u7684\u8868\u5355\u6700\u65B0\u7248\u672C")}):this.thisAccessType||this.$message({type:"warning",dangerouslyUseHTMLString:!0,message:"\u68C0\u6D4B\u5230\u67E5\u8BE2\u5217\u8868\u4E2D\u7ED1\u5B9A\u4E86\u8868\u5355\u7684\u53D1\u5E03\u7248\u672C\uFF0C\u4F1A\u5BFC\u81F4\u5BFC\u5165\u5BFC\u51FA\u540E\u7ED1\u5B9A\u5931\u6548\uFF0C\u8BF7\u8FDB\u5165\u8BBE\u8BA1\u5668\u4FEE\u6539\u3002"}))},setGlobalClass(){this.queryConfig.base.global_class&&this.queryConfig.base.global_class!=this.global_query.global_class.default.code&&this.queryConfig.base.global_class==this.global_query.global_class.platform.code&&a.e(90099).then(a.bind(a,990099))},setResource(t,e){let s=!0;this.widgetId&&this.widgetId!=""&&(s=!1);let i={};if(t.configJson&&(i=JSON.parse(t.configJson)),this.isDesign==!0&&(s=i.base.load_resource_file),this.getURLParams.load_resource_file!=null&&(s=d.stringToBoolean(this.getURLParams.load_resource_file)),s==!0&&i.base&&i.base.resource){let r=[],o=[];this.$$lib__.each(i.base.resource,h=>{h.sync==!0?r.push(h):o.push(h)}),r.length>0?d.loadCallbackResourceList(r,()=>{this.$$lib__.each(o,h=>{d.appendResource(h.fileUrlPath,h.restypeId,h.updatedTime)}),e&&e()}):(this.$$lib__.each(o,h=>{d.appendResource(h.fileUrlPath,h.restypeId,h.updatedTime)}),e&&e())}else e&&e()},setFonts(){let t="";this.$$lib__.each(this.queryConfig.base.fonts,e=>{if(e){let s=e.split("-")[1],i=`./resource/font/${e}.${s}`;t+=`@font-face {font-family: "${e}"; src: url('${i}') format('${s}')}`}}),t!=""&&d.appendCss("font-style",t)},setWaterMark(){if(n.Z.baseConfig.isPlatform==!0&&window.parent===window&&this.thisAccessType!="public"&&!this.widgetId){let t="/identity/getPlatInfo/explorer";(0,$.platformGetRequest)(t).then(e=>{e&&e.status==200&&e.data.waterMark&&Me.GisqWaterMarkService.create(e.data.waterMark,!0)})}},setBoardIconLibrary(){this.queryConfig.iconLibrary&&this.queryConfig.iconLibrary.map(t=>{JSON.stringify(this.queryConfig).indexOf("icon_library_code"+t.code)>-1&&t.code!=""&&de.D.getIconLibraryByCode(t.code).then(e=>{e.status==200?d.appendLink(e.data.fileUrlPath):H.Message.error({message:e.msg,offset:60})})})},getQueryDataList(){this.loading=!0;let t=new Date().getTime();if(this.$emit("queryRequestBody",this.requestBody),qe.info(this.requestBody.keyValue),this.isInit==!1&&f.Z.$emit("busPreviewConditionValue"+(this.widgetId?"_"+this.widgetId:"")),this.thisAccessType)switch(this.thisAccessType){case this.global.editType.original.code:_.getDataForOriginal(this.requestBody).then(e=>{this.afterGetData(t,e)});break;case this.global.editType.public.code:this.getDataForPublic(this.requestBody).then(e=>{this.afterGetData(t,e)});break;default:H.Message.error({message:"\u53C2\u6570\u6709\u8BEF\uFF0C\u65E0\u6CD5\u67E5\u770B",offset:60})}else{let e=JSON.parse(JSON.stringify(this.requestBody));e.condition&&e.condition.length>0&&(e.conditionString=d.AES.encrypt(JSON.stringify(e.condition)),e.condition=null),e.field&&e.field.length>0&&(e.fieldString=d.AES.encrypt(JSON.stringify(e.field)),e.field=null),e.customerFields&&e.customerFields.length>0&&(e.customerFieldsString=d.AES.encrypt(JSON.stringify(e.customerFields)),e.customerFields=null),_.getData(e).then(s=>{this.afterGetData(t,s)})}},getCustomerQuery(){if(this.$$lib__.find(this.queryConfig.button,i=>i.guid==this.global_query.button_system.customer_query.guid)==null)return;let e=this.$$lib__.find(this.customerQuery,i=>i.default==!0),s=null;if(e&&(s=e),s){let i=s.keyValue;if(i&&i!=""){let r=JSON.parse(i),o=this.$$lib__.pluck(this.queryConfig.field,"field");for(let h in JSON.parse(i))this.$$lib__.contains(o,h)||y.default.delete(r,h);this.setRequestBodyKeyValue({keyValue:r,widgetId:this.widgetId})}}},exportExcel(t){this.$confirm("\u8BF7\u786E\u8BA4\u662F\u5426\u5BFC\u51FAExcel?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",customClass:"deleteBoardC"}).then(()=>{this.loading=!0;let e=t.requestBody;e.publishType=this.thisAccessType,e.keyValueDataset=this.datasetInfo.datasetJson,this.thisAccessType&&this.thisAccessType==this.global_query.accessType.public.code?this.exportExcelForQueryListForPublic(e).then(s=>{this.afterExportExcel(s,t)}):_.exportExcelForQueryList(e).then(s=>{this.afterExportExcel(s,t)})}).catch(()=>{H.Message.info({message:"\u5DF2\u53D6\u6D88\u5BFC\u51FA",offset:60})})},afterGetData(t,e){const s=(new Date().getTime()-t)/1e3;this.setQueryTime({time:s,widgetId:this.widgetId}),this.loading=!1,e&&e.status==200?(this.queryConfig.base.datesetConfigJson?this.query_result_data=this.getDataSetData(e.data,this.queryConfig.base?.datesetConfigJson?.query,this.queryConfig.base?.datesetConfigJson?.dimensions,this.queryConfig.base.datasetId):this.query_result_data=e.data,this.newQueryDataList(),this.getQueryRequestData()):e.msg=="\u67E5\u8BE2\u5217\u8868\u6570\u636E\u96C6\u4E3A\u7A7A"?H.Message.warning({message:"\u60A8\u8FD8\u6CA1\u6709\u9009\u62E9\u6570\u636E\u96C6\uFF0C\u8BF7\u5148\u524D\u5F80\u57FA\u672C\u914D\u7F6E\u9009\u62E9",offset:60}):H.Message.error({message:e.msg,offset:60})},afterExportExcel(t,e){this.loading=!1;let s=this.responseHeaders["content-disposition"];if(!t)return;let i=new Blob([t],{type:"application/vnd.ms-excel;charset=utf-8"}),r=window.URL.createObjectURL(i);if(s){let o=window.decodeURI(s.split("=")[1]);const h=document.createElement("a");h.href=r,h.download=this.getExportExcelFileName(o,e),h.click(),URL.revokeObjectURL(r)}else window.location.href=r},getExportExcelFileName(t,e){let s=e.button;if(s.is_define_fileName)if(!s.script_define_fileName||s.script_define_fileName=="")qe.warn("\u5B9A\u4E49\u6587\u4EF6\u540D \u6309\u94AE"+s.name+" \u811A\u672C\u4E3A\u7A7A");else{qe.info("\u6267\u884C\u5B9A\u4E49\u6587\u4EF6\u540D \u6309\u94AE"+s.name+" \u811A\u672C");let r=new Function("button_config",s.script_define_fileName).apply(this,[s]);r&&(t=r)}return t},newQueryDataList(){if(this.isOkDatasetInfo()==!0&&this.enumInfo.isOk&&this.query_result_data!=null){this.isInit&&(f.Z.$emit("busSetQueryCustomer"+(this.widgetId?"_"+this.widgetId:"")),f.Z.$emit("busPreviewConditionValue"+(this.widgetId?"_"+this.widgetId:"")),this.isInit=!1);let t=this.getDataSetObjectData(this.query_result_data,this.queryConfig.base?.datesetConfigJson?.query,this.queryConfig.base?.datesetConfigJson?.dimensions,this.queryConfig.base.datasetId),e=this.getTableData(t);this.setQueryDataList({list:e,total:this.query_result_data.total,widgetId:this.widgetId})}},isOkDatasetInfo(){let t=!0;for(let e in this.datasetInfo.isOk)if(this.datasetInfo.isOk[e]!=!0)return t=!1,!1;return t},setAction(){this.$$lib__.each(this.queryConfig.action,t=>{t.code==this.global_query.action_system.query_onPostMessage.code&&t.disabled!=!0&&window.addEventListener("message",e=>{if(e.data&&typeof e.data=="string"&&e.data.indexOf("setImmediate")>-1)return;let s=this.onPostMessage,i=t.origin;i&&(i==="*"||i!="*"&&i.indexOf(e.origin)>-1)&&s.apply(this,[t,e])})})},onPostMessage(t,e){let s={data:e.data,source:e};try{if(t.script_action==""){H.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}qe.info("\u6267\u884C\u76D1\u542ConPostMessage\u4FE1\u606F\u811A\u672C"),new Function("param",t.script_action).apply(this,[s])}catch(i){qe.error("\u6267\u884Cquery_onPostMessage\u81EA\u5B9A\u4E49\u4E8B\u4EF6\u51FA\u9519"),qe.error(i)}},customScript_onPostMessage(){},getQueryRequestData(){this.$$lib__.each(this.queryConfig.request,t=>{t.query_request==!0&&this.getRequestData(t.guid)})}},beforeDestroy(){f.Z.$off("busGetFieldEnumJson"+(this.widgetId?"_"+this.widgetId:"")),f.Z.$off("busGetDataSetJson"+(this.widgetId?"_"+this.widgetId:"")),f.Z.$off("busQueryDataList"+(this.widgetId?"_"+this.widgetId:"")),f.Z.$off("busExportExcel"+(this.widgetId?"_"+this.widgetId:""))}},Ae=Re,Ve=(0,Q.Z)(Ae,O,T,!1,null,"2dd5d61c",null),Je=Ve.exports,Qe=a(844513),Be=a(149500),He={name:"ListQuery",components:{HideButton:Qe.Z,QueryView:Je},mixins:[b.baseConfig,c.u,q.P],props:["widgetInfo"],data(){return{isEditor:!0,isInit:!0,query_list_id:null,query_list_publish_id:null,publish_mode:null,version_mode:null,publish_type:null,query_info:{queryListId:null,queryListPublishId:null,publishMode:null,versionMode:null,publishType:null}}},computed:{...(0,k.Se)(["getApplication","viewType"])},watch:{"widgetInfo.attr.hide":{deep:!0,handler:function(){this.$emit("attrChange",this.widgetInfo)}}},mounted(){this.isEditor=window.location.href.indexOf("editor.html")>0,this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),f.Z.$on("refreshQueryKey",()=>{this.$refs.query_view.initQueryInfo()})},methods:{...(0,k.nv)(["updateCurrentWidget","setCurrentWidget"]),loadInfo(t){this.query_info.queryListId!=t.dataset.query.queryListId||this.query_info.queryListPublishId!=t.dataset.query.queryListPublishId||this.query_info.publishMode!=t.dataset.query.publishMode||this.query_info.versionMode!=t.dataset.query.versionMode||this.query_info.publishType!=t.dataset.query.publishType?(this.clearParameters(t),this.clearParameters(),this.query_list_id=t.dataset.query.queryListId,t.dataset.query.publishMode=="board"?this.publish_type=this.viewType:t.dataset.query.publishMode=="query"&&(t.dataset.query.versionMode=="newest"?this.publish_type=t.dataset.query.publishType:t.dataset.query.versionMode=="someone"&&(this.query_list_publish_id=t.dataset.query.queryListPublishId,this.publish_type=t.dataset.query.publishType)),setTimeout(()=>{this.$refs.query_view.initQueryInfo()},1)):this.isInit=!1,this.lifecycleAfterLoad()},reLoadInfo(t){this.loadInfo(t)},initAction(t){this.actionReceive(t),this.replaceQueryCondition(t)},replaceQueryCondition(t){let e=t.action.receive.replaceQueryCondition;if(e&&e.enabled){let s={};if(this.$$lib__.each(e.replaceList,i=>{let r=i.replaceParam;for(let o=0;o<r.length;o++)if(r[o].length==3){let h=r[o][1]+"_"+r[o][0],G=r[o][2],B=G.indexOf("|");r[o][1].indexOf("_")>-1&&(h=r[o][1]),B>-1&&(G=r[o][2].substring(B+1)),s[h]||y.default.set(s,h,{}),s[h][i.param]||y.default.set(s[h],i.param,G)}}),!this.$$lib__.isEmpty(s))for(let i in s)f.Z.$on(i,r=>{if(e.script&&e.script.enabled){if(Be.log("Execute script for "+t.name+" component to replace query condition"),e.script.content==""){H.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.doActionParams=new Function("info","keyValue","data","param_key",e.script.content)}let o=this.$refs.query_view.requestBody.keyValue;this.doActionParams(t,o,r,s[i])})}},doActionParams(t,e,s,i){let r=Object.keys(s);for(let o in i)for(let h in e)if(h==o){let G=i[o];this.$$lib__.contains(r,G)?e[h]=s[G]:Be.warn("\u7EC4\u4EF6["+t.name+"]\u7684\u63A5\u6536\u4E8B\u4EF6\u53C2\u6570\u4E2D\uFF0Cdata\u6CA1\u6709["+G+"]\u8FD9\u4E2A\u5C5E\u6027")}this.reloadQueryData(e)},reloadQueryData(t){let e=this.$refs.query_view;if(e){let s=e.$refs.refHeader;s?(s.form_condition=JSON.parse(JSON.stringify(t)),s.doQuery()):Be.error("\u672A\u67E5\u5230\u67E5\u8BE2\u5217\u8868\u7684\u5934\u90E8\u5BF9\u8C61")}else Be.error("\u672A\u67E5\u5230\u67E5\u8BE2\u5217\u8868\u5BF9\u8C61")},queryRequestBody(t){if(this.isEditor==!0&&t.keyValue){for(let e in t.keyValue)t.keyValue[e]==null&&(t.keyValue[e]=null);this.widgetInfo.dataset.query.keyValue=t.keyValue,this.updateCurrentWidget(JSON.parse(JSON.stringify(this.widgetInfo))),this.isInit==!0&&(this.setCurrentWidget(null),this.isInit=!1)}},clearParameters(t){t?(this.query_info.queryListId=t.dataset.query.queryListId,this.query_info.queryListPublishId=t.dataset.query.queryListPublishId,this.query_info.publishMode=t.dataset.query.publishMode,this.query_info.versionMode=t.dataset.query.versionMode,this.query_info.publishType=t.dataset.query.publishType):(this.query_list_id=null,this.query_list_publish_id=null,this.publish_mode=null,this.version_mode=null,this.publish_type=null)}}},je=He,We=(0,Q.Z)(je,w,C,!1,null,"f251f46a",null),Ue=We.exports},452013:function(m,x,a){a.d(x,{Z:function(){return T}});var w=function(){var n=this,l=n._self._c;return l("el-tooltip",{attrs:{disabled:n.button_config.tooltip!=null&&n.button_config.tooltip.enable!=!0,effect:n.button_config.tooltip.effect,placement:n.button_config.tooltip.placement,offset:n.button_config.tooltip.offset,transition:n.button_config.tooltip.transition,"open-delay":n.button_config.tooltip.open_delay,enterable:n.button_config.tooltip.enterable}},[l("div",{style:n.tooltipStyle(),attrs:{slot:"content"},domProps:{innerHTML:n._s(n.getContent())},slot:"content"}),n._t("default")],2)},C=[],f=a(149500),b={name:"button-tooltip",props:{button_config:{type:Object,default:()=>({})},scope:{type:Object,default:()=>({})}},methods:{getContent(){let $=this.button_config.tooltip.content;if(this.button_config.tooltip&&this.button_config.tooltip.is_tooltip_content==!0){if(!this.button_config.tooltip.script_tooltip_content||this.button_config.tooltip.script_tooltip_content=="")return f.warn("\u6309\u94AE\u6587\u5B57\u63D0\u793A\u5185\u5BB9 "+this.button_config.name+" \u811A\u672C\u4E3A\u7A7A"),null;f.info("\u6267\u884C\u6309\u94AE\u6587\u5B57\u63D0\u793A\u5185\u5BB9 "+this.button_config.name+" \u811A\u672C");let n=new Function("button_config","row","column","$index",this.button_config.tooltip.script_tooltip_content);try{$=n.apply(this,[this.button_config,this.scope.row,this.scope.column,this.scope.$index]),$||f.warn("\u6267\u884C\u6309\u94AE "+this.button_config.name+" \u6587\u5B57\u63D0\u793A\u5185\u5BB9\u811A\u672C\u65F6\uFF0C\u9700\u8981\u6709return\u6587\u5B57\u5185\u5BB9")}catch{f.error("\u6267\u884C\u6309\u94AE "+this.button_config.name+" \u6587\u5B57\u63D0\u793A\u5185\u5BB9\u811A\u672C\u65F6\u62A5\u9519\u5F02\u5E38")}}return $},tooltipStyle(){let $={};return this.button_config.tooltip&&(this.button_config.tooltip.fontSize&&($.fontSize=this.button_config.tooltip.fontSize+"px"),this.button_config.tooltip.fontFamily&&($.fontFamily=this.button_config.tooltip.fontFamily),this.button_config.tooltip.color&&($.color=this.button_config.tooltip.color)),$}}},c=b,q=a(768141),O=(0,q.Z)(c,w,C,!1,null,"119796d0",null),T=O.exports}}]);
