"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[7691],{307691:function(y,o,n){n.r(o),n.d(o,{default:function(){return v}});var r=function(){var t=this,e=t._self._c;return e("vue-lazy-component",[e("el-form",{ref:"form",attrs:{size:"mini","label-width":"70px","label-position":"right",model:t.currentWidget.dataset}},[e("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[e("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B",onchange:"blur"},on:{change:t.changeDatasetType},model:{value:t.currentWidget.dataset.type,callback:function(i){t.$set(t.currentWidget.dataset,"type",i)},expression:"currentWidget.dataset.type"}},t._l(this.$$global_editor.dataSourcTypeList3,function(i){return e("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),e("el-collapse",[e("el-collapse-item",{staticClass:"my-collapse-text",staticStyle:{padding:"0px",margin:"0px"}},[e("div",{staticStyle:{"font-size":"14px"},attrs:{slot:"title"},slot:"title"},[t._v("\u6811\u5F62\u6570\u636E")]),e("el-form-item",{ref:"id",attrs:{label:"\u5F00\u542F",prop:"id"}},[e("el-tooltip",{attrs:{content:""}},[e("el-switch",{on:{change:t.getConfigData},model:{value:t.currentWidget.config.tree.enabled,callback:function(i){t.$set(t.currentWidget.config.tree,"enabled",i)},expression:"currentWidget.config.tree.enabled"}})],1)],1),e("el-form-item",{ref:"id",attrs:{label:"\u9009\u9879\u7684\u503C",prop:"id"}},[e("el-select",{staticStyle:{width:"180px"},attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u5217\u9009\u9879\u503C\u7684\u5B57\u6BB5"},on:{change:t.getConfigData},model:{value:t.currentWidget.config.tree.id,callback:function(i){t.$set(t.currentWidget.config.tree,"id",i)},expression:"currentWidget.config.tree.id"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(i){return e("el-option",{key:i.name,attrs:{label:i.alias!=""?i.alias:i.name,value:i.name}})}),1)],1),e("el-form-item",{ref:"pid",attrs:{label:"\u9009\u9879\u7236\u503C",prop:"pid"}},[e("el-select",{staticStyle:{width:"180px"},attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u5217\u9009\u9879\u503C\u7684\u5B57\u6BB5"},on:{change:t.getConfigData},model:{value:t.currentWidget.config.tree.parentId,callback:function(i){t.$set(t.currentWidget.config.tree,"parentId",i)},expression:"currentWidget.config.tree.parentId"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(i){return e("el-option",{key:i.name,attrs:{label:i.alias!=""?i.alias:i.name,value:i.name}})}),1)],1)],1)],1),e("el-form-item",{attrs:{label:"\u6DFB\u52A0\u5217"}},[e("el-tooltip",{attrs:{content:"\u6DFB\u52A0\u8868\u683C\u5217","open-delay":1e3,effect:"dark",placement:"top"}},[e("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(i){return t.addColumn()}}})],1)],1),e("div",{staticClass:"my-collapse-text"},[e("el-collapse",t._l(t.columnList,function(i,s){return e("el-collapse-item",{key:s},[e("template",{slot:"title"},[e("div",{staticClass:"my-title"},[t._v(t._s("\u7B2C"+(s+1)+"\u5217"))])]),e("el-form-item",{attrs:{label:"\u5185\u5BB9\u6587\u672C"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:"\u8BF7\u9009\u62E9\u5217\u7684\u5B57\u6BB5"},on:{change:t.getConfigData},model:{value:i.field,callback:function(l){t.$set(i,"field",l)},expression:"col.field"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(l){return e("el-option",{key:l.name,attrs:{label:l.alias!=""?l.alias:l.name,value:l.name}})}),1),e("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(l){return t.deleteColumn(i.id,s)}}})],1),e("el-form-item",{attrs:{label:"\u5185\u5BB9\u80CC\u666F"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:"\u8BF7\u9009\u62E9\u80CC\u666F\u7684\u5B57\u6BB5"},on:{change:t.getConfigData},model:{value:i.fieldImage,callback:function(l){t.$set(i,"fieldImage",l)},expression:"col.fieldImage"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(l){return e("el-option",{key:l.name,attrs:{label:l.alias!=""?l.alias:l.name,value:l.name}})}),1)],1),e("el-form-item",{attrs:{label:"\u586B\u5145\u6A21\u5F0F"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:"\u8BF7\u9009\u62E9\u80CC\u666F\u7684\u5B57\u6BB5"},on:{change:t.getConfigData},model:{value:i.fieldBackgroundSize,callback:function(l){t.$set(i,"fieldBackgroundSize",l)},expression:"col.fieldBackgroundSize"}},t._l(t.globalEditor.backgroundSize,function(l){return e("el-option",{key:l.value,attrs:{label:l.label,value:l.value}})}),1)],1),i.scriptScope!=null?e("el-collapse-item",{attrs:{title:"\u5185\u5BB9\u811A\u672C\u5B9A\u4E49"}},[e("el-form-item",{attrs:{label:"\u662F\u5426\u542F\u7528"}},[e("common-custom-script",{attrs:{options:{attribute_enable:"enabled",attribute_script_content:"content",title:i.label+"\u811A\u672C\u5185\u5BB9",script_examples:`/*
                                                                    \u5F53\u524D\u65B9\u6CD5\u4E2D\u53EF\u4F7F\u7528\u7684\u53C2\u6570:
row:\u5F53\u524D\u884C\u6570\u636E\u5BF9\u8C61\uFF1B
column\uFF1A\u5F53\u524D\u5355\u5143\u683C\u5BF9\u8C61;
cellValue:\u5F53\u524D\u5355\u5143\u683C\u6587\u672C\u5185\u5BB9;
index\uFF1A\u5F53\u524D\u5355\u5143\u683C\u7D22\u5F15;
*/
return cellValue;
`}},on:{change:t.getConfigData},model:{value:i.scriptScope,callback:function(l){t.$set(i,"scriptScope",l)},expression:"col.scriptScope"}})],1)],1):t._e()],2)}),1)],1),e("setting-dataset",{ref:"settingDataset",attrs:{currentWidget:t.currentWidget},on:{getDataSetData:t.getConfigData,clearDynamicEncode:t.clearDynamicEncode}})],1),e("el-dialog",{staticClass:"my-dialog",staticStyle:{padding:"0px"},attrs:{title:t.title,top:"10px","append-to-body":!0,"close-on-click-modal":!1,visible:t.dialogVisible,width:t.dialogWidth},on:{"update:visible":function(i){t.dialogVisible=i}}},[e("div",{staticClass:"my-script",style:{height:t.divH+"px"}},[e("div",[e("el-popover",{attrs:{placement:"right",width:"800","open-delay":1e3,trigger:"click"},on:{"after-enter":t.afterEnter}},[e("my-monaco-editor",{ref:"sampleCode",style:{height:t.divH-30+"px"},attrs:{language:"javascript"},model:{value:t.tooltip.examples,callback:function(i){t.$set(t.tooltip,"examples",i)},expression:"tooltip['examples']"}}),e("el-button",{attrs:{slot:"reference",type:"text",size:"medium "},slot:"reference"},[t._v("\u67E5\u770B\u793A\u4F8B\u4EE3\u7801")])],1)],1),e("div",{style:{height:t.divH-30+"px"}},[e("my-monaco-editor",{ref:"scriptContent",attrs:{language:"javascript"},model:{value:t.script_content,callback:function(i){t.script_content=i},expression:"script_content"}})],1)]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("\u53D6 \u6D88")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.confirm}},[t._v("\u786E \u5B9A")])],1)])],1)},c=[],d=n(589908),u=n(846577),g=n(723400),p=n(338376),f={name:"list-table-data",props:["currentWidget"],components:{SettingDataset:d.Z,MyMonacoEditor:()=>Promise.resolve().then(n.bind(n,980424)),CommonCustomScript:()=>Promise.resolve().then(n.bind(n,406627))},mixins:[p.baseConfig,g.j],data(){return{colIndex:-1,title:"",divH:"0",dialogVisible:!1,dialogWidth:"0px",script_content:"",globalEditor:this.$$global_editor,tooltip:{examples:`/*\u5F53\u524D\u65B9\u6CD5\u4E2D\u53EF\u4F7F\u7528\u7684\u53C2\u6570
row:\u5F53\u524D\u884C\u6570\u636E\u5BF9\u8C61\uFF1B
column\uFF1A\u5F53\u524D\u5355\u5143\u683C\u5BF9\u8C61; 
cellValue:\u5F53\u524D\u5355\u5143\u683C\u6587\u672C\u5185\u5BB9;
index\uFF1A\u5F53\u524D\u5355\u5143\u683C\u7D22\u5F15; 
*/
return cellValue;`}}},watch:{currentWidget(){this.currentWidget.config.tree||(this.currentWidget.config.tree={enabled:!1})}},beforeMount(){this.currentWidget.config.tree||(this.currentWidget.config.tree={enabled:!1})},mounted(){this.dialogWidth=window.innerWidth-170+"px",this.divH=window.innerHeight-160},computed:{columnList(){return JSON.parse(JSON.stringify(this.currentWidget.config.column))}},methods:{setSeriesList(){this.currentWidget.config.column=JSON.parse(JSON.stringify(this.columnList))},addColumn(){let a=JSON.parse(JSON.stringify(u.Z.text.list.list_table.config.column[0]));a.id=JSON.parse(JSON.stringify(this.uuid())),a.label="\u7B2C"+(this.columnList.length+1)+"\u5217",a.field="",this.columnList.push(a),this.getConfigData()},deleteColumn(a,t){this.deleteContentClick(a),this.columnList.splice(t,1),this.getConfigData()},deleteContentClick(a){if(a&&a!="")for(let t=0;t<this.currentWidget.action.sendOut.actionList.length;t++)this.currentWidget.action.sendOut.actionList[t].contentId==a&&this.currentWidget.action.sendOut.actionList.splice(t,1)},changeDatasetType(){this.$refs.settingDataset.loadPreview(),this.clearDynamicEncode(),this.getConfigData()},clearDynamicEncode(){this.$$lib__.each(this.currentWidget.config.column,a=>{a.field=""}),this.$$lib__.each(this.columnList,a=>{a.field=""}),this.getConfigData()},editScript(a,t){this.dialogVisible=!0,this.colIndex=t,this.title="\u7B2C"+(t+1)+"\u5217\u7684\u811A\u672C\u7F16\u8F91",setTimeout(()=>{this.$refs.scriptContent.setValue(a.scriptScope.content)},1)},cancel(){this.dialogVisible=!1,this.colIndex=-1,this.$refs.scriptContent.setValue("")},confirm(){this.columnList[this.colIndex].scriptScope.content=this.script_content,this.getConfigData(),this.dialogVisible=!1},afterEnter(){this.$refs.sampleCode.initEditor()},uuid(){let a=[],t="0123456789abcdef";for(let i=0;i<36;i++)a[i]=t.substr(Math.floor(Math.random()*16),1);return a[14]="4",a[19]=t.substr(a[19]&3|8,1),a[8]=a[13]=a[18]=a[23]="-",a.join("").replace(/-/g,"")}}},m=f,h=n(768141),b=(0,h.Z)(m,r,c,!1,null,"b1f9e0cc",null),v=b.exports}}]);
