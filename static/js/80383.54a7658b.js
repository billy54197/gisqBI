"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[80383],{752246:function(b,f,i){i.d(f,{X:function(){return s},b:function(){return u}});let s={versions:function(){var r=navigator.userAgent;return{trident:r.indexOf("Trident")>-1,presto:r.indexOf("Presto")>-1,webKit:r.indexOf("AppleWebKit")>-1,gecko:r.indexOf("Gecko")>-1&&r.indexOf("KHTML")==-1,mobile:!!r.match(/AppleWebKit.*Mobile.*/),ios:!!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:r.indexOf("Android")>-1,iPhone:r.indexOf("iPhone")>-1,iPad:r.indexOf("iPad")>-1,webApp:r.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},u;s.versions.mobile||s.versions.ios||s.versions.android||s.versions.iPhone||s.versions.iPad?u=!1:u=!0},459738:function(b,f,i){i.d(f,{OW:function(){return u},m3:function(){return m},nm:function(){return r},vP:function(){return p},xC:function(){return g}});var s=i(153258);function u(t,n,o){let e=t;const d=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(h=>(0,s.mf)(e[h]));if(!(0,s.mf)(e[d]))return!1;do{if(e[d](n))return!0;if(e===o)return!1;e=e.parentNode}while(e);return!1}function r(t){const n=window.getComputedStyle(t);return[parseFloat(n.getPropertyValue("width"),10),parseFloat(n.getPropertyValue("height"),10)]}function p(t,n,o){t&&(t.attachEvent?t.attachEvent("on"+n,o):t.addEventListener?t.addEventListener(n,o,!0):t["on"+n]=o)}function g(t,n,o){t&&(t.detachEvent?t.detachEvent("on"+n,o):t.removeEventListener?t.removeEventListener(n,o,!0):t["on"+n]=null)}function m(t,n,o,e){var d=0,h=setInterval(()=>{d<o?(d++,t()):(clearInterval(h),e&&e())},n);return h}},153258:function(b,f,i){i.d(f,{ew:function(){return p},le:function(){return g},mf:function(){return s},sg:function(){return m},xn:function(){return u}});function s(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function u(t,n,o,e=1){const d=Math.round(n/e/t[0])*t[0],h=Math.round(o/e/t[1])*t[1];return[d,h]}function r(t){const n=t.getBoundingClientRect();return[parseInt(n.width),parseInt(n.height)]}function p(t,n,o){return t-n-o}function g(t,n,o){return t-n-o}function m(t,n,o){return n!==null&&t<n?n:o!==null&&o<t?o:t}},844513:function(b,f,i){i.d(f,{Z:function(){return n}});var s=function(){var e=this,d=e._self._c;return e.attr.buttonHide?d("div",{style:{position:"absolute",right:e.attr.buttonHideRight+"px",top:e.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(h){return e.onHide()}}},[e.openTooltip?d("el-tooltip",{attrs:{"open-delay":1e3,content:e.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[d("el-button",{class:e.attr.buttonHideIconClass&&e.attr.buttonHideIconClass!=""?e.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:e.attr.buttonHideColor,fontSize:e.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):d("el-button",{class:e.attr.buttonHideIconClass&&e.attr.buttonHideIconClass!=""?e.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:e.attr.buttonHideColor,fontSize:e.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):e._e()},u=[],r=i(752246),p={props:["attr"],name:"hide-button",data(){return{isPc:r.b}},computed:{openTooltip:function(){let o=!1,e=this.attr.buttonHideTooltipContent;return r.b&&e&&e!=null&&e.trim()!=""&&(o=!0),o}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},g=p,m=i(768141),t=(0,m.Z)(g,s,u,!1,null,"bf399b9a",null),n=t.exports},580383:function(b,f,i){i.r(f),i.d(f,{default:function(){return H}});var s=function(){var a=this,v=a._self._c;return v("div",{directives:[{name:"show",rawName:"v-show",value:a.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:a.widgetInfo.attr.w+"px",height:a.widgetInfo.attr.hh+"px"}},[v("hide-button",{attrs:{attr:a.widgetInfo.attr}}),a.widgetInfo.config.imgIconConfig.isHtml?v("div",{domProps:{innerHTML:a._s(a.widgetInfo.config.imgIconConfig.html)}}):v("img",{staticStyle:{border:"none"},attrs:{src:a.widgetInfo.config.imgIconConfig.img||a.tocImgUrl,width:a.widgetInfo.config.imgIconConfig.width,height:a.widgetInfo.config.imgIconConfig.height},on:{click:a.doChecked1}})],1)},u=[],r=i(844513),p=i(927966),g=i(589075),m=i(445061),t=i(126711),n=i(386892),o=i(459738),e=i(149500);let d=i(820612);var h={name:"GisKhAnalysis",components:{HideButton:r.Z},mixins:[g.baseConfig,n.D,m.u,t.H],props:["widgetInfo"],data(){return{timer:"",map:null,tocConfig:null,tocImgUrl:d,heatData:{type:"FeatureCollection",features:[{type:"Point",coordinates:[104.4,31.19],count:100},{type:"Point",coordinates:[113.3,30.6],count:19},{type:"Point",coordinates:[123.3,30.6],count:419},{type:"Point",coordinates:[105.3,30.6],count:319},{type:"Point",coordinates:[106.3,30.6],count:719},{type:"Point",coordinates:[109.3,31.6],count:519},{type:"Point",coordinates:[109.3,30.6],count:319},{type:"Point",coordinates:[108.3,32.6],count:139},{type:"Point",coordinates:[118.3,31.6],count:129},{type:"Point",coordinates:[108.3,33.6],count:190},{type:"Point",coordinates:[108.3,32.6],count:189},{type:"Point",coordinates:[100.3,30.6],count:1},{type:"Point",coordinates:[109.3,30.6],count:119},{type:"Point",coordinates:[108.3,31.6],count:200},{type:"Point",coordinates:[118.3,30.6],count:300}]}}},computed:{},beforeDestroy(){},mounted(){var c=this.imgWidth;this.initAction(this.widgetInfo),this.timer=(0,o.m3)(this.getBindMap,500,50,()=>{e.error("gis-kh-analysis\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")})},methods:{loadInfo(c){var a=c.dataset.dynamic.source;this.databaseInfo=a,this.doChecked1()},reLoadInfo(c){this.loadInfo(c)},initAction(c){this.actionSendout(c),this.actionReceive(c)},getBindMap(){if(typeof this.widgetInfo.action.gisMapId<"u"){e.log(this.widgetInfo.action.gisMapId);let c=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(c){clearInterval(this.timer);let a=c.$refs.gismap;a&&(e.log("\u83B7\u53D6map\u5BF9\u8C61\u6210\u529F\uFF0C\u7EC4\u4EF6\u7ED1\u5B9A\u5730\u56FE\uFF0C\u5173\u95ED\u5B9A\u65F6\u5668"),this.map=a.map,this.$refs.measure.map=this.map,this.reLoadInfo(this.widgetInfo))}}},doChecked1(c){let a=this,v=a.widgetInfo.action.sendOut.actionList;var M=this.databaseInfo;let x={type:"FeatureCollection",features:[]},S=[];this.databaseInfo.forEach(function(l,I){var y={type:"Point",coordinates:[Number(l[1]),Number(l[2])],count:Number(l[3])};x.features.push(y)}),this.$$lib__.each(v,l=>{if(l.enabled&&l.code==a.$$global_editor.actionType.sendHeatData.code){let I=l.code+"_"+a.widgetInfo.id,y={isGeojson:!0,geojson:x};l.paramsExtend&&l.paramsExtend.length>0&&this.getExtendParams(y,l.paramsExtend,[],[]),e.log(y),p.Z.$emit(I,y),l.postMessage&&this.doPostMessage(y),this.actionNameList.push(I)}})},doGetTime(c,a){}}},P=h,w=i(768141),C=(0,w.Z)(P,s,u,!1,null,"1f1b4ffc",null),H=C.exports}}]);
