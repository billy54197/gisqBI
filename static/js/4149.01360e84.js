(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[4149],{9061:function(o,c,t){o.exports=function(e){var a={};function n(r){if(a[r])return a[r].exports;var i=a[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=a,n.d=function(r,i,f){n.o(r,i)||Object.defineProperty(r,i,{enumerable:!0,get:f})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,i){if(i&1&&(r=n(r)),i&8||i&4&&typeof r=="object"&&r&&r.__esModule)return r;var f=Object.create(null);if(n.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:r}),i&2&&typeof r!="string")for(var b in r)n.d(f,b,function(g){return r[g]}.bind(null,b));return f},n.n=function(r){var i=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(i,"a",i),i},n.o=function(r,i){return Object.prototype.hasOwnProperty.call(r,i)},n.p="/dist/",n(n.s=794)}({0:function(e,a){e.exports=t(42579)},100:function(e,a){e.exports=t(22305)},16:function(e,a){e.exports=t(91873)},2:function(e,a,n){"use strict";n.d(a,"a",function(){return r});function r(i,f,b,g,l,s,C,p){var u=typeof i=="function"?i.options:i;f&&(u.render=f,u.staticRenderFns=b,u._compiled=!0),g&&(u.functional=!0),s&&(u._scopeId="data-v-"+s);var v;if(C?(v=function(d){d=d||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!d&&typeof __VUE_SSR_CONTEXT__<"u"&&(d=__VUE_SSR_CONTEXT__),l&&l.call(this,d),d&&d._registeredComponents&&d._registeredComponents.add(C)},u._ssrRegister=v):l&&(v=p?function(){l.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:l),v)if(u.functional){u._injectStyles=v;var m=u.render;u.render=function(h,w){return v.call(w),m(h,w)}}else{var x=u.beforeCreate;u.beforeCreate=x?[].concat(x,v):[v]}return{exports:i,options:u}}},27:function(e,a){e.exports=t(78756)},35:function(e,a){e.exports=t(49162)},4:function(e,a){e.exports=t(55616)},45:function(e,a){e.exports=t(11323)},496:function(e,a){e.exports=t(77384)},497:function(e,a){e.exports=t(37318)},56:function(e,a){e.exports=t(34749)},6:function(e,a){e.exports=t(83574)},7:function(e,a){e.exports=t(17249)},794:function(e,a,n){"use strict";n.r(a);var r=function(){var S=this,y=S.$createElement,z=S._self._c||y;return z("div",{staticClass:"sh-general-mask"})},i=[];r._withStripped=!0;var f=n(56),b=n.n(f),g=n(0),l=n.n(g),s=n(27),C=n.n(s),p=n(45),u=n.n(p),v=n(6),m=n.n(v),x=n(7),d=n.n(x),h=n(496),w=n.n(h),k=n(35),I=n.n(k),$=n(497),M=n.n($),P=n(16),D=n(4),E=n(100),H=n.n(E),R={name:"ShGeneralMask",mixins:[m.a,d.a],props:{maskConfig:{type:Object}},data:function(){return this.options=void 0,this.geoJsonFeature=void 0,this.mask=void 0,{}},beforeDestroy:function(){this.$map&&this.remove2DMask(),this.$earth&&this.remove3DMask()},mounted:function(){var y=this;(this.$map||this.$earth)&&setTimeout(function(){l()(this,y),this.begin()}.bind(this),0)},methods:{begin:function(){this.initConfig()},initConfig:function(){var y=this;return b()(u.a.mark(function z(){return u.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(y.maskConfig){O.next=3;break}return D.Message.error("\u8BF7\u63D0\u4F9B\u63A9\u819C\u914D\u7F6E\u4FE1\u606F"),O.abrupt("return");case 3:return y.options={layer:{url:y.maskConfig.url,visibleLayers:y.maskConfig.layerName,selectLayer:y.maskConfig.layerName,type:y.maskConfig.type},where:y.maskConfig.where,xzqdm:y.maskConfig.xzqdm,token:y.token},O.next=6,y.requestMaskData("EPSG:4326",y.options);case 6:y.geoJsonFeature=O.sent,y.$map&&(y.remove2DMask(),y.add2DMask()),y.$earth&&(y.remove3DMask(),y.add3DMask());case 9:case"end":return O.stop()}},z)}))()},requestMaskData:function(y,z){var F=this;return new C.a(function(O,G){var J=this;l()(this,F),w()(y,z).then(function(L){l()(this,J);var B=L;B?O(B):G("\u8BF7\u6C42\u63A9\u819C\u6570\u636E\u5931\u8D25\uFF01")}.bind(this))}.bind(this))},add2DMask:function(){var y=this;if(this.geoJsonFeature){this.$map.maskGeoJson=this.geoJsonFeature;var z=new I.a().readFeature(this.geoJsonFeature,{dataProjection:"EPSG:4326",featureProjection:this.$map.getView().getProjection().getCode()}),F=new M.a({feature:z,inner:!1,fill:new P.Fill({color:this.maskConfig.color?this.maskConfig.color:[255,255,255,1]})});this.mask=F,this.$map.mask=this.mask,this.$map.getLayers().forEach(function(O){l()(this,y),this.geoJsonFeature!==null&&O.addFilter(this.mask)}.bind(this))}},add3DMask:function(){if(this.geoJsonFeature){this.$earth.maskGeoJson=this.geoJsonFeature;var y=H()(this.maskConfig.color).unitObject();this.$earth.viewer.shine.add3DMask(this.geoJsonFeature,y)}},remove2DMask:function(){var y=this;this.mask&&(this.$map.getLayers().forEach(function(z){l()(this,y),z.removeFilter(this.mask)}.bind(this)),this.$map.mask=void 0,this.$map.maskGeoJson=void 0)},remove3DMask:function(){this.$earth.viewer.shine.remove3DMask(),this.$earth.viewer.maskGeoJson=void 0}}},A=R,T=n(2),N=Object(T.a)(A,r,i,!1,null,null,null),j=N.exports;j.install=function(S){S.component(j.name,j)};var Z=a.default=j}})},17249:function(o,c,t){"use strict";var e=t(19534);Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var a=e(t(42579)),n=e(t(5146)),r=e(t(28866)),i=e(t(41739)),f=t(10563),b={created:function(){var l=this;this.subscribe=this.$emitter_create_subscribe();var s=this.$emit,C=(0,f.formatConversion)(this.$options.name).replace("sh-","");this.$emit=function(p){for(var u,v,m,x,d=arguments.length,h=new Array(d>1?d-1:0),w=1;w<d;w++)h[w-1]=arguments[w];s.call.apply(s,(0,n.default)(u=[l,p]).call(u,h)),l.subscribe&&(v=l.subscribe).$emit.apply(v,(0,n.default)(m=[(0,n.default)(x="".concat(C,":")).call(x,p)]).call(m,h))}},methods:{$emitter_create_subscribe:function(){var l=this,s={},C=this.emitterId?"".concat(this.emitterId,":"):"";return s.$emit=function(p){for(var u,v,m=(0,n.default)(u="".concat(C)).call(u,p),x=arguments.length,d=new Array(x>1?x-1:0),h=1;h<x;h++)d[h-1]=arguments[h];i.default.$emit.apply(i.default,(0,n.default)(v=[m]).call(v,d))},s.$on=function(p,u){var v=this;(0,a.default)(this,l);var m;if(p instanceof Array)m=(0,r.default)(p).call(p,function(d){var h;return(0,a.default)(this,v),(0,n.default)(h="".concat(C)).call(h,d)}.bind(this));else{var x;m=(0,n.default)(x="".concat(C)).call(x,p)}i.default.$on(m,u)}.bind(this),s.$once=function(p,u){var v;(0,a.default)(this,l);var m=(0,n.default)(v="".concat(C)).call(v,p);i.default.$once(m,u)}.bind(this),s.$off=function(p,u){var v=this;(0,a.default)(this,l);var m;if(p instanceof Array)m=(0,r.default)(p).call(p,function(d){var h;return(0,a.default)(this,v),(0,n.default)(h="".concat(C)).call(h,d)}.bind(this));else{var x;m=(0,n.default)(x="".concat(C)).call(x,p)}i.default.$off(m,u)}.bind(this),s}}};c.default=b},41739:function(o,c,t){"use strict";var e=t(19534);Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var a=e(t(42160)),n=new a.default;c.default=n},42709:function(o,c,t){"use strict";var e=t(48836);const a={data(){return this.map=null,this.timer="",{isEditor:window.location.href.indexOf("editor.html")>0}},inject:{reactiveViewMode:{default:function(){return()=>"23D"}}},computed:{viewMode(){return this.isSetMap_common?this.$_viewMode:this.reactiveViewMode()}},mounted(){!this.widgetInfo.parentId&&this.isEditor&&this.widgetInfo.action.gisMapId&&this.$nextTick(function(){this.updateWidgetParentId({widgetId:this.widgetInfo.id,parentId:this.widgetInfo.action.gisMapId,keepPosition:!0})})},methods:{...(0,e.nv)(["updateWidgetParentId"]),getBindMap(){typeof this.widgetInfo.action.gisMapId<"u"}}};c.Z=a},68042:function(o,c,t){"use strict";t.d(c,{$:function(){return n}});var e=t(27966),a=t(49500);function n(r,i,f,b){let g=i[f];g&&g.length<1||g.forEach(l=>{if(l&&l.length<1)return;let s=l[0][1]+"_"+l[0][0];l[0][1].indexOf("_")>-1&&(s=l[0][1]),e.Z.$on(s,C=>{a.debug("gis\u7EC4\u4EF6\u63A5\u6536\u4E8B\u4EF6\u89E6\u53D1");let p=l[0][2];if(p){let u=p.indexOf("|");u>-1&&(p=l[0][2].substring(u+1))}i.script&&i.script.enabled?(r._doAction=new Function("data","param_key","value","info",i.script.content),r._doAction(C,p,i.value,C)):b(C[p],C)})})}},76010:function(o,c){"use strict";const t={data(){return{isSpecial:!1,isEditor:window.location.href.indexOf("editor.html")>0}},computed:{isBindToPage(){return this.widgetInfo.config.styleConfig.dragEnable||this.isSpecial},position(){return this.isEditor||!this.isBindToPage?{type:"absolute",top:"0px",left:"0px",bottom:"unset",right:"unset",zIndex:this.widgetInfo.attr.z}:{type:"absolute",top:this.widgetInfo.attr.y+"px",left:this.widgetInfo.attr.x+"px",zIndex:this.widgetInfo.attr.z}},styleConfig(){return{isShowBtn:this.widgetInfo.config.styleConfig.isShowBtn,isStartFix:this.isEditor,titleBar:{miniBtn:!0,maxBtn:!1,closeBtn:!1,fixBtn:!this.isEditor,title:!0},autoVisible:!1,btnSize:{size:this.widgetInfo.config.styleConfig.btnSize.size+"px",padding:this.widgetInfo.config.styleConfig.btnSize.padding+"px",radius:this.widgetInfo.config.styleConfig.btnSize.radius+"px"},size:{radius:this.widgetInfo.config.styleConfig.size.radius+"px",width:this.widgetInfo.attr.w>150?this.widgetInfo.attr.w+"px":"275px",height:this.widgetInfo.attr.hh>100?this.widgetInfo.attr.hh+"px":"80vh"},toolBtnSize:{size:this.widgetInfo.config.styleConfig.toolBtnSize.size+"px",margin:(this.widgetInfo.config.styleConfig.btnSize.size-this.widgetInfo.config.styleConfig.toolBtnSize.size)/2+"px"}}},themeConfig(){let e=this.widgetInfo.config.themeStyle.light;return{light:{title:{backgroundImage:"url('"+e.title.backgroundImage+"')",backgroundColor:e.title.backgroundColor?e.title.backgroundColor:e.floatButton.fillcolor,backgroundSize:e.title.backgroundSize,fontSize:e.title.fontSize+"px",color:e.title.fontColor},primaryFont:{fontSize:e.primaryFont.fontSize+"px",fontColor:e.primaryFont.fontColor},toolButton:{color:e.toolButton.color},panel:{backgroundImage:"url('"+e.panel.backgroundImage+"')",backgroundColor:e.panel.fillcolor,backgroundSize:e.panel.backgroundSize,border:e.panel.border},floatButton:{backgroundColor:e.floatButton.fillcolor,shadowColor:e.floatButton.shadowColor,border:e.floatButton.border}}}}},methods:{bindToPage(e){e&&this.isBindToPage&&(e.parentElement.remove(e),document.getElementById("page_"+this.widgetInfo.pageId).append(e),e.style.pointerEvents="auto",document.getElementById("container_child_"+this.widgetInfo.id).remove())}}};c.Z=t},44513:function(o,c,t){"use strict";t.d(c,{Z:function(){return g}});var e=function(){var s=this,C=s._self._c;return s.attr.buttonHide?C("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(p){return s.onHide()}}},[s.openTooltip?C("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[C("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):C("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},a=[],n=t(52246),r={props:["attr"],name:"hide-button",data(){return{isPc:n.b}},computed:{openTooltip:function(){let l=!1,s=this.attr.buttonHideTooltipContent;return n.b&&s&&s!=null&&s.trim()!=""&&(l=!0),l}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},i=r,f=t(68141),b=(0,f.Z)(i,e,a,!1,null,"bf399b9a",null),g=b.exports},97280:function(o,c,t){"use strict";t.r(c),t.d(c,{default:function(){return k}});var e=function(){var $=this,M=$._self._c;return M("div",{directives:[{name:"show",rawName:"v-show",value:$.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:$.widgetInfo.attr.w+"px",height:$.widgetInfo.attr.hh+"px"}},[M("hide-button",{attrs:{attr:$.widgetInfo.attr}}),M("general-mask",{ref:"mask",attrs:{"mask-config":$.widgetInfo.config.maskConfig}})],1)},a=[],n=t(9061),r=t.n(n),i=t(44513),f=t(27966),b=t(68099),g=t(45061),l=t(26711),s=t(86892),C=t(48836),p=t(76010),u=t(42709),v=t(68042),m=t(49500),x={name:"GisCovermask",mixins:[b.u,s.D,g.u,l.H,u.Z,p.Z],props:["widgetInfo"],computed:{...(0,C.Se)(["getCanvasSetting","getURLParams"])},components:{HideButton:i.Z,GeneralMask:r()},data(){return{timer:"",map:null,mapvue:null,globalEditor:this.$$global_editor}},watch:{},beforeDestroy(){this.doHide()},created(){},mounted(){this.initAction(this.widgetInfo)},methods:{loadInfo(I){m.log(I)},reLoadInfo(I){m.log("\u914D\u7F6E\u66F4\u65B0\u4E86"),this.loadInfo(I),this.doHide(),this.doShow()},initAction(I){this.actionReceive(I)},actionReceive(I){if(I.action==null||I.action.receive==null)return;let $=I.action.receive.replaceSomeParams;$&&$.enabled&&$.paramsList&&$.paramsList.length>0&&(0,v.$)(this,$,"paramsList",this.replaceSomeParams);let M=I.action.receive.show;M&&M.enabled&&M.showList&&M.showList.length>0&&this.doActionShowOrHide(M.showList,M.value,M.script,I.name,"show",!1);let P=I.action.receive.hide;P&&P.enabled&&P.hideList&&P.hideList.length>0&&this.doActionShowOrHide(P.hideList,P.value,P.script,I.name,"hide",!0)},replaceSomeParams(I){if(I){m.log("cover init param",I);let $={...this.widgetInfo.config.maskConfig,...I};this.widgetInfo.config.maskConfig=$,this.reLoadInfo()}},doShow(){this.$refs.mask&&this.$refs.mask.initConfig()},doHide(){this.$refs.mask&&this.$refs.mask.remove2DMask()}}},d=x,h=t(68141),w=(0,h.Z)(d,e,a,!1,null,"4ab36c2a",null),k=w.exports},65557:function(o,c,t){o.exports=t(72626)},87507:function(o){function c(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}o.exports=c,o.exports.__esModule=!0,o.exports.default=o.exports},22777:function(o){function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}o.exports=c,o.exports.__esModule=!0,o.exports.default=o.exports},42762:function(o,c,t){var e=t(57448),a=t(68871);function n(i,f){for(var b=0;b<f.length;b++){var g=f[b];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),e(i,a(g.key),g)}}function r(i,f,b){return f&&n(i.prototype,f),b&&n(i,b),e(i,"prototype",{writable:!1}),i}o.exports=r,o.exports.__esModule=!0,o.exports.default=o.exports},34009:function(o,c,t){var e=t(39155),a=t(1520),n=t(72026);function r(i){var f;return o.exports=r=e?a(f=n).call(f):function(g){return g.__proto__||n(g)},o.exports.__esModule=!0,o.exports.default=o.exports,r(i)}o.exports=r,o.exports.__esModule=!0,o.exports.default=o.exports},30044:function(o,c,t){var e=t(21648),a=t(57448),n=t(39736);function r(i,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=e(f&&f.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),a(i,"prototype",{writable:!1}),f&&n(i,f)}o.exports=r,o.exports.__esModule=!0,o.exports.default=o.exports},99085:function(o,c,t){var e=t(29870).default,a=t(87507);function n(r,i){if(i&&(e(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a(r)}o.exports=n,o.exports.__esModule=!0,o.exports.default=o.exports},39736:function(o,c,t){var e=t(39155),a=t(1520);function n(r,i){var f;return o.exports=n=e?a(f=e).call(f):function(g,l){return g.__proto__=l,g},o.exports.__esModule=!0,o.exports.default=o.exports,n(r,i)}o.exports=n,o.exports.__esModule=!0,o.exports.default=o.exports},44900:function(o,c,t){"use strict";var e=t(56370);o.exports=e},53005:function(o,c,t){"use strict";t(94495);var e=t(18893);o.exports=e("Function","bind")},17086:function(o,c,t){"use strict";var e=t(32242),a=t(53005),n=Function.prototype;o.exports=function(r){var i=r.bind;return r===n||e(n,r)&&i===n.bind?a:i}},60382:function(o,c,t){"use strict";t(30897);var e=t(94388);o.exports=e.Reflect.construct},1520:function(o,c,t){"use strict";o.exports=t(48691)},48691:function(o,c,t){"use strict";var e=t(44900);o.exports=e},77958:function(o,c,t){"use strict";var e=t(36021),a=t(86735),n=t(42660),r=t(79489),i=t(2529),f=t(82396),b=Function,g=e([].concat),l=e([].join),s={},C=function(p,u,v){if(!r(s,u)){for(var m=[],x=0;x<u;x++)m[x]="a["+x+"]";s[u]=b("C,a","return new C("+l(m,",")+")")}return s[u](p,v)};o.exports=f?b.bind:function(u){var v=a(this),m=v.prototype,x=i(arguments,1),d=function(){var w=g(x,i(arguments));return this instanceof d?C(v,w.length,w):v.apply(u,w)};return n(m)&&(d.prototype=m),d}},94495:function(o,c,t){"use strict";var e=t(90434),a=t(77958);e({target:"Function",proto:!0,forced:Function.bind!==a},{bind:a})},30897:function(o,c,t){"use strict";var e=t(90434),a=t(30889),n=t(19522),r=t(77958),i=t(11298),f=t(87934),b=t(42660),g=t(24136),l=t(27909),s=a("Reflect","construct"),C=Object.prototype,p=[].push,u=l(function(){function x(){}return!(s(function(){},[],x)instanceof x)}),v=!l(function(){s(function(){})}),m=u||v;e({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(d,h){i(d),f(h);var w=arguments.length<3?d:i(arguments[2]);if(v&&!u)return s(d,h,w);if(d===w){switch(h.length){case 0:return new d;case 1:return new d(h[0]);case 2:return new d(h[0],h[1]);case 3:return new d(h[0],h[1],h[2]);case 4:return new d(h[0],h[1],h[2],h[3])}var k=[null];return n(p,k,h),new(n(r,d,k))}var I=w.prototype,$=g(b(I)?I:C),M=n(d,$,h);return b(M)?M:$}})},56370:function(o,c,t){"use strict";var e=t(17086);o.exports=e},72626:function(o,c,t){"use strict";var e=t(60382);o.exports=e}}]);
