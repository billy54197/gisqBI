(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[596],{19457:function(M,P,n){"use strict";var C=n(19534);Object.defineProperty(P,"__esModule",{value:!0}),P.default=void 0;var a=C(n(52909)),h=C(n(42579)),s=void 0,f={props:{isShow:{type:Boolean,default:!0},position:{type:Object,default:function(){return(0,h.default)(this,s),{type:"absolute",top:"1px",left:"1px"}}.bind(void 0)},isColumn:{type:Boolean,default:!1},title:{type:String},iconClass:{type:String},dragEnable:{type:Boolean,default:!1},showImg:{type:Boolean,default:!0},showLabel:{type:Boolean,default:!0},themeStyle:{type:Object}},data:function(){return{theme:"light"}},watch:{currentView:{handler:function(y){y==="earth"?this.theme="dark":this.theme="light"},immediate:!0}},mounted:function(){var y,D=this;this.$_mixin_generalButton=(0,a.default)(y=this.$children).call(y,function(A){return(0,h.default)(this,D),A.$options.name==="ShGeneralButton"}.bind(this))},methods:{getPosition:function(){var y;return(y=this.$_mixin_generalButton)===null||y===void 0?void 0:y.getPosition()}}},o=f;P.default=o},32726:function(M,P,n){"use strict";var C=n(49500),a=n(85208),h=n(59791),s=n(22466),f=n(83393),o=n(5077),d=n(19534);Object.defineProperty(P,"__esModule",{value:!0}),P.default=j;var y=d(n(11323)),D=d(n(43389)),A=d(n(34749)),B=d(n(42579)),O=d(n(85208)),U=d(n(28866)),p=d(n(22466)),F=d(n(81806)),R=d(n(5146));function c(m,b){var E=a(m);if(h){var L=h(m);b&&(L=s(L).call(L,function(H){return f(m,H).enumerable})),E.push.apply(E,L)}return E}function v(m){for(var b=1;b<arguments.length;b++){var E=arguments[b]!=null?arguments[b]:{};b%2?c(Object(E),!0).forEach(function(L){(0,D.default)(m,L,E[L])}):o?Object.defineProperties(m,o(E)):c(Object(E)).forEach(function(L){Object.defineProperty(m,L,f(E,L))})}return m}function I(m,b){for(var E=!1,L=m,H=function(){var Q=this;L=L.$parent;var Y=L.$refs;Y&&(0,O.default)(Y).forEach(function(J){(0,B.default)(this,Q),Y[J]===m&&(Y[J]=b,E=!0)}.bind(this))};L.$parent&&!E;)H()}function j(m){var b,E,L=this,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=H.configName,Q=H.componentName,Y=H.transform,J=(0,U.default)(b=(0,p.default)(E=m.mixins||[]).call(E,function(W){return(0,B.default)(this,L),!!W.props}.bind(this))).call(b,function(W){return(0,B.default)(this,L),{props:W.props}}.bind(this));return{name:Q||m.name,props:m.props,mixins:J,inject:{reactiveConfigInstance:{default:function(){var $=this;return function(){return(0,B.default)(this,$),null}.bind(this)}}},data:function(){return this.$configInfo={},{ready:!1}},computed:{configInstance:function(){return this.reactiveConfigInstance()}},mounted:function(){this.initConfig()},methods:{initConfig:function(){var $=this;return(0,A.default)(y.default.mark(function G(){var Z,T;return y.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!$.configInstance){S.next=17;break}return Z=$.$options.name.replace("Sh",""),T={},S.prev=3,S.next=6,$.configInstance.getWidgetInfoByTag(X||Z);case 6:T=S.sent,S.next=13;break;case 9:return S.prev=9,S.t0=S.catch(3),C.error(S.t0),S.abrupt("return");case 13:if(T.stat){S.next=15;break}return S.abrupt("return");case 15:typeof Y=="function"&&T.data?T=Y(T.data,$.configInstance.widgetInfo.mapConfig,{url:$.configInstance.url.replace("/role/getResources",""),schemeId:$.configInstance.schemeId}):T=T.data,$.$configInfo=v({},T);case 17:$.ready=!0;case 18:case"end":return S.stop()}},G,null,[[3,9]])}))()},forwordRef:function(){var $;I(this._self,this._self.$children[0]),($=this._self.$children[0])===null||$===void 0||$.$emit("mounted",this._self.$children[0])}},render:function($){var G,Z=this,T;if((0,F.default)(G=(0,O.default)(this.$listeners)).call(G,"hook:mounted")){var k;T=v(v({},this.$listeners),{},{"hook:mounted":(0,R.default)(k=[this.forwordRef]).call(k,this.$listeners["hook:mounted"])})}else T=v(v({},this.$listeners),{},{"hook:mounted":this.forwordRef});var S=this.$options.propsData;return(0,O.default)(S).forEach(function(tt){(0,B.default)(this,Z),S[tt]===void 0&&delete S[tt]}.bind(this)),this.ready?$(m,{on:T,scopedSlots:this.$scopedSlots,props:v(v({},this.$configInfo),S),attrs:this.$attrs},this.$slots.default):null}}}},98140:function(M,P,n){var C=n(49500);M.exports=function(a){var h={};function s(f){if(h[f])return h[f].exports;var o=h[f]={i:f,l:!1,exports:{}};return a[f].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=a,s.c=h,s.d=function(f,o,d){s.o(f,o)||Object.defineProperty(f,o,{enumerable:!0,get:d})},s.r=function(f){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},s.t=function(f,o){if(o&1&&(f=s(f)),o&8||o&4&&typeof f=="object"&&f&&f.__esModule)return f;var d=Object.create(null);if(s.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:f}),o&2&&typeof f!="string")for(var y in f)s.d(d,y,function(D){return f[D]}.bind(null,y));return d},s.n=function(f){var o=f&&f.__esModule?function(){return f.default}:function(){return f};return s.d(o,"a",o),o},s.o=function(f,o){return Object.prototype.hasOwnProperty.call(f,o)},s.p="/dist/",s(s.s=792)}({0:function(a,h){a.exports=n(42579)},110:function(a,h){a.exports=n(46769)},16:function(a,h){a.exports=n(91873)},17:function(a,h){a.exports=n(85208)},18:function(a,h){a.exports=n(59791)},19:function(a,h){a.exports=n(83393)},2:function(a,h,s){"use strict";s.d(h,"a",function(){return f});function f(o,d,y,D,A,B,O,U){var p=typeof o=="function"?o.options:o;d&&(p.render=d,p.staticRenderFns=y,p._compiled=!0),D&&(p.functional=!0),B&&(p._scopeId="data-v-"+B);var F;if(O?(F=function(v){v=v||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!v&&typeof __VUE_SSR_CONTEXT__<"u"&&(v=__VUE_SSR_CONTEXT__),A&&A.call(this,v),v&&v._registeredComponents&&v._registeredComponents.add(O)},p._ssrRegister=F):A&&(F=U?function(){A.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:A),F)if(p.functional){p._injectStyles=F;var R=p.render;p.render=function(I,j){return F.call(j),R(I,j)}}else{var c=p.beforeCreate;p.beforeCreate=c?[].concat(c,F):[F]}return{exports:o,options:p}}},20:function(a,h){a.exports=n(5077)},21:function(a,h){a.exports=n(81806)},22:function(a,h){a.exports=n(69033)},25:function(a,h){a.exports=n(43389)},28:function(a,h){a.exports=n(32726)},30:function(a,h){a.exports=n(32569)},35:function(a,h){a.exports=n(49162)},36:function(a,h){a.exports=n(59269)},368:function(a,h){a.exports=n(98924)},4:function(a,h){a.exports=n(55616)},47:function(a,h){a.exports=n(10563)},58:function(a,h){a.exports=n(65594)},6:function(a,h){a.exports=n(83574)},60:function(a,h){a.exports=n(8421)},61:function(a,h){a.exports=n(19457)},65:function(a,h){a.exports=n(92405)},66:function(a,h){a.exports=n(37029)},67:function(a,h){a.exports=n(31694)},7:function(a,h){a.exports=n(17249)},792:function(a,h,s){"use strict";s.r(h);var f=s(0),o=s.n(f),d=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.shouldShow,expression:"shouldShow"}],staticClass:"sh-split-tool"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticStyle:{width:"100%",height:"100%"}},[t.$slots.default?e("span",{staticStyle:{width:"100%",height:"100%"},on:{click:t.toggle}},[t._t("default")],2):e("general-button",{attrs:{position:t.position,"is-column":t.isColumn,"drag-enable":t.dragEnable,"icon-class":t.iconClass?t.iconClass:"split-tool","show-img":t.showImg,"show-label":t.showLabel,"theme-style":t.themeStyle,title:t.title?t.title:"\u5206\u5272"},on:{click:t.toggle}})],1),t.dialogVisible?e("general-container",{ref:"container",staticClass:"sh-split-tool",attrs:{title:"\u786E\u5B9A\u5206\u5272\u56FE\u73ED?","style-config":t.cardStyleConfig,position:t.panelPosition,"append-to-body":!0,"img-src":t.iconClass?t.iconClass:"split",theme:"light"},on:{afterClose:t.toggle,"change:isShow":t.onChangeIsShow}},[e("div",[e("div",{staticClass:"diaBody split-label"},[t.cardShow?e("div",{staticStyle:{width:"100%"}},[e("div",{staticClass:"lineListDiv"},[t.lineList.length>0?e("div",t._l(t.lineList,function(r,l){return e("div",{key:r.id,staticClass:"lineItem",on:{mouseenter:function(u){return t.mouseover(r)},mouseleave:function(u){return t.mouseLeave(r)}}},[e("div",{staticClass:"lineName"},[t._v(t._s(r.name)+":")]),e("div",{staticClass:"lineDiv",style:"background: "+r.color+";"}),e("span",{directives:[{name:"show",rawName:"v-show",value:r.show,expression:"line.show"}],staticClass:"delBtn",on:{click:function(u){return t._deleteLine(r.id,l)}}},[e("i",{staticClass:"el-icon-delete"})])])}),0):e("div",{staticStyle:{"text-align":"center"}},[t._v("\u8BF7\u7ED8\u5236\u5206\u5272\u7EBF")])])]):t._e()]),e("div",{staticClass:"btns"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t._confirmSave}},[t._v(t._s(t.isSplitFinish?"\u4FDD \u5B58":"\u5207 \u5272"))]),t.isSplitFinish?t._e():e("el-button",{attrs:{type:"warning",size:"small"},on:{click:t.clearAll}},[t._v("\u6E05\u7A7A")]),t.isSplitFinish?e("el-button",{attrs:{type:"warning",size:"small"},on:{click:t.revoke}},[t._v("\u64A4\u9500")]):t._e()],1)])]):t._e()],1)},y=[];d._withStripped=!0;var D=s(17),A=s.n(D),B=s(18),O=s.n(B),U=s(8),p=s.n(U),F=s(19),R=s.n(F),c=s(20),v=s.n(c),I=s(25),j=s.n(I),m=s(368),b=s.n(m),E=s(21),L=s.n(E),H=s(22),X=s.n(H),Q=s(6),Y=s.n(Q),J=s(7),W=s.n(J),$=s(85),G=s(16),Z=s(65),T=s.n(Z),k=s(66),S=s.n(k),tt=s(110),V=s(4),ft=s(47),ut=s(67),dt=s.n(ut),ct=s(35),vt=s.n(ct),pt=s(60),gt=s.n(pt),mt=s(30),yt=s.n(mt),St=s(61),xt=s.n(St),Ct=s(58),et=s.n(Ct),q=s(36),rt=void 0;function ot(t,i){var e=A()(t);if(O.a){var r=O()(t);i&&(r=p()(r).call(r,function(l){return R()(t,l).enumerable})),e.push.apply(e,r)}return e}function lt(t){for(var i=1;i<arguments.length;i++){var e=arguments[i]!=null?arguments[i]:{};i%2?ot(Object(e),!0).forEach(function(r){j()(t,r,e[r])}):v.a?Object.defineProperties(t,v()(e)):ot(Object(e)).forEach(function(r){Object.defineProperty(t,r,R()(e,r))})}return t}var It={name:"ShSplitTool",components:{GeneralButton:gt.a,GeneralContainer:yt.a},mixins:[Y.a,W.a,xt.a],props:{position:{type:Object,default:function(){return o()(this,rt),{type:"absolute",top:"1px",left:"490px"}}.bind(void 0)},url:{type:String},lineConfig:{type:Object},autoExecute:{type:Boolean,default:!0},autoSave:{type:Boolean,default:!1},isShowDialog:{type:Boolean,default:!0},panelPosition:{type:Object,default:function(){return o()(this,rt),{type:"absolute",top:"40vh",left:"400px",zIndex:9999}}.bind(void 0)},panelStyleConfig:{type:Object,default:function(){o()(this,rt)}.bind(void 0)}},data:function(){return{shouldShow:!1,typeConfig:{isShowBtn:!1,isStartFix:!1,titleBar:{miniBtn:!1,maxBtn:!1,closeBtn:!0,fixBtn:!1,title:!0},autoVisible:!1,size:{radius:"4px",width:"300px",height:"300px"}},isSplitFinish:!1,warningDuration:1500,showCard:!0,cardShow:!1,lineList:[],allFeatures:{},wktFormat:new dt.a,geoJSON:new vt.a,splitWkts:[],deleteIds:[],active:!1,dialogVisible:!1,newFeatures:[],originFeatures:[],splitCount:0,reovkeIndex:0,layerPrimaryKey:"id"}},computed:{cardStyleConfig:function(){return lt(lt({},this.typeConfig),this.panelStyleConfig)}},watch:{currentView:{handler:function(i){this.shouldShow=i==="map"},immediate:!0},currentInteraction:function(i){i!==this.$options.name&&this.active&&this.deactivate()}},mounted:function(){var i=this;this.$earth&&setTimeout(function(){o()(this,i),this.begin()}.bind(this),0)},methods:{begin:function(){this._baseUrl=this.url?this.url:this.shinegaUrl},onChangeIsShow:function(i){this.$emit("change:isShow",i)},toggle:function(i){var e;typeof i=="boolean"?e=i:e=!this.active,e?this.activate():this.deactivate()},activate:function(){this.isSplitFinish=!1,this.splitCount=0,this.reovkeIndex=0,this.originFeatures=[],this.newFeatures=[];var i=this.$map.getSelectFeatures();i.length>0?(this.active=!0,this.dialogVisible=!this.autoSave,this.isShowDialog===!1&&(this.dialogVisible=!1),this.showCard&&(this.cardShow=!0),this._initLine(),this.$emit("change:active",!0)):V.Message.warning("\u8BF7\u5148\u9009\u62E9\u9700\u8981\u88AB\u5206\u5272\u7684\u5730\u5757")},deactivate:function(){this.isSplitFinish=!1,this.splitCount=0,this.reovkeIndex=0,this.originFeatures=[],this.newFeatures=[],this.drawLine&&this.$map.removeInteraction(this.drawLine),this.showCard&&(this.cardShow=!1),this.active=!1,this.dialogVisible=!1,this.$emit("change:active",!1)},clearAll:function(){var i=this;this.lineList.forEach(function(e){o()(this,i);var r=e.id,l=this.allFeatures[r];if(l)try{this.drawSource.removeFeature(l)}catch(u){C.warn(u)}}.bind(this)),this.lineList=[],this.allFeatures={}},_executeSplit:function(){var i=this,e=this.selectedFeatures=this.$map.getSelectFeatures();if(e&&e.length>0){var r=this._createMuliLine();this.splitWkts=[],this.deleteIds=[],e.forEach(function(l,u){o()(this,i);var g=l.getGeometry(),x=this.wktFormat.writeGeometry(g);this.splitWkts.push({id:"split_"+u,geom:x});var N=l.id_?l.id_:l.ol_uid,w=N.split("."),z=w[1]?w[1]:w[0];this.deleteIds.push(z)}.bind(this)),this._bboxCilp(r,this.splitWkts)}else V.Message.warning("\u8BF7\u9009\u62E9\u8981\u5207\u5272\u7684\u56FE\u5F62")},_createMuliLine:function(){var i=this,e=b()(this.allFeatures),r=[];e.forEach(function(x){o()(this,i);var N=x.getGeometry(),w=N.getCoordinates();r.push(w)}.bind(this));var l=Object(tt.multiLineString)(r),u=this.geoJSON.readFeature(l.geometry),g=u.getGeometry();return this.wktFormat.writeGeometry(g)},_bboxCilp:function(i,e){var r=this,l=this._Loading();new et.a(this._baseUrl).split({features:e,splitLine:i,token:this.token}).then(function(u){o()(this,r),u.success?u.data.length>0?(this.isSplitFinish=!0,this.resultHandel(u.data,this.layerPrimaryKey),l.close()):V.Message.warning("\u6CA1\u6709\u5206\u5272\u7ED3\u679C!"):V.Message.error("\u56FE\u5F62\u5206\u5272\u5931\u8D25!")}.bind(this)).catch(function(u){o()(this,r),l.close(),C.error(u),V.Message.error("\u56FE\u5F62\u5206\u5272\u5931\u8D25!")}.bind(this))},resultHandel:function(i,e){var r=this;this.splitCount+=1,this.reovkeIndex=this.splitCount,this.newFeatures=[];var l=this.selectedFeatures=this.$map.getSelectFeatures(),u={id:this.splitCount,features:l};this.originFeatures.push(u);var g=[];i.forEach(function(x){var N=this;o()(this,r);var w=x.id,z=this.wktFormat.readGeometry(x.st_astext),K=null;l.forEach(function(st,at){o()(this,N),w==="split_"+at&&(K=st)}.bind(this));var nt=z.geometries_;nt.forEach(function(st,at){if(o()(this,N),!this.autoSave){var _=K.clone();_.setGeometry(st),at!==0&&_.unset(e),_.set("tempSelected",!0),this.$map.getLayerById(q.BASE_DRAWLAYER_ID).getSource().addFeature(_),this.newFeatures.push(_)}var jt=this.wktFormat.writeGeometry(st),ht=this._setParams({wkt:jt,id:w,index:at});ht&&g.push(ht)}.bind(this)),this.$map.getLayerById(q.BASE_DRAWLAYER_ID).getSource().removeFeature(K)}.bind(this)),g.length>0&&(this.$emit("splitSuccess",g),this.autoSave&&(this.splitCount=0,this.reovkeIndex=0,this._save(g),this.splitCount=0,this.reovkeIndex=0)),this.clearAll()},_setParams:function(i){var e=i.wkt,r=i.id,l=i.feature,u=i.index;r=r.split("_")[1];var g=null;l?g=l:g=this.selectedFeatures[r];var x=g.values_;x=x||{};var N=[],w={};for(var z in x)if(!(z==="id"&&u&&u>0)&&z!=="geometry"&&z!=="isSelected"&&z!=="tempSelected"){var K=x[z];typeof K=="string"&&Object(ft.strDateTime)(K)&&(K=""+K.substr(0,K.length-1)),N.push({name:z,value:K})}var nt=this._getEditLayerInfo();return nt?(w.attribute=N,w.featureClass=nt.layerTable,w.topological=!0,w.checkLevel=0,w.geometry=e,w.spatialReference=this._getWkid().spatialReference,w.filter=""):w=null,w},_confirmSave:function(){var i=this;if(!this.isSplitFinish)this._executeSplit();else if(!this.autoSave){var e=this._getEditLayerInfo();if(!e){V.Message.warning("\u8BF7\u5148\u9009\u62E9\u9700\u8981\u4FDD\u5B58\u7684\u56FE\u5C42");return}var r=this.selectedFeatures=this.$map.getSelectFeatures(),l=[];r.forEach(function(u){o()(this,i);var g=this.wktFormat.writeGeometry(u.getGeometry()),x=this._setParams({wkt:g,id:"1_1",feature:u});x&&l.push(x)}.bind(this)),l.length>0&&this._save(l)}this.splitCount=0,this.reovkeIndex=0},_save:function(i){var e,r=this;new et.a(this._baseUrl,this.shinegaDatabaseId).save({features:i,options:(e=this.options)===null||e===void 0?void 0:e.saveOptions,ruleOptions:this.ruleOptions,token:this.token}).then(function(l){if(o()(this,r),this.loadingInstance.close(),l.success){var u=this.$map.getLayerById(q.BASE_DRAWLAYER_ID);u.getSource().clear(),V.Message.success("\u56FE\u5F62\u5206\u5272\u6210\u529F"),this.$map.refresh(),this.clearAll()}else V.Message.error("\u5206\u5272\u7ED3\u679C\u4FDD\u5B58\u5931\u8D25")}.bind(this)).catch(function(l){o()(this,r),C.error(l),V.Message.error("\u5206\u5272\u7ED3\u679C\u4FDD\u5B58\u5931\u8D25"),this.loadingInstance.close()}.bind(this))},_deleteCurrentGraphics:function(){var i=this,e=this._getEditLayerInfo();new et.a(this._baseUrl,this.shinegaDatabaseId).getPrimaryKey({layerTable:e.layerTable,token:this.token}).then(function(r){var l=this;if(o()(this,i),r.success){this.primaryKey=r.data.key,this.primaryType=r.data.type;var u=[];this.deleteIds.forEach(function(g){o()(this,l),this.primaryType==="bigint"||this.primaryType==="smallint"||this.primaryType==="integer"?u=this.deleteIds:u.push("'"+g+"'")}.bind(this)),new et.a(this._baseUrl,this.shinegaDatabaseId).delete({featureClass:e.layerTable,filterWhere:this.primaryKey+" in ("+u.join(",")+")",token:this.token}).then(function(g){if(o()(this,l),g.success){var x=e.id,N=this.$map.getLayerById(x);N.getSource().refresh(),this.$map.refresh()}else V.Message.error("\u539F\u56FE\u5F62\u5220\u9664\u5931\u8D25")}.bind(this)).catch(function(g){o()(this,l),C.error(g),V.Message.error("\u539F\u56FE\u5F62\u5220\u9664\u5931\u8D25")}.bind(this))}}.bind(this)).catch(function(r){o()(this,i),C.error(r)}.bind(this))},drawLineEnd:function(i){this.isSplitFinish=!1;var e=this._getStyle();i.setStyle(e),this._setList(i),this.autoExecute&&this._executeSplit()},_initLine:function(){var i=this;if(!this.drawLine&&this.$map){var e=this.$map,r=this.drawSource=this._createSplitLayer(e),l=this.lineConfig?this.lineConfig.lineColor:"";this.drawLine=new $.Draw({type:"LineString",source:r,map:e,style:new G.Style({fill:new G.Fill({color:"#0044CC"}),stroke:new G.Stroke({lineDash:[1,2,3,4,5,6],color:l||"#34f509",width:4})})}),this.drawLine.on("drawend",function(u){o()(this,i),this.drawLineEnd(u.feature)}.bind(this))}this.$map.addInteraction(this.drawLine)},_deleteLine:function(i,e){this.$delete(this.lineList,e);var r=this.allFeatures[i];r&&(this.drawSource.removeFeature(r),this.$delete(this.allFeatures,i))},_createSplitLayer:function(i){var e=this,r=this.$map.getLayers().getArray(),l=null,u=null;if(r.forEach(function(x){o()(this,e),x.values_.id==="flashTempLayer"&&(l=x)}.bind(this)),l)u=l.getSource();else{u=new T.a;var g=new S.a({id:"splitLineLayer",source:u,zIndex:9999999,opacity:1});i.addLayer(g)}return u},_setList:function(i){var e=this.lineList.length,r=this.lineList[e-1],l=r?r.id.split("_")[1]:0,u="split_"+(parseInt(l)+1);i.id=u;var g={id:u,name:"\u5207\u5272\u7EBF"+(parseInt(l)+1),color:this._lineColor?this._lineColor:"#34f509"};this.allFeatures[u]=i,this.$set(this.lineList,e,g)},_getStyle:function(){var i=this.lineConfig?this.lineConfig.lineColor:"",e=new G.Style({fill:new G.Fill({color:"#0044CC"}),stroke:new G.Stroke({lineDash:[1,2,3,4,5,6],color:i||"#34f509",width:4})}),r=this.lineConfig?this.lineConfig.showTag:!1;if(r){var l=this.lineConfig?this.lineConfig.tagColor:"",u=this.lineList.length,g=this.lineList[u-1],x=g?g.id.split("_")[1]:0,N=new G.Text({font:"20px Microsoft YaHei",text:parseInt(x)+1+"",textAlign:"left",fill:new G.Fill({color:l||"#f50938"})});e.setText(N)}return e},_getEditLayerInfo:function(){this.layerManager||(this.layerManager=this.$map.layerManager);var i=this.layerManager.getEditLayer(),e=i?i.metadata:void 0;return!e||!e.layerTable?(this.loadingInstance&&this.loadingInstance.close(),null):e},_getWkid:function(){var i="EPSG:4490",e=4490;return this.$map&&(i=this.$map.getView().getProjection().getCode(),e=L()(i).call(i,":")?i.split(":")[1]:i),{projection:i,spatialReference:e}},_clearLayer:function(){var i=this,e=this.$map.getLayers().getArray();e.length>0&&e.forEach(function(r){o()(this,i),r.values_.id==="splitLineLayer"&&this.$map.removeLayer(r)}.bind(this)),this.deactivate(),this.drawLine=null},_Loading:function(){return this.loadingInstance||(this.loadingInstance=V.Loading.service({target:this.$map.getTargetElement(),lock:!0,text:"\u6B63\u5728\u5206\u5272...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})),this.loadingInstance},revoke:function(){var i=this;this.reovkeIndex>0&&(this.newFeatures.forEach(function(e){o()(this,i),this.$map.getLayerById(q.BASE_DRAWLAYER_ID).getSource().removeFeature(e)}.bind(this)),this.newFeatures=[],this.originFeatures.forEach(function(e){var r=this;if(o()(this,i),e.id===this.reovkeIndex){var l;this.$map.getLayerById(q.BASE_DRAWLAYER_ID).getSource().addFeatures(e.features),X()(l=this.originFeatures).call(l,this.originFeatures.indexOf(e),1),e.features.forEach(function(u){o()(this,r),this.newFeatures.push(u)}.bind(this))}}.bind(this)),this.reovkeIndex-=1,this.splitCount=this.reovkeIndex)},mouseover:function(i){var e=this;this.lineList.forEach(function(r){o()(this,e),this.$set(r,"show",!1)}.bind(this)),this.$set(i,"show",!0)},mouseLeave:function(i){this.$set(i,"show",!1)}}},Lt=It,$t=s(2),wt=Object($t.a)(Lt,d,y,!1,null,null,null),Ft=wt.exports,bt=s(28),Et=s.n(bt),Ot=void 0,it=Et()(Ft,{transform:function(i){o()(this,Ot);var e=i.show,r=i.label,l=i.position;return{isShow:e,title:r,position:l}}.bind(void 0)});it.install=function(t){t.component(it.name,it)};var Pt=h.default=it},8:function(a,h){a.exports=n(22466)},85:function(a,h){a.exports=n(12768)}})},596:function(M,P,n){"use strict";n.r(P),n.d(P,{default:function(){return F}});var C=function(){var c=this,v=c._self._c;return v("div",{directives:[{name:"show",rawName:"v-show",value:c.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:c.widgetInfo.attr.w+"px",height:c.widgetInfo.attr.hh+"px"}},[v("SplitTool",c._b({ref:"split",style:{width:c.widgetInfo.attr.w+"px",height:c.widgetInfo.attr.hh+"px"},attrs:{"auto-execute":c.widgetInfo.config.autoExecute,"auto-save":c.widgetInfo.config.autoSave,"is-show-dialog":c.widgetInfo.config.isShowDialog,"theme-style":c.themeConfig,panelPosition:c.position,position:c.btnPosition,"style-config":c.styleConfig},on:{splitSuccess:c.splitSuccess}},"SplitTool",c.widgetInfo.config.btnConfig,!1))],1)},a=[],h=n(98140),s=n.n(h),f=n(86892),o=n(45061),d=n(26711),y=n(27966),D=n(50681),A=n(49500),B={name:"GisSplit",components:{SplitTool:s()},mixins:[f.D,d.H,o.u,D.Z],props:["widgetInfo"],data(){return{map:null,width:"16px",height:"16px",fontSize:"12px;"}},computed:{position(){return{type:"absolute",top:this.widgetInfo.config.dialog.top,left:this.widgetInfo.config.dialog.left}},styleConfig(){return{size:{radius:"4px",width:this.widgetInfo.config.dialog.width,height:"200px"}}}},mounted(){A.log(this.widgetInfo.config.dialog),this.initAction(this.widgetInfo)},methods:{reLoadInfo(R){this.btnAttr=R.attr},initAction(R){this.actionReceive(R)},splitSuccess(R){let c=this,v=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(v,I=>{if(I.enabled&&I.code==c.$$global_editor.actionType.splitSuccess.code){let j=I.code+"_"+c.widgetInfo.id,m={result:R};if(I.paramsExtend&&I.paramsExtend.length>0&&this.getExtendParams(m,I.paramsExtend,[],[]),I.script&&I.script.enabled&&I.script.content){this.doConfigMap=new Function("data",I.script.content);let b=this.doConfigMap(m);b&&(m=b)}y.Z.$emit(j,m),I.postMessage&&this.doPostMessage(m),this.actionNameList.push(j)}})}}},O=B,U=n(68141),p=(0,U.Z)(O,C,a,!1,null,"55c296d8",null),F=p.exports},98924:function(M,P,n){M.exports=n(75595)},80744:function(M,P,n){"use strict";n(66032);var C=n(94388);M.exports=C.Object.values},45291:function(M,P,n){"use strict";var C=n(14451),a=n(27909),h=n(36021),s=n(66167),f=n(98564),o=n(4036),d=n(7196).f,y=h(d),D=h([].push),A=C&&a(function(){var O=Object.create(null);return O[2]=2,!y(O,2)}),B=function(O){return function(U){for(var p=o(U),F=f(p),R=A&&s(p)===null,c=F.length,v=0,I=[],j;c>v;)j=F[v++],(!C||(R?j in p:y(p,j)))&&D(I,O?[j,p[j]]:p[j]);return I}};M.exports={entries:B(!0),values:B(!1)}},66032:function(M,P,n){"use strict";var C=n(90434),a=n(45291).values;C({target:"Object",stat:!0},{values:function(s){return a(s)}})},75595:function(M,P,n){"use strict";var C=n(80744);M.exports=C}}]);
