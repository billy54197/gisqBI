"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[20160],{638913:function(b,c,l){l.d(c,{$:function(){return g}});var m=l(654395);const g={components:{MyMonacoEditor:()=>Promise.resolve().then(l.bind(l,980424)),shortcutkey:m.Z},data(){return{editDialog:!1,dialogFullScr:!1,dialogWidth:"0px",navMenu_list:[{id:"remark",name:"\u811A\u672C\u7F16\u8F91\u5668",type:"remark"},{id:"examples",name:"\u770B\u677F\u4FE1\u606F\u6CE8\u89E3",type:"examples"}],activated:{id:"remark",type:"remark"},script_examples:`/*{
                canvasSetting:\u770B\u677F\u57FA\u672C\u4FE1\u606F\uFF1B
                widgets:\u770B\u677F\u4E2D\u6240\u6709\u7EC4\u4EF6\u4FE1\u606F\uFF1B
                }*/`,mouseOverClassName:" background_color_grey",divH:0,script_content:""}},mounted(){this.divH=window.innerHeight-51,this.dialogWidth=window.innerWidth-170+"px",window.addEventListener("resize",()=>{this.divH=window.innerHeight-51})},methods:{showEditorDialog(s){this.editDialog=!0,this.script_content=JSON.stringify(s);let a=this;if(a.$refs.sampleCode)a.$refs.sampleCode.initEditor();else{let o=setTimeout(()=>{a.$refs.sampleCode&&a.$refs.sampleCode.initEditor(),clearTimeout(o)},500)}this.$nextTick(()=>{this.dragControllerDiv()})},cancel(){this.editDialog=!1,this.$refs.sampleCode.setValue("")},confirm(){this.currentWidget.config=JSON.parse(this.script_content),this.getConfigData(),this.editDialog=!1},setFullScreen(){this.dialogFullScr=!this.dialogFullScr,this.divH=this.dialogFullScr?window.innerHeight+35:window.innerHeight-51,this.$refs.sampleCode.initEditor()},closeDialog(){this.dialogFullScr=!1,this.divH=this.dialogFullScr?window.innerHeight+35:window.innerHeight-51},dragControllerDiv:function(){let s=this;var a=this.$refs.queryResize,o=this.$refs.left,f=this.$refs.mid,d=this.$refs.box;a.onmousedown=function(r){s.$refs.queryResize.focus(),a.style.background="#818181";var p=r.clientX;return a.left=a.offsetLeft,document.onmousemove=function(v){var h=v.clientX,n=a.left+(h-p),u=d.clientWidth-a.offsetWidth;n<200&&(n=200),n>u-200&&(n=u-200),a.style.left=n,o.style.width=n+"px",f.style.width=d.clientWidth-n-10+"px"},document.onmouseup=function(){a.style.background="#d6d6d6",document.onmousemove=null,document.onmouseup=null,a.releaseCapture&&a.releaseCapture(),s.$refs.sampleCode.initEditor(),s.$refs.script_aip_examples.initEditor()},a.setCapture&&a.setCapture(),!1}},onMouseEnter(s){s.currentTarget.className=s.currentTarget.className+this.mouseOverClassName},onMouseLeave(s){let a=s.currentTarget.className.indexOf(this.mouseOverClassName);a>-1&&(s.currentTarget.className=s.currentTarget.className.substring(0,a)+s.currentTarget.className.substring(a+this.mouseOverClassName.length))},onActivated(s){this.activated.id=s.id,this.activated.type=s.type,this.$nextTick(()=>{switch(this.activated.type){case"examples":this.activatedExamples();break}})},activatedExamples(){this.$refs.script_aip_examples&&(this.$refs.script_aip_examples.initEditor(),this.$nextTick(()=>{this.$refs.script_aip_examples.formatDocument(),setTimeout(()=>{this.$refs.script_aip_examples.setReadOnly()},1e3)}))}}}},120160:function(b,c,l){l.r(c),l.d(c,{default:function(){return y}});var m=function(){var e=this,t=e._self._c;return t("div",[t("el-collapse",[t("el-collapse-item",[t("template",{slot:"title"},[t("div",{staticClass:"my-title"},[e._v("\u5B8C\u6210\u529E\u4EF6\u5C5E\u6027")])]),t("vue-lazy-component",[t("el-form",{ref:"form",attrs:{model:e.currentWidget.config,"label-width":"105px",size:"mini"}},[t("el-form-item",{attrs:{label:"\u529E\u4EF6\u7C7B\u578B"}},[t("el-select",{staticStyle:{width:"185px"},attrs:{placeholder:"\u8BF7\u9009\u62E9\u529E\u4EF6\u7C7B\u578B"},on:{change:e.getConfigData},model:{value:e.currentWidget.config.componentName,callback:function(i){e.$set(e.currentWidget.config,"componentName",i)},expression:"currentWidget.config.componentName"}},e._l(e.taskMode,function(i){return t("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),t("el-form-item",{attrs:{label:"\u5217\u8868\u6837\u5F0F"}},[t("el-select",{staticStyle:{width:"185px"},attrs:{placeholder:"\u8BF7\u9009\u62E9\u5217\u8868\u6837\u5F0F"},on:{change:e.getConfigData},model:{value:e.currentWidget.config.tableConfig,callback:function(i){e.$set(e.currentWidget.config,"tableConfig",i)},expression:"currentWidget.config.tableConfig"}},e._l(e.tableMode,function(i){return t("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),t("el-form-item",{attrs:{label:"\u6570\u636E\u5305\u62EC"}},[t("el-checkbox",{on:{change:e.getConfigData},model:{value:e.currentWidget.config.isIncludeTask,callback:function(i){e.$set(e.currentWidget.config,"isIncludeTask",i)},expression:"currentWidget.config.isIncludeTask"}},[e._v("\u534F\u529E\u529E\u4EF6")])],1),t("el-form-item",{attrs:{label:"\u542F\u7528\u5217\u6392\u5E8F"}},[t("el-switch",{on:{change:e.getConfigData},model:{value:e.currentWidget.config.columnSort,callback:function(i){e.$set(e.currentWidget.config,"columnSort",i)},expression:"currentWidget.config.columnSort"}})],1),t("el-form-item",{attrs:{label:"\u503C\u53D8\u5316\u5373\u67E5\u8BE2"}},[t("el-switch",{on:{change:e.getConfigData},model:{value:e.currentWidget.config.instantQuery,callback:function(i){e.$set(e.currentWidget.config,"instantQuery",i)},expression:"currentWidget.config.instantQuery"}})],1),t("el-form-item",{attrs:{label:"\u529E\u4EF6\u53D8\u91CF"}},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){e.dialogTaskVisible=!0}}},[e._v("\u529E\u4EF6\u53D8\u91CF")])],1),t("el-form-item",{attrs:{label:"\u67E5\u8BE2\u6761\u4EF6\u914D\u7F6E"}},[t("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:e.clickedSearchSetting}})],1),t("el-form-item",{attrs:{label:"\u6309\u94AE\u529F\u80FD\u914D\u7F6E"}},[t("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:e.clickedButtonSetting}})],1),t("el-form-item",{attrs:{label:"\u5217\u540D\u663E\u793A\u914D\u7F6E"}},[t("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:e.clickedColumnSetting}})],1),t("el-form-item",{attrs:{label:"\u6863\u6848\u888B\u5730\u5740"}},[t("el-input",{staticStyle:{width:"165px",marginRight:"5px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u6863\u6848\u888B\u5730\u5740"},on:{change:e.getConfigData},model:{value:e.currentWidget.config.filebagUrl,callback:function(i){e.$set(e.currentWidget.config,"filebagUrl",i)},expression:"currentWidget.config.filebagUrl"}}),t("el-tooltip",[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("\u9ED8\u8BA4\u4E3A\u7A7A\u65F6\u5373\u53EF\u6253\u5F00\u5BF9\u5E94\u7684\u6863\u6848\u888B\u9875\u9762\uFF1B\u82E5\u9700\u8DF3\u8F6C\u5230\u5176\u4ED6\u9ED8\u8BA4\u5730\u5740\uFF0C\u8BF7\u5728\u6B64\u5904\u586B\u5199\u3002")]),t("i",{staticClass:"el-icon-info"})])],1)],1),t("el-form",{ref:"form",staticStyle:{marginTop:"25px"},attrs:{"label-width":"50px",size:"mini"}},[t("el-form-item",{attrs:{label:"\u5B8C\u6210\u529E\u4EF6\u4EE3\u7801\u6A21\u5F0F","label-width":"135px"}},[t("el-button",{attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(i){return e.showEditorDialog(e.currentWidget.config)}}})],1)],1)],1)],2)],1),t("el-dialog",{ref:"editDialog",class:["dialog-publish",e.dialogFullScr?"full-screen":""],attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:e.dialogFullScr,visible:e.editDialog,width:e.dialogWidth,top:"10px"},on:{"update:visible":function(i){e.editDialog=i},close:e.closeDialog}},[t("div",{staticStyle:{overflow:"hidden",width:"100%"},attrs:{slot:"title"},slot:"title"},[t("span",[e._v("\u5B8C\u6210\u529E\u4EF6\u4EE3\u7801\u6A21\u5F0F")]),t("div",{class:["dialog_title",e.dialogFullScr?"dialog_full_screen":""]},[e.dialogFullScr?t("span",{staticClass:"iconfont bi_min1",on:{click:e.setFullScreen}}):t("span",{staticClass:"iconfont bi_max1",on:{click:e.setFullScreen}}),t("span",{staticClass:"iconfont bi_close",on:{click:e.cancel}})])]),t("div",{staticClass:"main-content",style:{height:e.divH-180+"px"}},[t("div",{ref:"box",staticClass:"box",style:{height:e.divH-180+"px"}},[t("div",{ref:"left",staticClass:"left",style:{height:e.divH-180+"px"}},[t("my-monaco-editor",{ref:"sampleCode",attrs:{language:"json",theme:"vs"},model:{value:e.script_content,callback:function(i){e.script_content=i},expression:"script_content"}})],1),t("el-tooltip",{attrs:{"open-delay":1e3,content:"\u5DE6\u53F3\u6ED1\u52A8\u8C03\u6574\u5927\u5C0F",effect:"light",placement:"top"}},[t("div",{ref:"queryResize",staticClass:"resize"},[e._v(" \u22EE ")])]),t("div",{ref:"mid",staticClass:"mid"},[t("el-aside",{staticClass:"my-aside",attrs:{width:"150px"}},[t("el-row",[e._l(e.navMenu_list,function(i,k){return[t("el-col",{key:k,attrs:{span:24}},[i.divider?[t("el-divider",[e._v(e._s(i.name))])]:[t("div",{class:"my-navMenu-list "+(e.activated.id==i.id?"color_blue":""),on:{click:function(C){return e.onActivated(i)},mouseenter:e.onMouseEnter,mouseleave:e.onMouseLeave}},[e._v(" "+e._s(i.name)+" ")])]],2)]})],2)],1),t("el-container",{staticStyle:{height:"100%"}},[t("shortcutkey",{directives:[{name:"show",rawName:"v-show",value:e.activated.type=="remark",expression:"activated.type == 'remark'"}]}),t("my-monaco-editor",{directives:[{name:"show",rawName:"v-show",value:e.activated.type=="examples",expression:"activated.type == 'examples'"}],ref:"script_aip_examples",attrs:{language:"javascript",theme:"vs"},model:{value:e.script_examples,callback:function(i){e.script_examples=i},expression:"script_examples"}})],1)],1)],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("\u53D6 \u6D88")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.confirm}},[e._v("\u786E \u5B9A")])],1)]),t("el-dialog",{staticClass:"my-image-dialog",attrs:{"append-to-body":!0,"close-on-click-modal":!1,visible:e.dialogTaskVisible,title:"\u529E\u4EF6\u53D8\u91CF",top:"10px",width:"88%"},on:{"update:visible":function(i){e.dialogTaskVisible=i}}},[t("div",[t("iframe",{staticClass:"platform-page",style:{height:"calc(100vh - 230px)",width:"100%",border:"0px"},attrs:{src:e.domain+"#/gisqbiDialog/keyvalueSetting?containCommon=true&subGuid="+this.editorAppId+"&token="+e.token}})]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(i){e.dialogTaskVisible=!1}}},[e._v("\u5173 \u95ED")])],1)])],1)},g=[],s=l(234044),a=l(638913),o=l(723400),f=l(231954),d=l(321300),r=l(927966),p=l(148836),v={name:"task-end-style",props:["currentWidget"],mixins:[s.baseConfig,o.j,a.$],computed:{...(0,p.Se)(["editorAppId","viewAppId"])},data(){return{taskMode:[{value:"EndTaskComponent",label:"\u73AF\u8282\u5B8C\u6210"},{value:"handleEndTaskComponent",label:"\u529E\u7ED3\u529E\u4EF6"}],tableMode:[{value:"",label:"\u9ED8\u8BA4"},{value:"stripe",label:"\u6591\u9A6C\u7EBF"}],dialogTaskVisible:!1,domain:f.Z.baseConfig.domain,token:d.getStoreToken()}},methods:{clickedSearchSetting(){r.Z.$emit("clickedSearchSetting")},clickedButtonSetting(){r.Z.$emit("clickedButtonSetting")},clickedColumnSetting(){r.Z.$emit("clickedColumnSetting")}}},h=v,n=l(768141),u=(0,n.Z)(h,m,g,!1,null,"132af7d8",null),y=u.exports}}]);
