"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[10693],{56279:function(T,I,a){a.d(I,{P:function(){return f}});var b=a(386892),y=a(149500);const f={mixins:[b.D],created(){},methods:{lifecycleBeforeChartsLoad(C){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&y.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),y.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let L=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[C]);if(L)return L}return C},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&y.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),y.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(T,I,a){a.d(I,{X:function(){return b},b:function(){return y}});let b={versions:function(){var f=navigator.userAgent;return{trident:f.indexOf("Trident")>-1,presto:f.indexOf("Presto")>-1,webKit:f.indexOf("AppleWebKit")>-1,gecko:f.indexOf("Gecko")>-1&&f.indexOf("KHTML")==-1,mobile:!!f.match(/AppleWebKit.*Mobile.*/),ios:!!f.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:f.indexOf("Android")>-1,iPhone:f.indexOf("iPhone")>-1,iPad:f.indexOf("iPad")>-1,webApp:f.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},y;b.versions.mobile||b.versions.ios||b.versions.android||b.versions.iPhone||b.versions.iPad?y=!1:y=!0},610693:function(T,I,a){a.r(I),a.d(I,{default:function(){return k}});var b=function(){var h=this,u=h._self._c;return u("div",{style:{width:h.widgetInfo.attr.w+"px",height:h.widgetInfo.attr.hh+"px"}},[u("hide-button",{attrs:{attr:h.widgetInfo.attr}}),u("div",{ref:"pieDoughnut",style:{width:h.widgetInfo.attr.w+"px",height:h.widgetInfo.attr.hh+"px"}})],1)},y=[],f=a(844513),C=a(927966),A=a(56279),L=a(445061),E=a(126711),N=a(275770),w=a(843674),r=a(67157),v=a(150813);const F={mixins:[r.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(v.Z.charts.title)),legend:JSON.parse(JSON.stringify(v.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(v.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(v.Z.charts.toolbox))}}},methods:{filterPredefineColoursSchemeConfig(i,h){this.getNewConfigWithArrary(i,h,this.filter_config),this.getNewDoughnutConfigSeries(i.series,h.series)},getNewDoughnutConfigSeries(i,h){let u=0;for(let x in i){let O=i[x],S={};if(u>h.length-1&&(u=0),S=h[u],O.color&&O.color instanceof Array&&S.color&&S.color instanceof Array){let R=0;for(let J in O.color)R>S.color.length-1&&(R=0),O.color[J]=S.color[R],R++}u++}}}};var $=a(99349),M=a(787798),z=a(555616),D=a(954255),B=a(42160),H=a(149500),U={name:"PieDoughnutMulti",components:{HideButton:f.Z},mixins:[w.baseConfig,F,A.P,L.u,E.H,$.P,M.P],props:["widgetInfo"],setup(){const{proxy:i}=(0,B.getCurrentInstance)();let h=D,u=[],x=null;(0,B.watch)(()=>i.widgetInfo.attr.hide,(t,e)=>{i.$emit("attrChange",i.widgetInfo)}),(0,B.onMounted)(()=>{x=h.init(i.$refs.pieDoughnut,null,{devicePixelRatio:2}),Q(i.widgetInfo),O(i.widgetInfo)}),(0,B.onUnmounted)(()=>{if(h.dispose(),u.length>0){for(let t in u)clearInterval(u[t]);u=[]}});const O=t=>{let e=JSON.parse(JSON.stringify(t)),n=J(e),l=V(e),o=e.config.toolbox,p=i.getTooltip(e.config.tooltip),c=i.getLegend(t.config.legend),s={title:n,tooltip:p,toolbox:o,legend:c,series:l};i.getAnimation(s,t),S(s,t,l),i.setAnimationLoop(t,()=>{S(s,t)})},S=(t,e)=>{if(x.getOption()&&x.clear(),setTimeout(()=>{x.setOption(i.lifecycleBeforeChartsLoad(t),{notMerge:!0})},0),u.length>0){for(let l in u)clearInterval(u[l]);u=[]}let n=e.config.series;for(let l in n)if(n[l].auto==!0){let o=5;n[l].showTime&&(o=n[l].showTime),o=o*1e3;let p=0,c=t.series[l].data.length,s=setInterval(function(){x.dispatchAction({type:"downplay",seriesIndex:l,dataIndex:p}),p=(p+1)%c,x.dispatchAction({type:"highlight",seriesIndex:l,dataIndex:p})},o);u.push(s)}},R=t=>{t&&(i.$refs.pieDoughnut.style.width=t.attr.w+"px",i.$refs.pieDoughnut.style.height=t.attr.hh+"px"),O(t),x.resize()},J=t=>({show:t.config.title.show,text:t.config.title.text,subtext:t.config.title.subtext,link:t.config.title.link,textAlign:t.config.title.textAlign,left:t.config.title.left+"%",right:t.config.title.right+"%",top:t.config.title.top+"%",bottom:t.config.title.bottom+"%",label:{fontSize:t.config.title.label.fontSize,fontFamily:t.config.title.label.fontFamily,color:t.config.title.label.color},textStyle:{fontSize:t.config.title.textStyle.fontSize,fontFamily:t.config.title.textStyle.fontFamily,color:t.config.title.textStyle.color},subtextStyle:{fontSize:t.config.title.subtextStyle.fontSize,fontFamily:t.config.title.subtextStyle.fontFamily,color:t.config.title.subtextStyle.color}}),V=t=>{let e=JSON.parse(JSON.stringify(t.config.series));if(e)for(let n in e){let l=e[n].center[t.config.layout][0],o=e[n].center[t.config.layout][1],p=e[n].radius[t.config.layout][0],c=e[n].radius[t.config.layout][1];if(e[n].center=[l+"%",o+"%"],e[n].radius=[p,c],e[n].name=X(n,t),e[n].data=W(n,t),e[n].label.formatter=i.getFormatterString(e[n].label.formatter),e[n].label.show=G(e[n].label)&&e[n].label.show,e[n].label.emphasis.textStyle={},e[n].label.emphasis.textStyle.fontWeight="bold",e[n].color&&e[n].data)if(e[n].colorCustom==!1){e[n].color=[];for(let s in e[n].data)e[n].color.push(i.$$global_editor.predefineColors[s])}else{let s=e[n].data.length-e[n].color.length,d=[];if(s>0){d=JSON.parse(JSON.stringify(e[n].color));let g="rgba(0, 0, 0, 0)";for(let m=0;m<s;m++)d.push(g);e[n].color=JSON.parse(JSON.stringify(d))}else if(s<0){for(let g in e[n].data)d.push(e[n].color[g]);e[n].color=JSON.parse(JSON.stringify(d))}}if(e[n].itemStyle.borderRadius=Y(e[n].itemStyle),e[n].emphasis)try{let s=e[n].emphasis;if(s.script&&s.script.enabled){if(s.script.content){let d=new Function("index","item","data",s.script.content),g=e[n].data;if(g&&g.length>0)for(let m=0;m<g.length;++m)try{g[m].emphasis=d.call(this,m,g[m],g)}catch(tt){H.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",tt)}}}else e[n].emphasis.itemStyle&&e[n].emphasis.itemStyle.color&&(e[n].emphasis={itemStyle:{...e.emphasis.itemStyle}})}catch(s){H.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",s)}}else e=[];return e},X=(t,e)=>{let n="",l=e.dataset[e.dataset.type].encode,o=e.dataset[e.dataset.type].dimensionsAlias;if(l&&o)for(let p in o)l[t].value==o[p].name&&(n=o[p].alias?o[p].alias:o[p].name);return n},W=(t,e)=>{let n=[],l=e.dataset[e.dataset.type].encode,o=e.dataset[e.dataset.type].dimensionsAlias,p=-1,c=-1;if(l&&o)for(let d in o)l[t].name==o[d].name&&(p=d),l[t].value==o[d].name&&(c=d);let s=e.dataset[e.dataset.type].source;if(s)for(let d in s){let g={};for(let m in s[d])p==m&&(g.name=s[d][m]),c==m&&(g.value=s[d][m]);n.push(g)}return n},G=t=>t.position!=="center",Y=t=>{let e;return t.borderRadiusType=="one"?e=P(t.barBorderRadiusInfo[0],t.barBorderRadiusInfoUnit[0]):t.borderRadiusType=="tow"?e=[P(t.barBorderRadiusInfo[0],t.barBorderRadiusInfoUnit[0]),P(t.barBorderRadiusInfo[1],t.barBorderRadiusInfoUnit[1])]:t.borderRadiusType=="four"&&(e=[P(t.barBorderRadiusInfo[0],t.barBorderRadiusInfoUnit[0]),P(t.barBorderRadiusInfo[1],t.barBorderRadiusInfoUnit[1]),P(t.barBorderRadiusInfo[2],t.barBorderRadiusInfoUnit[2]),P(t.barBorderRadiusInfo[3],t.barBorderRadiusInfoUnit[3])]),e},P=(t,e)=>(!t||t==""?0:t)+(e=="%"?"%":""),Q=t=>{_(t),i.actionReceive(t)},_=t=>{x.on("click",e=>{e.componentType=="graphic"||e.componentType=="series"&&q(t,e)})},q=(t,e)=>{let n=[],l=t.action.sendOut.actionList;i.$$lib__.each(l,o=>{let p=o.code+"_"+t.id,c={};o.paramsExtend&&o.paramsExtend.length>0&&i.getParamsExtend(c,o.paramsExtend,t);let s=o.postMessage;if(c.name=e.data.name,c.value=e.data.value,o.enabled&&o.code==N.default.click.code){if(t.dataset[t.dataset.type].source&&t.dataset[t.dataset.type].source.length>0&&(n=t.dataset[t.dataset.type].source[e.dataIndex]),i.getExtendParams(c,o.paramsExtend,n,t.dataset[t.dataset.type].dimensions),o.script&&o.script.enabled){if(H.log("Execute script for "+t.name+" component to "+t.name+" component"),o.script.content==""){z.Message.warning({message:o.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}i.customScript_actionSend_clickParam=new Function("param,params",o.script.content),c=i.customScript_actionSend_clickParam(c,e)}C.Z.$emit(p,c),s&&i.doPostMessage(c)}else if(o.enabled&&o.code==N.default.openLink.code){if(o.paramsExtend&&o.paramsExtend.length>0){let d=[];t.dataset[t.dataset.type].source&&t.dataset[t.dataset.type].source.length>0&&(d=t.dataset[t.dataset.type].source[e.dataIndex]),o.type===i.$$global_editor.linkType.dynamic.code&&(o[i.$$global_editor.linkType.dynamic.code].url=i.getActionUrl(o,t.dataset[t.dataset.type].source[e.dataIndex],t.dataset[t.dataset.type].dimensions)),i.getExtendParams(c,o.paramsExtend,d,t.dataset[t.dataset.type].dimensions)}if(o.script&&o.script.enabled){if(H.log("Execute script for "+o.name+" component to "+t.name+" component"),o.script.content==""){z.Message.warning({message:o.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}i.customScript_actionSend_clickParam=new Function("param,params",o.script.content),c=i.customScript_actionSend_clickParam(c,e)}i.openLinkAction(o,c,e)}})};return{reLoadInfo:R,getAttribute:t=>i.getAttribute(t)}}},Z=U,j=a(768141),K=(0,j.Z)(Z,b,y,!1,null,"342b2d62",null),k=K.exports},844513:function(T,I,a){a.d(I,{Z:function(){return N}});var b=function(){var r=this,v=r._self._c;return r.attr.buttonHide?v("div",{style:{position:"absolute",right:r.attr.buttonHideRight+"px",top:r.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(F){return r.onHide()}}},[r.openTooltip?v("el-tooltip",{attrs:{"open-delay":1e3,content:r.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[v("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):v("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r._e()},y=[],f=a(752246),C={props:["attr"],name:"hide-button",data(){return{isPc:f.b}},computed:{openTooltip:function(){let w=!1,r=this.attr.buttonHideTooltipContent;return f.b&&r&&r!=null&&r.trim()!=""&&(w=!0),w}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},A=C,L=a(768141),E=(0,L.Z)(A,b,y,!1,null,"bf399b9a",null),N=E.exports}}]);
