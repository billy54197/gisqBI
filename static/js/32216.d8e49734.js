(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[32216],{419457:function(M,E,n){"use strict";var R=n(419534);Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var a=R(n(452909)),u=R(n(342579)),t=void 0,s={props:{isShow:{type:Boolean,default:!0},position:{type:Object,default:function(){return(0,u.default)(this,t),{type:"absolute",top:"1px",left:"1px"}}.bind(void 0)},isColumn:{type:Boolean,default:!1},title:{type:String},iconClass:{type:String},dragEnable:{type:Boolean,default:!1},showImg:{type:Boolean,default:!0},showLabel:{type:Boolean,default:!0},themeStyle:{type:Object}},data:function(){return{theme:"light"}},watch:{currentView:{handler:function(l){l==="earth"?this.theme="dark":this.theme="light"},immediate:!0}},mounted:function(){var l,y=this;this.$_mixin_generalButton=(0,a.default)(l=this.$children).call(l,function(p){return(0,u.default)(this,y),p.$options.name==="ShGeneralButton"}.bind(this))},methods:{getPosition:function(){var l;return(l=this.$_mixin_generalButton)===null||l===void 0?void 0:l.getPosition()}}},i=s;E.default=i},132726:function(M,E,n){"use strict";var R=n(149500),a=n(985208),u=n(659791),t=n(22466),s=n(183393),i=n(105077),h=n(419534);Object.defineProperty(E,"__esModule",{value:!0}),E.default=L;var l=h(n(611323)),y=h(n(543389)),p=h(n(934749)),m=h(n(342579)),v=h(n(985208)),w=h(n(828866)),f=h(n(22466)),T=h(n(581806)),F=h(n(705146));function N(U,P){var x=a(U);if(u){var I=u(U);P&&(I=t(I).call(I,function(K){return s(U,K).enumerable})),x.push.apply(x,I)}return x}function b(U){for(var P=1;P<arguments.length;P++){var x=arguments[P]!=null?arguments[P]:{};P%2?N(Object(x),!0).forEach(function(I){(0,y.default)(U,I,x[I])}):i?Object.defineProperties(U,i(x)):N(Object(x)).forEach(function(I){Object.defineProperty(U,I,s(x,I))})}return U}function X(U,P){for(var x=!1,I=U,K=function(){var r=this;I=I.$parent;var e=I.$refs;e&&(0,v.default)(e).forEach(function(o){(0,m.default)(this,r),e[o]===U&&(e[o]=P,x=!0)}.bind(this))};I.$parent&&!x;)K()}function L(U){var P,x,I=this,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},it=K.configName,r=K.componentName,e=K.transform,o=(0,w.default)(P=(0,f.default)(x=U.mixins||[]).call(x,function(d){return(0,m.default)(this,I),!!d.props}.bind(this))).call(P,function(d){return(0,m.default)(this,I),{props:d.props}}.bind(this));return{name:r||U.name,props:U.props,mixins:o,inject:{reactiveConfigInstance:{default:function(){var c=this;return function(){return(0,m.default)(this,c),null}.bind(this)}}},data:function(){return this.$configInfo={},{ready:!1}},computed:{configInstance:function(){return this.reactiveConfigInstance()}},mounted:function(){this.initConfig()},methods:{initConfig:function(){var c=this;return(0,p.default)(l.default.mark(function g(){var O,$;return l.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!c.configInstance){j.next=17;break}return O=c.$options.name.replace("Sh",""),$={},j.prev=3,j.next=6,c.configInstance.getWidgetInfoByTag(it||O);case 6:$=j.sent,j.next=13;break;case 9:return j.prev=9,j.t0=j.catch(3),R.error(j.t0),j.abrupt("return");case 13:if($.stat){j.next=15;break}return j.abrupt("return");case 15:typeof e=="function"&&$.data?$=e($.data,c.configInstance.widgetInfo.mapConfig,{url:c.configInstance.url.replace("/role/getResources",""),schemeId:c.configInstance.schemeId}):$=$.data,c.$configInfo=b({},$);case 17:c.ready=!0;case 18:case"end":return j.stop()}},g,null,[[3,9]])}))()},forwordRef:function(){var c;X(this._self,this._self.$children[0]),(c=this._self.$children[0])===null||c===void 0||c.$emit("mounted",this._self.$children[0])}},render:function(c){var g,O=this,$;if((0,T.default)(g=(0,v.default)(this.$listeners)).call(g,"hook:mounted")){var A;$=b(b({},this.$listeners),{},{"hook:mounted":(0,F.default)(A=[this.forwordRef]).call(A,this.$listeners["hook:mounted"])})}else $=b(b({},this.$listeners),{},{"hook:mounted":this.forwordRef});var j=this.$options.propsData;return(0,v.default)(j).forEach(function(Q){(0,m.default)(this,O),j[Q]===void 0&&delete j[Q]}.bind(this)),this.ready?c(U,{on:$,scopedSlots:this.$scopedSlots,props:b(b({},this.$configInfo),j),attrs:this.$attrs},this.$slots.default):null}}}},75805:function(M,E,n){var R=n(149500);M.exports=function(a){var u={};function t(s){if(u[s])return u[s].exports;var i=u[s]={i:s,l:!1,exports:{}};return a[s].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=a,t.c=u,t.d=function(s,i,h){t.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:h})},t.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},t.t=function(s,i){if(i&1&&(s=t(s)),i&8||i&4&&typeof s=="object"&&s&&s.__esModule)return s;var h=Object.create(null);if(t.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:s}),i&2&&typeof s!="string")for(var l in s)t.d(h,l,function(y){return s[y]}.bind(null,l));return h},t.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(i,"a",i),i},t.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},t.p="/dist/",t(t.s=775)}({0:function(a,u){a.exports=n(342579)},1:function(a,u){a.exports=n(828866)},10:function(a,u){a.exports=n(42762)},105:function(a,u){a.exports=n(614843)},124:function(a,u){a.exports=n(10257)},15:function(a,u){a.exports=n(202692)},2:function(a,u,t){"use strict";t.d(u,"a",function(){return s});function s(i,h,l,y,p,m,v,w){var f=typeof i=="function"?i.options:i;h&&(f.render=h,f.staticRenderFns=l,f._compiled=!0),y&&(f.functional=!0),m&&(f._scopeId="data-v-"+m);var T;if(v?(T=function(b){b=b||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!b&&typeof __VUE_SSR_CONTEXT__<"u"&&(b=__VUE_SSR_CONTEXT__),p&&p.call(this,b),b&&b._registeredComponents&&b._registeredComponents.add(v)},f._ssrRegister=T):p&&(T=w?function(){p.call(this,(f.functional?this.parent:this).$root.$options.shadowRoot)}:p),T)if(f.functional){f._injectStyles=T;var F=f.render;f.render=function(X,L){return T.call(L),F(X,L)}}else{var N=f.beforeCreate;f.beforeCreate=N?[].concat(N,T):[T]}return{exports:i,options:f}}},28:function(a,u){a.exports=n(132726)},36:function(a,u){a.exports=n(59269)},4:function(a,u){a.exports=n(555616)},432:function(a,u,t){var s=t(718);typeof s=="string"&&(s=[[a.i,s,""]]);var i,h,l={hmr:!0};l.transform=i,l.insertInto=void 0;var y=t(77)(s,l);s.locals&&(a.exports=s.locals)},47:function(a,u){a.exports=n(110563)},48:function(a,u){a.exports=n(181360)},53:function(a,u){a.exports=n(29870)},58:function(a,u){a.exports=n(165594)},6:function(a,u){a.exports=n(783574)},60:function(a,u){a.exports=n(308421)},61:function(a,u){a.exports=n(419457)},67:function(a,u){a.exports=n(31694)},717:function(a,u,t){"use strict";var s=t(432),i=t.n(s)},718:function(a,u,t){u=a.exports=t(76)(!1),u.push([a.i,".save[data-v-3dc9a204]{border:0;color:#999;cursor:pointer;font-size:14px;line-height:23px;transition:all .3s ease-out;width:48px;background:#d3d3d3}",""])},75:function(a,u){a.exports=n(641739)},76:function(a,u,t){"use strict";a.exports=function(h){var l=[];return l.toString=function(){return this.map(function(p){var m=s(p,h);return p[2]?"@media "+p[2]+"{"+m+"}":m}).join("")},l.i=function(y,p){typeof y=="string"&&(y=[[null,y,""]]);for(var m={},v=0;v<this.length;v++){var w=this[v][0];w!=null&&(m[w]=!0)}for(v=0;v<y.length;v++){var f=y[v];(f[0]==null||!m[f[0]])&&(p&&!f[2]?f[2]=p:p&&(f[2]="("+f[2]+") and ("+p+")"),l.push(f))}},l};function s(h,l){var y=h[1]||"",p=h[3];if(!p)return y;if(l&&typeof btoa=="function"){var m=i(p),v=p.sources.map(function(w){return"/*# sourceURL="+p.sourceRoot+w+" */"});return[y].concat(v).concat([m]).join(`
`)}return[y].join(`
`)}function i(h){var l=btoa(unescape(encodeURIComponent(JSON.stringify(h)))),y="sourceMappingURL=data:application/json;charset=utf-8;base64,"+l;return"/*# "+y+" */"}},77:function(a,u,t){var s={},i=function(r){var e;return function(){return typeof e>"u"&&(e=r.apply(this,arguments)),e}},h=i(function(){return window&&document&&document.all&&!window.atob}),l=function(r,e){return e?e.querySelector(r):document.querySelector(r)},y=function(r){var e={};return function(o,d){if(typeof o=="function")return o();if(typeof e[o]>"u"){var c=l.call(this,o,d);if(window.HTMLIFrameElement&&c instanceof window.HTMLIFrameElement)try{c=c.contentDocument.head}catch{c=null}e[o]=c}return e[o]}}(),p=null,m=0,v=[],w=t(91);a.exports=function(r,e){if(typeof DEBUG<"u"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},e.attrs=typeof e.attrs=="object"?e.attrs:{},!e.singleton&&typeof e.singleton!="boolean"&&(e.singleton=h()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var o=T(r,e);return f(o,e),function(c){for(var g=[],O=0;O<o.length;O++){var $=o[O],A=s[$.id];A.refs--,g.push(A)}if(c){var j=T(c,e);f(j,e)}for(var O=0;O<g.length;O++){var A=g[O];if(A.refs===0){for(var Q=0;Q<A.parts.length;Q++)A.parts[Q]();delete s[A.id]}}}};function f(r,e){for(var o=0;o<r.length;o++){var d=r[o],c=s[d.id];if(c){c.refs++;for(var g=0;g<c.parts.length;g++)c.parts[g](d.parts[g]);for(;g<d.parts.length;g++)c.parts.push(P(d.parts[g],e))}else{for(var O=[],g=0;g<d.parts.length;g++)O.push(P(d.parts[g],e));s[d.id]={id:d.id,refs:1,parts:O}}}}function T(r,e){for(var o=[],d={},c=0;c<r.length;c++){var g=r[c],O=e.base?g[0]+e.base:g[0],$=g[1],A=g[2],j=g[3],Q={css:$,media:A,sourceMap:j};d[O]?d[O].parts.push(Q):o.push(d[O]={id:O,parts:[Q]})}return o}function F(r,e){var o=y(r.insertInto);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var d=v[v.length-1];if(r.insertAt==="top")d?d.nextSibling?o.insertBefore(e,d.nextSibling):o.appendChild(e):o.insertBefore(e,o.firstChild),v.push(e);else if(r.insertAt==="bottom")o.appendChild(e);else if(typeof r.insertAt=="object"&&r.insertAt.before){var c=y(r.insertAt.before,o);o.insertBefore(e,c)}else throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`)}function N(r){if(r.parentNode===null)return!1;r.parentNode.removeChild(r);var e=v.indexOf(r);e>=0&&v.splice(e,1)}function b(r){var e=document.createElement("style");if(r.attrs.type===void 0&&(r.attrs.type="text/css"),r.attrs.nonce===void 0){var o=U();o&&(r.attrs.nonce=o)}return L(e,r.attrs),F(r,e),e}function X(r){var e=document.createElement("link");return r.attrs.type===void 0&&(r.attrs.type="text/css"),r.attrs.rel="stylesheet",L(e,r.attrs),F(r,e),e}function L(r,e){Object.keys(e).forEach(function(o){r.setAttribute(o,e[o])})}function U(){return t.nc}function P(r,e){var o,d,c,g;if(e.transform&&r.css)if(g=typeof e.transform=="function"?e.transform(r.css):e.transform.default(r.css),g)r.css=g;else return function(){};if(e.singleton){var O=m++;o=p||(p=b(e)),d=I.bind(null,o,O,!1),c=I.bind(null,o,O,!0)}else r.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(o=X(e),d=it.bind(null,o,e),c=function(){N(o),o.href&&URL.revokeObjectURL(o.href)}):(o=b(e),d=K.bind(null,o),c=function(){N(o)});return d(r),function(A){if(A){if(A.css===r.css&&A.media===r.media&&A.sourceMap===r.sourceMap)return;d(r=A)}else c()}}var x=function(){var r=[];return function(e,o){return r[e]=o,r.filter(Boolean).join(`
`)}}();function I(r,e,o,d){var c=o?"":d.css;if(r.styleSheet)r.styleSheet.cssText=x(e,c);else{var g=document.createTextNode(c),O=r.childNodes;O[e]&&r.removeChild(O[e]),O.length?r.insertBefore(g,O[e]):r.appendChild(g)}}function K(r,e){var o=e.css,d=e.media;if(d&&r.setAttribute("media",d),r.styleSheet)r.styleSheet.cssText=o;else{for(;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(o))}}function it(r,e,o){var d=o.css,c=o.sourceMap,g=e.convertToAbsoluteUrls===void 0&&c;(e.convertToAbsoluteUrls||g)&&(d=w(d)),c&&(d+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(c))))+" */");var O=new Blob([d],{type:"text/css"}),$=r.href;r.href=URL.createObjectURL(O),$&&URL.revokeObjectURL($)}},775:function(a,u,t){"use strict";t.r(u);var s=t(0),i=t.n(s),h=function(){var C=this,W=C.$createElement,S=C._self._c||W;return S("div",{directives:[{name:"show",rawName:"v-show",value:C.shouldShow,expression:"shouldShow"}],staticClass:"sh-save-tool"},[S("div",{directives:[{name:"show",rawName:"v-show",value:C.isShow,expression:"isShow"}]},[C.$slots.default?S("span",{on:{click:C.execute}},[C._t("default")],2):S("general-button",{attrs:{position:C.position,"is-column":C.isColumn,"icon-class":C.iconClass?C.iconClass:"save-tool","show-img":C.showImg,"drag-enable":C.dragEnable,"show-label":C.showLabel,"theme-style":C.themeStyle,title:C.title?C.title:"\u4FDD\u5B58"},on:{click:C.execute}})],1)])},l=[];h._withStripped=!0;var y=t(53),p=t.n(y),m=t(9),v=t.n(m),w=t(10),f=t.n(w),T=t(1),F=t.n(T),N=t(8),b=t.n(N),X=t(48),L=t.n(X),U=t(67),P=t.n(U),x=t(4),I=t(15),K=t.n(I),it=t(75),r=t.n(it),e=t(124),o=t.n(e),d=t(47),c=t(58),g=t.n(c),O=t(105),$=t(36),A=function(){function C(W,S,D,z){v()(this,C),this.name="graphicSave",this.map=W,this.options=z,this.baseUrl=S&&S!==""?S:"http://192.168.11.77:8084/zjzs/ga/",this.shinegaDatabaseId=D,this.adminUrl=z.adminUrl,this.layerManager=F()(this).layerManager}return f()(C,[{key:"init",value:function(){if(this.currentTargetLayer=this.layerManager.getEditLayer()?this.layerManager.getEditLayer().metadata:void 0,this.selectFeatures=F()(this).getSelectFeatures(),this.currentTargetLayer===void 0){Object(x.Message)({message:"\u76EE\u6807\u56FE\u5C42\u672A\u9009\u4E2D",type:"warning",showClose:!0});return}if(this.selectFeatures.length===0){Object(x.Message)({message:"\u8BF7\u9009\u4E2D\u8981\u4FDD\u5B58\u7684\u5730\u5757",type:"warning",showClose:!0});return}if(!this.currentTargetLayer.layerTable){Object(x.Message)({message:"\u56FE\u5C42\u672A\u914D\u7F6E\u6570\u636E\u6E90\uFF0C\u8BF7\u68C0\u67E5",type:"warning",showClose:!0});return}this.postCondition()}},{key:"postCondition",value:function(){var S,D,z=this,H,V,st,B=this,k=this.selectFeatures;this.mapOptions=(S=this.options)===null||S===void 0?void 0:S.shinegaInitData;var q=b()(D=K()(k)).call(D,function(G,Y){return i()(this,z),Y.layerTag&&Y.layerTag!==B.currentTargetLayer.layerTag}.bind(this));if(q.length>0){Object(x.Message)({message:"\u64CD\u4F5C\u975E\u6CD5\uFF0C\u9009\u62E9\u5730\u5757\u4E2D\u5305\u542B\u975E\u3010"+B.currentTargetLayer.label+"\u3011\u56FE\u5C42\u7684\u5730\u5757\uFF01",type:"warning",showClose:!0});return}var ot=this.currentTargetLayer.layerTag?this.currentTargetLayer.layerTag:"";if(this.mapOptions&&this.mapOptions.xm&&L()(H=this.mapOptions.xm).call(H).length>0&&this.mapOptions.xm.toUpperCase()!==ot.toUpperCase()){Object(x.Message)({message:"\u64CD\u4F5C\u975E\u6CD5\uFF0C\u9650\u5B9A\u56FE\u5C42\u6807\u8BC6\u3010"+B.mapOptions.xm+"\u3011",type:"warning",showClose:!0});return}if(this.mapOptions&&this.mapOptions.editProjectGuid&&L()(V=this.mapOptions.editProjectGuid).call(V).length>0){var _,rt=b()(_=K()(k)).call(_,function(G,Y){i()(this,z);for(var J in Y.values_)if(J.toUpperCase()==="XM_GUID"){var at;return Y.values_[J]&&L()(at=Y.values_[J]).call(at).length>0&&Y.values_[J]!==B.mapOptions.editProjectGuid}}.bind(this));if(rt.length>0){Object(x.Message)({message:"\u64CD\u4F5C\u975E\u6CD5\uFF0C\u9009\u62E9\u7684\u5730\u5757\u4E2D\u5305\u542B\u975E\u672C\u9879\u76EE\u7684\u5730\u5757\uFF01",type:"warning",showClose:!0});return}}if(this.mapOptions&&this.mapOptions.editBlockGuid&&L()(st=this.mapOptions.editBlockGuid).call(st).length>0)if(this.selectFeatures.length>1){Object(x.Message)({message:"\u64CD\u4F5C\u975E\u6CD5\uFF0C\u53EA\u80FD\u4FDD\u5B58\u6307\u5B9A\u7684\u5730\u5757\uFF01",type:"warning",showClose:!0});return}else for(var tt in this.selectFeatures[0].values_){var Z=this.selectFeatures[0].values_[tt],et=tt;if(et.toUpperCase()==="DK_GUID"&&Z&&L()(Z).call(Z)!==""&&Z!==this.mapOptions.editBlockGuid){Object(x.Message)({message:"\u64CD\u4F5C\u975E\u6CD5\uFF0C\u53EA\u80FD\u4FDD\u5B58\u6307\u5B9A\u7684\u5730\u5757\uFF01",type:"warning",showClose:!0});return}}new g.a(this.baseUrl,this.shinegaDatabaseId).getPrimaryKey({layerTable:this.currentTargetLayer.layerTable,token:this.options.token}).then(function(G){var Y=this;i()(this,z),G.success?(this.primaryKey=G.data.key,this.primaryType=G.data.type,Object(O.getSaveRuleOptions)({url:this.adminUrl,tocId:this.currentTargetLayer.id,token:this.options.token,applicationId:this.options.applicationId,schemeId:this.options.schemeId,publishId:this.options.publishId,hasRules:this.currentTargetLayer.hasRules}).then(function(J){i()(this,Y),this.ruleOptions=J,this.processDataNew()}.bind(this))):Object(x.Message)({message:G.message?G.message:"\u5730\u5757\u4FDD\u5B58\u5931\u8D25",type:"warning",showClose:!0})}.bind(this)).catch(function(G){i()(this,z),R.error(G)}.bind(this))}},{key:"processDataNew",value:function(){var S=this,D=[],z=this.selectFeatures,H=[],V=[];if(this.mapOptions&&this.mapOptions.keyfield&&this.mapOptions.keyvalue&&(H=this.mapOptions.keyfield.split(","),V=this.mapOptions.keyvalue.split(",")),K.a.each(z,function(B,k){if(i()(this,S),k.get("tempSelected")&&H&&H.length>0&&V&&V.length>0&&H.length===V.length)for(var q=0;q<H.length;q++)k.set(H[q].toUpperCase(),V[q])}.bind(this)),this.options&&this.options.isShowEdit)r.a.$emit("startFeatureEditing",{type:"add",features:new o.a(z)});else{var st=x.Loading.service({target:F()(this).getTargetElement(),lock:!0,text:"\u4FDD\u5B58\u4E2D...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.1)"});D=this.processData(z),new g.a(this.baseUrl,this.shinegaDatabaseId).save({features:D,options:this.options.saveOptions,ruleOptions:this.ruleOptions,token:this.options.token}).then(function(B){if(i()(this,S),st.close(),B.success){var k=F()(this).getLayerById($.BASE_DRAWLAYER_ID);k.getSource().clear();var q=this.currentTargetLayer.id,ot=F()(this).getLayerById(q);ot.getSource().refresh(),F()(this).refresh(),Object(x.Message)({message:"\u5730\u5757\u4FDD\u5B58\u6210\u529F",type:"success",showClose:!0});var _=B.data.oids;if(_&&_ instanceof Array&&_.length>0)for(var rt=0;rt<D.length;rt++){var tt,Z={name:(tt=this.primaryKey)===null||tt===void 0?void 0:tt.toLowerCase(),value:_[rt]};D[rt].attribute.push(Z)}this.callback&&this.callback(D)}else Object(x.Message)({message:B.message?B.message:"\u5730\u5757\u4FDD\u5B58\u5931\u8D25",type:"warning",dangerouslyUseHTMLString:!0,showClose:!0})}.bind(this)).catch(function(B){i()(this,S),Object(x.Message)({message:"\u5730\u5757\u4FDD\u5B58\u5931\u8D25",type:"warning",showClose:!0}),st.close(),R.error(B)}.bind(this))}}},{key:"processData",value:function(S){var D=this,z=[],H=new P.a,V=1;return K.a.each(S,function(st,B){var k,q,ot=this,_,rt,tt;i()(this,D);var Z=this,et={},G=[],Y="",J=B.values_[(k=Z.primaryKey)===null||k===void 0?void 0:k.toLowerCase()];if(J){var at;Z.primaryType==="bigint"||Z.primaryType==="smallint"||Z.primaryType==="integer"||typeof J=="number"?at=J:(at=J.substring(J.lastIndexOf(".")+1,J.length),at="'"+at+"'"),Y=Z.primaryKey+" in ("+at+")"}var jt=function(nt){var Lt=this;if(p()(B.values_[nt])!=="object"){var dt,Pt=b()(dt=K()(G)).call(dt,function(Ft,At){return i()(this,Lt),At.name===nt.toUpperCase()}.bind(this));if(Pt.length===0){var lt=B.values_[nt];typeof lt=="string"&&Object(d.strDateTime)(lt)&&(lt=""+lt.substr(0,lt.length-1)),G.push({name:nt.toUpperCase(),value:lt})}}};for(var Rt in B.values_)jt(Rt);var Ut=b()(q=K()(G)).call(q,function(ft,nt){return i()(this,ot),nt.name==="DK_GUID"}.bind(this));Ut.length===0&&G.push({name:"DK_GUID",value:this.newGuid()});var Dt=b()(_=K()(G)).call(_,function(ft,nt){return i()(this,ot),nt.name==="XM_GUID"}.bind(this));Dt.length===0&&G.push({name:"XM_GUID",value:this.newGuid()});var ct=b()(rt=K()(G)).call(rt,function(ft,nt){return i()(this,ot),nt.name==="DK_MC"}.bind(this));ct.length===0?(G.push({name:"DK_MC",value:"\u65B0\u5730\u5757"+V}),V++):((tt=ct[0].value)===null||tt===void 0?void 0:tt.indexOf("\u65B0\u5730\u5757"))>-1&&V++;var Mt=H.writeGeometry(B.getGeometry()),$t=F()(this).getView().getProjection(),Et=$t.code_.split(":")[1];et.featureClass=this.currentTargetLayer.layerTable,et.topological=!0,et.checkLevel=this.currentTargetLayer.topologyCheck,et.geometry=Mt,et.attribute=G,et.spatialReference=Et,et.filter=Y,z.push(et)}.bind(this)),z}},{key:"setActive",value:function(S){S&&this.init()}},{key:"setCallback",value:function(S){this.callback=S}},{key:"newGuid",value:function(){for(var S="",D=1;D<=32;D++){var z=Math.floor(Math.random()*16).toString(16);S+=z,(D===8||D===12||D===16||D===20)&&(S+="-")}return S}}]),C}(),j=A,Q=t(6),ht=t.n(Q),pt=t(60),vt=t.n(pt),gt=t(61),mt=t.n(gt),yt=void 0,xt={name:"ShSaveTool",components:{GeneralButton:vt.a},mixins:[ht.a,mt.a],props:{map:Object,url:String,adminUrl:String,schemeId:String,saveOptions:Object,isShowEdit:{type:Boolean,default:!1},position:{type:Object,default:function(){return i()(this,yt),{type:"absolute",top:"1px",left:"210px"}}.bind(void 0)}},data:function(){return{shouldShow:!1}},watch:{currentView:{handler:function(W){this.shouldShow=W==="map"},immediate:!0}},mounted:function(){},methods:{execute:function(){this.initSave()},initSave:function(){var W=this,S=new j(this.$map,this.url?this.url:this.shinegaUrl,this.shinegaDatabaseId,{adminUrl:this.adminUrl,token:this.token,applicationId:this.fastApplicationId,schemeId:this.schemeId,publishId:this.publishId,isShowEdit:this.isShowEdit,saveOptions:this.saveOptions,shinegaInitData:this.shinegaInitData});S.setCallback(function(D){i()(this,W),this.$emit("saveSuccess",D)}.bind(this)),S.init()}}},bt=xt,Bt=t(717),It=t(2),Ot=Object(It.a)(bt,h,l,!1,null,"3dc9a204",null),Ct=Ot.exports,St=t(28),wt=t.n(St),Tt=void 0,ut=wt()(Ct,{transform:function(W,S,D){i()(this,Tt);var z=W.show,H=W.label,V=W.position,st=D.url,B=D.schemeId;return{isShow:z,title:H,position:V,adminUrl:st,schemeId:B}}.bind(void 0)});ut.install=function(C){C.component(ut.name,ut)};var Gt=u.default=ut},8:function(a,u){a.exports=n(22466)},9:function(a,u){a.exports=n(122777)},91:function(a,u){a.exports=function(t){var s=typeof window<"u"&&window.location;if(!s)throw new Error("fixUrls requires window.location");if(!t||typeof t!="string")return t;var i=s.protocol+"//"+s.host,h=i+s.pathname.replace(/\/[^\/]*$/,"/"),l=t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(y,p){var m=p.trim().replace(/^"(.*)"$/,function(w,f){return f}).replace(/^'(.*)'$/,function(w,f){return f});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(m))return y;var v;return m.indexOf("//")===0?v=m:m.indexOf("/")===0?v=i+m:v=h+m.replace(/^\.\//,""),"url("+JSON.stringify(v)+")"});return l}}})},614843:function(M,E,n){"use strict";var R=n(419534);Object.defineProperty(E,"__esModule",{value:!0}),E.getDeleteRuleOptions=h,E.getSaveRuleOptions=i;var a=R(n(342579)),u=R(n(578756)),t=R(n(66273)),s=n(159602);function i(l){var y=this,p=l.url,m=l.schemeId,v=l.publishId,w=l.tocId,f=l.token,T=l.applicationId,F=l.hasRules;return new u.default(function(N){var b=this;(0,a.default)(this,y);var X;if(F&&p){var L=p.split("/"),U=L[0]+"//"+L[2]+"/"+L[3],P=m||v?"/subschemePublish/getPublishTocRule":"/tocRule/getInfo";(0,s.postFromAdmin)(U+P,{tocId:w,schemeId:m,id:v},{token:f,applicationId:T}).then(function(x){(0,a.default)(this,b);var I=(0,s.parseResult)(x);I.success&&I.data&&I.data.saveRule&&(X=(0,t.default)(I.data.saveRule)),N(X)}.bind(this)).catch(function(){(0,a.default)(this,b),N()}.bind(this))}else N()}.bind(this))}function h(l){var y=this,p=l.url,m=l.schemeId,v=l.publishId,w=l.tocId,f=l.token,T=l.applicationId,F=l.hasRules;return new u.default(function(N){var b=this;(0,a.default)(this,y);var X;if(F&&p){var L=p.split("/"),U=L[0]+"//"+L[2]+"/"+L[3],P=m||v?"/subschemePublish/getPublishTocRule":"/tocRule/getInfo";(0,s.postFromAdmin)(U+P,{tocId:w,schemeId:m,id:v},{token:f,applicationId:T}).then(function(x){(0,a.default)(this,b);var I=(0,s.parseResult)(x);I.success&&I.data&&I.data.delRule&&(X=(0,t.default)(I.data.delRule)),N(X)}.bind(this)).catch(function(){(0,a.default)(this,b),N()}.bind(this))}else N()}.bind(this))}},532216:function(M,E,n){"use strict";n.r(E),n.d(E,{default:function(){return v}});var R=function(){var f=this,T=f._self._c;return T("div",{directives:[{name:"show",rawName:"v-show",value:f.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:f.widgetInfo.attr.w+"px",height:f.widgetInfo.attr.hh+"px"}},[T("save-tool",f._b({style:{width:f.widgetInfo.attr.w+"px",height:f.widgetInfo.attr.hh+"px"},attrs:{"widget-info":f.widgetInfo,position:f.btnPosition,"theme-style":f.themeConfig}},"save-tool",f.widgetInfo.config.btnConfig,!1))],1)},a=[],u=n(75805),t=n.n(u),s=n(386892),i=n(445061),h=n(950681),l={name:"GisSave",components:{SaveTool:t()},mixins:[s.D,i.u,h.Z],props:["widgetInfo"],data(){return{map:null,width:"16px",height:"16px",fontSize:"12px;"}},mounted(){this.initAction(this.widgetInfo)},methods:{reLoadInfo(w){this.btnAttr=w.attr},initAction(w){this.actionReceive(w)}}},y=l,p=n(768141),m=(0,p.Z)(y,R,a,!1,null,"dedd9b12",null),v=m.exports},105077:function(M,E,n){M.exports=n(272873)},659791:function(M,E,n){M.exports=n(169127)},543389:function(M,E,n){var R=n(857448),a=n(168871);function u(t,s,i){return s=a(s),s in t?R(t,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[s]=i,t}M.exports=u,M.exports.__esModule=!0,M.exports.default=M.exports},259631:function(M,E,n){"use strict";n(125902);var R=n(594388);M.exports=R.Object.getOwnPropertyDescriptors},481640:function(M,E,n){"use strict";n(46932);var R=n(594388);M.exports=R.Object.getOwnPropertySymbols},125902:function(M,E,n){"use strict";var R=n(190434),a=n(714451),u=n(883419),t=n(204036),s=n(168428),i=n(259063);R({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(l){for(var y=t(l),p=s.f,m=u(y),v={},w=0,f,T;m.length>w;)T=p(y,f=m[w++]),T!==void 0&&i(v,f,T);return v}})},272873:function(M,E,n){"use strict";var R=n(259631);M.exports=R},169127:function(M,E,n){"use strict";var R=n(481640);M.exports=R}}]);
