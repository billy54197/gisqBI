"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[5630],{56279:function($,u,a){a.d(u,{P:function(){return v}});var b=a(86892),f=a(49500);const v={mixins:[b.D],created(){},methods:{lifecycleBeforeChartsLoad(x){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&f.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let I=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[x]);if(I)return I}return x},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&f.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),f.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},75630:function($,u,a){a.r(u),a.d(u,{default:function(){return V}});var b=function(){var n=this,s=n._self._c;return s("div",{style:{width:n.widgetInfo.attr.w+"px",height:n.widgetInfo.attr.hh+"px"}},[s("hide-button",{attrs:{attr:n.widgetInfo.attr}}),s("div",{ref:"scatterCartesian",style:{width:n.widgetInfo.attr.w+"px",height:n.widgetInfo.attr.hh+"px"}})],1)},f=[],v=a(44513),x=a(27966),E=a(78323),I=a(23400),z=a(56279),J=a(45061),M=a(26711),F=a(99349),Z=a(55616),P=a(75770),R=a(67157),g=a(50666);const T={mixins:[R.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(g.Z.charts.title)),legend:JSON.parse(JSON.stringify(g.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(g.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(g.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(g.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(g.Z.charts.yAxis)),series:[{label:{color:"#4B7EFE"},markLine:{lineStyle:{color:"#5FB2FF"}},itemStyle:{colorInfo:{type:"pureColor",pureColor:"rgba(76, 132, 255, 0.2)",gradation:{}},opacity:1,borderColor:"rgba(76, 132, 255, 0.5)"}}]}}},methods:{filterPredefineColoursSchemeConfig(i,n){this.getNewConfigWithArrary(i,n,this.filter_config)}}};var C=a(49500);const D=a(29426);var B={name:"ScatterCartesian",components:{HideButton:v.Z},mixins:[E.u,F.P,I.j,z.P,J.u,M.H,T],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null,seriesAttr:{x:"",y:[],label:[],size:[]}}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=D.init(this.$refs.scatterCartesian,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(i){let n=[],s=[],o=[],l=[];i.dataset[i.dataset.type]&&(s=i.dataset[i.dataset.type].source,o=i.dataset[i.dataset.type].dimensions,l=i.dataset[i.dataset.type].dimensionsAlias,n=i.dataset[i.dataset.type].encode);let e=JSON.parse(JSON.stringify(i.config.series));this.dimensionsEx=o,this.dimensionsAliasEx=l,this.seriesAttr.x=n.x;let h=this.getTitle(i.config.title),c=this.getLegend(i.config.legend),r=this.getGrid(i.config.grid),G=this.getTooltip(i.config.tooltip),K=JSON.parse(JSON.stringify(i.config.toolbox)),y=this.getxAxis(i.config.xAxis),p=this.getyAxis(i.config.yAxis);y.axisTick.lineStyle.color=this.getColorInfo(y.axisTick.lineStyle.colorInfo),p.axisTick.lineStyle.color=this.getColorInfo(p.axisTick.lineStyle.colorInfo),y.axisLine.lineStyle.color=this.getColorInfo(y.axisLine.lineStyle.colorInfo),p.axisLine.lineStyle.color=this.getColorInfo(p.axisLine.lineStyle.colorInfo);for(let t=0;t<e.length;t++){if(this.seriesAttr.y.push(e[t].encodeEx.y),this.seriesAttr.label.push(e[t].encodeEx.name),this.seriesAttr.size.push(e[t].encodeEx.value),e[t].dimensions=o,e[t].encode={x:n.x,y:e[t].encodeEx.y},e[t].symbolURL&&e[t].symbolURL!=""&&(e[t].symbol=this.getSymbolURL(e[t].symbolURL)),e[t].itemStyle&&e[t].itemStyle.colorInfo&&(e[t].itemStyle.color=this.getColorInfo(e[t].itemStyle.colorInfo)),e[t].encodeEx.value&&e[t].encodeEx.value!=""){let m=[],A=0,L=0;e[t].isShowMax&&e[t].isShowMin?(e[t].max=60,e[t].min=20):!e[t].isShowMax&&e[t].isShowMin?(e[t].min=20,Number(e[t].max)<=Number(e[t].min)&&(e[t].max=Number(e[t].min)+1)):e[t].isShowMax&&!e[t].isShowMin&&(e[t].max=60,Number(e[t].max)<=Number(e[t].min)&&(e[t].min=Number(e[t].max)-1));let X=e[t].max,N=e[t].min,O=this.getFieldIndex(o,e[t].encodeEx.value);for(let d=0;d<s.length;d++)s[d][O]>0&&m.push(s[d][O]);m.sort(function(d,S){return d-S}),m.length>0&&(A=m[m.length-1],L=m[0]),e[t].symbolSize=d=>{let S=this.getFieldIndex(o,e[t].encodeEx.value);return d[S]==0?0:Number((X-N)*(d[S]-L)/(A-L))+Number(N)}}e[t].encodeEx.name!=""&&(e[t].encode.itemName=e[t].encodeEx.name,e[t].name||(e[t].name=this.getLegendData(l,e[t].encodeEx.name))),e[t].label=this.getLabelStyle(e[t].label),e[t].encodeEx.name!=""?e[t].label.formatter="{@"+e[t].encodeEx.name+"}":e[t].label.formatter="";let Q=this.getTooltip(e[t].tooltip);e[t].tooltip=Q,e[t].markLine.label.formatter=this.getFormatterString(e[t].markLine.label.formatter),e[t].emphasis.itemStyle&&e[t].emphasis.itemStyle.colorInfo&&(e[t].emphasis.itemStyle.color=this.getColorInfo(e[t].emphasis.itemStyle.colorInfo))}let w={legend:c,title:h,grid:r,tooltip:G,toolbox:K,xAxis:y,yAxis:p,dataset:{source:s,sourceHeader:!1},series:e};this.getAnimation(w,i),this.setOption(w),this.setAnimationLoop(i,()=>{this.setOption(w,i)})},setOption(i){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(i),{notMerge:!0})},reLoadInfo(i){this.mergeConfig(i),i&&(this.$refs.scatterCartesian.style.width=i.attr.w+"px",this.$refs.scatterCartesian.style.height=i.attr.hh+"px"),this.loadInfo(i),this.echarts.resize()},getSerData(i,n,s,o){let l=[],e=-1,h=-1;return this.$$lib__.each(s,(c,r)=>{c==n.x&&(e=r),c==i.encodeEx.y&&(h=r)}),this.$$lib__.each(o,c=>{l.push([c[e],c[h]])}),l},getDataDim(i,n){let s=[];return this.$$lib__.each(i,o=>{s.indexOf(o.encodeEx.value)==-1&&s.push(o.encodeEx.value),s.indexOf(o.encodeEx.y)==-1&&s.push(o.encodeEx.y)}),this.$$lib__.each(n,o=>{s.indexOf(o)==-1&&s.push(o)}),s},getFieldIndex(i,n){for(let s=0;s<i.length;s++)if(i[s]==n)return s},getLegendData(i,n){let s=this.$$lib__.find(i,o=>o.name==n);return s?s.alias&&s.alias!=""?s.alias:s.name:""},initAction(i){this.actionSendout(i),this.actionReceive(i)},actionSendout(i){C.log(i);let n=this;this.$$lib__.each(i.action.sendOut.actionList,s=>{if(s.enabled){let o=s.code+"_"+i.id;if(s.paramsExtend&&s.paramsExtend.length>0){let l={};this.getParamsExtend(l,s.paramsExtend,i)}s.code==P.Z.click.code&&n.onClick(o,s)}})},onClick(i,n){let s=this;s.echarts.on("click",o=>{let l={},e=s.getVal(o.data,s.dimensionsEx,{x:s.seriesAttr.x,y:s.seriesAttr.y[o.componentIndex],label:s.seriesAttr.label[o.componentIndex],size:s.seriesAttr.size[o.componentIndex]});if(l.x=e.x,l.y=e.y,l.label=e.label,l.size=e.size,n.script&&n.script.enabled){if(C.log("Execute script for "+s.widgetInfo.name+" component to "+n.name+" component1111111111111111111"),n.script.content==""){Z.Message.warning({message:n.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",n.script.content),l=this.customScript(l)}x.Z.$emit(i,l),n.postMessage&&s.doPostMessage(l),s.actionNameList.push(i)})},getVal(i,n,s){let o={x:null,y:null,label:null,size:null},l=-1,e=-1,h=-1,c=-1;if(i&&i.length>0){for(let r=0;r<n.length;r++)n[r]==s.x&&(l=r),n[r]==s.y&&(e=r),n[r]==s.label&&(h=r),n[r]==s.size&&(c=r);o.x=i[l],o.y=i[e],o.label=i[h],o.size=i[c]}return o}}},j=B,U=a(68141),H=(0,U.Z)(j,b,f,!1,null,"8b92e788",null),V=H.exports}}]);
