(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[74149],{9061:function(o,d,t){o.exports=function(e){var a={};function n(r){if(a[r])return a[r].exports;var i=a[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=a,n.d=function(r,i,f){n.o(r,i)||Object.defineProperty(r,i,{enumerable:!0,get:f})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,i){if(i&1&&(r=n(r)),i&8||i&4&&typeof r=="object"&&r&&r.__esModule)return r;var f=Object.create(null);if(n.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:r}),i&2&&typeof r!="string")for(var y in r)n.d(f,y,function(g){return r[g]}.bind(null,y));return f},n.n=function(r){var i=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(i,"a",i),i},n.o=function(r,i){return Object.prototype.hasOwnProperty.call(r,i)},n.p="/dist/",n(n.s=794)}({0:function(e,a){e.exports=t(342579)},100:function(e,a){e.exports=t(122305)},16:function(e,a){e.exports=t(91873)},2:function(e,a,n){"use strict";n.d(a,"a",function(){return r});function r(i,f,y,g,l,s,C,p){var u=typeof i=="function"?i.options:i;f&&(u.render=f,u.staticRenderFns=y,u._compiled=!0),g&&(u.functional=!0),s&&(u._scopeId="data-v-"+s);var v;if(C?(v=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),l&&l.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(C)},u._ssrRegister=v):l&&(v=p?function(){l.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:l),v)if(u.functional){u._injectStyles=v;var m=u.render;u.render=function(h,I){return v.call(I),m(h,I)}}else{var x=u.beforeCreate;u.beforeCreate=x?[].concat(x,v):[v]}return{exports:i,options:u}}},27:function(e,a){e.exports=t(578756)},35:function(e,a){e.exports=t(349162)},4:function(e,a){e.exports=t(555616)},45:function(e,a){e.exports=t(611323)},496:function(e,a){e.exports=t(477384)},497:function(e,a){e.exports=t(637318)},56:function(e,a){e.exports=t(934749)},6:function(e,a){e.exports=t(783574)},7:function(e,a){e.exports=t(17249)},794:function(e,a,n){"use strict";n.r(a);var r=function(){var S=this,b=S.$createElement,k=S._self._c||b;return k("div",{staticClass:"sh-general-mask"})},i=[];r._withStripped=!0;var f=n(56),y=n.n(f),g=n(0),l=n.n(g),s=n(27),C=n.n(s),p=n(45),u=n.n(p),v=n(6),m=n.n(v),x=n(7),c=n.n(x),h=n(496),I=n.n(h),z=n(35),w=n.n(z),$=n(497),M=n.n($),P=n(16),D=n(4),E=n(100),A=n.n(E),H={name:"ShGeneralMask",mixins:[m.a,c.a],props:{maskConfig:{type:Object}},data:function(){return this.options=void 0,this.geoJsonFeature=void 0,this.mask=void 0,{}},beforeDestroy:function(){this.$map&&this.remove2DMask(),this.$earth&&this.remove3DMask()},mounted:function(){var b=this;(this.$map||this.$earth)&&setTimeout(function(){l()(this,b),this.begin()}.bind(this),0)},methods:{begin:function(){this.initConfig()},initConfig:function(){var b=this;return y()(u.a.mark(function k(){return u.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(b.maskConfig){O.next=3;break}return D.Message.error("\u8BF7\u63D0\u4F9B\u63A9\u819C\u914D\u7F6E\u4FE1\u606F"),O.abrupt("return");case 3:return b.options={layer:{url:b.maskConfig.url,visibleLayers:b.maskConfig.layerName,selectLayer:b.maskConfig.layerName,type:b.maskConfig.type},where:b.maskConfig.where,xzqdm:b.maskConfig.xzqdm,token:b.token},O.next=6,b.requestMaskData("EPSG:4326",b.options);case 6:b.geoJsonFeature=O.sent,b.$map&&(b.remove2DMask(),b.add2DMask()),b.$earth&&(b.remove3DMask(),b.add3DMask());case 9:case"end":return O.stop()}},k)}))()},requestMaskData:function(b,k){var F=this;return new C.a(function(O,L){var N=this;l()(this,F),I()(b,k).then(function(J){l()(this,N);var B=J;B?O(B):L("\u8BF7\u6C42\u63A9\u819C\u6570\u636E\u5931\u8D25\uFF01")}.bind(this))}.bind(this))},add2DMask:function(){var b=this;if(this.geoJsonFeature){this.$map.maskGeoJson=this.geoJsonFeature;var k=new w.a().readFeature(this.geoJsonFeature,{dataProjection:"EPSG:4326",featureProjection:this.$map.getView().getProjection().getCode()}),F=new M.a({feature:k,inner:!1,fill:new P.Fill({color:this.maskConfig.color?this.maskConfig.color:[255,255,255,1]})});this.mask=F,this.$map.mask=this.mask,this.$map.getLayers().forEach(function(O){l()(this,b),this.geoJsonFeature!==null&&O.addFilter(this.mask)}.bind(this))}},add3DMask:function(){if(this.geoJsonFeature){this.$earth.maskGeoJson=this.geoJsonFeature;var b=A()(this.maskConfig.color).unitObject();this.$earth.viewer.shine.add3DMask(this.geoJsonFeature,b)}},remove2DMask:function(){var b=this;this.mask&&(this.$map.getLayers().forEach(function(k){l()(this,b),k.removeFilter(this.mask)}.bind(this)),this.$map.mask=void 0,this.$map.maskGeoJson=void 0)},remove3DMask:function(){this.$earth.viewer.shine.remove3DMask(),this.$earth.viewer.maskGeoJson=void 0}}},R=H,T=n(2),G=Object(T.a)(R,r,i,!1,null,null,null),j=G.exports;j.install=function(S){S.component(j.name,j)};var U=a.default=j}})},17249:function(o,d,t){"use strict";var e=t(419534);Object.defineProperty(d,"__esModule",{value:!0}),d.default=void 0;var a=e(t(342579)),n=e(t(705146)),r=e(t(828866)),i=e(t(641739)),f=t(110563),y={created:function(){var l=this;this.subscribe=this.$emitter_create_subscribe();var s=this.$emit,C=(0,f.formatConversion)(this.$options.name).replace("sh-","");this.$emit=function(p){for(var u,v,m,x,c=arguments.length,h=new Array(c>1?c-1:0),I=1;I<c;I++)h[I-1]=arguments[I];s.call.apply(s,(0,n.default)(u=[l,p]).call(u,h)),l.subscribe&&(v=l.subscribe).$emit.apply(v,(0,n.default)(m=[(0,n.default)(x="".concat(C,":")).call(x,p)]).call(m,h))}},methods:{$emitter_create_subscribe:function(){var l=this,s={},C=this.emitterId?"".concat(this.emitterId,":"):"";return s.$emit=function(p){for(var u,v,m=(0,n.default)(u="".concat(C)).call(u,p),x=arguments.length,c=new Array(x>1?x-1:0),h=1;h<x;h++)c[h-1]=arguments[h];i.default.$emit.apply(i.default,(0,n.default)(v=[m]).call(v,c))},s.$on=function(p,u){var v=this;(0,a.default)(this,l);var m;if(p instanceof Array)m=(0,r.default)(p).call(p,function(c){var h;return(0,a.default)(this,v),(0,n.default)(h="".concat(C)).call(h,c)}.bind(this));else{var x;m=(0,n.default)(x="".concat(C)).call(x,p)}i.default.$on(m,u)}.bind(this),s.$once=function(p,u){var v;(0,a.default)(this,l);var m=(0,n.default)(v="".concat(C)).call(v,p);i.default.$once(m,u)}.bind(this),s.$off=function(p,u){var v=this;(0,a.default)(this,l);var m;if(p instanceof Array)m=(0,r.default)(p).call(p,function(c){var h;return(0,a.default)(this,v),(0,n.default)(h="".concat(C)).call(h,c)}.bind(this));else{var x;m=(0,n.default)(x="".concat(C)).call(x,p)}i.default.$off(m,u)}.bind(this),s}}};d.default=y},641739:function(o,d,t){"use strict";var e=t(419534);Object.defineProperty(d,"__esModule",{value:!0}),d.default=void 0;var a=e(t(42160)),n=new a.default;d.default=n},242709:function(o,d,t){"use strict";var e=t(148836);const a={data(){return this.map=null,this.timer="",{isEditor:window.location.href.indexOf("editor.html")>0}},inject:{reactiveViewMode:{default:function(){return()=>"23D"}}},computed:{viewMode(){return this.isSetMap_common?this.$_viewMode:this.reactiveViewMode()}},mounted(){!this.widgetInfo.parentId&&this.isEditor&&this.widgetInfo.action.gisMapId&&this.$nextTick(function(){this.updateWidgetParentId({widgetId:this.widgetInfo.id,parentId:this.widgetInfo.action.gisMapId,keepPosition:!0})})},methods:{...(0,e.nv)(["updateWidgetParentId"]),getBindMap(){typeof this.widgetInfo.action.gisMapId<"u"}}};d.Z=a},168042:function(o,d,t){"use strict";t.d(d,{$:function(){return n}});var e=t(927966),a=t(149500);function n(r,i,f,y){let g=i[f];g&&g.length<1||g.forEach(l=>{if(l&&l.length<1)return;let s=l[0][1]+"_"+l[0][0];l[0][1].indexOf("_")>-1&&(s=l[0][1]),e.Z.$on(s,C=>{a.debug("gis\u7EC4\u4EF6\u63A5\u6536\u4E8B\u4EF6\u89E6\u53D1");let p=l[0][2];if(p){let u=p.indexOf("|");u>-1&&(p=l[0][2].substring(u+1))}i.script&&i.script.enabled?(r._doAction=new Function("data","param_key","value","info",i.script.content),r._doAction(C,p,i.value,C)):y(C[p],C)})})}},476010:function(o,d){"use strict";const t={data(){return{isSpecial:!1,isEditor:window.location.href.indexOf("editor.html")>0}},computed:{isBindToPage(){return this.widgetInfo.config.styleConfig.dragEnable||this.isSpecial},position(){return this.isEditor||!this.isBindToPage?{type:"absolute",top:"0px",left:"0px",bottom:"unset",right:"unset",zIndex:this.widgetInfo.attr.z}:{type:"absolute",top:this.widgetInfo.attr.y+"px",left:this.widgetInfo.attr.x+"px",zIndex:this.widgetInfo.attr.z}},styleConfig(){return{isShowBtn:this.widgetInfo.config.styleConfig.isShowBtn,isStartFix:this.isEditor,titleBar:{miniBtn:!0,maxBtn:!1,closeBtn:!1,fixBtn:!this.isEditor,title:!0},autoVisible:!1,btnSize:{size:this.widgetInfo.config.styleConfig.btnSize.size+"px",padding:this.widgetInfo.config.styleConfig.btnSize.padding+"px",radius:this.widgetInfo.config.styleConfig.btnSize.radius+"px"},size:{radius:this.widgetInfo.config.styleConfig.size.radius+"px",width:this.widgetInfo.attr.w>150?this.widgetInfo.attr.w+"px":"275px",height:this.widgetInfo.attr.hh>100?this.widgetInfo.attr.hh+"px":"80vh"},toolBtnSize:{size:this.widgetInfo.config.styleConfig.toolBtnSize.size+"px",margin:(this.widgetInfo.config.styleConfig.btnSize.size-this.widgetInfo.config.styleConfig.toolBtnSize.size)/2+"px"}}},themeConfig(){let e=this.widgetInfo.config.themeStyle.light;return{light:{title:{backgroundImage:"url('"+e.title.backgroundImage+"')",backgroundColor:e.title.backgroundColor?e.title.backgroundColor:e.floatButton.fillcolor,backgroundSize:e.title.backgroundSize,fontSize:e.title.fontSize+"px",color:e.title.fontColor},primaryFont:{fontSize:e.primaryFont.fontSize+"px",fontColor:e.primaryFont.fontColor},toolButton:{color:e.toolButton.color},panel:{backgroundImage:"url('"+e.panel.backgroundImage+"')",backgroundColor:e.panel.fillcolor,backgroundSize:e.panel.backgroundSize,border:e.panel.border},floatButton:{backgroundColor:e.floatButton.fillcolor,shadowColor:e.floatButton.shadowColor,border:e.floatButton.border}}}}},methods:{bindToPage(e){e&&this.isBindToPage&&(e.parentElement.remove(e),document.getElementById("page_"+this.widgetInfo.pageId).append(e),e.style.pointerEvents="auto",document.getElementById("container_child_"+this.widgetInfo.id).remove())}}};d.Z=t},752246:function(o,d,t){"use strict";t.d(d,{X:function(){return e},b:function(){return a}});let e={versions:function(){var n=navigator.userAgent;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")==-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1,iPhone:n.indexOf("iPhone")>-1,iPad:n.indexOf("iPad")>-1,webApp:n.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},a;e.versions.mobile||e.versions.ios||e.versions.android||e.versions.iPhone||e.versions.iPad?a=!1:a=!0},844513:function(o,d,t){"use strict";t.d(d,{Z:function(){return g}});var e=function(){var s=this,C=s._self._c;return s.attr.buttonHide?C("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(p){return s.onHide()}}},[s.openTooltip?C("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[C("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):C("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},a=[],n=t(752246),r={props:["attr"],name:"hide-button",data(){return{isPc:n.b}},computed:{openTooltip:function(){let l=!1,s=this.attr.buttonHideTooltipContent;return n.b&&s&&s!=null&&s.trim()!=""&&(l=!0),l}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},i=r,f=t(768141),y=(0,f.Z)(i,e,a,!1,null,"bf399b9a",null),g=y.exports},597280:function(o,d,t){"use strict";t.r(d),t.d(d,{default:function(){return z}});var e=function(){var $=this,M=$._self._c;return M("div",{directives:[{name:"show",rawName:"v-show",value:$.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:$.widgetInfo.attr.w+"px",height:$.widgetInfo.attr.hh+"px"}},[M("hide-button",{attrs:{attr:$.widgetInfo.attr}}),M("general-mask",{ref:"mask",attrs:{"mask-config":$.widgetInfo.config.maskConfig}})],1)},a=[],n=t(9061),r=t.n(n),i=t(844513),f=t(927966),y=t(468099),g=t(445061),l=t(126711),s=t(386892),C=t(148836),p=t(476010),u=t(242709),v=t(168042),m=t(149500),x={name:"GisCovermask",mixins:[y.baseConfig,s.D,g.u,l.H,u.Z,p.Z],props:["widgetInfo"],computed:{...(0,C.Se)(["getCanvasSetting","getURLParams"])},components:{HideButton:i.Z,GeneralMask:r()},data(){return{timer:"",map:null,mapvue:null,globalEditor:this.$$global_editor}},watch:{},beforeDestroy(){this.doHide()},created(){},mounted(){this.initAction(this.widgetInfo)},methods:{loadInfo(w){m.log(w)},reLoadInfo(w){m.log("\u914D\u7F6E\u66F4\u65B0\u4E86"),this.loadInfo(w),this.doHide(),this.doShow()},initAction(w){this.actionReceive(w)},actionReceive(w){if(w.action==null||w.action.receive==null)return;let $=w.action.receive.replaceSomeParams;$&&$.enabled&&$.paramsList&&$.paramsList.length>0&&(0,v.$)(this,$,"paramsList",this.replaceSomeParams);let M=w.action.receive.show;M&&M.enabled&&M.showList&&M.showList.length>0&&this.doActionShowOrHide(M.showList,M.value,M.script,w.name,"show",!1);let P=w.action.receive.hide;P&&P.enabled&&P.hideList&&P.hideList.length>0&&this.doActionShowOrHide(P.hideList,P.value,P.script,w.name,"hide",!0)},replaceSomeParams(w){if(w){m.log("cover init param",w);let $={...this.widgetInfo.config.maskConfig,...w};this.widgetInfo.config.maskConfig=$,this.reLoadInfo()}},doShow(){this.$refs.mask&&this.$refs.mask.initConfig()},doHide(){this.$refs.mask&&this.$refs.mask.remove2DMask()}}},c=x,h=t(768141),I=(0,h.Z)(c,e,a,!1,null,"4ab36c2a",null),z=I.exports},465557:function(o,d,t){o.exports=t(372626)},387507:function(o){function d(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}o.exports=d,o.exports.__esModule=!0,o.exports.default=o.exports},122777:function(o){function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}o.exports=d,o.exports.__esModule=!0,o.exports.default=o.exports},42762:function(o,d,t){var e=t(857448),a=t(168871);function n(i,f){for(var y=0;y<f.length;y++){var g=f[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),e(i,a(g.key),g)}}function r(i,f,y){return f&&n(i.prototype,f),y&&n(i,y),e(i,"prototype",{writable:!1}),i}o.exports=r,o.exports.__esModule=!0,o.exports.default=o.exports},234009:function(o,d,t){var e=t(439155),a=t(601520),n=t(797556);function r(i){var f;return o.exports=r=e?a(f=n).call(f):function(g){return g.__proto__||n(g)},o.exports.__esModule=!0,o.exports.default=o.exports,r(i)}o.exports=r,o.exports.__esModule=!0,o.exports.default=o.exports},330044:function(o,d,t){var e=t(721648),a=t(857448),n=t(372459);function r(i,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=e(f&&f.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),a(i,"prototype",{writable:!1}),f&&n(i,f)}o.exports=r,o.exports.__esModule=!0,o.exports.default=o.exports},299085:function(o,d,t){var e=t(29870).default,a=t(387507);function n(r,i){if(i&&(e(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a(r)}o.exports=n,o.exports.__esModule=!0,o.exports.default=o.exports},372459:function(o,d,t){var e=t(439155),a=t(601520);function n(r,i){var f;return o.exports=n=e?a(f=e).call(f):function(g,l){return g.__proto__=l,g},o.exports.__esModule=!0,o.exports.default=o.exports,n(r,i)}o.exports=n,o.exports.__esModule=!0,o.exports.default=o.exports},144900:function(o,d,t){"use strict";var e=t(556370);o.exports=e},253005:function(o,d,t){"use strict";t(194495);var e=t(318893);o.exports=e("Function","bind")},817086:function(o,d,t){"use strict";var e=t(832242),a=t(253005),n=Function.prototype;o.exports=function(r){var i=r.bind;return r===n||e(n,r)&&i===n.bind?a:i}},660382:function(o,d,t){"use strict";t(430897);var e=t(594388);o.exports=e.Reflect.construct},601520:function(o,d,t){"use strict";o.exports=t(748691)},748691:function(o,d,t){"use strict";var e=t(144900);o.exports=e},777958:function(o,d,t){"use strict";var e=t(636021),a=t(986735),n=t(942660),r=t(979489),i=t(602529),f=t(982396),y=Function,g=e([].concat),l=e([].join),s={},C=function(p,u,v){if(!r(s,u)){for(var m=[],x=0;x<u;x++)m[x]="a["+x+"]";s[u]=y("C,a","return new C("+l(m,",")+")")}return s[u](p,v)};o.exports=f?y.bind:function(u){var v=a(this),m=v.prototype,x=i(arguments,1),c=function(){var I=g(x,i(arguments));return this instanceof c?C(v,I.length,I):v.apply(u,I)};return n(m)&&(c.prototype=m),c}},194495:function(o,d,t){"use strict";var e=t(190434),a=t(777958);e({target:"Function",proto:!0,forced:Function.bind!==a},{bind:a})},430897:function(o,d,t){"use strict";var e=t(190434),a=t(830889),n=t(119522),r=t(777958),i=t(411298),f=t(987934),y=t(942660),g=t(24136),l=t(427909),s=a("Reflect","construct"),C=Object.prototype,p=[].push,u=l(function(){function x(){}return!(s(function(){},[],x)instanceof x)}),v=!l(function(){s(function(){})}),m=u||v;e({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(c,h){i(c),f(h);var I=arguments.length<3?c:i(arguments[2]);if(v&&!u)return s(c,h,I);if(c===I){switch(h.length){case 0:return new c;case 1:return new c(h[0]);case 2:return new c(h[0],h[1]);case 3:return new c(h[0],h[1],h[2]);case 4:return new c(h[0],h[1],h[2],h[3])}var z=[null];return n(p,z,h),new(n(r,c,z))}var w=I.prototype,$=g(y(w)?w:C),M=n(c,$,h);return y(M)?M:$}})},556370:function(o,d,t){"use strict";var e=t(817086);o.exports=e},372626:function(o,d,t){"use strict";var e=t(660382);o.exports=e}}]);
