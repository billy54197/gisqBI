"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[7147],{77147:function(y,d,n){n.r(d),n.d(d,{default:function(){return x}});var l=function(){var t=this,o=t._self._c;return o("div",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"content",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[t.isLoad?o("LayerManager",{ref:"toc",attrs:{id:`toc_${t.widgetInfo.id}`,mobile:t.widgetInfo.config.widgetConfig.panelType==="mobile","is-show":t.widgetInfo.attr.hide!==!0,"hide-pile-num":t.hidePileNum,"layers-info":t.toc,position:t.position,"style-config":t.styleConfig,"theme-style":t.themeConfig,"is-search":t.widgetInfo.config.widgetConfig.isSearch,"map-link-enable":t.widgetInfo.config.widgetConfig.isMapLink,"drag-enable":t.widgetInfo.config.styleConfig.dragEnable,"img-src":t.widgetInfo.config.imgSrc},on:{tocLoaded:t.tocLoaded,treeNodeCheckChange:t.treeNodeCheckChange}}):t._e()],1)},g=[],h=n(19364),f=n.n(h),a=n(27966),m=n(75530),p=n(45061),C=n(26711),u=n(42709),w=n(76010),b=n(86892),c=n(49500),I={name:"GisToc",components:{LayerManager:f()},mixins:[m.u,b.D,p.u,C.H,u.Z,w.Z],props:["widgetInfo"],data(){return{isLoad:!0,tocConfig:null,isShowBtn:this.widgetInfo.config.widgetConfig.isShowBtn,hidePileNum:this.widgetInfo.config.widgetConfig.hidePileNum,btnAttr:this.widgetInfo.attr,toc:this.widgetInfo.mapLayer.toc,imgIconConfig:this.widgetInfo.config.imgIconConfig,widgetConfig:this.widgetInfo.config.widgetConfig,eventConfig:this.widgetInfo.config.eventConfig}},mounted(){this.isEditor||this.$nextTick(()=>{let e=this.$refs.toc.$el;this.bindToPage(e)}),this.initAction(this.widgetInfo),this.setStyle()},methods:{reBind(){this.isLoad=!1,setTimeout(()=>{this.isLoad=!0},500)},loadInfo(){this.setStyle()},reLoadInfo(e){c.log("\u914D\u7F6E\u66F4\u65B0\u4E86",e),this.loadInfo(e),this.btnAttr=e.attr,this.imgIconConfig=e.config.imgIconConfig,this.isShowBtn=e.config.widgetConfig.isShowBtn,this.hidePileNum=e.config.widgetConfig.hidePileNum,this.widgetConfig=e.config.widgetConfig,this.toc=e.mapLayer.toc},setStyle(){let e=this.getCssString(this.widgetInfo),t=`css_widget_${this.widgetInfo.id}`,o=document.getElementById(t);o?o.innerHTML=e:(o=document.createElement("style"),o.id=t,o.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(o))},getCssString(){let e=this.widgetInfo.config.tocStyle,t=`toc_${this.widgetInfo.id}`,o=`#${t}  .layer-tree .el-tree .el-tree-node .el-tree-node__content:hover {
                     background-color: ${e.hoverColor} !important;
                 }
                 #${t}  .layer-tree .el-tree .el-tree-node:focus>.el-tree-node__content {
                      background-color: ${e.hoverColor} !important;
                 }
                 #${t} .dark .layer-tree .el-tree .el-tree-node .el-tree-node__content:hover {
                     background-color: ${e.darkHoverColor} !important;
                 }
                 #${t} .dark .layer-tree .el-tree .el-tree-node:focus>.el-tree-node__content {
                      background-color: ${e.darkHoverColor} !important;
                 }
                 ${this.widgetInfo.config.scriptStyle.enabled?this.widgetInfo.config.script_content.formatterScript:""}
                 `;if(e.checkboxBorderColorNormal||e.checkboxBackgroundColorNormal){let i=e.checkboxBorderColorNormal?`border: 1px solid ${e.checkboxBorderColorNormal}!important;`:"",r=e.checkboxBackgroundColorNormal?`background-color: ${e.checkboxBackgroundColorNormal}!important;`:"";o+=`
                #${t}  .el-checkbox__inner {
                    ${i}
                    ${r}
                }
                `}if(e.checkboxBorderColorSelected||e.checkboxBackgroundColorNormal){let i=e.checkboxBorderColorSelected?`border: 1px solid ${e.checkboxBorderColorSelected}!important;`:"",r=e.checkboxBackgroundColorSelected?`background-color: ${e.checkboxBackgroundColorSelected}!important;`:"";o+=`
                #${t} .el-checkbox__input.is-checked .el-checkbox__inner,#${t}  .el-checkbox__input.is-indeterminate .el-checkbox__inner {
                    ${i}
                    ${r}
                }`}return o},initAction(e){this.registerAction(e,"configMap","mapList",this.doConfigMap),this.actionReceive(e)},doConfigMap(e,t,o){let i=t[o];this.map=i,c.info("===============")},tocLoaded(){let e=this,t=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(t,o=>{if(o.enabled&&o.code==e.$$global_editor.actionType.tocInit.code){let i=o.code+"_"+e.widgetInfo.id,r={toc:e};o.paramsExtend&&o.paramsExtend.length>0&&this.getExtendParams(r,o.paramsExtend,[],[]),o.script&&o.script.enabled&&o.script.content&&(this.doConfigMap=new Function("data",o.script.content),this.doConfigMap(r)),a.Z.$emit(i,r),o.postMessage&&this.doPostMessage(r),this.actionNameList.push(i)}})},treeNodeCheckChange(e){let t=this,o=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(o,i=>{if(i.enabled&&i.code==t.$$global_editor.actionType.layerTocManager.code){let r=i.code+"_"+t.widgetInfo.id,s={info:e};i.paramsExtend&&i.paramsExtend.length>0&&this.getExtendParams(s,i.paramsExtend,[],[]),i.script&&i.script.enabled&&i.script.content&&(this.doConfigMap=new Function("data",i.script.content),this.doConfigMap(s)),a.Z.$emit(r,s),i.postMessage&&this.doPostMessage(s),this.actionNameList.push(r)}})}}},v=I,$=n(68141),k=(0,$.Z)(v,l,g,!1,null,"0da30588",null),x=k.exports}}]);
