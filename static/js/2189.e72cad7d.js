"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2189],{56279:function($,I,s){s.d(I,{P:function(){return O}});var v=s(86892),p=s(49500);const O={mixins:[v.D],created(){},methods:{lifecycleBeforeChartsLoad(y){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&p.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let x=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[y]);if(x)return x}return y},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&p.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),p.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},62189:function($,I,s){s.r(I),s.d(I,{default:function(){return T}});var v=function(){var e=this,i=e._self._c;return i("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:e.widgetInfo.attr}}),i("div",{ref:"candlestickSimple",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},p=[],O=s(44513),y=s(27966),b=s(56279),x=s(45061),N=s(26711),C=s(99349),J=s(67616),A=s(55616),F=s(75770),E=s(67157),m=s(50666);const Z={mixins:[E.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(m.Z.charts.title)),legend:JSON.parse(JSON.stringify(m.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(m.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(m.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(m.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(m.Z.charts.yAxis)),color:["rgba(45,95,115, 1)"],series:[{itemStyle:{color:"#FFC978",borderColor:"#FFB23F",color0:"#5DDEDE",borderColor0:"#18CFCF"}}],lineSeries:[{lineStyle:{color:"rgba(255, 122, 92, 0.4)"},itemStyle:{color:"#FF7A5C"}}]}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var D=s(49500);const P=s(29426);var k={name:"CandlestickSimple",components:{HideButton:O.Z},mixins:[C.P,b.P,x.u,N.H,J.u,Z],props:["widgetInfo"],data(){return{}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=P.init(this.$refs.candlestickSimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let e=t.dataset[t.dataset.type].source,i=t.dataset[t.dataset.type].dimensionsAlias,n=t.dataset[t.dataset.type].encode,o=this.getDataList(n,i,e),w=JSON.parse(JSON.stringify(t.config.title)),u=JSON.parse(JSON.stringify(t.config.legend)),l=this.getTooltip(t.config.tooltip),g=JSON.parse(JSON.stringify(t.config.toolbox)),h=JSON.parse(JSON.stringify(t.config.grid)),r=JSON.parse(JSON.stringify(t.config.series)),c=JSON.parse(JSON.stringify(t.config.lineSeries)),S=JSON.parse(JSON.stringify(t.config.xAxis)),a=this.getyAxis(t.config.yAxis);S.data=o.xList,a.axisTick.lineStyle.color=this.getColorInfo(a.axisTick.lineStyle.colorInfo),a.axisLine.lineStyle.color=this.getColorInfo(a.axisLine.lineStyle.colorInfo),u.data=this.getLegendData(r,c);let d={legend:u,tooltip:l,toolbox:g,title:w,dataZoom:[{end:100,start:0,type:"inside"}],grid:{left:h.left+"%",right:h.right+"%",top:h.top+"%",bottom:h.bottom+"%"},series:[],xAxis:S,yAxis:a};this.$$lib__.each(o.list,(L,f)=>{d.series.push({type:"candlestick",name:r[f].name,data:L,itemStyle:r[f].itemStyle,markLine:r[f].markLine})}),this.$$lib__.each(o.lineList,(L,f)=>{d.series.push({type:"line",name:c[f].name,symbol:c[f].symbol,symbolSize:c[f].symbolSize,smooth:c[f].smooth,data:L,itemStyle:c[f].itemStyle,lineStyle:c[f].lineStyle})}),this.getAnimation(d,t),this.setOption(d),this.setAnimationLoop(t,()=>{this.setOption(d,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},getLegendData(t,e){let i=[];return this.$$lib__.each(t,n=>{n.name&&i.push(n.name)}),this.$$lib__.each(e,n=>{n.name&&i.push(n.name)}),i},reLoadInfo(t){t&&(this.$refs.candlestickSimple.style.width=t.attr.w+"px",this.$refs.candlestickSimple.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getDataList(t,e,i){let n=[],o=[],w=[],u=null;return this.$$lib__.each(e,(l,g)=>{l.name==t.x&&(u=g)}),this.$$lib__.each(i,l=>{n.push(l[u])}),this.$$lib__.each(t.y,l=>{let g=null,h=null,r=null,c=null,S=[];this.$$lib__.each(e,(a,d)=>{a.name==l.open&&(g=d),a.name==l.close&&(h=d),a.name==l.lowest&&(r=d),a.name==l.highest&&(c=d)}),this.$$lib__.each(i,a=>{S.push([a[g],a[h],a[r],a[c]])}),o.push(S)}),this.$$lib__.each(t.lines,l=>{let g=null,h=[];this.$$lib__.each(e,(r,c)=>{r.name==l.value&&(g=c)}),this.$$lib__.each(i,r=>{h.push(r[g])}),w.push(h)}),{list:o,lineList:w,xList:n}},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let e=this;this.$$lib__.each(t.action.sendOut.actionList,i=>{if(i.enabled){let n=i.code+"_"+t.id;if(i.paramsExtend&&i.paramsExtend.length>0){let o={};this.getParamsExtend(o,i.paramsExtend,t)}i.code==F.Z.click.code&&e.onClick(n,i)}})},onClick(t,e){let i=this;i.echarts.on("click",n=>{let o={};if(o.x=n.name,o.y=n.data.splice(1,4),e.script&&e.script.enabled){if(D.log("Execute script for "+i.widgetInfo.name+" component to "+e.name+" component"),e.script.content==""){A.Message.warning({message:e.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",e.script.content),o=this.customScript(o)}y.Z.$emit(t,o),e.postMessage&&i.doPostMessage(o),i.actionNameList.push(t)})}}},M=k,B=s(68141),R=(0,B.Z)(M,v,p,!1,null,"2ec87fa4",null),T=R.exports}}]);
