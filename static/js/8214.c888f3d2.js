"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[8214],{5143:function(v,p,r){r.d(p,{b:function(){return h}});var u=r(48836),c=r(42160),l=r(49500);const h={created(){},computed:{...(0,u.Se)(["getWidgetAllArr"])},data(){return{containerViewSubWidgetList:[]}},methods:{...(0,u.nv)(["updateWidgetParentArrDataset","updateWidgetAllArrDataset"]),reLoadInfo(t){this.widgetInfo.id!=t.id&&this.$refs["comp_"+t.id]&&setTimeout(this.$refs["comp_"+t.id][0].reLoadInfo(t),500),this.loadInfo(t)},orgWidget(t){let a=[];return this.$$lib__.each(t,s=>{let e=this.$$lib__.find(this.getWidgetAllArr,o=>o.parentId==this.widgetInfo.id&&o.id==s.id);e&&(e.dataset&&e.dataset[e.dataset.type]&&(e.dataset.type==this.$$global_editor.dataSourcType.dynamic.code||e.dataset.type==this.$$global_editor.dataSourcType.local.code)&&e.dataset[e.dataset.type].autoUpdate==!0&&(c.default.set(this.dynamicWidgets,e.id,e),e.attr.hide!=!0&&e.dataset[e.dataset.type].autoUpdate==!0&&c.default.set(this.autoUpdateWidget,e.id,e)),a.push(e))}),c.default.set(this,"containerViewSubWidgetList",a),a},setTitleText(t,a){a?this.$$lib__.each(a,s=>{this.$$lib__.each(this.orgWidget(s.widgets),e=>{e.attr.widgetW||(e.attr.widgetW=e.attr.w),this.$refs["title_"+e.id]&&this.$refs["title_"+e.id][0]&&(this.$refs["title_"+e.id][0].innerHTML=this.initTextPosition(e)),e.title.position||(e.title.position="top")})}):this.$$lib__.each(this.orgWidget(t),s=>{this.$refs["title_"+s.id]&&this.$refs["title_"+s.id][0]&&(this.$refs["title_"+s.id][0].innerHTML=this.initTextPosition(s)),s.title.position||(s.title.position="top")})},initTextPosition(t){return t.title.text===void 0||!t.title.text?"":t.title.text&&(t.title.position==="left"||t.title.position==="right")?t.title.text.split("").join("<br />"):t.title.text},updataWidgetSource(t,a,s){try{switch(t.dataset.type){case this.$$global_editor.dataSourcType.dynamic.code:t.dataset.dynamic.source=a.data,a.total&&(t.dataset.dynamic.total=a.total);break;case this.$$global_editor.dataSourcType.local.code:t.dataset.local.dimensionsAlias=[],t.dataset.local.columnList=[],t.dataset.local.source=[],t.dataset.local.dimensions=[],t.dataset.local.dimensionsAlias=a.dimensionsAlias,t.dataset.local.columnList=a.columnList,t.dataset.local.source=a.source,t.dataset.local.dimensions=a.dimensions;break}}catch(o){l&&l.log&&l.log(o)}let e=this.$refs["comp_"+t.id];e&&e.length>0&&(this.updateWidgetAllArrDataset(t),this.updateWidgetParentArrDataset(t),e[0].reLoadInfo(t),this.sendoutDataloadSuccess(t),this.sendoutResponseData(t,a,s))},fit(t,a){if(!this.isView||!/^mobile/.test(this.getCanvasSetting.transformType))return t+"px";let s=this.getCanvasSetting.width/10,e=this.getCanvasSetting.height/window.innerHeight,o="";switch(this.getCanvasSetting.transformType){case"mobileAutoWidth":a?o=t+"px":o=t/s+"rem";break;case"mobileAutoBoth":o=t/s+"rem";break;default:a?o=t/e+"px":o=t/s+"rem"}return o}}}},58214:function(v,p,r){r.r(p),r.d(p,{default:function(){return b}});var u=function(){var i=this,f=i._self._c;return f("ShineMap",{ref:"gismap",attrs:{"widget-info":i.widgetInfo},scopedSlots:i._u([{key:"default",fn:function(d){return[f("ViewContainer",{ref:"container",attrs:{"widget-info":d.widgetInfo,"widget-arr":i.getWidgetAllArr}})]}}])})},c=[],l=r(48836),h=r(9848),t=function(){var i=this,f=i._self._c;return f("div",{ref:"container",attrs:{id:"map_child_view"}},[i._l(i.orgWidget(i.widgetInfo.config.widgets),function(d){return[f("draggable-component-container",{key:i.prefix.widget+d.id,ref:"comp_"+d.id,refInFor:!0,staticStyle:{display:"inline-block",float:"left"},style:{...i.getBindStyle(d),...i.widgetStyle(d)},attrs:{"widget-data":d,"current-widget":i.getCurrentWidget},on:{doGetPreviewData:i.getPreviewData,attrChange:i.attrChange}})]})],2)},a=[],s=r(80512),e=r(23400),o=r(83577),g=r(93575),_=r(5143),y=r(45061),$={name:"ViewContainer",components:{DraggableComponentContainer:s.Z},mixins:[e.j,o.i,g.E,_.b,y.u],props:["widgetInfo","widgetArr"],data(){return{prefix:{widget:"widget_"}}},computed:{...(0,l.Se)(["getWidgets"]),widgetStyle(){return function(n){return{position:"absolute",pointerEvents:n.config.isPointEventNone?"none":"auto",left:`${n.attr.x}px`,top:`${n.attr.y}px`}}}},beforeDestroy(){this.$refs.container.remove()},mounted(){document.getElementById("page_"+this.widgetInfo.pageId).appendChild(this.$refs.container)},methods:{...(0,l.nv)(["setCurrentWidget"]),doSetCurrentWidgetId(n){this.$nextTick(()=>{this.setCurrentWidget(n)})},loadInfo(){},attrChange(n){let i=this.$refs["widget_"+n.id][0];n.attr.hide?n.attr.hideAnimate?(this.first=!1,i.classList="",i.classList.add("animated"),i.classList.add("my-comp"),i.classList.add(n.attr.hideAnimate[n.attr.hideAnimate.length-1])):i.style.display="none":n.attr.showAnimate?(this.first=!1,i.classList="",i.classList.add("animated"),i.classList.add("my-comp"),i.classList.add(n.attr.showAnimate[n.attr.showAnimate.length-1])):i.style.display="block"}}},A=$,m=r(68141),x=(0,m.Z)(A,t,a,!1,null,null,null),C=x.exports,S={name:"GisMapView",components:{ShineMap:h.Z,ViewContainer:C},props:["widgetInfo"],data(){return{}},computed:{...(0,l.Se)(["getWidgetAllArr"])},methods:{reLoadInfo(n){this.$refs.container&&this.$refs.container.reLoadInfo(n)},getMap(){return this.$refs.gismap.$refs.gismap.map},getEarth(){return this.$refs.gismap.$refs.gismap.earth}}},W=S,L=(0,m.Z)(W,u,c,!1,null,"47c9fca1",null),b=L.exports}}]);
