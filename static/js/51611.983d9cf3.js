"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[51611],{351611:function(b,h,l){var j=l(149500),$=l(29870),B=l(985208),A=l(659791),W=l(22466),p=l(183393),O=l(105077),H=l(520314),J=l(426352),L=l(230551),N=l(43586),T=l(787879),y=l(419534);Object.defineProperty(h,"__esModule",{value:!0}),Object.defineProperty(h,"DrawConfig",{enumerable:!0,get:function(){return w.default}}),h.default=void 0;var E=y(l(66273)),z=y(l(543389)),P=y(l(342579)),G=y(l(122777)),K=y(l(42762)),C=l(792672),g=Y(l(187647)),w=y(l(437661)),U=l(59269);function D(r){if(typeof T!="function")return null;var a=new T,t=new T;return(D=function(n){return n?t:a})(r)}function Y(r,a){if(!a&&r&&r.__esModule)return r;if(r===null||$(r)!=="object"&&typeof r!="function")return{default:r};var t=D(a);if(t&&t.has(r))return t.get(r);var e={},n=Object.defineProperty&&p;for(var i in r)if(i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)){var s=n?p(r,i):null;s&&(s.get||s.set)?Object.defineProperty(e,i,s):e[i]=r[i]}return e.default=r,t&&t.set(r,e),e}function Q(r,a){var t=typeof L<"u"&&N(r)||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=V(r))||a&&r&&typeof r.length=="number"){t&&(r=t);var e=0,n=function(){};return{s:n,n:function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}},e:function(d){throw d},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,v;return{s:function(){t=t.call(r)},n:function(){var d=t.next();return i=d.done,d},e:function(d){s=!0,v=d},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(s)throw v}}}}function V(r,a){var t;if(r){if(typeof r=="string")return I(r,a);var e=H(t=Object.prototype.toString.call(r)).call(t,8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return J(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return I(r,a)}}function I(r,a){(a==null||a>r.length)&&(a=r.length);for(var t=0,e=new Array(a);t<a;t++)e[t]=r[t];return e}function S(r,a){var t=B(r);if(A){var e=A(r);a&&(e=W(e).call(e,function(n){return p(r,n).enumerable})),t.push.apply(t,e)}return t}function o(r){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?S(Object(t),!0).forEach(function(e){(0,z.default)(r,e,t[e])}):O?Object.defineProperties(r,O(t)):S(Object(t)).forEach(function(e){Object.defineProperty(r,e,p(t,e))})}return r}var X=function(){function r(a,t){(0,G.default)(this,r),this._initailize(a,t)}return(0,K.default)(r,[{key:"_initailize",value:function(t,e){this._drawTool=t.shine.draw;var n={visible:!0,id:e.id?e.id:U.BASE_DRAWLAYER_ID,type:"geojson-draw"};t.shine.addLayer(n),this._drawTool.setEditLayer(n.id,e.hasEdit)}},{key:"activate",value:function(t,e){var n=w.default[t];if(n){n=JSON.parse((0,E.default)(n));var i=this._drawTool.startDraw({drawtype:n.drawtype,style:e||n.style,edittype:n.edittype,plottingType:n.plottingType,attr:n.attr});return i}}},{key:"deactivate",value:function(){this._drawTool.hasEdit(!1),this._drawTool.stopDraw()}},{key:"loadFeature",value:function(t){var e,n=this,i=t.geojson,s=t.isClear,v=t.isFly,u=t.isFlash,d=t.layerId,R=t.style,Z=t.type,M=(e=t.getAttr3d)===null||e===void 0?void 0:e.call(t).attr;try{typeof i=="string"&&i.constructor===String&&(i=JSON.parse(i))}catch(c){j.error(c.name+": "+c.message+` 
\u8BF7\u786E\u8BA4json\u6587\u4EF6\u683C\u5F0F\u6B63\u786E!!!`);return}i=JSON.parse((0,E.default)(i));var f=w.default[Z];if(Array.isArray(i.features))i.features.forEach(function(c){var F;(0,P.default)(this,n),c.properties={drawtype:f.drawtype,plottingType:f.plottingType,style:o(o({},f.style),R),attr:o(o(o({},f.attr),(F=c.properties)===null||F===void 0?void 0:F.attr),M)}}.bind(this));else{var m;i.properties={drawtype:f.drawtype,plottingType:f.plottingType,style:o(o({},f.style),R),attr:o(o(o(o({},f.attr),(m=i.properties)===null||m===void 0?void 0:m.attr),M),{},{id:t.id})}}return this._drawTool.loadJson(i,{isClear:s,isFly:v,isFlash:u,layerId:d})}},{key:"removeAll",value:function(){this._drawTool.clearDraw()}},{key:"removeFeatures",value:function(t){var e=this;Array.isArray(t)&&t.forEach(function(n){(0,P.default)(this,e),this.removeFeature(n)}.bind(this))}},{key:"removeFeature",value:function(t){this._drawTool.deleteEntity(t)}},{key:"setPositions",value:function(t,e,n){n&&(t=(0,C.setPositionsHeight)(t,n)),this._drawTool.setPositions(t,e)}},{key:"setFeatureStyle",value:function(t,e){e=o(o({},t.style),e);var n=this._getEntity(t);return this._drawTool.updateAttribute({style:e},n),t}},{key:"flyTo3dFeature",value:function(t){if(Array.isArray(t))this.flyTo3dFeature(t[0]);else if(t instanceof g.CumulusCloud){var e=(0,C.addPositionsHeight)(t.position,200);this._drawTool.viewer.scene.camera.flyTo({destination:e,orientation:{heading:0,pitch:g.Math.toRadians(-90),roll:0}})}else this._drawTool.viewer.flyTo(t)}},{key:"flyToFeatures",value:function(t){if(Array.isArray(t)&&t.length>0)if(t.length>5e3)this.flyTo3dFeature(this._getEntity(t[0]));else{var e,n=[],i=Q(t),s;try{for(i.s();!(s=i.n()).done;){var v=s.value,u=this._getEntity(v);u&&(n.push(u),e=u.attribute.style.clampToGround)}}catch(d){i.e(d)}finally{i.f()}e?this._drawTool.viewer.flyTo(n,{offset:new g.HeadingPitchRange(0,g.Math.toRadians(-90),0)}):this._drawTool.viewer.flyTo(n)}else this.flyTo3dFeature(this._getEntity(t))}},{key:"_getEntity",value:function(t){if(t==null&&(t=this.currEditFeature),t!=null){var e=t.feature3d;return e||(e=this._drawTool.getFeatureById(t.id,t.layerId)),e}}},{key:"getCurrEditFeature",value:function(){return this._drawTool.currEditFeature}},{key:"updateDraggers",value:function(t){var e;t=t||this._drawTool.currEditFeature,(e=t)===null||e===void 0||e.editing.updateDraggers()}}]),r}();h.default=X}}]);
