"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[8098],{44513:function(w,l,o){o.d(l,{Z:function(){return v}});var h=function(){var t=this,r=t._self._c;return t.attr.buttonHide?r("div",{style:{position:"absolute",right:t.attr.buttonHideRight+"px",top:t.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(y){return t.onHide()}}},[t.openTooltip?r("el-tooltip",{attrs:{"open-delay":1e3,content:t.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[r("el-button",{class:t.attr.buttonHideIconClass&&t.attr.buttonHideIconClass!=""?t.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.attr.buttonHideColor,fontSize:t.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r("el-button",{class:t.attr.buttonHideIconClass&&t.attr.buttonHideIconClass!=""?t.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:t.attr.buttonHideColor,fontSize:t.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):t._e()},f=[],c=o(52246),a={props:["attr"],name:"hide-button",data(){return{isPc:c.b}},computed:{openTooltip:function(){let d=!1,t=this.attr.buttonHideTooltipContent;return c.b&&t&&t!=null&&t.trim()!=""&&(d=!0),d}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},p=a,m=o(68141),g=(0,m.Z)(p,h,f,!1,null,"bf399b9a",null),v=g.exports},58098:function(w,l,o){o.r(l),o.d(l,{default:function(){return x}});var h=function(){var i=this,n=i._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:i.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[n("hide-button",{attrs:{attr:i.widgetInfo.attr}})],1)},f=[],c=o(44513),a=o(27966),p=o(23166),m=o(45061),g=o(26711),v=o(48836),d=o(49500),t={name:"Gis3dmap",components:{HideButton:c.Z},mixins:[p.u,m.u,g.H],props:["widgetInfo"],data(){return{layers:null,basemap:null,center:null,zoom:1}},created(){this.initAction(this.widgetInfo)},beforeDestroy(){a.Z.$off("mapInitialized")},computed:{...(0,v.Se)(["getCanvasSetting","bodyFraction"])},watch:{layers(e,i){if(i!=null){for(let n of i)this.$refs.cesiumviewer.remove(n);for(let n of e)this.$refs.cesiumviewer.add(n)}},"widgetInfo.mapLayer.toc":{handler(e){this.widgetInfo.config.options.layers=e}},"getCanvasSetting.screenZoom":{handler:function(){},immediate:!0,deep:!0},bodyFraction:{handler:function(){d.log("-----bodyFraction-----"),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH)},immediate:!0,deep:!0},"widgetInfo.attr.w":{handler:function(){setTimeout(()=>{},100)}},"widgetInfo.attr.hh":{handler:function(){setTimeout(()=>{},100)}}},mounted(){this.zoom=this.widgetInfo.config.options.zoom,this.center=this.widgetInfo.config.options.center,this.layers=this.widgetInfo.mapLayer.toc,this.widgetInfo.config.options.layers=this.layers,a.Z.$emit("register-save-event",{widget:this,handler:this.setMapInfo})},methods:{loadInfo(e){this.$refs.cesiumviewer.resizeMap();let i=!1,n=!1;this.zoom!=e.config.options.zoom&&(i=!0,this.zoom=e.config.options.zoom),this.center!=e.config.options.center&&(n=!0,this.center=e.config.options.center),(i||n)&&this.$refs.cesiumviewer.zoomTo(this.center,this.zoom),a.Z.$emit("gis3dMapReload")},reLoadInfo(e){if(this.loadInfo(e),e.mapLayer.toc){let i=[];for(let n of e.mapLayer.toc)n.url&&(n.isbase=!0,i.push(n));this.layers=i}},initAction(e){this.actionReceive(e)},actionReceive(e){e.action==null||e.action.receive==null},mapConfiged(e){let i=this,n=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(n,s=>{if(s.enabled&&s.code==i.$$global_editor.actionType.mapConfiged.code){let b=s.code+"_"+i.widgetInfo.id,u={map:e};s.paramsExtend&&s.paramsExtend.length>0&&this.getExtendParams(u,s.paramsExtend,[],[]),s.script&&s.script.enabled&&s.script.content&&(this.doConfigMap=new Function("data",s.script.content),this.doConfigMap(u)),a.Z.$emit(b,u),s.postMessage&&this.doPostMessage(u),this.actionNameList.push(b)}}),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH)},actionScale(e,i){e!=null&&i!=null&&(e==1&&i==1)},setMapInfo(){}}},r=t,y=o(68141),I=(0,y.Z)(r,h,f,!1,null,"10269d06",null),x=I.exports}}]);
