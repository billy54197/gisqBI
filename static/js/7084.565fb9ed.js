"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[7084],{98521:function(H,A,n){var N=n(75770),w=n(27966),O=n(55616),b=n.n(O),E=n(49500);A.Z={autoShow(v,L,I){let o=v;if(o.innerAutoShowInterval&&o.innerAutoShowInterval>-1&&(clearInterval(o.innerAutoShowInterval),o.innerAutoShowInterval=-1,L.dispatchAction({type:"downplay",dataIndex:o.innerAutoShowIndex}),o.innerAutoShowIndex=0),!(v&&L&&I&&I.enabled&&I.interval>0))return;let Z=I.showTip;typeof o.innerAutoShowIndex>"u"&&(o.innerAutoShowIndex=0),o.innerAutoShowInterval=setInterval(function(){let r=L.getOption(),x=0,c=0;r.series[x].data?c=r.series[x].data.length:r.dataset&&r.dataset.length>0&&(c=r.dataset[0].source.length),c!=0&&(L.dispatchAction({type:"downplay",dataIndex:o.innerAutoShowIndex}),o.innerAutoShowIndex=(o.innerAutoShowIndex+1)%c,L.dispatchAction({type:"highlight",dataIndex:o.innerAutoShowIndex}),Z&&L.dispatchAction({type:"showTip",seriesIndex:x,dataIndex:o.innerAutoShowIndex}),F(o,o.innerAutoShowIndex,x,r))},I.interval*1e3);function F(r,x,c,J){let h=r.widgetInfo;r.$$lib__.each(h.action.sendOut.actionList,p=>{if(p.enabled&&p.code==N.Z.autoHighLight.code){let P=h.dataset[h.dataset.type].dimensions,D=p.code+"_"+h.id,S={},C=[];if(h.dataset[h.dataset.type].source&&h.dataset[h.dataset.type].source.length>0&&(C=h.dataset[h.dataset.type].source[x]),S.x=r.getFieldVal(C,P,J.series[c].encode.x),S.y=r.getFieldVal(C,P,J.series[c].encode.y),r.getExtendParams(S,p.paramsExtend,C,P),p.script&&p.script.enabled){if(E.log("Execute script for "+h.name+" component to "+p.name+" component"),p.script.content==""){O.Message.warning({message:p.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}try{S=new Function("param,autoShowIndex,seriesIndex, opts",p.script.content).apply(r,[S,x,c,J])}catch($){E.error($)}}w.Z.$emit(D,S),p.postMessage&&r.doPostMessage(S)}})}}}},56279:function(H,A,n){n.d(A,{P:function(){return O}});var N=n(86892),w=n(49500);const O={mixins:[N.D],created(){},methods:{lifecycleBeforeChartsLoad(b){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&w.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),w.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let v=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[b]);if(v)return v}return b},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&w.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),w.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},97084:function(H,A,n){n.r(A),n.d(A,{default:function(){return $}});var N=function(){var e=this,i=e._self._c;return i("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:e.widgetInfo.attr}}),i("div",{ref:"lineStack",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},w=[],O=n(44513),b=n(27966),E=n(97910),v=n(56279),L=n(45061),I=n(26711),o=n(99349),Z=n(98521),F=n(75770),r=n(55616),x=n(67157),c=n(50666);const J={mixins:[x.c],data(){return{config_extend:{config:{series:[{itemStyle:{color:"#222227"}},{itemStyle:{color:"#29CC97"}}]}},filter_config:{title:JSON.parse(JSON.stringify(c.Z.charts.title)),legend:JSON.parse(JSON.stringify(c.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(c.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(c.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(c.Z.charts.xAxis)),yAxis:JSON.parse(JSON.stringify(c.Z.charts.yAxis)),series:[{itemStyle:{opacity:1,color:"rgba(76, 132, 255, 1)"}}]}}},methods:{filterPredefineColoursSchemeConfig(t,e){this.getNewConfigWithArrary(t,e,this.filter_config)}}};var h=n(49500);const p=n(29426);var P={name:"LineStack",components:{HideButton:O.Z},mixins:[E.u,v.P,L.u,I.H,o.P,J],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=p.init(this.$refs.lineStack,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let e=[],i=[],g=[],y=[];t.dataset[t.dataset.type]&&(e=t.dataset[t.dataset.type].source,i=t.dataset[t.dataset.type].dimensions,g=t.dataset[t.dataset.type].dimensionsAlias,y=t.dataset[t.dataset.type].encode),this.dimensionsEx=i,this.dimensionsAliasEx=g;let a=JSON.parse(JSON.stringify(t.config.series)),U=JSON.parse(JSON.stringify(t.config.toolbox)),k=this.getTooltip(t.config.tooltip),f=JSON.parse(JSON.stringify(t.config.legend)),u=JSON.parse(JSON.stringify(t.config.title)),M=JSON.parse(JSON.stringify(t.config.grid)),l=JSON.parse(JSON.stringify(t.config.xAxis)),d=JSON.parse(JSON.stringify(t.config.yAxis));for(let s=0;s<a.length;s++){a[s].dimensions=i,a[s].type="line",a[s].lineWidth&&(a[s].lineWidth=a[s].lineWidth+"%"),a[s].name||(a[s].name=this.getLegendData(g,a[s].encode.y),t.config.series[s].name=a[s].name);let G={},B=[],R=[];for(let m=a[s].dimensions.length-1;m>-1;--m)G[i[m]]=m;for(let m=0;m<e.length;++m){let T=e[m];B.push(T[G[y.y[s]]]||""),R.push(T[G[y.x]]||"")}if(a[s].data=B,l.data=R,a[s].emphasis)try{if(a[s].emphasis.script&&a[s].emphasis.script.enabled){if(a[s].emphasis.script.content)try{let m=this,T=new Function("index","item","data",a[s].emphasis.script.content);a[s].data.forEach((W,K)=>{let j=T.call(m,K,W,B);a[s].data[K]={value:W,emphasis:j}})}catch(m){h.error("\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u811A\u672C\u62A5\u9519\uFF1A",m)}}else a[s].emphasis.itemStyle&&a[s].emphasis.itemStyle.color&&(a[s].emphasis={itemStyle:{...a[s].emphasis.itemStyle}})}catch(m){h.error("\u5904\u7406\u9AD8\u4EAE\u6837\u5F0F\u62A5\u9519\uFF1A",m)}}let z={color:this.$$global_editor.predefineColors,tooltip:k,toolbox:U,title:{show:u.show,text:u.text,link:u.link,textAlign:u.textAlign,left:u.left+"%",right:u.right+"%",top:u.top+"%",bottom:u.bottom+"%",textStyle:{fontSize:u.textStyle.fontSize,fontFamily:u.textStyle.fontFamily,color:u.textStyle.color}},legend:{show:f.show,type:f.type,itemWidth:f.itemWidth,itemHeight:f.itemHeight,icon:f.icon,orient:f.orient,align:f.align,itemGap:f.itemGap,left:f.left+"%",right:f.right+"%",top:f.top+"%",bottom:f.bottom+"%",textStyle:{fontSize:f.textStyle.fontSize,fontFamily:f.textStyle.fontFamily,color:f.textStyle.color}},grid:{left:M.left+"%",right:M.right+"%",top:M.top+"%",bottom:M.bottom+"%"},xAxis:[{type:"category",show:l.show,name:l.name,data:l.data,nameLocation:l.nameLocation,boundaryGap:l.boundaryGap,nameGap:l.nameGap,axisLine:{show:l.axisLine.show,lineStyle:{color:l.axisLine.lineStyle.color}},axisTick:{show:l.axisTick.show},axisLabel:{interval:l.axisLabel.interval,show:l.axisLabel.show,rotate:l.axisLabel.rotate,margin:l.axisLabel.margin,fontSize:l.axisLabel.fontSize,fontFamily:l.axisLabel.fontFamily,color:l.axisLabel.color},splitLine:l.splitLine}],yAxis:[{type:"value",show:d.show,name:d.name,nameLocation:d.nameLocation,nameGap:d.nameGap,max:d.max,min:d.min,axisLine:{show:d.axisLine.show,lineStyle:{color:d.axisLine.lineStyle.color}},axisTick:{show:d.axisTick.show},axisLabel:{show:d.axisLabel.show,rotate:d.axisLabel.rotate,margin:d.axisLabel.margin,fontSize:d.axisLabel.fontSize,fontFamily:d.axisLabel.fontFamily,color:d.axisLabel.color},splitLine:d.splitLine}],dataset:{source:e,sourceHeader:!1},series:a};this.getAnimation(z,t),this.setOption(z,t),this.setAnimationLoop(t,()=>{this.setOption(z,t)})},setOption(t,e){this.echarts.getOption()&&this.echarts.clear(),setTimeout(()=>{this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0}),Z.Z.autoShow(this,this.echarts,e.config.autoShow)},0)},reLoadInfo(t){this.mergeConfig(t),t&&(this.$refs.lineStack.style.width=t.attr.w+"px",this.$refs.lineStack.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,e){let i=this.$$lib__.find(t,g=>g.name==e);return i?i.alias&&i.alias!=""?i.alias:i.name:""},getEmphasisStyle(t){let e=null;return t.pureColor&&(e=t.pureColor),e},getItemStyleColor(t){let e=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?e=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(e=new p.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),e},getItemStyleBarBorderRadius(t){let e=[];return e.push(t.lt),e.push(t.rt),e.push(t.rb),e.push(t.lb),e},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let e=this;this.$$lib__.each(t.action.sendOut.actionList,i=>{if(i.enabled){let g=i.code+"_"+t.id;if(i.paramsExtend&&i.paramsExtend.length>0){let y={};this.getParamsExtend(y,i.paramsExtend,t)}i.code==F.Z.click.code&&e.onClick(g,i)}})},onClick(t,e){let i=this;i.echarts.on("click",g=>{let y={},a=i.getValue(g.seriesName,g.data);if(y.x=g.name||g.value,y.y=a,e.script&&e.script.enabled){if(h.log("Execute script for "+i.widgetInfo.name+" component to "+F.Z[e.code].name+" component"),e.script.content==""){r.Message.warning({message:F.Z[e.code].name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",e.script.content),y=this.customScript(y)}b.Z.$emit(t,y),e.postMessage&&i.doPostMessage(y),i.actionNameList.push(t)})}}},D=P,S=n(68141),C=(0,S.Z)(D,N,w,!1,null,"b1e51ee8",null),$=C.exports}}]);
