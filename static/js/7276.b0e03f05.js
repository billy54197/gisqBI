"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[7276],{907276:function(W,l,d){d.r(l),d.d(l,{default:function(){return f}});var x=function(){var t=this,a=t._self._c;return a("div",[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"70px","label-position":"right",model:t.currentWidget.dataset}},[a("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[a("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B"},on:{change:t.changeDatasetType},model:{value:t.currentWidget.dataset.type,callback:function(i){t.$set(t.currentWidget.dataset,"type",i)},expression:"currentWidget.dataset.type"}},t._l(t.$$global_editor.dataSourcTypeList3,function(i){return a("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),a("el-form-item",{attrs:{label:"x\u8F74"}},[a("el-select",{ref:"encodeX",attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9X\u8F74\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:t.changeX},model:{value:t.currentWidget.dataset[t.currentWidget.dataset.type].encode.x,callback:function(i){t.$set(t.currentWidget.dataset[t.currentWidget.dataset.type].encode,"x",i)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.x"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(i){return a("el-option",{key:i.name,attrs:{label:i.alias!=""?i.alias:i.name,value:i.name}})}),1)],1),a("el-collapse",[a("el-collapse-item",[a("template",{slot:"title"},[a("div",{staticClass:"my-title"},[t._v(" X\u8F74\u5B57\u6BB5\u8BBE\u7F6E")])]),a("div",{staticClass:"my-collapse-chart"},[a("el-form",{attrs:{size:"mini",model:t.currentWidget.dataset,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"\u6DFB\u52A0\u5B57\u6BB5"}},[a("el-tooltip",{attrs:{content:"\u6DFB\u52A0x\u8F74\u5B57\u6BB5","open-delay":1e3,effect:"dark",placement:"top"}},[a("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(i){return t.addX()}}})],1)],1),t._l(t.x.xAxisEdit,function(i,n){return a("div",{key:n},[a("el-form-item",{attrs:{label:"\u5B57\u6BB5 "+(n+1)}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},on:{input:t.getConfigData},model:{value:i.data,callback:function(r){t.$set(i,"data",r)},expression:"item.data"}}),a("el-tooltip",{attrs:{content:"\u79FB\u9664\u67F1\u5B50","open-delay":1e3,effect:"dark",placement:"top"}},[a("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.deleteX(n)}}})],1)],1),a("el-form-item",{attrs:{label:"\u5B57\u6BB5\u987A\u5E8F"}},[a("el-input-number",{staticClass:"my-style-number",staticStyle:{width:"150px","margin-bottom":"10px"},attrs:{placeholder:"\u5B57\u6BB5\u987A\u5E8F","controls-position":"right",step:1,min:1},on:{change:t.changeOrderX},model:{value:i.order,callback:function(r){t.$set(i,"order",r)},expression:"item.order"}})],1)],1)})],2)],1)],2)],1),a("el-form-item",{attrs:{label:"y\u8F74"}},[a("el-select",{ref:"encodeY",attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9Y\u8F74\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:t.changeY},model:{value:t.currentWidget.dataset[t.currentWidget.dataset.type].encode.y,callback:function(i){t.$set(t.currentWidget.dataset[t.currentWidget.dataset.type].encode,"y",i)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.y"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(i){return a("el-option",{key:i.name,attrs:{label:i.alias!=""?i.alias:i.name,value:i.name}})}),1)],1),a("el-collapse",[a("el-collapse-item",[a("template",{slot:"title"},[a("div",{staticClass:"my-title"},[t._v(" Y\u8F74\u5B57\u6BB5\u8BBE\u7F6E")])]),a("div",{staticClass:"my-collapse-chart"},[a("el-form",{attrs:{size:"mini",model:t.currentWidget.dataset,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"\u6DFB\u52A0\u5B57\u6BB5"}},[a("el-tooltip",{attrs:{content:"\u6DFB\u52A0y\u8F74\u5B57\u6BB5","open-delay":1e3,effect:"dark",placement:"top"}},[a("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(i){return t.addY()}}})],1)],1),t._l(t.y.yAxisEdit,function(i,n){return a("div",{key:n},[a("el-form-item",{attrs:{label:"\u5B57\u6BB5 "+(n+1)}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},on:{input:t.getConfigData},model:{value:i.data,callback:function(r){t.$set(i,"data",r)},expression:"item.data"}}),a("el-tooltip",{attrs:{content:"\u79FB\u9664\u67F1\u5B50","open-delay":1e3,effect:"dark",placement:"top"}},[a("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.deleteY(n)}}})],1)],1),a("el-form-item",{attrs:{label:"\u5B57\u6BB5\u987A\u5E8F"}},[a("el-input-number",{staticClass:"my-style-number",staticStyle:{width:"150px","margin-bottom":"10px"},attrs:{placeholder:"\u5B57\u6BB5\u987A\u5E8F","controls-position":"right",step:1,min:1},on:{change:t.changeOrderY},model:{value:i.order,callback:function(r){t.$set(i,"order",r)},expression:"item.order"}})],1)],1)})],2)],1)],2)],1),a("el-form-item",{attrs:{label:"\u6570\u636E"}},[a("el-select",{ref:"encodeY",attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u8981\u53CD\u5E94\u7684\u5B57\u6BB5"},on:{change:t.getConfigData},model:{value:t.currentWidget.dataset[t.currentWidget.dataset.type].encode.data,callback:function(i){t.$set(t.currentWidget.dataset[t.currentWidget.dataset.type].encode,"data",i)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.data"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(i){return a("el-option",{key:i.name,attrs:{label:i.alias!=""?i.alias:i.name,value:i.name}})}),1)],1),a("setting-dataset",{ref:"settingDataset",attrs:{currentWidget:t.currentWidget},on:{getDataSetData:t.getConfigData,clearDynamicEncode:t.clearDynamicEncode}})],1)],1)},h=[],p=d(589908),u=d(723400),y={name:"heatmap-cartesian-data",components:{SettingDataset:p.Z},props:["currentWidget"],mixins:[u.j],data(){return{x:{xAxis:{},xAxisEdit:[]},y:{yAxis:{},yAxisEdit:[]}}},mounted(){this.loadInfo(this.currentWidget)},methods:{loadInfo(e){this.x.xAxis=this.unique(e.dataset[e.dataset.type].source,e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode,"xAxis"),this.x.xAxisEdit=this.getAxisEdit(this.x.xAxis),this.y.yAxis=this.unique(e.dataset[e.dataset.type].source,e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode,"yAxis"),this.y.yAxisEdit=this.getAxisEdit(this.y.yAxis),this.getConfigData()},changeOrderX(){let e=[];for(let t=0;t<this.x.xAxis.length;t++)e[t]={xAxis:this.x.xAxis[t],xAxisEdit:this.x.xAxisEdit[t].data,order:this.x.xAxisEdit[t].order};e=this.$$lib__.sortBy(e,"order");for(let t=0;t<e.length;t++)this.x.xAxis[t]=e[t].xAxis,this.x.xAxisEdit[t].data=e[t].xAxisEdit,this.x.xAxisEdit[t].order=e[t].order;this.getConfigData()},changeOrderY(){let e=[];for(let t=0;t<this.y.yAxis.length;t++)e[t]={yAxis:this.y.yAxis[t],yAxisEdit:this.y.yAxisEdit[t].data,order:this.y.yAxisEdit[t].order};e=this.$$lib__.sortBy(e,"order");for(let t=0;t<e.length;t++)this.y.yAxis[t]=e[t].yAxis,this.y.yAxisEdit[t].data=e[t].yAxisEdit,this.y.yAxisEdit[t].order=e[t].order;this.getConfigData()},addX(){this.x.xAxis.push(""),this.x.xAxisEdit.push({data:"",order:this.x.xAxisEdit.length+1}),this.getConfigData()},deleteX(e){this.x.xAxis.splice(e,1),this.x.xAxisEdit.splice(e,1),this.getConfigData()},addY(){this.y.yAxis.push(""),this.y.yAxisEdit.push({data:"",order:this.y.yAxisEdit.length+1}),this.getConfigData()},deleteY(e){this.y.yAxis.splice(e,1),this.y.yAxisEdit.splice(e,1),this.getConfigData()},setSeriesList(){this.currentWidget.dataset[this.currentWidget.dataset.type].xAxis.data=this.x.xAxis,this.currentWidget.dataset[this.currentWidget.dataset.type].yAxis.data=this.y.yAxis,this.currentWidget.dataset[this.currentWidget.dataset.type].xAxis.dataEdit=this.getAxis(this.x.xAxisEdit),this.currentWidget.dataset[this.currentWidget.dataset.type].yAxis.dataEdit=this.getAxis(this.y.yAxisEdit)},changeDatasetType(){this.loadInfo(this.currentWidget),this.$refs.settingDataset.loadPreview(),this.getConfigData()},changeX(){let e=this.currentWidget.dataset;this.x.xAxis=this.unique(e[e.type].source,e[e.type].dimensions,e[e.type].encode,"xAxis"),this.x.xAxisEdit=this.getAxisEdit(this.x.xAxis),e[e.type].xAxis.name=this.getAliasName(e[e.type].dimensionsAlias,e[e.type].encode.x),e[e.type].xAxis.data=this.x.xAxis,this.getConfigData()},changeY(){let e=this.currentWidget.dataset;this.y.yAxis=this.unique(e[e.type].source,e[e.type].dimensions,e[e.type].encode,"yAxis"),this.y.yAxisEdit=this.getAxisEdit(this.y.yAxis),e[e.type].yAxis.name=this.getAliasName(e[e.type].dimensionsAlias,e[e.type].encode.y),e[e.type].yAxis.data=this.y.yAxis,this.getConfigData()},getAliasName(e,t){let a="";for(let i=0;i<e.length;i++)e[i].name==t&&(a=e[i].alias);return a},getAxisEdit(e){let t=[];for(let a=0;a<e.length;a++)t[a]={data:e[a],order:a+1};return t},getAxis(e){let t=[];for(let a=0;a<e.length;a++)t[a]=e[a].data;return t},unique(e,t,a,i){let n=[],r=[],o,c;for(let s=0;s<t.length;s++)t[s]===a.x&&(o=s),t[s]===a.y&&(c=s);if(i=="xAxis"){for(let s=0;s<e.length;s++)n.push(e[s][o]);r=Array.from(new Set(n))}else if(i=="yAxis"){for(let s=0;s<e.length;s++)n.push(e[s][c]);r=Array.from(new Set(n))}return r},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.data=null}}},g=y,m=d(768141),A=(0,m.Z)(g,x,h,!1,null,"4529b95e",null),f=A.exports}}]);
