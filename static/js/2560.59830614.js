"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2560],{56279:function(S,d,a){a.d(d,{P:function(){return l}});var f=a(86892),c=a(49500);const l={mixins:[f.D],created(){},methods:{lifecycleBeforeChartsLoad(g){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&c.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let p=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[g]);if(p)return p}return g},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&c.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),c.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},53204:function(S,d,a){a.d(d,{f:function(){return f}});var f={inject:{vanField:{default:null}},watch:{value:function(){var l=this.vanField;l&&(l.resetValidation(),l.validateWithTrigger("onChange"))}},created:function(){var l=this.vanField;l&&!l.children&&(l.children=this)}}},10194:function(S,d,a){a.d(d,{I:function(){return c}});var f=a(82051);function c(l){return Array.isArray(l)?l.map(function(g){return c(g)}):typeof l=="object"?(0,f.n)({},l):l}},44513:function(S,d,a){a.d(d,{Z:function(){return H}});var f=function(){var o=this,m=o._self._c;return o.attr.buttonHide?m("div",{style:{position:"absolute",right:o.attr.buttonHideRight+"px",top:o.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(y){return o.onHide()}}},[o.openTooltip?m("el-tooltip",{attrs:{"open-delay":1e3,content:o.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[m("el-button",{class:o.attr.buttonHideIconClass&&o.attr.buttonHideIconClass!=""?o.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:o.attr.buttonHideColor,fontSize:o.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):m("el-button",{class:o.attr.buttonHideIconClass&&o.attr.buttonHideIconClass!=""?o.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:o.attr.buttonHideColor,fontSize:o.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):o._e()},c=[],l=a(52246),g={props:["attr"],name:"hide-button",data(){return{isPc:l.b}},computed:{openTooltip:function(){let I=!1,o=this.attr.buttonHideTooltipContent;return l.b&&o&&o!=null&&o.trim()!=""&&(I=!0),I}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},b=g,p=a(68141),E=(0,p.Z)(b,f,c,!1,null,"bf399b9a",null),H=E.exports},92560:function(S,d,a){a.r(d),a.d(d,{default:function(){return q}});var f=function(){var t=this,i=t._self._c;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],staticClass:"my-div",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:t.widgetInfo.attr}}),i("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:t.widgetInfo.config.vertical?"row":"column",justifyContent:"center"}},[i("slider",{attrs:{max:t.widgetInfo.config.max,min:t.widgetInfo.config.min,step:t.widgetInfo.config.step,"bar-height":t.widgetInfo.config.barHeight,"button-size":t.widgetInfo.config.buttonSize,"active-color":t.widgetInfo.config.activeColor,"inactive-color":t.widgetInfo.config.inactiveColor,range:t.widgetInfo.config.range,disabled:t.widgetInfo.config.disabled,vertical:t.widgetInfo.config.vertical},on:{input:t.valueChange,change:t.changeDone},model:{value:t.value,callback:function(r){t.value=r},expression:"value"}})],1)],1)},c=[],l=a(86569),g=a(39733),b=a(95982),p=a(10194),E=a(50068),H=a(34672),I=a(53204),o=(0,g.d)("slider"),m=o[0],y=o[1],T=function(t,i){return JSON.stringify(t)===JSON.stringify(i)},B=m({mixins:[H.D,I.f],props:{disabled:Boolean,vertical:Boolean,range:Boolean,barHeight:[Number,String],buttonSize:[Number,String],activeColor:String,inactiveColor:String,min:{type:[Number,String],default:0},max:{type:[Number,String],default:100},step:{type:[Number,String],default:1},value:{type:[Number,Array],default:0}},data:function(){return{dragStatus:""}},computed:{scope:function(){return this.max-this.min},buttonStyle:function(){if(this.buttonSize){var t=(0,b.N)(this.buttonSize);return{width:t,height:t}}}},created:function(){this.updateValue(this.value)},mounted:function(){this.range?(this.bindTouchEvent(this.$refs.wrapper0),this.bindTouchEvent(this.$refs.wrapper1)):this.bindTouchEvent(this.$refs.wrapper)},methods:{onTouchStart:function(t){this.disabled||(this.touchStart(t),this.currentValue=this.value,this.range?this.startValue=this.value.map(this.format):this.startValue=this.format(this.value),this.dragStatus="start")},onTouchMove:function(t){if(!this.disabled){this.dragStatus==="start"&&this.$emit("drag-start"),(0,E.PF)(t,!0),this.touchMove(t),this.dragStatus="draging";var i=this.$el.getBoundingClientRect(),r=this.vertical?this.deltaY:this.deltaX,n=this.vertical?i.height:i.width,s=r/n*this.scope;this.range?this.currentValue[this.index]=this.startValue[this.index]+s:this.currentValue=this.startValue+s,this.updateValue(this.currentValue)}},onTouchEnd:function(){this.disabled||(this.dragStatus==="draging"&&(this.updateValue(this.currentValue,!0),this.$emit("drag-end")),this.dragStatus="")},onClick:function(t){if(t.stopPropagation(),!this.disabled){var i=this.$el.getBoundingClientRect(),r=this.vertical?t.clientY-i.top:t.clientX-i.left,n=this.vertical?i.height:i.width,s=+this.min+r/n*this.scope;if(this.range){var u=this.value,x=u[0],V=u[1],F=(x+V)/2;s<=F?x=s:V=s,s=[x,V]}this.startValue=this.value,this.updateValue(s,!0)}},handleOverlap:function(t){return t[0]>t[1]?(t=(0,p.I)(t),t.reverse()):t},updateValue:function(t,i){this.range?t=this.handleOverlap(t).map(this.format):t=this.format(t),T(t,this.value)||this.$emit("input",t),i&&!T(t,this.startValue)&&this.$emit("change",t)},format:function(t){return Math.round(Math.max(this.min,Math.min(t,this.max))/this.step)*this.step}},render:function(){var t,i=this,r,n=arguments[0],s=this.vertical,u=s?"height":"width",x=s?"width":"height",V=(t={background:this.inactiveColor},t[x]=(0,b.N)(this.barHeight),t),F=function(){var h=i.value,C=i.min,v=i.range,w=i.scope;return v?(h[1]-h[0])*100/w+"%":(h-C)*100/w+"%"},$=function(){var h=i.value,C=i.min,v=i.range,w=i.scope;return v?(h[0]-C)*100/w+"%":null},A=(r={},r[u]=F(),r.left=this.vertical?null:$(),r.top=this.vertical?$():null,r.background=this.activeColor,r);this.dragStatus&&(A.transition="none");var M=function(h){var C=["left","right"],v=typeof h=="number",w=function(){return v?"button-wrapper-"+C[h]:"button-wrapper"},_=function(){return v?"wrapper"+h:"wrapper"};return n("div",{ref:_(),attrs:{role:"slider",tabindex:i.disabled?-1:0,"aria-valuemin":i.min,"aria-valuenow":i.value,"aria-valuemax":i.max,"aria-orientation":i.vertical?"vertical":"horizontal"},class:y(w()),on:{touchstart:function(){v&&(i.index=h)},click:function(tt){return tt.stopPropagation()}}},[i.slots("button")||n("div",{class:y("button"),style:i.buttonStyle})])};return n("div",{style:V,class:y({disabled:this.disabled,vertical:s}),on:{click:this.onClick}},[n("div",{class:y("bar"),style:A},[this.range?[M(0),M(1)]:M()])])}}),D=a(44513),P=a(91673),Z=a(67157);const j={mixins:[Z.c],data(){return{config_extend:{config:{}},filter_config:{activeColor:"#4C84FF",inactiveColor:"#BFCBD9"}}},methods:{filterPredefineColoursSchemeConfig(e,t){this.getNewConfigWithArrary(e,t,this.filter_config)}}};var W=a(45061),J=a(23400),K=a(86892),U=a(26711),X=a(56279),L=a(27966),R=a(55616),N=a(49500),Y={name:"form-slider",props:["widgetInfo"],components:{HideButton:D.Z,Slider:B},mixins:[P.u,j,W.u,J.j,K.D,U.H,X.P],data(){return{value:20}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)},"widgetInfo.config.init":function(){this.resolveRange()},"widgetInfo.config.range":function(){this.resolveRange()},"widgetInfo.config.initRangeLeft":function(){this.resolveRange()},"widgetInfo.config.initRangeRight":function(){this.resolveRange()}},methods:{loadInfo(e){if(e.dataset[e.dataset.type]&&e.dataset[e.dataset.type].dimensions&&e.dataset[e.dataset.type].dimensions.length>0&&(this.value=this.getFieldVal(e.dataset[e.dataset.type].source[0],e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode.value),e.config.range)){const t=this.getFieldVal(e.dataset[e.dataset.type].source[0],e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode.leftValue),i=this.getFieldVal(e.dataset[e.dataset.type].source[0],e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode.rightValue);this.value=[t,i]}this.lifecycleAfterLoad()},reLoadInfo(e){this.loadInfo(e)},emitChange(e,t){let i=this,r=i.widgetInfo.action.sendOut.actionList;this.$$lib__.each(r,n=>{if(n.enabled&&n.code==t){let s=t+"_"+i.widgetInfo.id,u=e;if(n.paramsExtend&&n.paramsExtend.length>0&&this.getExtendParams(u,n.paramsExtend),n.script&&n.script.enabled){if(N.log("Execute script for "+this.widgetInfo.name+" component to "+n.name+" component"),n.script.content==""){R.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",n.script.content),u=this.customScript(u)}L.Z.$emit(s,u),n.postMessage&&this.doPostMessage(u),i.actionNameList.push(s)}})},valueChange(e){this.emitChange({value:e},"change")},changeDone(e){this.emitChange({value:e},"done")},initAction(e){this.actionReceive(e),this.sliderReceive(e)},sliderReceive(e){if(e.action===void 0||e.action.receive===void 0)return;let t=e.action.receive.setValue;if(t&&t.enabled){let n=t.widgetList;this.doSetValue(n,e)}let i=e.action.receive.setLeftValue;if(i&&i.enabled){let n=i.widgetList;this.doSetLeftValue(n,e)}let r=e.action.receive.setRightValue;if(r&&r.enabled){let n=r.widgetList;this.doSetRightValue(n,e)}},doSetValue(e,t){e&&e.length>0&&e.forEach(i=>{if(i&&i.length<1)return;let r=i[0][1]+"_"+i[0][0];i[0][1].indexOf("_")>-1&&(r=i[0][1]);let n=i[0][2];if(n){let s=n.indexOf("|");s>-1&&(n=i[0][2].substring(s+1))}L.Z.$on(r,s=>{if(t.action.receive.setValue.script&&t.action.receive.setValue.script.enabled){if(N.log("Execute script for "+this.widgetInfo.name+" component to "+i.name+" component"),t.action.receive.setValue.script.content==""){R.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.setValue=new Function("param","param_key",t.action.receive.setValue.script.content)}this.setValue(s,n)})})},doSetLeftValue(e,t){e&&e.length>0&&e.forEach(i=>{if(i&&i.length<1)return;let r=i[0][1]+"_"+i[0][0];i[0][1].indexOf("_")>-1&&(r=i[0][1]);let n=i[0][2];if(n){let s=n.indexOf("|");s>-1&&(n=i[0][2].substring(s+1))}L.Z.$on(r,s=>{if(t.action.receive.setLeftValue.script&&t.action.receive.setLeftValue.script.enabled){if(N.log("Execute script for "+this.widgetInfo.name+" component to "+i.name+" component"),t.action.receive.setLeftValue.script.content==""){R.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.setLeftValue=new Function("param","param_key",t.action.receive.setLeftValue.script.content)}this.setLeftValue(s,n)})})},doSetRightValue(e,t){e&&e.length>0&&e.forEach(i=>{if(i&&i.length<1)return;let r=i[0][1]+"_"+i[0][0];i[0][1].indexOf("_")>-1&&(r=i[0][1]);let n=i[0][2];if(n){let s=n.indexOf("|");s>-1&&(n=i[0][2].substring(s+1))}L.Z.$on(r,s=>{if(t.action.receive.setRightValue.script&&t.action.receive.setRightValue.script.enabled){if(N.log("Execute script for "+this.widgetInfo.name+" component to "+i.name+" component"),t.action.receive.setRightValue.script.content==""){R.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.setRightValue=new Function("param","param_key",t.action.receive.setRightValue.script.content)}this.setRightValue(s,n)})})},setValue(e,t){(typeof e[t]=="number"||typeof e[t]=="string")&&Number(e[t])>this.widgetInfo.config.max||Array.isArray(e[t])&&(Number(e[t][1])>this.widgetInfo.config.max||Number(e[t][0])<this.widgetInfo.config.min)||(this.value=e[t],this.valueChange(this.value),this.changeDone(this.value))},setLeftValue(e,t){this.widgetInfo.config.range&&((typeof e[t]=="number"||typeof e[t]=="string")&&Number(e[t])<this.widgetInfo.config.min||(this.value=[e[t],this.value[1]],this.valueChange(this.value),this.changeDone(this.value)))},setRightValue(e,t){this.widgetInfo.config.range&&((typeof e[t]=="number"||typeof e[t]=="string")&&Number(e[t])>this.widgetInfo.config.max||(this.value=[this.value[0],e[t]],this.valueChange(this.value),this.changeDone(this.value)))},resolveRange(){this.widgetInfo.config.range?this.value=[this.widgetInfo.config.initRangeLeft,this.widgetInfo.config.initRangeRight]:this.value=this.widgetInfo.config.init}},mounted(){this.show=!0,this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo),this.resolveRange()}},G=Y,Q=a(68141),k=(0,Q.Z)(G,f,c,!1,null,"05cc1fec",null),q=k.exports}}]);
