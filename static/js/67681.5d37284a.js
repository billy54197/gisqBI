"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[67681],{367681:function(v,c,r){r.r(c),r.d(c,{default:function(){return W}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-div"},[t("el-form",{ref:"form",attrs:{size:"mini","label-width":"90px","label-position":"right",model:e.currentWidget.dataset}},[t("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[t("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B"},on:{change:e.changeDatasetType},model:{value:e.currentWidget.dataset.type,callback:function(s){e.$set(e.currentWidget.dataset,"type",s)},expression:"currentWidget.dataset.type"}},e._l(this.$$global_editor.dataSourcTypeList3,function(s){return t("el-option",{key:s.value,attrs:{label:s.label,value:s.value}})}),1)],1),t("vue-lazy-component",[t("el-form-item",{attrs:{label:"x\u8F74"}},[t("el-select",{attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9X\u8F74\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:e.changeX},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.x,callback:function(s){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"x",s)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.x"}},e._l(this.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(s){return t("el-option",{key:s.name,attrs:{label:s.alias!=""?s.alias:s.name,value:s.name}})}),1)],1),t("el-divider",{attrs:{"content-position":"left"}},[e._v("y\u8F74\uFF08\u5DE6\u4FA7\uFF09")]),t("el-form-item",[t("el-tooltip",{attrs:{content:"\u6DFB\u52A0\u67F1\u5B50/\u6298\u7EBF",effect:"dark",placement:"top","open-delay":1e3}},[t("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"150px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(s){return e.addY(0)}}})],1)],1),e._l(e.seriesList0,function(s,n){return t("el-form-item",{key:"static0"+n,attrs:{label:"\u67F1\u5B50/\u6298\u7EBF"+(n+1)}},[t("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u67F1\u5B50/\u6298\u7EBF\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:function(a){return e.changeY(n,0)}},model:{value:s.encode.y,callback:function(a){e.$set(s.encode,"y",a)},expression:"ser.encode.y"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(a){return t("el-option",{key:a.name,attrs:{label:a.alias!=""?a.alias:a.name,value:a.name}})}),1),t("el-tooltip",{attrs:{content:"\u79FB\u9664\u67F1\u5B50/\u6298\u7EBF",effect:"dark",placement:"top","open-delay":1e3}},[t("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteY(n,0)}}})],1)],1)}),t("el-divider",{attrs:{"content-position":"left"}},[e._v("y\u8F74\uFF08\u53F3\u4FA7\uFF09")]),t("el-form-item",[t("el-tooltip",{attrs:{content:"\u6DFB\u52A0\u67F1\u5B50/\u6298\u7EBF",effect:"dark",placement:"top","open-delay":1e3}},[t("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"150px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(s){return e.addY(1)}}})],1)],1),e._l(e.seriesList1,function(s,n){return t("el-form-item",{key:"static1"+n,attrs:{label:"\u67F1\u5B50/\u6298\u7EBF"+(n+1)}},[t("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u67F1\u5B50/\u6298\u7EBF\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:function(a){return e.changeY(n,1)}},model:{value:s.encode.y,callback:function(a){e.$set(s.encode,"y",a)},expression:"ser.encode.y"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(a){return t("el-option",{key:a.name,attrs:{label:a.alias!=""?a.alias:a.name,value:a.name}})}),1),t("el-tooltip",{attrs:{content:"\u79FB\u9664\u67F1\u5B50/\u6298\u7EBF",effect:"dark",placement:"top","open-delay":1e3}},[t("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteY(n,1)}}})],1)],1)})],2),t("setting-dataset",{ref:"settingDataset",attrs:{currentWidget:e.currentWidget},on:{getDataSetData:e.getConfigData,clearDynamicEncode:e.clearDynamicEncode}})],1)],1)},d=[],o=r(589908),u=r(846577),h=r(723400),g=r(828309),p={name:"bar-stack-data",props:["currentWidget"],components:{SettingDataset:o.Z},mixins:[g.baseConfig,h.j],computed:{seriesList0:function(){return this.getSeriesList(this.currentWidget.config.series,0)},seriesList1:function(){return this.getSeriesList(this.currentWidget.config.series,1)}},methods:{changeDatasetType(){this.$refs.settingDataset.loadPreview(),this.clearDynamicEncode(),this.initName(this.seriesList0),this.initName(this.seriesList1),this.getConfigData()},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y={0:[],1:[]},this.$$lib__.each(this.seriesList0,i=>{i.encode.x="",i.encode.y=""}),this.$$lib__.each(this.seriesList1,i=>{i.encode.x="",i.encode.y=""}),this.$$lib__.each(this.currentWidget.config.series,i=>{i.encode.x="",i.encode.y=""})},addY(i){let e=JSON.parse(JSON.stringify(u.Z.charts.bar.bar_line_mix.config.series[0]));e.encode={x:"",y:""},e.yAxisIndex=i,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x&&(e.encode.x=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[i].push(""),i==0?this.seriesList0.push(JSON.parse(JSON.stringify(e))):i==1&&this.seriesList1.push(JSON.parse(JSON.stringify(e))),this.getConfigData()},deleteY(i,e){let t=[];e==0?this.seriesList0.splice(i,1):e==1&&this.seriesList1.splice(i,1),t=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e],t.splice(i,1),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e]=t,this.getConfigData()},changeX(){this.$$lib__.each(this.seriesList0,i=>{i.encode.x=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x}),this.$$lib__.each(this.seriesList1,i=>{i.encode.x=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x}),this.getConfigData()},changeY(i,e){let t=[],s=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias;e==0?(t=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e],t.splice(i,1,this.seriesList0[i].encode.y),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e]=t,this.seriesList0[i].name=this.getLegendData(s,this.seriesList0[i].encode.y)):e==1&&(t=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e],t.splice(i,1,this.seriesList1[i].encode.y),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e]=t,this.seriesList1[i].name=this.getLegendData(s,this.seriesList1[i].encode.y)),this.getConfigData()},getLegendData(i,e){let t=this.$$lib__.find(i,s=>s.name==e);return t?t.alias&&t.alias!=""?t.alias:t.name:""},initName(i){let e=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias;this.$$lib__.each(i,t=>{let s=t.encode.y,n=this.$$lib__.find(e,a=>a.name==s);n?t.name=n.alias:t.name=""})},getSeriesList(i,e){let t=[];return this.$$lib__.each(i,s=>{s.yAxisIndex==e&&t.push(JSON.parse(JSON.stringify(s)))}),t},setSeriesList(){this.currentWidget.config.series=this.$$lib__.union(this.seriesList0,this.seriesList1)}}},y=p,f=r(768141),m=(0,f.Z)(y,l,d,!1,null,"7a8b39af",null),W=m.exports}}]);
