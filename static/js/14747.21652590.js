"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[14747],{214747:function(_,p,d){d.r(p),d.d(p,{default:function(){return D}});var h=function(){var e=this,a=e._self._c;return a("div",[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"70px","label-position":"right",model:e.currentWidget.dataset}},[a("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[a("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B"},on:{change:e.changeDatasetType},model:{value:e.currentWidget.dataset.type,callback:function(t){e.$set(e.currentWidget.dataset,"type",t)},expression:"currentWidget.dataset.type"}},e._l(this.$$global_editor.dataSourcTypeList3,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),a("vue-lazy-component",[a("el-form-item",{attrs:{label:"\u8282\u70B9"}},[a("el-select",{staticStyle:{"margin-bottom":"4px"},attrs:{size:"mini",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u8282\u70B9\u5B57\u6BB5"},on:{change:e.getConfigData},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.key,callback:function(t){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"key",t)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.key"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(t){return a("el-option",{key:t.name,attrs:{label:t.alias!=""?t.alias:t.name,value:t.name}})}),1)],1),a("el-form-item",{attrs:{label:"\u6307\u5411\u8282\u70B9"}},[a("el-select",{staticStyle:{"margin-bottom":"4px"},attrs:{size:"mini",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6307\u5411\u8282\u70B9\u5B57\u6BB5"},on:{change:e.getConfigData},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.linkKey,callback:function(t){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"linkKey",t)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.linkKey"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(t){return a("el-option",{key:t.name,attrs:{label:t.alias!=""?t.alias:t.name,value:t.name}})}),1)],1),a("el-form-item",{attrs:{label:"\u7EDF\u8BA1\u503C"}},[a("el-select",{staticStyle:{"margin-bottom":"4px"},attrs:{size:"mini",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u7EDF\u8BA1\u503C\u5B57\u6BB5"},on:{change:e.getConfigData},model:{value:e.currentWidget.dataset[e.currentWidget.dataset.type].encode.value,callback:function(t){e.$set(e.currentWidget.dataset[e.currentWidget.dataset.type].encode,"value",t)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.value"}},e._l(e.currentWidget.dataset[e.currentWidget.dataset.type].dimensionsAlias,function(t){return a("el-option",{key:t.name,attrs:{label:t.alias!=""?t.alias:t.name,value:t.name}})}),1)],1)],1),a("setting-dataset",{ref:"settingDataset",attrs:{currentWidget:e.currentWidget},on:{getDataSetData:e.getConfigData,clearDynamicEncode:e.clearDynamicEncode}})],1)],1)},m=[],y=d(589908),W=d(723400),f={name:"graph-simple-data",components:{SettingDataset:y.Z},mixins:[W.j],props:["currentWidget"],mounted(){},watch:{"currentWidget.dataset":{deep:!0,handler:function(){this.currentWidget.dataset.type=="static"||this.currentWidget.dataset.type=="dynamic"}}},methods:{changeDatasetType(){this.$refs.settingDataset.loadPreview(),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.key="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.linkKey="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.value="",this.getConfigData()},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.key="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.linkKey="",this.currentWidget.dataset[this.currentWidget.dataset.type].encode.value=""},getItemColor(i){let e=this,a=[];e.currentWidget.config.series.itemColor&&e.currentWidget.config.series.itemColor.length>0?a=JSON.parse(JSON.stringify(e.currentWidget.config.series.itemColor)):a=e.currentWidget.config.series.colorList,e.currentWidget.config.series.itemColor=[];let t=e.currentWidget.dataset[i].source,l=e.currentWidget.dataset[i].dimensionsAlias,o=e.currentWidget.dataset[i].encode,u=this.getDataList(o,l,t);this.$$lib__.each(u.data,(n,r)=>{if(!n.name)return;let c=a.length;if(a&&a[r]&&a[r].color)e.currentWidget.config.series.itemColor.push({name:n.name,color:a[r].color,emphasisColor:a[r].color});else{let s=e.currentWidget.config.series.colorList;e.currentWidget.config.series.itemColor.push({name:n.name,color:s[r]?s[r]:s[r%s],emphasisColor:s[r]?s[r]:s[r%s]})}})},getDataList(i,e,a){let t=null,l=null,o=null,u=[],n=[];return this.$$lib__.each(e,(r,c)=>{r.name==i.key&&(t=c),r.name==i.linkKey&&(l=c),r.name==i.value&&(o=c)}),this.$$lib__.each(a,r=>{u.push({source:r[t],target:r[l],value:r[o]}),this.$$lib__.find(n,g=>g.name==r[t])||n.push({name:r[t]}),this.$$lib__.find(n,g=>g.name==r[l])||n.push({name:r[l]})}),{links:u,data:n}}}},v=f,b=d(768141),k=(0,b.Z)(v,h,m,!1,null,"30eadb52",null),D=k.exports}}]);
