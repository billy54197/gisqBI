(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[10036],{404686:function(ht,Q,a){"use strict";a.r(Q)},946057:function(ht,Q,a){"use strict";a.r(Q)},341775:function(ht,Q,a){"use strict";var L=a(29870),i=a(985208),r=a(659791),t=a(22466),e=a(183393),n=a(105077),d=a(787879),b=a(419534);Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var j=b(a(828866)),I=b(a(342579)),R=b(a(543389)),q=b(a(122777)),K=b(a(42762));a(404686),a(946057);var x=X(a(325074)),G=b(a(68119)),_=a(439705),A=a(595031),c=a(59269),O=b(a(456865));function F(H){if(typeof d!="function")return null;var V=new d,m=new d;return(F=function(o){return o?m:V})(H)}function X(H,V){if(!V&&H&&H.__esModule)return H;if(H===null||L(H)!=="object"&&typeof H!="function")return{default:H};var m=F(V);if(m&&m.has(H))return m.get(H);var D={},o=Object.defineProperty&&e;for(var s in H)if(s!=="default"&&Object.prototype.hasOwnProperty.call(H,s)){var f=o?e(H,s):null;f&&(f.get||f.set)?Object.defineProperty(D,s,f):D[s]=H[s]}return D.default=H,m&&m.set(H,D),D}function k(H,V){var m=i(H);if(r){var D=r(H);V&&(D=t(D).call(D,function(o){return e(H,o).enumerable})),m.push.apply(m,D)}return m}function ut(H){for(var V=1;V<arguments.length;V++){var m=arguments[V]!=null?arguments[V]:{};V%2?k(Object(m),!0).forEach(function(D){(0,R.default)(H,D,m[D])}):n?Object.defineProperties(H,n(m)):k(Object(m)).forEach(function(D){Object.defineProperty(H,D,e(m,D))})}return H}var Y=function(){function H(V){var m=this,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,q.default)(this,H);var o=D.center,s=o===void 0?[111.7579,31.6736]:o,f=D.height,$=f===void 0?614914256e-2:f,N=D.projection,u=N===void 0?"EPSG:4490":N,B=D.heading,z=B===void 0?0:B,rt=D.roll,pt=rt===void 0?0:rt,dt=D.pitch,gt=dt===void 0?-90:dt,lt=(0,j.default)(D),Ct=D.duration,mt=(0,_.transformCoordinate)(s,u,"EPSG:4490"),bt=ut(ut({},A.earthDefaultConfig),{},{center:{heading:z,roll:pt,x:mt[0],y:mt[1],z:$,pitch:gt},duration:Ct});x.Map.createMap({id:V,data:bt,map2d:lt,is2d:lt?1:2,success:function(ct){(0,I.default)(this,m),this.viewer=ct}.bind(this)}),this.layerManager=this.viewer.shine.layerManager}return(0,K.default)(H,[{key:"maskGeoJson",get:function(){return this.viewer.maskGeoJson},set:function(m){this.viewer.maskGeoJson=m}},{key:"resize",value:function(){this.viewer.forceResize()}},{key:"centerAt",value:function(m){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=D.duration,s=D.projection,f=s===void 0?"EPSG:4490":s,$=this.viewer.shine.getCameraView(!0),N=$.x,u=$.y,B=$.z,z=$.heading,rt=$.roll,pt=$.pitch,dt=m.center,gt=dt===void 0?[N,u]:dt,lt=m.height,Ct=lt===void 0?B:lt,mt=m.heading,bt=mt===void 0?z:mt,xt=m.roll,ct=xt===void 0?rt:xt,$t=m.pitch,wt=$t===void 0?pt:$t,Et=(0,_.transformCoordinate)(gt,f,"EPSG:4490");this.viewer.shine.centerAt({x:Et[0],y:Et[1],z:Ct,heading:bt,roll:ct,pitch:wt},{duration:o!=null?o/1e3:void 0,isWgs84:!0})}},{key:"setExtent",value:function(m){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=D.duration,s=D.projection,f=s===void 0?"EPSG:4490":s,$=m;f!=="EPSG:4490"&&($=(0,_.transformExtent)(m,f,"EPSG:4490"));var N={xmin:$[0],ymin:$[1],xmax:$[2],ymax:$[3]};this.viewer.shine.centerAt(N,{duration:o!=null?o/1e3:void 0,isWgs84:!0})}},{key:"getExtent",value:function(){var m=this.viewer.shine.getExtent(!0);return[m.xmin,m.ymin,m.xmax,m.ymax]}},{key:"getCenter",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.x,o=m.y;return[D,o]}},{key:"getHeight",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.z;return D}},{key:"getZoom",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.z,o=this.viewer.shine.getLevel(D);return o}},{key:"getOrientation",value:function(){var m=this.viewer.shine.getCameraView(!0),D=m.heading,o=m.roll,s=m.pitch;return{heading:D,roll:o,pitch:s}}},{key:"getProjection",value:function(){return"EPSG:4490"}},{key:"addLayer",value:function(m){m.visible=!0,this.viewer.shine.addLayer(m)}},{key:"createDrawLayer",value:function(m){m.visible=!0,m.type="geojson-draw",m.drawLayerType||(m.drawLayerType=c.DRAWLAYER_TYPE),this.viewer.shine.addLayer(m)}},{key:"removeLayer",value:function(m){this.viewer.shine.removeLayer(m)}},{key:"getViewer",value:function(){return this.viewer}},{key:"olcs3dUpdate",value:function(){this.viewer.shine.ol3d.update()}},{key:"groundUnder",value:function(m){this.viewer.shine.groundUnder(m)}},{key:"groundTranslucency",value:function(m){this.viewer.shine.groundTranslucency(m)}},{key:"useTranslucencyRectangle",value:function(m){this.viewer.shine.useTranslucencyRectangle(m)}},{key:"getContainer",value:function(){return this.viewer.container}},{key:"createPopup",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=new G.default(this,m);return D}},{key:"performVideoProjection",value:function(m){this.videoProjection=new O.default(this,m),this.videoProjection.execute()}},{key:"destroyVideoProjection",value:function(){var m;(m=this.videoProjection)===null||m===void 0||m.destroy(),this.videoProjection=null}}]),H}(),it=Y;Q.default=it},68119:function(ht,Q,a){"use strict";var L=a(419534);Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var i=L(a(122777)),r=L(a(42762)),t=a(696789),e=function(){function d(b,j){(0,i.default)(this,d),this.earth=b,this.earthPopup=new t.DivPoint(this.earth.viewer,{html:j.element,offset:j.offset})}return(0,r.default)(d,[{key:"setPosition",value:function(j){this.earthPopup.setLonlat(j)}},{key:"destroy",value:function(){this.earthPopup.destroy()}}]),d}(),n=e;Q.default=n},85002:function(ht,Q,a){"use strict";var L=a(419534);Object.defineProperty(Q,"__esModule",{value:!0}),Q.default=void 0;var i=L(a(122777)),r=L(a(42762)),t=a(115998),e=function(){function d(b){(0,i.default)(this,d),this.weather=new t.Weather(b.viewer)}return(0,r.default)(d,[{key:"rain",value:function(j){j=Number(j),j===0?this.weather.removeRainStage():this.weather.rainfall(j)}},{key:"snow",value:function(j){j=Number(j),j===0?this.weather.removeSnowStage():this.weather.snowfall(j)}},{key:"removeAll",value:function(){this.weather.removeStage()}}]),d}(),n=e;Q.default=n},121120:function(ht,Q,a){var L=a(149500);ht.exports=function(i){var r={};function t(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return i[e].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=i,t.c=r,t.d=function(e,n,d){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:d})},t.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(n&1&&(e=t(e)),n&8||n&4&&typeof e=="object"&&e&&e.__esModule)return e;var d=Object.create(null);if(t.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:e}),n&2&&typeof e!="string")for(var b in e)t.d(d,b,function(j){return e[j]}.bind(null,b));return d},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/dist/",t(t.s=767)}({0:function(i,r){i.exports=a(342579)},1:function(i,r){i.exports=a(828866)},10:function(i,r){i.exports=a(42762)},11:function(i,r){i.exports=a(520314)},2:function(i,r,t){"use strict";t.d(r,"a",function(){return e});function e(n,d,b,j,I,R,q,K){var x=typeof n=="function"?n.options:n;d&&(x.render=d,x.staticRenderFns=b,x._compiled=!0),j&&(x.functional=!0),R&&(x._scopeId="data-v-"+R);var G;if(q?(G=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),I&&I.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(q)},x._ssrRegister=G):I&&(G=K?function(){I.call(this,(x.functional?this.parent:this).$root.$options.shadowRoot)}:I),G)if(x.functional){x._injectStyles=G;var _=x.render;x.render=function(O,F){return G.call(F),_(O,F)}}else{var A=x.beforeCreate;x.beforeCreate=A?[].concat(A,G):[G]}return{exports:n,options:x}}},24:function(i,r){i.exports=a(452909)},27:function(i,r){i.exports=a(578756)},37:function(i,r){i.exports=a(159602)},39:function(i,r){i.exports=a(426352)},4:function(i,r){i.exports=a(555616)},40:function(i,r){i.exports=a(230551)},41:function(i,r){i.exports=a(43586)},45:function(i,r){i.exports=a(611323)},46:function(i,r){i.exports=a(869257)},47:function(i,r){i.exports=a(110563)},5:function(i,r){i.exports=a(705146)},56:function(i,r){i.exports=a(934749)},64:function(i,r){i.exports=a(728954)},767:function(i,r,t){"use strict";t.r(r),t.d(r,"ConfigManager",function(){return mt}),t.d(r,"ConfigManagerGt",function(){return W});var e=function(){var p=this,S=p.$createElement,h=p._self._c||S;return h("div",{staticClass:"sh-config-provider"},[p.loading?h("div",{staticClass:"loading"},[p._t("loading",function(){return[h("div",{directives:[{name:"loading",rawName:"v-loading",value:p.loading,expression:"loading"}],staticClass:"default-loading"})]})],2):p._e(),p.loading?p._e():p._t("default")],2)},n=[];e._withStripped=!0;var d=t(0),b=t.n(d),j=t(11),I=t.n(j),R=t(39),q=t.n(R),K=t(40),x=t.n(K),G=t(41),_=t.n(G),A=t(56),c=t.n(A),O=t(9),F=t.n(O),X=t(10),k=t.n(X),ut=t(45),Y=t.n(ut),it=t(27),H=t.n(it),V=t(24),m=t.n(V),D=t(5),o=t.n(D),s=t(64),f=t.n(s),$=t(1),N=t.n($),u=t(8),B=t.n(u),z=t(37),rt=t(47);function pt(p,S){var h=typeof x.a<"u"&&_()(p)||p["@@iterator"];if(!h){if(Array.isArray(p)||(h=dt(p))||S&&p&&typeof p.length=="number"){h&&(p=h);var g=0,E=function(){};return{s:E,n:function(){return g>=p.length?{done:!0}:{done:!1,value:p[g++]}},e:function(tt){throw tt},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,T=!1,Z;return{s:function(){h=h.call(p)},n:function(){var tt=h.next();return v=tt.done,tt},e:function(tt){T=!0,Z=tt},f:function(){try{!v&&h.return!=null&&h.return()}finally{if(T)throw Z}}}}function dt(p,S){var h;if(p){if(typeof p=="string")return gt(p,S);var g=I()(h=Object.prototype.toString.call(p)).call(h,8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return q()(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return gt(p,S)}}function gt(p,S){(S==null||S>p.length)&&(S=p.length);for(var h=0,g=new Array(S);h<S;h++)g[h]=p[h];return g}function lt(p){return"sh-".concat(Object(rt.formatConversion)(p))}var Ct=function(){function p(S,h,g){var E=g.token,v=g.applicationId;F()(this,p),this.url=S,this.params=h,this.schemeId=h.schemeId,this.token=E,this.applicationId=v,this.isLoading=!1,this.widgetInfo=void 0,h&&(this.promise_=this._request())}return k()(p,[{key:"_request",value:function(){var h=this;return new H.a(function(g,E){var v=this;b()(this,h),Object(z.getFromAdmin)(this.url,{params:this.params,token:this.token,applicationId:this.applicationId}).then(function(T){b()(this,v);var Z=Object(z.parseResult)(T);if(Z.success){var w=this._parseWidgetInfo(Z.data);w.schemeId&&(this.schemeId=w.schemeId),g(w)}else E(Z.message)}.bind(this)).catch(function(T){b()(this,v),E(T)}.bind(this))}.bind(this))}},{key:"_parseWidgetInfo",value:function(h){var g,E=this,v,T=h,Z=m()(g=T.components).call(g,function(tt){return b()(this,E),tt.name==="ToolBar"}.bind(this));if(Z){var w=this.getTreeData(T.components,Z.id);Z.stat=!!w.length,Z.config=w}return T.components=o()(v=T.components).call(v,[{stat:!0,name:"Map"},{stat:!0,name:"Earth"},{stat:!0,name:"MapEarth"}]),T}},{key:"getWidgetInfos",value:function(){var S=c()(Y.a.mark(function g(){return Y.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.widgetInfo){v.next=12;break}if(!this.promise_){v.next=12;break}return v.prev=2,v.next=5,this.promise_;case 5:this.widgetInfo=v.sent,v.next=12;break;case 8:throw v.prev=8,v.t0=v.catch(2),L.error(v.t0),new Error(v.t0);case 12:return v.abrupt("return",this.widgetInfo?this.widgetInfo:{});case 13:case"end":return v.stop()}},g,this,[[2,8]])}));function h(){return S.apply(this,arguments)}return h}()},{key:"getConfigByKey",value:function(){var S=c()(Y.a.mark(function g(E){var v,T,Z,w;return Y.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.getWidgetInfos();case 2:if(v=C.sent,!v.config){C.next=23;break}T=pt(v.config),C.prev=5,T.s();case 7:if((Z=T.n()).done){C.next=13;break}if(w=Z.value,w.key!==E){C.next=11;break}return C.abrupt("return",w.value);case 11:C.next=7;break;case 13:C.next=18;break;case 15:C.prev=15,C.t0=C.catch(5),T.e(C.t0);case 18:return C.prev=18,T.f(),C.finish(18);case 21:C.next=24;break;case 23:return C.abrupt("return","");case 24:case"end":return C.stop()}},g,this,[[5,15,18,21]])}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getWidgetInfoByTag",value:function(){var S=c()(Y.a.mark(function g(E){var v,T=this,Z,w,tt;return Y.a.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return at.next=2,this.getWidgetInfos();case 2:return Z=at.sent,w={stat:!1,data:{}},tt=Z==null||(v=Z.components)===null||v===void 0?void 0:m()(v).call(v,function(et){return b()(this,T),et.name===E}.bind(this)),tt&&(w.stat=tt.stat,w.data=tt,E==="LayerManager"&&(w.data.layersInfo=this.widgetInfo.tocs)),at.abrupt("return",w);case 7:case"end":return at.stop()}},g,this)}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getTreeData",value:function(h){var g=this,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v={};if(h.forEach(function(C){b()(this,g),v[C.id]=C}.bind(this)),E){var w,tt;return f()(w=N()(tt=B()(h).call(h,function(C){return b()(this,g),C.parentId===E}.bind(this))).call(tt,function(C){b()(this,g);var at={key:lt(C.name),name:C.label,sort:f()(C)},et=this.getTreeData(h,C.id);return et.length&&(at.children=et),at}.bind(this))).call(w,function(C,at){return b()(this,g),f()(C)-f()(at)}.bind(this))}else{var T,Z;return f()(T=N()(Z=B()(h).call(h,function(C){return b()(this,g),!v[C.parent]}.bind(this))).call(Z,function(C){b()(this,g);var at={key:lt(C.name),name:C.label,sort:f()(C)},et=this.getTreeData(h,C.id);return et.length&&(at.children=et),at}.bind(this))).call(T,function(C,at){return b()(this,g),f()(C)-f()(at)}.bind(this))}}}],[{key:"getInstance",value:function(h,g,E){var v=E.token,T=E.applicationId;return p.instance||(p.instance=new p(h,g,{token:v,applicationId:T})),p.instance}}]),p}(),mt=Ct,bt=t(46),xt=t.n(bt),ct=t(4);function $t(p,S){var h=typeof x.a<"u"&&_()(p)||p["@@iterator"];if(!h){if(Array.isArray(p)||(h=wt(p))||S&&p&&typeof p.length=="number"){h&&(p=h);var g=0,E=function(){};return{s:E,n:function(){return g>=p.length?{done:!0}:{done:!1,value:p[g++]}},e:function(tt){throw tt},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,T=!1,Z;return{s:function(){h=h.call(p)},n:function(){var tt=h.next();return v=tt.done,tt},e:function(tt){T=!0,Z=tt},f:function(){try{!v&&h.return!=null&&h.return()}finally{if(T)throw Z}}}}function wt(p,S){var h;if(p){if(typeof p=="string")return Et(p,S);var g=I()(h=Object.prototype.toString.call(p)).call(h,8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return q()(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Et(p,S)}}function Et(p,S){(S==null||S>p.length)&&(S=p.length);for(var h=0,g=new Array(S);h<S;h++)g[h]=p[h];return g}var P=function(){function p(S,h){F()(this,p),this.url=S,this.params=h,this.token=h.token,this.isLoading=!1,this.widgetInfo=void 0,h&&(this.promise_=this._request(S,h))}return k()(p,[{key:"_request",value:function(h,g){var E=this;return new H.a(function(v){var T=this;b()(this,E),Object(z.get)(h,g).then(function(Z){if(b()(this,T),Z.code===200){var w=this._parseWidgetInfo(Z.data);v(w)}else Z.code===201&&Object(ct.Message)("\u8BF7\u68C0\u67E5\u56FD\u571F\u5E73\u53F0\u767B\u5F55\u7684token"),v({})}.bind(this)),this.params.schemeId=this.params.resourceApplicationId}.bind(this))}},{key:"_parseWidgetInfo",value:function(h){var g=xt()({},h);if(h.components){g.components={};var E=$t(h.components),v;try{for(E.s();!(v=E.n()).done;){var T=v.value;T.code==="BaseMap"&&(T.code="23D-base-map"),g.components[T.code]=T}}catch(Z){E.e(Z)}finally{E.f()}}return h.componentDir&&(g.components.ToolBar={stat:JSON.parse(h.componentDir)[0].isShowToolbar,name:"ToolBar",config:h.componentDir}),g}},{key:"getWidgetInfos",value:function(){var S=c()(Y.a.mark(function g(){var E,v,T;return Y.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.widgetInfo){w.next=11;break}if(!this.promise_){w.next=11;break}return w.next=4,this.promise_;case 4:this.widgetInfo=w.sent,this.widgetInfo.components.map={stat:!0,name:"map"},this.widgetInfo.components.earth={stat:!0,name:"earth"},this.widgetInfo.components.mapEarth={stat:!0,name:"mapEarth"},this.widgetInfo.config=[],this.widgetInfo.custom&&this.widgetInfo.custom.length>0?this.treeConvertToArr(this.widgetInfo.custom):this.widgetInfo.already&&this.widgetInfo.already.length>0&&this.treeConvertToArr(this.widgetInfo.already),(E=this.widgetInfo)!==null&&E!==void 0&&(v=E.application)!==null&&v!==void 0&&v.basicConfiguration&&(T=JSON.parse(this.widgetInfo.application.basicConfiguration),this.widgetInfo.config.push({key:"spatial_data_governance",value:T.GovernAddress}));case 11:return w.abrupt("return",this.widgetInfo?this.widgetInfo:{});case 12:case"end":return w.stop()}},g,this)}));function h(){return S.apply(this,arguments)}return h}()},{key:"getConfigByKey",value:function(){var S=c()(Y.a.mark(function g(E){var v,T,Z,w;return Y.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.getWidgetInfos();case 2:if(v=C.sent,!v.config){C.next=23;break}T=$t(v.config),C.prev=5,T.s();case 7:if((Z=T.n()).done){C.next=13;break}if(w=Z.value,w.key!==E){C.next=11;break}return C.abrupt("return",w.value);case 11:C.next=7;break;case 13:C.next=18;break;case 15:C.prev=15,C.t0=C.catch(5),T.e(C.t0);case 18:return C.prev=18,T.f(),C.finish(18);case 21:C.next=24;break;case 23:return C.abrupt("return","");case 24:case"end":return C.stop()}},g,this,[[5,15,18,21]])}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getWidgetInfoByTag",value:function(){var S=c()(Y.a.mark(function g(E){var v,T,Z,w,tt,C;return Y.a.wrap(function(et){for(;;)switch(et.prev=et.next){case 0:return et.next=2,this.getWidgetInfos();case 2:if(v=et.sent,T={stat:!0,data:{}},!(v!=null&&v.components)){et.next=31;break}if(!v.config){et.next=26;break}Z="",w=$t(v.config),et.prev=8,w.s();case 10:if((tt=w.n()).done){et.next=17;break}if(C=tt.value,C.key!=="spatial_data_governance"){et.next=15;break}return Z=C.value,et.abrupt("break",17);case 15:et.next=10;break;case 17:et.next=22;break;case 19:et.prev=19,et.t0=et.catch(8),w.e(et.t0);case 22:return et.prev=22,w.f(),et.finish(22);case 25:E==="FileImport"?v.components[E].url=Z+"geofile/import":E==="FileExport"&&(v.components[E].url=Z+"geofile/export");case 26:T.data=v.components[E],E==="Toc"&&(T.data.layersInfo=this.flatLayerdata),T.stat=!0,et.next=32;break;case 31:T.stat=!0;case 32:return et.abrupt("return",T);case 33:case"end":return et.stop()}},g,this,[[8,19,22,25]])}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getSchemeById",value:function(){var S=c()(Y.a.mark(function g(E){var v=this,T,Z,w;return Y.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.getWidgetInfoByTag("LayerScheme");case 2:return Z=C.sent,Z.stat&&(w=JSON.parse(Z.data.config),T=m()(w).call(w,function(at){return b()(this,v),at.id===E}.bind(this))),C.abrupt("return",T);case 5:case"end":return C.stop()}},g,this)}));function h(g){return S.apply(this,arguments)}return h}()},{key:"getMaskOptions",value:function(){var S=c()(Y.a.mark(function g(){var E,v,T;return Y.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.getWidgetInfoByTag("Mask");case 2:return v=w.sent,v.stat&&v.data.config&&(T=JSON.parse(v.data.config),E={layer:{url:T.url,visibleLayers:T.layerName,selectLayer:T.layerName,type:T.type},where:T.where}),w.abrupt("return",E);case 5:case"end":return w.stop()}},g,this)}));function h(){return S.apply(this,arguments)}return h}()},{key:"treeConvertToArr",value:function(h){this.flatLayerdata=[],this.baseLayerIds=[],this.recursionFun(h)}},{key:"recursionFun",value:function(h){var g=this;h.forEach(function(E){b()(this,g),E.authkey=JSON.parse(sessionStorage.getItem("authkeytoken")),this.flatLayerdata.push(E),E.isBaseLayer&&this.baseLayerIds.push(E.id),E.child&&E.child.length>0&&this.recursionFun(E.child)}.bind(this))}}],[{key:"getInstance",value:function(h,g){return p.instance||(p.instance=new p(h,g)),p.instance}}]),p}(),W=P,U={name:"ShConfigProvider",provide:function(){var S=this;return{reactiveConfigInstance:function(){return b()(this,S),this.configInstance}.bind(this),reactiveShinegaUrl:function(){return b()(this,S),this.realShinegaUrl}.bind(this),reactiveShinegaDatabaseId:function(){return b()(this,S),this.realShinegaDatabaseId}.bind(this),token:this.token,generalCardThemeStyle:this.generalCardThemeStyle,generalBarThemeStyle:this.generalBarThemeStyle,shinegaInitData:this.shinegaInitData,fastApplicationId:this.fastApplicationId,publishId:this.publishId}},props:{url:{type:String},schemeId:{type:String},type:{type:String,default:"clientAdmin"},applicationId:{type:String},shinegaUrl:{type:String},shinegaDatabaseId:{type:String},token:{type:String},generalCardThemeStyle:{type:Object},generalBarThemeStyle:{type:Object},shinegaInitData:{type:Object},fastApplicationId:{type:String},publishId:{type:String},delay:{type:Number,default:0}},data:function(){return{loading:!1,configInstanceShinegaUrl:"",configInstanceShinegaDatabaseId:""}},computed:{configParams:function(){var S=this.$props,h=S.type,g=S.url,E=S.applicationId,v=S.token,T=S.schemeId;return{type:h,url:g,applicationId:E,token:v,schemeId:T}},configInstance:function(){if(this.type&&this.url)if(this.type==="geoplat"){var S=this.$props,h=S.url,g=S.applicationId,E=S.token;return new W(h,{resourceApplicationId:g,"X-Gisq-Token":E})}else{var v=this.$props,T=v.url,Z=v.schemeId,w=v.token,tt=v.fastApplicationId,C={schemeId:Z,id:this.publishId};return new mt(T,C,{token:w,applicationId:tt})}return null},realShinegaUrl:function(){return this.shinegaUrl?this.shinegaUrl:this.configInstanceShinegaUrl},realShinegaDatabaseId:function(){return this.shinegaDatabaseId?this.shinegaDatabaseId:this.configInstanceShinegaDatabaseId}},watch:{configParams:function(){this.executeRequest()}},mounted:function(){this.executeRequest()},methods:{executeRequest:function(){var S=this;this.configInstance&&(this.loading=!0,this.configInstance.getWidgetInfos().then(function(h){var g,E,v=this;b()(this,S),this.configInstanceShinegaUrl=(g=h.mapConfig)===null||g===void 0?void 0:g.spatial_data_governance,this.configInstanceShinegaDatabaseId=(E=h.mapConfig)===null||E===void 0?void 0:E.spatial_database_id,setTimeout(function(){b()(this,v),this.loading=!1}.bind(this),this.delay)}.bind(this)).catch(function(h){b()(this,S),this.$emit("error",h),ct.Message.error("\u83B7\u53D6\u8FD0\u7EF4\u7AEF\u6570\u636E\u5931\u8D25:"+h.message)}.bind(this)))}}},nt=U,yt=t(2),ft=Object(yt.a)(nt,e,n,!1,null,null,null),St=ft.exports;St.install=function(p){p.component(St.name,St)};var Tt=r.default=St},8:function(i,r){i.exports=a(22466)},9:function(i,r){i.exports=a(122777)}})},899497:function(ht,Q,a){ht.exports=function(L){var i={};function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return L[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}return r.m=L,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(e&1&&(t=r(t)),e&8||e&4&&typeof t=="object"&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),e&2&&typeof t!="string")for(var d in t)r.d(n,d,function(b){return t[b]}.bind(null,d));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s=772)}({0:function(L,i){L.exports=a(342579)},102:function(L,i){L.exports=a(170017)},103:function(L,i){L.exports=a(260706)},17:function(L,i){L.exports=a(985208)},18:function(L,i){L.exports=a(659791)},19:function(L,i){L.exports=a(183393)},2:function(L,i,r){"use strict";r.d(i,"a",function(){return t});function t(e,n,d,b,j,I,R,q){var K=typeof e=="function"?e.options:e;n&&(K.render=n,K.staticRenderFns=d,K._compiled=!0),b&&(K.functional=!0),I&&(K._scopeId="data-v-"+I);var x;if(R?(x=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__<"u"&&(A=__VUE_SSR_CONTEXT__),j&&j.call(this,A),A&&A._registeredComponents&&A._registeredComponents.add(R)},K._ssrRegister=x):j&&(x=q?function(){j.call(this,(K.functional?this.parent:this).$root.$options.shadowRoot)}:j),x)if(K.functional){K._injectStyles=x;var G=K.render;K.render=function(c,O){return x.call(O),G(c,O)}}else{var _=K.beforeCreate;K.beforeCreate=_?[].concat(_,x):[x]}return{exports:e,options:K}}},20:function(L,i){L.exports=a(105077)},22:function(L,i){L.exports=a(669033)},25:function(L,i){L.exports=a(543389)},28:function(L,i){L.exports=a(132726)},38:function(L,i){L.exports=a(326541)},457:function(L,i){L.exports=a(402237)},50:function(L,i){L.exports=a(636583)},6:function(L,i){L.exports=a(783574)},7:function(L,i){L.exports=a(17249)},772:function(L,i,r){"use strict";r.r(i);var t=r(0),e=r.n(t),n=function(){var P=this,W=P.$createElement,U=P._self._c||W;return U("div",{staticClass:"sh-draw-tool"},[U("general-bar",{attrs:{mode:P.mode,theme:P.theme,"drag-enable":P.dragEnable,"is-show":P.visible,position:P.position,options:P.toolOptions,"active-index":P.activeIndex,"theme-style":P.barThemeStyle},on:{"update:isShow":function(nt){P.visible=nt},"update:is-show":function(nt){P.visible=nt},"change:isShow":P.onChangeIsShow,select:P.select,unselect:P.unselect}})],1)},d=[];n._withStripped=!0;var b=r(17),j=r.n(b),I=r(18),R=r.n(I),q=r(8),K=r.n(q),x=r(19),G=r.n(x),_=r(20),A=r.n(_),c=r(50),O=r.n(c),F=r(25),X=r.n(F),k=r(38),ut=r.n(k),Y=r(22),it=r.n(Y),H=r(457),V=r.n(H),m=r(6),D=r.n(m),o=r(7),s=r.n(o),f=r(102),$=r.n(f),N=r(103),u=r.n(N),B={cad:!0,drawPoint:!0,drawLine:!0,drawPolygon:!0,modify:!0,clear:!0,rotate:!0,buffer:!0,union:!0,intersection:!0,difference:!0};function z(P){return[{key:"point",name:"\u7ED8\u5236\u70B9",img:"drawPoint",hidden:!P.drawPoint},{key:"polyline",name:"\u7ED8\u5236\u7EBF",img:"drawLine",hidden:!P.drawLine},{key:"polygon",name:"\u7ED8\u5236\u9762",img:"drawPolygon",hidden:!P.drawPolygon},{key:"clear",name:"\u6E05\u9664",img:"clear",hidden:!P.clear},{key:"modify",name:"\u7F16\u8F91",img:"modify",hidden:!P.modify}]}var rt=void 0;function pt(P,W){var U=j()(P);if(R.a){var nt=R()(P);W&&(nt=K()(nt).call(nt,function(yt){return G()(P,yt).enumerable})),U.push.apply(U,nt)}return U}function dt(P){for(var W=1;W<arguments.length;W++){var U=arguments[W]!=null?arguments[W]:{};W%2?pt(Object(U),!0).forEach(function(nt){X()(P,nt,U[nt])}):A.a?Object.defineProperties(P,A()(U)):pt(Object(U)).forEach(function(nt){Object.defineProperty(P,nt,G()(U,nt))})}return P}var gt={name:"ShDrawTool",components:{GeneralBar:$.a},mixins:[D.a,s.a,u.a],props:{returnType:{type:String,default:"geojson"},options:{type:Object,default:function(){return B}},isDrawEndSelected:{type:Boolean,default:!0},defaultStyle:{type:Object,default:function(){return e()(this,rt),{point:{pixelSize:5,color:"#3388ff",opacity:1,outline:!0,outlineColor:"#ffffff",outlineOpacity:.6,outlineWidth:2,clampToGround:!0},polyline:{name:"\u7EBF",lineType:"solid",color:"#3388ff",width:4,clampToGround:!0,opacity:1,zIndex:0},polygon:{fill:!0,fillType:"color",color:"#3388ff",opacity:.6,stRotation:0,outline:!0,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:.6,clampToGround:!0,zIndex:0}}}.bind(void 0)},defaultSelectStyle:{type:Object,default:function(){return e()(this,rt),{point:{pixelSize:5,color:"#FF0000",opacity:1,outline:!1,clampToGround:!0},polyline:{name:"\u7EBF",lineType:"solid",color:"#FF0000",width:4,clampToGround:!0,opacity:1,zIndex:0},polygon:{fill:!0,fillType:"color",color:"rgb(255,0,0)",opacity:.3,stRotation:0,outline:!0,outlineWidth:4,outlineColor:"#FF0000",outlineOpacity:1,clampToGround:!0,zIndex:0}}}.bind(void 0)}},data:function(){return this.drawTool,{activeIndex:[]}},computed:{toolOptions:function(){return z(dt(dt({},B),this.options))}},watch:{currentView:function(W){this.inited&&this.drawTool.setCurrentView(W)},currentInteraction:function(W){W!==this.$options.name&&this.deactivate()}},beforeDestroy:function(){this.deactivate()},mounted:function(){var W=this;(this.$map||this.$earth)&&setTimeout(function(){e()(this,W),this.begin()}.bind(this),0)},methods:{begin:function(){var W=this;this.drawTool&&(this.activeIndex=[],this.drawTool.destory()),this.drawTool=new V.a(this.$map,this.$earth),this.drawTool.on("inited",function(){e()(this,W),this.inited=!0,this.$emit("inited",this.drawTool)}.bind(this)),this.drawTool.on("drawend",function(U){if(e()(this,W),this.isDrawEndSelected){var nt=U.feature.getAttr3d(),yt=nt.style;nt.style=this.defaultSelectStyle[U.feature.type],nt.attr.tempSelected=!0,this.drawTool.updateAttribute(nt,U.feature),U.feature.feature2d&&(U.feature.feature2d.beforeSelectStyle=yt)}this.unselect(U.feature.type),this.$emit("drawend",U.feature)}.bind(this)),this.drawTool.on("change:active",function(U){var nt=this;if(e()(this,W),U.active)this.activeIndex=[U.tool];else{var yt,ft=O()(this.activeIndex),St=ut()(yt=this.activeIndex).call(yt,function(Tt){return e()(this,nt),Tt===U.tool}.bind(this));St>-1&&(it()(ft).call(ft,St,1),this.activeIndex=O()(ft))}this.$emit("change:active",U.active,U.tool,this.activeIndex)}.bind(this))},activate:function(W){this.select(W)},deactivate:function(){this.drawTool&&this.drawTool.deactivate()},removeAll:function(W){this.drawTool.removeAll(W)},select:function(W){W==="clear"?this.drawTool.removeAll():W==="modify"?(this.activeIndex=["modify"],this.drawTool.hasEdit(!0)):this.drawTool.activate(W,this.defaultStyle[W])},unselect:function(W){if(W==="modify"){this.drawTool.hasEdit(!1);for(var U=0;U<this.activeIndex.length;U++)if(this.activeIndex[U]==="modify"){var nt;it()(nt=this.activeIndex).call(nt,U,1);break}}else this.drawTool.deactivate(W)},onChangeIsShow:function(W){this.$emit("change:isShow",W)},setEditLayer:function(W){this.drawTool.setEditLayer(W)},createDrawLayer:function(W){return this.drawTool.createDrawLayer(W)},loadGeoJson:function(W,U){return this.drawTool.loadGeoJson(W,U)},removeFeatures:function(W){this.drawTool.removeFeatures(W)},removeFeature:function(W){this.drawTool.removeFeature(W)},setFeatureStyle:function(W,U){this.drawTool.setFeatureStyle(W,U)}}},lt=gt,Ct=r(2),mt=Object(Ct.a)(lt,n,d,!1,null,null,null),bt=mt.exports,xt=r(28),ct=r.n(xt),$t=void 0,wt=ct()(bt,{transform:function(W){e()(this,$t);var U=W.show,nt=W.position,yt=W.config,ft=yt===void 0?{}:yt,St={cad:ft.cadControl,drawPoint:ft.drawControl,drawLine:ft.drawLineControl,drawPolygon:ft.drawPolyControl,modify:ft.modifyControl,clear:ft.clearControl,rotate:ft.rotateControl,buffer:ft.bufferControl,union:ft.unionControl,intersection:ft.intersectionControl,difference:ft.differenceControl};return{isShow:U,position:nt,options:St}}.bind(void 0)});wt.install=function(P){P.component(wt.name,wt)};var Et=i.default=wt},8:function(L,i){L.exports=a(22466)}})},7819:function(ht,Q,a){var L=a(149500);ht.exports=function(i){var r={};function t(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return i[e].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=i,t.c=r,t.d=function(e,n,d){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:d})},t.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(n&1&&(e=t(e)),n&8||n&4&&typeof e=="object"&&e&&e.__esModule)return e;var d=Object.create(null);if(t.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:e}),n&2&&typeof e!="string")for(var b in e)t.d(d,b,function(j){return e[j]}.bind(null,b));return d},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/dist/",t(t.s=751)}({0:function(i,r){i.exports=a(342579)},1:function(i,r){i.exports=a(828866)},115:function(i,r){i.exports=a(521830)},136:function(i){i.exports=JSON.parse('{"1.3.12":"1.3","2.0.5":"2.0","2.1.4":"2.1","2.2.0-29":"2.2"}')},17:function(i,r){i.exports=a(985208)},18:function(i,r){i.exports=a(659791)},19:function(i,r){i.exports=a(183393)},2:function(i,r,t){"use strict";t.d(r,"a",function(){return e});function e(n,d,b,j,I,R,q,K){var x=typeof n=="function"?n.options:n;d&&(x.render=d,x.staticRenderFns=b,x._compiled=!0),j&&(x.functional=!0),R&&(x._scopeId="data-v-"+R);var G;if(q?(G=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),I&&I.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(q)},x._ssrRegister=G):I&&(G=K?function(){I.call(this,(x.functional?this.parent:this).$root.$options.shadowRoot)}:I),G)if(x.functional){x._injectStyles=G;var _=x.render;x.render=function(O,F){return G.call(F),_(O,F)}}else{var A=x.beforeCreate;x.beforeCreate=A?[].concat(A,G):[G]}return{exports:n,options:x}}},20:function(i,r){i.exports=a(105077)},21:function(i,r){i.exports=a(581806)},24:function(i,r){i.exports=a(452909)},25:function(i,r){i.exports=a(543389)},28:function(i,r){i.exports=a(132726)},32:function(i,r){i.exports=a(417745)},354:function(i,r){i.exports=a(602258)},355:function(i,r){i.exports=a(361536)},406:function(i,r){i.exports=a(229406)},446:function(i,r){i.exports=a(341775)},447:function(i,r){i.exports=a(699290)},448:function(i,r){i.exports=a(819563)},449:function(i,r){i.exports=a(395512)},53:function(i,r){i.exports=a(29870)},54:function(i,r){i.exports=a(101117)},57:function(i,r){i.exports=a(632002)},59:function(i,r){i.exports=a(867040)},6:function(i,r){i.exports=a(783574)},7:function(i,r){i.exports=a(17249)},751:function(i,r,t){"use strict";t.r(r);var e=t(0),n=t.n(e),d=function(){var l=this,M=l.$createElement,y=l._self._c||M;return y("div",{staticClass:"sh-earth cesium-container",class:{"sh-base-component":l.$isBaseComponent},attrs:{id:l.earthId}},[y("div",{staticClass:"sh-earth-controls"},[l.isEarthLoad&&l.getControlIsShow("FullFigure")?y("FullFigure",{attrs:{options:l.getControlOption("FullFigure"),"init-position":l.initPosition}},[l._t("earth:FullFigure")],2):l._e(),l.isEarthLoad&&l.getControlIsShow("Zoom")?y("Zoom",{attrs:{options:l.getControlOption("Zoom")},scopedSlots:l._u([{key:"ZoomIn",fn:function(){return[l._t("earth:ZoomIn")]},proxy:!0},{key:"ZoomOut",fn:function(){return[l._t("earth:ZoomOut")]},proxy:!0}],null,!0)}):l._e(),l.isEarthLoad&&l.getControlIsShow("FullScreen")?y("FullScreen",{attrs:{options:l.getControlOption("FullScreen")}},[l._t("earth:FullScreen")],2):l._e(),l.isEarthLoad&&l.getControlIsShow("NavigationHelp")?y("NavigationHelp",{attrs:{options:l.getControlOption("NavigationHelp")}},[l._t("earth:NavigationHelp")],2):l._e(),l.isEarthLoad&&l.getControlIsShow("ScenePick")?y("ScenePick",{attrs:{options:l.getControlOption("ScenePick")}}):l._e()],1),l.isEarthLoad&&l.getControlIsShow("Rotate")?y("Rotate",{attrs:{options:l.getControlOption("Rotate")}}):l._e(),l.isEarthLoad&&l.getControlIsShow("ScaleLine")?y("ScaleLine",{attrs:{options:l.getControlOption("ScaleLine")}}):l._e(),l.isEarthLoad&&l.getControlIsShow("Geolocation")?y("Geolocation",{attrs:{options:l.getControlOption("Geolocation")}}):l._e(),l.isEarthLoad?l._t("default"):l._e()],2)},b=[];d._withStripped=!0;var j=t(53),I=t.n(j),R=t(17),q=t.n(R),K=t(1),x=t.n(K),G=t(21),_=t.n(G),A=t(24),c=t.n(A),O=t(446),F=t.n(O),X=t(7),k=t.n(X),ut=t(115),Y=t.n(ut),it=t(54),H=t(355),V=t.n(H),m=t(354),D=t.n(m),o=t(59),s=t(57),f=function(){var l=this,M=l.$createElement,y=l._self._c||M;return y("div",{staticClass:"sh-earth-zoom"},[y("div",[l.$slots.ZoomIn?y("div",{attrs:{title:"\u653E\u5927"},on:{click:function(J){return J.stopPropagation(),l.onZoomIn.apply(null,arguments)}}},[l._t("ZoomIn")],2):y("div",{staticClass:"zoom-in",attrs:{title:"\u653E\u5927"},on:{click:function(J){return J.stopPropagation(),l.onZoomIn.apply(null,arguments)}}},[y("icon-svg",{attrs:{"icon-class":"zoom-in",width:"16px",height:"16px",theme:"dark"}})],1)]),y("div",[l.$slots.ZoomOut?y("div",{attrs:{title:"\u7F29\u5C0F"},on:{click:function(J){return J.stopPropagation(),l.onZoomOut.apply(null,arguments)}}},[l._t("ZoomOut")],2):y("div",{staticClass:"zoom-out",attrs:{title:"\u7F29\u5C0F"},on:{click:function(J){return J.stopPropagation(),l.onZoomOut.apply(null,arguments)}}},[y("icon-svg",{attrs:{"icon-class":"zoom-out",width:"16px",height:"16px",theme:"dark"}})],1)])])},$=[];f._withStripped=!0;var N=t(6),u=t.n(N),B=t(32),z=t.n(B),rt=t(406),pt=t.n(rt),dt={name:"ShEarthZoom",components:{IconSvg:z.a},mixins:[u.a,k.a],mounted:function(){this.zoomIn=new pt.a(this.$earth.viewer,!0),this.zoomOut=new pt.a(this.$earth.viewer,!1)},methods:{onZoomIn:function(){this.zoomIn.zoom(this.zoomIn.relativeAmount)},onZoomOut:function(){this.zoomOut.zoom(this.zoomOut.relativeAmount)}}},gt=dt,lt=t(2),Ct=Object(lt.a)(gt,f,$,!1,null,null,null),mt=Ct.exports,bt=function(){var l=this,M=l.$createElement,y=l._self._c||M;return y("div",{ref:"target",staticClass:"sh-earth-rotate"})},xt=[];bt._withStripped=!0;var ct=t(94),$t=t(447),wt=t.n($t),Et={name:"ShEarthRotate",mixins:[u.a,k.a],mounted:function(){this.$earth.viewer.afterWidgetChanged||(this.$earth.viewer.afterWidgetChanged=new ct.Event),this.$earth.viewer.beforeWidgetChanged||(this.$earth.viewer.beforeWidgetChanged=new ct.Event),this.navigationViewModel=wt.a.create({container:this.$refs.target,terria:this.$earth.viewer,enableZoomControls:!1,enableCompass:!0})}},P=Et,W=Object(lt.a)(P,bt,xt,!1,null,null,null),U=W.exports,nt=function(){var l=this,M=l.$createElement,y=l._self._c||M;return y("div",{ref:"target",staticClass:"sh-earth-scale-line"})},yt=[];nt._withStripped=!0;var ft=t(448),St=t.n(ft),Tt={name:"ShEarthScaleLine",mixins:[u.a,k.a],mounted:function(){this.container=document.createElement("div"),this.container.className="cesium-widget-cesiumNavigationContainer",this.container.appendChild(this.$refs.target),this.$refs.target.setAttribute("id","distanceLegendDiv"),this.$earth.viewer.container.appendChild(this.container),this.$earth.viewer.afterWidgetChanged||(this.$earth.viewer.afterWidgetChanged=new ct.Event),this.$earth.viewer.beforeWidgetChanged||(this.$earth.viewer.beforeWidgetChanged=new ct.Event),this.distanceLegendViewModel=St.a.create({container:this.$refs.target,terria:this.$earth.viewer,mapElement:this.container,enableDistanceLegend:!0})},beforeDestroy:function(){this.$earth.viewer.container.removeChild(this.container)}},p=Tt,S=Object(lt.a)(p,nt,yt,!1,null,null,null),h=S.exports,g=t(449),E=void 0,v="<div>\u4FEF\u4EF0\u89D2\uFF1A{pitch}\u5EA6</div><div>\u65B9\u5411\uFF1A{heading}\u5EA6\uFF080\u5EA6\u4E3A\u6B63\u5317\uFF09</div><div>\u89C6\u9AD8\uFF1A{height}\u7C73</div><div>\u7EAC\u5EA6\uFF1A{screenwd})</div><div>\u76F8\u673A (\u7ECF\u5EA6\uFF1A{screenjd}</div>",T={name:"ShEarthGeolocation",mixins:[u.a,k.a],props:{options:{type:Object,default:function(){n()(this,E)}.bind(void 0)}},data:function(){var M,y;return{crs:(M=this.options)===null||M===void 0?void 0:M.crs,format:((y=this.options)===null||y===void 0?void 0:y.format)||v}},mounted:function(){this.location=new g.Location(this.$earth.viewer,{crs:this.crs,format:this.format,bindEvent:!1}),this.$earth.viewer.shine._location=this.location,this.location.updaeCamera()},beforeDestroy:function(){var M;(M=this.location)===null||M===void 0||M.destroy()},render:function(){return null}},Z=T,w,tt,C=Object(lt.a)(Z,w,tt,!1,null,null,null),at=C.exports,et=function(){var l=this,M=l.$createElement,y=l._self._c||M;return y("div",{staticStyle:{position:"relative"}},[l.$slots.default?y("div",{ref:"button"},[l._t("default")],2):y("div",{ref:"button",staticClass:"sh-earth-navigation-help"},[y("IconSvg",{ref:"icon",attrs:{"icon-class":"help",theme:"dark",width:"16px",height:"16px"}})],1)])},Bt=[];et._withStripped=!0;var Pt,Zt={name:"ShNavigationHelp",components:{IconSvg:z.a},mixins:[u.a,k.a],mounted:function(){var M=this.$refs.button;new ct.NavigationHelpButton({container:M}),Pt=M.getElementsByClassName("cesium-navigationHelpButton-wrapper")[0],M.appendChild(Pt)}},Ft=Zt,Vt=Object(lt.a)(Ft,et,Bt,!1,null,null,null),Gt=Vt.exports,jt=function(){var l=this,M=l.$createElement,y=l._self._c||M;return y("div",{ref:"button",staticClass:"sh-earth-scene-pick"},[y("span",{staticClass:"container"},[y("div",{staticClass:"button",attrs:{id:l.item.id,title:l.item.text},on:{click:function(J){return l.handleEvent("open_close_scenePicker")}}},[y("IconSvg",{attrs:{"icon-class":l.item.icon,theme:"dark",width:"16px",height:"16px"}})],1),l._l(l.item.list,function(J,st){return y("div",{directives:[{name:"show",rawName:"v-show",value:!J.hidden,expression:"!factor.hidden"}],key:st,staticClass:"button",attrs:{title:J.text},on:{click:function(ot){return l.handleEvent(J.id)}}},[y("IconSvg",{attrs:{"icon-class":J.icon,width:"16px",height:"16px",theme:"dark"}})],1)})],2)])},Ht=[];jt._withStripped=!0;var Ut=t(25),Kt=t.n(Ut),Jt=t(18),Rt=t.n(Jt),Xt=t(8),Yt=t.n(Xt),Qt=t(19),At=t.n(Qt),kt=t(20),Wt=t.n(kt);function Dt(l,M){var y=q()(l);if(Rt.a){var J=Rt()(l);M&&(J=Yt()(J).call(J,function(st){return At()(l,st).enumerable})),y.push.apply(y,J)}return y}function qt(l){for(var M=1;M<arguments.length;M++){var y=arguments[M]!=null?arguments[M]:{};M%2?Dt(Object(y),!0).forEach(function(J){Kt()(l,J,y[J])}):Wt.a?Object.defineProperties(l,Wt()(y)):Dt(Object(y)).forEach(function(J){Object.defineProperty(l,J,At()(y,J))})}return l}var _t={name:"ShScenePick",components:{IconSvg:z.a},mixins:[u.a,k.a],data:function(){return{item:{id:"scene_3d",icon:"scene-mode-3d",text:"\u4E09\u7EF4\u89C6\u56FE",list:[{id:"scene_2d",icon:"scene-mode-2d",text:"\u4E8C\u7EF4\u89C6\u56FE",hidden:!0},{id:"scene_Columbus",icon:"scene-mode-columbus",text:"\u54E5\u4F26\u5E03\u89C6\u56FE",hidden:!0}]}}},methods:{begin:function(){},handleEvent:function(M){var y=this;if(M==="open_close_scenePicker"){var J=this.item.list;J.forEach(function(Lt){n()(this,y),Lt.hidden=!Lt.hidden}.bind(this));return}else{var st=this.$earth.viewer.scene;switch(M){case"scene_2d":{st.morphTo2D(0);break}case"scene_3d":{st.morphTo3D(0);break}case"scene_Columbus":st.morphToColumbusView(0)}var ot=this.item.list,vt=c()(ot).call(ot,function(Lt){return n()(this,y),Lt.id===M}.bind(this)),It=qt({},this.item);this.item.icon=vt.icon,this.item.id=vt.id,this.item.text=vt.text,vt.icon=It.icon,vt.id=It.id,vt.text=It.text,this.handleEvent("open_close_scenePicker")}}}},te=_t,ee=Object(lt.a)(te,jt,Ht,!1,null,null,null),ie=ee.exports,Ot=void 0,ne={name:"ShEarth",components:{FullFigure:V.a,Zoom:mt,Rotate:U,ScaleLine:h,Geolocation:at,FullScreen:D.a,NavigationHelp:Gt,ScenePick:ie},mixins:[k.a,Y.a],inject:{reactiveViewMode:{default:function(){var M=this;return function(){return n()(this,M),"3D"}.bind(this)}},reactiveView:{default:function(){var M=this;return function(){return n()(this,M),"earth"}.bind(this)}}},provide:function(){var M=this;return{reactiveViewMode:function(){return n()(this,M),"3D"}.bind(this),reactiveView:function(){return n()(this,M),"earth"}.bind(this),reactiveEarth:function(){return n()(this,M),this.$earth}.bind(this),emitterId:this.emitterId}},props:{map:Object,initLayers:{type:Array,default:function(){return n()(this,Ot),[]}.bind(void 0)},duration:{type:Number,default:0},controls:{type:Array,default:function(){return n()(this,Ot),["FullFigure","Zoom","Geolocation","Rotate","ScaleLine","FullScreen","NavigationHelp"]}.bind(void 0)},projection:{type:String,default:"EPSG:4490"},center:{type:Array,default:function(){return n()(this,Ot),[111.7579,31.6736]}.bind(void 0)},height:{type:Number,default:614914256e-2},zoom:{type:Number},heading:{type:Number,default:0},roll:{type:Number,default:0},pitch:{type:Number,default:-90}},data:function(){return this.$earth=void 0,this.earthId=Object(it.v4)(),{isEarthLoad:!1}},computed:{currentPosition:function(){return{center:this.center,height:this.height,heading:this.heading,roll:this.roll,pitch:this.pitch}}},watch:{currentPosition:function(M,y){var J=this,st,ot={};q()(M).forEach(function(It){n()(this,J),Object(s.isEqual)(M[It],y[It])||(ot[It]=M[It])}.bind(this));var vt=this.$el.style.display!=="none";vt&&((st=this.$earth)===null||st===void 0||st.centerAt(ot))}},beforeCreate:function(){var M,y;this.$isBaseComponent=((M=this.$parent)===null||M===void 0||(y=M.$parent.$options)===null||y===void 0?void 0:y.name)!=="ShMapEarth",this.emitterId=this.$isBaseComponent?Object(it.v4)():this.$parent.$parent.emitterId},mounted:function(){var M=this;if(this.$isBaseComponent){var y=q()(t(136)).reverse()[0];L.log("shinegis-client-23d version:",y)}setTimeout(function(){n()(this,M),this.initEarth(),this.setInitLayers()}.bind(this))},methods:{initEarth:function(){var M=this,y=this.reactiveView(),J=this.duration;y==="earth"?J=(J||50)/1e3:J=0,this.$earth=new F.a(this.earthId,{center:this.center,projection:this.projection,height:this.height,heading:this.heading,roll:this.roll,pitch:this.pitch,map:x()(this),duration:J}),this.initPosition={center:this.center,height:this.height,heading:this.heading,roll:this.roll,pitch:this.pitch},this.isEarthLoad=!0,this.$emit("earthInited",this.$earth),y==="earth"&&x()(this)&&this.$earth.viewer.shine.ol3d.setEnabled(!0),this.subscribe.$once("map-earth:change:view",function(vt){if(n()(this,M),vt==="earth"&&x()(this)&&this.duration>0){var It=x()(this).getCenter(),Lt=x()(this).getZoom();this.$earth.centerAt({center:It,height:this.$earth.viewer.shine.levelToHeight(Lt),heading:0,roll:0,pitch:-90},{duration:this.duration})}}.bind(this));var st=Object(o.getUrlParams)(decodeURIComponent(window.location.href)),ot={};st.forEach(function(vt){n()(this,M),ot[vt.name]=vt.value}.bind(this)),ot.view==="earth"&&setTimeout(function(){n()(this,M),this.$earth.centerAt({center:[Number(ot.x),Number(ot.y)],height:Number(ot.z),heading:Number(ot.heading),roll:Number(ot.roll),pitch:Number(ot.pitch)},{duration:0,projection:ot.projection})}.bind(this),500)},setInitLayers:function(){for(var M=0;M<this.initLayers.length;M++)this.$earth.viewer.shine.layerManager.addCheckedLayers(this.initLayers[M])},getControlIsShow:function(M){var y,J=this,st=x()(y=this.controls).call(y,function(ot){return n()(this,J),I()(ot)==="object"?ot.name:ot}.bind(this));return _()(st).call(st,M)},getControlOption:function(M){var y,J=this,st=c()(y=this.controls).call(y,function(ot){return n()(this,J),ot.name===M}.bind(this));return st?st.earthOptions:null}}},re=ne,oe=Object(lt.a)(re,d,b,!1,null,null,null),ae=oe.exports,se=t(28),le=t.n(se),he=void 0,Mt=le()(ae,{transform:function(M,y){n()(this,he);var J=y.view,st=y.projection,ot=y.center,vt=y.height,It=y.controls,Lt=y.heading,Nt=y.roll,zt=y.pitch;return J==="map"&&(Lt=0,Nt=0,zt=-90),{projection:st,center:ot,controls:It,height:Number(vt),heading:Number(Lt),roll:Number(Nt),pitch:Number(zt)}}.bind(void 0)});Mt.install=function(l){l.component(Mt.name,Mt)};var ue=r.default=Mt},8:function(i,r){i.exports=a(22466)},94:function(i,r){i.exports=a(187647)}})},463632:function(ht,Q,a){var L=a(149500);ht.exports=function(i){var r={};function t(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return i[e].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=i,t.c=r,t.d=function(e,n,d){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:d})},t.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(n&1&&(e=t(e)),n&8||n&4&&typeof e=="object"&&e&&e.__esModule)return e;var d=Object.create(null);if(t.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:e}),n&2&&typeof e!="string")for(var b in e)t.d(d,b,function(j){return e[j]}.bind(null,b));return d},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/dist/",t(t.s=783)}({0:function(i,r){i.exports=a(342579)},1:function(i,r){i.exports=a(828866)},115:function(i,r){i.exports=a(521830)},136:function(i){i.exports=JSON.parse('{"1.3.12":"1.3","2.0.5":"2.0","2.1.4":"2.1","2.2.0-29":"2.2"}')},17:function(i,r){i.exports=a(985208)},2:function(i,r,t){"use strict";t.d(r,"a",function(){return e});function e(n,d,b,j,I,R,q,K){var x=typeof n=="function"?n.options:n;d&&(x.render=d,x.staticRenderFns=b,x._compiled=!0),j&&(x.functional=!0),R&&(x._scopeId="data-v-"+R);var G;if(q?(G=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),I&&I.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(q)},x._ssrRegister=G):I&&(G=K?function(){I.call(this,(x.functional?this.parent:this).$root.$options.shadowRoot)}:I),G)if(x.functional){x._injectStyles=G;var _=x.render;x.render=function(O,F){return G.call(F),_(O,F)}}else{var A=x.beforeCreate;x.beforeCreate=A?[].concat(A,G):[G]}return{exports:n,options:x}}},28:function(i,r){i.exports=a(132726)},356:function(i,r){i.exports=a(7819)},450:function(i,r){i.exports=a(79810)},47:function(i,r){i.exports=a(110563)},54:function(i,r){i.exports=a(101117)},59:function(i,r){i.exports=a(867040)},7:function(i,r){i.exports=a(17249)},783:function(i,r,t){"use strict";t.r(r);var e=t(0),n=t.n(e),d=function(){var u=this,B=u.$createElement,z=u._self._c||B;return z("div",{staticClass:"sh-map-earth sh-base-component",class:u.currentView},[u.mapViewMode!="3D"?z("Map",{directives:[{name:"show",rawName:"v-show",value:u.currentView==="map",expression:"currentView === 'map'"}],ref:"map",attrs:{controls:u.controls,"init-layers":u.initLayers,projection:u.projection,center:u.center,zoom:u.zoom,"min-zoom":u.minZoom,"max-zoom":u.maxZoom,"mouse-wheel-zoom-enable":u.mouseWheelZoomEnable,"double-click-zoom-enable":u.doubleClickZoomEnable,"drag-pan-enable":u.dragPanEnable},on:{mapInited:u.mapInited},scopedSlots:u._u([{key:"map:FullFigure",fn:function(){return[u._t("map:FullFigure")]},proxy:!0},{key:"map:FullScreen",fn:function(){return[u._t("map:FullScreen")]},proxy:!0},{key:"map:ZoomIn",fn:function(){return[u._t("map:ZoomIn")]},proxy:!0},{key:"map:ZoomOut",fn:function(){return[u._t("map:ZoomOut")]},proxy:!0}],null,!0)}):u._e(),u.isMapLoad&&u.mapViewMode!="2D"?z("Earth",{directives:[{name:"show",rawName:"v-show",value:u.currentView==="earth",expression:"currentView === 'earth'"}],ref:"earth",attrs:{duration:u.duration,controls:u.controls,"init-layers":u.initLayers,map:u.$map,projection:u.projection,center:u.center,height:u.height,zoom:u.zoom,heading:u.heading,roll:u.roll,pitch:u.pitch},on:{earthInited:u.earthInited},scopedSlots:u._u([{key:"earth:FullFigure",fn:function(){return[u._t("earth:FullFigure")]},proxy:!0},{key:"earth:FullScreen",fn:function(){return[u._t("earth:FullScreen")]},proxy:!0},{key:"earth:ZoomIn",fn:function(){return[u._t("earth:ZoomIn")]},proxy:!0},{key:"earth:ZoomOut",fn:function(){return[u._t("earth:ZoomOut")]},proxy:!0},{key:"earth:NavigationHelp",fn:function(){return[u._t("earth:NavigationHelp")]},proxy:!0}],null,!0)}):u._e(),u.isMapLoad&&u.isEarthLoad?u._t("default"):u._e()],2)},b=[];d._withStripped=!0;var j=t(1),I=t.n(j),R=t(17),q=t.n(R),K=t(450),x=t.n(K),G=t(356),_=t.n(G),A=t(47),c=t(7),O=t.n(c),F=t(115),X=t.n(F),k=t(54),ut=t(59),Y=void 0,it={name:"ShMapEarth",components:{Map:x.a,Earth:_.a},mixins:[O.a,X.a],provide:function(){var B=this;return{reactiveViewMode:function(){return n()(this,B),this.mapViewMode}.bind(this),reactiveView:function(){return n()(this,B),this.currentView}.bind(this),reactiveMap:function(){return n()(this,B),this.$map}.bind(this),reactiveEarth:function(){return n()(this,B),this.$earth}.bind(this),reactiveInitPosition:function(){return n()(this,B),this.initPosition}.bind(this),emitterId:this.emitterId}},props:{viewMode:{type:[String,Number],default:"23D"},view:{type:String,default:"map"},controls:{type:Array,default:function(){return n()(this,Y),["FullFigure","Zoom","Geolocation","Rotate","ScaleLine","FullScreen","NavigationHelp"]}.bind(void 0)},initLayers:{type:Array,default:function(){return n()(this,Y),[]}.bind(void 0)},duration:{type:Number},projection:{type:String},center:{type:Array,default:function(){return n()(this,Y),[111.7579,31.6736]}.bind(void 0)},zoom:{type:Number,default:5},height:{type:Number,default:614914256e-2},heading:{type:Number,default:0},roll:{type:Number,default:0},pitch:{type:Number,default:-90},mouseWheelZoomEnable:{type:Boolean,default:!0},doubleClickZoomEnable:{type:Boolean,default:!0},dragPanEnable:{type:Boolean,default:!0},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:28}},data:function(){return this.$map=void 0,this.$earth=void 0,{currentView:this.getInitView(),isMapLoad:!1,isEarthLoad:!1,initPosition:{}}},computed:{initialized:function(){var B=this.isMapLoad,z=this.isEarthLoad;return B&&z},mapViewMode:function(){return Object(A.getMapViewMode)(this.viewMode)}},watch:{initialized:function(B){var z=this;B&&setTimeout(function(){var rt=this;n()(this,z),this.$emit("mapEarthInited",{map:this.$map,earth:this.$earth,mapRef:I()(this.$refs),earthRef:this.$refs.earth}),this.setInitPosition();var pt=Object(ut.getUrlParams)(decodeURIComponent(window.location.href)),dt={};pt.forEach(function(gt){n()(this,rt),dt[gt.name]=gt.value}.bind(this)),(dt.view==="map"||dt.view==="earth")&&this.toggleViewMode(dt.view)}.bind(this),0)},mapViewMode:{handler:function(B,z){this.currentView=this.getInitView(),this.mapViewMode==="3D"?(this.isMapLoad=!0,this.isEarthLoad=z==="23D"):this.mapViewMode==="2D"?(this.isEarthLoad=!0,this.isMapLoad=z==="23D"):this.mapViewMode==="23D"&&(this.isEarthLoad=!1,this.isMapLoad=z==="2D")},immediate:!0},currentView:function(B){var z=this;B==="earth"?setTimeout(function(){n()(this,z),this.$earth.viewer.shine.ol3d.setEnabled(!0)}.bind(this),10):(this.$earth.viewer.shine.ol3d.setEnabled(!1),this.$nextTick(function(){n()(this,z),this.$map.updateSize()}.bind(this))),this.$emit("change:view",B)},view:function(B){this.mapViewMode==="23D"&&(this.currentView=B)}},beforeCreate:function(){this.emitterId=Object(k.v4)(),this.$isBaseComponent=!0},mounted:function(){var B=q()(t(136)).reverse()[0];L.log("shinegis-client-23d version:",B),this.subscribe.$on("layer-switcher:change:view",this.toggleViewMode)},methods:{mapInited:function(B){var z=this;this.$map=B,this.isMapLoad=!0,this.$map.on("afterAddMapLink",function(rt){n()(this,z),this.$earth&&this.resetEarthElement(rt.element)}.bind(this)),this.$map.on("afterRemoveMapLink",function(rt){n()(this,z),this.$earth&&this.resetEarthElement(rt.element)}.bind(this))},earthInited:function(B){this.$earth=B,this.isEarthLoad=!0},toggleViewMode:function(B){B==="map"||B==="earth"?this.currentView=B:this.currentView=this.currentView==="map"?"earth":"map"},resetEarthElement:function(B){var z=document.getElementById(this.$earth.viewer._container.id);z.style.width=B.style.width,z.style.height=B.style.height},getInitView:function(){return this.mapViewMode==="23D"?this.view:this.mapViewMode==="3D"?"earth":"map"},setInitPosition:function(){this.view==="map"?this.initPosition={center:this.center,zoom:this.zoom,height:this.$earth?this.$earth.viewer.shine.levelToHeight(this.zoom):0,heading:this.heading,roll:this.roll,pitch:this.pitch}:this.initPosition={center:this.center,zoom:this.$earth?this.$earth.viewer.shine.getLevel(this.height):0,height:this.height,heading:0,roll:0,pitch:-90}}}},H=it,V=t(2),m=Object(V.a)(H,d,b,!1,null,null,null),D=m.exports,o=t(28),s=t.n(o),f=void 0,$=s()(D,{transform:function(B,z){n()(this,f);var rt=z.viewMode,pt=z.view,dt=z.projection,gt=z.center,lt=z.controls,Ct=z.zoom,mt=z.height,bt=z.heading,xt=z.pitch,ct=z.roll;return{viewMode:rt,view:pt,projection:dt,center:gt,controls:lt,zoom:Number(Ct),height:Number(mt),heading:Number(bt),pitch:Number(xt),roll:Number(ct)}}.bind(void 0)});$.install=function(u){u.component($.name,$)};var N=r.default=$}})},595031:function(ht,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0}),Q.earthDefaultConfig=void 0;var a={id:"cesiumContainer555",baseLayerPicker:!1,navigationHelpButton:!1,sceneModePicker:!1,homeButton:!1,fullscreenButton:!1,infoBox:!1,geocoder:!1,navigation:{},controls:[{crs:"",type:"location"},{type:"mousezoom"},{style:{top:"auto",bottom:"240px",right:"2px"},type:"navigation"}],showRenderLoopErrors:!0,center:{heading:360,roll:360,x:120.173619,y:30.247628,z:40113339e-1,pitch:-90},basemaps:[],defaultKey:{www_bing:"AtkX3zhnRe5fyGuLU30uZw8r3sxdBDnpQly7KfFTCB2rGlDgXBG3yr-qEiQEicEc",CesiumionToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmNDEzNmM2ZC02YTVmLTQ5YWEtODI4My1kN2ZkMTZjYWY4MmMiLCJpZCI6MTY4ODIsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NzEyOTE5NDd9.z0SU6f7Ou6381zw8UzAvFGIz6n7X0HNgCpse_kfBJXg",www_tdt:"e8355c4f15927bf3bf73b4801e30611a",geocoderConfig:{key:["f2fedb9b08ae13d22f1692cd472d345e","81825d9f2bafbb14f235d2779be90c0f","b185732970a4487de104fa71ef575f29","2e6ca4aeb6867fb637a5bee8333e5d3a","027187040fa924e56048468aaa77b62c"]}},maxzoom:5e7,minzoom:1,vrButton:!1,operationallayers:[],style:{debugShowFramesPerSecond:!1,resolutionScale:!0,atmosphere:!0,testTerrain:!0,lighting:!1,fog:!0}};Q.earthDefaultConfig=a},483577:function(ht,Q,a){"use strict";a.d(Q,{i:function(){return r}});var L=a(148836),i=a(927966);const r={created(){},computed:{...(0,L.Se)(["getCurrentWidget","getKeydown","getSelectMultiple","getMultipleWidget","getWidgets"])},methods:{...(0,L.nv)(["setCurrentWidget","setCurrentWidgetXYWHR","setActiveScreen","removeMultipleWidget","addMultipleWidget","setSelectMultiple","clearMultipleWidget"]),reLoadInfo(t){this.widgetInfo.id!=t.id&&this.$refs["comp_"+t.id]&&setTimeout(()=>{this.$refs["comp_"+t.id][0].reLoadInfo(t),this.$refs["comp_frame_"+t.id][0].initSvg()},500),this.loadInfo(t)},orgWidget(t,e){let n=[];return this.$$lib__.each(t,d=>{for(let b=0;b<this.widgetArr.length;b++){let j=this.widgetArr[b];j.parentId==this.widgetInfo.id&&j.id==d.id&&(!e||e(j))&&n.push(JSON.parse(JSON.stringify(j)))}}),n},setTitleText(t,e){e?this.$$lib__.each(e,n=>{this.$$lib__.each(this.orgWidget(n.widgets,d=>!d.title.hide&&d.title.text),d=>{d.attr.widgetW||(d.attr.widgetW=d.attr.w),this.$refs["title_"+d.id]&&this.$refs["title_"+d.id][0]&&(this.$refs["title_"+d.id][0].innerHTML=this.initTextPosition(d)),d.title.position||(d.title.position="top")})}):this.$$lib__.each(this.orgWidget(t,n=>!n.title.hide&&n.title.text),n=>{this.$refs["title_"+n.id]&&this.$refs["title_"+n.id][0]&&(this.$refs["title_"+n.id][0].innerHTML=this.initTextPosition(n)),n.title.position||(n.title.position="top")})},initTextPosition(t){return t.title.text===void 0||!t.title.text?"":t.title.text&&(t.title.position==="left"||t.title.position==="right")?t.title.text.split("").join("<br />"):t.title.text},onActive(t){return this.getSelectMultiple?this.getMultipleWidget[t.id]!=null:t.id===this.getCurrentWidget.id},onClicked(t){if(t&&t.currentTarget){let e=t.currentTarget.id;if(e&&e.indexOf(this.prefix.widget)>-1){let n=e.substr(this.prefix.widget.length);if(n!=this.getCurrentWidget.id){this.setActiveScreen(!1),this.setCurrentWidget(n);let d=this.$$lib__.keys(this.getMultipleWidget);this.getKeydown.ctrlKey?(this.setSelectMultiple(!0),this.getMultipleWidget[n]?this.removeMultipleWidget(n):this.addMultipleWidget(n)):this.getMultipleWidget[n]==null?(this.setSelectMultiple(!1),this.clearMultipleWidget(),this.addMultipleWidget(n)):d&&d.length==1&&(this.setSelectMultiple(!1),this.setCurrentWidget(d[0]),this.clearMultipleWidget(),this.addMultipleWidget(d[0]))}i.Z.$emit("autoScrollIntoViewWidgetTree",n)}}},onMouseEnter(t){this.onWidgetLayerMouseOver("push",t)},onMouseLeave(t){this.onWidgetLayerMouseOver("pop",t)},onWidgetLayerMouseOver(t,e){if(e&&e.currentTarget){let n=e.currentTarget.id;if(n&&n.indexOf(this.prefix.widget)>-1){let d=n.substr(this.prefix.widget.length);d&&d!=this.getCurrentWidget.id&&this.getMultipleWidget[d]==null&&t=="push"&&this.widget_layer_mouse_over.push(d),t=="pop"&&(this.widget_layer_mouse_over=this.$$lib__.without(this.widget_layer_mouse_over,d))}}},onDragstop(t,e){let n=this.getCurrentWidget.attr;n&&(n.x!=t||n.y!=e)&&this.setCurrentWidgetXYWHR({x:t,y:e})},dragging(t,e,n,d){if(this.getSelectMultiple){let b=this.getCurrentWidget.attr;b&&(b.x!=t||b.y!=e)&&this.setCurrentWidgetXYWHR({x:t,y:e})}},onResizstop(t,e,n,d){this.setCurrentWidgetXYWHR({x:t,y:e,w:n,h:d})},onRotatestop(t){this.setCurrentWidgetXYWHR({r:t})},getdraggableHW(t){let e={h:t.attr.h,w:t.attr.w?t.attr.widgetW:t.attr.w};return t.border.hide!=!0&&(t.border.type==!1?(t.border.widthT&&t.border.styleT&&t.border.styleT!=="none"&&(e.h=e.h+t.border.widthT),t.border.widthB&&t.border.styleB&&t.border.styleB!=="none"&&(e.h=e.h+t.border.widthB),t.border.widthR&&t.border.styleR&&t.border.styleR!=="none"&&(e.w=e.w+t.border.widthR),t.border.widthL&&t.border.styleL&&t.border.styleL!=="none"&&(e.w=e.w+t.border.widthL)):t.border.type==!0&&(t.border.breadthT&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.h=e.h+t.border.breadthT),t.border.breadthB&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.h=e.h+t.border.breadthB),t.border.breadthR&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.w=e.w+t.border.breadthR),t.border.breadthL&&t.border.borderStyle&&t.border.borderStyle!=="none"&&(e.w=e.w+t.border.breadthL))),e},getDraggableStyle(t){let e={};return!t.isContainer&&!t.attr.pointerEvents&&(e.pointerEvents="none",t.id===this.getCurrentWidget.id&&(e.backgroundColor="rgba(236, 240, 241, 1)",e.filter="Alpha(Opacity=50)")),typeof t.attr.opacity=="number"&&(e.opacity=t.attr.opacity),t.attr.backgroundColor&&(e.backgroundColor=t.attr.backgroundColor),t.attr.backgroundImage&&(e.backgroundImage=this.getImageUrl(t.attr.backgroundImage)),t.attr.backgroundSize&&(e.backgroundSize=t.attr.backgroundSize),e.overflow=t.border.overflowShow?"hidden":"visible",t.border.hide!=!0&&((t.border.hShadow||t.border.vShadow)&&(e.boxShadow=(t.border.hShadow||0)+"px "+(t.border.vShadow||0)+"px "+(t.border.blur||0)+"px "+t.border.blurColor||"rgba(0,0,0,0)"),t.border.type==!1?(e.borderTopWidth=t.border.widthT+"px",e.borderRightWidth=t.border.widthR+"px",e.borderBottomWidth=t.border.widthB+"px",e.borderLeftWidth=t.border.widthL+"px",e.borderTopStyle=t.border.styleT,e.borderRightStyle=t.border.styleR,e.borderBottomStyle=t.border.styleB,e.borderLeftStyle=t.border.styleL,e.borderTopColor=t.border.colorT,e.borderRightColor=t.border.colorR,e.borderBottomColor=t.border.colorB,e.borderLeftColor=t.border.colorL,e.borderTopLeftRadius=t.border.radiusTL+"px",e.borderTopRightRadius=t.border.radiusTR+"px",e.borderBottomLeftRadius=t.border.radiusBL+"px",e.borderBottomRightRadius=t.border.radiusBR+"px"):t.border.type==!0&&(e.borderStyle=t.border.borderStyle,e.borderTopWidth=t.border.breadthT+"px",e.borderRightWidth=t.border.breadthR+"px",e.borderBottomWidth=t.border.breadthB+"px",e.borderLeftWidth=t.border.breadthL+"px",e.borderImageSource=this.getImageUrl(t.border.borderImage),e.borderImageSlice=t.border.cutT+" "+t.border.cutR+" "+t.border.cutB+" "+t.border.cutL,e.borderImageRepeat=t.border.repeat)),e.float="left !important",e}}}},752246:function(ht,Q,a){"use strict";a.d(Q,{X:function(){return L},b:function(){return i}});let L={versions:function(){var r=navigator.userAgent;return{trident:r.indexOf("Trident")>-1,presto:r.indexOf("Presto")>-1,webKit:r.indexOf("AppleWebKit")>-1,gecko:r.indexOf("Gecko")>-1&&r.indexOf("KHTML")==-1,mobile:!!r.match(/AppleWebKit.*Mobile.*/),ios:!!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:r.indexOf("Android")>-1,iPhone:r.indexOf("iPhone")>-1,iPad:r.indexOf("iPad")>-1,webApp:r.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},i;L.versions.mobile||L.versions.ios||L.versions.android||L.versions.iPhone||L.versions.iPad?i=!1:i=!0},980512:function(ht,Q,a){"use strict";a.d(Q,{Z:function(){return j}});var L=function(){var R=this,q=R._self._c;return q("div",{class:"container_child_"+R.widgetData.id,attrs:{id:"container_child_"+R.widgetData.id}},[q("keep-alive",[q(R.isView&&R.widgetData.isContainer?R.widgetData.typeName+"-view":R.widgetData.typeName,{ref:"com_"+R.widgetData.id,tag:"component",attrs:{"widget-info":R.widgetData,"widget-arr":R.getWidgetAllArr,"current-widget":R.currentWidget},on:{doGetPreviewData:R.doGetPreviewData,doReSetBoardId:R.doReSetBoardId,attrChange:R.attrChange}})],1)],1)},i=[],r=a(513229),t=a(148836),e={name:"DraggableComponent",extends:r.Z,computed:{...(0,t.Se)(["getWidgetAllArr","isView"])},methods:{reLoadInfo(I){if(I.id){let R=this.$refs["com_"+I.id];R&&R.reLoadInfo(I)}},doReSetBoardId(I){this.$emit("doReSetBoardId",I)},attrChange(I){this.$emit("attrChange",I)}}},n=e,d=a(768141),b=(0,d.Z)(n,L,i,!1,null,"41d16aa2",null),j=b.exports},844513:function(ht,Q,a){"use strict";a.d(Q,{Z:function(){return b}});var L=function(){var I=this,R=I._self._c;return I.attr.buttonHide?R("div",{style:{position:"absolute",right:I.attr.buttonHideRight+"px",top:I.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(q){return I.onHide()}}},[I.openTooltip?R("el-tooltip",{attrs:{"open-delay":1e3,content:I.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[R("el-button",{class:I.attr.buttonHideIconClass&&I.attr.buttonHideIconClass!=""?I.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:I.attr.buttonHideColor,fontSize:I.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):R("el-button",{class:I.attr.buttonHideIconClass&&I.attr.buttonHideIconClass!=""?I.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:I.attr.buttonHideColor,fontSize:I.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):I._e()},i=[],r=a(752246),t={props:["attr"],name:"hide-button",data(){return{isPc:r.b}},computed:{openTooltip:function(){let j=!1,I=this.attr.buttonHideTooltipContent;return r.b&&I&&I!=null&&I.trim()!=""&&(j=!0),j}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},e=t,n=a(768141),d=(0,n.Z)(e,L,i,!1,null,"bf399b9a",null),b=d.exports},509848:function(ht,Q,a){"use strict";a.d(Q,{Z:function(){return D}});var L=function(){var s=this,f=s._self._c;return f("div",{directives:[{name:"show",rawName:"v-show",value:s.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:s.widgetInfo.attr.w+"px",height:s.widgetInfo.attr.hh+"px"}},[f("hide-button",{attrs:{attr:s.widgetInfo.attr}}),f("ConfigProvider",{attrs:{"shinega-url":s.widgetInfo.config.shinegaUrl}},[f("MapEarth",{ref:"gismap",attrs:{controls:s.widgetInfo.config.controls,"init-layers":s.initLayers,center:s.center,zoom:s.widgetInfo.config.zoom,height:s.height,heading:s.widgetInfo.config.heading,roll:s.widgetInfo.config.roll,pitch:s.widgetInfo.config.pitch,"min-zoom":s.widgetInfo.config.minZoom,"max-zoom":s.widgetInfo.config.maxZoom,"mouse-wheel-zoom-enable":s.widgetInfo.config.mouseWheelZoomEnable,"double-click-zoom-enable":s.widgetInfo.config.doubleClickZoomEnable,"drag-pan-enable":s.widgetInfo.config.dragPanEnable,"view-mode":s.widgetInfo.config.viewMode,view:s.widgetInfo.config.view},on:{mapEarthInited:s.mapConfiged,"change:view":s.changeViewMode}},[f("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[f("draw-tool",{ref:"drawTool",on:{mounted:s.drawMounted}})],1),s.isDrawInited?s._t("default",null,{widgetInfo:s.widgetInfo}):s._e()],2)],1)],1)},i=[],r=a(899497),t=a.n(r),e=a(463632),n=a.n(e),d=a(121120),b=a.n(d),j=a(844513),I=a(927966),R=a(716971),q=a(445061),K=a(126711),x=a(386892),G=a(663778),_=a(654583);function A(o,s){if(o.length!==s.length)return!1;const f=o.length;for(let $=0;$<f;$++)if(!O(o[$],s[$]))return!1;return!0}function c(o,s){const f=Object.keys(o),$=Object.keys(s);return f.length!==$.length?!1:f.every(N=>!!O(o[N],s[N]))}function O(o,s){return o===s?!0:typeof o!=typeof s||o===null||s===null?!1:Array.isArray(o)?Array.isArray(s)?A(o,s):!1:typeof o=="object"?c(o,s):!1}var F=a(148836),X=a(110563),k=a(85002),ut=a(723400),Y=a(149500),it={name:"ShineMap",components:{ConfigProvider:b(),MapEarth:n(),DrawTool:t(),HideButton:j.Z},mixins:[R.baseConfig,ut.j,x.D,q.u,K.H,G.a],props:["widgetInfo"],data(){return{isEditor:window.location.href.indexOf("editor.html")>0,isDrawInited:!1,layers:null,basemap:null,center:null,zoom:1,lastScaleW:1,lastScaleH:1,isExportPng:!1,translateInteractions:[]}},created(){this.initAction(this.widgetInfo)},beforeDestroy(){I.Z.$off("mapInitialized"),I.Z.$off("bindMap",this.reLoadWidgets)},computed:{...(0,F.Se)(["getCanvasSetting","bodyFraction","getWidgets","getWidgetAllArr"]),initLayers(){let o=[];if(this.widgetInfo.mapLayer.toc)for(let s of this.widgetInfo.mapLayer.toc)s.url&&(s.isInitLayer=!0,o.push(s));return o},height(){return this.getHeight(this.widgetInfo.config.zoom)}},watch:{basemap(o,s){s!==null&&o.id!==s.id&&this.$refs.gismap.changeBaseMap(o)},"widgetInfo.config.center":{handler(o,s){o.length===2&&o.toString()!==s.toString()&&(this.center=o)}},"widgetInfo.mapLayer.toc":{handler(o,s){if(s!=null&&!A(o,s)){for(let f of s)f.url&&(this.$refs.gismap.$map&&this.$refs.gismap.$map.layerManager.removeLayer(f),this.$refs.gismap.$earth&&this.$refs.gismap.$earth.viewer.shine.layerManager.removeLayer(f));for(let f of o)f.url&&(this.$refs.gismap.$map&&this.$refs.gismap.$map.layerManager.addLayer(f),this.$refs.gismap.$earth&&(f.isInitLayer=!0,this.$refs.gismap.$earth.viewer.shine.layerManager.addCheckedLayers(f)))}}},"getCanvasSetting.screenZoom":{handler:function(){},immediate:!0,deep:!0},bodyFraction:{handler:function(){Y.log("bodyFraction",this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting.transformType)},immediate:!0,deep:!0},"widgetInfo.attr.w":{handler:function(){setTimeout(()=>{this.$refs.gismap.$map&&this.$refs.gismap.$map.updateSize()},100)}},"widgetInfo.attr.hh":{handler:function(){setTimeout(()=>{this.$refs.gismap.$map&&this.$refs.gismap.$map.updateSize()},100)}},"widgetInfo.attr.hide":{handler(){let o=this.$refs.gismap.$map;o&&setTimeout(()=>{o.updateSize()},200)}}},mounted(){Y.log("shime-map mounted"),this.widgetInfo.isContainer||this.updatewidgetInfoById({...this.widgetInfo,isContainer:!0}),(this.widgetInfo.config.widgets===null||this.widgetInfo.config.widgets.length===0)&&(this.widgetInfo.config.widgets=this.getMapWidgetsList(this.widgetInfo.id),this.changeCurrentWidget(JSON.parse(JSON.stringify(this.widgetInfo)))),I.Z.$on("bindMap",this.reLoadWidgets),this.zoom=this.widgetInfo.config.zoom,this.center=this.widgetInfo.config.center,I.Z.$emit("register-save-event",{widget:this,handler:this.setMapInfo}),I.Z.$on("gis-map-change-layer-index",o=>{let s=this.$refs.gismap.$map;if(s&&o&&o.length>0)for(let f of o)this.changeLayerZoomById(s,f.id,f.mapIndex)}),I.Z.$on("map:toChangeViewMode",()=>{this.$refs.gismap.toggleViewMode()}),this.widgetInfo.config.isStartTranslate=!1},methods:{...(0,F.nv)(["updatewidgetInfoById","changeCurrentWidget"]),reLoadWidgets(){this.widgetInfo.config.widgets=this.getMapWidgetsList(this.widgetInfo.id),this.changeCurrentWidget(JSON.parse(JSON.stringify(this.widgetInfo)))},reLoadInfo(o){Y.log(o,this.getWidgets),this.refreshFullStyle()},getMapWidgetsList(o){let s=[];for(let f in this.getWidgets){let $=JSON.parse(JSON.stringify(this.getWidgets[f]));$.parentId===o&&s.push({id:$.id,name:$.name})}return s},initAction(o){this.actionReceive(o)},initSendEvent(){this.$refs.gismap.$map&&(this.$refs.gismap.$map.layerManager.on("afterAddLayer",this.layerAdded),this.$refs.gismap.$map.on("click",this.mapClick),this.$refs.gismap.$map.on("moveend",this.mapMoveend),this.$refs.gismap.$map.markerClick(this.markerClick))},actionReceive(o){if(o.action==null||o.action.receive==null)return;let s=o.action.receive.locateTempGraphic;s&&s.enabled&&s.locateList&&s.locateList.length>0&&this.$$lib__.each(s.locateList,N=>{let u=N[0][1];I.Z.$on(u,B=>{o.action.receive.locateTempGraphic.script&&o.action.receive.locateTempGraphic.script.enabled&&(Y.log("Execute the script to locate temp graphic to the "+o.name+" component"),this.actionLocateTempGraphic=new Function("info","data","action",o.action.receive.locateTempGraphic.script.content)),this.actionLocateTempGraphic(o,B,N)})});let f=o.action.receive.show;f&&f.enabled&&f.showList&&f.showList.length>0&&this.doActionShowOrHide(f.showList,f.value,f.script,o.name,"show",f.values?f.values:[]);let $=o.action.receive.hide;$&&$.enabled&&$.hideList&&$.hideList.length>0&&this.doActionShowOrHide($.hideList,$.value,$.script,o.name,"hide",$.values?$.values:[]),this.layerTocManagerReceive(o),this.setCutReceive(o)},layerTocManagerReceive(o){let s=o.action.receive.tocAction;s&&s.enabled&&s.tocList&&s.tocList.length>0&&this.$$lib__.each(s.tocList,f=>{let $=f[0][1];I.Z.$on($,N=>{o.action.receive.tocAction.script&&o.action.receive.tocAction.script.enabled&&(Y.log("Execute the script to cutting to the "+o.name+" component"),this.actionToc=new Function("info","data","action",o.action.receive.tocAction.script.content)),this.actionToc(o,N,f)})})},setCutReceive(o){let s=o.action.receive.mapCutting;s&&s.enabled&&s.cutList&&s.cutList.length>0&&this.$$lib__.each(s.cutList,f=>{let $=f[0][1];I.Z.$on($,N=>{o.action.receive.mapCutting.script&&o.action.receive.mapCutting.script.enabled&&(Y.log("Execute the script to cutting to the "+o.name+" component"),this.actionCutting=new Function("info","data","action",o.action.receive.mapCutting.script.content)),this.actionCutting(o,N,f)})})},actionScale(o,s,f){if(f==this.$$global_editor.transformType.autoWidth.code||f==this.$$global_editor.transformType.mobileAutoWidth.code?s=o:f==this.$$global_editor.transformType.autoHeight.code&&(o=s),o!=null&&s!=null&&!isNaN(o)&&!isNaN(s)&&!(o==this.lastScaleW&&s==this.lastScaleW)){if(this.$refs.gismap&&this.$refs.gismap.$map){let $=this.$refs.gismap.$map,N=this.widgetInfo.attr.w*o,u=this.widgetInfo.attr.h*s,B=1/o,z=1/s,rt=$.getTargetElement().parentElement.style.cssText;rt=rt+";width:"+N+"px",rt=rt+";height:"+u+"px",rt=rt+";transform: scale("+B+","+z+");transform-origin: 0 0 0;",$.getTargetElement().parentElement.style.cssText=rt,setTimeout(()=>{this.$refs.gismap.$map.updateSize()},300),this.lastScaleW=o,this.lastScaleH=s}}else(isNaN(o)||isNaN(s))&&this.$refs.gismap&&this.$refs.gismap.$map&&setTimeout(()=>{this.$refs.gismap.$map.updateSize()},300)},actionLocateTempGraphic(o,s,f){let $={};$.OBJECTID=s.OBJECTID,this.locateTempGraphic($)},zoomTo(o,s){this.mapRef.zoomTo(o,s)},toggle(o,s,f){this.mapRef.toggle(o,s,f)},centerAt3d(){if(this.widgetInfo.config.viewMode==="3D"){let o=this.widgetInfo.config.center,s=this.widgetInfo.config.zoom;this.earth&&this.earth.viewer&&(Y.log("centerAt3d"),this.earth.viewer.shine.centerAt({x:Number(o[0]),y:Number(o[1]),z:Number(this.getHeight(s))},{isFly:!0}))}},locateTempGraphic(o){this.$refs.gismap.$map&&this.$refs.gismap.$map.locateTempGraphic(o)},layerAdded(o){let s={data:o.layer.values_.info,layer:o.layer};this.biPostMessage([this.$$global_editor.actionType.layerAdded.code],s)},mapConfiged(o){document.body.classList.add("bi-gis-theme-element"),this.changeBodyTheme(this.$refs.gismap.getInitView()),this.isEditor&&this.$refs.gismap.getInitView()==="earth"&&(this.$refs.gisBase.style.width=this.widgetInfo.attr.w+1+"px");let s=o;this.$refs.gismap.toggle=(f,$,N)=>{o.mapRef.toggle(f,$,N)},o.map&&(I.Z.$emit("mapInitialized",o.map),this.initSendEvent(),this.map=o.map,this.mapRef=o.mapRef,this.map.drawTool=this.$refs.drawTool,Y.log("mapConfiged",o),this.$refs.gismap.map=o.map,this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting.transformType)),o.earth&&(this.earth=o.earth,this.earth.weather=new k.default(this.earth),this.earthRef=o.earthRef),this.biPostMessage([this.$$global_editor.actionType.mapConfiged.code,this.$$global_editor.actionType.layerTocManager.code],s),this.actionScale(this.bodyFraction.windowScaleW,this.bodyFraction.windowScaleH,this.getCanvasSetting.transformType),setTimeout(()=>{this.refreshFullStyle()},200)},refreshFullStyle(){(0,X.changeElementByClassName)("ol-full-screen-false",o=>{let s=this.widgetInfo.config.fullScreenStyle?this.widgetInfo.config.fullScreenStyle.backColor:"";s&&(o.style.backgroundColor=s);let f=this.widgetInfo.config.fullScreenStyle.size;f&&(o.style.width=f+"px",o.style.height=f+"px");let $=this.widgetInfo.config.fullScreenStyle?this.widgetInfo.config.fullScreenStyle.configSrc:"";if($){let N=document.createElement("img");N.src=$,N.src="/gisqBI/images"+N.src.split("images")[1];let u=this.widgetInfo.config.fullScreenStyle.size?.8*this.widgetInfo.config.fullScreenStyle.size+"px":"1.1em";N.style.width=u,N.style.height=u,o.innerText="",o.innerHTML='<img src="'+N.src+'" style="width:'+u+";height:"+u+'"></img>'}})},drawMounted(){this.isDrawInited=!0},mapClick(o){let s={event:o,point:o.coordinate};this.biPostMessage([this.$$global_editor.actionType.mapClick.code],s)},mapMoveend(){if(this.$refs.gismap.$map){let o={center:this.$refs.gismap.$map.getView().getCenter(),zoom:this.$refs.gismap.$map.getView().getZoom()};this.biPostMessage([this.$$global_editor.actionType.mapMoveend.code],o)}},markerClick(o){let s=[];if(o){for(let $ of o){let N=$.getProperties();delete N.geometry,s.push(N)}let f={event:{},data:s};this.biPostMessage([this.$$global_editor.actionType.markerClick.code],f)}},biPostMessage(o,s){let f=this,$=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each($,N=>{if(N.enabled&&o.indexOf(N.code)>-1){let u=N.code+"_"+f.widgetInfo.id;if(N.paramsExtend&&N.paramsExtend.length>0&&this.getExtendParams(s,N.paramsExtend,[],[]),N.script&&N.script.enabled&&N.script.content){this.doConfigMap=new Function("data",N.script.content);let B=this.doConfigMap(s);B&&(s=B)}I.Z.$emit(u,s),N.postMessage&&this.doPostMessage(s),this.actionNameList.push(u)}})},onMapConfig(o,s,f){s.map=this.map,I.Z.$emit(o,s),f&&this.doPostMessage(s)},setMapInfo(){let o=this.$refs.gismap.$map;if(o){let s=o.getView().getCenter(),f=o.getView().getResolution();this.widgetInfo.config.locateConf.center=s,this.widgetInfo.config.locateConf.resolution=f}},changeLayerZoomById(o,s,f){let $=o.getLayerById(s);if($ instanceof _.Z){let N=$.getLayers().getArray();for(let u of N)Number.isInteger(u.values_.info.mapIndex)||(f=f-.001),this._changeLayerZoom(o,u,f)}else this._changeLayerZoom(o,$,f)},_changeLayerZoom(o,s,f){s.setZIndex(f),o.removeLayer(s),o.addLayer(s)},getHeight(o){return 48e6/Math.pow(2,o)},changeBodyTheme(o){o==="map"?(document.body.classList.remove("dark"),document.body.classList.add("light")):(document.body.classList.remove("light"),document.body.classList.add("dark"))},changeViewMode(o){this.changeBodyTheme(o),Y.log("currentViewMode"),I.Z.$emit("map:changeViewMode",o)},getMap(){return this.$refs.gismap.map}}},H=it,V=a(768141),m=(0,V.Z)(H,L,i,!1,null,null,null),D=m.exports},654583:function(ht,Q,a){"use strict";a.d(Q,{V:function(){return K}});var L=a(893843),i=a(655825),r=a(296231),t=a(832450),e=a(302073),n=a(265077),d=a(312059),b=a(545059),j=a(776094),I=a(95232),R=a(24918),q=function(){var _=function(A,c){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,F){O.__proto__=F}||function(O,F){for(var X in F)Object.prototype.hasOwnProperty.call(F,X)&&(O[X]=F[X])},_(A,c)};return function(A,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");_(A,c);function O(){this.constructor=A}A.prototype=c===null?Object.create(c):(O.prototype=c.prototype,new O)}}(),K=function(_){q(A,_);function A(c,O){var F=_.call(this,c)||this;return F.layer=O,F}return A}(t.ZP),x={LAYERS:"layers"},G=function(_){q(A,_);function A(c){var O=this,F=c||{},X=(0,b.f0)({},F);delete X.layers;var k=F.layers;return O=_.call(this,X)||this,O.on,O.once,O.un,O.layersListenerKeys_=[],O.listenerKeys_={},O.addChangeListener(x.LAYERS,O.handleLayersChanged_),k?Array.isArray(k)?k=new i.Z(k.slice(),{unique:!0}):(0,d.h)(typeof k.getArray=="function",43):k=new i.Z(void 0,{unique:!0}),O.setLayers(k),O}return A.prototype.handleLayerChange_=function(){this.changed()},A.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(R.bN),this.layersListenerKeys_.length=0;var c=this.getLayers();this.layersListenerKeys_.push((0,R.oL)(c,r.Z.ADD,this.handleLayersAdd_,this),(0,R.oL)(c,r.Z.REMOVE,this.handleLayersRemove_,this));for(var O in this.listenerKeys_)this.listenerKeys_[O].forEach(R.bN);(0,b.ZH)(this.listenerKeys_);for(var F=c.getArray(),X=0,k=F.length;X<k;X++){var ut=F[X];this.registerLayerListeners_(ut),this.dispatchEvent(new K("addlayer",ut))}this.changed()},A.prototype.registerLayerListeners_=function(c){var O=[(0,R.oL)(c,n.Z.PROPERTYCHANGE,this.handleLayerChange_,this),(0,R.oL)(c,e.Z.CHANGE,this.handleLayerChange_,this)];c instanceof A&&O.push((0,R.oL)(c,"addlayer",this.handleLayerGroupAdd_,this),(0,R.oL)(c,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,I.sq)(c)]=O},A.prototype.handleLayerGroupAdd_=function(c){this.dispatchEvent(new K("addlayer",c.layer))},A.prototype.handleLayerGroupRemove_=function(c){this.dispatchEvent(new K("removelayer",c.layer))},A.prototype.handleLayersAdd_=function(c){var O=c.element;this.registerLayerListeners_(O),this.dispatchEvent(new K("addlayer",O)),this.changed()},A.prototype.handleLayersRemove_=function(c){var O=c.element,F=(0,I.sq)(O);this.listenerKeys_[F].forEach(R.bN),delete this.listenerKeys_[F],this.dispatchEvent(new K("removelayer",O)),this.changed()},A.prototype.getLayers=function(){return this.get(x.LAYERS)},A.prototype.setLayers=function(c){var O=this.getLayers();if(O)for(var F=O.getArray(),X=0,k=F.length;X<k;++X)this.dispatchEvent(new K("removelayer",F[X]));this.set(x.LAYERS,c)},A.prototype.getLayersArray=function(c){var O=c!==void 0?c:[];return this.getLayers().forEach(function(F){F.getLayersArray(O)}),O},A.prototype.getLayerStatesArray=function(c){var O=c!==void 0?c:[],F=O.length;this.getLayers().forEach(function(H){H.getLayerStatesArray(O)});var X=this.getLayerState(),k=X.zIndex;!c&&X.zIndex===void 0&&(k=0);for(var ut=F,Y=O.length;ut<Y;ut++){var it=O[ut];it.opacity*=X.opacity,it.visible=it.visible&&X.visible,it.maxResolution=Math.min(it.maxResolution,X.maxResolution),it.minResolution=Math.max(it.minResolution,X.minResolution),it.minZoom=Math.max(it.minZoom,X.minZoom),it.maxZoom=Math.min(it.maxZoom,X.maxZoom),X.extent!==void 0&&(it.extent!==void 0?it.extent=(0,j.getIntersection)(it.extent,X.extent):it.extent=X.extent),it.zIndex===void 0&&(it.zIndex=k)}return O},A.prototype.getSourceState=function(){return"ready"},A}(L.Z);Q.Z=G}}]);
