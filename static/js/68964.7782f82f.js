"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[68964],{368964:function(k,g,l){l.r(g),l.d(g,{default:function(){return I}});var h=function(){var t=this,a=t._self._c;return a("div",[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"80px","label-position":"right",model:t.currentWidget.dataset}},[a("el-form-item",{attrs:{label:"\u83DC\u5355\u7C7B\u578B"}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u7C7B\u578B"},on:{change:t.changeDatasetNewType},model:{value:t.currentWidget.dataset.newType,callback:function(i){t.$set(t.currentWidget.dataset,"newType",i)},expression:"currentWidget.dataset.newType"}},t._l(t.currentWidget.dataset.newTypeInfo,function(i){return a("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.currentWidget.dataset.newType=="all",expression:"currentWidget.dataset.newType=='all'"}],attrs:{label:"\u7236\u7EA7\u83DC\u5355"}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355"},on:{change:t.changeFirPId},model:{value:t.currentWidget.dataset[t.currentWidget.dataset.type].encode.firstPid,callback:function(i){t.$set(t.currentWidget.dataset[t.currentWidget.dataset.type].encode,"firstPid",i)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.firstPid"}},t._l(this.currentWidget.dataset[this.currentWidget.dataset.type].source,function(i){return a("el-option",{key:i.id,attrs:{label:t.fullName(i.id),value:i.id}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(t.fullName(i.id)))])])}),1)],1),a("el-form-item",{attrs:{label:"\u7981\u7528\u83DC\u5355\u7684\u663E\u793A\u65B9\u5F0F","label-width":"150px"}},[a("el-radio-group",{on:{change:t.reloadShowModeForDisabledMenu},model:{value:t.currentWidget.dataset.showModeForDisabledMenu,callback:function(i){t.$set(t.currentWidget.dataset,"showModeForDisabledMenu",i)},expression:"currentWidget.dataset.showModeForDisabledMenu"}},[a("el-radio",{attrs:{label:"hide"}},[t._v("\u9690\u85CF")]),a("el-radio",{attrs:{label:"disabled"}},[t._v("\u7981\u7528")])],1)],1)],1)],1)},p=[],f=l(723400),m=l(148836),c=l(935051),W={name:"platform-menu-data",props:["currentWidget","menuData"],mixins:[f.j],computed:{...(0,m.Se)(["getCanvasSetting","getApplicationId"]),dimensions_alias:function(){let e=[];return this.$$lib__.each(this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias,t=>{let a=JSON.parse(JSON.stringify(t));(!t.alias||t.alias=="")&&(a.alias=t.name),e.push(a)}),this.$$lib__.sortBy(e,"alias")}},mounted(){this.reloadMenuData(!0),this.clearDynamicEncode()},methods:{changeDatasetType(){this.getConfigData()},changeDatasetNewType(){this.reloadMenuData(),this.clearDynamicEncode()},changeFirPId(){this.getConfigData()},fullName(e){let t=this.currentWidget.dataset[this.currentWidget.dataset.type].source;return this.getFullName(e,t,"")},getFullName(e,t,a){let i;for(let n=0;n<t.length;n++)if(t[n].id==e){i=t[n];break}return i?(a=i.name+"/"+a,this.getFullName(i.parentFuncgroupId,t,a)):a},reloadShowModeForDisabledMenu(e){e==="hide"?this.currentWidget.dataset.dynamic.encode.hide="disabled":this.currentWidget.dataset.dynamic.encode.hide=null,this.getConfigData()},reloadMenuData(e){this.currentWidget.dataset.newType=="first"?this.getConfigData():this.loadAllMenuData(e)},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.firstPid=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.id=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.pid=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.name=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.icon=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.disabled=null,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.sort=null,this.setEncodeAndActionParam()},setEncodeAndActionParam(){this.$$lib__.each(this.dimensions_alias,e=>{switch(e.name){case"id":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.id=e.name,this.setClickActionParam(e.name,this.currentWidget.dataset.type);break;case"name":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.name=e.name,this.setClickActionParam(e.name,this.currentWidget.dataset.type);break;case"funcgroupId":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.pid=e.name,this.setClickActionParam(e.name,this.currentWidget.dataset.type);break;case"parentFuncgroupId":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.pid=e.name,this.setClickActionParam(e.name,this.currentWidget.dataset.type);break;case"iconPath":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.icon=e.name;break;case"sequence":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.sort=e.name;break;case"pagePath":this.setClickActionParam(e.name,this.currentWidget.dataset.type);break;case"disabled":this.currentWidget.dataset[this.currentWidget.dataset.type].encode.disabled=e.name;break}}),this.getCanvasSetting&&this.getCanvasSetting.data&&this.getCanvasSetting.data.globalParams&&this.getCanvasSetting.data.globalParams&&(this.getCanvasSetting.data.globalParams.params.token!=null&&this.setClickActionParam("token","global"),this.getCanvasSetting.data.globalParams.params.userId!=null&&this.setClickActionParam("userId","global"))},setClickActionParam(e,t){this.currentWidget.action&&this.currentWidget.action.sendOut&&this.currentWidget.action.sendOut.actionList&&this.$$lib__.each(this.currentWidget.action.sendOut.actionList,a=>{if(a.code==this.$$global_editor.actionType.click.code)if(a.params&&a.params[e]==null&&(a.params[e]=null),!a.paramsExtend)a.paramsExtend=[];else{let i="";if(t=="dynamic"||t=="local"?i="fieldD":t=="global"&&(i="fieldG"),!this.$$lib__.find(a.paramsExtend,r=>r[i]==e)){let r={type:t,fieldS:"",value:""};r[i]=e,a.paramsExtend.push(r)}}})},loadFirstMenuData(){let e=this.getApplicationId,t={subGuid:e},a="/identity/base/funcmgr/funcgroups-all",i;(0,c.platformPostRequest)(a,t).then(n=>{for(let s=0;s<n.data.length;s++)if(!n.data[s].parentFuncgroupId){i=n.data[s].id;break}let r={parentFuncgroupId:i,subGuid:e};a="/identity/base/funcmgr/getAppFuncGroupAndItem",(0,c.platformPostRequest)(a,r).then(s=>{if(s.data.length>0)for(let d=s.data.length-1;d>=0;d--)i!=s.data[d].parentFuncgroupId&&s.data.splice(d,1);this.currentWidget.dataset[this.currentWidget.dataset.type].source=s.data,this.currentWidget.dataset[this.currentWidget.dataset.type].encode.firstPid=i,this.getConfigData()})})},loadAllMenuData(e){let a={subGuid:this.getApplicationId},i="/identity/base/funcmgr/funcgroups-all",n=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.firstPid,r;(0,c.platformPostRequest)(i,a).then(s=>{for(let d=0;d<s.data.length;d++)if(!s.data[d].parentFuncgroupId){r=s.data[d].id;break}(!e||!n)&&(n=r),i="/identity/base/funcmgr/getAppFuncGroupAndItem",(0,c.platformPostRequest)(i,a).then(d=>{let o=[];if(d.data.length>0){for(let u=d.data.length-1;u>=0;u--)d.data[u].isFuncItem===1&&d.data.splice(u,1);let P={id:r,name:"\u6839\u8282\u70B9"};d.data.splice(0,0,P),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.firstPid=n,this.inOrderTravel(d.data,o,d.data[0])}this.currentWidget.dataset[this.currentWidget.dataset.type].source=o,this.getConfigData()})})},inOrderTravel(e,t,a){t.push(a);for(let i=0;i<e.length;i++)if(a.id===e[i].parentFuncgroupId){let n=e[i];this.inOrderTravel(e,t,n)}}}},y=W,b=l(768141),v=(0,b.Z)(y,h,p,!1,null,"2cbbec46",null),I=v.exports}}]);
