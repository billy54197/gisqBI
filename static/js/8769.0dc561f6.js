"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[8769],{98521:function(k,N,o){var T=o(75770),A=o(27966),F=o(55616),J=o.n(F),Z=o(49500);N.Z={autoShow(M,O,v){let c=M;if(c.innerAutoShowInterval&&c.innerAutoShowInterval>-1&&(clearInterval(c.innerAutoShowInterval),c.innerAutoShowInterval=-1,O.dispatchAction({type:"downplay",dataIndex:c.innerAutoShowIndex}),c.innerAutoShowIndex=0),!(M&&O&&v&&v.enabled&&v.interval>0))return;let _=v.showTip;typeof c.innerAutoShowIndex>"u"&&(c.innerAutoShowIndex=0),c.innerAutoShowInterval=setInterval(function(){let g=O.getOption(),h=0,b=0;g.series[h].data?b=g.series[h].data.length:g.dataset&&g.dataset.length>0&&(b=g.dataset[0].source.length),b!=0&&(O.dispatchAction({type:"downplay",dataIndex:c.innerAutoShowIndex}),c.innerAutoShowIndex=(c.innerAutoShowIndex+1)%b,O.dispatchAction({type:"highlight",dataIndex:c.innerAutoShowIndex}),_&&O.dispatchAction({type:"showTip",seriesIndex:h,dataIndex:c.innerAutoShowIndex}),B(c,c.innerAutoShowIndex,h,g))},v.interval*1e3);function B(g,h,b,R){let p=g.widgetInfo;g.$$lib__.each(p.action.sendOut.actionList,y=>{if(y.enabled&&y.code==T.Z.autoHighLight.code){let $=p.dataset[p.dataset.type].dimensions,z=y.code+"_"+p.id,I={},E=[];if(p.dataset[p.dataset.type].source&&p.dataset[p.dataset.type].source.length>0&&(E=p.dataset[p.dataset.type].source[h]),I.x=g.getFieldVal(E,$,R.series[b].encode.x),I.y=g.getFieldVal(E,$,R.series[b].encode.y),g.getExtendParams(I,y.paramsExtend,E,$),y.script&&y.script.enabled){if(Z.log("Execute script for "+p.name+" component to "+y.name+" component"),y.script.content==""){F.Message.warning({message:y.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}try{I=new Function("param,autoShowIndex,seriesIndex, opts",y.script.content).apply(g,[I,h,b,R])}catch(D){Z.error(D)}}A.Z.$emit(z,I),y.postMessage&&g.doPostMessage(I)}})}}}},56279:function(k,N,o){o.d(N,{P:function(){return F}});var T=o(86892),A=o(49500);const F={mixins:[T.D],created(){},methods:{lifecycleBeforeChartsLoad(J){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&A.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),A.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let M=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[J]);if(M)return M}return J},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&A.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),A.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},98769:function(k,N,o){o.r(N),o.d(N,{default:function(){return D}});var T=function(){var i=this,n=i._self._c;return n("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[n("hide-button",{attrs:{attr:i.widgetInfo.attr}}),n("div",{ref:"barLineMix",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},A=[],F=o(44513),J=o(27966),Z=o(28309),M=o(45061),O=o(26711),v=o(99349),c=o(55616),_=o(98521),B=o(75770),g=o(67157),h=o(50666);const b={mixins:[g.c],data(){return{config_extend:{config:{series:[{barWidth:30,itemStyle:{barBorderRadiusInfo:{lt:30,rt:30,lb:0,rb:0},colorInfo:{type:"gradation",pureColor:"",gradation:{top:"rgba(146, 203, 255, 1)",bottom:"rgba(20, 122, 217, 1)"}},color:"rgba(24, 222, 167, 1)"},lineStyle:{color:"rgba(24, 222, 167, 1)"}}],xAxis:{axisLine:{lineStyle:{color:"rgba(196,196,196,1)"}},axisLabel:{color:"rgba(146, 203, 255, 1)"}},yAxisLeft:{axisLine:{lineStyle:{color:"rgba(196,196,196,1)"}},axisLabel:{color:"rgba(146, 203, 255, 1)"}}}},filter_config:{title:JSON.parse(JSON.stringify(h.Z.charts.title)),legend:JSON.parse(JSON.stringify(h.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(h.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(h.Z.charts.toolbox)),visualMap:JSON.parse(JSON.stringify(h.Z.charts.visualMap)),dataZoom:JSON.parse(JSON.stringify(h.Z.charts.dataZoom)),xAxis:JSON.parse(JSON.stringify(h.Z.charts.xAxis)),yAxisLeft:JSON.parse(JSON.stringify(h.Z.charts.yAxis)),yAxisRight:JSON.parse(JSON.stringify(h.Z.charts.yAxis))}}},methods:{filterPredefineColoursSchemeConfig(t,i){this.getNewConfig(t,i,this.filter_config),this.getNewConfig_charts_visualMap_inRange_color(t.visualMap,i.visualMap),this.getNewConfig_charts_series(t.series,i.series)}}};var R=o(56279),p=o(49500);const y=o(29426);var $={name:"BarLineMix",components:{HideButton:F.Z},mixins:[Z.u,b,M.u,O.H,R.P,v.P],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null,negative:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=y.init(this.$refs.barLineMix,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let i=[],n=[],f=[];if(t.dataset[t.dataset.type]&&(i=JSON.parse(JSON.stringify(t.dataset[t.dataset.type].source)),n=JSON.parse(JSON.stringify(t.dataset[t.dataset.type].dimensions)),f=JSON.parse(JSON.stringify(t.dataset[t.dataset.type].dimensionsAlias))),t.config.firstRowAsAlias&&i&&i.length>0){let e=i.splice(0,1);if(e&&e.length>0&&e[0].length===f.length)for(let L=e[0].length-1;L>-1;--L)f[L].alias=""+e[0][L]}this.dimensionsEx=n,this.dimensionsAliasEx=f;let a=JSON.parse(JSON.stringify(t.config.series)),s=this.getTooltip(t.config.tooltip),W=JSON.parse(JSON.stringify(t.config.toolbox)),x=JSON.parse(JSON.stringify(t.config.dataZoom)),m=JSON.parse(JSON.stringify(t.config.legend)),u=JSON.parse(JSON.stringify(t.config.title)),G=JSON.parse(JSON.stringify(t.config.grid)),l=JSON.parse(JSON.stringify(t.config.xAxis)),r=JSON.parse(JSON.stringify(t.config.yAxisLeft)),d=JSON.parse(JSON.stringify(t.config.yAxisRight));for(let e=0;e<a.length;e++){a[e].dimensions=n,a[e].barGap&&(a[e].barGap=a[e].barGap+"%"),(!a[e].name||t.config.firstRowAsAlias==!0)&&(a[e].name=this.getLegendData(f,a[e].encode.y),t.config.series[e].name=a[e].name),a[e].type=="bar"?(a[e].barWidth&&(a[e].barWidth=a[e].barWidth+"%"),a[e].itemStyle.barBorderRadiusInfo&&(a[e].itemStyle.barBorderRadius=this.getItemStyleBarBorderRadius(a[e].itemStyle.barBorderRadiusInfo)),a[e].itemStyle.colorInfo.type&&(a[e].itemStyle.color=this.getItemStyleColor(a[e].itemStyle.colorInfo)),t.config.series[e].emphasis&&t.config.series[e].emphasis.itemStyle&&t.config.series[e].emphasis.itemStyle.color&&(a[e].emphasis.itemStyle.color=t.config.series[e].emphasis.itemStyle.color)):a[e].type=="line"&&(a[e].lineWidth=a[e].lineWidth+"%",a[e].itemStyle.color=a[e].itemStyle.color?a[e].itemStyle.color:a[e].lineStyle.color,a[e].areaStyle.colorInfo.type&&(a[e].areaStyle.color=this.getItemStyleColor(a[e].areaStyle.colorInfo)),t.config.series[e].emphasis&&t.config.series[e].emphasis.itemStyle&&t.config.series[e].emphasis.itemStyle.color&&(a[e].emphasis.itemStyle.color=t.config.series[e].emphasis.itemStyle.color),this.getSymbol(a[e]));let L={},C=[],H=[];for(let S=a[e].dimensions.length-1;S>-1;--S)L[n[S]]=S;for(let S=0;S<i.length;++S){let P=i[S];C.push(P[L[a[e].encode.y]]||""),H.push(P[L[a[e].encode.x]]||"")}if(a[e].data=C,C&&C.length>0&&t.config.series[e].emphasis&&t.config.series[e].emphasis.script&&t.config.series[e].emphasis.script.enabled){const S=t.config.series[e].emphasis;if(S.script.content)try{let P=this,K=new Function("index","item","data",S.script.content);a[e].data.forEach((U,j)=>{let V=K.call(P,j,U,C);a[e].data[j]={value:U,emphasis:V}})}catch(P){p.error("\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u811A\u672C\u62A5\u9519\uFF1A",P)}}l.data=H}let w={color:this.$$global_editor.predefineColors,tooltip:s,toolbox:W,visualMap:t.config.visualMap.show?this.getVisualMap(t.config.visualMap):"",dataZoom:x,title:{show:u.show,text:u.text,link:u.link,textAlign:u.textAlign,left:u.left+"%",right:u.right+"%",top:u.top+"%",bottom:u.bottom+"%",textStyle:{fontSize:u.textStyle.fontSize,fontFamily:u.textStyle.fontFamily,color:u.textStyle.color}},legend:{show:m.show,type:m.type,itemWidth:m.itemWidth,itemHeight:m.itemHeight,icon:m.icon,orient:m.orient,align:m.align,itemGap:m.itemGap,left:m.left+"%",right:m.right+"%",top:m.top+"%",bottom:m.bottom+"%",textStyle:{fontSize:m.textStyle.fontSize,fontFamily:m.textStyle.fontFamily,color:m.textStyle.color}},grid:{left:G.left+"%",right:G.right+"%",top:G.top+"%",bottom:G.bottom+"%"},xAxis:[{type:"category",show:l.show,name:l.name,data:l.data,nameLocation:l.nameLocation,nameGap:l.nameGap,boundaryGap:l.boundaryGap,axisLine:{show:l.axisLine.show,lineStyle:{color:l.axisLine.lineStyle.color}},axisTick:{show:l.axisTick.show},axisLabel:{interval:l.axisLabel.interval,show:l.axisLabel.show,rotate:l.axisLabel.rotate,margin:l.axisLabel.margin,fontSize:l.axisLabel.fontSize,fontFamily:l.axisLabel.fontFamily,color:l.axisLabel.color,formatter:function(e,L){return l.axisLabel.script==!0?new Function("value, index",l.axisLabel.scriptontent).apply(this,[e,L]):l.axisLabel.vertical?e.split("").join(`
`):e}},splitLine:l.splitLine}],yAxis:[{scale:!0,show:r.show,type:r.type,name:r.name,position:"left",min:r.min,max:r.max,splitNumber:r.splitNumber,nameLocation:r.nameLocation,nameGap:r.nameGap,nameTextStyle:r.nameTextStyle,axisLine:{show:r.axisLine.show,lineStyle:{color:r.axisLine.lineStyle.color}},axisTick:{show:r.axisTick.show,lineStyle:r.axisTick.lineStyle},axisLabel:{show:r.axisLabel.show,rotate:r.axisLabel.rotate,margin:r.axisLabel.margin,fontSize:r.axisLabel.fontSize,fontFamily:r.axisLabel.fontFamily,color:r.axisLabel.color},splitLine:r.splitLine,axisPointer:r.axisPointer.axisPointer},{scale:!0,show:d.show,type:d.type,name:d.name,position:"right",min:d.min,max:d.max,splitNumber:d.splitNumber,nameLocation:d.nameLocation,nameGap:d.nameGap,nameTextStyle:d.nameTextStyle,axisLine:{show:d.axisLine.show,lineStyle:{color:d.axisLine.lineStyle.color}},axisTick:{show:d.axisTick.show,lineStyle:d.axisTick.lineStyle},axisLabel:{show:d.axisLabel.show,rotate:d.axisLabel.rotate,margin:d.axisLabel.margin,fontSize:d.axisLabel.fontSize,fontFamily:d.axisLabel.fontFamily,color:d.axisLabel.color},splitLine:d.splitLine,axisPointer:d.axisPointer.axisPointer}],dataset:{source:i,sourceHeader:!1},series:a};this.isNegative(a,i);for(let e=0;e<w.yAxis.length;e++)(!w.yAxis[e].min||w.yAxis[e].min=="")&&(w.yAxis[e].min=0),(!w.yAxis[e].max||w.yAxis[e].max=="")&&delete w.yAxis[e].max;for(let e=0;e<a.length;e++)a[e].dimensions=void 0;for(let e=0;e<a.length;e++)a[e].type=="bar"&&a[e].showBackground&&(a[e].backgroundStyle.color||(a[e].backgroundStyle.color="rgba(146, 203, 255, 0.2)"));this.getAnimation(w,t),this.setOption(w,t),this.setAnimationLoop(t,()=>{this.setOption(w,t)})},setOption(t,i){this.echarts.getOption()&&this.echarts.clear(),setTimeout(()=>{this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0}),_.Z.autoShow(this,this.echarts,i.config.autoShow)},0)},getSymbol(t){t.symbolType=="img"&&t.symbol!=""&&(t.symbol=this.getSymbolURL(t.symbol)),t.symbolType=="svg"&&t.symbol!=""&&(t.symbol.indexOf("image/")>-1?t.symbol=t.symbol.indexOf("image://")==-1?"image://"+t.symbol:t.symbol:t.symbol=t.symbol.indexOf("path://")==-1?"path://"+t.symbol:t.symbol)},reLoadInfo(t){this.mergeConfig(t),t&&(this.$refs.barLineMix.style.width=t.attr.w+"px",this.$refs.barLineMix.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,i){let n=this.$$lib__.find(t,f=>f.name==i);return n?n.alias&&n.alias!=""?n.alias:n.name:""},getItemStyleColor(t){let i=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?i=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(t.position=="levelDec"?i=new y.graphic.LinearGradient(0,0,1,0,[{offset:0,color:t.gradation.left!=null&&t.gradation.left!=""?t.gradation.left:"#FFFFFF"},{offset:1,color:t.gradation.right!=null&&t.gradation.right!=""?t.gradation.right:"#FFFFFF"}]):i=new y.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),i},getItemStyleBarBorderRadius(t){let i=[];return i.push(t.lt),i.push(t.rt),i.push(t.rb),i.push(t.lb),i},initAction(t){this.onClick(t),this.actionReceive(t)},onClick(t){let i=this;i.echarts.on("click",n=>{let f=[],a=i.widgetInfo.action.sendOut.actionList;i.$$lib__.each(a,s=>{let W=s.code+"_"+t.id,x={};s.paramsExtend&&s.paramsExtend.length>0&&i.getParamsExtend(x,s.paramsExtend,t);let m=s.postMessage;if(x.x=n.name,x.y=n.value,s.enabled&&s.code==B.Z.click.code){if(i.widgetInfo.dataset[i.widgetInfo.dataset.type].source&&i.widgetInfo.dataset[i.widgetInfo.dataset.type].source.length>0&&(f=i.widgetInfo.dataset[i.widgetInfo.dataset.type].source[n.dataIndex]),i.getExtendParams(x,a[0].paramsExtend,f,i.widgetInfo.dataset[i.widgetInfo.dataset.type].dimensions),s.script&&s.script.enabled){if(p.log("Execute script for "+i.widgetInfo.name+" component to "+s.name+" component"),s.script.content==""){c.Message.warning({message:s.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",s.script.content),x=this.customScript_actionSend_clickParam(x,n)}J.Z.$emit(W,x),m&&i.doPostMessage(x)}else if(s.enabled&&s.code==B.Z.openLink.code){if(s.paramsExtend&&s.paramsExtend.length>0){let u=[];i.widgetInfo.dataset[i.widgetInfo.dataset.type].source&&i.widgetInfo.dataset[i.widgetInfo.dataset.type].source.length>0&&(u=i.widgetInfo.dataset[i.widgetInfo.dataset.type].source[n.dataIndex]),i.getExtendParams(x,s.paramsExtend,u,i.widgetInfo.dataset[i.widgetInfo.dataset.type].dimensions)}if(s.script&&s.script.enabled){if(p.log("Execute script for "+i.widgetInfo.name+" component to "+s.name+" component"),s.script.content==""){c.Message.warning({message:s.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",s.script.content),x=this.customScript_actionSend_clickParam(x,n)}i.openLinkAction(s,x)}})})},isNegative(t,i){let n=[];for(let f=0;f<t.length;f++){let a=-1;for(let s=0;s<t[f].dimensions.length;s++)t[f].dimensions[s]==t[f].encode.y&&(a=s);for(let s=0;s<i.length;s++)parseInt(i[s][a])<0&&n.push(s)}n.length>0?this.negative=!0:this.negative=!1},fun_max(t){let i=0,n=0;return parseInt(t.max)&&(i=Math.abs(parseInt(t.max)).toFixed(0).toString().length-1),parseInt(t.min)&&(n=Math.abs(parseInt(t.min)).toFixed(0).toString().length-1),Math.abs(t.max)>Math.abs(t.min)?Math.ceil(Math.abs(t.max)/Math.pow(10,i))*Math.pow(10,i):Math.ceil(Math.abs(t.min)/Math.pow(10,n))*Math.pow(10,n)},fun_min(t){if(this.negative){let i=0,n=0;return parseInt(t.max)&&(i=Math.abs(parseInt(t.max)).toFixed(0).toString().length-1),parseInt(t.min)&&(n=Math.abs(parseInt(t.min)).toFixed(0).toString().length-1),Math.abs(t.max)>Math.abs(t.min)?-1*Math.ceil(Math.abs(t.max)/Math.pow(10,i))*Math.pow(10,i):-1*Math.ceil(Math.abs(t.min)/Math.pow(10,n))*Math.pow(10,n)}else return-Math.abs(0)}}},z=$,I=o(68141),E=(0,I.Z)(z,T,A,!1,null,"8f273bac",null),D=E.exports}}]);
