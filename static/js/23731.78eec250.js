"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[23731],{509132:function(v,s,e){e.d(s,{M:function(){return r}});var d=e(479876),_=e(745643),c=e(555616),h=e.n(c),l=e(927966),u=e(148836),a=e(149500);const r={props:{widgetId:{type:String},value:{default:null},condition_config:{}},mixins:[d.G,_.E],data(){return{global_query:this.$$global_query,condition_value:void 0}},computed:{...(0,u.Se)(["enumInfoFun","datasetInfoFun"]),enumInfo(){return this.enumInfoFun(this.widgetId)},datasetInfo(){return this.datasetInfoFun(this.widgetId)}},mounted(){l.Z.$on("busGetEnumDataSetJson"+(this.widgetId?"_"+this.widgetId:""),i=>{this.getEnumDataSetJson(i)})},methods:{afterChangeValue(){this.scriptChangeValue(),this.condition_config.change_query==!0&&this.doQuery()},scriptChangeValue(){if(this.condition_config.is_change_value&&this.condition_config.is_change_value==!0){if(!this.condition_config.script_change_value||this.condition_config.script_change_value==""){a.warn(this.condition_name+this.condition_config.label+"\u56DE\u8F66\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}a.info("\u6267\u884C"+this.condition_name+this.condition_config.label+" \u56DE\u8F66\u4E8B\u4EF6\u811A\u672C");let i=new Function("condition_config","value",this.condition_config.script_change_value);this.condition_config.control_type==this.global_query.control_type.selectTree.code?i.apply(this,[this.condition_config,this.condition_value.value]):i.apply(this,[this.condition_config,this.condition_value])}},keyupEnter(){if(this.condition_config.attributes&&this.condition_config.attributes.is_condition_enter&&this.condition_config.attributes.is_condition_enter==!0){if(!this.condition_config.attributes.script_condition_enter||this.condition_config.attributes.script_condition_enter==""){a.warn(this.condition_name+this.condition_config.label+"\u56DE\u8F66\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}a.info("\u6267\u884C"+this.condition_name+this.condition_config.label+" \u56DE\u8F66\u4E8B\u4EF6\u811A\u672C"),this.keyupEnterScript=new Function("condition_config,value",this.condition_config.attributes.script_condition_enter),this.condition_config.control_type==this.global_query.control_type.selectTree.code?this.keyupEnterScript(this.condition_config,this.condition_value.value):this.keyupEnterScript(this.condition_config,this.condition_value)}},getEnumDataSetJson(i){let t=null;this.$$lib__.each(this.queryConfig.field,n=>{n.guid==i&&n.enum_type==this.global_query.enum_type.data_set.code&&n.data_set.dataSetId&&n.data_set.dataSetId!=""&&(t=JSON.parse(JSON.stringify(n)))}),this.$$lib__.each(this.queryConfig.condition,n=>{n.guid==i&&(n.control_type==this.global_query.control_type.select.code||n.control_type==this.global_query.control_type.selectTree.code||n.control_type==this.global_query.control_type.cascader.code||n.control_type==this.global_query.control_type.radio.code||n.control_type==this.global_query.control_type.checkbox.code)&&n.control_enum_type==this.global_query.enum_type.data_set.code&&n.data_set.dataSetId&&n.data_set.dataSetId!=""&&(t=JSON.parse(JSON.stringify(n)))});let o=null;if(t)o=t.data_set.dataSetId+"_"+i,this.updateDatasetInfo({key:o,data:[],isOk:!1,widgetId:this.widgetId});else{a.error("\u672A\u627E\u5230\u4E3B\u952EID\u4E3A["+i+"]\u7684\u67E5\u8BE2\u7ED3\u679C\u5217\u6216\u67E5\u8BE2\u6761\u4EF6");return}let p={dataSet:JSON.stringify(this.handleDataSetParam(t.data_set))};this.getDataSetSource(p,n=>{let f=[];n&&n.status==200?f=this.getDataSetObjectData(n.data,t.data_set.query,t.data_set.dimensionsAlias,t.data_set.dataSetId):c.Message.error({message:"\u6570\u636E\u96C6:[ "+t.data_set.dataSetName+" ]\u83B7\u53D6\u5931\u8D25\uFF0C"+n.msg,offset:60}),this.updateDatasetInfo({key:o,data:f,widgetId:this.widgetId})})},getEnumList(){let i=[];if(this.condition_config.control_enum_type==this.$$global_query.enum_type.data_set.code)this.condition_config.guid!=""&&this.condition_config.data_set.dataSetId!=""&&this.$$lib__.each(this.datasetInfo.datasetJson[this.condition_config.data_set.dataSetId+"_"+this.condition_config.guid],t=>{t.enumValue=t[this.condition_config.data_set.field_value],t.enumName=t[this.condition_config.data_set.field_name];let o=t[this.condition_config.data_set.field_disabled];o&&(o.toString()=="1"||o.toString()=="true")?t.disabled=!0:o&&(o.toString()=="0"||o.toString()=="false")&&(t.disabled=!1),i.push(t)});else{let t=this.enumInfo.enumJson[this.condition_config.control_enum_name];t&&(i=JSON.parse(JSON.stringify(t)),i=this.$$lib__.sortBy(i,"enumOrder"))}return i}}}},123731:function(v,s,e){e.r(s),e.d(s,{default:function(){return r}});var d=function(){var t=this,o=t._self._c;return o("div",[o("el-switch",{attrs:{"active-value":t.condition_config.attributes.active_value,"inactive-value":t.condition_config.attributes.inactive_value,"active-text":t.condition_config.attributes.active_text,"inactive-text":t.condition_config.attributes.inactive_text,"active-color":t.condition_config.attributes.active_color,"inactive-color":t.condition_config.attributes.inactive_color,disabled:t.condition_config.attributes.disabled},on:{change:t.changeValue},model:{value:t.condition_value,callback:function(g){t.condition_value=g},expression:"condition_value"}})],1)},_=[],c=e(509132),h={name:"control-switch",model:{prop:"value",event:"change"},mixins:[c.M],watch:{value(i){this.condition_value=i}},data(){return{condition_name:"\u5F00\u5173"}},mounted(){this.condition_value=this.value},methods:{changeValue(i){this.$emit("change",i!=""?i:null),this.afterChangeValue()}}},l=h,u=e(768141),a=(0,u.Z)(l,d,_,!1,null,"d91027c8",null),r=a.exports}}]);
