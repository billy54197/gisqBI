"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[4055],{56279:function(M,x,n){n.d(x,{P:function(){return v}});var D=n(86892),y=n(49500);const v={mixins:[D.D],created(){},methods:{lifecycleBeforeChartsLoad(u){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&y.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),y.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let S=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[u]);if(S)return S}return u},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&y.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),y.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},24055:function(M,x,n){n.r(x),n.d(x,{default:function(){return R}});var D=function(){var e=this,i=e._self._c;return i("div",{style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}},[i("hide-button",{attrs:{attr:e.widgetInfo.attr}}),i("div",{ref:"scatterThreeDimensional",style:{width:e.widgetInfo.attr.w+"px",height:e.widgetInfo.attr.hh+"px"}})],1)},y=[],v=n(44513),u=n(27966),w=n(61366),S=n(67157),f=n(50666);const J={mixins:[S.c],data(){return{config_extend:{config:{series:[{itemStyle:{color:"#222227"}},{itemStyle:{color:"#29CC97"}}]}},filter_config:{title:JSON.parse(JSON.stringify(f.Z.charts.title)),legend:JSON.parse(JSON.stringify(f.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(f.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(f.Z.charts.toolbox)),visualMap:JSON.parse(JSON.stringify(f.Z.charts.visualMap)),dataZoom:JSON.parse(JSON.stringify(f.Z.charts.dataZoom)),xAxis3D:JSON.parse(JSON.stringify(f.Z.charts.xAxis3D)),yAxis3D:JSON.parse(JSON.stringify(f.Z.charts.yAxis3D)),zAxis3D:JSON.parse(JSON.stringify(f.Z.charts.zAxis3D)),series:{label:{textStyle:{color:""}},itemStyle:{opacity:1,color:""},emphasis:{itemStyle:{color:""},label:{textStyle:{color:""}}}}}}},methods:{filterPredefineColoursSchemeConfig(t,e){if(this.getNewConfig(t,e,this.filter_config),this.getNewConfig_charts_visualMap_inRange_color(t.visualMap,e.visualMap),e.color&&e.color instanceof Array&&e.color.length>0)if(t.color&&t.color instanceof Array&&t.color.length>0)for(let i=0;i<t.color.length;i++)t.color[i]=e.color[i];else t.color=JSON.parse(JSON.stringify(e.color))}}};var A=n(56279),I=n(45061),z=n(26711),L=n(99349),B=n(8925),$=n(55616),C=n(75770),O=n(49500);const b=n(29426);var Z={props:["widgetInfo"],name:"scatter-three-dimensional",components:{HideButton:v.Z},mixins:[w.u,J,A.P,I.u,z.H,L.P],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},destroyed(){this.echarts.dispose()},mounted(){this.echarts=b.init(this.$refs.scatterThreeDimensional,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},methods:{loadInfo(t){let e=this.getData(t.dataset[t.dataset.type].encode,t.dataset[t.dataset.type].dimensionsAlias,t.dataset[t.dataset.type].source),i=this.getTooltip(t.config.tooltip),l=JSON.parse(JSON.stringify(t.config.xAxis3D));l.data=Array.from(new Set(e.xData));let s=JSON.parse(JSON.stringify(t.config.yAxis3D));s.data=Array.from(new Set(e.yData));let c=JSON.parse(JSON.stringify(t.config.zAxis3D));c.data=Array.from(new Set(e.zData));let r=JSON.parse(JSON.stringify(t.config.grid3D)),a=JSON.parse(JSON.stringify(t.config.series)),o=JSON.parse(JSON.stringify(t.config.visualMap));o.seriesIndex=o.show?0:-1;let N=JSON.parse(JSON.stringify(t.config.toolbox)),m=t.dataset[t.dataset.type].encode;t.config.visualMap.visualMapMin=="dataMin"&&(o.min=this.getVisualmapData(t,m.z)[0]),t.config.visualMap.visualMapMax=="dataMax"&&(o.max=this.getVisualmapData(t,m.z)[1]);let d={dataMax:0,dataMin:0,max:0,min:0};d=this.getPointSymbolSize(a,e.zData);let g={tooltip:i,toolbox:N,visualMap:this.getVisualMap(o),xAxis3D:l,yAxis3D:s,zAxis3D:c,grid3D:r,series:[{type:"scatter3D",coordinateSystem:"cartesian3D",symbol:"circle",symbolSize:function(h){let p=h[2]>0?Number((d.max-d.min)*(h[2]-d.dataMin)/(d.dataMax-d.dataMin))+Number(d.min):0;return Math.ceil(p)},animationDurationUpdate:500,blendMode:"source-over",progressive:1e5,progressiveThreshold:1e5,data:e.data.map(function(h){return{value:[h[0],h[1],h[2]]}}),shading:"lambert",label:this.getLabelStyle(a.label),itemStyle:a.itemStyle,emphasis:a.emphasis}]};O.log(g),this.echarts.dispose(),this.echarts=b.init(this.$refs.scatterThreeDimensional,null,{devicePixelRatio:2}),this.echarts.setOption(this.lifecycleBeforeChartsLoad(g),{notMerge:!0})},reLoadInfo(t){t&&(this.$refs.scatterThreeDimensional.style.width=t.attr.w+"px",this.$refs.scatterThreeDimensional.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getData(t,e,i){let l,s,c,r={xData:[],yData:[],zData:[],data:[]};return this.$$lib__.each(e,(a,o)=>{t.x&&a.name==t.x&&(l=o),t.y&&a.name==t.y&&(s=o),t.z&&a.name==t.z&&(c=o)}),this.$$lib__.each(i,a=>{l>=0?r.xData.push(a[l]):r.xData.push(0),s>=0?r.yData.push(a[s]):r.xData.push(0),c>=0?r.zData.push(a[c]):r.xData.push(0);let o=[];l>=0?o.push(a[l]):o.push(0),s>=0?o.push(a[s]):o.push(0),c>=0?o.push(a[c]):o.push(0),r.data.push(o)}),r.data=this.changeSourceType(r.data,r.xData,r.yData,r.zData),r},changeSourceType(t,e,i,l){let s=Array.from(new Set(e)),c=Array.from(new Set(i)),r=Array.from(new Set(l)),a=this.widgetInfo.config.xAxis3D.type,o=this.widgetInfo.config.yAxis3D.type,N=this.widgetInfo.config.zAxis3D.type,m=JSON.parse(JSON.stringify(t));return this.$$lib__.each(t,(d,g)=>{a=="category"&&this.$$lib__.each(s,(h,p)=>{d[0]==h&&(m[g][0]=p)}),o=="category"&&this.$$lib__.each(c,(h,p)=>{d[1]==h&&(m[g][1]=p)}),N=="category"&&this.$$lib__.each(r,(h,p)=>{d[2]==h&&(m[g][2]=p)})}),m},getPointSymbolSize(t,e){let i=[],l=0,s=0;t.isShowMax&&t.isShowMin?(t.max=20,t.min=5):!t.isShowMax&&t.isShowMin?(t.min=5,Number(t.max)<=Number(t.min)&&(t.max=Number(t.min)+1)):t.isShowMax&&!t.isShowMin&&(t.max=20,Number(t.max)<=Number(t.min)&&(t.min=Number(t.max)-1));let c=t.max,r=t.min;for(let a=0;a<e.length;a++)e[a]>0&&i.push(e[a]);return i.sort(function(a,o){return a-o}),i.length>0&&(l=i[i.length-1],s=i[0]),{dataMax:l,dataMin:s,max:c,min:r}},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let e=this;this.$$lib__.each(t.action.sendOut.actionList,i=>{if(i.enabled){let l=i.code+"_"+t.id;if(i.paramsExtend&&i.paramsExtend.length>0){let s={};this.getParamsExtend(s,i.paramsExtend,t)}i.code==C.Z.click.code&&e.onClick(l,i)}})},onClick(t,e){let i=this;i.echarts.on("click",l=>{let s={};if(s.x=l.value[0],s.y=l.value[1],s.z=l.value[2],e.script&&e.script.enabled){if(O.log("Execute script for "+i.widgetInfo.name+" component to "+e.name+" component"),e.script.content==""){$.Message.warning({message:e.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",e.script.content),s=this.customScript(s)}u.Z.$emit(t,s),e.postMessage&&i.doPostMessage(s),i.actionNameList.push(t)})}}},T=Z,E=n(68141),P=(0,E.Z)(T,D,y,!1,null,"feeacf6e",null),R=P.exports}}]);
