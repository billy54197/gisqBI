(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[47447],{419457:function(v,S,t){"use strict";var e=t(419534);Object.defineProperty(S,"__esModule",{value:!0}),S.default=void 0;var s=e(t(452909)),r=e(t(342579)),c=void 0,l={props:{isShow:{type:Boolean,default:!0},position:{type:Object,default:function(){return(0,r.default)(this,c),{type:"absolute",top:"1px",left:"1px"}}.bind(void 0)},isColumn:{type:Boolean,default:!1},title:{type:String},iconClass:{type:String},dragEnable:{type:Boolean,default:!1},showImg:{type:Boolean,default:!0},showLabel:{type:Boolean,default:!0},themeStyle:{type:Object}},data:function(){return{theme:"light"}},watch:{currentView:{handler:function(E){E==="earth"?this.theme="dark":this.theme="light"},immediate:!0}},mounted:function(){var E,C=this;this.$_mixin_generalButton=(0,s.default)(E=this.$children).call(E,function(B){return(0,r.default)(this,C),B.$options.name==="ShGeneralButton"}.bind(this))},methods:{getPosition:function(){var E;return(E=this.$_mixin_generalButton)===null||E===void 0?void 0:E.getPosition()}}},p=l;S.default=p},132726:function(v,S,t){"use strict";var e=t(149500),s=t(985208),r=t(659791),c=t(22466),l=t(183393),p=t(105077),x=t(419534);Object.defineProperty(S,"__esModule",{value:!0}),S.default=X;var E=x(t(611323)),C=x(t(543389)),B=x(t(934749)),O=x(t(342579)),T=x(t(985208)),h=x(t(828866)),f=x(t(22466)),d=x(t(581806)),A=x(t(705146));function L(g,U){var D=s(g);if(r){var I=r(g);U&&(I=c(I).call(I,function(N){return l(g,N).enumerable})),D.push.apply(D,I)}return D}function M(g){for(var U=1;U<arguments.length;U++){var D=arguments[U]!=null?arguments[U]:{};U%2?L(Object(D),!0).forEach(function(I){(0,C.default)(g,I,D[I])}):p?Object.defineProperties(g,p(D)):L(Object(D)).forEach(function(I){Object.defineProperty(g,I,l(D,I))})}return g}function W(g,U){for(var D=!1,I=g,N=function(){var q=this;I=I.$parent;var k=I.$refs;k&&(0,T.default)(k).forEach(function(_){(0,O.default)(this,q),k[_]===g&&(k[_]=U,D=!0)}.bind(this))};I.$parent&&!D;)N()}function X(g){var U,D,I=this,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},st=N.configName,q=N.componentName,k=N.transform,_=(0,h.default)(U=(0,f.default)(D=g.mixins||[]).call(D,function(K){return(0,O.default)(this,I),!!K.props}.bind(this))).call(U,function(K){return(0,O.default)(this,I),{props:K.props}}.bind(this));return{name:q||g.name,props:g.props,mixins:_,inject:{reactiveConfigInstance:{default:function(){var G=this;return function(){return(0,O.default)(this,G),null}.bind(this)}}},data:function(){return this.$configInfo={},{ready:!1}},computed:{configInstance:function(){return this.reactiveConfigInstance()}},mounted:function(){this.initConfig()},methods:{initConfig:function(){var G=this;return(0,B.default)(E.default.mark(function Y(){var V,$;return E.default.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!G.configInstance){P.next=17;break}return V=G.$options.name.replace("Sh",""),$={},P.prev=3,P.next=6,G.configInstance.getWidgetInfoByTag(st||V);case 6:$=P.sent,P.next=13;break;case 9:return P.prev=9,P.t0=P.catch(3),e.error(P.t0),P.abrupt("return");case 13:if($.stat){P.next=15;break}return P.abrupt("return");case 15:typeof k=="function"&&$.data?$=k($.data,G.configInstance.widgetInfo.mapConfig,{url:G.configInstance.url.replace("/role/getResources",""),schemeId:G.configInstance.schemeId}):$=$.data,G.$configInfo=M({},$);case 17:G.ready=!0;case 18:case"end":return P.stop()}},Y,null,[[3,9]])}))()},forwordRef:function(){var G;W(this._self,this._self.$children[0]),(G=this._self.$children[0])===null||G===void 0||G.$emit("mounted",this._self.$children[0])}},render:function(G){var Y,V=this,$;if((0,d.default)(Y=(0,T.default)(this.$listeners)).call(Y,"hook:mounted")){var lt;$=M(M({},this.$listeners),{},{"hook:mounted":(0,A.default)(lt=[this.forwordRef]).call(lt,this.$listeners["hook:mounted"])})}else $=M(M({},this.$listeners),{},{"hook:mounted":this.forwordRef});var P=this.$options.propsData;return(0,T.default)(P).forEach(function(at){(0,O.default)(this,V),P[at]===void 0&&delete P[at]}.bind(this)),this.ready?G(g,{on:$,scopedSlots:this.$scopedSlots,props:M(M({},this.$configInfo),P),attrs:this.$attrs},this.$slots.default):null}}}},112640:function(v,S,t){v.exports=function(e){var s={};function r(c){if(s[c])return s[c].exports;var l=s[c]={i:c,l:!1,exports:{}};return e[c].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=s,r.d=function(c,l,p){r.o(c,l)||Object.defineProperty(c,l,{enumerable:!0,get:p})},r.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},r.t=function(c,l){if(l&1&&(c=r(c)),l&8||l&4&&typeof c=="object"&&c&&c.__esModule)return c;var p=Object.create(null);if(r.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:c}),l&2&&typeof c!="string")for(var x in c)r.d(p,x,function(E){return c[E]}.bind(null,x));return p},r.n=function(c){var l=c&&c.__esModule?function(){return c.default}:function(){return c};return r.d(l,"a",l),l},r.o=function(c,l){return Object.prototype.hasOwnProperty.call(c,l)},r.p="/dist/",r(r.s=769)}({0:function(e,s){e.exports=t(342579)},1:function(e,s){e.exports=t(828866)},10:function(e,s){e.exports=t(42762)},118:function(e,s){e.exports=t(627482)},12:function(e,s){e.exports=t(465557)},130:function(e,s){e.exports=t(12207)},132:function(e,s){e.exports=t(372517)},134:function(e,s){e.exports=t(875907)},2:function(e,s,r){"use strict";r.d(s,"a",function(){return c});function c(l,p,x,E,C,B,O,T){var h=typeof l=="function"?l.options:l;p&&(h.render=p,h.staticRenderFns=x,h._compiled=!0),E&&(h.functional=!0),B&&(h._scopeId="data-v-"+B);var f;if(O?(f=function(L){L=L||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!L&&typeof __VUE_SSR_CONTEXT__<"u"&&(L=__VUE_SSR_CONTEXT__),C&&C.call(this,L),L&&L._registeredComponents&&L._registeredComponents.add(O)},h._ssrRegister=f):C&&(f=T?function(){C.call(this,(h.functional?this.parent:this).$root.$options.shadowRoot)}:C),f)if(h.functional){h._injectStyles=f;var d=h.render;h.render=function(M,W){return f.call(W),d(M,W)}}else{var A=h.beforeCreate;h.beforeCreate=A?[].concat(A,f):[f]}return{exports:l,options:h}}},22:function(e,s){e.exports=t(669033)},26:function(e,s){e.exports=t(234009)},28:function(e,s){e.exports=t(132726)},33:function(e,s){e.exports=t(330044)},34:function(e,s){e.exports=t(299085)},35:function(e,s){e.exports=t(349162)},36:function(e,s){e.exports=t(59269)},370:function(e,s){e.exports=t(561674)},371:function(e,s){e.exports=t(813866)},372:function(e,s){e.exports=t(865046)},374:function(e,s){e.exports=t(708326)},375:function(e,s){e.exports=t(17369)},381:function(e,s){e.exports=t(708326)},382:function(e,s){e.exports=t(542422)},414:function(e,s){e.exports=t(745105)},415:function(e,s){e.exports=t(561280)},416:function(e,s){e.exports=t(12207)},42:function(e,s){e.exports=t(647598)},472:function(e,s){e.exports=t(655878)},473:function(e,s){e.exports=t(500623)},474:function(e,s){e.exports=t(339211)},475:function(e,s){e.exports=t(10257)},476:function(e,s){e.exports=t(243566)},477:function(e,s){e.exports=t(355217)},5:function(e,s){e.exports=t(705146)},52:function(e,s){e.exports=t(407165)},6:function(e,s){e.exports=t(783574)},60:function(e,s){e.exports=t(308421)},61:function(e,s){e.exports=t(419457)},62:function(e,s){e.exports=t(197149)},66:function(e,s){e.exports=t(505085)},7:function(e,s){e.exports=t(17249)},769:function(e,s,r){"use strict";r.r(s);var c=r(0),l=r.n(c),p=function(){var n=this,i=n.$createElement,a=n._self._c||i;return a("div",{directives:[{name:"show",rawName:"v-show",value:n.shouldShow,expression:"shouldShow"}],staticClass:"sh-select-tool"},[a("div",{directives:[{name:"show",rawName:"v-show",value:n.isShow,expression:"isShow"}]},[n.$slots.default?a("span",{on:{click:function(){return n.toggle()}}},[n._t("default")],2):a("general-button",{attrs:{theme:n.theme,position:n.position,active:n.active,"is-column":n.isColumn,"drag-enable":n.dragEnable,"icon-class":n.iconClass?n.iconClass:"select-tool","show-img":n.showImg,"show-label":n.showLabel,"theme-style":n.themeStyle,title:n.title?n.title:"\u9009\u62E9"},on:{click:function(){return n.toggle()}}})],1)])},x=[];p._withStripped=!0;var E=r(12),C=r.n(E),B=r(10),O=r.n(B),T=r(9),h=r.n(T),f=r(33),d=r.n(f),A=r(34),L=r.n(A),M=r(26),W=r.n(M),X=r(1),g=r.n(X),U=r(5),D=r.n(U),I=r(8),N=r.n(I),st=r(22),q=r.n(st),k=r(85),_=r(381),K=r(66),G=r.n(K),Y=r(62),V=r(36),$=r(134),lt=r(414),P=r.n(lt),at=r(382),Dt=r(130),Pt=r.n(Dt),dt=r(374),Ot=r(415),Bt=r(375),vt=r.n(Bt),Mt=r(472),Nt=r.n(Mt),bt=r(473),Jt=r(474),Ut=r(475),Vt=r.n(Ut),Wt=r(35),gt=r.n(Wt),Kt=r(86),Yt=r.n(Kt),Ht=r(370),Et=r.n(Ht),zt=r(371),Tt=r.n(zt),Zt=r(372),jt=r.n(Zt),Ft=r(132),Xt=r(476),Qt=r.n(Xt),wt=r(42),it=r.n(wt),Lt=function(){var n=function(a,u){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,m){o.__proto__=m}||function(o,m){for(var y in m)m.hasOwnProperty(y)&&(o[y]=m[y])},n(a,u)};return function(i,a){n(i,a);function u(){this.constructor=i}i.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),kt={SELECT:"select"},qt=function(n){Lt(i,n);function i(a,u,o,m){var y=n.call(this,a)||this;return y.selected=u,y.deselected=o,y.mapBrowserEvent=m,y}return i}(Pt.a),yt=function(n){Lt(i,n);function i(a,u){var o=n.call(this,a)||this;return o.feature=u,o}return i}(Pt.a),_t=function(n){Lt(i,n);function i(a){var u=n.call(this,{handleEvent:te})||this,o=a||{};u.condition_=o.condition?o.condition:dt.singleClick,u.addCondition_=o.addCondition?o.addCondition:dt.platformModifierKeyOnly,u.removeCondition_=o.removeCondition?o.removeCondition:dt.never,u.toggleCondition_=o.toggleCondition?o.toggleCondition:dt.altKeyOnly,u.multi_=o.multi?o.multi:!1,u.filter_=N()(o)?N()(o):Ot.TRUE,u.hitTolerance_=o.hitTolerance?o.hitTolerance:0,u.style_=o.style!=null?o.style:ee(),u.featureStyleAssociation_={},u.features_=o.features||new Vt.a;var m;if(o.layers)if(typeof o.layers=="function")m=o.layers;else{var y=o.layers;m=function(Q){return Object(at.includes)(y,Q)}}else m=Ot.TRUE;u.layerFilter_=m,u.featureLayerAssociation_={};var J=u.getFeatures();return J.addEventListener(P.a.ADD,u.addFeature_.bind(u)),J.addEventListener(P.a.REMOVE,u.removeFeature_.bind(u)),u}return i.prototype.addFeatureLayerAssociation_=function(a,u){this.featureLayerAssociation_[Object($.getUid)(a)]=u},i.prototype.getFeatures=function(){return this.features_},i.prototype.getHitTolerance=function(){return this.hitTolerance_},i.prototype.getLayer=function(a){return this.featureLayerAssociation_[Object($.getUid)(a)]},i.prototype.setHitTolerance=function(a){this.hitTolerance_=a},i.prototype.setMap=function(a){a&&(this.layerManager=a.layerManager),a&&this.style_&&this.features_.forEach(this.removeSelectedStyle_.bind(this)),n.prototype.setMap.call(this,a),a&&this.style_&&this.features_.forEach(this.giveSelectedStyle_.bind(this))},i.prototype.addFeature_=function(a){var u=a.element;this.style_&&this.giveSelectedStyle_(u)},i.prototype.removeFeature_=function(a){var u=a.element;this.style_&&this.removeSelectedStyle_(u)},i.prototype.giveSelectedStyle_=function(a){var u=Object($.getUid)(a);this.featureStyleAssociation_[u]=a.getStyle(),a.setStyle(this.style_)},i.prototype.removeSelectedStyle_=function(a){var u=Object($.getUid)(a);a.setStyle(this.featureStyleAssociation_[u]),delete this.featureStyleAssociation_[u]},i.prototype.removeFeatureLayerAssociation_=function(a){delete this.featureLayerAssociation_[Object($.getUid)(a)]},i.prototype.setIsStayAdd=function(a){this.isStayAddValue=a},i.prototype.isStayAdd=function(){return this.isStayAddValue},i}(Nt.a);function te(n){var i=this;if(!this.condition_(n))return!0;var a;this.isStayAdd()?a=this.add=!0:a=this.add=this.addCondition_(n);var u=this.remove=this.removeCondition_(n),o=this.toggle=this.toggleCondition_(n),m=!a&&!u&&!o,y=this.map=g()(n);this.features=this.getFeatures(),this.deselected=[],this.selected=[];var J=new gt.a,et=new Yt.a(y.getCoordinateFromPixel(n.pixel)),Q=J.writeGeometry(et);if(m){Object(bt.clear)(this.featureLayerAssociation_),y.forEachFeatureAtPixel(n.pixel,function(j,R){if(this.filter_(j,R))return this.selected.push(j),this.addFeatureLayerAssociation_(j,R),R.values_.id===V.BASE_DRAWLAYER_ID&&(j.set("layerTag","temp"),j.set("tempSelected",!0),this.dispatchEvent(new yt("featureSelected",j))),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var b=this.features.getLength()-1;b>=0;--b){var w=this.features.item(b),F=this.selected.indexOf(w);if(F>-1){var rt;q()(rt=this.selected).call(rt,F,1)}else this.features.remove(w),this.deselected.push(w)}if(this.selected.length!==0&&this.features.extend(this.selected),this.currentEditTargetLayer=this.layerManager.getEditLayer()?this.layerManager.getEditLayer().metadata:null,this.currentEditTargetLayer!=null){if(this.currentEditTargetLayer.type==="dynamic"||this.currentEditTargetLayer.type==="feature"||this.currentEditTargetLayer.type==="feature-pbf"){var H=this.currentEditTargetLayer.selectLayer?this.currentEditTargetLayer.selectLayer:this.currentEditTargetLayer.visibleLayers.join(","),ut={layers:"visible:"+H};N()(this.currentEditTargetLayer)&&(ut.layerDefs=N()(this.currentEditTargetLayer)),this.currentEditTargetLayer.authkey&&(ut.authkey=this.currentEditTargetLayer.authkey);var St=new jt.a(this.currentEditTargetLayer.url,ut,this.currentEditTargetLayer);St.at(Q,{map:y}),St.run().then(function(j){if(l()(this,i),j.results.length){var R=new it.a({geometry:J.readGeometry(j.results[0].geometry)});pt(j.results[0],R),At(this,R)}}.bind(this))}else if(this.currentEditTargetLayer.type==="geoserver-wms"||this.currentEditTargetLayer.type==="geoserver-wfs"){var ct=new Et.a(this.currentEditTargetLayer,Q,{map:y}),xt=new Tt.a;xt.execute(ct).then(function(j){if(l()(this,i),j.results.length){var R=new it.a({geometry:J.readGeometry(j.results[0].geometry)});pt(j.results[0],R),At(this,R)}}.bind(this))}}}else{y.forEachFeatureAtPixel(n.pixel,function(j,R){if(this.filter_(j,R))return R.values_.id===V.BASE_DRAWLAYER_ID&&(j.set("layerTag","temp"),this.selected.push(j),this.dispatchEvent(new yt("featureSelected",j))),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var ft=this.deselected.length-1;ft>=0;--ft)this.features.remove(this.deselected[ft]);if(this.features.extend(this.selected),this.currentEditTargetLayer=this.layerManager.getEditLayer()?this.layerManager.getEditLayer().metadata:null,this.currentEditTargetLayer!=null){if(this.currentEditTargetLayer.type==="dynamic"||this.currentEditTargetLayer.type==="feature"||this.currentEditTargetLayer.type==="feature-pbf"){var ht={layers:"visible:"+this.currentEditTargetLayer.visibleLayers.join(",")};N()(this.currentEditTargetLayer)&&(ht.layerDefs=N()(this.currentEditTargetLayer)),this.currentEditTargetLayer.authkey&&(ht.authkey=this.currentEditTargetLayer.authkey);var z=new jt.a(this.currentEditTargetLayer.url,ht,this.currentEditTargetLayer);z.at(Q,{map:y}),z.run().then(function(j){if(l()(this,i),j.results.length){var R=new it.a({geometry:J.readGeometry(j.results[0].geometry)});pt(j.results[0],R),It(this,R)}}.bind(this))}else if(this.currentEditTargetLayer.type==="geoserver-wms"||this.currentEditTargetLayer.type==="geoserver-wfs"){var nt=new Et.a(this.currentEditTargetLayer,Q,{map:y}),Z=new Tt.a;Z.execute(nt).then(function(j){if(l()(this,i),j.results.length){var R=new it.a({geometry:J.readGeometry(j.results[0].geometry)});pt(j.results[0],R),It(this,R)}}.bind(this))}}}return this.dispatchEvent(new qt(kt.SELECT,this.selected,this.deselected,n)),!0}function pt(n,i){for(var a in n.attributes)i.set(a?.toLowerCase(),n.attributes[a])}function At(n,i){i.set("layerTag",n.currentEditTargetLayer.layerTag),n.dispatchEvent(new yt("featureSelected",i));for(var a=g()(n).getSelectFeatures(),u=0;u<a.length;u++){var o=a[u];o.get("isSelected")&&(q()(a).call(a,u,1),u--,g()(n).getLayerById(V.BASE_DRAWLAYER_ID).getSource().removeFeature(o))}i.set("isSelected",!0),i.setStyle(Y.selectStyles),g()(n).getLayerById(V.BASE_DRAWLAYER_ID).getSource().addFeature(i),n.selected.push(i),n.addFeatureLayerAssociation_(i,g()(n).getLayerById(n.currentEditTargetLayer.id));for(var m=n.features.getLength()-1;m>=0;--m){var y=n.features.item(m),J=n.selected.indexOf(y);if(J>-1){var et;q()(et=n.selected).call(et,J,1)}else n.features.remove(y),n.deselected.push(y)}n.selected.length!==0&&n.features.extend(n.selected)}function It(n,i){n.dispatchEvent(new yt("featureSelected",i));var a=i;a.set("isSelected",!0),n.selected.push(a),(n.add||n.toggle)&&!$t(n.features.getArray(),a)?(a.setStyle(Y.selectStyles),g()(n).getLayerById(V.BASE_DRAWLAYER_ID).getSource().addFeature(a),n.selected.push(a),n.addFeatureLayerAssociation_(a,g()(n).getLayerById(n.currentEditTargetLayer.id))):(n.remove||n.toggle)&&$t(n.features.getArray(),a)&&(n.deselected.push(a),n.removeFeatureLayerAssociation_(a));for(var u=n.deselected.length-1;u>=0;--u)n.features.remove(n.deselected[u]);n.features.extend(n.selected)}function ee(){var n=Object(Jt.createEditingStyle)();return Object(at.extend)(n[vt.a.POLYGON],n[vt.a.LINE_STRING]),Object(at.extend)(n[vt.a.GEOMETRY_COLLECTION],n[vt.a.LINE_STRING]),function(i){return i.getGeometry()?n[i.getGeometry().getType()]:null}}function $t(n,i){for(var a=0;a<n.length;a++){var u=Object(Ft.getGeom)(new gt.a().writeFeatureObject(n[a])),o=Object(Ft.getGeom)(new gt.a().writeFeatureObject(i));if(Qt()(u,o))return!0}return!1}var re=_t,ne=r(118),ae=r.n(ne),ie=r(52),oe=r.n(ie),se=r(416),Gt=r.n(se),le=r(477);function Ct(n){var i=ue();return function(){var u=W()(n),o;if(i){var m=W()(this).constructor;o=C()(u,arguments,m)}else o=u.apply(this,arguments);return L()(this,o)}}function ue(){if(typeof Reflect>"u"||!C.a||C.a.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(C()(Boolean,[],function(){})),!0}catch{return!1}}var tt={CHANGEACTIVE:"change:active",SELECTED:"selected"},Rt=function(n){d()(a,n);var i=Ct(a);function a(u,o){var m;return h()(this,a),m=i.call(this,u),m.active=o,m}return O()(a)}(Gt.a),ot=function(n){d()(a,n);var i=Ct(a);function a(u,o){var m;return h()(this,a),m=i.call(this,u),m.selected=o,m}return O()(a)}(Gt.a),ce=function(n){d()(a,n);var i=Ct(a);function a(u){var o;return h()(this,a),o=i.call(this),o.name="SelectTool",o.active=!1,o.map=u,o.tempLayer=g()(o).getLayerById(V.BASE_DRAWLAYER_ID),o.addCondition_=_.platformModifierKeyOnly,o.toggleCondition_=_.altKeyOnly,o.originStyles=[],o.select=null,o.dragBox=null,o}return O()(a,[{key:"init",value:function(){var o=this;this.layerManager=g()(this).layerManager,this.currentEditTargetLayer=this.layerManager.getEditLayer()?this.layerManager.getEditLayer().metadata:null;for(var m=this.currentEditTargetLayer?[g()(this).getLayerById(this.currentEditTargetLayer.id),this.tempLayer]:[this.tempLayer],y=[],J=0,et=m;J<et.length;J++){var Q=et[J];Q instanceof ae.a?y=D()(y).call(y,Q.getLayers().getArray()):y.push(Q)}this.select=new re({layers:y,style:!1}),g()(this).addInteraction(this.select),this.dragBox=new k.DragBox({condition:_.shiftKeyOnly}),g()(this).addInteraction(this.dragBox),g()(this).getTargetElement().style.cursor="auto",this.selectedFeatures=this.select.getFeatures(),this.dragBox.on("boxend",function(){var b,w=this;l()(this,o);var F=(b=this.layerManager.getEditLayer())===null||b===void 0?void 0:b.metadata,rt=new gt.a,H=rt.writeGeometry(this.dragBox.getGeometry()),ut=this.dragBox.getGeometry().getExtent(),St=g()(this).getLayers().getArray();if(St.forEach(function(z){var nt=this;l()(this,w),(F&&z.get("id")===F.id||z.get("id")===V.BASE_DRAWLAYER_ID)&&z instanceof G.a&&(z.getSource().forEachFeatureIntersectingExtent(ut,function(Z){l()(this,nt),Z.id_?this.setFeatureSelected(Z):(Z.setStyle(Y.selectStyles),Z.set("tempSelected",!0),this.selectedFeatures.push(Z))}.bind(this)),this.dispatchEvent(new ot(tt.SELECTED,g()(this).getSelectFeatures())))}.bind(this)),F&&(F.type==="dynamic"||F.type==="feature"||F.type==="feature-pbf")){var ct={layers:"visible:"+F.visibleLayers.join(",")};N()(F)&&(ct.layerDefs=N()(F)),F.authkey&&(ct.authkey=F.authkey);var xt=new jt.a(F.url,ct,F);xt.at(H,{map:g()(this)}),xt.run().then(function(z){var nt=this;l()(this,w),z.results.forEach(function(Z){l()(this,nt);var j=new it.a({geometry:rt.readGeometry(Z.geometry)});this.setFeatureSelected(j),this.selectedFeatures.push(j)}.bind(this)),this.dispatchEvent(new ot(tt.SELECTED,g()(this).getSelectFeatures()))}.bind(this))}else if(F&&(F.type==="geoserver-wms"||F.type==="geoserver-wfs")){var ft=new Et.a(F,H,{map:g()(this)}),ht=new Tt.a;ht.execute(ft).then(function(z){var nt=this;l()(this,w),z.results.forEach(function(Z){l()(this,nt);var j=new it.a({geometry:rt.readGeometry(Z.geometry)});this.setFeatureSelected(j),this.selectedFeatures.push(j)}.bind(this)),this.dispatchEvent(new ot(tt.SELECTED,g()(this).getSelectFeatures()))}.bind(this))}}.bind(this)),this.select.on("select",function(b){l()(this,o);var w=this.addCondition_(b.mapBrowserEvent),F=this.toggleCondition_(b.mapBrowserEvent),rt=g()(this).getSelectFeatures();if(w||F||this.handleGraphic(rt),b.selected.length>0){var H=b.selected[0];H.get("tempSelected")===!1?(H.set("tempSelected",!0),H.setStyle(Y.selectStyles)):H.id_&&(this.setFeatureSelected(H),this.dispatchEvent(new ot(tt.SELECTED,H)))}else w||this.dispatchEvent(new ot(tt.SELECTED,null))}.bind(this)),this.select.on("featureSelected",function(b){l()(this,o),this.dispatchEvent(new ot(tt.SELECTED,b.feature))}.bind(this)),this.dragBox.on("boxstart",function(){l()(this,o);var b=g()(this).getSelectFeatures();this.handleGraphic(b)}.bind(this))}},{key:"handleGraphic",value:function(o){for(var m=0;m<o.length;m++){var y=o[m];y.get("tempSelected")?(y.set("tempSelected",!1),y.beforeSelectStyle?y.setStyle(Object(le.getStyle)(y.drawType,y.beforeSelectStyle)):y.originalStyle?y.setStyle(y.originalStyle):y.setStyle(this.tempLayer?this.tempLayer.getStyle():Y.defaultStyles)):y.get("isSelected")&&(q()(o).call(o,m,1),m--,g()(this).getLayerById(V.BASE_DRAWLAYER_ID).getSource().removeFeature(y))}}},{key:"setFeatureSelected",value:function(o){o.setStyle(Y.selectStyles),o.set("isSelected",!0),g()(this).getLayerById(V.BASE_DRAWLAYER_ID).getSource().addFeature(o)}},{key:"activate",value:function(){this.init(),this.active=!0,this.dispatchEvent(new Rt(tt.CHANGEACTIVE,this.active))}},{key:"deactivate",value:function(){g()(this).removeInteraction(this.select),g()(this).removeInteraction(this.dragBox),this.active=!1,this.dispatchEvent(new Rt(tt.CHANGEACTIVE,this.active))}}]),a}(oe.a),fe=ce,he=r(60),de=r.n(he),ve=r(6),ge=r.n(ve),ye=r(7),pe=r.n(ye),me=r(61),Se=r.n(me),xe=void 0,Ee={name:"ShSelectTool",components:{GeneralButton:de.a},mixins:[ge.a,pe.a,Se.a],props:{position:{type:Object,default:function(){return l()(this,xe),{type:"absolute",top:"1px",left:"70px"}}.bind(void 0)},returnType:{type:String,default:"geojson"}},data:function(){return this.selectTool,{shouldShow:!1,active:!1}},watch:{currentView:{handler:function(i){this.shouldShow=i==="map"},immediate:!0},currentInteraction:function(i){i!==this.$options.name&&this.active&&this.deactivate()}},mounted:function(){var i=this;this.$map&&setTimeout(function(){l()(this,i),this.begin()}.bind(this),0),this.subscribe.$on("identify-popup-buffer-card:changeSelect",function(a){l()(this,i),a?this.activate():this.active&&(this.deactivate(),this.selectTool.handleGraphic(this.$map.getSelectFeatures()))}.bind(this))},methods:{begin:function(){var i=this;this.selectTool=new fe(this.$map),this.selectTool.on("change:active",function(a){l()(this,i),this.active=a.active,this.$emit("change:active",a.active)}.bind(this)),this.selectTool.on("selected",function(a){l()(this,i);var u=null;this.returnType==="geojson"?u=this.$map.transformGeo(a.selected):u=a.selected,this.$emit("selected",u)}.bind(this)),this.subscribe.$on("union-tool:change:isStayAdd",function(a){l()(this,i),this.selectTool.select.setIsStayAdd(a)}.bind(this))},activate:function(){this.selectTool.activate()},deactivate:function(){this.selectTool.deactivate()},toggle:function(i){var a;typeof i=="boolean"?a=i:a=!this.selectTool.active,a?this.activate():this.deactivate()}}},Te=Ee,je=r(2),Le=Object(je.a)(Te,p,x,!1,null,null,null),Ce=Le.exports,Pe=r(28),Oe=r.n(Pe),Fe=void 0,mt=Oe()(Ce,{transform:function(i){l()(this,Fe);var a=i.show,u=i.label,o=i.position;return{isShow:a,title:u,position:o}}.bind(void 0)});mt.install=function(n){n.component(mt.name,mt)};var Ae=s.default=mt},8:function(e,s){e.exports=t(22466)},85:function(e,s){e.exports=t(612768)},86:function(e,s){e.exports=t(223378)},9:function(e,s){e.exports=t(122777)}})},439705:function(v,S,t){"use strict";var e=t(419534);Object.defineProperty(S,"__esModule",{value:!0}),S.getFeaturesFromGeoJson=l,S.getGeoJsonFromFeature=x,S.getGeoJsonFromFeatures=p,S.getGeoJsonFromGeometry=E,S.transformCoordinate=C,S.transformExtent=B,S.transformGeojson=O;var s=t(972233),r=e(t(349162)),c=t(481534);function l(T){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=h.dataProjection,d=h.featureProjection;T.type||(T=JSON.parse(T));var A=T.crs,L=A?A.properties.name:"";L=L.replace("urn:ogc:def:crs:","").replace("::",":"),L&&(0,c.registerProj)(L),f&&(0,c.registerProj)(f),d&&(0,c.registerProj)(d);var M={dataProjection:L||f,featureProjection:d},W=new r.default().readFeatures(T,M);return W}function p(T){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=h.dataProjection,d=h.featureProjection;f&&(0,c.registerProj)(f),d&&(0,c.registerProj)(d);var A={dataProjection:f,featureProjection:d},L=new r.default().writeFeatures(T,A);return L}function x(T){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=h.dataProjection,d=h.featureProjection;f&&(0,c.registerProj)(f),d&&(0,c.registerProj)(d);var A={dataProjection:f,featureProjection:d};return new r.default().writeFeature(T,A)}function E(T){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=h.dataProjection,d=h.featureProjection;f&&(0,c.registerProj)(f),d&&(0,c.registerProj)(d);var A={dataProjection:f,featureProjection:d};return new r.default().writeGeometry(T,A)}function C(T,h,f){return(0,c.registerProj)(h),(0,c.registerProj)(f),(0,s.transform)(T,h,f)}function B(T,h,f){return(0,c.registerProj)(h),(0,c.registerProj)(f),(0,s.transformExtent)(T,h,f)}function O(){}},376886:function(v,S,t){"use strict";t.r(S),t.d(S,{default:function(){return h}});var e=function(){var d=this,A=d._self._c;return A("div",{directives:[{name:"show",rawName:"v-show",value:d.widgetInfo.attr.hide!=!0,expression:"widgetInfo.attr.hide != true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:d.widgetInfo.attr.w+"px",height:d.widgetInfo.attr.hh+"px"}},[A("SelectTool",d._b({style:{width:d.widgetInfo.attr.w+"px",height:d.widgetInfo.attr.hh+"px"},attrs:{"widget-info":d.widgetInfo,"theme-style":d.themeConfig,position:d.btnPosition},on:{openStatus:d.changeStatus}},"SelectTool",d.widgetInfo.config.btnConfig,!1))],1)},s=[],r=t(112640),c=t.n(r),l=t(386892),p=t(445061),x=t(927966),E=t(950681),C={name:"GisSelect",components:{SelectTool:c()},mixins:[l.D,p.u,E.Z],props:["widgetInfo"],data(){return{fontSize:"12px;",width:"16px",height:"16px",isMobile:!1}},mounted(){this.initAction(this.widgetInfo),x.Z.$on("unionClicked",()=>{this.isMobile=!0})},methods:{reLoadInfo(f){this.btnAttr=f.attr},changeStatus(f){this.$refs.drawBtn.changeBtn(f)},initAction(f){this.actionReceive(f)}}},B=C,O=t(768141),T=(0,O.Z)(B,e,s,!1,null,"29210bec",null),h=T.exports},105077:function(v,S,t){v.exports=t(272873)},659791:function(v,S,t){v.exports=t(169127)},298924:function(v,S,t){v.exports=t(475595)},122777:function(v){function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}v.exports=S,v.exports.__esModule=!0,v.exports.default=v.exports},42762:function(v,S,t){var e=t(857448),s=t(168871);function r(l,p){for(var x=0;x<p.length;x++){var E=p[x];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),e(l,s(E.key),E)}}function c(l,p,x){return p&&r(l.prototype,p),x&&r(l,x),e(l,"prototype",{writable:!1}),l}v.exports=c,v.exports.__esModule=!0,v.exports.default=v.exports},543389:function(v,S,t){var e=t(857448),s=t(168871);function r(c,l,p){return l=s(l),l in c?e(c,l,{value:p,enumerable:!0,configurable:!0,writable:!0}):c[l]=p,c}v.exports=r,v.exports.__esModule=!0,v.exports.default=v.exports},259631:function(v,S,t){"use strict";t(125902);var e=t(594388);v.exports=e.Object.getOwnPropertyDescriptors},481640:function(v,S,t){"use strict";t(46932);var e=t(594388);v.exports=e.Object.getOwnPropertySymbols},180744:function(v,S,t){"use strict";t(66032);var e=t(594388);v.exports=e.Object.values},245291:function(v,S,t){"use strict";var e=t(714451),s=t(427909),r=t(636021),c=t(66167),l=t(898564),p=t(204036),x=t(707196).f,E=r(x),C=r([].push),B=e&&s(function(){var T=Object.create(null);return T[2]=2,!E(T,2)}),O=function(T){return function(h){for(var f=p(h),d=l(f),A=B&&c(f)===null,L=d.length,M=0,W=[],X;L>M;)X=d[M++],(!e||(A?X in f:E(f,X)))&&C(W,T?[X,f[X]]:f[X]);return W}};v.exports={entries:O(!0),values:O(!1)}},125902:function(v,S,t){"use strict";var e=t(190434),s=t(714451),r=t(883419),c=t(204036),l=t(168428),p=t(259063);e({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(E){for(var C=c(E),B=l.f,O=r(C),T={},h=0,f,d;O.length>h;)d=B(C,f=O[h++]),d!==void 0&&p(T,f,d);return T}})},66032:function(v,S,t){"use strict";var e=t(190434),s=t(245291).values;e({target:"Object",stat:!0},{values:function(c){return s(c)}})},272873:function(v,S,t){"use strict";var e=t(259631);v.exports=e},169127:function(v,S,t){"use strict";var e=t(481640);v.exports=e},475595:function(v,S,t){"use strict";var e=t(180744);v.exports=e}}]);
