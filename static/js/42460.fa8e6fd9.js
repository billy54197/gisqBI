"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[42460],{752246:function(I,h,o){o.d(h,{X:function(){return c},b:function(){return f}});let c={versions:function(){var s=navigator.userAgent;return{trident:s.indexOf("Trident")>-1,presto:s.indexOf("Presto")>-1,webKit:s.indexOf("AppleWebKit")>-1,gecko:s.indexOf("Gecko")>-1&&s.indexOf("KHTML")==-1,mobile:!!s.match(/AppleWebKit.*Mobile.*/),ios:!!s.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:s.indexOf("Android")>-1,iPhone:s.indexOf("iPhone")>-1,iPad:s.indexOf("iPad")>-1,webApp:s.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},f;c.versions.mobile||c.versions.ios||c.versions.android||c.versions.iPhone||c.versions.iPad?f=!1:f=!0},459738:function(I,h,o){o.d(h,{OW:function(){return f},m3:function(){return w},nm:function(){return s},vP:function(){return g},xC:function(){return v}});var c=o(153258);function f(t,n,a){let e=t;const u=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(y=>(0,c.mf)(e[y]));if(!(0,c.mf)(e[u]))return!1;do{if(e[u](n))return!0;if(e===a)return!1;e=e.parentNode}while(e);return!1}function s(t){const n=window.getComputedStyle(t);return[parseFloat(n.getPropertyValue("width"),10),parseFloat(n.getPropertyValue("height"),10)]}function g(t,n,a){t&&(t.attachEvent?t.attachEvent("on"+n,a):t.addEventListener?t.addEventListener(n,a,!0):t["on"+n]=a)}function v(t,n,a){t&&(t.detachEvent?t.detachEvent("on"+n,a):t.removeEventListener?t.removeEventListener(n,a,!0):t["on"+n]=null)}function w(t,n,a,e){var u=0,y=setInterval(()=>{u<a?(u++,t()):(clearInterval(y),e&&e())},n);return y}},153258:function(I,h,o){o.d(h,{ew:function(){return g},le:function(){return v},mf:function(){return c},sg:function(){return w},xn:function(){return f}});function c(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function f(t,n,a,e=1){const u=Math.round(n/e/t[0])*t[0],y=Math.round(a/e/t[1])*t[1];return[u,y]}function s(t){const n=t.getBoundingClientRect();return[parseInt(n.width),parseInt(n.height)]}function g(t,n,a){return t-n-a}function v(t,n,a){return t-n-a}function w(t,n,a){return n!==null&&t<n?n:a!==null&&a<t?a:t}},844513:function(I,h,o){o.d(h,{Z:function(){return n}});var c=function(){var e=this,u=e._self._c;return e.attr.buttonHide?u("div",{style:{position:"absolute",right:e.attr.buttonHideRight+"px",top:e.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(y){return e.onHide()}}},[e.openTooltip?u("el-tooltip",{attrs:{"open-delay":1e3,content:e.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[u("el-button",{class:e.attr.buttonHideIconClass&&e.attr.buttonHideIconClass!=""?e.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:e.attr.buttonHideColor,fontSize:e.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):u("el-button",{class:e.attr.buttonHideIconClass&&e.attr.buttonHideIconClass!=""?e.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:e.attr.buttonHideColor,fontSize:e.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):e._e()},f=[],s=o(752246),g={props:["attr"],name:"hide-button",data(){return{isPc:s.b}},computed:{openTooltip:function(){let a=!1,e=this.attr.buttonHideTooltipContent;return s.b&&e&&e!=null&&e.trim()!=""&&(a=!0),a}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},v=g,w=o(768141),t=(0,w.Z)(v,c,f,!1,null,"bf399b9a",null),n=t.exports},142460:function(I,h,o){o.r(h),o.d(h,{default:function(){return K}});var c=function(){var i=this,r=i._self._c;return r("div",{directives:[{name:"show",rawName:"v-show",value:i.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[r("hide-button",{attrs:{attr:i.widgetInfo.attr}})],1)},f=[],s=o(844513),g=o(927966),v=o(29340),w=o(445061),t=o(126711),n=o(386892),a=o(337564),e=o(776094),u=o(682571),y=o(660316),p=o(568640),F=o(23230),S=o(505689),P=o(413798),L=o(313811),k=o(2487),C=o(372449),H=o(459738),m=o(149500),E={name:"GisXmlocation",components:{HideButton:s.Z},mixins:[v.baseConfig,n.D,w.u,t.H],props:["widgetInfo"],data(){return{timer:"",map:null,iconLayer:null,blockLayer:null,solutionStyle:null,solution1Style:null,solution2Style:null,highlightStyle:null,normalStyle:null,blockSource:null,solutionSource:null,solutionLayer:null,currentBlockId:null,solutionFeature:null,blockFeature:null}},watch:{},beforeDestroy(){},mounted(){this.initAction(this.widgetInfo),this.timer=(0,H.m3)(this.getBindMap,500,50,()=>{m.error("gis-xmlocation\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")})},methods:{loadInfo(l){m.log(l)},reLoadInfo(l){m.log("\u914D\u7F6E\u66F4\u65B0\u4E86"),this.loadInfo(l)},initAction(l){this.registerAction(l,"configMap","mapList",this.doConfigMap);let i=this;g.Z.$on("searchBlock",r=>{i.initBlockLayer()}),g.Z.$on("locateBlock",r=>{i.locateBlock(r)}),g.Z.$on("showSolution",r=>{i.showSolution(r)}),this.actionReceive(l)},initBlockLayer(){this.blockLayer&&this.map.removeLayer(this.blockLayer),this.solutionLayer&&this.map.removeLayer(this.solutionLayer),this.iconLayer&&this.map.removeLayer(this.iconLayer);let l=[];var i=new u.ZP({image:new y.Z({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"xmlocation/locate.png"})}),r=new L.Z({geometry:new P.Z([120.57081369709772,30.599520021203983]),name:"\u5730\u57571",population:4e3,rainfall:500});r.setStyle(i);var d=new L.Z({geometry:new P.Z([120.59287885888347,30.643132218627763]),name:"\u5730\u57572",population:4e3,rainfall:500});d.setStyle(i);var b=new L.Z({geometry:new P.Z([120.59109639854998,30.611971580883083]),name:"\u5730\u57573",population:4e3,rainfall:500});b.setStyle(i),l.push(r),l.push(d),l.push(b);var x=new k.default({features:l});this.highlightStyle=new u.ZP({fill:new p.Z({color:"rgba(	0,255,255, 0.3)"}),stroke:new F.Z({color:"#00FA9A",width:1.5}),image:new S.Z({radius:7,fill:new p.Z({color:"#ffcc33"})})}),this.normalStyle=new u.ZP({fill:new p.Z({color:"rgba(	255,0,0, 0.3)"}),stroke:new F.Z({color:"#FF0000",width:1.5}),image:new S.Z({radius:7,fill:new p.Z({color:"#ffcc33"})})}),this.solutionStyle=new u.ZP({fill:new p.Z({color:"rgba(	255,0,0, 0.0)"}),stroke:new F.Z({color:"rgba(	255,0,0, 0.0)",width:1}),image:new S.Z({radius:7,fill:new p.Z({color:"#ffcc33"})})}),this.solution1Style=new u.ZP({fill:new p.Z({color:"rgba(255,255,0, 0.2)"}),stroke:new F.Z({color:"#FFFF00",width:1.5}),image:new S.Z({radius:7,fill:new p.Z({color:"#ffcc33"})})}),this.solution2Style=new u.ZP({fill:new p.Z({color:"rgba(255,0,0, 0.2)"}),stroke:new F.Z({color:"#FF0000",width:1.5}),image:new S.Z({radius:7,fill:new p.Z({color:"#ffcc33"})})});let Z={type:"FeatureCollection",name:"block",crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4490"}},features:[{type:"Feature",properties:{Key:"FID",Value:"0"},geometry:{type:"MultiPolygon",coordinates:[[[[120.56955207106705,30.597881454202366],[120.56939113852616,30.597881454202366],[120.56970227477177,30.600874799462872],[120.57204116103287,30.600971358987522],[120.57235229727848,30.59877194759531],[120.5714188885413,30.598374980661163],[120.57059276816483,30.598149675103855],[120.56993830916508,30.59794582721878],[120.56955207106705,30.597881454202366]]]]}},{type:"Feature",properties:{Key:"FID",Value:"3"},geometry:{type:"MultiPolygon",coordinates:[[[[120.59447785572843,30.641418852214088],[120.59321185307351,30.641139902476482],[120.59188147740201,30.641247190837078],[120.59186001972989,30.641547598246802],[120.59196730809049,30.641933836344833],[120.59173127369729,30.642534651164226],[120.59065839009133,30.64296380460661],[120.59087296681253,30.64463750303196],[120.594198905991,30.644980825785865],[120.59424182133512,30.644916452769394],[120.59482117848245,30.642362989787216],[120.59447785572843,30.641418852214088]]]]}},{type:"Feature",properties:{Key:"FID",Value:"6"},geometry:{type:"MultiPolygon",coordinates:[[[[120.59154842293606,30.613143826075316],[120.59205267823086,30.610965872355223],[120.59028242028103,30.611040974207754],[120.59038970864162,30.611985111780882],[120.59033606446133,30.61300435120654],[120.59034679329739,30.612982893534422],[120.59154842293606,30.613143826075316]]]]}}]};this.blockSource=new k.default({features:new a.default().readFeatures(Z)}),this.blockLayer=new C.default({source:this.blockSource,style:this.normalStyle,zIndex:99}),this.map.addLayer(this.blockLayer);let M={type:"FeatureCollection",name:"solution",crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4490"}},features:[{type:"Feature",properties:{Key:"FID",Value:"1"},geometry:{type:"MultiPolygon",coordinates:[[[[120.57378637405759,30.599479047825582],[120.5723594389467,30.598773337204136],[120.57203968172553,30.600977850281254],[120.57345646251349,30.60159103273611],[120.5739687642706,30.599811641743543],[120.57378637405759,30.599479047825582]]]]}},{type:"Feature",properties:{Key:"FID",Value:"2"},geometry:{type:"MultiPolygon",coordinates:[[[[120.5683951341714,30.59774376749749],[120.56768703099146,30.59770085215331],[120.56735443707385,30.59774376749749],[120.56729006405726,30.59780277609582],[120.56760656472102,30.598092454669427],[120.56853997345831,30.59914924502135],[120.56968741535911,30.60090732118067],[120.56968795879959,30.600906092027003],[120.56938486883564,30.59788055998183],[120.5683951341714,30.59774376749749]]]]}},{type:"Feature",properties:{Key:"FID",Value:"4"},geometry:{type:"MultiPolygon",coordinates:[[[[120.5944837739346,30.641416256736136],[120.59423701070523,30.640279000113765],[120.59178010724747,30.64048821241687],[120.59187666677212,30.641196315596858],[120.59188739560807,30.641249959777156],[120.5932070424434,30.64113730699853],[120.5944837739346,30.641416256736136]]]]}},{type:"Feature",properties:{Key:"FID",Value:"5"},geometry:{type:"MultiPolygon",coordinates:[[[[120.59419357315596,30.64498046149629],[120.59087299839575,30.64466396083253],[120.5908998204859,30.645237953561605],[120.59161865250167,30.64551153888118],[120.59410237804957,30.64571002234834],[120.59419357315596,30.64498046149629]]]]}},{type:"Feature",properties:{Key:"FID",Value:"7"},geometry:{type:"MultiPolygon",coordinates:[[[[120.59155110430368,30.613143450439622],[120.59034411263838,30.61298788262502],[120.59033606602736,30.613002634745442],[120.59026364397653,30.613299018594432],[120.59148673128732,30.613540417405773],[120.59155110430368,30.613143450439622]]]]}},{type:"Feature",properties:{Key:"FID",Value:"8"},geometry:{type:"MultiPolygon",coordinates:[[[[120.59038433976309,30.611962270344748],[120.58968160100119,30.611817431058057],[120.58967355465586,30.61294664098415],[120.59033337676613,30.61299223844702],[120.59038433976309,30.611962270344748]]]]}}]};this.solutionSource=new k.default({features:new a.default().readFeatures(M)}),this.solutionLayer=new C.default({source:this.solutionSource,style:this.solutionStyle,zIndex:99}),this.map.addLayer(this.solutionLayer),this.iconLayer=new C.default({source:x,zIndex:99}),this.map.addLayer(this.iconLayer)},locateBlock(l){this.solutionFeature&&this.solutionFeature.setStyle(this.solutionStyle),this.blockFeature&&this.blockFeature.setStyle(this.normalStyle);let i=this.blockSource.getFeatures();for(var r=0;r<i.length;r++)if(i[r].get("Value")===l.id){this.blockFeature=i[r],this.currentBlockId=l.id;break}this.blockFeature.setStyle(this.highlightStyle);let d=this.map.getView().getResolutionForExtent(this.blockFeature.getGeometry().getExtent());this.map.getView().animate({center:(0,e.getCenter)(this.blockFeature.getGeometry().getExtent()),resolution:d}),this.flyTo((0,e.getCenter)(this.blockFeature.getGeometry().getExtent()),function(){})},flyTo(l,i){var r=2e3;let d=this.map.getView();var b=15,x=2,Z=!1;function M(B){--x,!Z&&(x===0||!B)&&(Z=!0,i(B))}d.setCenter(l),d.animate({zoom:b-1,duration:r/2},{zoom:b,duration:r/2},M)},showSolution(l){let i=this.solutionSource.getFeatures();if(l.solution1==!0){let d=parseInt(this.currentBlockId)+1;for(var r=0;r<i.length;r++)if(i[r].get("Value")===d.toString()){this.solutionFeature=i[r];break}this.solutionFeature.setStyle(this.solution1Style)}else{let d=parseInt(this.currentBlockId)+2;for(var r=0;r<i.length;r++)if(i[r].get("Value")===d.toString()){this.solutionFeature=i[r];break}this.solutionFeature.setStyle(this.solution2Style)}},getBindMap(){if(typeof this.widgetInfo.action.gisMapId<"u"){m.log(this.widgetInfo.action.gisMapId);let l=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(l){clearInterval(this.timer);let i=l.$refs.gismap;i&&(this.map=i.map)}}},doConfigMap(l,i,r){let d=i[r];m.info("======xmlocation get map========="),m.info(l),m.info(d),this.map=d,m.info("===============")}}},V=E,z=o(768141),O=(0,z.Z)(V,c,f,!1,null,"5af85dbe",null),K=O.exports}}]);
