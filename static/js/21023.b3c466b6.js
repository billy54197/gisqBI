"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[21023],{56279:function(M,u,s){s.d(u,{P:function(){return h}});var y=s(386892),g=s(149500);const h={mixins:[y.D],created(){},methods:{lifecycleBeforeChartsLoad(S){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&g.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let w=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[S]);if(w)return w}return S},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&g.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),g.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(M,u,s){s.d(u,{X:function(){return y},b:function(){return g}});let y={versions:function(){var h=navigator.userAgent;return{trident:h.indexOf("Trident")>-1,presto:h.indexOf("Presto")>-1,webKit:h.indexOf("AppleWebKit")>-1,gecko:h.indexOf("Gecko")>-1&&h.indexOf("KHTML")==-1,mobile:!!h.match(/AppleWebKit.*Mobile.*/),ios:!!h.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:h.indexOf("Android")>-1,iPhone:h.indexOf("iPhone")>-1,iPad:h.indexOf("iPad")>-1,webApp:h.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},g;y.versions.mobile||y.versions.ios||y.versions.android||y.versions.iPhone||y.versions.iPad?g=!1:g=!0},21023:function(M,u,s){s.r(u),s.d(u,{default:function(){return _}});var y=function(){var a=this,o=a._self._c;return o("div",{style:{width:a.widgetInfo.attr.w+"px",height:a.widgetInfo.attr.hh+"px"}},[o("hide-button",{attrs:{attr:a.widgetInfo.attr}}),o("div",{ref:"pictorialBarLineMix",style:{width:a.widgetInfo.attr.w+"px",height:a.widgetInfo.attr.hh+"px"}})],1)},g=[],h=s(844513),S=s(927966),O=s(56279),w=s(445061),N=s(126711),z=s(575797),I=s(99349),r=s(555616),L=s(275770),H=s(67157),C=s(150813);const R={mixins:[H.c],data(){return{config_extend:{config:{series:[{type:"pictorialBar",yAxisIndex:0,markLine:{lineStyle:{show:!0,color:"rgba(180, 18, 18, 1)"}}},{type:"line",yAxisIndex:0,lineStyle:{color:"rgba(99, 196, 90, 1)"}},{type:"pictorialBar",yAxisIndex:0}]}},filter_config:{title:JSON.parse(JSON.stringify(C.Z.charts.title)),legend:JSON.parse(JSON.stringify(C.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(C.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(C.Z.charts.toolbox)),xAxis:JSON.parse(JSON.stringify(C.Z.charts.xAxis)),yAxisLeft:{axisLine:{lineStyle:{color:"#BFC5D1"}},axisLabel:{fontFamily:"",color:"#8B93A8"}},yAxisRight:{axisLine:{lineStyle:{color:"rgba(0,0,0,1)"}},axisLabel:{fontFamily:"",color:"rgba(0,0,0,1)"}}},series_filter:{series_pictorialBar:[{type:"pictorialBar",yAxisIndex:0,itemStyle:{colorInfo:{type:"pureColor",pureColor:"",gradation:{}},opacity:1},areaStyle:{colorInfo:{type:"pureColor",pureColor:"",gradation:{}},opacity:0},markLine:{lineStyle:{color:"rgba(180, 18, 18, 1)"}}}],series_line:[{type:"line",yAxisIndex:0,itemStyle:{colorInfo:{type:"pureColor",pureColor:"",gradation:{}},opacity:1},areaStyle:{colorInfo:{type:"pureColor",pureColor:"",gradation:{}},opacity:0},lineStyle:{color:"rgba(254, 196, 0, 1)"}}]}}},methods:{filterPredefineColoursSchemeConfig(t,a){if(this.getNewConfigWithArrary(t,a,this.filter_config),a.series instanceof Array&&t.series instanceof Array){let o=[],c=[],e=[],p=[];for(let m=0;m<a.series.length;m++)a.series[m].type=="pictorialBar"?o.push(a.series[m]):c.push(a.series[m]);for(let m=0;m<t.series.length;m++)t.series[m].type=="pictorialBar"?e.push(t.series[m]):p.push(t.series[m]);this.getNewConfigWithArrary(e,o,this.series_filter.series_pictorialBar),this.getNewConfigWithArrary(p,c,this.series_filter.series_line)}}}};var P=s(149500);const B=s(954255);var W={name:"PictorialBarLineMix",components:{HideButton:h.Z},mixins:[O.P,w.u,N.H,I.P,z.baseConfig,R],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null,negative:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=B.init(this.$refs.pictorialBarLineMix,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let a=[],o=[],c=[];o=t.dataset[t.dataset.type].dimensions,a=t.dataset[t.dataset.type].source,c=t.dataset[t.dataset.type].dimensionsAlias,this.dimensionsEx=o,this.dimensionsAliasEx=c;let e=JSON.parse(JSON.stringify(t.config.series)),p=this.getTooltip(t.config.tooltip),m=JSON.parse(JSON.stringify(t.config.toolbox)),f=JSON.parse(JSON.stringify(t.config.legend)),x=JSON.parse(JSON.stringify(t.config.title)),A=JSON.parse(JSON.stringify(t.config.grid)),d=JSON.parse(JSON.stringify(t.config.xAxis)),n=JSON.parse(JSON.stringify(t.config.yAxisLeft)),l=JSON.parse(JSON.stringify(t.config.yAxisRight)),j=e.length;for(let i=0;i<j;i++){e[i].dimensions=o,e[i].barGap&&(e[i].barGap=e[i].barGap+"%"),e[i].name||(e[i].name=this.getLegendData(c,e[i].encode[t.dataset.type].y)),e[i].type=="pictorialBar"?(e[i].barWidth&&(e[i].barWidth=e[i].barWidth+"%"),e[i].itemStyle.barBorderRadiusInfo&&(e[i].itemStyle.barBorderRadius=this.getItemStyleBarBorderRadius(e[i].itemStyle.barBorderRadiusInfo)),e[i].itemStyle.colorInfo.type&&(e[i].itemStyle.color=this.getItemStyleColor(e[i].itemStyle.colorInfo)),t.config.series[i].emphasis&&t.config.series[i].emphasis.itemStyle&&t.config.series[i].emphasis.itemStyle.color&&(e[i].emphasis.itemStyle.color=t.config.series[i].emphasis.itemStyle.color),this.getSymbol(e[i]),e[i].symbolSize&&(e[i].symbolSize=e[i].symbolSizePercent?[e[i].symbolSize[0]+"%",e[i].symbolSize[1]+"%"]:[e[i].symbolSize[0],e[i].symbolSize[1]])):e[i].type=="line"&&(e[i].lineWidth=e[i].lineWidth+"%",e[i].itemStyle.color=e[i].lineStyle.color,e[i].symbol=e[i].lineSymbol,e[i].symbolSize=e[i].lineSymbolSize,e[i].areaStyle.colorInfo.type&&(e[i].areaStyle.color=this.getItemStyleColor(e[i].areaStyle.colorInfo)),t.config.series[i].emphasis&&t.config.series[i].emphasis.itemStyle&&t.config.series[i].emphasis.itemStyle.color&&(e[i].emphasis.itemStyle.color=t.config.series[i].emphasis.itemStyle.color));let T={},F=[],E=[];for(let b=e[i].dimensions.length-1;b>-1;--b)T[o[b]]=b;for(let b=0;b<a.length;++b){let v=a[b];F.push(v[T[e[i].encode[t.dataset.type].y]]||""),E.push(v[T[e[i].encode[t.dataset.type].x]]||"")}if(e[i].data=F,d.data=E,F&&F.length>0&&t.config.series[i].emphasis&&t.config.series[i].emphasis.script&&t.config.series[i].emphasis.script.enabled){const b=t.config.series[i].emphasis;if(b.script.content)try{let v=this,K=new Function("index","item","data",b.script.content);e[i].data.forEach(($,G)=>{let U=K.call(v,G,$,F);e[i].data[G]={value:$,emphasis:U}})}catch(v){P.error("\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u811A\u672C\u62A5\u9519\uFF1A",v)}}}this.isNegative(e,a),!n.max&&n.max!=0&&(n.max=this.fun_max),!n.min&&n.min!=0&&(n.min=this.fun_min),!l.max&&l.max!=0&&(l.max=this.fun_max),!l.min&&l.min!=0&&(l.min=this.fun_min);let J={color:this.$$global_editor.predefineColors,tooltip:p,toolbox:m,title:{show:x.show,text:x.text,link:x.link,textAlign:x.textAlign,left:x.left+"%",right:x.right+"%",top:x.top+"%",bottom:x.bottom+"%",textStyle:{fontSize:x.textStyle.fontSize,fontFamily:x.textStyle.fontFamily,color:x.textStyle.color}},legend:{show:f.show,type:f.type,itemWidth:f.itemWidth,itemHeight:f.itemHeight,icon:f.icon,orient:f.orient,align:f.align,itemGap:f.itemGap,left:f.left+"%",top:f.top+"%",textStyle:{fontSize:f.textStyle.fontSize,fontFamily:f.textStyle.fontFamily,color:f.textStyle.color}},grid:{left:A.left+"%",right:A.right+"%",top:A.top+"%",bottom:A.bottom+"%"},xAxis:[{type:d.type,show:d.show,name:d.name,data:d.data,nameLocation:d.nameLocation,nameGap:d.nameGap,boundaryGap:d.boundaryGap,axisLine:{show:d.axisLine.show,lineStyle:{color:d.axisLine.lineStyle.color}},axisTick:{show:d.axisTick.show},axisLabel:{interval:d.axisLabel.interval,show:d.axisLabel.show,rotate:d.axisLabel.rotate,margin:d.axisLabel.margin,fontSize:d.axisLabel.fontSize,fontFamily:d.axisLabel.fontFamily,color:d.axisLabel.color},splitLine:d.splitLine}],yAxis:[{show:n.show,type:n.type,name:n.name,position:"left",min:n.min,max:n.max,nameLocation:n.nameLocation,nameGap:n.nameGap,nameTextStyle:n.nameTextStyle,axisLine:{show:n.axisLine.show,lineStyle:{color:n.axisLine.lineStyle.color}},axisTick:{show:n.axisTick.show,lineStyle:n.axisTick.lineStyle},axisLabel:{show:n.axisLabel.show,rotate:n.axisLabel.rotate,margin:n.axisLabel.margin,fontSize:n.axisLabel.fontSize,fontFamily:n.axisLabel.fontFamily,color:n.axisLabel.color},splitLine:n.splitLine,axisPointer:{status:"hide"}},{show:l.show,type:l.type,name:l.name,position:"right",min:l.min,max:l.max,nameLocation:l.nameLocation,nameGap:l.nameGap,nameTextStyle:l.nameTextStyle,axisLine:{show:l.axisLine.show,lineStyle:{color:l.axisLine.lineStyle.color}},axisTick:{show:l.axisTick.show,lineStyle:l.axisTick.lineStyle},axisLabel:{show:l.axisLabel.show,rotate:l.axisLabel.rotate,margin:l.axisLabel.margin,fontSize:l.axisLabel.fontSize,fontFamily:l.axisLabel.fontFamily,color:l.axisLabel.color},splitLine:l.splitLine,axisPointer:{status:"hide"}}],dataset:{source:a,sourceHeader:!1},series:e};this.getAnimation(J,t),this.setOption(J),this.setAnimationLoop(t,()=>{this.setOption(J,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},getSymbol(t){t.symbolType=="img"&&t.symbol!=""&&(t.symbol=this.getSymbolURL(t.symbol)),t.symbolType=="svg"&&t.symbol!=""&&(t.symbol.indexOf("image/")>-1?t.symbol=t.symbol.indexOf("image://")==-1?"image://"+t.symbol:t.symbol:t.symbol=t.symbol.indexOf("path://")==-1?"path://"+t.symbol:t.symbol)},reLoadInfo(t){t&&(this.$refs.pictorialBarLineMix.style.width=t.attr.w+"px",this.$refs.pictorialBarLineMix.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,a){let o=this.$$lib__.find(t,c=>c.name==a);return o?o.alias&&o.alias!=""?o.alias:o.name:""},getItemStyleColor(t){let a=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?a=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(t.position=="levelDec"?a=new B.graphic.LinearGradient(0,0,1,0,[{offset:0,color:t.gradation.left!=null&&t.gradation.left!=""?t.gradation.left:"#FFFFFF"},{offset:1,color:t.gradation.right!=null&&t.gradation.right!=""?t.gradation.right:"#FFFFFF"}]):a=new B.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),a},getItemStyleBarBorderRadius(t){let a=[];return a.push(t.lt),a.push(t.rt),a.push(t.rb),a.push(t.lb),a},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let a=this;this.$$lib__.each(t.action.sendOut.actionList,o=>{if(o.enabled){let c=o.code+"_"+t.id;if(o.paramsExtend&&o.paramsExtend.length>0){let e={};this.getParamsExtend(e,o.paramsExtend,t)}o.code==L.default.click.code&&a.onClick(c,o)}})},onClick(t,a){let o=this;o.echarts.on("click",c=>{let e={};e.x=c.name,e.y=c.value;let p=[],m=o.widgetInfo.action.sendOut.actionList;if(o.widgetInfo.dataset[o.widgetInfo.dataset.type].source&&o.widgetInfo.dataset[o.widgetInfo.dataset.type].source.length>0&&(p=o.widgetInfo.dataset[o.widgetInfo.dataset.type].source[c.dataIndex]),o.getExtendParams(e,m[0].paramsExtend,p,o.widgetInfo.dataset[o.widgetInfo.dataset.type].dimensions),a.script&&a.script.enabled){if(P.log("Execute script for "+o.widgetInfo.name+" component to "+a.name+" component"),a.script.content==""){r.Message.warning({message:a.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",a.script.content),e=this.customScript(e)}S.Z.$emit(t,e),a.postMessage&&o.doPostMessage(e),o.actionNameList.push(t)})},isNegative(t,a){let o=[];for(let c=0;c<t.length;c++){let e=-1;for(let p=0;p<t[c].dimensions.length;p++)t[c].dimensions[p]==t[c].encode.y&&(e=p);for(let p=0;p<a.length;p++)parseInt(a[p][e])<0&&o.push(p)}o.length>0?this.negative=!0:this.negative=!1},fun_max(t){let a=0,o=0;return parseInt(t.max)&&(a=Math.abs(parseInt(t.max)).toFixed(0).toString().length-1),parseInt(t.min)&&(o=Math.abs(parseInt(t.min)).toFixed(0).toString().length-1),Math.abs(t.max)>Math.abs(t.min)?Math.ceil(Math.abs(t.max)/Math.pow(10,a))*Math.pow(10,a):Math.ceil(Math.abs(t.min)/Math.pow(10,o))*Math.pow(10,o)},fun_min(t){if(this.negative){let a=0,o=0;return parseInt(t.max)&&(a=Math.abs(parseInt(t.max)).toFixed(0).toString().length-1),parseInt(t.min)&&(o=Math.abs(parseInt(t.min)).toFixed(0).toString().length-1),Math.abs(t.max)>Math.abs(t.min)?-1*Math.ceil(Math.abs(t.max)/Math.pow(10,a))*Math.pow(10,a):-1*Math.ceil(Math.abs(t.min)/Math.pow(10,o))*Math.pow(10,o)}else return-Math.abs(0)}}},Z=W,k=s(768141),D=(0,k.Z)(Z,y,g,!1,null,"7b86cf4c",null),_=D.exports},844513:function(M,u,s){s.d(u,{Z:function(){return z}});var y=function(){var r=this,L=r._self._c;return r.attr.buttonHide?L("div",{style:{position:"absolute",right:r.attr.buttonHideRight+"px",top:r.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(H){return r.onHide()}}},[r.openTooltip?L("el-tooltip",{attrs:{"open-delay":1e3,content:r.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[L("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):L("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r._e()},g=[],h=s(752246),S={props:["attr"],name:"hide-button",data(){return{isPc:h.b}},computed:{openTooltip:function(){let I=!1,r=this.attr.buttonHideTooltipContent;return h.b&&r&&r!=null&&r.trim()!=""&&(I=!0),I}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},O=S,w=s(768141),N=(0,w.Z)(O,y,g,!1,null,"bf399b9a",null),z=N.exports}}]);
