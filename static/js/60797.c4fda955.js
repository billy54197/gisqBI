"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[60797],{56279:function(C,p,n){n.d(p,{P:function(){return r}});var f=n(386892),h=n(149500);const r={mixins:[f.D],created(){},methods:{lifecycleBeforeChartsLoad(g){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&h.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),h.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let m=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[g]);if(m)return m}return g},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&h.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),h.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(C,p,n){n.d(p,{X:function(){return f},b:function(){return h}});let f={versions:function(){var r=navigator.userAgent;return{trident:r.indexOf("Trident")>-1,presto:r.indexOf("Presto")>-1,webKit:r.indexOf("AppleWebKit")>-1,gecko:r.indexOf("Gecko")>-1&&r.indexOf("KHTML")==-1,mobile:!!r.match(/AppleWebKit.*Mobile.*/),ios:!!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:r.indexOf("Android")>-1,iPhone:r.indexOf("iPhone")>-1,iPad:r.indexOf("iPad")>-1,webApp:r.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},h;f.versions.mobile||f.versions.ios||f.versions.android||f.versions.iPhone||f.versions.iPad?h=!1:h=!0},960797:function(C,p,n){n.r(p),n.d(p,{default:function(){return $}});var f=function(){var i=this,a=i._self._c;return a("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[a("hide-button",{attrs:{attr:i.widgetInfo.attr}}),a("div",{ref:"funnelSimple",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},h=[],r=n(844513),g=n(927966),v=n(677928),m=n(56279),I=n(445061),O=n(126711),S=n(99349),s=n(555616),u=n(275770),L=n(67157),w=n(150813);const N={mixins:[L.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(w.Z.charts.title)),legend:JSON.parse(JSON.stringify(w.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(w.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(w.Z.charts.toolbox)),series:{itemStyle:{colorInfo:[{type:"pureColor",pureColor:"#FEC400",gradation:{top:"rgba(255, 0, 0, 1)",bottom:"rgba(30, 144, 255, 1)"}}],opacity:1}}}}},methods:{filterPredefineColoursSchemeConfig(t,i){this.getNewConfigWithArrary(t,i,this.filter_config)}}};var F=n(149500);const H=n(954255);var A={name:"FunnelSimple",components:{HideButton:r.Z},mixins:[v.baseConfig,m.P,I.u,O.H,S.P,N],props:["widgetInfo"],data(){return{}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=H.init(this.$refs.funnelSimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let i=[],a=[];i=this.getSeriesData(t.dataset[t.dataset.type].source,t.dataset[t.dataset.type].dimensions,t.dataset[t.dataset.type].encode);let l=JSON.parse(JSON.stringify(t.config.grid)),e=JSON.parse(JSON.stringify(t.config.series)),d=JSON.parse(JSON.stringify(t.config.title)),o=JSON.parse(JSON.stringify(t.config.legend)),T=this.getTooltip(t.config.tooltip),E=JSON.parse(JSON.stringify(t.config.toolbox)),M=this.$$global_editor.predefineColors;for(let c=0;c<e.itemStyle.colorInfo.length;++c)a.push(this.getItemStyleColor(e.itemStyle.colorInfo[c]));let b={color:this.$$global_editor.predefineColors,tooltip:T,toolbox:E,title:{show:d.show,text:d.text,link:d.link,textAlign:d.textAlign,left:d.left+"%",right:d.right+"%",top:d.top+"%",bottom:d.bottom+"%",textStyle:{fontSize:d.textStyle.fontSize,fontFamily:d.textStyle.fontFamily,color:d.textStyle.color}},legend:{show:o.show,type:o.type,itemWidth:o.itemWidth,itemHeight:o.itemHeight,icon:o.icon,orient:o.orient,align:o.align,itemGap:o.itemGap,left:o.left+"%",right:o.right+"%",top:o.top+"%",bottom:o.bottom+"%",textStyle:{fontSize:o.textStyle.fontSize,color:o.textStyle.color,fontFamily:o.textStyle.fontFamily}},series:[{name:this.getSeriesName(t),type:"funnel",data:i,min:e.min,max:e.max,minSize:e.minSize+"%",maxSize:e.maxSize+"%",sort:e.sort,gap:e.gap,funnelAlign:e.funnelAlign,left:l.left+"%",right:l.right+"%",top:l.top+"%",bottom:l.bottom+"%",label:this.getLabelStyle(e.label),emphasis:{itemStyle:e.emphasis.itemStyle},itemStyle:{borderColor:e.itemStyle.borderColor,borderWidth:e.itemStyle.borderWidth,color:function(c){return a[c.dataIndex]?a[c.dataIndex]:M[c.dataIndex]}}}]};if(e.emphasis)try{let c=e.emphasis;if(c.script&&c.script.enabled){if(c.script.content){let Z=new Function("index","item","data",c.script.content),y=b.series[0].data;if(y&&y.length>0)for(let x=0;x<y.length;++x)try{y[x].emphasis=Z.call(this,x,y[x],y)}catch(R){F.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",R)}}}else e.emphasis.itemStyle&&e.emphasis.itemStyle.color&&(b.series[0].emphasis={itemStyle:{...e.emphasis.itemStyle}})}catch(c){F.error("\u5904\u7406\u81EA\u5B9A\u4E49\u9AD8\u4EAE\u6837\u5F0F\u51FA\u9519\uFF1A",c)}this.getAnimation(b,t),this.setOption(b),this.setAnimationLoop(t,()=>{this.setOption(b,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),setTimeout(()=>{this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!1})},0)},reLoadInfo(t){t&&(this.$refs.funnelSimple.style.width=t.attr.w+"px",this.$refs.funnelSimple.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getSeriesData(t,i,a){let l=[],e=-1,d=-1;for(let o=0;o<i.length;o++)i[o]==a.x&&(e=o),i[o]==a.y&&(d=o);for(let o=0;o<t.length;o++)l.push({name:t[o][e],value:t[o][d]});return l},getSeriesName(t){let i="",a=t.dataset[t.dataset.type].encode,l=t.dataset[t.dataset.type].dimensionsAlias;if(a&&l)for(let e in l)a.y==l[e].name&&(i=l[e].alias?l[e].alias:l[e].name);return i},initAction(t){this.actionSendout(t),this.actionReceive(t)},getItemStyleColor(t){let i=null;return t.pureColor&&t.type==this.$$global_editor.colorType.pureColor.code?i=t.pureColor:t.type==this.$$global_editor.colorType.gradation.code&&(i=new H.graphic.LinearGradient(0,0,0,1,[{offset:0,color:t.gradation.top!=null&&t.gradation.top!=""?t.gradation.top:"#FFFFFF"},{offset:1,color:t.gradation.bottom!=null&&t.gradation.bottom!=""?t.gradation.bottom:"#FFFFFF"}])),i},actionSendout(t){let i=this;this.$$lib__.each(t.action.sendOut.actionList,a=>{if(a.enabled){let l=a.code+"_"+t.id;if(a.paramsExtend&&a.paramsExtend.length>0){let e={};this.getParamsExtend(e,a.paramsExtend,t)}a.code==u.default.click.code&&i.onClick(l,a)}})},onClick(t,i){let a=this;a.echarts.on("click",l=>{let e={};if(e.x=l.data.name,e.y=l.data.value,i.script&&i.script.enabled){if(F.log("Execute script for "+a.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){s.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",i.script.content),e=this.customScript(e)}g.Z.$emit(t,e),i.postMessage&&a.doPostMessage(e),a.actionNameList.push(t)})}}},P=A,z=n(768141),J=(0,z.Z)(P,f,h,!1,null,"7618d006",null),$=J.exports},844513:function(C,p,n){n.d(p,{Z:function(){return O}});var f=function(){var s=this,u=s._self._c;return s.attr.buttonHide?u("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(L){return s.onHide()}}},[s.openTooltip?u("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[u("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):u("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},h=[],r=n(752246),g={props:["attr"],name:"hide-button",data(){return{isPc:r.b}},computed:{openTooltip:function(){let S=!1,s=this.attr.buttonHideTooltipContent;return r.b&&s&&s!=null&&s.trim()!=""&&(S=!0),S}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},v=g,m=n(768141),I=(0,m.Z)(v,f,h,!1,null,"bf399b9a",null),O=I.exports}}]);
