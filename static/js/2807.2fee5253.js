"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2807],{59738:function(m,d,s){s.d(d,{OW:function(){return c},m3:function(){return p},nm:function(){return h},vP:function(){return f},xC:function(){return g}});var u=s(53258);function c(t,e,o){let n=t;const r=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(l=>(0,u.mf)(n[l]));if(!(0,u.mf)(n[r]))return!1;do{if(n[r](e))return!0;if(n===o)return!1;n=n.parentNode}while(n);return!1}function h(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function f(t,e,o){t&&(t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener?t.addEventListener(e,o,!0):t["on"+e]=o)}function g(t,e,o){t&&(t.detachEvent?t.detachEvent("on"+e,o):t.removeEventListener?t.removeEventListener(e,o,!0):t["on"+e]=null)}function p(t,e,o,n){var r=0,l=setInterval(()=>{r<o?(r++,t()):(clearInterval(l),n&&n())},e);return l}},53258:function(m,d,s){s.d(d,{ew:function(){return f},le:function(){return g},mf:function(){return u},sg:function(){return p},xn:function(){return c}});function u(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function c(t,e,o,n=1){const r=Math.round(e/n/t[0])*t[0],l=Math.round(o/n/t[1])*t[1];return[r,l]}function h(t){const e=t.getBoundingClientRect();return[parseInt(e.width),parseInt(e.height)]}function f(t,e,o){return t-e-o}function g(t,e,o){return t-e-o}function p(t,e,o){return e!==null&&t<e?e:o!==null&&o<t?o:t}},44513:function(m,d,s){s.d(d,{Z:function(){return e}});var u=function(){var n=this,r=n._self._c;return n.attr.buttonHide?r("div",{style:{position:"absolute",right:n.attr.buttonHideRight+"px",top:n.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(l){return n.onHide()}}},[n.openTooltip?r("el-tooltip",{attrs:{"open-delay":1e3,content:n.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[r("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):n._e()},c=[],h=s(52246),f={props:["attr"],name:"hide-button",data(){return{isPc:h.b}},computed:{openTooltip:function(){let o=!1,n=this.attr.buttonHideTooltipContent;return h.b&&n&&n!=null&&n.trim()!=""&&(o=!0),o}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},g=f,p=s(68141),t=(0,p.Z)(g,u,c,!1,null,"bf399b9a",null),e=t.exports},82807:function(m,d,s){s.r(d),s.d(d,{default:function(){return y}});var u=function(){var a=this,v=a._self._c;return v("div")},c=[],h=s(44513),f=s(16188),g=s(45061),p=s(26711),t=s(86892),e=s(27966),o=s(48836),n=s(59738),r=s(49500),l={name:"GisPlot",components:{},mixins:[f.u,t.D,g.u,p.H],props:["widgetInfo"],computed:{...(0,o.Se)(["getWidgets","getWidgetAllArr","getCurrentWidget","getActiveScreen"])},data(){return{showMsg:!0,timer:"",map:null,loading:null}},watch:{},beforeDestroy(){},mounted(){r.log(this.widgetInfo),this.initAction(this.widgetInfo),this.loading=this.$loading({lock:!0,text:"\u6B63\u5728\u914D\u7F6E\u5730\u56FE\uFF0C\u8BF7\u7A0D\u540E..",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.timer=(0,n.m3)(this.getBindMap,500,50,()=>{r.error("gis-polt\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")}),e.Z.$on("gis-plot-activate",(i,a)=>{r.log(i),this.$refs.plot.activate(i,a)}),e.Z.$emit("register-save-event",{widget:this,handler:this.savePlot}),e.Z.$on("refreshStyle",(i,a)=>{this.$refs.plot.refreshStyle(i,a)}),e.Z.$on("zIndexChange",i=>{this.$refs.plot.zIndexChange(i)}),e.Z.$on("deleteGeo",()=>{this.$refs.plot.deleteGeo()}),e.Z.$on("translateGeo",()=>{this.$refs.plot.translateGeo()})},methods:{...(0,o.nv)(["setSelectMultiple","addMultipleWidget","clearMultipleWidget","setCurrentWidget","setActiveScreen"]),loadInfo(i){r.log(i)},selectCurrentWidget(){if(this.getWidgets){let i="";for(let a in this.getWidgets)if(this.getWidgets[a]&&this.getWidgets[a].typeName=="gis-plot"){i=this.getWidgets[a].id;break}i&&(this.getActiveScreen||this.getCurrentWidget.id!=i)&&(this.setActiveScreen(!1),this.setCurrentWidget(i),this.setSelectMultiple(!1),this.clearMultipleWidget(),this.addMultipleWidget(i))}},reLoadInfo(i){r.log("\u914D\u7F6E\u66F4\u65B0\u4E86"),this.loadInfo(i)},initAction(i){this.registerAction(i,"configMap","mapList",this.doConfigMap),this.actionReceive(i)},savePlot(){this.widgetInfo.config.data=this.$refs.plot.getPlots()},drawEnd(){e.Z.$emit("gis-plot-drawend")},getBindMap(){if(this.loading.close(),typeof this.widgetInfo.action.gisMapId>"u"&&this.$$lib__.each(this.getWidgetAllArr,i=>{i.typeName=="gis-map"&&!this.widgetInfo.action.gisMapId&&(this.widgetInfo.action.gisMapId=i.id,r.log("auto bind map:"+i.id))}),typeof this.widgetInfo.action.gisMapId<"u"){r.log(this.widgetInfo.action.gisMapId);let i=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(i){clearInterval(this.timer);let a=i.$refs.gismap;a&&(r.log("\u83B7\u53D6map\u5BF9\u8C61\u6210\u529F\uFF0C\u7ED8\u5236\u7EC4\u4EF6\u7ED1\u5B9A\u5730\u56FE\uFF0C\u5173\u95ED\u5B9A\u65F6\u5668"),this.map=a.map,this.$refs.plot.setMap(this.map),this.widgetInfo.config.data&&this.$refs.plot.setPlots(this.widgetInfo.config.data))}}else this.showMsg&&(this.$message.info("\u672A\u914D\u7F6E\u5730\u56FE\u7EC4\u4EF6\uFF0C\u8BF7\u6DFB\u52A0\u5730\u56FE\u7EC4\u4EF6\u3002"),this.showMsg=!1)},doConfigMap(i,a,v){},setPlotStyle(i,a){e.Z.$emit("changePlot",i,a)}}},I=l,b=s(68141),M=(0,b.Z)(I,u,c,!1,null,"54fc2645",null),y=M.exports}}]);
