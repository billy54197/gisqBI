"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[4958],{56279:function(I,d,o){o.d(d,{P:function(){return p}});var g=o(86892),a=o(49500);const p={mixins:[g.D],created(){},methods:{lifecycleBeforeChartsLoad(c){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&a.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),a.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let f=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[c]);if(f)return f}return c},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&a.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),a.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},4958:function(I,d,o){o.r(d),o.d(d,{default:function(){return Z}});var g=function(){var i=this,t=i._self._c;return t("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[t("hide-button",{attrs:{attr:i.widgetInfo.attr}}),t("div",{ref:"gaugeSimple",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},a=[],p=o(44513),c=o(27966),u=o(64196),f=o(56279),O=o(45061),v=o(26711),N=o(99349),J=o(55616),A=o(75770),F=o(67157),h=o(50666);const E={mixins:[F.c],data(){return{config_extend:{},filter_config:{title:JSON.parse(JSON.stringify(h.Z.charts.title)),legend:JSON.parse(JSON.stringify(h.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(h.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(h.Z.charts.toolbox)),series:{itemStyle:{color:"rgba(232, 233, 240, 1)"},axisLine:{lineStyle:{shadowColor:"#eee",color:[[null,"#FEC400"]]}},axisLabel:{fontFamily:"sans-serif"},detail:{color:"#3A4151",fontFamily:"sans-serif",backgroundColor:"rgba(232, 233, 240, 1)",shadowColor:"#eee"},title:{backgroundColor:"rgba(0,0,0,0)",textStyle:{color:""}}}}}},methods:{filterPredefineColoursSchemeConfig(e,i){this.getNewConfigWithArrary(e,i,this.filter_config)}}};var z=o(49500);const w=o(29426);var T={name:"GaugeSimple",components:{HideButton:p.Z},mixins:[u.u,f.P,O.u,v.H,N.P,E],props:["widgetInfo"],data(){return{}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=w.init(this.$refs.gaugeSimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(e){let i=[];i=this.getSeriesData(e.dataset[e.dataset.type].source,e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode);let t=JSON.parse(JSON.stringify(e.config.series)),l=JSON.parse(JSON.stringify(e.config.title)),s=JSON.parse(JSON.stringify(e.config.legend)),n=JSON.parse(JSON.stringify(e.config.grid)),k=this.getTooltip(e.config.tooltip),R=JSON.parse(JSON.stringify(e.config.toolbox));t.axisLine.lineStyle.color.forEach(function(r,b,M){b==0?r[0]=r[0]/100:r[0]=(M[b-1][0]*100+r[0])/100});let x=e.config.series.axisLine.lineStyle.colorStyle,y=null,L=null;x=="solidColor"?y=t.axisLine.lineStyle.color:x=="linearGradient"&&(y=[[1,new w.graphic.LinearGradient(0,0,1,0,[{offset:0,color:e.config.series.axisLine.lineStyle.colorStart?e.config.series.axisLine.lineStyle.colorStart:"#fcfe92"},{offset:1,color:e.config.series.axisLine.lineStyle.colorEnd?e.config.series.axisLine.lineStyle.colorEnd:"#4ccb96"}])]]),L=t.axisTick.lineStyle.color?t.axisTick.lineStyle.color:"auto",t.splitLine.lineStyle.color=t.splitLine.lineStyle.color?t.splitLine.lineStyle.color:"auto";let m="",C=0,S={color:this.$$global_editor.predefineColors,tooltip:k,toolbox:R,legend:{show:s.show,textStyle:{fontFamily:s.textStyle.fontFamily,fontSize:s.textStyle.fontSize,color:s.textStyle.color},data:[],itemGap:s.itemGap},grid:{left:n.left,right:n.right,top:n.top,bottom:n.bottom},title:{show:l.show,text:l.text,link:l.link,textAlign:l.textAlign,left:l.left+"%",right:l.right+"%",top:l.top+"%",bottom:l.bottom+"%",textStyle:{fontSize:l.textStyle.fontSize,fontFamily:l.textStyle.fontFamily,color:l.textStyle.color}},series:[{name:"\u7A7A\u6C14\u8D28\u91CF",type:"gauge",data:i,startAngle:t.startAngle,endAngle:t.endAngle,min:t.min,max:t.max,center:[t.center[0]+"%",t.center[1]+"%"],radius:t.radius+"%",splitNumber:t.splitNumber,pointer:{show:t.pointer.show,width:t.pointer.width,length:t.pointer.length+"%"},itemStyle:{color:t.itemStyle.color},axisLine:{show:t.axisLine.lineStyle.show,lineStyle:{color:y,width:t.axisLine.lineStyle.width,shadowBlur:t.axisLine.lineStyle.shadowBlur,shadowColor:t.axisLine.lineStyle.shadowColor,shadowOffsetX:t.axisLine.lineStyle.shadowOffsetX,shadowOffsetY:t.axisLine.lineStyle.shadowOffsetY}},axisTick:{show:t.axisTick.show,splitNumber:t.axisTick.splitNumber,length:t.axisTick.length,lineStyle:{color:L,width:1,type:"solid"}},axisLabel:{show:t.axisLabel.show,fontSize:t.axisLabel.fontSize,fontFamily:t.axisLabel.fontFamily,fontWeight:t.axisLabel.fontWeight,color:t.axisLabel.color,distance:t.axisLabel.distance},splitLine:{show:t.splitLine.show,length:t.splitLine.length,lineStyle:t.splitLine.lineStyle},detail:{show:t.detail.show,color:t.detail.color,fontSize:t.detail.fontSize,fontFamily:t.detail.fontFamily,fontWeight:t.detail.fontWeight,offsetCenter:t.detail.offsetCenter,formatter:r=>{if(C++,m+=r+",",C==i.length)return m.substring(0,m.length-1)},backgroundColor:t.detail.backgroundColor,borderRadius:t.detail.borderRadius,shadowBlur:t.detail.shadowBlur,shadowColor:t.detail.shadowColor,shadowOffsetX:t.detail.shadowOffsetX,shadowOffsetY:t.detail.shadowOffsetY,width:t.detail.width,height:t.detail.height,lineHeight:t.detail.lineHeight,rich:{}},title:{show:t.title.show,z:2,backgroundColor:t.title.backgroundColor,textStyle:t.title.textStyle,fontSize:t.title.fontSize,offsetCenter:[t.title.offsetCenter[0]+"%",t.title.offsetCenter[1]+"%"]}}]};this.getAnimation(S,e),this.setOption(S),this.setAnimationLoop(e,()=>{this.setOption(S,e)})},setOption(e){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(e),{notMerge:!0})},reLoadInfo(e){e&&(this.$refs.gaugeSimple.style.width=e.attr.w+"px",this.$refs.gaugeSimple.style.height=e.attr.hh+"px"),this.loadInfo(e),this.echarts.resize()},getSeriesData(e,i,t){let l=[],s=-1;for(let n=0;n<i.length;n++)i[n]==t.value&&(s=n);for(let n=0;n<e.length;n++)l.push({value:e[n][s]});return l},initAction(e){this.actionSendout(e),this.actionReceive(e)},actionSendout(e){let i=this;this.$$lib__.each(e.action.sendOut.actionList,t=>{if(t.enabled){let l=t.code+"_"+e.id;if(t.paramsExtend&&t.paramsExtend.length>0){let s={};this.getParamsExtend(s,t.paramsExtend,e)}t.code==A.Z.click.code&&i.onClick(l,t)}})},onClick(e,i){let t=this;t.echarts.on("click",l=>{let s={};if(s.x=l.data.name,s.y=l.data.value,i.script&&i.script.enabled){if(z.log("Execute script for "+t.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){J.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",i.script.content),s=this.customScript(s)}c.Z.$emit(e,s),i.postMessage&&t.doPostMessage(s),t.actionNameList.push(e)})}}},P=T,$=o(68141),B=(0,$.Z)(P,g,a,!1,null,"03d5e18a",null),Z=B.exports}}]);
