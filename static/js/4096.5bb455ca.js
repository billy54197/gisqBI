"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[4096],{56279:function(D,N,r){r.d(N,{P:function(){return P}});var L=r(86892),u=r(49500);const P={mixins:[L.D],created(){},methods:{lifecycleBeforeChartsLoad(b){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&u.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let S=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[b]);if(S)return S}return b},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&u.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},44513:function(D,N,r){r.d(N,{Z:function(){return M}});var L=function(){var a=this,U=a._self._c;return a.attr.buttonHide?U("div",{style:{position:"absolute",right:a.attr.buttonHideRight+"px",top:a.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(Z){return a.onHide()}}},[a.openTooltip?U("el-tooltip",{attrs:{"open-delay":1e3,content:a.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[U("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):U("el-button",{class:a.attr.buttonHideIconClass&&a.attr.buttonHideIconClass!=""?a.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:a.attr.buttonHideColor,fontSize:a.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):a._e()},u=[],P=r(52246),b={props:["attr"],name:"hide-button",data(){return{isPc:P.b}},computed:{openTooltip:function(){let k=!1,a=this.attr.buttonHideTooltipContent;return P.b&&a&&a!=null&&a.trim()!=""&&(k=!0),k}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},W=b,S=r(68141),R=(0,S.Z)(W,L,u,!1,null,"bf399b9a",null),M=R.exports},24096:function(D,N,r){r.r(N),r.d(N,{default:function(){return q}});var L=function(){var t=this,i=t._self._c;return i("div",{ref:"digitalScrolling",style:{width:t.widgetInfo.attr.w+"px",height:t.widgetInfo.attr.hh+"px",textAlign:t.widgetInfo.config.text.label.horizontalAlignment}},[i("hide-button",{attrs:{attr:t.widgetInfo.attr}}),i("div",{style:{paddingLeft:t.mUtils.getNewPxW(t.widgetInfo.config.text.left)+"px",paddingTop:t.mUtils.getNewPxH(t.widgetInfo.config.text.top)+"px",overflow:"auto",display:"inline-block"},on:{click:t.onClick}},[i("div",{style:t.getStylePrefix(t.widgetInfo)},[i("span",[t._v(" "+t._s(t.widgetInfo.config.text.prefix.lable)+" ")])]),i("div",{style:{float:"left",paddingLeft:t.mUtils.getNewPxW(t.widgetInfo.config.text.margin.left)+"px",paddingTop:t.mUtils.getNewPxH(t.widgetInfo.config.text.margin.top)+"px",fontSize:t.mUtils.getNewFontSize(t.widgetInfo.config.text.label.fontSize)+"px",color:t.widgetInfo.config.text.label.color,fontWeight:t.widgetInfo.config.text.label.fontWeight,fontFamily:t.widgetInfo.config.text.label.fontFamily,fontStyle:t.widgetInfo.config.text.label.fontStyle,textDecoration:t.widgetInfo.config.text.label.textDecoration,webkitTextStrokeWidth:t.widgetInfo.config.text.label.textStrokeWidth+"px",webkitTextStrokeColor:t.widgetInfo.config.text.label.textStrokeColor,textShadow:t.mUtils.getNewPxH(t.widgetInfo.config.text.label.hShadow)+"px "+t.widgetInfo.config.text.label.vShadow+"px "+t.widgetInfo.config.text.label.textShadowBlur+"px "+t.widgetInfo.config.text.label.textShadowColor||"rgba(0,0,0,0)",cursor:this.getCursor(t.widgetInfo.action,this.$$global_editor.actionType.click.code,this.$$global_editor.actionType.openLink.code)}},[i("div",{ref:"numberscroll",staticClass:"numbers"},[i("input",{attrs:{type:"hidden"},domProps:{value:t.textInfo}})])]),i("div",{style:t.getStyleSuffix(t.widgetInfo)},[i("span",[t._v(" "+t._s(t.widgetInfo.config.text.suffix.lable)+" ")])])])],1)},u=[],P=r(44513),b=r(26711),W=r(45061),S=r(56279),R=r(61709),M=r(27966),k=r(21300),a=r(55616),U=r(67157);const Z={mixins:[U.c],data(){return{config_extend:{config:{text:{top:11,left:16}}},filter_config:{text:{label:{color:"rgba(44, 62, 80, 1)"},prefix:{color:"rgba(44, 62, 80, 1)"},suffix:{color:"rgba(44, 62, 80, 1)"}},option:{borderColor:"#4C84FF",background:"rgba(255, 255, 255, 0)"}}}},methods:{filterPredefineColoursSchemeConfig(e,t){this.getNewConfigWithArrary(e,t,this.filter_config)}}};var j=r(49500),G={props:["widgetInfo"],name:"digital-scrolling",components:{HideButton:P.Z},mixins:[R.u,b.H,W.u,S.P,Z],data(){return{textInfo:""}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},methods:{loadInfo(e){this.textInfo=null,e.dataset[e.dataset.type]&&e.dataset[e.dataset.type].dimensions&&e.dataset[e.dataset.type].dimensions.length>0?this.textInfo=this.getFieldVal(e.dataset[e.dataset.type].source[0],e.dataset[e.dataset.type].dimensions,e.dataset[e.dataset.type].encode.text):this.textInfo=e.dataset[e.dataset.type].encode.text;let t=JSON.parse(JSON.stringify(e.config.option));t.num=this.textInfo,t.backgroundImage=this.getImageUrl(t.backgroundImage),t.scroll?this.scroll(t):this.show(t),this.lifecycleAfterLoad()},reLoadInfo(e){if(e){this.$refs.digitalScrolling.style.width=e.attr.w+"px",this.$refs.digitalScrolling.style.height=e.attr.hh+"px";let t=this.$refs.numberscroll.querySelector("input[type=hidden]");t&&(t.value="")}this.loadInfo(e)},initAction(e){this.actionReceive(e)},scroll(e){let t=this.$refs.numberscroll;this.initNumberScroll(t,e)},show(e){let t=this.$refs.numberscroll;this.initNumberScroll(t,e,!0)},initNumberScroll(e,t,i){let s=Number(t.num),l=t.width,n=t.height,d=t.mLeft,m=t.borderWidth,f=t.borderColor,A=t.borderRadius,$=t.background,J=t.local,z=t.backgroundImage,K=e.querySelector("input[type=hidden]"),T=t.diffrentiation,E=t.l2r,x=t.undreg,F=t.groupNum,H=t.minLen;if(T=parseInt(T),E=parseInt(E),F=parseInt(F)||1,H=parseInt(H)||0,!K)return;let C=e.querySelector("[HALO-NUMBERS-CONTAINER]"),h=K.value||"";if(parseInt(t.decimal)>=0&&(s=s.toFixed(t.decimal)),C||(C=document.createElement("div"),C.className=t.containerClass||"",C.setAttribute("HALO-NUMBERS-CONTAINER",""),e.appendChild(C)),isNaN(s)||s===h)return;J&&(s=this.addThousands(s));let g=(s+"").split(""),p=g.length;if(H&&H>p){for(let o=0;o<H-p;++o)g.unshift(0);p=H}if(h=="")for(let o=0;o<p;++o)h+="-";h=Number(h),t.decimal>=0&&(h=h.toFixed(t.decimal)),J&&(h=this.addThousands(h));let w,I;if(isNaN(h)?(I=[],w=I.length):(I=(h+"").split(""),w=I.length),t.zeronum){if(p>w){let o=p-w;for(let c=0;c<o;++c)I.unshift("0");w=p}else if(p<w){let o=w-p;for(let c=0;c<o;++c)g.unshift("0");p=w}}let V=[];if(!T)x="";else if(x!=""){let o=x.length;if(x=x.toLowerCase(),x.indexOf("^")==0)for(let c=0;c<o;++c)x[c]=="x"&&(V[c-1]=1);else if(x.indexOf("$")==o-1){let c=x.replace(/\$$/g,"").split("");for(let _=p-1;_>=0&&c.length;--_)c.pop()=="x"&&(V[_]=1)}else x=""}let y="",v=e.getAttribute("direction")||t.direction;v!="up"&&v!="down"&&(v="alternate");let tt=v=="alternate",B=E?0:p;for(let o=0;o<p;++o)i||T?(B=0,g[o]===","||g[o]==="."?y+='<span class="'+t.containerItemClass+'" style=" position:relative; width: '+this.mUtils.getNewPxW(l/2)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+'px; text-align: center; overflow: hidden;">'+g[o]+"</span>":g[o]==="-"?y+='<span class="'+t.containerItemClass+'" style="display:inline-block; vertical-align:top; position:relative; width: '+this.mUtils.getNewPxW(l)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px;margin-left: "+this.mUtils.getNewPxW(d)+"px;border:"+m+"px solid "+f+"; border-radius: "+A+"px;background-color:"+$+";background-image:"+z+'; background-size:100% 100%; text-align: center; overflow: hidden;">'+g[o]+"</span>":y+='<span class="'+t.containerItemClass+'" style="display:inline-block; vertical-align:top; position:relative; width: '+this.mUtils.getNewPxW(l)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px;margin-left: "+this.mUtils.getNewPxW(d)+"px;border:"+m+"px solid "+f+"; border-radius: "+A+"px;background-color:"+$+";background-image:"+z+'; background-size:100% 100%; text-align: center; overflow: hidden;">'+t.numList[g[o]]+"</span>"):(tt&&(v=o%2==0?"up":"down"),E?g[o]==","||g[o]=="."?y+='<span class="'+t.containerItemClass+'" style="position:relative; width: '+this.mUtils.getNewPxW(l/2)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+'px; text-align: center; overflow: hidden;">'+g[o]+"</span>":y+='<span class="'+t.containerItemClass+'" style="display:inline-block; vertical-align:top; position:relative; width: '+this.mUtils.getNewPxW(l)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px;margin-left: "+this.mUtils.getNewPxW(d)+"px;border:"+m+"px solid "+f+"; border-radius: "+A+"px;background-color:"+$+";background-image:"+z+';background-size:100% 100%;text-align: center; overflow: hidden;">'+this.createNum(g[o],I[o],Math.ceil(B++/F),v,t,n)+"</span>":g[o]==","||g[o]=="."?y+='<span class="'+t.containerItemClass+'" style="position:relative; width: '+this.mUtils.getNewPxW(l/2)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+'px; text-align: center; overflow: hidden;">'+g[o]+"</span>":y+='<span class="'+t.containerItemClass+'" style="display:inline-block; vertical-align:top; position:relative; width: '+this.mUtils.getNewPxW(l)+"px; height: "+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px;margin-left: "+this.mUtils.getNewPxW(d)+"px;border:"+m+"px solid "+f+"; border-radius: "+A+"px;background-color:"+$+";background-image:"+z+';background-size:100% 100%; text-align: center; overflow: hidden;">'+this.createNum(g[o],I[o],Math.ceil(B--/F),v,t,n)+"</span>");C.innerHTML=y;let O=document.querySelectorAll("[HALO-NUMBER]");setTimeout(function(){for(let o=0,c=O.length;o<c;++o)O[o].getAttribute("direction")=="up"?O[o].style.transform="translate3d(0,-100%,0)":O[o].style.transform="translate3d(0,0,0)"},300)},createNum(e,t,i,s,l,n){let d="",m=l.round;if(s=="up"){d+='<div style="transform: translate3d(0,0,0); transition: transform '+l.duration+"s ease-in-out "+l.delay*i+'s; position: absolute; width: 100%; height: auto; top: 0;" HALO-NUMBER direction="'+s+'">',typeof t=="number"?(d+=this.createScrollNum(l,n,t),t>5&&--m):d+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+'px; overflow:hidden; padding: 0; margin: 0; left: 0; top: 0;">'+l.numHolder+"</div>";for(let f=0;f<m;++f)d+=this.createScrollNum(l,n);for(let f=0;f<=e;++f)d+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px; overflow:hidden; padding: 0; margin: 0 0 "+(f==e?"-"+this.mUtils.getNewPxH(n)+"px":"0")+' 0; left: 0; top: 0;">'+l.numList[f]+"</div>";e=="-"&&(d+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px; overflow:hidden; padding: 0; margin: 0 0 -"+this.mUtils.getNewPxH(n)+'px 0; left: 0; top: 0;">'+e+"</div>")}else{d+='<div style="transform: translate3d(0,-100%,0); transition: transform '+l.duration+"s ease-in-out "+l.delay*i+'s; position: absolute; width: 100%; height: auto; top: 0;" HALO-NUMBER direction="'+s+'">';for(let f=e;f>=0;--f)d+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+'px; overflow:hidden; padding: 0; margin: 0 0 0 0; left: 0; top: 0;">'+l.numList[f]+"</div>";e=="-"&&(d+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+'px; overflow:hidden; padding: 0; margin: 0 0 0 0; left: 0; top: 0;">'+e+"</div>"),t<5&&--m;for(let f=0;f<m;++f)d+=this.createScrollNum2(l,n);typeof t=="number"?d+=this.createScrollNum2(l,n,t):d+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(n)+"px; line-height: "+this.mUtils.getNewPxH(n)+"px; overflow:hidden; padding: 0; margin: 0 0 -"+this.mUtils.getNewPxH(n)+'px 0; left: 0; top: 0;">'+l.numHolder+"</div>"}return d+="</div>",d},createScrollNum(e,t,i){let s="";i=i||0;for(let l=i,n=e.numList.length;l<n;++l)s+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(t)+"px; line-height: "+this.mUtils.getNewPxH(t)+'px; overflow:hidden; padding: 0; margin: 0; left: 0; top: 0;">'+e.numList[l]+"</div>";return s},createScrollNum2(e,t,i,s){let l="";i=i||0;for(let n=e.numList.length-1;n>=i;--n)l+='<div style="position:relative; width:100%; height: '+this.mUtils.getNewPxH(t)+"px; line-height: "+this.mUtils.getNewPxH(t)+"px; overflow:hidden; padding: 0; margin: "+(i==n&&s?"0 0 -"+this.mUtils.getNewPxH(t)+"px 0":"0")+'; left: 0; top: 0;">'+e.numList[n]+"</div>";return l},addThousands(e){let t=/\d{1,3}(?=(\d{3})+$)/g;return e&&e.toString().indexOf(".")==-1?(e+"").replace(t,"$&,"):e.toString().replace(/(\d)(?=(\d{3})+\.)/g,function(i,s){return s+","})},getStylePrefix(e){return{wordWrap:"break-word",float:"left",display:e.config.text.prefix.hide==!0?"none":"",width:this.mUtils.getNewPxW(e.config.text.prefix.w)+"px",marginLeft:this.mUtils.getNewPxW(e.config.text.prefix.left)+"px",marginTop:this.mUtils.getNewPxH(e.config.text.prefix.top)+"px",fontSize:this.mUtils.getNewFontSize(e.config.text.prefix.fontSize)+"px",color:e.config.text.prefix.color,fontWeight:e.config.text.prefix.fontWeight,fontStyle:e.config.text.prefix.fontStyle,fontFamily:e.config.text.prefix.fontFamily,textDecoration:e.config.text.prefix.textDecoration,textAlign:e.config.text.prefix.horizontalAlignment}},getStyleSuffix(e){return{wordWrap:"break-word",float:"left",display:e.config.text.suffix.hide==!0?"none":"",width:this.mUtils.getNewPxW(e.config.text.suffix.w)+"px",marginLeft:this.mUtils.getNewPxW(e.config.text.suffix.left)+"px",marginTop:this.mUtils.getNewPxH(e.config.text.suffix.top)+"px",fontSize:this.mUtils.getNewFontSize(e.config.text.suffix.fontSize)+"px",color:e.config.text.suffix.color,fontWeight:e.config.text.suffix.fontWeight,fontFamily:e.config.text.suffix.fontFamily,fontStyle:e.config.text.suffix.fontStyle,textDecoration:e.config.text.suffix.textDecoration,textAlign:e.config.text.suffix.horizontalAlignment}},onClick(){let e=this,t=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(t,i=>{if(i.enabled&&i.code==e.$$global_editor.actionType.click.code){let s=e.$$global_editor.actionType.click.code+"_"+e.widgetInfo.id,l={text:e.textInfo};if(i.paramsExtend&&i.paramsExtend.length>0){let n=[];e.widgetInfo.dataset[e.widgetInfo.dataset.type].source&&e.widgetInfo.dataset[e.widgetInfo.dataset.type].source.length>0&&(n=e.widgetInfo.dataset[e.widgetInfo.dataset.type].source[0]),this.getExtendParams(l,i.paramsExtend,n,e.widgetInfo.dataset[e.widgetInfo.dataset.type].dimensions)}if(i.script&&i.script.enabled){if(j.log("Execute script for "+e.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){a.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param",i.script.content),l=this.customScript_actionSend_clickParam(l)}M.Z.$emit(s,l),i.postMessage&&this.doPostMessage(l),this.actionNameList.push(s)}else if(i.enabled&&i.code==e.$$global_editor.actionType.openLink.code){let s={};if(i.paramsExtend&&i.paramsExtend.length>0){let l=[];e.widgetInfo.dataset[e.widgetInfo.dataset.type].source&&e.widgetInfo.dataset[e.widgetInfo.dataset.type].source.length>0&&(l=e.widgetInfo.dataset[e.widgetInfo.dataset.type].source[0]),this.getExtendParams(s,i.paramsExtend,l,e.widgetInfo.dataset[e.widgetInfo.dataset.type].dimensions)}if(i.script&&i.script.enabled){if(j.log("Execute script for "+e.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){a.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_openLinkParam=new Function("param",i.script.content),s=this.customScript_actionSend_openLinkParam(s)}this.openLinkAction(i,s)}})},getImageUrl(e){if(e&&e!="")return"url("+k.appendImageBaseURL(e)+")"}}},Q=G,X=r(68141),Y=(0,X.Z)(Q,L,u,!1,null,"1c140048",null),q=Y.exports}}]);
