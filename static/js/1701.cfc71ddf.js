(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[1701],{10565:function(B,y){var a,I,C;(function(m,i){I=[],a=i,C=typeof a=="function"?a.apply(y,I):a,C!==void 0&&(B.exports=C)})(this,function(){var m=52.35987755982988,i=3.141592653589793,M=6378245,A=.006693421622965943,n=function(e,t){var e=+e,t=+t,c=e-.0065,g=t-.006,h=Math.sqrt(c*c+g*g)-2e-5*Math.sin(g*m),f=Math.atan2(g,c)-3e-6*Math.cos(c*m),x=h*Math.cos(f),S=h*Math.sin(f);return[x,S]},s=function(t,e){var e=+e,t=+t,c=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*m),g=Math.atan2(e,t)+3e-6*Math.cos(t*m),h=c*Math.cos(g)+.0065,f=c*Math.sin(g)+.006;return[h,f]},l=function(t,e){var e=+e,t=+t;if(F(t,e))return[t,e];var c=v(t-105,e-35),g=b(t-105,e-35),h=e/180*i,f=Math.sin(h);f=1-A*f*f;var x=Math.sqrt(f);c=c*180/(M*(1-A)/(f*x)*i),g=g*180/(M/x*Math.cos(h)*i);var S=e+c,H=t+g;return[H,S]},r=function(t,e){var e=+e,t=+t;if(F(t,e))return[t,e];var c=v(t-105,e-35),g=b(t-105,e-35),h=e/180*i,f=Math.sin(h);f=1-A*f*f;var x=Math.sqrt(f);c=c*180/(M*(1-A)/(f*x)*i),g=g*180/(M/x*Math.cos(h)*i);var S=e+c,H=t+g;return[t*2-H,e*2-S]},v=function(t,e){var e=+e,t=+t,c=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return c+=(20*Math.sin(6*t*i)+20*Math.sin(2*t*i))*2/3,c+=(20*Math.sin(e*i)+40*Math.sin(e/3*i))*2/3,c+=(160*Math.sin(e/12*i)+320*Math.sin(e*i/30))*2/3,c},b=function(t,e){var e=+e,t=+t,c=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return c+=(20*Math.sin(6*t*i)+20*Math.sin(2*t*i))*2/3,c+=(20*Math.sin(t*i)+40*Math.sin(t/3*i))*2/3,c+=(150*Math.sin(t/12*i)+300*Math.sin(t/30*i))*2/3,c},F=function(t,e){var e=+e,t=+t;return!(t>73.66&&t<135.05&&e>3.86&&e<53.55)};return{bd09togcj02:n,gcj02tobd09:s,wgs84togcj02:l,gcj02towgs84:r}})},59738:function(B,y,a){"use strict";a.d(y,{OW:function(){return C},m3:function(){return A},nm:function(){return m},vP:function(){return i},xC:function(){return M}});var I=a(53258);function C(n,s,l){let r=n;const v=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(b=>(0,I.mf)(r[b]));if(!(0,I.mf)(r[v]))return!1;do{if(r[v](s))return!0;if(r===l)return!1;r=r.parentNode}while(r);return!1}function m(n){const s=window.getComputedStyle(n);return[parseFloat(s.getPropertyValue("width"),10),parseFloat(s.getPropertyValue("height"),10)]}function i(n,s,l){n&&(n.attachEvent?n.attachEvent("on"+s,l):n.addEventListener?n.addEventListener(s,l,!0):n["on"+s]=l)}function M(n,s,l){n&&(n.detachEvent?n.detachEvent("on"+s,l):n.removeEventListener?n.removeEventListener(s,l,!0):n["on"+s]=null)}function A(n,s,l,r){var v=0,b=setInterval(()=>{v<l?(v++,n()):(clearInterval(b),r&&r())},s);return b}},53258:function(B,y,a){"use strict";a.d(y,{ew:function(){return i},le:function(){return M},mf:function(){return I},sg:function(){return A},xn:function(){return C}});function I(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Function]"}function C(n,s,l,r=1){const v=Math.round(s/r/n[0])*n[0],b=Math.round(l/r/n[1])*n[1];return[v,b]}function m(n){const s=n.getBoundingClientRect();return[parseInt(s.width),parseInt(s.height)]}function i(n,s,l){return n-s-l}function M(n,s,l){return n-s-l}function A(n,s,l){return s!==null&&n<s?s:l!==null&&l<n?l:n}},44513:function(B,y,a){"use strict";a.d(y,{Z:function(){return s}});var I=function(){var r=this,v=r._self._c;return r.attr.buttonHide?v("div",{style:{position:"absolute",right:r.attr.buttonHideRight+"px",top:r.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(b){return r.onHide()}}},[r.openTooltip?v("el-tooltip",{attrs:{"open-delay":1e3,content:r.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[v("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):v("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r._e()},C=[],m=a(52246),i={props:["attr"],name:"hide-button",data(){return{isPc:m.b}},computed:{openTooltip:function(){let l=!1,r=this.attr.buttonHideTooltipContent;return m.b&&r&&r!=null&&r.trim()!=""&&(l=!0),l}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},M=i,A=a(68141),n=(0,A.Z)(M,I,C,!1,null,"bf399b9a",null),s=n.exports},21701:function(B,y,a){"use strict";a.r(y),a.d(y,{default:function(){return T}});var I=function(){var o=this,p=o._self._c;return p("div",{directives:[{name:"show",rawName:"v-show",value:o.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],style:{width:o.widgetInfo.attr.w+"px",height:o.widgetInfo.attr.hh+"px"}},[p("el-popover",{attrs:{placement:"bottom-start",trigger:"manual"},model:{value:o.visible,callback:function(u){o.visible=u},expression:"visible"}},[p("div",[p("ul",o._l(o.listAddress,function(u){return p("li",{key:u.uid,staticClass:"search-item",on:{click:function(j){return o.selectItem(u)}}},[o._v(" "+o._s(u.name)+" ")])}),0)]),p("el-input",{attrs:{slot:"reference",placeholder:"\u8BF7\u8F93\u5165\u5730\u540D"},on:{blur:o.handleBlur},slot:"reference",model:{value:o.searchValue,callback:function(u){o.searchValue=u},expression:"searchValue"}},[p("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(u){return o.locatByXY()}},slot:"append"})],1)],1)],1)},C=[],m=a(44513),i=a(27966),M=a(32214),A=a(45061),n=a(26711),s=a(86892),l=a(35776),r=a(55616),v=a(21300),b=a(82571),F=a(60316),E=a(13811),z=a(13798),R=a(90583),e=a(10565),t=a.n(e),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACOUlEQVRYR82XS3LTQBCG/1YlZImcC2BXWdriG+CcIMkJCMuMFpATxJwAWEhZxjkBzglibmC2UqrsE1hiSXCpqTGRsfFoZmRLVWirfnzT3dPTTajwuWHccxw6ZUYf4DaB2lKdwTOAZkQY5znfZ4E/sTVLNoJuGF8Q4bpwaNKRQAxnkInunUlWC+B+mrp0tLgl4MxkSPmfeZg/HV5lV52sTL8UYOn8xa8HIurt5PxZiZkn/HR4UgZRCtAKkxERTvdxXugyMEqFd66ypQSQOXeIbutwXtjImd9lgT/816YSoBUmsqJf1QkgCzMVfscI4N4kfYfxUKfzVRQIJ9mlN163vRWB4/DxM4jfNwEApi/zoPtBC9CKkjEBb5oAYOBbKry+HqCB/P+9Ddt1sJ2CKOEmTl/YnAtvw+f/B9DEFVxLwfdU+BudVRGBeAjQ22bSwHdz4V9oi7CJLqjrhupOGCUZAS/rjAIDP1LhucZOKAWOw2QAwnWdAGB8nAfewArAvZm2HV5M6wKQp2c66GWXnZkVQO1RKDm99KMfSI4Ws31rYXn6nwftygOJpHOjxzMH/HWfVOSg80x0R2U2jEPpPpMRM+7TwNPOk0aA58G0cipMoS8iYgTYNRWm0FcC+HMrKgwqisFj5xpYV2xF8YRAr3VFyeCtB0cnb5WCwoCpHmzzrn2MTFdO7odEJMe2jbdi6Zy5X2Uv1DYiHYiqP9gWnXUrtojEankpWzpMNnaOwKomwng5XKg2HhvnUuY3MPv3IXrIdv0AAAAASUVORK5CYII=",g=a(59738),h=a(49500),f={name:"GisSearchAddress",components:{HideButton:m.Z},mixins:[M.u,s.D,A.u,n.H],props:["widgetInfo"],data(){return{timer:"",map:null,searchValue:null,listAddress:[],visible:!1,isComeSelect:!1,currentItem:null}},watch:{searchValue(d){this.isComeSelect||(this.isComeSelect=!1,self.currentItem=null,(0,v.getLocationByAddress)(d,null,10,0).then((o,p)=>{o&&o.results&&o.results.length>0?(this.listAddress=o.results,this.currentItem=this.listAddress[0],this.visible=!0):(this.listAddress=[],this.visible=!1)}).catch(o=>{this.visible=!1,(0,r.Message)({message:"\u67E5\u8BE2\u5730\u540D\u5931\u8D25",type:"error"})})),this.isComeSelect=!1}},beforeDestroy(){},mounted(){this.widgetInfo.isDefaultBaseConfig,this.initAction(this.widgetInfo),this.timer=(0,g.m3)(this.getBindMap,500,50,()=>{h.error("gis-search-address\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")})},methods:{loadInfo(d){},reLoadInfo(d){this.loadInfo(d)},initAction(d){this.registerAction(d,"configMap","mapList",this.doConfigMap),this.actionReceive(d)},analysisFinish(d){let o=this,p=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(p,u=>{if(u.enabled&&u.code==o.$$global_editor.actionType.analyze.code){let j=u.code+"_"+o.widgetInfo.id,w={result:d};u.paramsExtend&&u.paramsExtend.length>0&&this.getExtendParams(w,u.paramsExtend,[],[]),u.script&&u.script.enabled&&u.script.content&&(this.doConfigMap=new Function("data",u.script.content),this.doConfigMap(w)),h.log(w),i.Z.$emit(j,w),u.postMessage&&this.doPostMessage(w),this.actionNameList.push(j)}})},getBindMap(){if(typeof this.widgetInfo.action.gisMapId<"u"){let d=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(d){clearInterval(this.timer);let o=d.$refs.gismap;o&&(h.log("\u83B7\u53D6map\u5BF9\u8C61\u6210\u529F\uFF0C\u56FE\u5C42\u76EE\u5F55\u7ED1\u5B9A\u5730\u56FE\uFF0C\u521D\u59CB\u5316\u56FE\u5C42\u64CD\u4F5C,\u5173\u95ED\u5B9A\u65F6\u5668"),this.map=o.map)}}},doConfigMap(d,o,p){let u=o[p];h.info("======tctocovt========="),h.info(d),h.info(u),this.map=u,h.info("==============="),this.$refs.toc.initLayerManager(this.map)},selectItem(d){d&&(this.currentItem=d,this.searchValue=d.name,this.visible=!1,this.isComeSelect=!0,this.locatByXY())},handleBlur(){this.visible=!1},locatByXY(){if(this.currentItem){const d=new b.ZP({image:new F.Z({anchor:[.5,.96],crossOrigin:"anonymous",src:c})}),o=t().gcj02towgs84(this.currentItem.location.lng,this.currentItem.location.lat);let p=new z.Z([o[0],o[1]]);const u=(0,R.get)("EPSG:4326");p.transform(u,this.map.getView().getProjection());const j=new E.Z(p);j.setStyle(d),j.tag="location";let w=this.map.getLayerById("drawLayer").getSource();const O=w.forEachFeature(P=>{P&&P.tag=="location"&&w.removeFeature(P)});w.addFeature(j),this.map.zoomTo([p.getCoordinates()[0],p.getCoordinates()[1]])}}}},x=f,S=a(68141),H=(0,S.Z)(x,I,C,!1,null,"6bc0fac5",null),T=H.exports}}]);
