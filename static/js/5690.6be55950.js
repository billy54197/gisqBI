"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[5690],{9132:function(p,d,a){a.d(d,{M:function(){return g}});var u=a(79876),_=a(45643),l=a(55616),r=a.n(l),h=a(27966),f=a(48836),s=a(49500);const g={props:{widgetId:{type:String},value:{default:null},condition_config:{}},mixins:[u.G,_.E],data(){return{global_query:this.$$global_query,condition_value:void 0}},computed:{...(0,f.Se)(["enumInfoFun","datasetInfoFun"]),enumInfo(){return this.enumInfoFun(this.widgetId)},datasetInfo(){return this.datasetInfoFun(this.widgetId)}},mounted(){h.Z.$on("busGetEnumDataSetJson"+(this.widgetId?"_"+this.widgetId:""),e=>{this.getEnumDataSetJson(e)})},methods:{afterChangeValue(){this.scriptChangeValue(),this.condition_config.change_query==!0&&this.doQuery()},scriptChangeValue(){if(this.condition_config.is_change_value&&this.condition_config.is_change_value==!0){if(!this.condition_config.script_change_value||this.condition_config.script_change_value==""){s.warn(this.condition_name+this.condition_config.label+"\u56DE\u8F66\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}s.info("\u6267\u884C"+this.condition_name+this.condition_config.label+" \u56DE\u8F66\u4E8B\u4EF6\u811A\u672C");let e=new Function("condition_config","value",this.condition_config.script_change_value);this.condition_config.control_type==this.global_query.control_type.selectTree.code?e.apply(this,[this.condition_config,this.condition_value.value]):e.apply(this,[this.condition_config,this.condition_value])}},keyupEnter(){if(this.condition_config.attributes&&this.condition_config.attributes.is_condition_enter&&this.condition_config.attributes.is_condition_enter==!0){if(!this.condition_config.attributes.script_condition_enter||this.condition_config.attributes.script_condition_enter==""){s.warn(this.condition_name+this.condition_config.label+"\u56DE\u8F66\u4E8B\u4EF6\u811A\u672C\u4E3A\u7A7A");return}s.info("\u6267\u884C"+this.condition_name+this.condition_config.label+" \u56DE\u8F66\u4E8B\u4EF6\u811A\u672C"),this.keyupEnterScript=new Function("condition_config,value",this.condition_config.attributes.script_condition_enter),this.condition_config.control_type==this.global_query.control_type.selectTree.code?this.keyupEnterScript(this.condition_config,this.condition_value.value):this.keyupEnterScript(this.condition_config,this.condition_value)}},getEnumDataSetJson(e){let i=null;this.$$lib__.each(this.queryConfig.field,n=>{n.guid==e&&n.enum_type==this.global_query.enum_type.data_set.code&&n.data_set.dataSetId&&n.data_set.dataSetId!=""&&(i=JSON.parse(JSON.stringify(n)))}),this.$$lib__.each(this.queryConfig.condition,n=>{n.guid==e&&(n.control_type==this.global_query.control_type.select.code||n.control_type==this.global_query.control_type.selectTree.code||n.control_type==this.global_query.control_type.cascader.code||n.control_type==this.global_query.control_type.radio.code||n.control_type==this.global_query.control_type.checkbox.code)&&n.control_enum_type==this.global_query.enum_type.data_set.code&&n.data_set.dataSetId&&n.data_set.dataSetId!=""&&(i=JSON.parse(JSON.stringify(n)))});let t=null;if(i)t=i.data_set.dataSetId+"_"+e,this.updateDatasetInfo({key:t,data:[],isOk:!1,widgetId:this.widgetId});else{s.error("\u672A\u627E\u5230\u4E3B\u952EID\u4E3A["+e+"]\u7684\u67E5\u8BE2\u7ED3\u679C\u5217\u6216\u67E5\u8BE2\u6761\u4EF6");return}let o={dataSet:JSON.stringify(this.handleDataSetParam(i.data_set))};this.getDataSetSource(o,n=>{let b=[];n&&n.status==200?b=this.getDataSetObjectData(n.data,i.data_set.query,i.data_set.dimensionsAlias,i.data_set.dataSetId):l.Message.error({message:"\u6570\u636E\u96C6:[ "+i.data_set.dataSetName+" ]\u83B7\u53D6\u5931\u8D25\uFF0C"+n.msg,offset:60}),this.updateDatasetInfo({key:t,data:b,widgetId:this.widgetId})})},getEnumList(){let e=[];if(this.condition_config.control_enum_type==this.$$global_query.enum_type.data_set.code)this.condition_config.guid!=""&&this.condition_config.data_set.dataSetId!=""&&this.$$lib__.each(this.datasetInfo.datasetJson[this.condition_config.data_set.dataSetId+"_"+this.condition_config.guid],i=>{i.enumValue=i[this.condition_config.data_set.field_value],i.enumName=i[this.condition_config.data_set.field_name];let t=i[this.condition_config.data_set.field_disabled];t&&(t.toString()=="1"||t.toString()=="true")?i.disabled=!0:t&&(t.toString()=="0"||t.toString()=="false")&&(i.disabled=!1),e.push(i)});else{let i=this.enumInfo.enumJson[this.condition_config.control_enum_name];i&&(e=JSON.parse(JSON.stringify(i)),e=this.$$lib__.sortBy(e,"enumOrder"))}return e}}}},15690:function(p,d,a){a.r(d),a.d(d,{default:function(){return e}});var u=function(){var t=this,c=t._self._c;return c("div",[t.condition_config.attributes.radio_style==t.global_query.control_style.base.code?c("el-checkbox-group",{attrs:{"text-color":t.condition_config.attributes.text_color,min:t.condition_config.attributes.min,max:t.condition_config.attributes.max,fill:t.condition_config.attributes.fill,disabled:t.condition_config.attributes.disabled},on:{change:t.changeValue},model:{value:t.condition_value,callback:function(o){t.condition_value=o},expression:"condition_value"}},t._l(t.options_data,function(o){return c("el-checkbox",{key:o.enumValue,attrs:{border:t.condition_config.attributes.border,disabled:o.disabled,label:o.enumValue}},[t._v(" "+t._s(o.enumName)+" ")])}),1):t._e(),t.condition_config.attributes.radio_style==t.global_query.control_style.button.code?c("el-checkbox-group",{attrs:{"text-color":t.condition_config.attributes.text_color,min:t.condition_config.attributes.min,max:t.condition_config.attributes.max,fill:t.condition_config.attributes.fill,disabled:t.condition_config.attributes.disabled},on:{change:t.changeValue},model:{value:t.condition_value,callback:function(o){t.condition_value=o},expression:"condition_value"}},t._l(t.options_data,function(o){return c("el-checkbox-button",{key:o.enumValue,attrs:{disabled:o.disabled,label:o.enumValue}},[t._v(" "+t._s(o.enumName)+" ")])}),1):t._e()],1)},_=[],l=a(9132),r=a(49500),h={name:"control-checkbox",model:{prop:"value",event:"change"},mixins:[l.M],watch:{value(i){this.setConditionCheckboxValue(i)}},data(){return{condition_name:"\u591A\u9009\u6846",condition_value:[]}},computed:{options_data(){let i=this,t=i.getEnumList();return this.condition_config.attributes.is_enum_filter==!0&&((!this.condition_config.attributes.script_enum_filter||this.condition_config.attributes.script_enum_filter=="")&&r.warn("\u591A\u9009\u6846\u679A\u4E3E\u8FC7\u6EE4\u7684\u811A\u672C\u4E3A\u7A7A"),r.info("\u6267\u884C\u591A\u9009\u6846\u679A\u4E3E\u8FC7\u6EE4\u7684\u811A\u672C\u4E3A\u7A7A"),t=new Function("enum_list",this.condition_config.attributes.script_enum_filter).apply(i,[JSON.parse(JSON.stringify(t))])),t}},mounted(){this.setConditionCheckboxValue(this.value)},methods:{changeValue(i){this.$emit("change",i.length==0?null:i),this.afterChangeValue()},setConditionCheckboxValue(i){i==null?this.condition_value=[]:i instanceof Array?this.condition_value=i:typeof i=="string"&&(this.condition_value=[i])}}},f=h,s=a(68141),g=(0,s.Z)(f,u,_,!1,null,"13c46753",null),e=g.exports}}]);
