"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[99349],{787798:function(d,p,l){l.d(p,{P:function(){return u}});var c=l(555616),h=l.n(c),o=l(149500);const u={created(){},methods:{getFormatterString(s){if(!s)return null;let e;if(s.script){if(o.log("Execute script for formatter component to replace dataset parameters"),s.scriptontent===""){c.Message.warning({message:"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}e=new Function("params",s.scriptontent)}if(s.show&&!s.script){let t=[];for(s.str_start&&t.push(s.str_start),s.a&&(t.push("{a}"),t.push(s.str_a)),s.b&&(t.push("{b}"),t.push(s.str_b)),s.c&&(s.cx?t.push(s.cx):t.push("{c}"),t.push(s.str_c)),s.d&&(t.push("{d}"),t.push(s.str_d)),s.str_end&&t.push(s.str_end),e=t.join("");e.indexOf("\\n")>-1;)e=e.replace("\\n",`
`)}return e}}}},99349:function(d,p,l){l.d(p,{P:function(){return s}});var c=l(787798),h=l(321300),o=l(42160),u=l(149500);const s={created(){},beforeDestroy(){this.echarts&&this.echarts.clear(),this.animationLoop&&clearInterval(this.animationLoop)},mixins:[c.P],data(){return{animationLoop:null,dimensionsEx:null,source:[],source_auto_timer:null,source_auto_carousel:[]}},methods:{getColorInfo(e){if(!e)return null;let t=null;if(e.type==this.$$global_editor.colorType.pureColor.code)t=e.pureColor;else if(e.type==this.$$global_editor.colorType.gradation.code){let a={linear:{type:"linear",x:e.linear.x!=null&&e.linear.x!=null?e.linear.x:0,y:e.linear.y!=null&&e.linear.y!=null?e.linear.y:0,x2:e.linear.x2!=null&&e.linear.x2!=null?e.linear.x2:0,y2:e.linear.y2!=null&&e.linear.y2!=null?e.linear.y2:1,colorStops:[{offset:0,color:e.gradation.start!=null&&e.gradation.start!=""?e.gradation.start:"#FFFFFF"},{offset:1,color:e.gradation.end!=null&&e.gradation.end!=""?e.gradation.end:"#FFFFFF"}],global:!1},radial:{type:"radial",x:e.radial.x!=null&&e.radial.x!=null?e.radial.x:.5,y:e.radial.y!=null&&e.radial.y!=null?e.radial.y:.5,x2:e.radial.r!=null&&e.radial.r!=null?e.radial.r:.5,colorStops:[{offset:0,color:e.gradation.start!=null&&e.gradation.start!=""?e.gradation.start:"#FFFFFF"},{offset:1,color:e.gradation.end!=null&&e.gradation.end!=""?e.gradation.end:"#FFFFFF"}],global:!1}};e.direction&&(t=a[e.direction])}else t=e;return t},getLabelStyle(e){let t=JSON.parse(JSON.stringify(e));return t.padding=this.getSplitNumber(e.padding),t.formatter=this.getFormatterString(e.formatter),t},getTitle(e){let t=JSON.parse(JSON.stringify(e));if(e&&e.top&&(t.top=e.top+"%"),e&&e.bottom&&(t.bottom=e.bottom+"%"),e&&e.left&&(t.left=e.left+"%"),e&&e.right&&(t.right=e.right+"%"),t.text)for(;t.text.indexOf("\\n")>-1;)t.text=t.text.replace("\\n",`
`);return t},getLegend(e){let t=JSON.parse(JSON.stringify(e));if(e&&e.top&&(t.top=e.top+"%"),e&&e.bottom&&(t.bottom=e.bottom+"%"),e&&e.left&&(t.left=e.left+"%"),e&&e.right&&(t.right=e.right+"%"),e&&e.iconURL&&(t.icon=this.getSymbolURL(e.iconURL)),e.formatterType||e.formatterArr){if(e.formatterType==null||e.formatterType=="template")t.formatter=e.formatterArr[0]+"{name}"+e.formatterArr[1];else if(e.formatterType=="script"){let a=this;t.formatter=function(i){return(!e.formatterScript||e.formatterScript=="")&&u.warn("\u56FE\u4F8B\u6587\u672C\u5185\u5BB9\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u56FE\u4F8B\u6587\u672C\u5185\u5BB9\u811A\u672C"),new Function("name",e.formatterScript).apply(a,[i])}}}return t},getGrid(e){let t=JSON.parse(JSON.stringify(e));return e.backgroundColor||(t.backgroundColor="transparent"),e.borderColor||(t.borderColor="transparent"),e.shadowColor||(t.shadowColor="transparent"),e&&e.top&&(t.top=e.top+"%"),e&&e.bottom&&(t.bottom=e.bottom+"%"),e&&e.left&&(t.left=e.left+"%"),e&&e.right&&(t.right=e.right+"%"),t},getSourceList(e,t){let a=[];return this.$$lib__.each(e,(i,n)=>{let r={};r[i]=t[n],a.push(r)}),a},getVisualMap(e){if(e.type==="piecewise"&&!e.setSplit){let t=e.splitNumber?e.splitNumber:5,a=e.precision?e.precision:0,i=((e.max-e.min)/t).toFixed(a),n=[];for(let r=0;r<t;r++)r==0?n.push({min:Math.floor(Number(e.min*Math.pow(10,a)))/Math.pow(10,a),max:Math.ceil(Number((e.min+i*(r+1))*Math.pow(10,a)))/Math.pow(10,a)}):r==t-1?n.push({min:Math.floor(Number((e.min+i*r)*Math.pow(10,a)))/Math.pow(10,a),max:Math.ceil(Number(e.max*Math.pow(10,a)))/Math.pow(10,a)}):n.push({min:Math.floor(Number((e.min+i*r)*Math.pow(10,a)))/Math.pow(10,a),max:Math.ceil(Number((e.min+i*(r+1))*Math.pow(10,a)))/Math.pow(10,a)});e.pieces=n}return e},getVisualmapData(e,t){let a,i,n=e.dataset[e.dataset.type].dimensions,r=e.dataset[e.dataset.type].source,m=null;return this.$$lib__.each(n,(g,f)=>{g==t&&(m=f)}),m>=0&&(a=Number(r[0][m]),i=Number(r[0][m]),this.$$lib__.each(r,g=>{let f=Number(g[m]);a>f&&(a=f),i<f&&(i=f)})),[a,i]},getAxisPointer(e){let t=JSON.parse(JSON.stringify(e));if(e)switch(e.type){case"line":e&&e.lineStyle&&(t.lineStyle.color=this.getColorInfo(e.lineStyle.colorInfo)),o.default.delete(t,"shadowStyle");break;case"shadow":e&&e.shadowStyle&&(t.shadowStyle.color=this.getColorInfo(e.shadowStyle.colorInfo)),o.default.delete(t,"lineStyle");break}return t},getToolbox(e){let t=JSON.parse(JSON.stringify(e));return e.iconStyle.shadowColor||(t.iconStyle.shadowColor="transparent"),t},getTooltip(e){let t=JSON.parse(JSON.stringify(e));if(e.backgroundColor||(t.backgroundColor="rgba(50,50,50,0.7)"),e.borderColor||(t.borderColor="#333"),e&&e.formatter&&(t.formatter=this.getFormatterString(e.formatter)),e.hideDelay&&(t.hideDelay=e.hideDelay*1e3),e.axisPointer)switch(e.axisPointer.type){case"line":e&&e.axisPointer&&e.axisPointer.lineStyle&&(t.axisPointer.lineStyle.color=this.getColorInfo(e.axisPointer.lineStyle.colorInfo)),o.default.delete(t.axisPointer,"shadowStyle"),o.default.delete(t.axisPointer,"crossStyle");break;case"shadow":e&&e.axisPointer&&e.axisPointer.shadowStyle&&(t.axisPointer.shadowStyle.color=this.getColorInfo(e.axisPointer.shadowStyle.colorInfo)),o.default.delete(t.axisPointer,"lineStyle"),o.default.delete(t.axisPointer,"crossStyle");break;case"cross":e&&e.axisPointer&&e.axisPointer.crossStyle&&(t.axisPointer.crossStyle.color=this.getColorInfo(e.axisPointer.crossStyle.colorInfo)),o.default.set(t.axisPointer,"lineStyle",t.axisPointer.crossStyle),o.default.delete(t.axisPointer,"shadowStyle");break}return h.isMobile()&&(t.renderMode="richText",t.confine=!0),t},getxAxis(e){let t=JSON.parse(JSON.stringify(e));return e&&e.axisLabel&&e.axisLabel.formatterArr&&(t.axisLabel.formatter=e.axisLabel.formatterArr[0]+"{value}"+e.axisLabel.formatterArr[1]),t},getyAxis(e){let t=JSON.parse(JSON.stringify(e));return e&&e.axisLabel&&e.axisLabel.formatterArr&&(t.axisLabel.formatter=e.axisLabel.formatterArr[0]+"{value}"+e.axisLabel.formatterArr[1]),t},getRadar(e){let t=JSON.parse(JSON.stringify(e));if(e.axisLine&&e.axisLine.symbol&&e.axisLine.symbol.split(",").length>1&&(t.axisLine.symbol=e.axisLine.symbol.split(",")),t.name.padding=this.getSplitNumber(e.name.padding),t.axisLabel.padding=this.getSplitNumber(e.axisLabel.padding),t.axisLine.symbolSize=this.getSplitNumber(e.axisLine.symbolSize),t.axisLine.symbolOffset=this.getSplitNumber(e.axisLine.symbolOffset),e.name&&e.name.show==!0&&(e.name.formatterType||e.name.formatterArr)){if(e.name.formatterType==null||e.name.formatterType=="template")t.name.formatter=e.name.formatterArr[0]+"{value}"+e.name.formatterArr[1];else if(e.name.formatterType=="script"){let a=this;t.name.formatter=function(i,n){return(!e.name.formatterScript||e.name.formatterScript=="")&&u.warn("\u6307\u793A\u5668\u540D\u79F0\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u6307\u793A\u5668\u540D\u79F0\u5185\u5BB9\u811A\u672C"),new Function("value","indicator",e.name.formatterScript).apply(a,[i,n])}}}if(e.axisLabel&&(e.axisLabel.formatterType||e.axisLabel.formatterArr)){if(e.axisLabel.formatterType==null||e.axisLabel.formatterType=="template")t.axisLabel.formatter=e.axisLabel.formatterArr[0]+"{value}"+e.axisLabel.formatterArr[1];else if(e.axisLabel.formatterType=="script"){let a=this;t.axisLabel.formatter=function(i,n){return(!e.axisLabel.formatterScript||e.axisLabel.formatterScript=="")&&u.warn("\u523B\u5EA6\u6807\u7B7E\u811A\u672C\u4E3A\u7A7A"),u.info("\u6267\u884C\u523B\u5EA6\u6807\u7B7E\u5185\u5BB9\u811A\u672C"),new Function("value","index",e.axisLabel.formatterScript).apply(a,[i,n])}}}return t},getOptionColor(e){if(e.useType=="system")return this.$$global_editor.predefineColors;{let t=[];return this.$$lib__.each(e.colorList,a=>{t.push(this.getColorInfo(a))}),t}},getSymbolURL(e){if(e&&e!="")return"image://"+h.appendImageBaseURL(e)},getAnimation(e,t){if(Array.isArray(e.series))this.$$lib__.each(e.series,i=>{i.animation=t.config.animation.animation,i.animationDuration=t.config.animation.animationDuration,i.animationEasing=t.config.animation.animationEasing,i.animationDurationUpdate=t.config.animation.animationDuration,i.animationEasingUpdate=t.config.animation.animationEasing;let n=0;i.animationDelay=r=>r==null||r==null?(n++,n*t.config.animation.animationDelayMultiple):(r+1)*t.config.animation.animationDelayMultiple}),e.series.animationEasing="elasticOut";else{e.series.animation=t.config.animation.animation,e.series.animationDuration=t.config.animation.animationDuration,e.series.animationEasing=t.config.animation.animationEasing,e.series.animationDurationUpdate=t.config.animation.animationDuration,e.series.animationEasingUpdate=t.config.animation.animationEasing;let i=0;e.series.animationDelay=n=>n==null||n==null?(i++,i*t.config.animation.animationDelayMultiple):(n+1)*t.config.animation.animationDelayMultiple}e.animation=t.config.animation.animation,e.animationDuration=t.config.animation.animationDuration,e.animationEasing=t.config.animation.animationEasing,e.animationDurationUpdate=t.config.animation.animationDuration,e.animationEasingUpdate=t.config.animation.animationEasing;let a=0;e.animationDelayUpdate=i=>i==null||i==null?(a++,a*t.config.animation.animationDelayMultiple):(i+1)*t.config.animation.animationDelayMultiple},setAnimationLoop(e,t){this.animationLoop&&(clearInterval(this.animationLoop),this.animationLoop=null);let a=0;e.config.animation.animation&&e.config.animation&&e.config.animation.animationLoop?a=e.config.animation.animationDuration+e.config.animation.animationInterval:e.config.series&&e.config.series.animationLoop&&(a=e.config.series.animationDuration+e.config.series.animationInterval),a>0&&(this.animationLoop=setInterval(()=>{t()},a))},getProgressLength(e){let t=e.dataset[e.dataset.type],a=t.encode.length;if(a){let i;for(let n=0;n<t.dimensions.length;n++)t.dimensions[n]===a&&(i=n);if(i)for(let n=0;n<t.source.length;n++)e.config.partitionAttr.widthData[n]=t.source[n][i]}else e.config.partitionAttr.widthData=e.config.partitionAttr.width},getSplitNumber(e){let t=null;return e&&e.split(",").length>1?t=e.split(",").map(a=>+a):t=+e,t},getSplitString(e){let t=null;return e&&e.split(",").length>1?t=e.split(",").map(a=>a):t=e,t},getGraphic(e){let t={elements:[]},a=[];if(e.image){let i=JSON.parse(JSON.stringify(e.image));i.style.imageUrl&&(i.style.image=this.getImageUrl(e.image.style.imageUrl)),i.type="image",i.z=9999,a.push(i)}if(e.text){let i=JSON.parse(JSON.stringify(e.text)),n="";e.text.style.fontSize&&(n=n+e.text.style.fontSize+"px "),e.text.style.fontFamily&&(n=n+e.text.style.fontFamily+" "),i.type="text",i.z=9999,i.style.font=n,a.push(i)}if(e.group){let i=JSON.parse(JSON.stringify(e.group));i.type="group",i.z=9999,i.children=a,t.elements.push(i)}else t.elements=a;return t},getImageUrl(e){if(e&&e!=="")return h.appendImageBaseURL(e)},setAutoCarousel(e,t){let a=t.length;if(a>0){let i=e.config.autoCarousel.carouselSize!=null?e.config.autoCarousel.carouselSize:null;this.source_auto_carousel=JSON.parse(JSON.stringify(t));let n=[];i&&i<a?n=this.source_auto_carousel.slice(0,i):n=JSON.parse(JSON.stringify(this.source_auto_carousel)),this.renderEcharts(e,n);let r=3;e.config.autoCarousel.carouselTime&&(r=e.config.autoCarousel.carouselTime),this.source_auto_timer=setInterval(()=>{this.source_auto_carousel.push(JSON.parse(JSON.stringify(this.source_auto_carousel[0]))),this.source_auto_carousel.shift();let m=[];i&&i<a?m=this.source_auto_carousel.slice(0,i):m=JSON.parse(JSON.stringify(this.source_auto_carousel)),this.renderEcharts(e,m)},r*1e3)}else this.renderEcharts(e,t)},clearAutoCarousel(){this.source_auto_timer&&clearInterval(this.source_auto_timer)}}}}}]);
