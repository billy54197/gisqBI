"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[383],{59738:function(I,d,a){a.d(d,{OW:function(){return f},m3:function(){return m},nm:function(){return h},vP:function(){return p},xC:function(){return g}});var l=a(53258);function f(t,n,o){let e=t;const s=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(u=>(0,l.mf)(e[u]));if(!(0,l.mf)(e[s]))return!1;do{if(e[s](n))return!0;if(e===o)return!1;e=e.parentNode}while(e);return!1}function h(t){const n=window.getComputedStyle(t);return[parseFloat(n.getPropertyValue("width"),10),parseFloat(n.getPropertyValue("height"),10)]}function p(t,n,o){t&&(t.attachEvent?t.attachEvent("on"+n,o):t.addEventListener?t.addEventListener(n,o,!0):t["on"+n]=o)}function g(t,n,o){t&&(t.detachEvent?t.detachEvent("on"+n,o):t.removeEventListener?t.removeEventListener(n,o,!0):t["on"+n]=null)}function m(t,n,o,e){var s=0,u=setInterval(()=>{s<o?(s++,t()):(clearInterval(u),e&&e())},n);return u}},53258:function(I,d,a){a.d(d,{ew:function(){return p},le:function(){return g},mf:function(){return l},sg:function(){return m},xn:function(){return f}});function l(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function f(t,n,o,e=1){const s=Math.round(n/e/t[0])*t[0],u=Math.round(o/e/t[1])*t[1];return[s,u]}function h(t){const n=t.getBoundingClientRect();return[parseInt(n.width),parseInt(n.height)]}function p(t,n,o){return t-n-o}function g(t,n,o){return t-n-o}function m(t,n,o){return n!==null&&t<n?n:o!==null&&o<t?o:t}},44513:function(I,d,a){a.d(d,{Z:function(){return n}});var l=function(){var e=this,s=e._self._c;return e.attr.buttonHide?s("div",{style:{position:"absolute",right:e.attr.buttonHideRight+"px",top:e.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(u){return e.onHide()}}},[e.openTooltip?s("el-tooltip",{attrs:{"open-delay":1e3,content:e.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[s("el-button",{class:e.attr.buttonHideIconClass&&e.attr.buttonHideIconClass!=""?e.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:e.attr.buttonHideColor,fontSize:e.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s("el-button",{class:e.attr.buttonHideIconClass&&e.attr.buttonHideIconClass!=""?e.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:e.attr.buttonHideColor,fontSize:e.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):e._e()},f=[],h=a(52246),p={props:["attr"],name:"hide-button",data(){return{isPc:h.b}},computed:{openTooltip:function(){let o=!1,e=this.attr.buttonHideTooltipContent;return h.b&&e&&e!=null&&e.trim()!=""&&(o=!0),o}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},g=p,m=a(68141),t=(0,m.Z)(g,l,f,!1,null,"bf399b9a",null),n=t.exports},80383:function(I,d,a){a.r(d),a.d(d,{default:function(){return H}});var l=function(){var i=this,v=i._self._c;return v("div",{directives:[{name:"show",rawName:"v-show",value:i.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],ref:"gisBase",staticClass:"my-gisBase",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[v("hide-button",{attrs:{attr:i.widgetInfo.attr}}),i.widgetInfo.config.imgIconConfig.isHtml?v("div",{domProps:{innerHTML:i._s(i.widgetInfo.config.imgIconConfig.html)}}):v("img",{staticStyle:{border:"none"},attrs:{src:i.widgetInfo.config.imgIconConfig.img||i.tocImgUrl,width:i.widgetInfo.config.imgIconConfig.width,height:i.widgetInfo.config.imgIconConfig.height},on:{click:i.doChecked1}})],1)},f=[],h=a(44513),p=a(27966),g=a(89075),m=a(45061),t=a(26711),n=a(86892),o=a(59738),e=a(49500);let s=a(20612);var u={name:"GisKhAnalysis",components:{HideButton:h.Z},mixins:[g.u,n.D,m.u,t.H],props:["widgetInfo"],data(){return{timer:"",map:null,tocConfig:null,tocImgUrl:s,heatData:{type:"FeatureCollection",features:[{type:"Point",coordinates:[104.4,31.19],count:100},{type:"Point",coordinates:[113.3,30.6],count:19},{type:"Point",coordinates:[123.3,30.6],count:419},{type:"Point",coordinates:[105.3,30.6],count:319},{type:"Point",coordinates:[106.3,30.6],count:719},{type:"Point",coordinates:[109.3,31.6],count:519},{type:"Point",coordinates:[109.3,30.6],count:319},{type:"Point",coordinates:[108.3,32.6],count:139},{type:"Point",coordinates:[118.3,31.6],count:129},{type:"Point",coordinates:[108.3,33.6],count:190},{type:"Point",coordinates:[108.3,32.6],count:189},{type:"Point",coordinates:[100.3,30.6],count:1},{type:"Point",coordinates:[109.3,30.6],count:119},{type:"Point",coordinates:[108.3,31.6],count:200},{type:"Point",coordinates:[118.3,30.6],count:300}]}}},computed:{},beforeDestroy(){},mounted(){var r=this.imgWidth;this.initAction(this.widgetInfo),this.timer=(0,o.m3)(this.getBindMap,500,50,()=>{e.error("gis-kh-analysis\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")})},methods:{loadInfo(r){var i=r.dataset.dynamic.source;this.databaseInfo=i,this.doChecked1()},reLoadInfo(r){this.loadInfo(r)},initAction(r){this.actionSendout(r),this.actionReceive(r)},getBindMap(){if(typeof this.widgetInfo.action.gisMapId<"u"){e.log(this.widgetInfo.action.gisMapId);let r=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(r){clearInterval(this.timer);let i=r.$refs.gismap;i&&(e.log("\u83B7\u53D6map\u5BF9\u8C61\u6210\u529F\uFF0C\u7EC4\u4EF6\u7ED1\u5B9A\u5730\u56FE\uFF0C\u5173\u95ED\u5B9A\u65F6\u5668"),this.map=i.map,this.$refs.measure.map=this.map,this.reLoadInfo(this.widgetInfo))}}},doChecked1(r){let i=this,v=i.widgetInfo.action.sendOut.actionList;var E=this.databaseInfo;let C={type:"FeatureCollection",features:[]},S=[];this.databaseInfo.forEach(function(c,b){var y={type:"Point",coordinates:[Number(c[1]),Number(c[2])],count:Number(c[3])};C.features.push(y)}),this.$$lib__.each(v,c=>{if(c.enabled&&c.code==i.$$global_editor.actionType.sendHeatData.code){let b=c.code+"_"+i.widgetInfo.id,y={isGeojson:!0,geojson:C};c.paramsExtend&&c.paramsExtend.length>0&&this.getExtendParams(y,c.paramsExtend,[],[]),e.log(y),p.Z.$emit(b,y),c.postMessage&&this.doPostMessage(y),this.actionNameList.push(b)}})},doGetTime(r,i){}}},x=u,w=a(68141),P=(0,w.Z)(x,l,f,!1,null,"1f1b4ffc",null),H=P.exports}}]);
