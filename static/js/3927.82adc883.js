"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[3927],{56279:function(C,h,s){s.d(h,{P:function(){return g}});var v=s(86892),d=s(49500);const g={mixins:[v.D],created(){},methods:{lifecycleBeforeChartsLoad(r){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&d.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),d.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let p=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[r]);if(p)return p}return r},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&d.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),d.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},44513:function(C,h,s){s.d(h,{Z:function(){return b}});var v=function(){var n=this,m=n._self._c;return n.attr.buttonHide?m("div",{style:{position:"absolute",right:n.attr.buttonHideRight+"px",top:n.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(L){return n.onHide()}}},[n.openTooltip?m("el-tooltip",{attrs:{"open-delay":1e3,content:n.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[m("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):m("el-button",{class:n.attr.buttonHideIconClass&&n.attr.buttonHideIconClass!=""?n.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:n.attr.buttonHideColor,fontSize:n.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):n._e()},d=[],g=s(52246),r={props:["attr"],name:"hide-button",data(){return{isPc:g.b}},computed:{openTooltip:function(){let u=!1,n=this.attr.buttonHideTooltipContent;return g.b&&n&&n!=null&&n.trim()!=""&&(u=!0),u}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},w=r,p=s(68141),x=(0,p.Z)(w,v,d,!1,null,"bf399b9a",null),b=x.exports},23927:function(C,h,s){s.r(h),s.d(h,{default:function(){return H}});var v=function(){var o=this,i=o._self._c;return i("div",{ref:"svg",style:o.containerStyle},[i("div",{ref:"svgDiv",style:{marginLeft:o.mUtils.getNewPxW(o.widgetInfo.config.global.marginLeft)+"px",marginTop:o.mUtils.getNewPxH(o.widgetInfo.config.global.marginTop)+"px"},domProps:{innerHTML:o._s(o.svgContent)}}),i("hide-button",{attrs:{attr:o.widgetInfo.attr}})],1)},d=[],g=s(44513),r=s(27966),w=s(42196),p=s(45061),x=s(26711),b=s(56279),u=s(55616),n=s(49500),m={name:"PictureSvg",components:{HideButton:g.Z},mixins:[p.u,x.H,b.P,w.u],props:["widgetInfo"],data(){return{svgSource:[],paramsIndex:"",svgContent:""}},computed:{containerStyle(){let t=this.widgetInfo.config&&this.widgetInfo.config.expandMode?this.widgetInfo.config.expandMode:"hidden",o={width:this.widgetInfo.attr.w+"px",height:this.widgetInfo.attr.hh+"px",overflow:t};return t.startsWith("visible")&&(o.width="auto"),t.endsWith("visible")&&(o.height="auto"),this.$nextTick(()=>{let i=this.$el&&this.$el.parentElement.parentElement.className.indexOf("my-drag-widget")>-1?this.$el.parentElement.parentElement:null;i&&(i.style.overflow=t.indexOf("visible")>-1?"visible":"hidden")}),o}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},created(){window.click=this.onClick},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},methods:{loadInfo(t){this.getSvgSource(t),this.lifecycleAfterLoad()},getSvgSource(t){let o=t.dataset[t.dataset.type].encode,i=t.dataset[t.dataset.type].source,c=t.dataset[t.dataset.type].columnList;if(this.svgContent=this.widgetInfo.config.svgStyle.svgContent,o.paramsList.forEach(e=>{let a=this.getIndex(e.val,c);this.replaceParams(i,a,e.key)}),t.action&&t.action.sendOut&&t.action.sendOut.actionList){let e=t.action.sendOut.actionList.find(a=>a.enabled&&a.code==="resize");e&&this.$nextTick(()=>{this.$nextTick(()=>{let a=this.$refs.svgDiv.getBoundingClientRect(),I=e.code+"_"+this.widgetInfo.id,l={height:a.height,width:a.width};if(e.paramsExtend&&e.paramsExtend.length>0){let f=[];this.widgetInfo.dataset[this.widgetInfo.dataset.type].source&&this.widgetInfo.dataset[this.widgetInfo.dataset.type].source.length>0&&(f=this.widgetInfo.dataset[this.widgetInfo.dataset.type].source[0]),this.getExtendParams(l,e.paramsExtend,f,this.widgetInfo.dataset[this.widgetInfo.dataset.type].dimensions)}if(e.script&&e.script.enabled){if(n.log("Execute script for "+this.widgetInfo.name+" component to "+e.name+" component"),e.script.content==""){u.Message.warning({message:e.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param",e.script.content),l=this.customScript_actionSend_clickParam(l)}r.Z.$emit(I,l,this),this.actionNameList.push(I),e.postMessage&&this.doPostMessage(l)})})}},getIndex(t,o){let i=-1;return o.forEach(c=>{t===c.name&&(i=c.index)}),i},replaceParams(t,o,i){let c=[],e=this;t.forEach(f=>{c.push(f[o])});let a=null;this.widgetInfo.config.svgStyle.defaultTxt==null?a="":a=this.widgetInfo.config.svgStyle.defaultTxt;let I=/\${.*?}/g,l=e.svgContent.match(I);l&&l.forEach(f=>{if(f.split("${")[1].split(",").length>1){let y=f.split("${")[1].split(",")[1].split("}")[0];c[y]==null?e.svgContent=e.svgContent.replace("${"+i+","+y+"}",a):e.svgContent=e.svgContent.replace("${"+i+","+y+"}",c[y])}else c[0]==null?e.svgContent=e.svgContent.replace("${"+i+"}",a):e.svgContent=e.svgContent.replace("${"+i+"}",c[0])})},reLoadInfo(t){this.loadInfo(t)},initAction(t){this.actionSendout(t),this.actionReceive(t)},sendoutClick(t){this.paramsIndex=t},onClick(){let t=this,o=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(o,i=>{if(i.enabled&&i.code==t.$$global_editor.actionType.click.code){let c=t.$$global_editor.actionType.click.code+"_"+t.widgetInfo.id,e={};for(let a in arguments)e["param"+a]=arguments[a];if(n.log(e),i.paramsExtend&&i.paramsExtend.length>0){let a=[];t.widgetInfo.dataset[t.widgetInfo.dataset.type].source&&t.widgetInfo.dataset[t.widgetInfo.dataset.type].source.length>0&&(a=t.widgetInfo.dataset[t.widgetInfo.dataset.type].source[0]),this.getExtendParams(e,i.paramsExtend,a,t.widgetInfo.dataset[t.widgetInfo.dataset.type].dimensions)}if(i.script&&i.script.enabled){if(n.log("Execute script for "+t.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){u.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param",i.script.content),e=this.customScript_actionSend_clickParam(e)}r.Z.$emit(c,e),this.actionNameList.push(c),i.postMessage&&this.doPostMessage(e)}})}}},L=m,S=s(68141),$=(0,S.Z)(L,v,d,!1,null,"36f1f294",null),H=$.exports}}]);
