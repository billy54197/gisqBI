"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[34473],{534473:function(v,d,n){n.r(d),n.d(d,{default:function(){return m}});var c=function(){var t=this,a=t._self._c;return a("div",[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"70px","label-position":"right",model:t.currentWidget.dataset}},[a("el-form-item",{attrs:{label:"\u6570\u636E\u7C7B\u578B"}},[a("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90\u7C7B\u578B"},on:{change:t.changeDatasetType},model:{value:t.currentWidget.dataset.type,callback:function(i){t.$set(t.currentWidget.dataset,"type",i)},expression:"currentWidget.dataset.type"}},t._l(this.$$global_editor.dataSourcTypeList3,function(i){return a("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),a("vue-lazy-component",[a("el-form-item",{attrs:{label:"x\u8F74"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9X\u8F74\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:t.changeX},model:{value:t.currentWidget.dataset[t.currentWidget.dataset.type].encode.x,callback:function(i){t.$set(t.currentWidget.dataset[t.currentWidget.dataset.type].encode,"x",i)},expression:"currentWidget.dataset[currentWidget.dataset.type].encode.x"}},t._l(this.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(i){return a("el-option",{key:i.name,attrs:{label:i.alias!=""?i.alias:i.name,value:i.name}})}),1),a("el-tooltip",{attrs:{content:"\u6DFB\u52A0\u6298\u7EBF","open-delay":1e3,effect:"dark",placement:"top"}},[a("el-button",{staticClass:"el-icon-plus",staticStyle:{color:"#13CE66","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text"},on:{click:function(i){return t.addY()}}})],1)],1),t._l(t.seriesList,function(i,r){return a("el-form-item",{key:r,attrs:{label:"\u6298\u7EBF"+(r+1)}},[a("el-select",{staticStyle:{width:"160px"},attrs:{size:"mini",placeholder:"\u8BF7\u9009\u62E9\u6298\u7EBF\u6620\u5C04\u7684\u5B57\u6BB5"},on:{change:function(s){return t.changeY(r)}},model:{value:i.encode.y,callback:function(s){t.$set(i.encode,"y",s)},expression:"ser.encode.y"}},t._l(t.currentWidget.dataset[t.currentWidget.dataset.type].dimensionsAlias,function(s){return a("el-option",{key:s.name,attrs:{label:s.alias!=""?s.alias:s.name,value:s.name}})}),1),a("el-tooltip",{attrs:{content:"\u79FB\u9664\u6298\u7EBF","open-delay":1e3,effect:"dark",placement:"top"}},[a("el-button",{staticStyle:{color:"#f6061b","margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(s){return t.deleteY(r)}}})],1)],1)})],2),a("setting-dataset",{ref:"settingDataset",attrs:{currentWidget:t.currentWidget},on:{getDataSetData:t.getConfigData,clearDynamicEncode:t.clearDynamicEncode}})],1)],1)},l=[],o=n(589908),g=n(846577),u=n(723400),h=n(597910),p={name:"bar-stack-data",props:["currentWidget"],components:{SettingDataset:o.Z},mixins:[h.baseConfig,u.j],computed:{seriesList:function(){return this.currentWidget.config.series}},methods:{changeDatasetType(){this.$refs.settingDataset.loadPreview(),this.clearDynamicEncode(),this.initName(this.seriesList),this.getConfigData()},clearDynamicEncode(){this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x="";for(let e=0;e<this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y.length;e++)this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y[e]="";this.$$lib__.each(this.seriesList,e=>{e.encode.x="",e.encode.y=""}),this.$$lib__.each(this.currentWidget.config.series,e=>{e.encode.x="",e.encode.y=""})},addY(){let e=[],t=JSON.parse(JSON.stringify(g.Z.charts.line.line_stack.config.series[0]));t.encode={x:"",y:""},this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x&&(t.encode.x=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x),e=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y,e.push(""),this.seriesList.push(JSON.parse(JSON.stringify(t))),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y=e},deleteY(e){let t=[];this.seriesList.splice(e,1),t=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y,t.splice(e,1),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y=t,this.getConfigData()},changeX(){for(let e=0;e<this.seriesList.length;e++)this.seriesList[e].encode.x=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.x;this.getConfigData()},changeY(e){let t=[];t=this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y,t.splice(e,1,this.seriesList[e].encode.y),this.currentWidget.dataset[this.currentWidget.dataset.type].encode.y=t;let a=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias;this.currentWidget.config.series[e].name=this.getLegendData(a,this.seriesList[e].encode.y),this.getConfigData()},initName(e){let t=this.currentWidget.dataset[this.currentWidget.dataset.type].dimensionsAlias;this.$$lib__.each(e,a=>{let i=a.encode.y,r=this.$$lib__.find(t,s=>s.name==i);r?a.name=r.alias:a.name=""})},getLegendData(e,t){let a=this.$$lib__.find(e,i=>i.name==t);return a?a.alias&&a.alias!=""?a.alias:a.name:""},setSeriesList(){this.currentWidget.config.series=this.seriesList}}},y=p,f=n(768141),W=(0,f.Z)(y,c,l,!1,null,"15a0b9ac",null),m=W.exports}}]);
