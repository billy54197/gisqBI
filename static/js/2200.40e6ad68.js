"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[2200],{56279:function(A,L,l){l.d(L,{P:function(){return O}});var z=l(86892),w=l(49500);const O={mixins:[z.D],created(){},methods:{lifecycleBeforeChartsLoad(b){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&w.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),w.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let C=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[b]);if(C)return C}return b},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&w.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),w.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},92200:function(A,L,l){l.r(L),l.d(L,{default:function(){return G}});var z=function(){var i=this,d=i._self._c;return d("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[d("hide-button",{attrs:{attr:i.widgetInfo.attr}}),d("div",{ref:"pieThreeDimensional",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"},attrs:{id:"pieThreeDimensional"}})],1)},w=[],O=l(44513),b=l(35776),c=l.n(b),C=l(7715),$=l.n(C),D=l(27966),H=l(56279),J=l(45061),M=l(26711),B=l(68326),R=l(67157),V=l(50666);const Z={mixins:[R.c],data(){return{config_extend:{},filter_config:{legend:{style:{color:""},itemStyle:{color:""}},series:{colors:["#29CC97"],dataLabels:{style:{color:"rgba(52, 73, 94, 1)"}}}}}},methods:{filterPredefineColoursSchemeConfig(t,i){this.getNewConfigWithArrary(t,i,this.filter_config)}}};var k=l(99349),E=l(55616),F=l(75770),N=l(49500);$()(c());var j={name:"PieThreeDimensional",components:{HideButton:O.Z},mixins:[H.P,J.u,M.H,k.P,c(),B.u,Z],props:["widgetInfo"],data(){return{}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},methods:{initAction(t){this.actionReceive(t)},loadInfo(t){c().wrap(c().seriesTypes.pie.prototype.pointClass.prototype,"getTranslate",function(n){var o=n.apply(this,[].slice.call(arguments,1));return this.height&&this.height!=""&&(o.translateY=-this.height),o}),c().wrap(c().seriesTypes.pie.prototype,"translate",function(n){if(n.apply(this,[].slice.call(arguments,1)),!!this.chart.is3d()&&!(t.dataset[t.dataset.type].encode.height==null||t.dataset[t.dataset.type].encode.height=="")){var o=this,h=o.chart,h=o.chart,m=h.options,p=o.options,u=p.depth||0,v=m.chart.options3d,y=v.alpha,K=v.beta,T=p.stacking?(p.stack||0)*u:o._i*u;T+=u/2,p.grouping!==!1&&(T=0),o.data.forEach(x=>{var I=x.shapeArgs;x.shapeType="arc3d";var P=x.options.height;I.z=T,I.depth=u*.75+Math.abs(P)||u,I.alpha=y,I.beta=K,I.center=o.center,I.ran=P,x.slicedTranslation.translateX*=2,x.slicedTranslation.translateY=-P})}}),function(n){n.wrap(c().SVGRenderer.prototype,"arc3dPath",function(o){var h=o.apply(this,[].slice.call(arguments,1));return h.zTop=(h.zOut+.5)/100,h})}(c());let i=this.getSeriesData(t.dataset[t.dataset.type].source,t.dataset[t.dataset.type].dimensions,t.dataset[t.dataset.type].encode),d=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(d.config.chart)),g=this.getLegend(JSON.parse(JSON.stringify(d.config.legend))),a=JSON.parse(JSON.stringify(d.config.tooltip)),e=JSON.parse(JSON.stringify(d.config.series)),s=this;if(e.dataLabels.formatter&&e.dataLabels.formatter.script)if(e.dataLabels.formatter.scriptontent){let n=new Function("params",e.dataLabels.formatter.scriptontent);e.dataLabels.formatter=function(){let o=this,h={data:{},name:this.key,percent:Math.floor(this.percentage*100)/100},m=s.widgetInfo.dataset,p=m[m.type],u=p.dimensions.indexOf(p.encode.name);if(u>-1){let v=p.source.find(y=>o.key==y[u]);for(let y=0;y<v.length;++y)h.data[p.dimensions[y]]=v[y]}return n.call(s,h)}}else N.error("\u542F\u7528\u81EA\u5B9A\u4E49\u6807\u7B7E\uFF0C\u4F46\u672A\u586B\u5199\u4EFB\u4F55\u811A\u672C\u5185\u5BB9");else if(e.dataLabels.formatter&&e.dataLabels.formatter.show){let n=e.dataLabels.formatter,o="";if(n.str_start&&(o+=n.str_start),n.a){let h=s.widgetInfo.dataset,m=h[h.type],p=m.dimensions.indexOf(m.encode.name);o+=m.dimensionsAlias[p].alias,n.str_a&&(o+=n.str_a)}n.b&&(o+="{point.name}",n.str_b&&(o+=n.str_b)),n.c&&(o+="{point.y}",n.str_c&&(o+=n.str_c)),n.d&&(o+="{point.percentage:.2f}",n.str_d&&(o+=n.str_d)),n.str_end&&(o+=n.str_end),delete e.dataLabels.formatter,e.dataLabels.format=o}else delete e.dataLabels.formatter,e.dataLabels.format="{point.name}";let f=e.dataLabels.style;f.textShadow&&(f.textShadow=f.hShadow+"px "+f.vShadow+"px "+f.textShadowColor||"rgba(0,0,0,0)");let S={chart:{type:"pie",options3d:{enabled:!0,alpha:r.options3d.alpha,beta:r.options3d.beta,viewDistance:25},width:d.attr.w,height:d.attr.hh,marginLeft:r.marginLeft,marginRight:r.marginRight,marginTop:r.marginTop,marginBottom:r.marginBottom,backgroundColor:"rgba(255,255,255,0)"},title:{text:""},credits:{enabled:!1},legend:g,tooltip:a,plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0},showInLegend:g.enabled,events:{click:n=>{s.onClick(n.point)}}}},series:[{type:"pie",name:e.name,animation:{duration:e.animation.duration*1e3},colors:e.colors,center:[e.center[0]+"%",e.center[1]+"%"],startAngle:e.startAngle,depth:r.options3d.depth,minSize:e.minSize,innerSize:e.innerSize,size:e.size,label:e.label,dataLabels:e.dataLabels,states:e.states,data:i}]};d.config.series.colorCustom&&(S.series[0].colors=e.colors.length>0?e.colors:c().getOptions().colors),d.config.series&&!d.config.series.colorCustom&&(S.series[0].colors=c().getOptions().colors),c().chart(this.$refs.pieThreeDimensional,this.lifecycleBeforeChartsLoad(S))},reLoadInfo(t){this.loadInfo(t)},getSeriesData(t,i,d){let r,g,a;this.$$lib__.each(i,(s,f)=>{s==d.name&&(r=f),s==d.value&&(g=f),s==d.height&&(a=f)});let e=[];return this.$$lib__.each(t,s=>{e.push({name:s[r],y:parseFloat(s[g]),height:parseFloat(s[a])})}),e},onClick(t){let i=this.widgetInfo,d=[],r=this,g=i.action.sendOut.actionList;r.$$lib__.each(g,a=>{let e=a.code+"_"+i.id,s={};a.paramsExtend&&a.paramsExtend.length>0&&r.getParamsExtend(s,a.paramsExtend,i);let f=a.postMessage;if(s.name=t.name,s.value=t.y,a.enabled&&a.code==F.Z.click.code){if(i.dataset[i.dataset.type].source&&i.dataset[i.dataset.type].source.length>0&&(d=i.dataset[i.dataset.type].source[t.index]),r.getExtendParams(s,a.paramsExtend,d,i.dataset[i.dataset.type].dimensions),a.script&&a.script.enabled){if(N.log("Execute script for "+r.widgetInfo.name+" component to "+a.name+" component"),a.script.content==""){E.Message.warning({message:a.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",a.script.content),s=this.customScript_actionSend_clickParam(s,t)}D.Z.$emit(e,s),f&&r.doPostMessage(s)}else if(a.enabled&&a.code==F.Z.click.openLink.code){if(a.paramsExtend&&a.paramsExtend.length>0){let S=[];i.dataset[i.dataset.type].source&&i.dataset[i.dataset.type].source.length>0&&(S=i.dataset[i.dataset.type].source[t.index]),a.type===r.$$global_editor.linkType.dynamic.code&&(a[r.$$global_editor.linkType.dynamic.code].url=r.getActionUrl(a,i.dataset[i.dataset.type].source[t.index],i.dataset[i.dataset.type].dimensions)),r.getExtendParams(s,a.paramsExtend,S,i.dataset[i.dataset.type].dimensions)}if(a.script&&a.script.enabled){if(N.log("Execute script for "+r.widgetInfo.name+" component to "+a.name+" component"),a.script.content==""){E.Message.warning({message:a.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript_actionSend_clickParam=new Function("param,params",a.script.content),s=this.customScript_actionSend_clickParam(s,t)}r.openLinkAction(a,s,t)}})},getLegend(t){return t.itemStyle&&t.itemStyle.fontSize&&(t.itemStyle.fontSize=t.itemStyle.fontSize+"px"),t.itemHoverStyle&&t.itemHoverStyle.fontSize&&(t.itemHoverStyle.fontSize=t.itemHoverStyle.fontSize+"px"),t.itemHiddenStyle&&t.itemHiddenStyle.fontSize&&(t.itemHiddenStyle.fontSize=t.itemHiddenStyle.fontSize+"px"),t.labelFormatter=this.getLabelFormatter(t.labelFormatter),t},getLabelFormatter(t){let i=this.widgetInfo.dataset[this.widgetInfo.dataset.type],d="",r="";if(i.dimensionsAlias&&i.encode)for(let e in i.dimensionsAlias){let s=i.dimensionsAlias[e];s.name==i.encode.name&&(d=s.alias),s.name==i.encode.value&&(r=s.alias)}let g=this;return function(){if(t.script)return new Function("params",t.scriptontent).apply(g,[this]);if(t.show){let e="";return t.str_start&&(e+=t.str_start),t.a&&(e+=d,t.str_a&&(e+=t.str_a)),t.b&&(e+=this.name,t.str_b&&(e+=t.str_b)),t.c&&(e+=this.y,t.str_c&&(e+=t.str_c)),t.d&&(e+=parseFloat(this.percentage).toFixed(2),t.str_d&&t.str_d!=""?e+=t.str_d:e+="%"),t.str_end&&(e+=t.str_end),e.replace(/\\n/g,"<br/>")}else return this.name+""}},resize(){let t=this.$refs.pieThreeDimensional;t.firstChild.style.width=this.widgetInfo.attr.w+"px",t.firstChild.style.height=this.widgetInfo.attr.h+"px",t.firstChild.firstChild.style.width=this.widgetInfo.attr.w+"px",t.firstChild.firstChild.style.height=this.widgetInfo.attr.h+"px",t.firstChild.childNodes[0].childNodes[2].style.width=this.widgetInfo.attr.w+"px",t.firstChild.childNodes[0].childNodes[2].style.height=this.widgetInfo.attr.h+"px",this.loadInfo(this.widgetInfo)}}},U=j,W=l(68141),Y=(0,W.Z)(U,z,w,!1,null,"673ed90b",null),G=Y.exports}}]);
