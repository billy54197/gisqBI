(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[21701],{110565:function(P,A){var a,h,b;(function(u,i){h=[],a=i,b=typeof a=="function"?a.apply(A,h):a,b!==void 0&&(P.exports=b)})(this,function(){var u=52.35987755982988,i=3.141592653589793,I=6378245,C=.006693421622965943,n=function(e,t){var e=+e,t=+t,c=e-.0065,m=t-.006,v=Math.sqrt(c*c+m*m)-2e-5*Math.sin(m*u),g=Math.atan2(m,c)-3e-6*Math.cos(c*u),w=v*Math.cos(g),S=v*Math.sin(g);return[w,S]},o=function(t,e){var e=+e,t=+t,c=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*u),m=Math.atan2(e,t)+3e-6*Math.cos(t*u),v=c*Math.cos(m)+.0065,g=c*Math.sin(m)+.006;return[v,g]},l=function(t,e){var e=+e,t=+t;if(O(t,e))return[t,e];var c=p(t-105,e-35),m=x(t-105,e-35),v=e/180*i,g=Math.sin(v);g=1-C*g*g;var w=Math.sqrt(g);c=c*180/(I*(1-C)/(g*w)*i),m=m*180/(I/w*Math.cos(v)*i);var S=e+c,B=t+m;return[B,S]},r=function(t,e){var e=+e,t=+t;if(O(t,e))return[t,e];var c=p(t-105,e-35),m=x(t-105,e-35),v=e/180*i,g=Math.sin(v);g=1-C*g*g;var w=Math.sqrt(g);c=c*180/(I*(1-C)/(g*w)*i),m=m*180/(I/w*Math.cos(v)*i);var S=e+c,B=t+m;return[t*2-B,e*2-S]},p=function(t,e){var e=+e,t=+t,c=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return c+=(20*Math.sin(6*t*i)+20*Math.sin(2*t*i))*2/3,c+=(20*Math.sin(e*i)+40*Math.sin(e/3*i))*2/3,c+=(160*Math.sin(e/12*i)+320*Math.sin(e*i/30))*2/3,c},x=function(t,e){var e=+e,t=+t,c=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return c+=(20*Math.sin(6*t*i)+20*Math.sin(2*t*i))*2/3,c+=(20*Math.sin(t*i)+40*Math.sin(t/3*i))*2/3,c+=(150*Math.sin(t/12*i)+300*Math.sin(t/30*i))*2/3,c},O=function(t,e){var e=+e,t=+t;return!(t>73.66&&t<135.05&&e>3.86&&e<53.55)};return{bd09togcj02:n,gcj02tobd09:o,wgs84togcj02:l,gcj02towgs84:r}})},752246:function(P,A,a){"use strict";a.d(A,{X:function(){return h},b:function(){return b}});let h={versions:function(){var u=navigator.userAgent;return{trident:u.indexOf("Trident")>-1,presto:u.indexOf("Presto")>-1,webKit:u.indexOf("AppleWebKit")>-1,gecko:u.indexOf("Gecko")>-1&&u.indexOf("KHTML")==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf("Android")>-1,iPhone:u.indexOf("iPhone")>-1,iPad:u.indexOf("iPad")>-1,webApp:u.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},b;h.versions.mobile||h.versions.ios||h.versions.android||h.versions.iPhone||h.versions.iPad?b=!1:b=!0},459738:function(P,A,a){"use strict";a.d(A,{OW:function(){return b},m3:function(){return C},nm:function(){return u},vP:function(){return i},xC:function(){return I}});var h=a(153258);function b(n,o,l){let r=n;const p=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(x=>(0,h.mf)(r[x]));if(!(0,h.mf)(r[p]))return!1;do{if(r[p](o))return!0;if(r===l)return!1;r=r.parentNode}while(r);return!1}function u(n){const o=window.getComputedStyle(n);return[parseFloat(o.getPropertyValue("width"),10),parseFloat(o.getPropertyValue("height"),10)]}function i(n,o,l){n&&(n.attachEvent?n.attachEvent("on"+o,l):n.addEventListener?n.addEventListener(o,l,!0):n["on"+o]=l)}function I(n,o,l){n&&(n.detachEvent?n.detachEvent("on"+o,l):n.removeEventListener?n.removeEventListener(o,l,!0):n["on"+o]=null)}function C(n,o,l,r){var p=0,x=setInterval(()=>{p<l?(p++,n()):(clearInterval(x),r&&r())},o);return x}},153258:function(P,A,a){"use strict";a.d(A,{ew:function(){return i},le:function(){return I},mf:function(){return h},sg:function(){return C},xn:function(){return b}});function h(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Function]"}function b(n,o,l,r=1){const p=Math.round(o/r/n[0])*n[0],x=Math.round(l/r/n[1])*n[1];return[p,x]}function u(n){const o=n.getBoundingClientRect();return[parseInt(o.width),parseInt(o.height)]}function i(n,o,l){return n-o-l}function I(n,o,l){return n-o-l}function C(n,o,l){return o!==null&&n<o?o:l!==null&&l<n?l:n}},844513:function(P,A,a){"use strict";a.d(A,{Z:function(){return o}});var h=function(){var r=this,p=r._self._c;return r.attr.buttonHide?p("div",{style:{position:"absolute",right:r.attr.buttonHideRight+"px",top:r.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(x){return r.onHide()}}},[r.openTooltip?p("el-tooltip",{attrs:{"open-delay":1e3,content:r.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[p("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):p("el-button",{class:r.attr.buttonHideIconClass&&r.attr.buttonHideIconClass!=""?r.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:r.attr.buttonHideColor,fontSize:r.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):r._e()},b=[],u=a(752246),i={props:["attr"],name:"hide-button",data(){return{isPc:u.b}},computed:{openTooltip:function(){let l=!1,r=this.attr.buttonHideTooltipContent;return u.b&&r&&r!=null&&r.trim()!=""&&(l=!0),l}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},I=i,C=a(768141),n=(0,C.Z)(I,h,b,!1,null,"bf399b9a",null),o=n.exports},421701:function(P,A,a){"use strict";a.r(A),a.d(A,{default:function(){return z}});var h=function(){var s=this,M=s._self._c;return M("div",{directives:[{name:"show",rawName:"v-show",value:s.widgetInfo.attr.hide!==!0,expression:"widgetInfo.attr.hide !== true"}],style:{width:s.widgetInfo.attr.w+"px",height:s.widgetInfo.attr.hh+"px"}},[M("el-popover",{attrs:{placement:"bottom-start",trigger:"manual"},model:{value:s.visible,callback:function(d){s.visible=d},expression:"visible"}},[M("div",[M("ul",s._l(s.listAddress,function(d){return M("li",{key:d.uid,staticClass:"search-item",on:{click:function(j){return s.selectItem(d)}}},[s._v(" "+s._s(d.name)+" ")])}),0)]),M("el-input",{attrs:{slot:"reference",placeholder:"\u8BF7\u8F93\u5165\u5730\u540D"},on:{blur:s.handleBlur},slot:"reference",model:{value:s.searchValue,callback:function(d){s.searchValue=d},expression:"searchValue"}},[M("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(d){return s.locatByXY()}},slot:"append"})],1)],1)],1)},b=[],u=a(844513),i=a(927966),I=a(832214),C=a(445061),n=a(126711),o=a(386892),l=a(235776),r=a(555616),p=a(321300),x=a(682571),O=a(660316),E=a(313811),F=a(413798),T=a(390583),e=a(110565),t=a.n(e),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACOUlEQVRYR82XS3LTQBCG/1YlZImcC2BXWdriG+CcIMkJCMuMFpATxJwAWEhZxjkBzglibmC2UqrsE1hiSXCpqTGRsfFoZmRLVWirfnzT3dPTTajwuWHccxw6ZUYf4DaB2lKdwTOAZkQY5znfZ4E/sTVLNoJuGF8Q4bpwaNKRQAxnkInunUlWC+B+mrp0tLgl4MxkSPmfeZg/HV5lV52sTL8UYOn8xa8HIurt5PxZiZkn/HR4UgZRCtAKkxERTvdxXugyMEqFd66ypQSQOXeIbutwXtjImd9lgT/816YSoBUmsqJf1QkgCzMVfscI4N4kfYfxUKfzVRQIJ9mlN163vRWB4/DxM4jfNwEApi/zoPtBC9CKkjEBb5oAYOBbKry+HqCB/P+9Ddt1sJ2CKOEmTl/YnAtvw+f/B9DEFVxLwfdU+BudVRGBeAjQ22bSwHdz4V9oi7CJLqjrhupOGCUZAS/rjAIDP1LhucZOKAWOw2QAwnWdAGB8nAfewArAvZm2HV5M6wKQp2c66GWXnZkVQO1RKDm99KMfSI4Ws31rYXn6nwftygOJpHOjxzMH/HWfVOSg80x0R2U2jEPpPpMRM+7TwNPOk0aA58G0cipMoS8iYgTYNRWm0FcC+HMrKgwqisFj5xpYV2xF8YRAr3VFyeCtB0cnb5WCwoCpHmzzrn2MTFdO7odEJMe2jbdi6Zy5X2Uv1DYiHYiqP9gWnXUrtojEankpWzpMNnaOwKomwng5XKg2HhvnUuY3MPv3IXrIdv0AAAAASUVORK5CYII=",m=a(459738),v=a(149500),g={name:"GisSearchAddress",components:{HideButton:u.Z},mixins:[I.baseConfig,o.D,C.u,n.H],props:["widgetInfo"],data(){return{timer:"",map:null,searchValue:null,listAddress:[],visible:!1,isComeSelect:!1,currentItem:null}},watch:{searchValue(f){this.isComeSelect||(this.isComeSelect=!1,self.currentItem=null,(0,p.getLocationByAddress)(f,null,10,0).then((s,M)=>{s&&s.results&&s.results.length>0?(this.listAddress=s.results,this.currentItem=this.listAddress[0],this.visible=!0):(this.listAddress=[],this.visible=!1)}).catch(s=>{this.visible=!1,(0,r.Message)({message:"\u67E5\u8BE2\u5730\u540D\u5931\u8D25",type:"error"})})),this.isComeSelect=!1}},beforeDestroy(){},mounted(){this.widgetInfo.isDefaultBaseConfig,this.initAction(this.widgetInfo),this.timer=(0,m.m3)(this.getBindMap,500,50,()=>{v.error("gis-search-address\u7EC4\u4EF6getBindMap\u7ED1\u5B9A\u8D85\u65F6")})},methods:{loadInfo(f){},reLoadInfo(f){this.loadInfo(f)},initAction(f){this.registerAction(f,"configMap","mapList",this.doConfigMap),this.actionReceive(f)},analysisFinish(f){let s=this,M=this.widgetInfo.action.sendOut.actionList;this.$$lib__.each(M,d=>{if(d.enabled&&d.code==s.$$global_editor.actionType.analyze.code){let j=d.code+"_"+s.widgetInfo.id,y={result:f};d.paramsExtend&&d.paramsExtend.length>0&&this.getExtendParams(y,d.paramsExtend,[],[]),d.script&&d.script.enabled&&d.script.content&&(this.doConfigMap=new Function("data",d.script.content),this.doConfigMap(y)),v.log(y),i.Z.$emit(j,y),d.postMessage&&this.doPostMessage(y),this.actionNameList.push(j)}})},getBindMap(){if(typeof this.widgetInfo.action.gisMapId<"u"){let f=this.getWidgetObject(this.widgetInfo.action.gisMapId);if(f){clearInterval(this.timer);let s=f.$refs.gismap;s&&(v.log("\u83B7\u53D6map\u5BF9\u8C61\u6210\u529F\uFF0C\u56FE\u5C42\u76EE\u5F55\u7ED1\u5B9A\u5730\u56FE\uFF0C\u521D\u59CB\u5316\u56FE\u5C42\u64CD\u4F5C,\u5173\u95ED\u5B9A\u65F6\u5668"),this.map=s.map)}}},doConfigMap(f,s,M){let d=s[M];v.info("======tctocovt========="),v.info(f),v.info(d),this.map=d,v.info("==============="),this.$refs.toc.initLayerManager(this.map)},selectItem(f){f&&(this.currentItem=f,this.searchValue=f.name,this.visible=!1,this.isComeSelect=!0,this.locatByXY())},handleBlur(){this.visible=!1},locatByXY(){if(this.currentItem){const f=new x.ZP({image:new O.Z({anchor:[.5,.96],crossOrigin:"anonymous",src:c})}),s=t().gcj02towgs84(this.currentItem.location.lng,this.currentItem.location.lat);let M=new F.Z([s[0],s[1]]);const d=(0,T.get)("EPSG:4326");M.transform(d,this.map.getView().getProjection());const j=new E.Z(M);j.setStyle(f),j.tag="location";let y=this.map.getLayerById("drawLayer").getSource();const R=y.forEachFeature(H=>{H&&H.tag=="location"&&y.removeFeature(H)});y.addFeature(j),this.map.zoomTo([M.getCoordinates()[0],M.getCoordinates()[1]])}}}},w=g,S=a(768141),B=(0,S.Z)(w,h,b,!1,null,"6bc0fac5",null),z=B.exports}}]);
