"use strict";(self.webpackChunkdatavisual=self.webpackChunkdatavisual||[]).push([[20070],{56279:function(L,p,o){o.d(p,{P:function(){return a}});var c=o(386892),d=o(149500);const a={mixins:[c.D],created(){},methods:{lifecycleBeforeChartsLoad(m){if(this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.beforeChartsLoad&&this.widgetInfo.action.lifecycle.beforeChartsLoad.enabled){(!this.widgetInfo.action.lifecycle.beforeChartsLoad.script||!this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content||this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content=="")&&d.warn("\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C\u4E3A\u7A7A"),d.info("\u6267\u884C\u5E38\u89C4\u56FE\u8868["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u524D\u7684\u811A\u672C");let y=new Function("option",this.widgetInfo.action.lifecycle.beforeChartsLoad.script.content).apply(this,[m]);if(y)return y}return m},lifecycleAfterLoad(){this.widgetInfo.action&&this.widgetInfo.action.lifecycle&&this.widgetInfo.action.lifecycle.afterLoad&&this.widgetInfo.action.lifecycle.afterLoad.enabled&&((!this.widgetInfo.action.lifecycle.afterLoad.script||!this.widgetInfo.action.lifecycle.afterLoad.script.content||this.widgetInfo.action.lifecycle.afterLoad.script.content=="")&&d.warn("\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C\u4E3A\u7A7A"),d.info("\u6267\u884C\u7EC4\u4EF6["+this.widgetInfo.name+"]\u52A0\u8F7D\u4E4B\u540E\u7684\u811A\u672C"),new Function("",this.widgetInfo.action.lifecycle.afterLoad.script.content).apply(this,[]))}}}},752246:function(L,p,o){o.d(p,{X:function(){return c},b:function(){return d}});let c={versions:function(){var a=navigator.userAgent;return{trident:a.indexOf("Trident")>-1,presto:a.indexOf("Presto")>-1,webKit:a.indexOf("AppleWebKit")>-1,gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")==-1,mobile:!!a.match(/AppleWebKit.*Mobile.*/),ios:!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:a.indexOf("Android")>-1,iPhone:a.indexOf("iPhone")>-1,iPad:a.indexOf("iPad")>-1,webApp:a.indexOf("Safari")==-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},d;c.versions.mobile||c.versions.ios||c.versions.android||c.versions.iPhone||c.versions.iPad?d=!1:d=!0},620070:function(L,p,o){o.r(p),o.d(p,{default:function(){return R}});var c=function(){var i=this,e=i._self._c;return e("div",{style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}},[e("hide-button",{attrs:{attr:i.widgetInfo.attr}}),e("div",{ref:"sunburstsimple",style:{width:i.widgetInfo.attr.w+"px",height:i.widgetInfo.attr.hh+"px"}})],1)},d=[],a=o(844513),m=o(927966),I=o(558608),y=o(56279),A=o(445061),N=o(126711),x=o(99349),s=o(555616),b=o(275770),E=o(67157),w=o(150813),V=o(325251);const F={mixins:[E.c],data(){return{config_extend:{config:{series:{itemStyle:{borderColor:"#E09900"},label:{color:"#0F151D"}}}},filter_config:{title:JSON.parse(JSON.stringify(w.Z.charts.title)),legend:JSON.parse(JSON.stringify(w.Z.charts.legend)),tooltip:JSON.parse(JSON.stringify(w.Z.charts.tooltip)),toolbox:JSON.parse(JSON.stringify(w.Z.charts.toolbox)),color:["#4C84FF"],series:{itemStyle:{type:"pureColor",pureColor:"rgba(30, 144, 255, 1)",opacity:1,gradation:{},borderColor:"#EDEEF0"},label:{color:"#0F151D"},emphasis:{itemStyle:{colorInfo:{type:"pureColor",pureColor:"",gradation:{}},opacity:1}}}}}},methods:{filterPredefineColoursSchemeConfig(t,i){this.getNewConfigWithArrary(t,i,this.filter_config)}}};var T=o(149500);const $=o(954255);var z={name:"SunburstSimple",components:{HideButton:a.Z},mixins:[I.baseConfig,x.P,y.P,A.u,N.H,F],props:["widgetInfo"],data(){return{dimensionsEx:null,dimensionsAliasEx:null}},watch:{"widgetInfo.attr.hide":function(){this.$emit("attrChange",this.widgetInfo)}},mounted(){this.echarts=$.init(this.$refs.sunburstsimple,null,{devicePixelRatio:2}),this.initAction(this.widgetInfo),this.loadInfo(this.widgetInfo)},destroyed(){this.echarts.dispose()},methods:{loadInfo(t){let i=[],e=[],r=[],n=[],f=[];i=t.dataset[t.dataset.type].source,e=t.dataset[t.dataset.type].dimensions,r=t.dataset[t.dataset.type].dimensionsAlias,n=t.dataset[t.dataset.type].encode,f=t.dataset[t.dataset.type].encodeList.custom,this.dimensionsEx=e,this.dimensionsAliasEx=r;let g=-1,h=e.length;for(let u=0;u<h;u++)e[u]==n.x&&(g=u);let C=new Array(f.length);for(let u=0;u<f.length;u++)for(let O=0;O<h;O++)e[O]===f[u].model&&(C[u]=O);let S=this.createTree(i,C),H=this.iterator_self(S,[],g,h),J=JSON.parse(JSON.stringify(t.config.title)),K=JSON.parse(JSON.stringify(t.config.toolbox)),v=JSON.parse(JSON.stringify(t.config.grid)),l=JSON.parse(JSON.stringify(t.config.series)),B=JSON.parse(JSON.stringify(t.config.color));l.name||(l.name=this.getLegendData(r,n)),l.itemStyle&&l.itemStyle.colorInfo&&(l.itemStyle.color=this.getColorInfo(l.itemStyle.colorInfo)),l.emphasis.itemStyle&&l.emphasis.itemStyle.colorInfo&&(l.emphasis.itemStyle.color=this.getColorInfo(l.emphasis.itemStyle.colorInfo));let P={color:B,title:J,toolbox:K,grid:{left:v.left+"%",right:v.right+"%",top:v.top+"%",bottom:v.bottom+"%",dx:v.dx+"%",dy:v.dy+"%"},series:{radius:[l.radius.in+"%",l.radius.out+"%"],type:"sunburst",sort:l.sort,highlightPolicy:l.highlightPolicy,data:H,label:l.label,levels:[],itemStyle:l.itemStyle,emphasis:{label:l.emphasis.label,itemStyle:l.emphasis.itemStyle}}};this.getAnimation(P,t),this.setOption(P),this.setAnimationLoop(t,()=>{this.setOption(P,t)})},setOption(t){this.echarts.getOption()&&this.echarts.clear(),this.echarts.setOption(this.lifecycleBeforeChartsLoad(t),{notMerge:!0})},reLoadInfo(t){t&&(this.$refs.sunburstsimple.style.width=t.attr.w+"px",this.$refs.sunburstsimple.style.height=t.attr.hh+"px"),this.loadInfo(t),this.echarts.resize()},getLegendData(t,i){let e=this.$$lib__.find(t,r=>r.name==i.y);return e?e.alias&&e.alias!=""?e.alias:e.name:""},createTree(t,i){function e(r,n,f,g){for(let h=0;h<r.length;h++){if(g>=f.length)return(Array.isArray(n)?n:[]).concat(r[h]);let C=f[g],S=r[h][C],H=n[S]?n[S]:{};n[S]=e([r[h]],H,f,g+1)}return n}return e(t,{},i,0)},iterator_self(t,i,e,r){if(t.constructor!==Array)for(let n in t){let f=t[n].length/r,g={name:n,value:t[n].constructor===Array?parseFloat(this.addValue(t[n],e,f)):null,children:this.iterator_self(t[n],[],e,r),itemStyle:n?null:{color:"rgba(255, 255, 255, 0)"}};i.push(g)}return i},addValue(t,i,e){let r=0;for(let n=1;n<=e;n++)r+=t[(i+1)*n-1];return r},initAction(t){this.actionSendout(t),this.actionReceive(t)},actionSendout(t){let i=this;this.$$lib__.each(t.action.sendOut.actionList,e=>{if(e.enabled){let r=e.code+"_"+t.id;if(e.paramsExtend&&e.paramsExtend.length>0){let n={};this.getParamsExtend(n,e.paramsExtend,t)}e.code==b.default.click.code&&i.onClick(r,e)}})},onClick(t,i){let e=this;e.echarts.on("click",r=>{let n={},f=e.getValue(r.seriesName,r.data);if(n.x=r.name,n.y=f,i.script&&i.script.enabled){if(T.log("Execute script for "+e.widgetInfo.name+" component to "+i.name+" component"),i.script.content==""){s.Message.warning({message:i.name+"\u81EA\u5B9A\u4E49\u811A\u672C\u5DF2\u542F\u7528\uFF0C\u4F46\u672A\u7F16\u5199\u4EFB\u4F55\u811A\u672C",offset:60});return}this.customScript=new Function("param",i.script.content),n=this.customScript(n)}m.Z.$emit(t,n),i.postMessage&&e.doPostMessage(n),e.actionNameList.push(t)})}}},M=z,Z=o(768141),D=(0,Z.Z)(M,c,d,!1,null,"f63f0cee",null),R=D.exports},844513:function(L,p,o){o.d(p,{Z:function(){return N}});var c=function(){var s=this,b=s._self._c;return s.attr.buttonHide?b("div",{style:{position:"absolute",right:s.attr.buttonHideRight+"px",top:s.attr.buttonHideTop+"px",width:"30px",height:"25px",cursor:"pointer",zIndex:"9999"},on:{click:function(E){return s.onHide()}}},[s.openTooltip?b("el-tooltip",{attrs:{"open-delay":1e3,content:s.attr.buttonHideTooltipContent,effect:"dark",placement:"top"}},[b("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):b("el-button",{class:s.attr.buttonHideIconClass&&s.attr.buttonHideIconClass!=""?s.attr.buttonHideIconClass:"iconfont bi_eyeslash",staticStyle:{"margin-left":"6px",padding:"3px 0",width:"15px",height:"15px"},style:{color:s.attr.buttonHideColor,fontSize:s.attr.buttonHideIconFontSize+"px"},attrs:{size:"small",type:"text"}})],1):s._e()},d=[],a=o(752246),m={props:["attr"],name:"hide-button",data(){return{isPc:a.b}},computed:{openTooltip:function(){let x=!1,s=this.attr.buttonHideTooltipContent;return a.b&&s&&s!=null&&s.trim()!=""&&(x=!0),x}},methods:{onHide(){this.attr.hide=!0,this.$emit("sendButtonHide")}}},I=m,y=o(768141),A=(0,y.Z)(I,c,d,!1,null,"bf399b9a",null),N=A.exports}}]);
