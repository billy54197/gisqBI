(function(L,q){typeof exports=="object"&&typeof module<"u"?module.exports=q(require("global/window"),require("global/document")):typeof define=="function"&&define.amd?define(["global/window","global/document"],q):(L=L||self).videojs=q(L.window,L.document)})(this,function(L,q){L=L&&L.hasOwnProperty("default")?L.default:L,q=q&&q.hasOwnProperty("default")?q.default:q;var N="7.6.3",D=[],I=function(t,i){return function(r,e,n){var a=i.levels[e],s=new RegExp("^("+a+")$");if(r!=="log"&&n.unshift(r.toUpperCase()+":"),n.unshift(t+":"),D&&D.push([].concat(n)),L.console){var o=L.console[r];o||r!=="debug"||(o=L.console.info||L.console.log),o&&a&&s.test(r)&&o[Array.isArray(n)?"apply":"call"](L.console,n)}}},b=function t(i){var r,e="info",n=function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];r("log",e,s)};return r=I(i,n),n.createLogger=function(a){return t(i+": "+a)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:e},n.level=function(a){if(typeof a=="string"){if(!n.levels.hasOwnProperty(a))throw new Error('"'+a+'" in not a valid log level');e=a}return e},(n.history=function(){return D?[].concat(D):[]}).filter=function(a){return(D||[]).filter(function(s){return new RegExp(".*"+a+".*").test(s[0])})},n.history.clear=function(){D&&(D.length=0)},n.history.disable=function(){D!==null&&(D.length=0,D=null)},n.history.enable=function(){D===null&&(D=[])},n.error=function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return r("error",e,s)},n.warn=function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return r("warn",e,s)},n.debug=function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return r("debug",e,s)},n}("VIDEOJS"),_=b.createLogger,f=Object.prototype.toString,m=function(t){return S(t)?Object.keys(t):[]};function c(t,i){m(t).forEach(function(r){return i(t[r],r)})}function T(t){for(var i=arguments.length,r=new Array(i>1?i-1:0),e=1;e<i;e++)r[e-1]=arguments[e];return Object.assign?Object.assign.apply(Object,[t].concat(r)):(r.forEach(function(n){n&&c(n,function(a,s){t[s]=a})}),t)}function S(t){return!!t&&typeof t=="object"}function w(t){return S(t)&&f.call(t)==="[object Object]"&&t.constructor===Object}function g(t,i){if(!t||!i)return"";if(typeof L.getComputedStyle=="function"){var r=L.getComputedStyle(t);return r?r.getPropertyValue(i)||r[i]:""}return""}function d(t){return typeof t=="string"&&/\S/.test(t)}function l(t){if(/\s/.test(t))throw new Error("class has illegal whitespace characters")}function p(){return q===L.document}function y(t){return S(t)&&t.nodeType===1}function A(){try{return L.parent!==L.self}catch{return!0}}function P(t){return function(i,r){if(!d(i))return q[t](null);d(r)&&(r=q.querySelector(r));var e=y(r)?r:q;return e[t]&&e[t](i)}}function U(t,i,r,e){t===void 0&&(t="div"),i===void 0&&(i={}),r===void 0&&(r={});var n=q.createElement(t);return Object.getOwnPropertyNames(i).forEach(function(a){var s=i[a];a.indexOf("aria-")!==-1||a==="role"||a==="type"?(b.warn(`Setting attributes in the second argument of createEl()
has been deprecated. Use the third argument instead.
createEl(type, properties, attributes). Attempting to set `+a+" to "+s+"."),n.setAttribute(a,s)):a==="textContent"?O(n,s):n[a]=s}),Object.getOwnPropertyNames(r).forEach(function(a){n.setAttribute(a,r[a])}),e&&ct(n,e),n}function O(t,i){return t.textContent===void 0?t.innerText=i:t.textContent=i,t}function V(t,i){i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t)}function z(t,i){return l(i),t.classList?t.classList.contains(i):(r=i,new RegExp("(^|\\s)"+r+"($|\\s)")).test(t.className);var r}function Z(t,i){return t&&(t.classList?t.classList.add(i):z(t,i)||(t.className=(t.className+" "+i).trim()),t)}function te(t,i){return t&&(t.classList?t.classList.remove(i):(l(i),t.className=t.className.split(/\s+/).filter(function(r){return r!==i}).join(" ")),t)}function se(t,i,r){var e=z(t,i);return typeof r=="function"&&(r=r(t,i)),typeof r!="boolean"&&(r=!e),r===e||(r?Z(t,i):te(t,i)),t}function ue(t,i){Object.getOwnPropertyNames(i).forEach(function(r){var e=i[r];e==null||e===!1?t.removeAttribute(r):t.setAttribute(r,e===!0?"":e)})}function de(t){var i={},r=",autoplay,stretch,fluent,controls,playsinline,loop,muted,default,defaultMuted,";if(t&&t.attributes&&t.attributes.length>0)for(var e=t.attributes,n=e.length-1;n>=0;n--){var a=e[n].name,s=e[n].value;typeof t[a]!="boolean"&&r.indexOf(","+a+",")===-1||(s=s!==null),i[a]=s}return i}function ke(t,i){return t.getAttribute(i)}function Te(t,i,r){t.setAttribute(i,r)}function he(t,i){t.removeAttribute(i)}function Ne(){q.body.focus(),q.onselectstart=function(){return!1}}function ve(){q.onselectstart=function(){return!0}}function Fe(t){if(t&&t.getBoundingClientRect&&t.parentNode){var i=t.getBoundingClientRect(),r={};return["bottom","height","left","right","top","width"].forEach(function(e){i[e]!==void 0&&(r[e]=i[e])}),r.height||(r.height=parseFloat(g(t,"height"))),r.width||(r.width=parseFloat(g(t,"width"))),r}}function Oe(t){var i;if(t.getBoundingClientRect&&t.parentNode&&(i=t.getBoundingClientRect()),!i)return{left:0,top:0};var r=q.documentElement,e=q.body,n=r.clientLeft||e.clientLeft||0,a=L.pageXOffset||e.scrollLeft,s=i.left+a-n,o=r.clientTop||e.clientTop||0,u=L.pageYOffset||e.scrollTop,v=i.top+u-o;return{left:Math.round(s),top:Math.round(v)}}function Ve(t,i){var r={},e=Oe(t),n=t.offsetWidth,a=t.offsetHeight,s=e.top,o=e.left,u=i.pageY,v=i.pageX;return i.changedTouches&&(v=i.changedTouches[0].pageX,u=i.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(s-u+a)/a)),r.x=Math.max(0,Math.min(1,(v-o)/n)),r}function Ce(t){return S(t)&&t.nodeType===3}function ze(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function tt(t){return typeof t=="function"&&(t=t()),(Array.isArray(t)?t:[t]).map(function(i){return typeof i=="function"&&(i=i()),y(i)||Ce(i)?i:typeof i=="string"&&/\S/.test(i)?q.createTextNode(i):void 0}).filter(function(i){return i})}function ct(t,i){return tt(i).forEach(function(r){return t.appendChild(r)}),t}function Ge(t,i){return ct(ze(t),i)}function He(t){return t.button===void 0&&t.buttons===void 0||t.button===0&&t.buttons===void 0||t.type==="mouseup"&&t.button===0&&t.buttons===0||t.button===0&&t.buttons===1}var rt=P("querySelector"),De=P("querySelectorAll"),re=Object.freeze({isReal:p,isEl:y,isInFrame:A,createEl:U,textContent:O,prependTo:V,hasClass:z,addClass:Z,removeClass:te,toggleClass:se,setAttributes:ue,getAttributes:de,getAttribute:ke,setAttribute:Te,removeAttribute:he,blockTextSelection:Ne,unblockTextSelection:ve,getBoundingClientRect:Fe,findPosition:Oe,getPointerPosition:Ve,isTextNode:Ce,emptyEl:ze,normalizeContent:tt,appendContent:ct,insertContent:Ge,isSingleLeftClick:He,$:rt,$$:De}),ae=new WeakMap,be=1;function _e(){return be++}function Pe(t,i){if(ae.has(t)){var r=ae.get(t);r.handlers[i].length===0&&(delete r.handlers[i],t.removeEventListener?t.removeEventListener(i,r.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+i,r.dispatcher)),Object.getOwnPropertyNames(r.handlers).length<=0&&(delete r.handlers,delete r.dispatcher,delete r.disabled),Object.getOwnPropertyNames(r).length===0&&ae.delete(t)}}function we(t,i,r,e){r.forEach(function(n){t(i,n,e)})}function Je(t){function i(){return!0}function r(){return!1}if(!t||!t.isPropagationStopped){var e=t||L.event;for(var n in t={},e)n!=="layerX"&&n!=="layerY"&&n!=="keyLocation"&&n!=="webkitMovementX"&&n!=="webkitMovementY"&&(n==="returnValue"&&e.preventDefault||(t[n]=e[n]));if(t.target||(t.target=t.srcElement||q),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){e.preventDefault&&e.preventDefault(),t.returnValue=!1,e.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){e.stopPropagation&&e.stopPropagation(),t.cancelBubble=!0,e.cancelBubble=!0,t.isPropagationStopped=i},t.isPropagationStopped=r,t.stopImmediatePropagation=function(){e.stopImmediatePropagation&&e.stopImmediatePropagation(),t.isImmediatePropagationStopped=i,t.stopPropagation()},t.isImmediatePropagationStopped=r,t.clientX!==null&&t.clientX!==void 0){var a=q.documentElement,s=q.body;t.pageX=t.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&s.clientLeft||0),t.pageY=t.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&s.clientTop||0)}t.which=t.charCode||t.keyCode,t.button!==null&&t.button!==void 0&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t}var st=!1;(function(){try{var t=Object.defineProperty({},"passive",{get:function(){st=!0}});L.addEventListener("test",null,t),L.removeEventListener("test",null,t)}catch{}})();var wt=["touchstart","touchmove"];function Xe(t,i,r){if(Array.isArray(i))return we(Xe,t,i,r);ae.has(t)||ae.set(t,{});var e=ae.get(t);if(e.handlers||(e.handlers={}),e.handlers[i]||(e.handlers[i]=[]),r.guid||(r.guid=_e()),e.handlers[i].push(r),e.dispatcher||(e.disabled=!1,e.dispatcher=function(a,s){if(!e.disabled){a=Je(a);var o=e.handlers[a.type];if(o)for(var u=o.slice(0),v=0,C=u.length;v<C&&!a.isImmediatePropagationStopped();v++)try{u[v].call(t,a,s)}catch(k){b.error(k)}}}),e.handlers[i].length===1)if(t.addEventListener){var n=!1;st&&wt.indexOf(i)>-1&&(n={passive:!0}),t.addEventListener(i,e.dispatcher,n)}else t.attachEvent&&t.attachEvent("on"+i,e.dispatcher)}function qe(t,i,r){if(ae.has(t)){var e=ae.get(t);if(e.handlers){if(Array.isArray(i))return we(qe,t,i,r);var n=function(u,v){e.handlers[v]=[],Pe(u,v)};if(i!==void 0){var a=e.handlers[i];if(a)if(r){if(r.guid)for(var s=0;s<a.length;s++)a[s].guid===r.guid&&a.splice(s--,1);Pe(t,i)}else n(t,i)}else for(var o in e.handlers)Object.prototype.hasOwnProperty.call(e.handlers||{},o)&&n(t,o)}}}function ot(t,i,r){var e=ae.has(t)?ae.get(t):{},n=t.parentNode||t.ownerDocument;if(typeof i=="string"?i={type:i,target:t}:i.target||(i.target=t),i=Je(i),e.dispatcher&&e.dispatcher.call(t,i,r),n&&!i.isPropagationStopped()&&i.bubbles===!0)ot.call(null,n,i,r);else if(!n&&!i.defaultPrevented&&i.target&&i.target[i.type]){ae.has(i.target)||ae.set(i.target,{});var a=ae.get(i.target);i.target[i.type]&&(a.disabled=!0,typeof i.target[i.type]=="function"&&i.target[i.type](),a.disabled=!1)}return!i.defaultPrevented}function ir(t,i,r){if(Array.isArray(i))return we(ir,t,i,r);var e=function n(){qe(t,i,n),r.apply(this,arguments)};e.guid=r.guid=r.guid||_e(),Xe(t,i,e)}function _r(t,i,r){var e=function n(){qe(t,i,n),r.apply(this,arguments)};e.guid=r.guid=r.guid||_e(),Xe(t,i,e)}var xn,Cd=Object.freeze({fixEvent:Je,on:Xe,off:qe,trigger:ot,one:ir,any:_r}),Dn=!1,wd=function(){if(p()&&xn.options.autoSetup!==!1){var t=Array.prototype.slice.call(q.getElementsByTagName("video")),i=Array.prototype.slice.call(q.getElementsByTagName("audio")),r=Array.prototype.slice.call(q.getElementsByTagName("video-js")),e=t.concat(i,r);if(e&&e.length>0)for(var n=0,a=e.length;n<a;n++){var s=e[n];if(!s||!s.getAttribute){Mn(1);break}s.player===void 0&&s.getAttribute("data-setup")!==null&&xn(s)}else Dn||Mn(1)}};function Mn(t,i){i&&(xn=i),L.setTimeout(wd,t)}p()&&q.readyState==="complete"?Dn=!0:ir(L,"load",function(){Dn=!0});var ni,Qs=function(t){var i=q.createElement("style");return i.className=t,i},Zs=function(t,i){t.styleSheet?t.styleSheet.cssText=i:t.textContent=i},br=30,je=function(t,i,r){i.guid||(i.guid=_e());var e=i.bind(t);return e.guid=r?r+"_"+i.guid:i.guid,e},ur=function(t,i){var r=L.performance.now();return function(){var e=L.performance.now();e-r>=i&&(t.apply(void 0,arguments),r=e)}},Pd=function(t,i,r,e){var n;e===void 0&&(e=L);var a=function(){var s=this,o=arguments,u=function(){n=null,u=null,r||t.apply(s,o)};!n&&r&&t.apply(s,o),e.clearTimeout(n),n=e.setTimeout(u,i)};return a.cancel=function(){e.clearTimeout(n),n=null},a},ht=function(){};ht.prototype.allowedEvents_={},ht.prototype.on=function(t,i){var r=this.addEventListener;this.addEventListener=function(){},Xe(this,t,i),this.addEventListener=r},ht.prototype.addEventListener=ht.prototype.on,ht.prototype.off=function(t,i){qe(this,t,i)},ht.prototype.removeEventListener=ht.prototype.off,ht.prototype.one=function(t,i){var r=this.addEventListener;this.addEventListener=function(){},ir(this,t,i),this.addEventListener=r},ht.prototype.any=function(t,i){var r=this.addEventListener;this.addEventListener=function(){},_r(this,t,i),this.addEventListener=r},ht.prototype.trigger=function(t){var i=t.type||t;typeof t=="string"&&(t={type:i}),t=Je(t),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](t),ot(this,t)},ht.prototype.dispatchEvent=ht.prototype.trigger,ht.prototype.queueTrigger=function(t){var i=this;ni||(ni=new Map);var r=t.type||t,e=ni.get(this);e||(e=new Map,ni.set(this,e));var n=e.get(r);e.delete(r),L.clearTimeout(n);var a=L.setTimeout(function(){e.size===0&&(e=null,ni.delete(i)),i.trigger(t)},0);e.set(r,a)};var Tr=function(t){return t instanceof ht||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(i){return typeof t[i]=="function"})},eo=function(t){return typeof t=="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length},Un=function(t){if(!t.nodeName&&!Tr(t))throw new Error("Invalid target; must be a DOM node or evented object.")},to=function(t){if(!eo(t))throw new Error("Invalid event type; must be a non-empty string or array.")},ro=function(t){if(typeof t!="function")throw new Error("Invalid listener; must be a function.")},jn=function(t,i){var r,e,n,a=i.length<3||i[0]===t||i[0]===t.eventBusEl_;return a?(r=t.eventBusEl_,i.length>=3&&i.shift(),e=i[0],n=i[1]):(r=i[0],e=i[1],n=i[2]),Un(r),to(e),ro(n),{isTargetingSelf:a,target:r,type:e,listener:n=je(t,n)}},Sr=function(t,i,r,e){Un(t),t.nodeName?Cd[i](t,r,e):t[i](r,e)},Ad={on:function(){for(var t=this,i=arguments.length,r=new Array(i),e=0;e<i;e++)r[e]=arguments[e];var n=jn(this,r),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(Sr(s,"on",o,u),!a){var v=function(){return t.off(s,o,u)};v.guid=u.guid;var C=function(){return t.off("dispose",v)};C.guid=u.guid,Sr(this,"on","dispose",v),Sr(s,"on","dispose",C)}},one:function(){for(var t=this,i=arguments.length,r=new Array(i),e=0;e<i;e++)r[e]=arguments[e];var n=jn(this,r),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)Sr(s,"one",o,u);else{var v=function C(){t.off(s,o,C);for(var k=arguments.length,M=new Array(k),j=0;j<k;j++)M[j]=arguments[j];u.apply(null,M)};v.guid=u.guid,Sr(s,"one",o,v)}},any:function(){for(var t=this,i=arguments.length,r=new Array(i),e=0;e<i;e++)r[e]=arguments[e];var n=jn(this,r),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)Sr(s,"any",o,u);else{var v=function C(){t.off(s,o,C);for(var k=arguments.length,M=new Array(k),j=0;j<k;j++)M[j]=arguments[j];u.apply(null,M)};v.guid=u.guid,Sr(s,"any",o,v)}},off:function(t,i,r){if(!t||eo(t))qe(this.eventBusEl_,t,i);else{var e=t,n=i;Un(e),to(n),ro(r),r=je(this,r),this.off("dispose",r),e.nodeName?(qe(e,n,r),qe(e,"dispose",r)):Tr(e)&&(e.off(n,r),e.off("dispose",r))}},trigger:function(t,i){return ot(this.eventBusEl_,t,i)}};function Bn(t,i){i===void 0&&(i={});var r=i.eventBusKey;if(r){if(!t[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');t.eventBusEl_=t[r]}else t.eventBusEl_=U("span",{className:"vjs-event-bus"});return T(t,Ad),t.eventedCallbacks&&t.eventedCallbacks.forEach(function(e){e()}),t.on("dispose",function(){t.off(),L.setTimeout(function(){t.eventBusEl_=null},0)}),t}var Rd={state:{},setState:function(t){var i,r=this;return typeof t=="function"&&(t=t()),c(t,function(e,n){r.state[n]!==e&&((i=i||{})[n]={from:r.state[n],to:e}),r.state[n]=e}),i&&Tr(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function io(t,i){return T(t,Rd),t.state=T({},t.state,i),typeof t.handleStateChanged=="function"&&Tr(t)&&t.on("statechanged",t.handleStateChanged),t}var Ii=function(t){return typeof t!="string"?t:t.replace(/./,function(i){return i.toLowerCase()})},ut=function(t){return typeof t!="string"?t:t.replace(/./,function(i){return i.toUpperCase()})};function Qe(){for(var t={},i=arguments.length,r=new Array(i),e=0;e<i;e++)r[e]=arguments[e];return r.forEach(function(n){n&&c(n,function(a,s){w(a)?(w(t[s])||(t[s]={}),t[s]=Qe(t[s],a)):t[s]=a})}),t}var oe=function(){function t(r,e,n){if(!r&&this.play?this.player_=r=this:this.player_=r,this.parentComponent_=null,this.options_=Qe({},this.options_),e=this.options_=Qe(this.options_,e),this.id_=e.id||e.el&&e.el.id,!this.id_){var a=r&&r.id&&r.id()||"no_player";this.id_=a+"_component_"+_e()}this.name_=e.name||null,e.el?this.el_=e.el:e.createEl!==!1&&(this.el_=this.createEl()),e.evented!==!1&&Bn(this,{eventBusKey:this.el_?"el_":null}),io(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.clearingTimersOnDispose_=!1,e.initChildren!==!1&&this.initChildren(),this.ready(n),e.reportTouchActivity!==!1&&this.enableTouchActivity()}var i=t.prototype;return i.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var r=this.children_.length-1;r>=0;r--)this.children_[r].dispose&&this.children_[r].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),ae.has(this.el_)&&ae.delete(this.el_),this.el_=null),this.player_=null},i.player=function(){return this.player_},i.options=function(r){return r?(this.options_=Qe(this.options_,r),this.options_):this.options_},i.el=function(){return this.el_},i.createEl=function(r,e,n){return U(r,e,n)},i.localize=function(r,e,n){n===void 0&&(n=r);var a=this.player_.language&&this.player_.language(),s=this.player_.languages&&this.player_.languages(),o=s&&s[a],u=a&&a.split("-")[0],v=s&&s[u],C=n;return o&&o[r]?C=o[r]:v&&v[r]&&(C=v[r]),e&&(C=C.replace(/\{(\d+)\}/g,function(k,M){var j=e[M-1],G=j;return j===void 0&&(G=k),G})),C},i.contentEl=function(){return this.contentEl_||this.el_},i.id=function(){return this.id_},i.name=function(){return this.name_},i.children=function(){return this.children_},i.getChildById=function(r){return this.childIndex_[r]},i.getChild=function(r){if(r)return this.childNameIndex_[r]},i.addChild=function(r,e,n){var a,s;if(e===void 0&&(e={}),n===void 0&&(n=this.children_.length),typeof r=="string"){s=ut(r);var o=e.componentClass||s;e.name=s;var u=t.getComponent(o);if(!u)throw new Error("Component "+o+" does not exist");if(typeof u!="function")return null;a=new u(this.player_||this,e)}else a=r;if(a.parentComponent_&&a.parentComponent_.removeChild(a),this.children_.splice(n,0,a),a.parentComponent_=this,typeof a.id=="function"&&(this.childIndex_[a.id()]=a),(s=s||a.name&&ut(a.name()))&&(this.childNameIndex_[s]=a,this.childNameIndex_[Ii(s)]=a),typeof a.el=="function"&&a.el()){var v=this.contentEl().children[n]||null;this.contentEl().insertBefore(a.el(),v)}return a},i.removeChild=function(r){if(typeof r=="string"&&(r=this.getChild(r)),r&&this.children_){for(var e=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===r){e=!0,this.children_.splice(n,1);break}if(e){r.parentComponent_=null,this.childIndex_[r.id()]=null,this.childNameIndex_[ut(r.name())]=null,this.childNameIndex_[Ii(r.name())]=null;var a=r.el();a&&a.parentNode===this.contentEl()&&this.contentEl().removeChild(r.el())}}},i.initChildren=function(){var r=this,e=this.options_.children;if(e){var n,a=this.options_,s=t.getComponent("Tech");(n=Array.isArray(e)?e:Object.keys(e)).concat(Object.keys(this.options_).filter(function(o){return!n.some(function(u){return typeof u=="string"?o===u:o===u.name})})).map(function(o){var u,v;return typeof o=="string"?v=e[u=o]||r.options_[u]||{}:(u=o.name,v=o),{name:u,opts:v}}).filter(function(o){var u=t.getComponent(o.opts.componentClass||ut(o.name));return u&&!s.isTech(u)}).forEach(function(o){var u=o.name,v=o.opts;if(a[u]!==void 0&&(v=a[u]),v!==!1){v===!0&&(v={}),v.playerOptions=r.options_.playerOptions;var C=r.addChild(u,v);C&&(r[u]=C)}})}},i.buildCSSClass=function(){return""},i.ready=function(r,e){if(e===void 0&&(e=!1),r)return this.isReady_?void(e?r.call(this):this.setTimeout(r,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(r))},i.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var r=this.readyQueue_;this.readyQueue_=[],r&&r.length>0&&r.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},i.$=function(r,e){return rt(r,e||this.contentEl())},i.$$=function(r,e){return De(r,e||this.contentEl())},i.hasClass=function(r){return z(this.el_,r)},i.addClass=function(r){Z(this.el_,r)},i.removeClass=function(r){te(this.el_,r)},i.toggleClass=function(r,e){se(this.el_,r,e)},i.show=function(){this.removeClass("vjs-hidden")},i.hide=function(){this.addClass("vjs-hidden")},i.lockShowing=function(){this.addClass("vjs-lock-showing")},i.unlockShowing=function(){this.removeClass("vjs-lock-showing")},i.getAttribute=function(r){return ke(this.el_,r)},i.setAttribute=function(r,e){Te(this.el_,r,e)},i.removeAttribute=function(r){he(this.el_,r)},i.width=function(r,e){return this.dimension("width",r,e)},i.height=function(r,e){return this.dimension("height",r,e)},i.dimensions=function(r,e){this.width(r,!0),this.height(e)},i.dimension=function(r,e,n){if(e!==void 0)return e!==null&&e==e||(e=0),(""+e).indexOf("%")!==-1||(""+e).indexOf("px")!==-1?this.el_.style[r]=e:this.el_.style[r]=e==="auto"?"":e+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var a=this.el_.style[r],s=a.indexOf("px");return parseInt(s!==-1?a.slice(0,s):this.el_["offset"+ut(r)],10)},i.currentDimension=function(r){var e=0;if(r!=="width"&&r!=="height")throw new Error("currentDimension only accepts width or height value");if(e=g(this.el_,r),(e=parseFloat(e))===0||isNaN(e)){var n="offset"+ut(r);e=this.el_[n]}return e},i.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},i.currentWidth=function(){return this.currentDimension("width")},i.currentHeight=function(){return this.currentDimension("height")},i.focus=function(){this.el_.focus()},i.blur=function(){this.el_.blur()},i.handleKeyDown=function(r){this.player_&&(r.stopPropagation(),this.player_.handleKeyDown(r))},i.handleKeyPress=function(r){this.handleKeyDown(r)},i.emitTapEvents=function(){var r,e=0,n=null;this.on("touchstart",function(s){s.touches.length===1&&(n={pageX:s.touches[0].pageX,pageY:s.touches[0].pageY},e=L.performance.now(),r=!0)}),this.on("touchmove",function(s){if(s.touches.length>1)r=!1;else if(n){var o=s.touches[0].pageX-n.pageX,u=s.touches[0].pageY-n.pageY;Math.sqrt(o*o+u*u)>10&&(r=!1)}});var a=function(){r=!1};this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",function(s){n=null,r===!0&&L.performance.now()-e<200&&(s.preventDefault(),this.trigger("tap"))})},i.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var r,e=je(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){e(),this.clearInterval(r),r=this.setInterval(e,250)});var n=function(a){e(),this.clearInterval(r)};this.on("touchmove",e),this.on("touchend",n),this.on("touchcancel",n)}},i.setTimeout=function(r,e){var n,a=this;return r=je(this,r),this.clearTimersOnDispose_(),n=L.setTimeout(function(){a.setTimeoutIds_.has(n)&&a.setTimeoutIds_.delete(n),r()},e),this.setTimeoutIds_.add(n),n},i.clearTimeout=function(r){return this.setTimeoutIds_.has(r)&&(this.setTimeoutIds_.delete(r),L.clearTimeout(r)),r},i.setInterval=function(r,e){r=je(this,r),this.clearTimersOnDispose_();var n=L.setInterval(r,e);return this.setIntervalIds_.add(n),n},i.clearInterval=function(r){return this.setIntervalIds_.has(r)&&(this.setIntervalIds_.delete(r),L.clearInterval(r)),r},i.requestAnimationFrame=function(r){var e,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),r=je(this,r),e=L.requestAnimationFrame(function(){n.rafIds_.has(e)&&n.rafIds_.delete(e),r()}),this.rafIds_.add(e),e):this.setTimeout(r,1e3/60)},i.cancelAnimationFrame=function(r){return this.supportsRaf_?(this.rafIds_.has(r)&&(this.rafIds_.delete(r),L.cancelAnimationFrame(r)),r):this.clearTimeout(r)},i.clearTimersOnDispose_=function(){var r=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(e){var n=e[0],a=e[1];r[n].forEach(r[a],r)}),r.clearingTimersOnDispose_=!1}))},t.registerComponent=function(r,e){if(typeof r!="string"||!r)throw new Error('Illegal component name, "'+r+'"; must be a non-empty string.');var n,a=t.getComponent("Tech"),s=a&&a.isTech(e),o=t===e||t.prototype.isPrototypeOf(e.prototype);if(s||!o)throw n=s?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+r+'"; '+n+".");r=ut(r),t.components_||(t.components_={});var u=t.getComponent("Player");if(r==="Player"&&u&&u.players){var v=u.players,C=Object.keys(v);if(v&&C.length>0&&C.map(function(k){return v[k]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[r]=e,t.components_[Ii(r)]=e,e},t.getComponent=function(r){if(r&&t.components_)return t.components_[r]},t}();function ye(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i}function no(t,i){return(no=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r})(t,i)}function ao(t,i,r){return(ao=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}()?Reflect.construct:function(e,n,a){var s=[null];s.push.apply(s,n);var o=new(Function.bind.apply(e,s));return a&&no(o,a.prototype),o}).apply(null,arguments)}function Me(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}oe.prototype.supportsRaf_=typeof L.requestAnimationFrame=="function"&&typeof L.cancelAnimationFrame=="function",oe.registerComponent("Component",oe);var Nn,gt=L.navigator&&L.navigator.userAgent||"",so=/AppleWebKit\/([\d.]+)/i.exec(gt),Ld=so?parseFloat(so.pop()):null,Fn=/iPad/i.test(gt),Vn=/iPhone/i.test(gt)&&!Fn,oo=/iPod/i.test(gt),Kt=Vn||Fn||oo,Od=(Nn=gt.match(/OS (\d+)_/i))&&Nn[1]?Nn[1]:null,lr=/Android/i.test(gt),Gn=function(){var t=gt.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!t)return null;var i=t[1]&&parseFloat(t[1]),r=t[2]&&parseFloat(t[2]);return i&&r?parseFloat(t[1]+"."+t[2]):i||null}(),uo=lr&&Gn<5&&Ld<537,lo=/Firefox/i.test(gt),Hn=/Edge/i.test(gt),sr=!Hn&&(/Chrome/i.test(gt)||/CriOS/i.test(gt)),co=function(){var t=gt.match(/(Chrome|CriOS)\/(\d+)/);return t&&t[2]?parseFloat(t[2]):null}(),zn=function(){var t=/MSIE\s(\d+)\.\d/.exec(gt),i=t&&parseFloat(t[1]);return!i&&/Trident\/7.0/i.test(gt)&&/rv:11.0/.test(gt)&&(i=11),i}(),ho=/Safari/i.test(gt)&&!sr&&!lr&&!Hn,qn=(ho||Kt)&&!sr,fo=/Windows/i.test(gt),ai=p()&&("ontouchstart"in L||L.navigator.maxTouchPoints||L.DocumentTouch&&L.document instanceof L.DocumentTouch),Id=Object.freeze({IS_IPAD:Fn,IS_IPHONE:Vn,IS_IPOD:oo,IS_IOS:Kt,IOS_VERSION:Od,IS_ANDROID:lr,ANDROID_VERSION:Gn,IS_NATIVE_ANDROID:uo,IS_FIREFOX:lo,IS_EDGE:Hn,IS_CHROME:sr,CHROME_VERSION:co,IE_VERSION:zn,IS_SAFARI:ho,IS_ANY_SAFARI:qn,IS_WINDOWS:fo,TOUCH_ENABLED:ai});function po(t,i,r,e){return function(n,a,s){if(typeof a!="number"||a<0||a>s)throw new Error("Failed to execute '"+n+"' on 'TimeRanges': The index provided ("+a+") is non-numeric or out of bounds (0-"+s+").")}(t,e,r.length-1),r[e][i]}function Wn(t){return t===void 0||t.length===0?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:t.length,start:po.bind(null,"start",0,t),end:po.bind(null,"end",1,t)}}function kr(t,i){return Array.isArray(t)?Wn(t):t===void 0||i===void 0?Wn():Wn([[t,i]])}function mo(t,i){var r,e,n=0;if(!i)return 0;t&&t.length||(t=kr(0,0));for(var a=0;a<t.length;a++)r=t.start(a),(e=t.end(a))>i&&(e=i),n+=e-r;return n/i}for(var si,Kn={prefixed:!0},xi=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],go=xi[0],Di=0;Di<xi.length;Di++)if(xi[Di][1]in q){si=xi[Di];break}if(si){for(var Mi=0;Mi<si.length;Mi++)Kn[go[Mi]]=si[Mi];Kn.prefixed=si[0]!==go[0]}function bt(t){if(t instanceof bt)return t;typeof t=="number"?this.code=t:typeof t=="string"?this.message=t:S(t)&&(typeof t.code=="number"&&(this.code=t.code),T(this,t)),this.message||(this.message=bt.defaultMessages[this.code]||"")}bt.prototype.code=0,bt.prototype.message="",bt.prototype.status=null,bt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],bt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Nr=0;Nr<bt.errorTypes.length;Nr++)bt[bt.errorTypes[Nr]]=Nr,bt.prototype[bt.errorTypes[Nr]]=Nr;var xd=function(t,i){var r,e=null;try{r=JSON.parse(t,i)}catch(n){e=n}return[e,r]};function oi(t){return t!=null&&typeof t.then=="function"}function Er(t){oi(t)&&t.then(null,function(i){})}var vo=function(t){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(i,r,e){return t[r]&&(i[r]=t[r]),i},{cues:t.cues&&Array.prototype.map.call(t.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})})},Dd=function(t){var i=t.$$("track"),r=Array.prototype.map.call(i,function(e){return e.track});return Array.prototype.map.call(i,function(e){var n=vo(e.track);return e.src&&(n.src=e.src),n}).concat(Array.prototype.filter.call(t.textTracks(),function(e){return r.indexOf(e)===-1}).map(vo))},Md=function(t,i){return t.forEach(function(r){var e=i.addRemoteTextTrack(r).track;!r.src&&r.cues&&r.cues.forEach(function(n){return e.addCue(n)})}),i.textTracks()};function $n(t,i){return t(i={exports:{}},i.exports),i.exports}var Re=$n(function(t,i){function r(u){if(u&&typeof u=="object"){var v=u.which||u.keyCode||u.charCode;v&&(u=v)}if(typeof u=="number")return s[u];var C,k=String(u);return(C=e[k.toLowerCase()])?C:(C=n[k.toLowerCase()])||(k.length===1?k.charCodeAt(0):void 0)}r.isEventKey=function(u,v){if(u&&typeof u=="object"){var C=u.which||u.keyCode||u.charCode;if(C==null)return!1;if(typeof v=="string"){var k;if((k=e[v.toLowerCase()])||(k=n[v.toLowerCase()]))return k===C}else if(typeof v=="number")return v===C;return!1}};var e=(i=t.exports=r).code=i.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},n=i.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)e[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)e[a-48]=a;for(a=1;a<13;a++)e["f"+a]=a+111;for(a=0;a<10;a++)e["numpad "+a]=a+96;var s=i.names=i.title={};for(a in e)s[e[a]]=a;for(var o in n)e[o]=n[o]}),Xn=(Re.code,Re.codes,Re.aliases,Re.names,Re.title,"vjs-modal-dialog"),Fr=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).opened_=a.hasBeenOpened_=a.hasBeenFilled_=!1,a.closeable(!a.options_.uncloseable),a.content(a.options_.content),a.contentEl_=U("div",{className:Xn+"-content"},{role:"document"}),a.descEl_=U("p",{className:Xn+"-description vjs-control-text",id:a.el().getAttribute("aria-describedby")}),O(a.descEl_,a.description()),a.el_.appendChild(a.descEl_),a.el_.appendChild(a.contentEl_),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},r.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,t.prototype.dispose.call(this)},r.buildCSSClass=function(){return Xn+" vjs-hidden "+t.prototype.buildCSSClass.call(this)},r.label=function(){return this.localize(this.options_.label||"Modal Window")},r.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},r.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},r.opened=function(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_},r.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},r.closeable=function(e){if(typeof e=="boolean"){var n=this.closeable_=!!e,a=this.getChild("closeButton");if(n&&!a){var s=this.contentEl_;this.contentEl_=this.el_,a=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=s,this.on(a,"close",this.close)}!n&&a&&(this.off(a,"close",this.close),this.removeChild(a),a.dispose())}return this.closeable_},r.fill=function(){this.fillWith(this.content())},r.fillWith=function(e){var n=this.contentEl(),a=n.parentNode,s=n.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,a.removeChild(n),this.empty(),Ge(n,e),this.trigger("modalfill"),s?a.insertBefore(n,s):a.appendChild(n);var o=this.getChild("closeButton");o&&a.appendChild(o.el_)},r.empty=function(){this.trigger("beforemodalempty"),ze(this.contentEl()),this.trigger("modalempty")},r.content=function(e){return e!==void 0&&(this.content_=e),this.content_},r.conditionalFocus_=function(){var e=q.activeElement,n=this.player_.el_;this.previouslyActiveEl_=null,(n.contains(e)||n===e)&&(this.previouslyActiveEl_=e,this.focus())},r.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},r.handleKeyDown=function(e){if(e.stopPropagation(),Re.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(Re.isEventKey(e,"Tab")){for(var n,a=this.focusableEls_(),s=this.el_.querySelector(":focus"),o=0;o<a.length;o++)if(s===a[o]){n=o;break}q.activeElement===this.el_&&(n=0),e.shiftKey&&n===0?(a[a.length-1].focus(),e.preventDefault()):e.shiftKey||n!==a.length-1||(a[0].focus(),e.preventDefault())}},r.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(n){return(n instanceof L.HTMLAnchorElement||n instanceof L.HTMLAreaElement)&&n.hasAttribute("href")||(n instanceof L.HTMLInputElement||n instanceof L.HTMLSelectElement||n instanceof L.HTMLTextAreaElement||n instanceof L.HTMLButtonElement)&&!n.hasAttribute("disabled")||n instanceof L.HTMLIFrameElement||n instanceof L.HTMLObjectElement||n instanceof L.HTMLEmbedElement||n.hasAttribute("tabindex")&&n.getAttribute("tabindex")!==-1||n.hasAttribute("contenteditable")})},i}(oe);Fr.prototype.options_={pauseOnOpen:!0,temporary:!0},oe.registerComponent("ModalDialog",Fr);var Vr=function(t){function i(e){var n;e===void 0&&(e=[]),(n=t.call(this)||this).tracks_=[],Object.defineProperty(Me(n),"length",{get:function(){return this.tracks_.length}});for(var a=0;a<e.length;a++)n.addTrack(e[a]);return n}ye(i,t);var r=i.prototype;return r.addTrack=function(e){var n=this.tracks_.length;""+n in this||Object.defineProperty(this,n,{get:function(){return this.tracks_[n]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},r.removeTrack=function(e){for(var n,a=0,s=this.length;a<s;a++)if(this[a]===e){(n=this[a]).off&&n.off(),this.tracks_.splice(a,1);break}n&&this.trigger({track:n,type:"removetrack",target:this})},r.getTrackById=function(e){for(var n=null,a=0,s=this.length;a<s;a++){var o=this[a];if(o.id===e){n=o;break}}return n},i}(ht);for(var Ud in Vr.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Vr.prototype.allowedEvents_)Vr.prototype["on"+Ud]=null;var Yn=function(t,i){for(var r=0;r<t.length;r++)Object.keys(t[r]).length&&i.id!==t[r].id&&(t[r].enabled=!1)},jd=function(t){function i(e){var n;e===void 0&&(e=[]);for(var a=e.length-1;a>=0;a--)if(e[a].enabled){Yn(e,e[a]);break}return(n=t.call(this,e)||this).changing_=!1,n}ye(i,t);var r=i.prototype;return r.addTrack=function(e){var n=this;e.enabled&&Yn(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&(e.enabledChange_=function(){n.changing_||(n.changing_=!0,Yn(n,e),n.changing_=!1,n.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))},r.removeTrack=function(e){t.prototype.removeTrack.call(this,e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)},i}(Vr),Jn=function(t,i){for(var r=0;r<t.length;r++)Object.keys(t[r]).length&&i.id!==t[r].id&&(t[r].selected=!1)},Bd=function(t){function i(e){var n;e===void 0&&(e=[]);for(var a=e.length-1;a>=0;a--)if(e[a].selected){Jn(e,e[a]);break}return(n=t.call(this,e)||this).changing_=!1,Object.defineProperty(Me(n),"selectedIndex",{get:function(){for(var s=0;s<this.length;s++)if(this[s].selected)return s;return-1},set:function(){}}),n}ye(i,t);var r=i.prototype;return r.addTrack=function(e){var n=this;e.selected&&Jn(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&(e.selectedChange_=function(){n.changing_||(n.changing_=!0,Jn(n,e),n.changing_=!1,n.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))},r.removeTrack=function(e){t.prototype.removeTrack.call(this,e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)},i}(Vr),yo=function(t){function i(){return t.apply(this,arguments)||this}ye(i,t);var r=i.prototype;return r.addTrack=function(e){var n=this;t.prototype.addTrack.call(this,e),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)},r.removeTrack=function(e){t.prototype.removeTrack.call(this,e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},i}(Vr),Nd=function(){function t(r){r===void 0&&(r=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var e=0,n=r.length;e<n;e++)this.addTrackElement_(r[e])}var i=t.prototype;return i.addTrackElement_=function(r){var e=this.trackElements_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.trackElements_[e]}}),this.trackElements_.indexOf(r)===-1&&this.trackElements_.push(r)},i.getTrackElementByTrack_=function(r){for(var e,n=0,a=this.trackElements_.length;n<a;n++)if(r===this.trackElements_[n].track){e=this.trackElements_[n];break}return e},i.removeTrackElement_=function(r){for(var e=0,n=this.trackElements_.length;e<n;e++)if(r===this.trackElements_[e]){this.trackElements_[e].track&&typeof this.trackElements_[e].track.off=="function"&&this.trackElements_[e].track.off(),typeof this.trackElements_[e].off=="function"&&this.trackElements_[e].off(),this.trackElements_.splice(e,1);break}},t}(),_o=function(){function t(r){t.prototype.setCues_.call(this,r),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var i=t.prototype;return i.setCues_=function(r){var e=this.length||0,n=0,a=r.length;this.cues_=r,this.length_=r.length;var s=function(o){""+o in this||Object.defineProperty(this,""+o,{get:function(){return this.cues_[o]}})};if(e<a)for(n=e;n<a;n++)s.call(this,n)},i.getCueById=function(r){for(var e=null,n=0,a=this.length;n<a;n++){var s=this[n];if(s.id===r){e=s;break}}return e},t}(),Fd={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Vd={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Gd={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},bo={disabled:"disabled",hidden:"hidden",showing:"showing"},Qn=function(t){function i(r){var e;r===void 0&&(r={}),e=t.call(this)||this;var n={id:r.id||"vjs_track_"+_e(),kind:r.kind||"",label:r.label||"",language:r.language||""},a=function(o){Object.defineProperty(Me(e),o,{get:function(){return n[o]},set:function(){}})};for(var s in n)a(s);return e}return ye(i,t),i}(ht),Zn=function(t){var i=["protocol","hostname","port","pathname","search","hash","host"],r=q.createElement("a");r.href=t;var e,n=r.host===""&&r.protocol!=="file:";n&&((e=q.createElement("div")).innerHTML='<a href="'+t+'"></a>',r=e.firstChild,e.setAttribute("style","display:none; position:absolute;"),q.body.appendChild(e));for(var a={},s=0;s<i.length;s++)a[i[s]]=r[i[s]];return a.protocol==="http:"&&(a.host=a.host.replace(/:80$/,"")),a.protocol==="https:"&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=L.location.protocol),n&&q.body.removeChild(e),a},To=function(t){if(!t.match(/^https?:\/\//)){var i=q.createElement("div");i.innerHTML='<a href="'+t+'">x</a>',t=i.firstChild.href}return t},ea=function(t){if(typeof t=="string"){var i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(t);if(i)return i.pop().toLowerCase()}return""},Ui=function(t){var i=L.location,r=Zn(t);return(r.protocol===":"?i.protocol:r.protocol)+r.host!==i.protocol+i.host},Hd=Object.freeze({parseUrl:Zn,getAbsoluteURL:To,getFileExtension:ea,isCrossOrigin:Ui}),zd=function(t){var i=qd.call(t);return i==="[object Function]"||typeof t=="function"&&i!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)},qd=Object.prototype.toString,So,ta=Array.prototype.slice,Wd=Object.prototype.toString,ra=Function.prototype.bind||function(t){var i=this;if(typeof i!="function"||Wd.call(i)!=="[object Function]")throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var r,e=ta.call(arguments,1),n=Math.max(0,i.length-e.length),a=[],s=0;s<n;s++)a.push("$"+s);if(r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var u=i.apply(this,e.concat(ta.call(arguments)));return Object(u)===u?u:this}return i.apply(t,e.concat(ta.call(arguments)))}),i.prototype){var o=function(){};o.prototype=i.prototype,r.prototype=new o,o.prototype=null}return r},ko=Object.prototype.toString,Eo=function(t){var i=ko.call(t),r=i==="[object Arguments]";return r||(r=i!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&ko.call(t.callee)==="[object Function]"),r};if(!Object.keys){var ji=Object.prototype.hasOwnProperty,Co=Object.prototype.toString,Kd=Eo,wo=Object.prototype.propertyIsEnumerable,$d=!wo.call({toString:null},"toString"),Xd=wo.call(function(){},"prototype"),Bi=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ia=function(t){var i=t.constructor;return i&&i.prototype===t},Yd={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Jd=function(){if(typeof window>"u")return!1;for(var t in window)try{if(!Yd["$"+t]&&ji.call(window,t)&&window[t]!==null&&typeof window[t]=="object")try{ia(window[t])}catch{return!0}}catch{return!0}return!1}();So=function(t){var i=t!==null&&typeof t=="object",r=Co.call(t)==="[object Function]",e=Kd(t),n=i&&Co.call(t)==="[object String]",a=[];if(!i&&!r&&!e)throw new TypeError("Object.keys called on a non-object");var s=Xd&&r;if(n&&t.length>0&&!ji.call(t,0))for(var o=0;o<t.length;++o)a.push(String(o));if(e&&t.length>0)for(var u=0;u<t.length;++u)a.push(String(u));else for(var v in t)s&&v==="prototype"||!ji.call(t,v)||a.push(String(v));if($d)for(var C=function(M){if(typeof window>"u"||!Jd)return ia(M);try{return ia(M)}catch{return!1}}(t),k=0;k<Bi.length;++k)C&&Bi[k]==="constructor"||!ji.call(t,Bi[k])||a.push(Bi[k]);return a}}var Qd=So,Zd=Array.prototype.slice,Po=Object.keys,Ni=Po?function(t){return Po(t)}:Qd,Ao=Object.keys;Ni.shim=function(){return Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return Eo(t)?Ao(Zd.call(t)):Ao(t)}):Object.keys=Ni,Object.keys||Ni};var eh=Ni,th=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",rh=Object.prototype.toString,ih=Array.prototype.concat,na=Object.defineProperty,Ro=na&&function(){var t={};try{for(var i in na(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch{return!1}}(),nh=function(t,i,r,e){var n;i in t&&(typeof(n=e)!="function"||rh.call(n)!=="[object Function]"||!e())||(Ro?na(t,i,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[i]=r)},Lo=function(t,i){var r=arguments.length>2?arguments[2]:{},e=eh(i);th&&(e=ih.call(e,Object.getOwnPropertySymbols(i)));for(var n=0;n<e.length;n+=1)nh(t,e[n],i[e[n]],r[e[n]])};Lo.supportsDescriptors=!!Ro;var Oo=Lo,ah=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},Cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",wr=Object.getPrototypeOf||function(t){return t.__proto__},aa=typeof Uint8Array>"u"?void 0:wr(Uint8Array),sa={"$ %Array%":Array,"$ %ArrayBuffer%":typeof ArrayBuffer>"u"?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":typeof ArrayBuffer>"u"?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":Cr?wr([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":void 0,"$ %Atomics%":typeof Atomics>"u"?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":typeof DataView>"u"?void 0:DataView,"$ %DataViewPrototype%":typeof DataView>"u"?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":typeof Float32Array>"u"?void 0:Float32Array,"$ %Float32ArrayPrototype%":typeof Float32Array>"u"?void 0:Float32Array.prototype,"$ %Float64Array%":typeof Float64Array>"u"?void 0:Float64Array,"$ %Float64ArrayPrototype%":typeof Float64Array>"u"?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":typeof Int8Array>"u"?void 0:Int8Array,"$ %Int8ArrayPrototype%":typeof Int8Array>"u"?void 0:Int8Array.prototype,"$ %Int16Array%":typeof Int16Array>"u"?void 0:Int16Array,"$ %Int16ArrayPrototype%":typeof Int16Array>"u"?void 0:Int8Array.prototype,"$ %Int32Array%":typeof Int32Array>"u"?void 0:Int32Array,"$ %Int32ArrayPrototype%":typeof Int32Array>"u"?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":Cr?wr(wr([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":typeof Map>"u"?void 0:Map,"$ %MapIteratorPrototype%":typeof Map<"u"&&Cr?wr(new Map()[Symbol.iterator]()):void 0,"$ %MapPrototype%":typeof Map>"u"?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":typeof Promise>"u"?void 0:Promise,"$ %PromisePrototype%":typeof Promise>"u"?void 0:Promise.prototype,"$ %PromiseProto_then%":typeof Promise>"u"?void 0:Promise.prototype.then,"$ %Promise_all%":typeof Promise>"u"?void 0:Promise.all,"$ %Promise_reject%":typeof Promise>"u"?void 0:Promise.reject,"$ %Promise_resolve%":typeof Promise>"u"?void 0:Promise.resolve,"$ %Proxy%":typeof Proxy>"u"?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":typeof Reflect>"u"?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":typeof Set>"u"?void 0:Set,"$ %SetIteratorPrototype%":typeof Set<"u"&&Cr?wr(new Set()[Symbol.iterator]()):void 0,"$ %SetPrototype%":typeof Set>"u"?void 0:Set.prototype,"$ %SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":typeof SharedArrayBuffer>"u"?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":Cr?wr(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":Cr?Symbol:void 0,"$ %SymbolPrototype%":Cr?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":ah,"$ %TypedArray%":aa,"$ %TypedArrayPrototype%":aa?aa.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":typeof Uint8Array>"u"?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":typeof Uint8Array>"u"?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":typeof Uint8ClampedArray>"u"?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":typeof Uint16Array>"u"?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":typeof Uint16Array>"u"?void 0:Uint16Array.prototype,"$ %Uint32Array%":typeof Uint32Array>"u"?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":typeof Uint32Array>"u"?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":typeof WeakMap>"u"?void 0:WeakMap,"$ %WeakMapPrototype%":typeof WeakMap>"u"?void 0:WeakMap.prototype,"$ %WeakSet%":typeof WeakSet>"u"?void 0:WeakSet,"$ %WeakSetPrototype%":typeof WeakSet>"u"?void 0:WeakSet.prototype},ui=function(t,i){if(arguments.length>1&&typeof i!="boolean")throw new TypeError('"allowMissing" argument must be a boolean');var r="$ "+t;if(!(r in sa))throw new SyntaxError("intrinsic "+t+" does not exist!");if(sa[r]===void 0&&!i)throw new TypeError("intrinsic "+t+" exists, but is not available. Please file an issue!");return sa[r]},at=ra.call(Function.call,Object.prototype.hasOwnProperty),Io=ui("%TypeError%"),sh=ui("%SyntaxError%"),oh={"Property Descriptor":function(t,i){if(t.Type(i)!=="Object")return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var e in i)if(at(i,e)&&!r[e])return!1;var n=at(i,"[[Value]]"),a=at(i,"[[Get]]")||at(i,"[[Set]]");if(n&&a)throw new Io("Property Descriptors may not be both accessor and data descriptors");return!0}},Fi=function(t,i,r,e){var n=oh[i];if(typeof n!="function")throw new sh("unknown record type: "+i);if(!n(t,e))throw new Io(r+" must be a "+i);console.log(n(t,e),e)},Vi=Number.isNaN||function(t){return t!=t},uh=Number.isNaN||function(t){return t!=t},xo=Number.isFinite||function(t){return typeof t=="number"&&!uh(t)&&t!==1/0&&t!==-1/0},Do=function(t){return t>=0?1:-1},Mo=Function.prototype.toString,lh=/^\s*class\b/,Uo=function(t){try{var i=Mo.call(t);return lh.test(i)}catch{return!1}},ch=Object.prototype.toString,dh=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",oa=function(t){if(!t||typeof t!="function"&&typeof t!="object")return!1;if(typeof t=="function"&&!t.prototype)return!0;if(dh)return function(r){try{return!Uo(r)&&(Mo.call(r),!0)}catch{return!1}}(t);if(Uo(t))return!1;var i=ch.call(t);return i==="[object Function]"||i==="[object GeneratorFunction]"},jo=function(t){return t===null||typeof t!="function"&&typeof t!="object"},hh=Object.prototype.toString,Bo=function(t){var i;if((i=arguments.length>1?arguments[1]:hh.call(t)==="[object Date]"?String:Number)===String||i===Number){var r,e,n=i===String?["toString","valueOf"]:["valueOf","toString"];for(e=0;e<n.length;++e)if(oa(t[n[e]])&&(r=t[n[e]](),jo(r)))return r;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")},fh=ui("%Object%"),Gr=ui("%TypeError%"),ph=ui("%String%"),No={ToPrimitive:function(t){return jo(t)?t:arguments.length>1?Bo(t,arguments[1]):Bo(t)},ToBoolean:function(t){return!!t},ToNumber:function(t){return+t},ToInteger:function(t){var i=this.ToNumber(t);return Vi(i)?0:i!==0&&xo(i)?Do(i)*Math.floor(Math.abs(i)):i},ToInt32:function(t){return this.ToNumber(t)>>0},ToUint32:function(t){return this.ToNumber(t)>>>0},ToUint16:function(t){var i=this.ToNumber(t);return Vi(i)||i===0||!xo(i)?0:function(r,e){var n=r%e;return Math.floor(n>=0?n:n+e)}(Do(i)*Math.floor(Math.abs(i)),65536)},ToString:function(t){return ph(t)},ToObject:function(t){return this.CheckObjectCoercible(t),fh(t)},CheckObjectCoercible:function(t,i){if(t==null)throw new Gr(i||"Cannot call method on "+t);return t},IsCallable:oa,SameValue:function(t,i){return t===i?t!==0||1/t==1/i:Vi(t)&&Vi(i)},Type:function(t){return t===null?"Null":t===void 0?"Undefined":typeof t=="function"||typeof t=="object"?"Object":typeof t=="number"?"Number":typeof t=="boolean"?"Boolean":typeof t=="string"?"String":void 0},IsPropertyDescriptor:function(t){if(this.Type(t)!=="Object")return!1;var i={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(at(t,r)&&!i[r])return!1;var e=at(t,"[[Value]]"),n=at(t,"[[Get]]")||at(t,"[[Set]]");if(e&&n)throw new Gr("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(t){return t!==void 0&&(Fi(this,"Property Descriptor","Desc",t),!(!at(t,"[[Get]]")&&!at(t,"[[Set]]")))},IsDataDescriptor:function(t){return t!==void 0&&(Fi(this,"Property Descriptor","Desc",t),!(!at(t,"[[Value]]")&&!at(t,"[[Writable]]")))},IsGenericDescriptor:function(t){return t!==void 0&&(Fi(this,"Property Descriptor","Desc",t),!this.IsAccessorDescriptor(t)&&!this.IsDataDescriptor(t))},FromPropertyDescriptor:function(t){if(t===void 0)return t;if(Fi(this,"Property Descriptor","Desc",t),this.IsDataDescriptor(t))return{value:t["[[Value]]"],writable:!!t["[[Writable]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};if(this.IsAccessorDescriptor(t))return{get:t["[[Get]]"],set:t["[[Set]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};throw new Gr("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(t){if(this.Type(t)!=="Object")throw new Gr("ToPropertyDescriptor requires an object");var i={};if(at(t,"enumerable")&&(i["[[Enumerable]]"]=this.ToBoolean(t.enumerable)),at(t,"configurable")&&(i["[[Configurable]]"]=this.ToBoolean(t.configurable)),at(t,"value")&&(i["[[Value]]"]=t.value),at(t,"writable")&&(i["[[Writable]]"]=this.ToBoolean(t.writable)),at(t,"get")){var r=t.get;if(r!==void 0&&!this.IsCallable(r))throw new TypeError("getter must be a function");i["[[Get]]"]=r}if(at(t,"set")){var e=t.set;if(e!==void 0&&!this.IsCallable(e))throw new Gr("setter must be a function");i["[[Set]]"]=e}if((at(i,"[[Get]]")||at(i,"[[Set]]"))&&(at(i,"[[Value]]")||at(i,"[[Writable]]")))throw new Gr("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return i}},Fo=ra.call(Function.call,String.prototype.replace),mh=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,gh=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,Vo=function(){var t=No.ToString(No.CheckObjectCoercible(this));return Fo(Fo(t,mh,""),gh,"")},ua=function(){return String.prototype.trim&&"\u200B".trim()==="\u200B"?String.prototype.trim:Vo},Go=ra.call(Function.call,ua());Oo(Go,{getPolyfill:ua,implementation:Vo,shim:function(){var t=ua();return Oo(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}});var la=Go,vh=Object.prototype.toString,Ho=Object.prototype.hasOwnProperty,yh=function(t,i,r){if(!oa(i))throw new TypeError("iterator must be a function");var e;arguments.length>=3&&(e=r),vh.call(t)==="[object Array]"?function(n,a,s){for(var o=0,u=n.length;o<u;o++)Ho.call(n,o)&&(s==null?a(n[o],o,n):a.call(s,n[o],o,n))}(t,i,e):typeof t=="string"?function(n,a,s){for(var o=0,u=n.length;o<u;o++)s==null?a(n.charAt(o),o,n):a.call(s,n.charAt(o),o,n)}(t,i,e):function(n,a,s){for(var o in n)Ho.call(n,o)&&(s==null?a(n[o],o,n):a.call(s,n[o],o,n))}(t,i,e)},_h=function(t){if(!t)return{};var i={};return yh(la(t).split(`
`),function(r){var e,n=r.indexOf(":"),a=la(r.slice(0,n)).toLowerCase(),s=la(r.slice(n+1));i[a]===void 0?i[a]=s:(e=i[a],Object.prototype.toString.call(e)==="[object Array]"?i[a].push(s):i[a]=[i[a],s])}),i},bh=function(){for(var t={},i=0;i<arguments.length;i++){var r=arguments[i];for(var e in r)Th.call(r,e)&&(t[e]=r[e])}return t},Th=Object.prototype.hasOwnProperty,zo=cr;function qo(t,i,r){var e=t;return zd(i)?(r=i,typeof t=="string"&&(e={uri:t})):e=bh(i,{uri:t}),e.callback=r,e}function cr(t,i,r){return Wo(i=qo(t,i,r))}function Wo(t){if(t.callback===void 0)throw new Error("callback argument missing");var i=!1,r=function(K,W,Y){i||(i=!0,t.callback(K,W,Y))};function e(K){return clearTimeout(u),K instanceof Error||(K=new Error(""+(K||"Unknown XMLHttpRequest Error"))),K.statusCode=0,r(K,H)}function n(){if(!s){var K;clearTimeout(u),K=t.useXDR&&o.status===void 0?200:o.status===1223?204:o.status;var W=H,Y=null;return K!==0?(W={body:function(){var ne=void 0;if(ne=o.response?o.response:o.responseText||function(ie){if(ie.responseType==="document")return ie.responseXML;var le=ie.responseXML&&ie.responseXML.documentElement.nodeName==="parsererror";return ie.responseType!==""||le?null:ie.responseXML}(o),G)try{ne=JSON.parse(ne)}catch{}return ne}(),statusCode:K,method:C,headers:{},url:v,rawRequest:o},o.getAllResponseHeaders&&(W.headers=_h(o.getAllResponseHeaders()))):Y=new Error("Internal XMLHttpRequest Error"),r(Y,W,W.body)}}var a,s,o=t.xhr||null;o||(o=t.cors||t.useXDR?new cr.XDomainRequest:new cr.XMLHttpRequest);var u,v=o.url=t.uri||t.url,C=o.method=t.method||"GET",k=t.body||t.data,M=o.headers=t.headers||{},j=!!t.sync,G=!1,H={body:void 0,headers:{},statusCode:0,method:C,url:v,rawRequest:o};if("json"in t&&t.json!==!1&&(G=!0,M.accept||M.Accept||(M.Accept="application/json"),C!=="GET"&&C!=="HEAD"&&(M["content-type"]||M["Content-Type"]||(M["Content-Type"]="application/json"),k=JSON.stringify(t.json===!0?k:t.json))),o.onreadystatechange=function(){o.readyState===4&&setTimeout(n,0)},o.onload=n,o.onerror=e,o.onprogress=function(){},o.onabort=function(){s=!0},o.ontimeout=e,o.open(C,v,!j,t.username,t.password),j||(o.withCredentials=!!t.withCredentials),!j&&t.timeout>0&&(u=setTimeout(function(){if(!s){s=!0,o.abort("timeout");var K=new Error("XMLHttpRequest timeout");K.code="ETIMEDOUT",e(K)}},t.timeout)),o.setRequestHeader)for(a in M)M.hasOwnProperty(a)&&o.setRequestHeader(a,M[a]);else if(t.headers&&!function(K){for(var W in K)if(K.hasOwnProperty(W))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(o.responseType=t.responseType),"beforeSend"in t&&typeof t.beforeSend=="function"&&t.beforeSend(o),o.send(k||null),o}cr.XMLHttpRequest=L.XMLHttpRequest||function(){},cr.XDomainRequest="withCredentials"in new cr.XMLHttpRequest?cr.XMLHttpRequest:L.XDomainRequest,function(t,i){for(var r=0;r<t.length;r++)i(t[r])}(["get","put","post","patch","head","delete"],function(t){cr[t==="delete"?"del":t]=function(i,r,e){return(r=qo(i,r,e)).method=t.toUpperCase(),Wo(r)}});var Ko=function(t,i){var r=new L.WebVTT.Parser(L,L.vttjs,L.WebVTT.StringDecoder()),e=[];r.oncue=function(n){i.addCue(n)},r.onparsingerror=function(n){e.push(n)},r.onflush=function(){i.trigger({type:"loadeddata",target:i})},r.parse(t),e.length>0&&(L.console&&L.console.groupCollapsed&&L.console.groupCollapsed("Text Track parsing errors for "+i.src),e.forEach(function(n){return b.error(n)}),L.console&&L.console.groupEnd&&L.console.groupEnd()),r.flush()},Sh=function(t,i){var r={uri:t},e=Ui(t);e&&(r.cors=e),zo(r,je(this,function(n,a,s){if(n)return b.error(n,a);i.loaded_=!0,typeof L.WebVTT!="function"?i.tech_&&i.tech_.any(["vttjsloaded","vttjserror"],function(o){if(o.type!=="vttjserror")return Ko(s,i);b.error("vttjs failed to load, stopping trying to process "+i.src)}):Ko(s,i)}))},li=function(t){function i(e){var n;if(e===void 0&&(e={}),!e.tech)throw new Error("A tech was not provided.");var a=Qe(e,{kind:Gd[e.kind]||"subtitles",language:e.language||e.srclang||""}),s=bo[a.mode]||"disabled",o=a.default;a.kind!=="metadata"&&a.kind!=="chapters"||(s="hidden"),(n=t.call(this,a)||this).tech_=a.tech,n.cues_=[],n.activeCues_=[];var u=new _o(n.cues_),v=new _o(n.activeCues_),C=!1,k=je(Me(n),function(){this.activeCues=this.activeCues,C&&(this.trigger("cuechange"),C=!1)});return s!=="disabled"&&n.tech_.ready(function(){n.tech_.on("timeupdate",k)},!0),Object.defineProperties(Me(n),{default:{get:function(){return o},set:function(){}},mode:{get:function(){return s},set:function(M){var j=this;bo[M]&&((s=M)!=="disabled"?this.tech_.ready(function(){j.tech_.on("timeupdate",k)},!0):this.tech_.off("timeupdate",k),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?u:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(this.cues.length===0)return v;for(var M=this.tech_.currentTime(),j=[],G=0,H=this.cues.length;G<H;G++){var K=this.cues[G];(K.startTime<=M&&K.endTime>=M||K.startTime===K.endTime&&K.startTime<=M&&K.startTime+.5>=M)&&j.push(K)}if(C=!1,j.length!==this.activeCues_.length)C=!0;else for(var W=0;W<j.length;W++)this.activeCues_.indexOf(j[W])===-1&&(C=!0);return this.activeCues_=j,v.setCues_(this.activeCues_),v},set:function(){}}}),a.src?(n.src=a.src,Sh(a.src,Me(n))):n.loaded_=!0,n}ye(i,t);var r=i.prototype;return r.addCue=function(e){var n=e;if(L.vttjs&&!(e instanceof L.vttjs.VTTCue)){for(var a in n=new L.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)a in n||(n[a]=e[a]);n.id=e.id,n.originalCue_=e}for(var s=this.tech_.textTracks(),o=0;o<s.length;o++)s[o]!==this&&s[o].removeCue(n);this.cues_.push(n),this.cues.setCues_(this.cues_)},r.removeCue=function(e){for(var n=this.cues_.length;n--;){var a=this.cues_[n];if(a===e||a.originalCue_&&a.originalCue_===e){this.cues_.splice(n,1),this.cues.setCues_(this.cues_);break}}},i}(Qn);li.prototype.allowedEvents_={cuechange:"cuechange"};var $o=function(t){function i(r){var e;r===void 0&&(r={});var n=Qe(r,{kind:Vd[r.kind]||""});e=t.call(this,n)||this;var a=!1;return Object.defineProperty(Me(e),"enabled",{get:function(){return a},set:function(s){typeof s=="boolean"&&s!==a&&(a=s,this.trigger("enabledchange"))}}),n.enabled&&(e.enabled=n.enabled),e.loaded_=!0,e}return ye(i,t),i}(Qn),Xo=function(t){function i(r){var e;r===void 0&&(r={});var n=Qe(r,{kind:Fd[r.kind]||""});e=t.call(this,n)||this;var a=!1;return Object.defineProperty(Me(e),"selected",{get:function(){return a},set:function(s){typeof s=="boolean"&&s!==a&&(a=s,this.trigger("selectedchange"))}}),n.selected&&(e.selected=n.selected),e}return ye(i,t),i}(Qn),Yo=0,Jo=2,Hr=function(t){function i(r){var e,n;r===void 0&&(r={}),e=t.call(this)||this;var a=new li(r);return e.kind=a.kind,e.src=a.src,e.srclang=a.language,e.label=a.label,e.default=a.default,Object.defineProperties(Me(e),{readyState:{get:function(){return n}},track:{get:function(){return a}}}),n=Yo,a.addEventListener("loadeddata",function(){n=Jo,e.trigger({type:"load",target:Me(e)})}),e}return ye(i,t),i}(ht);Hr.prototype.allowedEvents_={load:"load"},Hr.NONE=Yo,Hr.LOADING=1,Hr.LOADED=Jo,Hr.ERROR=3;var Ft={audio:{ListClass:jd,TrackClass:$o,capitalName:"Audio"},video:{ListClass:Bd,TrackClass:Xo,capitalName:"Video"},text:{ListClass:yo,TrackClass:li,capitalName:"Text"}};Object.keys(Ft).forEach(function(t){Ft[t].getterName=t+"Tracks",Ft[t].privateName=t+"Tracks_"});var ci={remoteText:{ListClass:yo,TrackClass:li,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Nd,TrackClass:Hr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Tt=Qe(Ft,ci);ci.names=Object.keys(ci),Ft.names=Object.keys(Ft),Tt.names=[].concat(ci.names).concat(Ft.names);var ca=Object.create||function(){function t(){}return function(i){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=i,new t}}();function Dt(t,i){this.name="ParsingError",this.code=t.code,this.message=i||t.message}function da(t){function i(e,n,a,s){return 3600*(0|e)+60*(0|n)+(0|a)+(0|s)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?i(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?i(r[1],r[2],0,r[4]):i(0,r[1],r[2],r[4]):null}function di(){this.values=ca(null)}function hi(t,i,r,e){var n=e?t.split(e):[t];for(var a in n)if(typeof n[a]=="string"){var s=n[a].split(r);s.length===2&&i(s[0],s[1])}}function kh(t,i,r){var e=t;function n(){var s=da(t);if(s===null)throw new Dt(Dt.Errors.BadTimeStamp,"Malformed timestamp: "+e);return t=t.replace(/^[^\sa-zA-Z-]+/,""),s}function a(){t=t.replace(/^\s+/,"")}if(a(),i.startTime=n(),a(),t.substr(0,3)!=="-->")throw new Dt(Dt.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+e);t=t.substr(3),a(),i.endTime=n(),a(),function(s,o){var u=new di;hi(s,function(v,C){switch(v){case"region":for(var k=r.length-1;k>=0;k--)if(r[k].id===C){u.set(v,r[k].region);break}break;case"vertical":u.alt(v,C,["rl","lr"]);break;case"line":var M=C.split(","),j=M[0];u.integer(v,j),u.percent(v,j)&&u.set("snapToLines",!1),u.alt(v,j,["auto"]),M.length===2&&u.alt("lineAlign",M[1],["start","middle","end"]);break;case"position":M=C.split(","),u.percent(v,M[0]),M.length===2&&u.alt("positionAlign",M[1],["start","middle","end"]);break;case"size":u.percent(v,C);break;case"align":u.alt(v,C,["start","middle","end","left","right"])}},/:/,/\s/),o.region=u.get("region",null),o.vertical=u.get("vertical",""),o.line=u.get("line","auto"),o.lineAlign=u.get("lineAlign","start"),o.snapToLines=u.get("snapToLines",!0),o.size=u.get("size",100),o.align=u.get("align","middle"),o.position=u.get("position",{start:0,left:0,middle:50,end:100,right:100},o.align),o.positionAlign=u.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},o.align)}(t,i)}Dt.prototype=ca(Error.prototype),Dt.prototype.constructor=Dt,Dt.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},di.prototype={set:function(t,i){this.get(t)||i===""||(this.values[t]=i)},get:function(t,i,r){return r?this.has(t)?this.values[t]:i[r]:this.has(t)?this.values[t]:i},has:function(t){return t in this.values},alt:function(t,i,r){for(var e=0;e<r.length;++e)if(i===r[e]){this.set(t,i);break}},integer:function(t,i){/^-?\d+$/.test(i)&&this.set(t,parseInt(i,10))},percent:function(t,i){return!!(i.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(i=parseFloat(i))>=0&&i<=100)&&(this.set(t,i),!0)}};var Eh={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"\u200E","&rlm;":"\u200F","&nbsp;":"\xA0"},Ch={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},wh={v:"title",lang:"lang"},Qo={rt:"ruby"};function Zo(t,i){function r(){if(!i)return null;var G,H=i.match(/^([^<]*)(<[^>]*>?)?/);return G=H[1]?H[1]:H[2],i=i.substr(G.length),G}function e(G){return Eh[G]}function n(G){for(;j=G.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)G=G.replace(j[0],e);return G}function a(G,H){return!Qo[H.localName]||Qo[H.localName]===G.localName}function s(G,H){var K=Ch[G];if(!K)return null;var W=t.document.createElement(K);W.localName=K;var Y=wh[G];return Y&&H&&(W[Y]=H.trim()),W}for(var o,u=t.document.createElement("div"),v=u,C=[];(o=r())!==null;)if(o[0]!=="<")v.appendChild(t.document.createTextNode(n(o)));else{if(o[1]==="/"){C.length&&C[C.length-1]===o.substr(2).replace(">","")&&(C.pop(),v=v.parentNode);continue}var k,M=da(o.substr(1,o.length-2));if(M){k=t.document.createProcessingInstruction("timestamp",M),v.appendChild(k);continue}var j=o.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!j||!(k=s(j[1],j[3]))||!a(v,k))continue;j[2]&&(k.className=j[2].substr(1).replace("."," ")),C.push(j[1]),v.appendChild(k),v=k}return u}var eu=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Ph(t){for(var i=0;i<eu.length;i++){var r=eu[i];if(t>=r[0]&&t<=r[1])return!0}return!1}function Gi(){}function Hi(t,i,r){Gi.call(this),this.cue=i,this.cueDiv=Zo(t,i.text);var e={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:i.vertical===""?"horizontal-tb":i.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(e,this.cueDiv),this.div=t.document.createElement("div"),e={direction:function(a){var s=[],o="";if(!a||!a.childNodes)return"ltr";function u(k,M){for(var j=M.childNodes.length-1;j>=0;j--)k.push(M.childNodes[j])}function v(k){if(!k||!k.length)return null;var M=k.pop(),j=M.textContent||M.innerText;if(j){var G=j.match(/^.*(\n|\r)/);return G?(k.length=0,G[0]):j}return M.tagName==="ruby"?v(k):M.childNodes?(u(k,M),v(k)):void 0}for(u(s,a);o=v(s);)for(var C=0;C<o.length;C++)if(Ph(o.charCodeAt(C)))return"rtl";return"ltr"}(this.cueDiv),writingMode:i.vertical===""?"horizontal-tb":i.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:i.align==="middle"?"center":i.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(e),this.div.appendChild(this.cueDiv);var n=0;switch(i.positionAlign){case"start":n=i.position;break;case"middle":n=i.position-i.size/2;break;case"end":n=i.position-i.size}i.vertical===""?this.applyStyles({left:this.formatStyle(n,"%"),width:this.formatStyle(i.size,"%")}):this.applyStyles({top:this.formatStyle(n,"%"),height:this.formatStyle(i.size,"%")}),this.move=function(a){this.applyStyles({top:this.formatStyle(a.top,"px"),bottom:this.formatStyle(a.bottom,"px"),left:this.formatStyle(a.left,"px"),right:this.formatStyle(a.right,"px"),height:this.formatStyle(a.height,"px"),width:this.formatStyle(a.width,"px")})}}function St(t){var i,r,e,n;if(t.div){r=t.div.offsetHeight,e=t.div.offsetWidth,n=t.div.offsetTop;var a=(a=t.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();t=t.div.getBoundingClientRect(),i=a?Math.max(a[0]&&a[0].height||0,t.height/a.length):0}this.left=t.left,this.right=t.right,this.top=t.top||n,this.height=t.height||r,this.bottom=t.bottom||n+(t.height||r),this.width=t.width||e,this.lineHeight=i!==void 0?i:t.lineHeight}function Ah(t,i,r,e){var n=new St(i),a=i.cue,s=function(H){if(typeof H.line=="number"&&(H.snapToLines||H.line>=0&&H.line<=100))return H.line;if(!H.track||!H.track.textTrackList||!H.track.textTrackList.mediaElement)return-1;for(var K=H.track,W=K.textTrackList,Y=0,ne=0;ne<W.length&&W[ne]!==K;ne++)W[ne].mode==="showing"&&Y++;return-1*++Y}(a),o=[];if(a.snapToLines){var u;switch(a.vertical){case"":o=["+y","-y"],u="height";break;case"rl":o=["+x","-x"],u="width";break;case"lr":o=["-x","+x"],u="width"}var v=n.lineHeight,C=v*Math.round(s),k=r[u]+v,M=o[0];Math.abs(C)>k&&(C=C<0?-1:1,C*=Math.ceil(k/v)*v),s<0&&(C+=a.vertical===""?r.height:r.width,o=o.reverse()),n.move(M,C)}else{var j=n.lineHeight/r.height*100;switch(a.lineAlign){case"middle":s-=j/2;break;case"end":s-=j}switch(a.vertical){case"":i.applyStyles({top:i.formatStyle(s,"%")});break;case"rl":i.applyStyles({left:i.formatStyle(s,"%")});break;case"lr":i.applyStyles({right:i.formatStyle(s,"%")})}o=["+y","-x","+x","-y"],n=new St(i)}var G=function(H,K){for(var W,Y=new St(H),ne=1,ie=0;ie<K.length;ie++){for(;H.overlapsOppositeAxis(r,K[ie])||H.within(r)&&H.overlapsAny(e);)H.move(K[ie]);if(H.within(r))return H;var le=H.intersectPercentage(r);ne>le&&(W=new St(H),ne=le),H=new St(Y)}return W||Y}(n,o);i.move(G.toCSSCompatValues(r))}function zr(){}Gi.prototype.applyStyles=function(t,i){for(var r in i=i||this.div,t)t.hasOwnProperty(r)&&(i.style[r]=t[r])},Gi.prototype.formatStyle=function(t,i){return t===0?0:t+i},Hi.prototype=ca(Gi.prototype),Hi.prototype.constructor=Hi,St.prototype.move=function(t,i){switch(i=i!==void 0?i:this.lineHeight,t){case"+x":this.left+=i,this.right+=i;break;case"-x":this.left-=i,this.right-=i;break;case"+y":this.top+=i,this.bottom+=i;break;case"-y":this.top-=i,this.bottom-=i}},St.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},St.prototype.overlapsAny=function(t){for(var i=0;i<t.length;i++)if(this.overlaps(t[i]))return!0;return!1},St.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},St.prototype.overlapsOppositeAxis=function(t,i){switch(i){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},St.prototype.intersectPercentage=function(t){return Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left))*Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top))/(this.height*this.width)},St.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},St.getSimpleBoxPosition=function(t){var i=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,r=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,e=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;return{left:(t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t).left,right:t.right,top:t.top||e,height:t.height||i,bottom:t.bottom||e+(t.height||i),width:t.width||r}},zr.StringDecoder=function(){return{decode:function(t){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},zr.convertCueToDOMTree=function(t,i){return t&&i?Zo(t,i):null},zr.processCues=function(t,i,r){if(!t||!i||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var e=t.document.createElement("div");if(e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin="1.5%",r.appendChild(e),function(u){for(var v=0;v<u.length;v++)if(u[v].hasBeenReset||!u[v].displayState)return!0;return!1}(i)){var n=[],a=St.getSimpleBoxPosition(e),s={font:Math.round(.05*a.height*100)/100+"px sans-serif"};(function(){for(var u,v,C=0;C<i.length;C++)v=i[C],u=new Hi(t,v,s),e.appendChild(u.div),Ah(0,u,a,n),v.displayState=u.div,n.push(St.getSimpleBoxPosition(u))})()}else for(var o=0;o<i.length;o++)e.appendChild(i[o].displayState)},zr.Parser=function(t,i,r){r||(r=i,i={}),i||(i={}),this.window=t,this.vttjs=i,this.state="INITIAL",this.buffer="",this.decoder=r||new TextDecoder("utf8"),this.regionList=[]},zr.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof Dt))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){var i=this;function r(){for(var u=i.buffer,v=0;v<u.length&&u[v]!=="\r"&&u[v]!==`
`;)++v;var C=u.substr(0,v);return u[v]==="\r"&&++v,u[v]===`
`&&++v,i.buffer=u.substr(v),C}function e(u){u.match(/X-TIMESTAMP-MAP/)?hi(u,function(v,C){switch(v){case"X-TIMESTAMP-MAP":k=C,M=new di,hi(k,function(j,G){switch(j){case"MPEGT":M.integer(j+"S",G);break;case"LOCA":M.set(j+"L",da(G))}},/[^\d]:/,/,/),i.ontimestampmap&&i.ontimestampmap({MPEGTS:M.get("MPEGTS"),LOCAL:M.get("LOCAL")})}var k,M},/=/):hi(u,function(v,C){switch(v){case"Region":(function(k){var M=new di;if(hi(k,function(G,H){switch(G){case"id":M.set(G,H);break;case"width":M.percent(G,H);break;case"lines":M.integer(G,H);break;case"regionanchor":case"viewportanchor":var K=H.split(",");if(K.length!==2)break;var W=new di;if(W.percent("x",K[0]),W.percent("y",K[1]),!W.has("x")||!W.has("y"))break;M.set(G+"X",W.get("x")),M.set(G+"Y",W.get("y"));break;case"scroll":M.alt(G,H,["up"])}},/=/,/\s/),M.has("id")){var j=new(i.vttjs.VTTRegion||i.window.VTTRegion);j.width=M.get("width",100),j.lines=M.get("lines",3),j.regionAnchorX=M.get("regionanchorX",0),j.regionAnchorY=M.get("regionanchorY",100),j.viewportAnchorX=M.get("viewportanchorX",0),j.viewportAnchorY=M.get("viewportanchorY",100),j.scroll=M.get("scroll",""),i.onregion&&i.onregion(j),i.regionList.push({id:M.get("id"),region:j})}})(C)}},/:/)}t&&(i.buffer+=i.decoder.decode(t,{stream:!0}));try{var n;if(i.state==="INITIAL"){if(!/\r\n|\n/.test(i.buffer))return this;var a=(n=r()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Dt(Dt.Errors.BadSignature);i.state="HEADER"}for(var s=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(s?s=!1:n=r(),i.state){case"HEADER":/:/.test(n)?e(n):n||(i.state="ID");continue;case"NOTE":n||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){i.state="NOTE";break}if(!n)continue;if(i.cue=new(i.vttjs.VTTCue||i.window.VTTCue)(0,0,""),i.state="CUE",n.indexOf("-->")===-1){i.cue.id=n;continue}case"CUE":try{kh(n,i.cue,i.regionList)}catch(u){i.reportOrThrowError(u),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var o=n.indexOf("-->")!==-1;if(!n||o&&(s=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+=`
`),i.cue.text+=n;continue;case"BADCUE":n||(i.state="ID");continue}}}catch(u){i.reportOrThrowError(u),i.state==="CUETEXT"&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state=i.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||this.state==="HEADER")&&(this.buffer+=`

`,this.parse()),this.state==="INITIAL")throw new Dt(Dt.Errors.BadSignature)}catch(t){this.reportOrThrowError(t)}return this.onflush&&this.onflush(),this}};var Rh=zr,Lh="auto",Oh={"":1,lr:1,rl:1},Ih={start:1,middle:1,end:1,left:1,right:1};function ha(t){return typeof t=="string"&&!!Ih[t.toLowerCase()]&&t.toLowerCase()}function tu(t,i,r){this.hasBeenReset=!1;var e="",n=!1,a=t,s=i,o=r,u=null,v="",C=!0,k="auto",M="start",j=50,G="middle",H=50,K="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return e},set:function(W){e=""+W}},pauseOnExit:{enumerable:!0,get:function(){return n},set:function(W){n=!!W}},startTime:{enumerable:!0,get:function(){return a},set:function(W){if(typeof W!="number")throw new TypeError("Start time must be set to a number.");a=W,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(W){if(typeof W!="number")throw new TypeError("End time must be set to a number.");s=W,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(W){o=""+W,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return u},set:function(W){u=W,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return v},set:function(W){var Y=function(ne){return typeof ne=="string"&&!!Oh[ne.toLowerCase()]&&ne.toLowerCase()}(W);if(Y===!1)throw new SyntaxError("An invalid or illegal string was specified.");v=Y,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return C},set:function(W){C=!!W,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return k},set:function(W){if(typeof W!="number"&&W!==Lh)throw new SyntaxError("An invalid number or illegal string was specified.");k=W,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return M},set:function(W){var Y=ha(W);if(!Y)throw new SyntaxError("An invalid or illegal string was specified.");M=Y,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return j},set:function(W){if(W<0||W>100)throw new Error("Position must be between 0 and 100.");j=W,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return G},set:function(W){var Y=ha(W);if(!Y)throw new SyntaxError("An invalid or illegal string was specified.");G=Y,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return H},set:function(W){if(W<0||W>100)throw new Error("Size must be between 0 and 100.");H=W,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return K},set:function(W){var Y=ha(W);if(!Y)throw new SyntaxError("An invalid or illegal string was specified.");K=Y,this.hasBeenReset=!0}}}),this.displayState=void 0}tu.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var xh=tu,Dh={"":!0,up:!0};function fi(t){return typeof t=="number"&&t>=0&&t<=100}var Mh=function(){var t=100,i=3,r=0,e=100,n=0,a=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(o){if(!fi(o))throw new Error("Width must be between 0 and 100.");t=o}},lines:{enumerable:!0,get:function(){return i},set:function(o){if(typeof o!="number")throw new TypeError("Lines must be set to a number.");i=o}},regionAnchorY:{enumerable:!0,get:function(){return e},set:function(o){if(!fi(o))throw new Error("RegionAnchorX must be between 0 and 100.");e=o}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(o){if(!fi(o))throw new Error("RegionAnchorY must be between 0 and 100.");r=o}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(o){if(!fi(o))throw new Error("ViewportAnchorY must be between 0 and 100.");a=o}},viewportAnchorX:{enumerable:!0,get:function(){return n},set:function(o){if(!fi(o))throw new Error("ViewportAnchorX must be between 0 and 100.");n=o}},scroll:{enumerable:!0,get:function(){return s},set:function(o){var u=function(v){return typeof v=="string"&&!!Dh[v.toLowerCase()]&&v.toLowerCase()}(o);if(u===!1)throw new SyntaxError("An invalid or illegal string was specified.");s=u}}})},pi=$n(function(t){var i=t.exports={WebVTT:Rh,VTTCue:xh,VTTRegion:Mh};L.vttjs=i,L.WebVTT=i.WebVTT;var r=i.VTTCue,e=i.VTTRegion,n=L.VTTCue,a=L.VTTRegion;i.shim=function(){L.VTTCue=r,L.VTTRegion=e},i.restore=function(){L.VTTCue=n,L.VTTRegion=a},L.VTTCue||i.shim()});pi.WebVTT,pi.VTTCue,pi.VTTRegion;var Ze=function(t){function i(e,n){var a;return e===void 0&&(e={}),n===void 0&&(n=function(){}),e.reportTouchActivity=!1,(a=t.call(this,null,e,n)||this).hasStarted_=!1,a.on("playing",function(){this.hasStarted_=!0}),a.on("loadstart",function(){this.hasStarted_=!1}),Tt.names.forEach(function(s){var o=Tt[s];e&&e[o.getterName]&&(a[o.privateName]=e[o.getterName])}),a.featuresProgressEvents||a.manualProgressOn(),a.featuresTimeupdateEvents||a.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(s){e["native"+s+"Tracks"]===!1&&(a["featuresNative"+s+"Tracks"]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?a.featuresNativeTextTracks=!1:e.nativeCaptions!==!0&&e.nativeTextTracks!==!0||(a.featuresNativeTextTracks=!0),a.featuresNativeTextTracks||a.emulateTextTracks(),a.autoRemoteTextTracks_=new Tt.text.ListClass,a.initTrackListeners(),e.nativeControlsForTouch||a.emitTapEvents(),a.constructor&&(a.name_=a.constructor.name||"Unknown Tech"),a}ye(i,t);var r=i.prototype;return r.triggerSourceset=function(e){var n=this;this.isReady_||this.one("ready",function(){return n.setTimeout(function(){return n.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},r.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},r.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},r.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(je(this,function(){var n=this.bufferedPercent();this.bufferedPercent_!==n&&this.trigger("progress"),this.bufferedPercent_=n,n===1&&this.stopTrackingProgress()}),500)},r.onDurationChange=function(e){this.duration_=this.duration()},r.buffered=function(){return kr(0,0)},r.bufferedPercent=function(){return mo(this.buffered(),this.duration_)},r.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},r.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},r.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},r.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},r.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},r.dispose=function(){this.clearTracks(Ft.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},r.clearTracks=function(e){var n=this;(e=[].concat(e)).forEach(function(a){for(var s=n[a+"Tracks"]()||[],o=s.length;o--;){var u=s[o];a==="text"&&n.removeRemoteTextTrack(u),s.removeTrack(u)}})},r.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],n=e.length;n--;){var a=e[n];this.removeRemoteTextTrack(a)}},r.reset=function(){},r.error=function(e){return e!==void 0&&(this.error_=new bt(e),this.trigger("error")),this.error_},r.played=function(){return this.hasStarted_?kr(0,0):kr()},r.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},r.initTrackListeners=function(){var e=this;Ft.names.forEach(function(n){var a=Ft[n],s=function(){e.trigger(n+"trackchange")},o=e[a.getterName]();o.addEventListener("removetrack",s),o.addEventListener("addtrack",s),e.on("dispose",function(){o.removeEventListener("removetrack",s),o.removeEventListener("addtrack",s)})})},r.addWebVttScript_=function(){var e=this;if(!L.WebVTT)if(q.body.contains(this.el())){if(!this.options_["vtt.js"]&&w(pi)&&Object.keys(pi).length>0)return void this.trigger("vttjsloaded");var n=q.createElement("script");n.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",n.onload=function(){e.trigger("vttjsloaded")},n.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){n.onload=null,n.onerror=null}),L.WebVTT=!0,this.el().parentNode.appendChild(n)}else this.ready(this.addWebVttScript_)},r.emulateTextTracks=function(){var e=this,n=this.textTracks(),a=this.remoteTextTracks(),s=function(C){return n.addTrack(C.track)},o=function(C){return n.removeTrack(C.track)};a.on("addtrack",s),a.on("removetrack",o),this.addWebVttScript_();var u=function(){return e.trigger("texttrackchange")},v=function(){u();for(var C=0;C<n.length;C++){var k=n[C];k.removeEventListener("cuechange",u),k.mode==="showing"&&k.addEventListener("cuechange",u)}};v(),n.addEventListener("change",v),n.addEventListener("addtrack",v),n.addEventListener("removetrack",v),this.on("dispose",function(){a.off("addtrack",s),a.off("removetrack",o),n.removeEventListener("change",v),n.removeEventListener("addtrack",v),n.removeEventListener("removetrack",v);for(var C=0;C<n.length;C++)n[C].removeEventListener("cuechange",u)})},r.addTextTrack=function(e,n,a){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(s,o,u,v,C){C===void 0&&(C={});var k=s.textTracks();C.kind=o,u&&(C.label=u),v&&(C.language=v),C.tech=s;var M=new Tt.text.TrackClass(C);return k.addTrack(M),M}(this,e,n,a)},r.createRemoteTextTrack=function(e){var n=Qe(e,{tech:this});return new ci.remoteTextEl.TrackClass(n)},r.addRemoteTextTrack=function(e,n){var a=this;e===void 0&&(e={});var s=this.createRemoteTextTrack(e);return n!==!0&&n!==!1&&(b.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),n=!0),this.remoteTextTrackEls().addTrackElement_(s),this.remoteTextTracks().addTrack(s.track),n!==!0&&this.ready(function(){return a.autoRemoteTextTracks_.addTrack(s.track)}),s},r.removeRemoteTextTrack=function(e){var n=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(n),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},r.getVideoPlaybackQuality=function(){return{}},r.requestPictureInPicture=function(){var e=this.options_.Promise||L.Promise;if(e)return e.reject()},r.setPoster=function(){},r.playsinline=function(){},r.setPlaysinline=function(){},r.overrideNativeAudioTracks=function(){},r.overrideNativeVideoTracks=function(){},r.canPlayType=function(){return""},i.canPlayType=function(){return""},i.canPlaySource=function(e,n){return i.canPlayType(e.type)},i.isTech=function(e){return e.prototype instanceof i||e instanceof i||e===i},i.registerTech=function(e,n){if(i.techs_||(i.techs_={}),!i.isTech(n))throw new Error("Tech "+e+" must be a Tech");if(!i.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!i.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=ut(e),i.techs_[e]=n,i.techs_[Ii(e)]=n,e!=="Tech"&&i.defaultTechOrder_.push(e),n},i.getTech=function(e){if(e)return i.techs_&&i.techs_[e]?i.techs_[e]:(e=ut(e),L&&L.videojs&&L.videojs[e]?(b.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),L.videojs[e]):void 0)},i}(oe);Tt.names.forEach(function(t){var i=Tt[t];Ze.prototype[i.getterName]=function(){return this[i.privateName]=this[i.privateName]||new i.ListClass,this[i.privateName]}}),Ze.prototype.featuresVolumeControl=!0,Ze.prototype.featuresMuteControl=!0,Ze.prototype.featuresFullscreenResize=!1,Ze.prototype.featuresPlaybackRate=!1,Ze.prototype.featuresProgressEvents=!1,Ze.prototype.featuresSourceset=!1,Ze.prototype.featuresTimeupdateEvents=!1,Ze.prototype.featuresNativeTextTracks=!1,Ze.withSourceHandlers=function(t){t.registerSourceHandler=function(i,r){var e=t.sourceHandlers;e||(e=t.sourceHandlers=[]),r===void 0&&(r=e.length),e.splice(r,0,i)},t.canPlayType=function(i){for(var r,e=t.sourceHandlers||[],n=0;n<e.length;n++)if(r=e[n].canPlayType(i))return r;return""},t.selectSourceHandler=function(i,r){for(var e=t.sourceHandlers||[],n=0;n<e.length;n++)if(e[n].canHandleSource(i,r))return e[n];return null},t.canPlaySource=function(i,r){var e=t.selectSourceHandler(i,r);return e?e.canHandleSource(i,r):""},["seekable","seeking","duration"].forEach(function(i){var r=this[i];typeof r=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(i){var r=t.selectSourceHandler(i,this.options_);r||(t.nativeSourceHandler?r=t.nativeSourceHandler:b.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),r!==t.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=r.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},oe.registerComponent("Tech",Ze),Ze.registerTech("Tech",Ze),Ze.defaultTechOrder_=[];var Pr={},fa={},zi={};function Uh(t,i,r){t.setTimeout(function(){return function e(n,a,s,o,u,v){n===void 0&&(n={}),a===void 0&&(a=[]),u===void 0&&(u=[]),v===void 0&&(v=!1);var C=a,k=C[0],M=C.slice(1);if(typeof k=="string")e(n,Pr[k],s,o,u,v);else if(k){var j=function(G,H){var K=fa[G.id()],W=null;if(K==null)return W=H(G),fa[G.id()]=[[H,W]],W;for(var Y=0;Y<K.length;Y++){var ne=K[Y],ie=ne[0],le=ne[1];ie===H&&(W=le)}return W===null&&(W=H(G),K.push([H,W])),W}(o,k);if(!j.setSource)return u.push(j),e(n,M,s,o,u,v);j.setSource(T({},n),function(G,H){if(G)return e(n,M,s,o,u,v);u.push(j),e(H,n.type===H.type?M:Pr[H.type],s,o,u,v)})}else M.length?e(n,M,s,o,u,v):v?s(n,u):e(n,Pr["*"],s,o,u,!0)}(i,Pr[i.type],r,t)},1)}function ru(t,i,r,e){e===void 0&&(e=null);var n="call"+ut(r),a=t.reduce(pa(n),e),s=a===zi,o=s?null:i[r](a);return function(u,v,C,k){for(var M=u.length-1;M>=0;M--){var j=u[M];j[v]&&j[v](k,C)}}(t,r,o,s),o}var jh={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1,volume:1},Bh={setCurrentTime:1,setVolume:1},iu={play:1,pause:1};function pa(t){return function(i,r){return i===zi?zi:r[t]?r[t](i):i}}var Nh={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},qi=function(t){t===void 0&&(t="");var i=ea(t);return Nh[i.toLowerCase()]||""};function nu(t){if(!t.type){var i=qi(t.src);i&&(t.type=i)}return t}var Fh=function(t){function i(r,e,n){var a,s=Qe({createEl:!1},e);if(a=t.call(this,r,s,n)||this,e.playerOptions.sources&&e.playerOptions.sources.length!==0)r.src(e.playerOptions.sources);else for(var o=0,u=e.playerOptions.techOrder;o<u.length;o++){var v=ut(u[o]),C=Ze.getTech(v);if(v||(C=oe.getComponent(v)),C&&C.isSupported()){r.loadTech_(v);break}}return a}return ye(i,t),i}(oe);oe.registerComponent("MediaLoader",Fh);var Wi=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).emitTapEvents(),a.enable(),a}ye(i,t);var r=i.prototype;return r.createEl=function(e,n,a){e===void 0&&(e="div"),n===void 0&&(n={}),a===void 0&&(a={}),n=T({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),e==="button"&&b.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),a=T({role:"button"},a),this.tabIndex_=n.tabIndex;var s=t.prototype.createEl.call(this,e,n,a);return this.createControlTextEl(s),s},r.dispose=function(){this.controlTextEl_=null,t.prototype.dispose.call(this)},r.createControlTextEl=function(e){return this.controlTextEl_=U("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},r.controlText=function(e,n){if(n===void 0&&(n=this.el()),e===void 0)return this.controlText_||"Need Text";var a=this.localize(e);this.controlText_=e,O(this.controlTextEl_,a),this.nonIconControl||n.setAttribute("title",a)},r.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},r.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),this.tabIndex_!==void 0&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},r.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),this.tabIndex_!==void 0&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},r.handleClick=function(e){},r.handleKeyDown=function(e){Re.isEventKey(e,"Space")||Re.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):t.prototype.handleKeyDown.call(this,e)},i}(oe);oe.registerComponent("ClickableComponent",Wi);var Vh=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).update(),e.on("posterchange",je(Me(a),a.update)),a}ye(i,t);var r=i.prototype;return r.dispose=function(){this.player().off("posterchange",this.update),t.prototype.dispose.call(this)},r.createEl=function(){return U("div",{className:"vjs-poster",tabIndex:-1})},r.update=function(e){var n=this.player().poster();this.setSrc(n),n?this.show():this.hide()},r.setSrc=function(e){var n="";e&&(n='url("'+e+'")'),this.el_.style.backgroundImage=n},r.handleClick=function(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Er(this.player_.play()):this.player_.pause())},i}(Wi);oe.registerComponent("PosterImage",Vh);var Gh={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function ma(t,i){var r;if(t.length===4)r=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else{if(t.length!==7)throw new Error("Invalid color code provided, "+t+"; must be formatted as e.g. #f0e or #f604e2.");r=t.slice(1)}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+i+")"}function ga(t,i,r){try{t.style[i]=r}catch{return}}var Hh=function(t){function i(e,n,a){var s;s=t.call(this,e,n,a)||this;var o=je(Me(s),s.updateDisplay);return e.on("loadstart",je(Me(s),s.toggleDisplay)),e.on("texttrackchange",o),e.on("loadedmetadata",je(Me(s),s.preselectTrack)),e.ready(je(Me(s),function(){if(e.tech_&&e.tech_.featuresNativeTextTracks)this.hide();else{e.on("fullscreenchange",o),e.on("playerresize",o),L.addEventListener("orientationchange",o),e.on("dispose",function(){return L.removeEventListener("orientationchange",o)});for(var u=this.options_.playerOptions.tracks||[],v=0;v<u.length;v++)this.player_.addRemoteTextTrack(u[v],!0);this.preselectTrack()}})),s}ye(i,t);var r=i.prototype;return r.preselectTrack=function(){for(var e,n,a,s={captions:1,subtitles:1},o=this.player_.textTracks(),u=this.player_.cache_.selectedLanguage,v=0;v<o.length;v++){var C=o[v];u&&u.enabled&&u.language&&u.language===C.language&&C.kind in s?C.kind===u.kind?a=C:a||(a=C):u&&!u.enabled?(a=null,e=null,n=null):C.default&&(C.kind!=="descriptions"||e?C.kind in s&&!n&&(n=C):e=C)}a?a.mode="showing":n?n.mode="showing":e&&(e.mode="showing")},r.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},r.clearDisplay=function(){typeof L.WebVTT=="function"&&L.WebVTT.processCues(L,[],this.el_)},r.updateDisplay=function(){var e=this.player_.textTracks(),n=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),n){for(var a=[],s=0;s<e.length;++s){var o=e[s];o.mode==="showing"&&a.push(o)}this.updateForTrack(a)}else{for(var u=null,v=null,C=e.length;C--;){var k=e[C];k.mode==="showing"&&(k.kind==="descriptions"?u=k:v=k)}v?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(v)):u&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(u))}},r.updateDisplayState=function(e){for(var n=this.player_.textTrackSettings.getValues(),a=e.activeCues,s=a.length;s--;){var o=a[s];if(o){var u=o.displayState;if(n.color&&(u.firstChild.style.color=n.color),n.textOpacity&&ga(u.firstChild,"color",ma(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(u.firstChild.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&ga(u.firstChild,"backgroundColor",ma(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?ga(u,"backgroundColor",ma(n.windowColor,n.windowOpacity)):u.style.backgroundColor=n.windowColor),n.edgeStyle&&(n.edgeStyle==="dropshadow"?u.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":n.edgeStyle==="raised"?u.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":n.edgeStyle==="depressed"?u.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":n.edgeStyle==="uniform"&&(u.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),n.fontPercent&&n.fontPercent!==1){var v=L.parseFloat(u.style.fontSize);u.style.fontSize=v*n.fontPercent+"px",u.style.height="auto",u.style.top="auto",u.style.bottom="2px"}n.fontFamily&&n.fontFamily!=="default"&&(n.fontFamily==="small-caps"?u.firstChild.style.fontVariant="small-caps":u.firstChild.style.fontFamily=Gh[n.fontFamily])}}},r.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),typeof L.WebVTT=="function"&&!e.every(function(M){return!M.activeCues})){for(var n=[],a=0;a<e.length;++a)for(var s=e[a],o=0;o<s.activeCues.length;++o)n.push(s.activeCues[o]);L.WebVTT.processCues(L,n,this.el_);for(var u=0;u<e.length;++u){for(var v=e[u],C=0;C<v.activeCues.length;++C){var k=v.activeCues[C].displayState;Z(k,"vjs-text-track-cue"),Z(k,"vjs-text-track-cue-"+(v.language?v.language:u))}this.player_.textTrackSettings&&this.updateDisplayState(v)}}},i}(oe);oe.registerComponent("TextTrackDisplay",Hh);var zh=function(t){function i(){return t.apply(this,arguments)||this}return ye(i,t),i.prototype.createEl=function(){var r=this.player_.isAudio(),e=this.localize(r?"Audio Player":"Video Player"),n=U("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[e])}),a=t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return a.appendChild(n),a},i}(oe);oe.registerComponent("LoadingSpinner",zh);var $t=function(t){function i(){return t.apply(this,arguments)||this}ye(i,t);var r=i.prototype;return r.createEl=function(e,n,a){n===void 0&&(n={}),a===void 0&&(a={}),n=T({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},n),a=T({type:"button"},a);var s=oe.prototype.createEl.call(this,"button",n,a);return this.createControlTextEl(s),s},r.addChild=function(e,n){n===void 0&&(n={});var a=this.constructor.name;return b.warn("Adding an actionable (user controllable) child to a Button ("+a+") is not supported; use a ClickableComponent instead."),oe.prototype.addChild.call(this,e,n)},r.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},r.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},r.handleKeyDown=function(e){Re.isEventKey(e,"Space")||Re.isEventKey(e,"Enter")?e.stopPropagation():t.prototype.handleKeyDown.call(this,e)},i}(Wi);oe.registerComponent("Button",$t);var au=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).mouseused_=!1,a.on("mousedown",a.handleMouseDown),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-big-play-button"},r.handleClick=function(e){var n=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)return Er(n),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());var a=this.player_.getChild("controlBar"),s=a&&a.getChild("playToggle");if(s){var o=function(){return s.focus()};oi(n)?n.then(o,function(){}):this.setTimeout(o,1)}else this.player_.tech(!0).focus()},r.handleKeyDown=function(e){this.mouseused_=!1,t.prototype.handleKeyDown.call(this,e)},r.handleMouseDown=function(e){this.mouseused_=!0},i}($t);au.prototype.controlText_="Play Video",oe.registerComponent("BigPlayButton",au);var qh=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).controlText(n&&n.controlText||a.localize("Close")),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},r.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},r.handleKeyDown=function(e){Re.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):t.prototype.handleKeyDown.call(this,e)},i}($t);oe.registerComponent("CloseButton",qh);var su=function(t){function i(e,n){var a;return n===void 0&&(n={}),a=t.call(this,e,n)||this,n.replay=n.replay===void 0||n.replay,a.on(e,"play",a.handlePlay),a.on(e,"pause",a.handlePause),n.replay&&a.on(e,"ended",a.handleEnded),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},r.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},r.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},r.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},r.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},i}($t);su.prototype.controlText_="Play",oe.registerComponent("PlayToggle",su);var ou=function(t,i){t=t<0?0:t;var r=Math.floor(t%60),e=Math.floor(t/60%60),n=Math.floor(t/3600),a=Math.floor(i/60%60),s=Math.floor(i/3600);return(isNaN(t)||t===1/0)&&(n=e=r="-"),(n=n>0||s>0?n+":":"")+(e=((n||a>=10)&&e<10?"0"+e:e)+":")+(r=r<10?"0"+r:r)},va=ou;function qr(t,i){return i===void 0&&(i=t),va(t,i)}var Wr=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).throttledUpdateContent=ur(je(Me(a),a.updateContent),br),a.on(e,"timeupdate",a.throttledUpdateContent),a}ye(i,t);var r=i.prototype;return r.createEl=function(){var e=this.buildCSSClass(),n=t.prototype.createEl.call(this,"div",{className:e+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"\xA0</span>"});return this.contentEl_=U("span",{className:e+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),n.appendChild(this.contentEl_),n},r.dispose=function(){this.contentEl_=null,this.textNode_=null,t.prototype.dispose.call(this)},r.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=q.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},r.formatTime_=function(e){return qr(e)},r.updateFormattedTime_=function(e){var n=this.formatTime_(e);n!==this.formattedTime_&&(this.formattedTime_=n,this.requestAnimationFrame(this.updateTextNode_))},r.updateContent=function(e){},i}(oe);Wr.prototype.labelText_="Time",Wr.prototype.controlText_="Time",oe.registerComponent("TimeDisplay",Wr);var ya=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on(e,"ended",a.handleEnded),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-current-time"},r.updateContent=function(e){var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(n)},r.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},i}(Wr);ya.prototype.labelText_="Current Time",ya.prototype.controlText_="Current Time",oe.registerComponent("CurrentTimeDisplay",ya);var _a=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on(e,"durationchange",a.updateContent),a.on(e,"loadstart",a.updateContent),a.on(e,"loadedmetadata",a.throttledUpdateContent),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-duration"},r.updateContent=function(e){var n=this.player_.duration();this.duration_!==n&&(this.duration_=n,this.updateFormattedTime_(n))},i}(Wr);_a.prototype.labelText_="Duration",_a.prototype.controlText_="Duration",oe.registerComponent("DurationDisplay",_a);var Wh=function(t){function i(){return t.apply(this,arguments)||this}return ye(i,t),i.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},i}(oe);oe.registerComponent("TimeDivider",Wh);var ba=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on(e,"durationchange",a.throttledUpdateContent),a.on(e,"ended",a.handleEnded),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-remaining-time"},r.createEl=function(){var e=t.prototype.createEl.call(this);return e.insertBefore(U("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e},r.updateContent=function(e){typeof this.player_.duration()=="number"&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},r.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(0)},i}(Wr);ba.prototype.labelText_="Remaining Time",ba.prototype.controlText_="Remaining Time",oe.registerComponent("RemainingTimeDisplay",ba);var Kh=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).updateShowing(),a.on(a.player(),"durationchange",a.updateShowing),a}ye(i,t);var r=i.prototype;return r.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=U("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"\xA0</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},r.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},r.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},i}(oe);oe.registerComponent("LiveDisplay",Kh);var uu=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).updateLiveEdgeStatus(),a.player_.liveTracker&&a.on(a.player_.liveTracker,"liveedgechange",a.updateLiveEdgeStatus),a}ye(i,t);var r=i.prototype;return r.createEl=function(){var e=t.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=U("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e},r.updateLiveEdgeStatus=function(e){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},r.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},r.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,t.prototype.dispose.call(this)},i}($t);uu.prototype.controlText_="Seek to live, currently playing live",oe.registerComponent("SeekToLive",uu);var Ta=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).bar=a.getChild(a.options_.barName),a.vertical(!!a.options_.vertical),a.enable(),a}ye(i,t);var r=i.prototype;return r.enabled=function(){return this.enabled_},r.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},r.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},r.createEl=function(e,n,a){return n===void 0&&(n={}),a===void 0&&(a={}),n.className=n.className+" vjs-slider",n=T({tabIndex:0},n),a=T({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},a),t.prototype.createEl.call(this,e,n,a)},r.handleMouseDown=function(e){var n=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type!=="touchstart"||sr||e.preventDefault(),Ne(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(n,"mousemove",this.handleMouseMove),this.on(n,"mouseup",this.handleMouseUp),this.on(n,"touchmove",this.handleMouseMove),this.on(n,"touchend",this.handleMouseUp),this.handleMouseMove(e)},r.handleMouseMove=function(e){},r.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;ve(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},r.update=function(){if(this.el_){var e=this.getPercent(),n=this.bar;if(n){(typeof e!="number"||e!=e||e<0||e===1/0)&&(e=0);var a=(100*e).toFixed(2)+"%",s=n.el().style,o=this.vertical()?"height":"width";return s[o]!==a&&(s[o]=a),e}}},r.calculateDistance=function(e){var n=Ve(this.el_,e);return this.vertical()?n.y:n.x},r.handleKeyDown=function(e){Re.isEventKey(e,"Left")||Re.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):Re.isEventKey(e,"Right")||Re.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):t.prototype.handleKeyDown.call(this,e)},r.handleClick=function(e){e.stopPropagation(),e.preventDefault()},r.vertical=function(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},i}(oe);oe.registerComponent("Slider",Ta);var $h=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).partEls_=[],a.on(e,"progress",a.update),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},r.dispose=function(){this.partEls_=null,t.prototype.dispose.call(this)},r.update=function(e){var n=this.player_.liveTracker,a=this.player_.buffered(),s=n&&n.isLive()?n.seekableEnd():this.player_.duration(),o=this.player_.bufferedEnd(),u=this.partEls_,v=this.$(".vjs-control-text-loaded-percentage"),C=function(K,W,Y){var ne=K/W||0;return ne=100*(ne>=1?1:ne),Y&&(ne=ne.toFixed(2)),ne+"%"};this.el_.style.width=C(o,s),O(v,C(o,s,!0));for(var k=0;k<a.length;k++){var M=a.start(k),j=a.end(k),G=u[k];G||(G=this.el_.appendChild(U()),u[k]=G),G.style.left=C(M,o),G.style.width=C(j-M,o)}for(var H=u.length;H>a.length;H--)this.el_.removeChild(u[H-1]);u.length=a.length},i}(oe);oe.registerComponent("LoadProgressBar",$h);var Xh=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).update=ur(je(Me(a),a.update),br),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},r.update=function(e,n,a){var s=Fe(this.el_),o=Fe(this.player_.el()),u=e.width*n;if(o&&s){var v=e.left-o.left+u,C=e.width-u+(o.right-e.right),k=s.width/2;v<k?k+=k-v:C<k&&(k=C),k<0?k=0:k>s.width&&(k=s.width),this.el_.style.right="-"+k+"px",this.write(a)}},r.write=function(e){O(this.el_,e)},r.updateTime=function(e,n,a,s){var o=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var u,v=o.player_.duration();if(o.player_.liveTracker&&o.player_.liveTracker.isLive()){var C=o.player_.liveTracker.liveWindow(),k=C-n*C;u=(k<1?"":"-")+qr(k,C)}else u=qr(a,v);o.update(e,n,u),s&&s()})},i}(oe);oe.registerComponent("TimeTooltip",Xh);var Sa=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).update=ur(je(Me(a),a.update),br),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},r.update=function(e,n){var a=this.getChild("timeTooltip");if(a){var s=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();a.updateTime(e,n,s)}},i}(oe);Sa.prototype.options_={children:[]},Kt||lr||Sa.prototype.options_.children.push("timeTooltip"),oe.registerComponent("PlayProgressBar",Sa);var lu=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).update=ur(je(Me(a),a.update),br),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},r.update=function(e,n){var a=this,s=n*this.player_.duration();this.getChild("timeTooltip").updateTime(e,n,s,function(){a.el_.style.left=e.width*n+"px"})},i}(oe);lu.prototype.options_={children:["timeTooltip"]},oe.registerComponent("MouseTimeDisplay",lu);var ka=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).setEventHandlers_(),a}ye(i,t);var r=i.prototype;return r.setEventHandlers_=function(){this.update=ur(je(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in q&&"visibilityState"in q&&this.on(q,"visibilitychange",this.toggleVisibility_)},r.toggleVisibility_=function(e){q.hidden?this.disableInterval_(e):(this.enableInterval_(),this.requestAnimationFrame(this.update))},r.enableInterval_=function(){var e=this;this.clearInterval(this.updateInterval),this.updateInterval=this.setInterval(function(){e.requestAnimationFrame(e.update)},30)},r.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e.type!=="ended"||this.clearInterval(this.updateInterval)},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},r.update_=function(e,n){var a=this.player_.liveTracker,s=this.player_.duration();a&&a.isLive()&&(s=this.player_.liveTracker.liveCurrentTime()),this.el_.setAttribute("aria-valuenow",(100*n).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[qr(e,s),qr(s,s)],"{1} of {2}")),this.bar&&this.bar.update(Fe(this.el_),n)},r.update=function(e){if(this.el().offsetParent!==null){var n=t.prototype.update.call(this);return this.update_(this.getCurrentTime_(),n),n}},r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},r.handleEnded=function(e){this.update_(this.player_.duration(),1)},r.getPercent=function(){var e,n=this.getCurrentTime_(),a=this.player_.liveTracker;return a&&a.isLive()?(e=(n-a.seekableStart())/a.liveWindow(),a.atLiveEdge()&&(e=1)):e=n/this.player_.duration(),e>=1?1:e||0},r.handleMouseDown=function(e){He(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),t.prototype.handleMouseDown.call(this,e))},r.handleMouseMove=function(e){if(He(e)){var n,a=this.calculateDistance(e),s=this.player_.liveTracker;if(s&&s.isLive()){var o=s.seekableStart(),u=s.liveCurrentTime();if((n=o+a*s.liveWindow())>=u&&(n=u),n<=o&&(n=o+.1),n===1/0)return}else(n=a*this.player_.duration())===this.player_.duration()&&(n-=.1);this.player_.currentTime(n)}},r.enable=function(){t.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},r.disable=function(){t.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},r.handleMouseUp=function(e){t.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Er(this.player_.play())},r.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},r.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},r.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleKeyDown=function(e){if(Re.isEventKey(e,"Space")||Re.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(Re.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.player_.currentTime(0);else if(Re.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(Re(e))){e.preventDefault(),e.stopPropagation();var n=10*(Re.codes[Re(e)]-Re.codes[0])/100;this.player_.currentTime(this.player_.duration()*n)}else Re.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):Re.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):t.prototype.handleKeyDown.call(this,e)},i}(Ta);ka.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Kt||lr||ka.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),oe.registerComponent("SeekBar",ka);var cu=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).handleMouseMove=ur(je(Me(a),a.handleMouseMove),br),a.throttledHandleMouseSeek=ur(je(Me(a),a.handleMouseSeek),br),a.enable(),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},r.handleMouseMove=function(e){var n=this.getChild("seekBar");if(n){var a=n.getChild("mouseTimeDisplay"),s=n.el(),o=Fe(s),u=Ve(s,e).x;u>1?u=1:u<0&&(u=0),a&&a.update(o,u)}},r.handleMouseSeek=function(e){var n=this.getChild("seekBar");n&&n.handleMouseMove(e)},r.enabled=function(){return this.enabled_},r.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},r.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},r.handleMouseDown=function(e){var n=this.el_.ownerDocument,a=this.getChild("seekBar");a&&a.handleMouseDown(e),this.on(n,"mousemove",this.throttledHandleMouseSeek),this.on(n,"touchmove",this.throttledHandleMouseSeek),this.on(n,"mouseup",this.handleMouseUp),this.on(n,"touchend",this.handleMouseUp)},r.handleMouseUp=function(e){var n=this.el_.ownerDocument,a=this.getChild("seekBar");a&&a.handleMouseUp(e),this.off(n,"mousemove",this.throttledHandleMouseSeek),this.off(n,"touchmove",this.throttledHandleMouseSeek),this.off(n,"mouseup",this.handleMouseUp),this.off(n,"touchend",this.handleMouseUp)},i}(oe);cu.prototype.options_={children:["seekBar"]},oe.registerComponent("ProgressControl",cu);var du=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on(e,["enterpictureinpicture","leavepictureinpicture"],a.handlePictureInPictureChange),q.pictureInPictureEnabled||a.disable(),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-picture-in-picture-control "+t.prototype.buildCSSClass.call(this)},r.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},r.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},i}($t);du.prototype.controlText_="Picture-in-Picture",oe.registerComponent("PictureInPictureToggle",du);var hu=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on(e,"fullscreenchange",a.handleFullscreenChange),q[e.fsApi_.fullscreenEnabled]===!1&&a.disable(),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},i}($t);hu.prototype.controlText_="Fullscreen",oe.registerComponent("FullscreenToggle",hu);var Yh=function(t,i){i.tech_&&!i.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(i,"loadstart",function(){i.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},Jh=function(t){function i(){return t.apply(this,arguments)||this}return ye(i,t),i.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},i}(oe);oe.registerComponent("VolumeLevel",Jh);var Ea=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on("slideractive",a.updateLastVolume_),a.on(e,"volumechange",a.updateARIAAttributes),e.ready(function(){return a.updateARIAAttributes()}),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},r.handleMouseDown=function(e){He(e)&&t.prototype.handleMouseDown.call(this,e)},r.handleMouseMove=function(e){He(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},r.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},r.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},r.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},r.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},r.updateARIAAttributes=function(e){var n=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",n),this.el_.setAttribute("aria-valuetext",n+"%")},r.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},r.updateLastVolume_=function(){var e=this,n=this.player_.volume();this.one("sliderinactive",function(){e.player_.volume()===0&&e.player_.lastVolume_(n)})},i}(Ta);Ea.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Ea.prototype.playerEvent="volumechange",oe.registerComponent("VolumeBar",Ea);var fu=function(t){function i(e,n){var a;return n===void 0&&(n={}),n.vertical=n.vertical||!1,(n.volumeBar===void 0||w(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),a=t.call(this,e,n)||this,Yh(Me(a),e),a.throttledHandleMouseMove=ur(je(Me(a),a.handleMouseMove),br),a.on("mousedown",a.handleMouseDown),a.on("touchstart",a.handleMouseDown),a.on(a.volumeBar,["focus","slideractive"],function(){a.volumeBar.addClass("vjs-slider-active"),a.addClass("vjs-slider-active"),a.trigger("slideractive")}),a.on(a.volumeBar,["blur","sliderinactive"],function(){a.volumeBar.removeClass("vjs-slider-active"),a.removeClass("vjs-slider-active"),a.trigger("sliderinactive")}),a}ye(i,t);var r=i.prototype;return r.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},r.handleMouseDown=function(e){var n=this.el_.ownerDocument;this.on(n,"mousemove",this.throttledHandleMouseMove),this.on(n,"touchmove",this.throttledHandleMouseMove),this.on(n,"mouseup",this.handleMouseUp),this.on(n,"touchend",this.handleMouseUp)},r.handleMouseUp=function(e){var n=this.el_.ownerDocument;this.off(n,"mousemove",this.throttledHandleMouseMove),this.off(n,"touchmove",this.throttledHandleMouseMove),this.off(n,"mouseup",this.handleMouseUp),this.off(n,"touchend",this.handleMouseUp)},r.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},i}(oe);fu.prototype.options_={children:["volumeBar"]},oe.registerComponent("VolumeControl",fu);var Qh=function(t,i){i.tech_&&!i.tech_.featuresMuteControl&&t.addClass("vjs-hidden"),t.on(i,"loadstart",function(){i.tech_.featuresMuteControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},pu=function(t){function i(e,n){var a;return a=t.call(this,e,n)||this,Qh(Me(a),e),a.on(e,["loadstart","volumechange"],a.update),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},r.handleClick=function(e){var n=this.player_.volume(),a=this.player_.lastVolume_();if(n===0){var s=a<.1?.1:a;this.player_.volume(s),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},r.update=function(e){this.updateIcon_(),this.updateControlText_()},r.updateIcon_=function(){var e=this.player_.volume(),n=3;Kt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?n=0:e<.33?n=1:e<.67&&(n=2);for(var a=0;a<4;a++)te(this.el_,"vjs-vol-"+a);Z(this.el_,"vjs-vol-"+n)},r.updateControlText_=function(){var e=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},i}($t);pu.prototype.controlText_="Mute",oe.registerComponent("MuteToggle",pu);var mu=function(t){function i(e,n){var a;return n===void 0&&(n={}),n.inline!==void 0?n.inline=n.inline:n.inline=!0,(n.volumeControl===void 0||w(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(a=t.call(this,e,n)||this).on(e,["loadstart"],a.volumePanelState_),a.on(a.muteToggle,"keyup",a.handleKeyPress),a.on(a.volumeControl,"keyup",a.handleVolumeControlKeyUp),a.on("keydown",a.handleKeyPress),a.on("mouseover",a.handleMouseOver),a.on("mouseout",a.handleMouseOut),a.on(a.volumeControl,["slideractive"],a.sliderActive_),a.on(a.volumeControl,["sliderinactive"],a.sliderInactive_),a}ye(i,t);var r=i.prototype;return r.sliderActive_=function(){this.addClass("vjs-slider-active")},r.sliderInactive_=function(){this.removeClass("vjs-slider-active")},r.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},r.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},r.dispose=function(){this.handleMouseOut(),t.prototype.dispose.call(this)},r.handleVolumeControlKeyUp=function(e){Re.isEventKey(e,"Esc")&&this.muteToggle.focus()},r.handleMouseOver=function(e){this.addClass("vjs-hover"),Xe(q,"keyup",je(this,this.handleKeyPress))},r.handleMouseOut=function(e){this.removeClass("vjs-hover"),qe(q,"keyup",je(this,this.handleKeyPress))},r.handleKeyPress=function(e){Re.isEventKey(e,"Esc")&&this.handleMouseOut()},i}(oe);mu.prototype.options_={children:["muteToggle","volumeControl"]},oe.registerComponent("VolumePanel",mu);var Ca=function(t){function i(e,n){var a;return a=t.call(this,e,n)||this,n&&(a.menuButton_=n.menuButton),a.focusedChild_=-1,a.on("keydown",a.handleKeyDown),a.boundHandleBlur_=je(Me(a),a.handleBlur),a.boundHandleTapClick_=je(Me(a),a.handleTapClick),a}ye(i,t);var r=i.prototype;return r.addEventListenerForItem=function(e){e instanceof oe&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},r.removeEventListenerForItem=function(e){e instanceof oe&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},r.removeChild=function(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),t.prototype.removeChild.call(this,e)},r.addItem=function(e){var n=this.addChild(e);n&&this.addEventListenerForItem(n)},r.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=U(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),Xe(n,"click",function(a){a.preventDefault(),a.stopImmediatePropagation()}),n},r.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,t.prototype.dispose.call(this)},r.handleBlur=function(e){var n=e.relatedTarget||q.activeElement;if(!this.children().some(function(s){return s.el()===n})){var a=this.menuButton_;a&&a.buttonPressed_&&n!==a.el().firstChild&&a.unpressButton()}},r.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var n=this.children();if(!Array.isArray(n))return;var a=n.filter(function(s){return s.el()===e.target})[0];if(!a)return;a.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},r.handleKeyDown=function(e){Re.isEventKey(e,"Left")||Re.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(Re.isEventKey(e,"Right")||Re.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},r.stepForward=function(){var e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)},r.stepBack=function(){var e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)},r.focus=function(e){e===void 0&&(e=0);var n=this.children().slice();n.length&&n[0].className&&/vjs-menu-title/.test(n[0].className)&&n.shift(),n.length>0&&(e<0?e=0:e>=n.length&&(e=n.length-1),this.focusedChild_=e,n[e].el_.focus())},i}(oe);oe.registerComponent("Menu",Ca);var wa=function(t){function i(e,n){var a;n===void 0&&(n={}),(a=t.call(this,e,n)||this).menuButton_=new $t(e,n),a.menuButton_.controlText(a.controlText_),a.menuButton_.el_.setAttribute("aria-haspopup","true");var s=$t.prototype.buildCSSClass();return a.menuButton_.el_.className=a.buildCSSClass()+" "+s,a.menuButton_.removeClass("vjs-control"),a.addChild(a.menuButton_),a.update(),a.enabled_=!0,a.on(a.menuButton_,"tap",a.handleClick),a.on(a.menuButton_,"click",a.handleClick),a.on(a.menuButton_,"keydown",a.handleKeyDown),a.on(a.menuButton_,"mouseenter",function(){a.addClass("vjs-hover"),a.menu.show(),Xe(q,"keyup",je(Me(a),a.handleMenuKeyUp))}),a.on("mouseleave",a.handleMouseLeave),a.on("keydown",a.handleSubmenuKeyDown),a}ye(i,t);var r=i.prototype;return r.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},r.createMenu=function(){var e=new Ca(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var n=U("li",{className:"vjs-menu-title",innerHTML:ut(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var a=new oe(this.player_,{el:n});e.addItem(a)}if(this.items=this.createItems(),this.items)for(var s=0;s<this.items.length;s++)e.addItem(this.items[s]);return e},r.createItems=function(){},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},r.buildWrapperCSSClass=function(){var e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+$t.prototype.buildCSSClass()+" "+t.prototype.buildCSSClass.call(this)},r.buildCSSClass=function(){var e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},r.controlText=function(e,n){return n===void 0&&(n=this.menuButton_.el()),this.menuButton_.controlText(e,n)},r.dispose=function(){this.handleMouseLeave(),t.prototype.dispose.call(this)},r.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},r.handleMouseLeave=function(e){this.removeClass("vjs-hover"),qe(q,"keyup",je(this,this.handleMenuKeyUp))},r.focus=function(){this.menuButton_.focus()},r.blur=function(){this.menuButton_.blur()},r.handleKeyDown=function(e){Re.isEventKey(e,"Esc")||Re.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),Re.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(Re.isEventKey(e,"Up")||Re.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},r.handleMenuKeyUp=function(e){(Re.isEventKey(e,"Esc")||Re.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},r.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},r.handleSubmenuKeyDown=function(e){(Re.isEventKey(e,"Esc")||Re.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),Re.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},r.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Kt&&A())return;this.menu.focus()}},r.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},r.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},r.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},i}(oe);oe.registerComponent("MenuButton",wa);var Pa=function(t){function i(r,e){var n,a=e.tracks;if((n=t.call(this,r,e)||this).items.length<=1&&n.hide(),!a)return Me(n);var s=je(Me(n),n.update);return a.addEventListener("removetrack",s),a.addEventListener("addtrack",s),n.player_.on("ready",s),n.player_.on("dispose",function(){a.removeEventListener("removetrack",s),a.removeEventListener("addtrack",s)}),n}return ye(i,t),i}(wa);oe.registerComponent("TrackButton",Pa);var Zh=["Tab","Esc","Up","Down","Right","Left"],mi=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).selectable=n.selectable,a.isSelected_=n.selected||!1,a.multiSelectable=n.multiSelectable,a.selected(a.isSelected_),a.selectable?a.multiSelectable?a.el_.setAttribute("role","menuitemcheckbox"):a.el_.setAttribute("role","menuitemradio"):a.el_.setAttribute("role","menuitem"),a}ye(i,t);var r=i.prototype;return r.createEl=function(e,n,a){return this.nonIconControl=!0,t.prototype.createEl.call(this,"li",T({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),a)},r.handleKeyDown=function(e){Zh.some(function(n){return Re.isEventKey(e,n)})||t.prototype.handleKeyDown.call(this,e)},r.handleClick=function(e){this.selected(!0)},r.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},i}(Wi);oe.registerComponent("MenuItem",mi);var gi=function(t){function i(e,n){var a,s=n.track,o=e.textTracks();n.label=s.label||s.language||"Unknown",n.selected=s.mode==="showing",(a=t.call(this,e,n)||this).track=s,a.kinds=(n.kinds||[n.kind||a.track.kind]).filter(Boolean);var u,v=function(){for(var k=arguments.length,M=new Array(k),j=0;j<k;j++)M[j]=arguments[j];a.handleTracksChange.apply(Me(a),M)},C=function(){for(var k=arguments.length,M=new Array(k),j=0;j<k;j++)M[j]=arguments[j];a.handleSelectedLanguageChange.apply(Me(a),M)};return e.on(["loadstart","texttrackchange"],v),o.addEventListener("change",v),o.addEventListener("selectedlanguagechange",C),a.on("dispose",function(){e.off(["loadstart","texttrackchange"],v),o.removeEventListener("change",v),o.removeEventListener("selectedlanguagechange",C)}),o.onchange===void 0&&a.on(["tap","click"],function(){if(typeof L.Event!="object")try{u=new L.Event("change")}catch{}u||(u=q.createEvent("Event")).initEvent("change",!0,!0),o.dispatchEvent(u)}),a.handleTracksChange(),a}ye(i,t);var r=i.prototype;return r.handleClick=function(e){var n=this.track,a=this.player_.textTracks();if(t.prototype.handleClick.call(this,e),a)for(var s=0;s<a.length;s++){var o=a[s];this.kinds.indexOf(o.kind)!==-1&&(o===n?o.mode!=="showing"&&(o.mode="showing"):o.mode!=="disabled"&&(o.mode="disabled"))}},r.handleTracksChange=function(e){var n=this.track.mode==="showing";n!==this.isSelected_&&this.selected(n)},r.handleSelectedLanguageChange=function(e){if(this.track.mode==="showing"){var n=this.player_.cache_.selectedLanguage;if(n&&n.enabled&&n.language===this.track.language&&n.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},r.dispose=function(){this.track=null,t.prototype.dispose.call(this)},i}(mi);oe.registerComponent("TextTrackMenuItem",gi);var gu=function(t){function i(e,n){return n.track={player:e,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,t.call(this,e,n)||this}ye(i,t);var r=i.prototype;return r.handleTracksChange=function(e){for(var n=this.player().textTracks(),a=!0,s=0,o=n.length;s<o;s++){var u=n[s];if(this.options_.kinds.indexOf(u.kind)>-1&&u.mode==="showing"){a=!1;break}}a!==this.isSelected_&&this.selected(a)},r.handleSelectedLanguageChange=function(e){for(var n=this.player().textTracks(),a=!0,s=0,o=n.length;s<o;s++){var u=n[s];if(["captions","descriptions","subtitles"].indexOf(u.kind)>-1&&u.mode==="showing"){a=!1;break}}a&&(this.player_.cache_.selectedLanguage={enabled:!1})},i}(gi);oe.registerComponent("OffTextTrackMenuItem",gu);var Kr=function(t){function i(r,e){return e===void 0&&(e={}),e.tracks=r.textTracks(),t.call(this,r,e)||this}return ye(i,t),i.prototype.createItems=function(r,e){var n;r===void 0&&(r=[]),e===void 0&&(e=gi),this.label_&&(n=this.label_+" off"),r.push(new gu(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var a=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var s=0;s<a.length;s++){var o=a[s];if(this.kinds_.indexOf(o.kind)>-1){var u=new e(this.player_,{track:o,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});u.addClass("vjs-"+o.kind+"-menu-item"),r.push(u)}}return r},i}(Pa);oe.registerComponent("TextTrackButton",Kr);var vu=function(t){function i(e,n){var a,s=n.track,o=n.cue,u=e.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=o.text,n.selected=o.startTime<=u&&u<o.endTime,(a=t.call(this,e,n)||this).track=s,a.cue=o,s.addEventListener("cuechange",je(Me(a),a.update)),a}ye(i,t);var r=i.prototype;return r.handleClick=function(e){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},r.update=function(e){var n=this.cue,a=this.player_.currentTime();this.selected(n.startTime<=a&&a<n.endTime)},i}(mi);oe.registerComponent("ChaptersTrackMenuItem",vu);var Aa=function(t){function i(e,n,a){return t.call(this,e,n,a)||this}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildWrapperCSSClass.call(this)},r.update=function(e){this.track_&&(!e||e.type!=="addtrack"&&e.type!=="removetrack")||this.setTrack(this.findChaptersTrack()),t.prototype.update.call(this)},r.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var a=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);a&&a.addEventListener("load",this.updateHandler_)}}},r.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],n=e.length-1;n>=0;n--){var a=e[n];if(a.kind===this.kind_)return a}},r.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(ut(this.kind_))},r.createMenu=function(){return this.options_.title=this.getMenuCaption(),t.prototype.createMenu.call(this)},r.createItems=function(){var e=[];if(!this.track_)return e;var n=this.track_.cues;if(!n)return e;for(var a=0,s=n.length;a<s;a++){var o=n[a],u=new vu(this.player_,{track:this.track_,cue:o});e.push(u)}return e},i}(Kr);Aa.prototype.kind_="chapters",Aa.prototype.controlText_="Chapters",oe.registerComponent("ChaptersButton",Aa);var Ra=function(t){function i(e,n,a){var s;s=t.call(this,e,n,a)||this;var o=e.textTracks(),u=je(Me(s),s.handleTracksChange);return o.addEventListener("change",u),s.on("dispose",function(){o.removeEventListener("change",u)}),s}ye(i,t);var r=i.prototype;return r.handleTracksChange=function(e){for(var n=this.player().textTracks(),a=!1,s=0,o=n.length;s<o;s++){var u=n[s];if(u.kind!==this.kind_&&u.mode==="showing"){a=!0;break}}a?this.disable():this.enable()},r.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildWrapperCSSClass.call(this)},i}(Kr);Ra.prototype.kind_="descriptions",Ra.prototype.controlText_="Descriptions",oe.registerComponent("DescriptionsButton",Ra);var La=function(t){function i(e,n,a){return t.call(this,e,n,a)||this}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildWrapperCSSClass.call(this)},i}(Kr);La.prototype.kind_="subtitles",La.prototype.controlText_="Subtitles",oe.registerComponent("SubtitlesButton",La);var Oa=function(t){function i(r,e){var n;return e.track={player:r,kind:e.kind,label:e.kind+" settings",selectable:!1,default:!1,mode:"disabled"},e.selectable=!1,e.name="CaptionSettingsMenuItem",(n=t.call(this,r,e)||this).addClass("vjs-texttrack-settings"),n.controlText(", opens "+e.kind+" settings dialog"),n}return ye(i,t),i.prototype.handleClick=function(r){this.player().getChild("textTrackSettings").open()},i}(gi);oe.registerComponent("CaptionSettingsMenuItem",Oa);var Ia=function(t){function i(e,n,a){return t.call(this,e,n,a)||this}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-captions-button "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Oa(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),t.prototype.createItems.call(this,e)},i}(Kr);Ia.prototype.kind_="captions",Ia.prototype.controlText_="Captions",oe.registerComponent("CaptionsButton",Ia);var yu=function(t){function i(){return t.apply(this,arguments)||this}return ye(i,t),i.prototype.createEl=function(r,e,n){var a='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return this.options_.track.kind==="captions"&&(a+=`
        <span aria-hidden="true" class="vjs-icon-placeholder"></span>
        <span class="vjs-control-text"> `+this.localize("Captions")+`</span>
      `),a+="</span>",t.prototype.createEl.call(this,r,T({innerHTML:a},e),n)},i}(gi);oe.registerComponent("SubsCapsMenuItem",yu);var xa=function(t){function i(e,n){var a;return n===void 0&&(n={}),(a=t.call(this,e,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(a.player_.language_)>-1&&(a.label_="captions"),a.menuButton_.controlText(ut(a.label_)),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Oa(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=t.prototype.createItems.call(this,e,yu)},i}(Kr);xa.prototype.kinds_=["captions","subtitles"],xa.prototype.controlText_="Subtitles",oe.registerComponent("SubsCapsButton",xa);var _u=function(t){function i(e,n){var a,s=n.track,o=e.audioTracks();n.label=s.label||s.language||"Unknown",n.selected=s.enabled,(a=t.call(this,e,n)||this).track=s,a.addClass("vjs-"+s.kind+"-menu-item");var u=function(){for(var v=arguments.length,C=new Array(v),k=0;k<v;k++)C[k]=arguments[k];a.handleTracksChange.apply(Me(a),C)};return o.addEventListener("change",u),a.on("dispose",function(){o.removeEventListener("change",u)}),a}ye(i,t);var r=i.prototype;return r.createEl=function(e,n,a){var s='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return this.options_.track.kind==="main-desc"&&(s+=`
        <span aria-hidden="true" class="vjs-icon-placeholder"></span>
        <span class="vjs-control-text"> `+this.localize("Descriptions")+`</span>
      `),s+="</span>",t.prototype.createEl.call(this,e,T({innerHTML:s},n),a)},r.handleClick=function(e){var n=this.player_.audioTracks();t.prototype.handleClick.call(this,e);for(var a=0;a<n.length;a++){var s=n[a];s.enabled=s===this.track}},r.handleTracksChange=function(e){this.selected(this.track.enabled)},i}(mi);oe.registerComponent("AudioTrackMenuItem",_u);var bu=function(t){function i(e,n){return n===void 0&&(n={}),n.tracks=e.audioTracks(),t.call(this,e,n)||this}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-audio-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-audio-button "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(e){e===void 0&&(e=[]),this.hideThreshold_=1;for(var n=this.player_.audioTracks(),a=0;a<n.length;a++){var s=n[a];e.push(new _u(this.player_,{track:s,selectable:!0,multiSelectable:!1}))}return e},i}(Pa);bu.prototype.controlText_="Audio Track",oe.registerComponent("AudioTrackButton",bu);var Da=function(t){function i(e,n){var a,s=n.rate,o=parseFloat(s,10);return n.label=s,n.selected=o===1,n.selectable=!0,n.multiSelectable=!1,(a=t.call(this,e,n)||this).label=s,a.rate=o,a.on(e,"ratechange",a.update),a}ye(i,t);var r=i.prototype;return r.handleClick=function(e){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},r.update=function(e){this.selected(this.player().playbackRate()===this.rate)},i}(mi);Da.prototype.contentElType="button",oe.registerComponent("PlaybackRateMenuItem",Da);var Tu=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).updateVisibility(),a.updateLabel(),a.on(e,"loadstart",a.updateVisibility),a.on(e,"ratechange",a.updateLabel),a}ye(i,t);var r=i.prototype;return r.createEl=function(){var e=t.prototype.createEl.call(this);return this.labelEl_=U("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},r.dispose=function(){this.labelEl_=null,t.prototype.dispose.call(this)},r.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildWrapperCSSClass.call(this)},r.createMenu=function(){var e=new Ca(this.player()),n=this.playbackRates();if(n)for(var a=n.length-1;a>=0;a--)e.addChild(new Da(this.player(),{rate:n[a]+"x"}));return e},r.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},r.handleClick=function(e){for(var n=this.player().playbackRate(),a=this.playbackRates(),s=a[0],o=0;o<a.length;o++)if(a[o]>n){s=a[o];break}this.player().playbackRate(s)},r.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},r.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},r.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},r.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},i}(wa);Tu.prototype.controlText_="Playback Rate",oe.registerComponent("PlaybackRateMenuButton",Tu);var Su=function(t){function i(){return t.apply(this,arguments)||this}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},i}(oe);oe.registerComponent("Spacer",Su);var ef=function(t){function i(){return t.apply(this,arguments)||this}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},r.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML="\xA0",e},i}(Su);oe.registerComponent("CustomControlSpacer",ef);var Ki=function(t){function i(){return t.apply(this,arguments)||this}return ye(i,t),i.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},i}(oe);Ki.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in q&&Ki.prototype.options_.children.splice(Ki.prototype.options_.children.length-1,0,"pictureInPictureToggle"),oe.registerComponent("ControlBar",Ki);var ku=function(t){function i(e,n){var a;return(a=t.call(this,e,n)||this).on(e,"error",a.open),a}ye(i,t);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-error-display "+t.prototype.buildCSSClass.call(this)},r.content=function(){var e=this.player().error();return e?this.localize(e.message):""},i}(Fr);ku.prototype.options_=Qe(Fr.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),oe.registerComponent("ErrorDisplay",ku);var Eu=["#000","Black"],Cu=["#00F","Blue"],wu=["#0FF","Cyan"],Pu=["#0F0","Green"],Au=["#F0F","Magenta"],Ru=["#F00","Red"],Lu=["#FFF","White"],Ou=["#FF0","Yellow"],Ma=["1","Opaque"],Ua=["0.5","Semi-Transparent"],Iu=["0","Transparent"],Ar={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Eu,Lu,Ru,Pu,Cu,Ou,Au,wu]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Ma,Ua,Iu]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Lu,Eu,Ru,Pu,Cu,Ou,Au,wu]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(t){return t==="1.00"?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ma,Ua]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Iu,Ua,Ma]}};function xu(t,i){if(i&&(t=i(t)),t&&t!=="none")return t}Ar.windowColor.options=Ar.backgroundColor.options;var tf=function(t){function i(e,n){var a;return n.temporary=!1,(a=t.call(this,e,n)||this).updateDisplay=je(Me(a),a.updateDisplay),a.fill(),a.hasBeenOpened_=a.hasBeenFilled_=!0,a.endDialog=U("p",{className:"vjs-control-text",textContent:a.localize("End of dialog window.")}),a.el().appendChild(a.endDialog),a.setDefaults(),n.persistTextTrackSettings===void 0&&(a.options_.persistTextTrackSettings=a.options_.playerOptions.persistTextTrackSettings),a.on(a.$(".vjs-done-button"),"click",function(){a.saveSettings(),a.close()}),a.on(a.$(".vjs-default-button"),"click",function(){a.setDefaults(),a.updateDisplay()}),c(Ar,function(s){a.on(a.$(s.selector),"change",a.updateDisplay)}),a.options_.persistTextTrackSettings&&a.restoreSettings(),a}ye(i,t);var r=i.prototype;return r.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},r.createElSelect_=function(e,n,a){var s=this;n===void 0&&(n=""),a===void 0&&(a="label");var o=Ar[e],u=o.id.replace("%s",this.id_),v=[n,u].join(" ").trim();return["<"+a+' id="'+u+'" class="'+(a==="label"?"vjs-label":"")+'">',this.localize(o.label),"</"+a+">",'<select aria-labelledby="'+v+'">'].concat(o.options.map(function(C){var k=u+"-"+C[1].replace(/\W+/g,"");return['<option id="'+k+'" value="'+C[0]+'" ','aria-labelledby="'+v+" "+k+'">',s.localize(C[1]),"</option>"].join("")})).concat("</select>").join("")},r.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},r.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},r.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},r.createElColors_=function(){return U("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return U("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},r.createElControls_=function(){var e=this.localize("restore all settings to the default values");return U("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var e,n,a,s=this;return e=Ar,n=function(o,u,v){var C,k,M=(C=s.$(u.selector),k=u.parser,xu(C.options[C.options.selectedIndex].value,k));return M!==void 0&&(o[v]=M),o},(a={})===void 0&&(a=0),m(e).reduce(function(o,u){return n(o,e[u],u)},a)},r.setValues=function(e){var n=this;c(Ar,function(a,s){(function(o,u,v){if(u){for(var C=0;C<o.options.length;C++)if(xu(o.options[C].value,v)===u){o.selectedIndex=C;break}}})(n.$(a.selector),e[s],a.parser)})},r.setDefaults=function(){var e=this;c(Ar,function(n){var a=n.hasOwnProperty("default")?n.default:0;e.$(n.selector).selectedIndex=a})},r.restoreSettings=function(){var e;try{e=JSON.parse(L.localStorage.getItem("vjs-text-track-settings"))}catch(n){b.warn(n)}e&&this.setValues(e)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?L.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e)):L.localStorage.removeItem("vjs-text-track-settings")}catch(n){b.warn(n)}}},r.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,n=e&&e.subsCapsButton,a=e&&e.captionsButton;n?n.focus():a&&a.focus()},i}(Fr);oe.registerComponent("TextTrackSettings",tf);var rf=function(t){function i(e,n){var a,s=n.ResizeObserver||L.ResizeObserver;n.ResizeObserver===null&&(s=!1);var o=Qe({createEl:!s,reportTouchActivity:!1},n);return(a=t.call(this,e,o)||this).ResizeObserver=n.ResizeObserver||L.ResizeObserver,a.loadListener_=null,a.resizeObserver_=null,a.debouncedHandler_=Pd(function(){a.resizeHandler()},100,!1,Me(a)),s?(a.resizeObserver_=new a.ResizeObserver(a.debouncedHandler_),a.resizeObserver_.observe(e.el())):(a.loadListener_=function(){if(a.el_&&a.el_.contentWindow){var u=a.debouncedHandler_,v=a.unloadListener_=function(){qe(this,"resize",u),qe(this,"unload",v),v=null};Xe(a.el_.contentWindow,"unload",v),Xe(a.el_.contentWindow,"resize",u)}},a.one("load",a.loadListener_)),a}ye(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,t.prototype.dispose.call(this)},i}(oe);oe.registerComponent("ResizeManager",rf);var nf=function(t){function i(e,n){var a,s=Qe({createEl:!1},n);return(a=t.call(this,e,s)||this).reset_(),a.on(a.player_,"durationchange",a.handleDurationchange),zn&&"hidden"in q&&"visibilityState"in q&&a.on(q,"visibilitychange",a.handleVisibilityChange),a}ye(i,t);var r=i.prototype;return r.handleVisibilityChange=function(){this.player_.duration()===1/0&&(q.hidden?this.stopTracking():this.startTracking())},r.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var e=this.liveCurrentTime(),n=this.player_.currentTime(),a=this.seekableIncrement_;return e!==1/0&&e-(2*a+.07)>=n},r.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(e&&e.length){var n=this.seekableEnd();n!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrement_=Math.abs(n-this.lastSeekEnd_)),this.pastSeekEnd_=0,this.lastSeekEnd_=n,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},r.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},r.startTracking=function(){var e=this;this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.timeupdateSeen_||(this.one(this.player_,"play",this.handlePlay),this.handleTimeupdate=function(){e.timeupdateSeen_=!0,e.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},r.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},r.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},r.stopTracking=function(){this.isTracking()&&this.reset_()},r.seekableEnd=function(){for(var e=this.player_.seekable(),n=[],a=e?e.length:0;a--;)n.push(e.end(a));return n.length?n.sort()[n.length-1]:1/0},r.seekableStart=function(){for(var e=this.player_.seekable(),n=[],a=e?e.length:0;a--;)n.push(e.start(a));return n.length?n.sort()[0]:0},r.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},r.isLive=function(){return this.isTracking()},r.atLiveEdge=function(){return!this.behindLiveEdge()},r.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},r.pastSeekEnd=function(){return this.pastSeekEnd_},r.behindLiveEdge=function(){return this.behindLiveEdge_},r.isTracking=function(){return typeof this.trackingInterval_=="number"},r.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},r.dispose=function(){this.stopTracking(),t.prototype.dispose.call(this)},i}(oe);oe.registerComponent("LiveTracker",nf);var ja=function(t){var i=t.el();if(i.hasAttribute("src"))return t.triggerSourceset(i.src),!0;var r=t.$$("source"),e=[],n="";if(!r.length)return!1;for(var a=0;a<r.length;a++){var s=r[a].src;s&&e.indexOf(s)===-1&&e.push(s)}return!!e.length&&(e.length===1&&(n=e[0]),t.triggerSourceset(n),!0)},af=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(t){var i=q.createElement(this.nodeName.toLowerCase());i.innerHTML=t;for(var r=q.createDocumentFragment();i.childNodes.length;)r.appendChild(i.childNodes[0]);return this.innerText="",L.Element.prototype.appendChild.call(this,r),this.innerHTML}}),Du=function(t,i){for(var r={},e=0;e<t.length&&!((r=Object.getOwnPropertyDescriptor(t[e],i))&&r.set&&r.get);e++);return r.enumerable=!0,r.configurable=!0,r},Mu=function(t){var i=t.el();if(!i.resetSourceWatch_){var r={},e=function(a){return Du([a.el(),L.HTMLMediaElement.prototype,L.Element.prototype,af],"innerHTML")}(t),n=function(a){return function(){for(var s=arguments.length,o=new Array(s),u=0;u<s;u++)o[u]=arguments[u];var v=a.apply(i,o);return ja(t),v}};["append","appendChild","insertAdjacentHTML"].forEach(function(a){i[a]&&(r[a]=i[a],i[a]=n(r[a]))}),Object.defineProperty(i,"innerHTML",Qe(e,{set:n(e.set)})),i.resetSourceWatch_=function(){i.resetSourceWatch_=null,Object.keys(r).forEach(function(a){i[a]=r[a]}),Object.defineProperty(i,"innerHTML",e)},t.one("sourceset",i.resetSourceWatch_)}},sf=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?To(L.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return L.Element.prototype.setAttribute.call(this,"src",t),t}}),of=function(t){if(t.featuresSourceset){var i=t.el();if(!i.resetSourceset_){var r=function(a){return Du([a.el(),L.HTMLMediaElement.prototype,sf],"src")}(t),e=i.setAttribute,n=i.load;Object.defineProperty(i,"src",Qe(r,{set:function(a){var s=r.set.call(i,a);return t.triggerSourceset(i.src),s}})),i.setAttribute=function(a,s){var o=e.call(i,a,s);return/src/i.test(a)&&t.triggerSourceset(i.src),o},i.load=function(){var a=n.call(i);return ja(t)||(t.triggerSourceset(""),Mu(t)),a},i.currentSrc?t.triggerSourceset(i.currentSrc):ja(t)||Mu(t),i.resetSourceset_=function(){i.resetSourceset_=null,i.load=n,i.setAttribute=e,Object.defineProperty(i,"src",r),i.resetSourceWatch_&&i.resetSourceWatch_()}}}},pe=function(t){function i(e,n){var a;a=t.call(this,e,n)||this;var s=e.source,o=!1;if(s&&(a.el_.currentSrc!==s.src||e.tag&&e.tag.initNetworkState_===3)?a.setSource(s):a.handleLateInit_(a.el_),e.enableSourceset&&a.setupSourcesetHandling_(),a.el_.hasChildNodes()){for(var u=a.el_.childNodes,v=u.length,C=[];v--;){var k=u[v];k.nodeName.toLowerCase()==="track"&&(a.featuresNativeTextTracks?(a.remoteTextTrackEls().addTrackElement_(k),a.remoteTextTracks().addTrack(k.track),a.textTracks().addTrack(k.track),o||a.el_.hasAttribute("crossorigin")||!Ui(k.src)||(o=!0)):C.push(k))}for(var M=0;M<C.length;M++)a.el_.removeChild(C[M])}return a.proxyNativeTracks_(),a.featuresNativeTextTracks&&o&&b.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),a.restoreMetadataTracksInIOSNativePlayer_(),(ai||Vn||uo)&&e.nativeControlsForTouch===!0&&a.setControls(!0),a.proxyWebkitFullscreen_(),a.triggerReady(),a}ye(i,t);var r=i.prototype;return r.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),i.disposeMediaElement(this.el_),this.options_=null,t.prototype.dispose.call(this)},r.setupSourcesetHandling_=function(){of(this)},r.restoreMetadataTracksInIOSNativePlayer_=function(){var e,n=this.textTracks(),a=function(){e=[];for(var o=0;o<n.length;o++){var u=n[o];u.kind==="metadata"&&e.push({track:u,storedMode:u.mode})}};a(),n.addEventListener("change",a),this.on("dispose",function(){return n.removeEventListener("change",a)});var s=function o(){for(var u=0;u<e.length;u++){var v=e[u];v.track.mode==="disabled"&&v.track.mode!==v.storedMode&&(v.track.mode=v.storedMode)}n.removeEventListener("change",o)};this.on("webkitbeginfullscreen",function(){n.removeEventListener("change",a),n.removeEventListener("change",s),n.addEventListener("change",s)}),this.on("webkitendfullscreen",function(){n.removeEventListener("change",a),n.addEventListener("change",a),n.removeEventListener("change",s)})},r.overrideNative_=function(e,n){var a=this;if(n===this["featuresNative"+e+"Tracks"]){var s=e.toLowerCase();this[s+"TracksListeners_"]&&Object.keys(this[s+"TracksListeners_"]).forEach(function(o){a.el()[s+"Tracks"].removeEventListener(o,a[s+"TracksListeners_"][o])}),this["featuresNative"+e+"Tracks"]=!n,this[s+"TracksListeners_"]=null,this.proxyNativeTracksForType_(s)}},r.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},r.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},r.proxyNativeTracksForType_=function(e){var n=this,a=Ft[e],s=this.el()[a.getterName],o=this[a.getterName]();if(this["featuresNative"+a.capitalName+"Tracks"]&&s&&s.addEventListener){var u={change:function(C){o.trigger({type:"change",target:o,currentTarget:o,srcElement:o})},addtrack:function(C){o.addTrack(C.track)},removetrack:function(C){o.removeTrack(C.track)}},v=function(){for(var C=[],k=0;k<o.length;k++){for(var M=!1,j=0;j<s.length;j++)if(s[j]===o[k]){M=!0;break}M||C.push(o[k])}for(;C.length;)o.removeTrack(C.shift())};this[a.getterName+"Listeners_"]=u,Object.keys(u).forEach(function(C){var k=u[C];s.addEventListener(C,k),n.on("dispose",function(M){return s.removeEventListener(C,k)})}),this.on("loadstart",v),this.on("dispose",function(C){return n.off("loadstart",v)})}},r.proxyNativeTracks_=function(){var e=this;Ft.names.forEach(function(n){e.proxyNativeTracksForType_(n)})},r.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),i.disposeMediaElement(e),e=n}else{e=q.createElement("video");var a=Qe({},this.options_.tag&&de(this.options_.tag));ai&&this.options_.nativeControlsForTouch===!0||delete a.controls,ue(e,T(a,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}this.options_.preload!==void 0&&Te(e,"preload",this.options_.preload);for(var s=["loop","muted","playsinline","autoplay","stretch","fluent"],o=0;o<s.length;o++){var u=s[o],v=this.options_[u];v!==void 0&&(v?Te(e,u,u):he(e,u),e[u]=v)}return e},r.handleLateInit_=function(e){if(e.networkState!==0&&e.networkState!==3){if(e.readyState===0){var n=!1,a=function(){n=!0};this.on("loadstart",a);var s=function(){n||this.trigger("loadstart")};return this.on("loadedmetadata",s),void this.ready(function(){this.off("loadstart",a),this.off("loadedmetadata",s),n||this.trigger("loadstart")})}var o=["loadstart"];o.push("loadedmetadata"),e.readyState>=2&&o.push("loadeddata"),e.readyState>=3&&o.push("canplay"),e.readyState>=4&&o.push("canplaythrough"),this.ready(function(){o.forEach(function(u){this.trigger(u)},this)})}},r.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(n){b(n,"Video is not ready. (Video.js)")}},r.duration=function(){var e=this;return this.el_.duration===1/0&&lr&&sr&&this.el_.currentTime===0?(this.on("timeupdate",function n(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",n))}),NaN):this.el_.duration||NaN},r.width=function(){return this.el_.offsetWidth},r.height=function(){return this.el_.offsetHeight},r.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var n=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},a=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",n),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",a),this.on("dispose",function(){e.off("webkitbeginfullscreen",a),e.off("webkitendfullscreen",n)})}},r.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var e=L.navigator&&L.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},r.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},r.exitFullScreen=function(){this.el_.webkitExitFullScreen()},r.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},r.src=function(e){if(e===void 0)return this.el_.src;this.setSrc(e)},r.reset=function(){i.resetMediaElement(this.el_)},r.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},r.setControls=function(e){this.el_.controls=!!e},r.addTextTrack=function(e,n,a){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,n,a):t.prototype.addTextTrack.call(this,e,n,a)},r.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return t.prototype.createRemoteTextTrack.call(this,e);var n=q.createElement("track");return e.kind&&(n.kind=e.kind),e.label&&(n.label=e.label),(e.language||e.srclang)&&(n.srclang=e.language||e.srclang),e.default&&(n.default=e.default),e.id&&(n.id=e.id),e.src&&(n.src=e.src),n},r.addRemoteTextTrack=function(e,n){var a=t.prototype.addRemoteTextTrack.call(this,e,n);return this.featuresNativeTextTracks&&this.el().appendChild(a),a},r.removeRemoteTextTrack=function(e){if(t.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var n=this.$$("track"),a=n.length;a--;)e!==n[a]&&e!==n[a].track||this.el().removeChild(n[a])},r.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var e={};return this.el().webkitDroppedFrameCount!==void 0&&this.el().webkitDecodedFrameCount!==void 0&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),L.performance&&typeof L.performance.now=="function"?e.creationTime=L.performance.now():L.performance&&L.performance.timing&&typeof L.performance.timing.navigationStart=="number"&&(e.creationTime=L.Date.now()-L.performance.timing.navigationStart),e},i}(Ze);if(p()){pe.TEST_VID=q.createElement("video");var $i=q.createElement("track");$i.kind="captions",$i.srclang="en",$i.label="English",pe.TEST_VID.appendChild($i)}pe.isSupported=function(){try{pe.TEST_VID.volume=.5}catch{return!1}return!(!pe.TEST_VID||!pe.TEST_VID.canPlayType)},pe.canPlayType=function(t){return pe.TEST_VID.canPlayType(t)},pe.canPlaySource=function(t,i){return pe.canPlayType(t.type)},pe.canControlVolume=function(){try{var t=pe.TEST_VID.volume;return pe.TEST_VID.volume=t/2+.1,t!==pe.TEST_VID.volume}catch{return!1}},pe.canMuteVolume=function(){try{var t=pe.TEST_VID.muted;return pe.TEST_VID.muted=!t,pe.TEST_VID.muted?Te(pe.TEST_VID,"muted","muted"):he(pe.TEST_VID,"muted"),t!==pe.TEST_VID.muted}catch{return!1}},pe.canControlPlaybackRate=function(){if(lr&&sr&&co<58)return!1;try{var t=pe.TEST_VID.playbackRate;return pe.TEST_VID.playbackRate=t/2+.1,t!==pe.TEST_VID.playbackRate}catch{return!1}},pe.canOverrideAttributes=function(){try{var t=function(){};Object.defineProperty(q.createElement("video"),"src",{get:t,set:t}),Object.defineProperty(q.createElement("audio"),"src",{get:t,set:t}),Object.defineProperty(q.createElement("video"),"innerHTML",{get:t,set:t}),Object.defineProperty(q.createElement("audio"),"innerHTML",{get:t,set:t})}catch{return!1}return!0},pe.supportsNativeTextTracks=function(){return qn||Kt&&sr},pe.supportsNativeVideoTracks=function(){return!(!pe.TEST_VID||!pe.TEST_VID.videoTracks)},pe.supportsNativeAudioTracks=function(){return!(!pe.TEST_VID||!pe.TEST_VID.audioTracks)},pe.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],pe.prototype.featuresVolumeControl=pe.canControlVolume(),pe.prototype.featuresMuteControl=pe.canMuteVolume(),pe.prototype.featuresPlaybackRate=pe.canControlPlaybackRate(),pe.prototype.featuresSourceset=pe.canOverrideAttributes(),pe.prototype.movingMediaElementInDOM=!Kt,pe.prototype.featuresFullscreenResize=!0,pe.prototype.featuresProgressEvents=!0,pe.prototype.featuresTimeupdateEvents=!0,pe.prototype.featuresNativeTextTracks=pe.supportsNativeTextTracks(),pe.prototype.featuresNativeVideoTracks=pe.supportsNativeVideoTracks(),pe.prototype.featuresNativeAudioTracks=pe.supportsNativeAudioTracks();var Uu=pe.TEST_VID&&pe.TEST_VID.constructor.prototype.canPlayType,uf=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;pe.patchCanPlayType=function(){Gn>=4&&!lo&&!sr&&(pe.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&uf.test(t)?"maybe":Uu.call(this,t)})},pe.unpatchCanPlayType=function(){var t=pe.TEST_VID.constructor.prototype.canPlayType;return pe.TEST_VID.constructor.prototype.canPlayType=Uu,t},pe.patchCanPlayType(),pe.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()}},pe.resetMediaElement=function(t){if(t){for(var i=t.querySelectorAll("source"),r=i.length;r--;)t.removeChild(i[r]);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()}},["muted","defaultMuted","autoplay","stretch","fluent","controls","loop","playsinline"].forEach(function(t){pe.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){pe.prototype["set"+ut(t)]=function(i){this.el_[t]=i,i?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(t){pe.prototype[t]=function(){return this.el_[t]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){pe.prototype["set"+ut(t)]=function(i){this.el_[t]=i}}),["pause","load","play"].forEach(function(t){pe.prototype[t]=function(){return this.el_[t]()}}),Ze.withSourceHandlers(pe),pe.nativeSourceHandler={},pe.nativeSourceHandler.canPlayType=function(t){try{return pe.TEST_VID.canPlayType(t)}catch{return""}},pe.nativeSourceHandler.canHandleSource=function(t,i){if(t.type)return pe.nativeSourceHandler.canPlayType(t.type);if(t.src){var r=ea(t.src);return pe.nativeSourceHandler.canPlayType("video/"+r)}return""},pe.nativeSourceHandler.handleSource=function(t,i,r){i.setSrc(t.src)},pe.nativeSourceHandler.dispose=function(){},pe.registerSourceHandler(pe.nativeSourceHandler),Ze.registerTech("Html5",pe);var ju=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ba={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Na=["tiny","xsmall","small","medium","large","xlarge","huge"],Xi={};Na.forEach(function(t){var i=t.charAt(0)==="x"?"x-"+t.substring(1):t;Xi[t]="vjs-layout-"+i});var lf={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},ft=function(t){function i(e,n,a){var s;if(e.id=e.id||n.id||"vjs_video_"+_e(),(n=T(i.getTagSettings(e),n)).initChildren=!1,n.createEl=!1,n.evented=!1,n.reportTouchActivity=!1,!n.language)if(typeof e.closest=="function"){var o=e.closest("[lang]");o&&o.getAttribute&&(n.language=o.getAttribute("lang"))}else for(var u=e;u&&u.nodeType===1;){if(de(u).hasOwnProperty("lang")){n.language=u.getAttribute("lang");break}u=u.parentNode}if((s=t.call(this,null,n,a)||this).boundDocumentFullscreenChange_=je(Me(s),s.documentFullscreenChange_),s.boundFullWindowOnEscKey_=je(Me(s),s.fullWindowOnEscKey),s.log=_(s.id_),s.fsApi_=Kn,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=e,s.tagAttributes=e&&de(e),s.language(s.options_.language),n.languages){var v={};Object.getOwnPropertyNames(n.languages).forEach(function(M){v[M.toLowerCase()]=n.languages[M]}),s.languages_=v}else s.languages_=i.prototype.options_.languages;s.resetCache_(),s.poster_=n.poster||"",s.controls_=!!n.controls,e.controls=!1,e.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],e.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),n.plugins&&Object.keys(n.plugins).forEach(function(M){if(typeof s[M]!="function")throw new Error('plugin "'+M+'" does not exist')}),s.scrubbing_=!1,s.el_=s.createEl(),Bn(Me(s),{eventBusKey:"el_"}),s.fluid_&&s.on("playerreset",s.updateStyleEl_);var C=Qe(s.options_);n.plugins&&Object.keys(n.plugins).forEach(function(M){s[M](n.plugins[M])}),s.options_.playerOptions=C,s.middleware_=[],s.initChildren(),s.isAudio(e.nodeName.toLowerCase()==="audio"),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),ai&&s.addClass("vjs-touch-enabled"),Kt||s.addClass("vjs-workinghover"),i.players[s.id_]=Me(s);var k=N.split(".")[0];return s.addClass("vjs-v"+k),s.userActive(!0),s.reportUserActivity(),s.one("play",s.listenForUserActivity_),s.on("stageclick",s.handleStageClick_),s.on("keydown",s.handleKeyDown),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s}ye(i,t);var r=i.prototype;return r.dispose=function(){var e=this;this.trigger("dispose"),this.off("dispose"),qe(q,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),qe(q,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),i.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),fa[this.id()]=null,Tt.names.forEach(function(n){var a=Tt[n],s=e[a.getterName]();s&&s.off&&s.off()}),t.prototype.dispose.call(this)},r.createEl=function(){var e,n=this.tag,a=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),s=this.tag.tagName.toLowerCase()==="video-js";a?e=this.el_=n.parentNode:s||(e=this.el_=t.prototype.createEl.call(this,"div"));var o=de(n);if(s){for(e=this.el_=n,n=this.tag=q.createElement("video");e.children.length;)n.appendChild(e.firstChild);z(e,"video-js")||Z(e,"video-js"),e.appendChild(n),a=this.playerElIngest_=e,Object.keys(e).forEach(function(j){n[j]=e[j]})}if(n.setAttribute("tabindex","-1"),o.tabindex="-1",(zn||sr&&fo)&&(n.setAttribute("role","application"),o.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in o&&delete o.width,"height"in o&&delete o.height,Object.getOwnPropertyNames(o).forEach(function(j){s&&j==="class"||e.setAttribute(j,o[j]),s&&n.setAttribute(j,o[j])}),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=e.player=this,this.addClass("vjs-paused"),L.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=Qs("vjs-styles-dimensions");var u=rt(".vjs-styles-defaults"),v=rt("head");v.insertBefore(this.styleEl_,u?u.nextSibling:v.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var C=n.getElementsByTagName("a"),k=0;k<C.length;k++){var M=C.item(k);Z(M,"vjs-hidden"),M.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!a&&n.parentNode.insertBefore(e,n),V(n,e),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=e,e},r.width=function(e){return this.dimension("width",e)},r.height=function(e){return this.dimension("height",e)},r.dimension=function(e,n){var a=e+"_";if(n===void 0)return this[a]||0;if(n==="")return this[a]=void 0,void this.updateStyleEl_();var s=parseFloat(n);isNaN(s)?b.error('Improper value "'+n+'" supplied for for '+e):(this[a]=s,this.updateStyleEl_())},r.fluid=function(e){if(e===void 0)return!!this.fluid_;var n,a;this.fluid_=!!e,Tr(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Tr(n=function(){this.on("playerreset",this.updateStyleEl_)})?a():(n.eventedCallbacks||(n.eventedCallbacks=[]),n.eventedCallbacks.push(a))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},r.fill=function(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},r.aspectRatio=function(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},r.updateStyleEl_=function(){if(L.VIDEOJS_NO_DYNAMIC_STYLE!==!0){var e,n,a,s=(this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),o=s[1]/s[0];e=this.width_!==void 0?this.width_:this.height_!==void 0?this.height_/o:this.videoWidth()||300,n=this.height_!==void 0?this.height_:e*o,a=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(a),Zs(this.styleEl_,`
      .`+a+` {
        width: `+e+`px;
        height: `+n+`px;
      }

      .`+a+`.vjs-fluid {
        padding-top: `+100*o+`%;
      }
    `)}else{var u=typeof this.width_=="number"?this.width_:this.options_.width,v=typeof this.height_=="number"?this.height_:this.options_.height,C=this.tech_&&this.tech_.el();C&&(u>=0&&(C.width=u),v>=0&&(C.height=v))}},r.loadTech_=function(e,n){var a=this;this.tech_&&this.unloadTech_();var s=ut(e),o=e.charAt(0).toLowerCase()+e.slice(1);s!=="Html5"&&this.tag&&(Ze.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=s,this.isReady_=!1;var u={source:n,autoplay:typeof this.autoplay()!="string"&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+o+"_api",playsinline:this.options_.playsinline,stretch:this.options_.stretch,fluent:this.options_.fluent,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Tt.names.forEach(function(C){var k=Tt[C];u[k.getterName]=a[k.privateName]}),T(u,this.options_[s]),T(u,this.options_[o]),T(u,this.options_[e.toLowerCase()]),this.tag&&(u.tag=this.tag),n&&n.src===this.cache_.src&&this.cache_.currentTime>0&&(u.startTime=this.cache_.currentTime);var v=Ze.getTech(e);if(!v)throw new Error("No Tech named '"+s+"' exists! '"+s+"' should be registered using videojs.registerTech()'");this.tech_=new v(u),this.tech_.ready(je(this,this.handleTechReady_),!0),Md(this.textTracksJson_||[],this.tech_),ju.forEach(function(C){a.on(a.tech_,C,a["handleTech"+ut(C)+"_"])}),Object.keys(Ba).forEach(function(C){a.on(a.tech_,C,function(k){a.tech_.playbackRate()===0&&a.tech_.seeking()?a.queuedCallbacks_.push({callback:a["handleTech"+Ba[C]+"_"].bind(a),event:k}):a["handleTech"+Ba[C]+"_"](k)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreentoggle",this.handleTechFullscreenToggle_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||s==="Html5"&&this.tag||V(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},r.unloadTech_=function(){var e=this;Tt.names.forEach(function(n){var a=Tt[n];e[a.privateName]=e[a.getterName]()}),this.textTracksJson_=Dd(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},r.tech=function(e){return e===void 0&&b.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_},r.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},r.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},r.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},r.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.seekingTimer&&(clearTimeout(this.seekingTimer),this.seekingTimer=0),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},r.manualAutoplay_=function(e){var n=this;if(this.tech_&&typeof e=="string"){var a,s=function(){var o=n.muted();n.muted(!0);var u=function(){n.muted(o)};n.playTerminatedQueue_.push(u);var v=n.play();if(oi(v))return v.catch(u)};if(e==="any"&&this.muted()!==!0?oi(a=this.play())&&(a=a.catch(s)):a=e==="muted"&&this.muted()!==!0?s():this.play(),oi(a))return a.then(function(){n.trigger({type:"autoplay-success",autoplay:e})}).catch(function(o){n.trigger({type:"autoplay-failure",autoplay:e})})}},r.updateSourceCaches_=function(e){e===void 0&&(e="");var n=e,a="";typeof n!="string"&&(n=e.src,a=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],n&&!a&&(a=function(M,j){if(!j)return"";if(M.cache_.source.src===j&&M.cache_.source.type)return M.cache_.source.type;var G=M.cache_.sources.filter(function(Y){return Y.src===j});if(G.length)return G[0].type;for(var H=M.$$("source"),K=0;K<H.length;K++){var W=H[K];if(W.type&&W.src&&W.src===j)return W.type}return qi(j)}(this,n)),this.cache_.source=Qe({},e,{src:n,type:a});for(var s=this.cache_.sources.filter(function(M){return M.src&&M.src===n}),o=[],u=this.$$("source"),v=[],C=0;C<u.length;C++){var k=de(u[C]);o.push(k),k.src&&k.src===n&&v.push(k.src)}v.length&&!s.length?this.cache_.sources=o:s.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=n},r.handleTechSourceset_=function(e){var n=this;if(!this.changingSrc_){var a=function(u){return n.updateSourceCaches_(u)},s=this.currentSource().src,o=e.src;s&&!/^blob:/.test(s)&&/^blob:/.test(o)&&(!this.lastSource_||this.lastSource_.tech!==o&&this.lastSource_.player!==s)&&(a=function(){}),a(o),e.src||this.tech_.any(["sourceset","loadstart"],function(u){if(u.type!=="sourceset"){var v=n.techGet("currentSrc");n.lastSource_.tech=v,n.updateSourceCaches_(v)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},r.hasStarted=function(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},r.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},r.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},r.waitingTimer=0,r.seekingTimer=0,r.handleTechWaiting_=function(){var e=this;this.waitingTimer&&clearTimeout(this.waitingTimer),this.waitingTimer=setTimeout(function(){e.addClass("vjs-waiting")},1e3),this.trigger("waiting");var n=this.currentTime();this.on("timeupdate",function a(){e.waitingTimer&&(clearTimeout(e.waitingTimer),e.waitingTimer=0),n!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",a))})},r.handleTechCanPlay_=function(){this.waitingTimer&&(clearTimeout(this.waitingTimer),this.waitingTimer=0),this.removeClass("vjs-waiting"),this.trigger("canplay")},r.handleTechCanPlayThrough_=function(){this.waitingTimer&&(clearTimeout(this.waitingTimer),this.waitingTimer=0),this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},r.handleTechPlaying_=function(){this.waitingTimer&&(clearTimeout(this.waitingTimer),this.waitingTimer=0),this.removeClass("vjs-waiting"),this.trigger("playing")},r.handleTechSeeking_=function(){var e=this;this.seekingTimer&&clearTimeout(this.seekingTimer),this.seekingTimer=setTimeout(function(){e.addClass("vjs-seeking")},1e3),this.trigger("seeking")},r.handleTechSeeked_=function(){this.seekingTimer&&(clearTimeout(this.seekingTimer),this.seekingTimer=0),this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},r.handleTechFirstPlay_=function(){this.options_.starttime&&(b.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},r.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},r.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},r.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},r.handleTechClick_=function(e){He(e)&&this.controls_&&this.paused()},r.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(n){return n.contains(e.target)})||this.options_!==void 0&&this.options_.userActions!==void 0&&this.options_.userActions.doubleClick!==void 0&&this.options_.userActions.doubleClick===!1||(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},r.handleTechTap_=function(){this.userActive(!this.userActive())},r.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},r.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},r.handleTechTouchEnd_=function(e){e.preventDefault()},r.handleStageClick_=function(){this.reportUserActivity()},r.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},r.documentFullscreenChange_=function(e){var n=this.el(),a=q[this.fsApi_.fullscreenElement]===n;!a&&n.matches?a=n.matches(":"+this.fsApi_.fullscreen):!a&&n.msMatchesSelector&&(a=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(a),this.isFullscreen()===!1&&qe(q,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed&&this.trigger("fullscreenchange")},r.handleTechFullscreenChange_=function(e,n){n&&this.isFullscreen(n.isFullscreen),this.trigger("fullscreenchange")},r.handleTechFullscreenToggle_=function(e,n){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()},r.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},r.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},r.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},r.handleTechError_=function(){var e=this.tech_.error();this.error(e)},r.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},r.getCache=function(){return this.cache_},r.resetCache_=function(){this.cache_={currentTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},r.techCall_=function(e,n){this.ready(function(){if(e in Bh)return function(a,s,o,u){return s[o](a.reduce(pa(o),u))}(this.middleware_,this.tech_,e,n);if(e in iu)return ru(this.middleware_,this.tech_,e,n);try{this.tech_&&this.tech_[e](n)}catch(a){throw b(a),a}},!0)},r.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in jh)return function(n,a,s){return n.reduceRight(pa(s),a[s]())}(this.middleware_,this.tech_,e);if(e in iu)return ru(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(n){throw this.tech_[e]===void 0?(b("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",n),n):n.name==="TypeError"?(b("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",n),this.tech_.isReady_=!1,n):(b(n),n)}}},r.play=function(){var e=this,n=this.options_.Promise||L.Promise;return n?new n(function(a){e.play_(a)}):this.play_()},r.play_=function(e){var n=this;e===void 0&&(e=Er),this.playCallbacks_.push(e);var a=!!(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!a)return this.waitToPlay_=function(o){n.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(a||!qn&&!Kt||this.load());var s=this.techGet_("play");s===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(s)},r.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(n){n()})},r.runPlayCallbacks_=function(e){var n=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],n.forEach(function(a){a(e)})},r.pause=function(){this.techCall_("pause")},r.paused=function(){return this.techGet_("paused")!==!1},r.played=function(){return this.techGet_("played")||kr(0,0)},r.scrubbing=function(e){if(e===void 0)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},r.currentTime=function(e){return e!==void 0?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},r.duration=function(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(e)||this.trigger("durationchange"))},r.remainingTime=function(){return this.duration()-this.currentTime()},r.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},r.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=kr(0,0)),e},r.bufferedPercent=function(){return mo(this.buffered(),this.duration())},r.bufferedEnd=function(){var e=this.buffered(),n=this.duration(),a=e.end(e.length-1);return a>n&&(a=n),a},r.volume=function(e){var n;return e!==void 0?(n=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=n,this.techCall_("setVolume",n),void(n>0&&this.lastVolume_(n))):(n=parseFloat(this.techGet_("volume")),isNaN(n)?1:n)},r.muted=function(e){if(e===void 0)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},r.defaultMuted=function(e){return e!==void 0?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},r.lastVolume_=function(e){if(e===void 0||e===0)return this.cache_.lastVolume;this.cache_.lastVolume=e},r.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},r.isFullscreen=function(e){return e!==void 0?(this.isFullscreen_=!!e,void this.toggleFullscreenClass_()):!!this.isFullscreen_},r.requestFullscreen=function(e){var n;this.isFullscreen(!0),this.fsApi_.requestFullscreen?(Xe(q,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed||(n=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(n=e)),Er(this.el_[this.fsApi_.requestFullscreen](n))):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},r.exitFullscreen=function(){this.isFullscreen(!1),this.fsApi_.requestFullscreen?(q.fullscreenElement||q.webkitFullscreenElement||q.mozFullScreenElement||q.msFullscreenElement)&&Er(q[this.fsApi_.exitFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},r.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=q.documentElement.style.overflow,Xe(q,"keydown",this.boundFullWindowOnEscKey_),q.documentElement.style.overflow="hidden",Z(q.body,"vjs-full-window"),this.trigger("enterFullWindow")},r.fullWindowOnEscKey=function(e){Re.isEventKey(e,"Esc")&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},r.exitFullWindow=function(){this.isFullWindow=!1,qe(q,"keydown",this.boundFullWindowOnEscKey_),q.documentElement.style.overflow=this.docOrigOverflow,te(q.body,"vjs-full-window"),this.trigger("exitFullWindow")},r.isInPictureInPicture=function(e){return e!==void 0?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},r.requestPictureInPicture=function(){if("pictureInPictureEnabled"in q)return this.techGet_("requestPictureInPicture")},r.exitPictureInPicture=function(){if("pictureInPictureEnabled"in q)return q.exitPictureInPicture()},r.handleKeyDown=function(e){var n=this.options_.userActions;n&&n.hotkeys&&(function(a){var s=a.tagName.toLowerCase();return a.isContentEditable?!0:s==="input"?["button","checkbox","hidden","radio","reset","submit"].indexOf(a.type)===-1:["textarea"].indexOf(s)!==-1}(this.el_.ownerDocument.activeElement)||(typeof n.hotkeys=="function"?n.hotkeys.call(this,e):this.handleHotkeys(e)))},r.handleHotkeys=function(e){var n=this.options_.userActions?this.options_.userActions.hotkeys:{},a=n.fullscreenKey,s=a===void 0?function(M){return Re.isEventKey(M,"f")}:a,o=n.muteKey,u=o===void 0?function(M){return Re.isEventKey(M,"m")}:o,v=n.playPauseKey,C=v===void 0?function(M){return Re.isEventKey(M,"k")||Re.isEventKey(M,"Space")}:v;if(s.call(this,e)){e.preventDefault(),e.stopPropagation();var k=oe.getComponent("FullscreenToggle");q[this.fsApi_.fullscreenEnabled]!==!1&&k.prototype.handleClick.call(this,e)}else u.call(this,e)?(e.preventDefault(),e.stopPropagation(),oe.getComponent("MuteToggle").prototype.handleClick.call(this,e)):C.call(this,e)&&(e.preventDefault(),e.stopPropagation(),oe.getComponent("PlayToggle").prototype.handleClick.call(this,e))},r.canPlayType=function(e){for(var n,a=0,s=this.options_.techOrder;a<s.length;a++){var o=s[a],u=Ze.getTech(o);if(u||(u=oe.getComponent(o)),u){if(u.isSupported()&&(n=u.canPlayType(e)))return n}else b.error('The "'+o+'" tech is undefined. Skipped browser support check for that tech.')}return""},r.selectSource=function(e){var n,a=this,s=this.options_.techOrder.map(function(v){return[v,Ze.getTech(v)]}).filter(function(v){var C=v[0],k=v[1];return k?k.isSupported():(b.error('The "'+C+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),o=function(v,C,k){var M;return v.some(function(j){return C.some(function(G){if(M=k(j,G))return!0})}),M},u=function(v,C){var k=v[0];if(v[1].canPlaySource(C,a.options_[k.toLowerCase()]))return{source:C,tech:k}};return(this.options_.sourceOrder?o(e,s,(n=u,function(v,C){return n(C,v)})):o(s,e,u))||!1},r.src=function(e){var n=this;if(e===void 0)return this.cache_.src||"";var a=function s(o){if(Array.isArray(o)){var u=[];o.forEach(function(v){v=s(v),Array.isArray(v)?u=u.concat(v):S(v)&&u.push(v)}),o=u}else o=typeof o=="string"&&o.trim()?[nu({src:o})]:S(o)&&typeof o.src=="string"&&o.src&&o.src.trim()?[nu(o)]:[];return o}(e);a.length?(this.changingSrc_=!0,this.cache_.sources=a,this.updateSourceCaches_(a[0]),Uh(this,a[0],function(s,o){var u,v;if(n.middleware_=o,n.cache_.sources=a,n.updateSourceCaches_(s),n.src_(s))return a.length>1?n.src(a.slice(1)):(n.changingSrc_=!1,n.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void n.triggerReady());u=o,v=n.tech_,u.forEach(function(C){return C.setTech&&C.setTech(v)})})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},r.src_=function(e){var n,a,s=this,o=this.selectSource([e]);return!o||(n=o.tech,a=this.techName_,ut(n)!==ut(a)?(this.changingSrc_=!0,this.loadTech_(o.tech,o.source),this.tech_.ready(function(){s.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1))},r.load=function(){this.techCall_("load")},r.reset=function(){var e=this,n=this.options_.Promise||L.Promise;this.paused()||!n?this.doReset_():Er(this.play().then(function(){return e.doReset_()}))},r.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Tr(this)&&this.trigger("playerreset")},r.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},r.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,n=e.durationDisplay,a=e.remainingTimeDisplay;n&&n.updateContent(),a&&a.updateContent()},r.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},r.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},r.currentSources=function(){var e=this.currentSource(),n=[];return Object.keys(e).length!==0&&n.push(e),this.cache_.sources||n},r.currentSource=function(){return this.cache_.source||{}},r.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},r.currentType=function(){return this.currentSource()&&this.currentSource().type||""},r.preload=function(e){return e!==void 0?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},r.autoplay=function(e){if(e===void 0)return this.options_.autoplay||!1;var n;typeof e=="string"&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),n=!1):this.options_.autoplay=!!e,n=n===void 0?this.options_.autoplay:n,this.tech_&&this.techCall_("setAutoplay",n)},r.playsinline=function(e){return e!==void 0?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},r.loop=function(e){return e!==void 0?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},r.stretch=function(e){return e!==void 0?(this.techCall_("setStretch",e),void(this.options_.stretch=e)):this.techGet_("stretch")},r.fluent=function(e){return e!=null?(this.techCall_("setFluent",e),this.options_.fluent=e,this):this.techGet_("fluent")},r.poster=function(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},r.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},r.controls=function(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},r.usingNativeControls=function(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},r.error=function(e){if(e===void 0)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&e.message&&e.message===this.localize(this.options_.notSupportedMessage)){var n=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],n),void this.one("loadstart",function(){this.off(["click","touchstart"],n)})}if(e===null)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new bt(e),this.addClass("vjs-error"),b.error("(CODE:"+this.error_.code+" "+bt.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},r.reportUserActivity=function(e){this.userActivity_=!0},r.userActive=function(e){if(e===void 0)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(n){n.stopPropagation(),n.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},r.listenForUserActivity_=function(){var e,n,a,s=je(this,this.reportUserActivity);this.on("mousedown",function(){s(),this.clearInterval(e),e=this.setInterval(s,250)}),this.on("mousemove",function(v){v.screenX===n&&v.screenY===a||(n=v.screenX,a=v.screenY,s())}),this.on("mouseup",function(v){s(),this.clearInterval(e)});var o,u=this.getChild("controlBar");!u||Kt||lr||(u.on("mouseenter",function(v){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),u.on("mouseleave",function(v){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",s),this.on("keyup",s),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(o);var v=this.options_.inactivityTimeout;v<=0||(o=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},v))}},250)},r.playbackRate=function(e){if(e===void 0)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},r.defaultPlaybackRate=function(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},r.isAudio=function(e){if(e===void 0)return!!this.isAudio_;this.isAudio_=!!e},r.addTextTrack=function(e,n,a){if(this.tech_)return this.tech_.addTextTrack(e,n,a)},r.addRemoteTextTrack=function(e,n){if(this.tech_)return this.tech_.addRemoteTextTrack(e,n)},r.removeRemoteTextTrack=function(e){e===void 0&&(e={});var n=e.track;if(n||(n=e),this.tech_)return this.tech_.removeRemoteTextTrack(n)},r.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},r.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},r.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},r.language=function(e){if(e===void 0)return this.language_;this.language_=String(e).toLowerCase()},r.languages=function(){return Qe(i.prototype.options_.languages,this.languages_)},r.toJSON=function(){var e=Qe(this.options_),n=e.tracks;e.tracks=[];for(var a=0;a<n.length;a++){var s=n[a];(s=Qe(s)).player=void 0,e.tracks[a]=s}return e},r.createModal=function(e,n){var a=this;(n=n||{}).content=e||"";var s=new Fr(this,n);return this.addChild(s),s.on("dispose",function(){a.removeChild(s)}),s.open(),s},r.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),n=this.currentWidth(),a=0;a<Na.length;a++){var s=Na[a];if(n<=this.breakpoints_[s]){if(e===s)return;e&&this.removeClass(Xi[e]),this.addClass(Xi[s]),this.breakpoint_=s;break}}},r.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},r.breakpoints=function(e){return e===void 0?T(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=T({},lf,e),this.updateCurrentBreakpoint_(),T(this.breakpoints_))},r.responsive=function(e){return e===void 0?this.responsive_:(e=!!e)!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},r.currentBreakpoint=function(){return this.breakpoint_},r.currentBreakpointClass=function(){return Xi[this.breakpoint_]||""},r.loadMedia=function(e,n){var a=this;if(e&&typeof e=="object"){this.reset(),this.cache_.media=Qe(e);var s=this.cache_.media,o=s.artwork,u=s.poster,v=s.src,C=s.textTracks;!o&&u&&(this.cache_.media.artwork=[{src:u,type:qi(u)}]),v&&this.src(v),u&&this.poster(u),Array.isArray(C)&&C.forEach(function(k){return a.addRemoteTextTrack(k,!1)}),this.ready(n)}},r.getMedia=function(){if(!this.cache_.media){var e=this.poster(),n={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(a){return{kind:a.kind,label:a.label,language:a.language,src:a.src}})};return e&&(n.poster=e,n.artwork=[{src:n.poster,type:qi(n.poster)}]),n}return Qe(this.cache_.media)},i.getTagSettings=function(e){var n={sources:[],tracks:[]},a=de(e),s=a["data-setup"];if(z(e,"vjs-fill")&&(a.fill=!0),z(e,"vjs-fluid")&&(a.fluid=!0),s!==null){var o=xd(s||"{}"),u=o[0],v=o[1];u&&b.error(u),T(a,v)}if(T(n,a),e.hasChildNodes())for(var C=e.childNodes,k=0,M=C.length;k<M;k++){var j=C[k],G=j.nodeName.toLowerCase();G==="source"?n.sources.push(de(j)):G==="track"&&n.tracks.push(de(j))}return n},r.flexNotSupported_=function(){var e=q.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},i}(oe);Tt.names.forEach(function(t){var i=Tt[t];ft.prototype[i.getterName]=function(){return this.tech_?this.tech_[i.getterName]():(this[i.privateName]=this[i.privateName]||new i.ListClass,this[i.privateName])}}),ft.players={};var vi=L.navigator;ft.prototype.options_={techOrder:Ze.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:vi&&(vi.languages&&vi.languages[0]||vi.userLanguage||vi.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(t){ft.prototype[t]=function(){return this.techGet_(t)}}),ju.forEach(function(t){ft.prototype["handleTech"+ut(t)+"_"]=function(){return this.trigger(t)}}),oe.registerComponent("Player",ft);var $r={},Yi=function(t){return $r.hasOwnProperty(t)},Ji=function(t){return Yi(t)?$r[t]:void 0},Bu=function(t,i){t.activePlugins_=t.activePlugins_||{},t.activePlugins_[i]=!0},Qi=function(t,i,r){var e=(r?"before":"")+"pluginsetup";t.trigger(e,i),t.trigger(e+":"+i.name,i)},Nu=function(t,i){return i.prototype.name=t,function(){Qi(this,{name:t,plugin:i,instance:null},!0);for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var a=ao(i,[this].concat(e));return this[t]=function(){return a},Qi(this,a.getEventHash()),a}},nr=function(){function t(r){if(this.constructor===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=r,Bn(this),delete this.trigger,io(this,this.constructor.defaultState),Bu(r,this.name),this.dispose=je(this,this.dispose),r.on("dispose",this.dispose)}var i=t.prototype;return i.version=function(){return this.constructor.VERSION},i.getEventHash=function(r){return r===void 0&&(r={}),r.name=this.name,r.plugin=this.constructor,r.instance=this,r},i.trigger=function(r,e){return e===void 0&&(e={}),ot(this.eventBusEl_,r,this.getEventHash(e))},i.handleStateChanged=function(r){},i.dispose=function(){var r=this.name,e=this.player;this.trigger("dispose"),this.off(),e.off("dispose",this.dispose),e.activePlugins_[r]=!1,this.player=this.state=null,e[r]=Nu(r,$r[r])},t.isBasic=function(r){var e=typeof r=="string"?Ji(r):r;return typeof e=="function"&&!t.prototype.isPrototypeOf(e.prototype)},t.registerPlugin=function(r,e){if(typeof r!="string")throw new Error('Illegal plugin name, "'+r+'", must be a string, was '+typeof r+".");if(Yi(r))b.warn('A plugin named "'+r+'" already exists. You may want to avoid re-registering plugins!');else if(ft.prototype.hasOwnProperty(r))throw new Error('Illegal plugin name, "'+r+'", cannot share a name with an existing player method!');if(typeof e!="function")throw new Error('Illegal plugin for "'+r+'", must be a function, was '+typeof e+".");return $r[r]=e,r!=="plugin"&&(t.isBasic(e)?ft.prototype[r]=function(n,a){var s=function(){Qi(this,{name:n,plugin:a,instance:null},!0);var o=a.apply(this,arguments);return Bu(this,n),Qi(this,{name:n,plugin:a,instance:o}),o};return Object.keys(a).forEach(function(o){s[o]=a[o]}),s}(r,e):ft.prototype[r]=Nu(r,e)),e},t.deregisterPlugin=function(r){if(r==="plugin")throw new Error("Cannot de-register base plugin.");Yi(r)&&(delete $r[r],delete ft.prototype[r])},t.getPlugins=function(r){var e;return r===void 0&&(r=Object.keys($r)),r.forEach(function(n){var a=Ji(n);a&&((e=e||{})[n]=a)}),e},t.getPluginVersion=function(r){var e=Ji(r);return e&&e.VERSION||""},t}();nr.getPlugin=Ji,nr.BASE_PLUGIN_NAME="plugin",nr.registerPlugin("plugin",nr),ft.prototype.usingPlugin=function(t){return!!this.activePlugins_&&this.activePlugins_[t]===!0},ft.prototype.hasPlugin=function(t){return!!Yi(t)};var Fu=function(t){return t.indexOf("#")===0?t.slice(1):t};function J(t,i,r){var e=J.getPlayer(t);if(e)return i&&b.warn('Player "'+t+'" is already initialised. Options will not be applied.'),r&&e.ready(r),e;var n=typeof t=="string"?rt("#"+Fu(t)):t;if(!y(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");n.ownerDocument.defaultView&&n.ownerDocument.body.contains(n)||b.warn("The element supplied is not included in the DOM"),i=i||{},J.hooks("beforesetup").forEach(function(s){var o=s(n,Qe(i));S(o)&&!Array.isArray(o)?i=Qe(i,o):b.error("please return an object in beforesetup hooks")});var a=oe.getComponent("Player");return e=new a(n,i,r),J.hooks("setup").forEach(function(s){return s(e)}),e}if(J.hooks_={},J.hooks=function(t,i){return J.hooks_[t]=J.hooks_[t]||[],i&&(J.hooks_[t]=J.hooks_[t].concat(i)),J.hooks_[t]},J.hook=function(t,i){J.hooks(t,i)},J.hookOnce=function(t,i){J.hooks(t,[].concat(i).map(function(r){return function e(){return J.removeHook(t,e),r.apply(void 0,arguments)}}))},J.removeHook=function(t,i){var r=J.hooks(t).indexOf(i);return!(r<=-1)&&(J.hooks_[t]=J.hooks_[t].slice(),J.hooks_[t].splice(r,1),!0)},L.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&p()){var Zi=rt(".vjs-styles-defaults");if(!Zi){Zi=Qs("vjs-styles-defaults");var Fa=rt("head");Fa&&Fa.insertBefore(Zi,Fa.firstChild),Zs(Zi,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid {
        padding-top: 56.25%
      }
    `)}}Mn(1,J),J.VERSION=N,J.options=ft.prototype.options_,J.getPlayers=function(){return ft.players},J.getPlayer=function(t){var i,r=ft.players;if(typeof t=="string"){var e=Fu(t),n=r[e];if(n)return n;i=rt("#"+e)}else i=t;if(y(i)){var a=i,s=a.player,o=a.playerId;if(s||r[o])return s||r[o]}},J.getAllPlayers=function(){return Object.keys(ft.players).map(function(t){return ft.players[t]}).filter(Boolean)},J.players=ft.players,J.getComponent=oe.getComponent,J.registerComponent=function(t,i){Ze.isTech(i)&&b.warn("The "+t+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),oe.registerComponent.call(oe,t,i)},J.getTech=Ze.getTech,J.registerTech=Ze.registerTech,J.use=function(t,i){Pr[t]=Pr[t]||[],Pr[t].push(i)},Object.defineProperty(J,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(J.middleware,"TERMINATOR",{value:zi,writeable:!1,enumerable:!0}),J.browser=Id,J.TOUCH_ENABLED=ai,J.extend=function(t,i){i===void 0&&(i={});var r=function(){t.apply(this,arguments)},e={};for(var n in typeof i=="object"?(i.constructor!==Object.prototype.constructor&&(r=i.constructor),e=i):typeof i=="function"&&(r=i),function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof s);a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),s&&(a.super_=s)}(r,t),e)e.hasOwnProperty(n)&&(r.prototype[n]=e[n]);return r},J.mergeOptions=Qe,J.bind=je,J.registerPlugin=nr.registerPlugin,J.deregisterPlugin=nr.deregisterPlugin,J.plugin=function(t,i){return b.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),nr.registerPlugin(t,i)},J.getPlugins=nr.getPlugins,J.getPlugin=nr.getPlugin,J.getPluginVersion=nr.getPluginVersion,J.addLanguage=function(t,i){var r;return t=(""+t).toLowerCase(),J.options.languages=Qe(J.options.languages,((r={})[t]=i,r)),J.options.languages[t]},J.log=b,J.createLogger=_,J.createTimeRange=J.createTimeRanges=kr,J.formatTime=qr,J.setFormatTime=function(t){va=t},J.resetFormatTime=function(){va=ou},J.parseUrl=Zn,J.isCrossOrigin=Ui,J.EventTarget=ht,J.on=Xe,J.one=ir,J.off=qe,J.trigger=ot,J.xhr=zo,J.TextTrack=li,J.AudioTrack=$o,J.VideoTrack=Xo,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(t){J[t]=function(){return b.warn("videojs."+t+"() is deprecated; use videojs.dom."+t+"() instead"),re[t].apply(null,arguments)}}),J.computedStyle=g,J.dom=re,J.url=Hd;var Vu=$n(function(t,i){var r,e,n,a,s;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,e=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(o,u,v){if(v=v||{},o=o.trim(),!(u=u.trim())){if(!v.alwaysNormalize)return o;var C=s.parseURL(o);if(!C)throw new Error("Error trying to parse base URL.");return C.path=s.normalizePath(C.path),s.buildURLFromParts(C)}var k=s.parseURL(u);if(!k)throw new Error("Error trying to parse relative URL.");if(k.scheme)return v.alwaysNormalize?(k.path=s.normalizePath(k.path),s.buildURLFromParts(k)):u;var M=s.parseURL(o);if(!M)throw new Error("Error trying to parse base URL.");if(!M.netLoc&&M.path&&M.path[0]!=="/"){var j=e.exec(M.path);M.netLoc=j[1],M.path=j[2]}M.netLoc&&!M.path&&(M.path="/");var G={scheme:M.scheme,netLoc:k.netLoc,path:null,params:k.params,query:k.query,fragment:k.fragment};if(!k.netLoc&&(G.netLoc=M.netLoc,k.path[0]!=="/"))if(k.path){var H=M.path,K=H.substring(0,H.lastIndexOf("/")+1)+k.path;G.path=s.normalizePath(K)}else G.path=M.path,k.params||(G.params=M.params,k.query||(G.query=M.query));return G.path===null&&(G.path=v.alwaysNormalize?s.normalizePath(k.path):k.path),s.buildURLFromParts(G)},parseURL:function(o){var u=r.exec(o);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(o){for(o=o.split("").reverse().join("").replace(n,"");o.length!==(o=o.replace(a,"")).length;);return o.split("").reverse().join("")},buildURLFromParts:function(o){return o.scheme+o.netLoc+o.path+o.params+o.query+o.fragment}},t.exports=s});function Gu(){return(Gu=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t}).apply(this,arguments)}function Va(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i}function Hu(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ga=function(){function t(){this.listeners={}}var i=t.prototype;return i.on=function(r,e){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(e)},i.off=function(r,e){if(!this.listeners[r])return!1;var n=this.listeners[r].indexOf(e);return this.listeners[r].splice(n,1),n>-1},i.trigger=function(r){var e,n,a,s=this.listeners[r];if(s)if(arguments.length===2)for(n=s.length,e=0;e<n;++e)s[e].call(this,arguments[1]);else for(a=Array.prototype.slice.call(arguments,1),n=s.length,e=0;e<n;++e)s[e].apply(this,a)},i.dispose=function(){this.listeners={}},i.pipe=function(r){this.on("data",function(e){r.push(e)})},t}(),cf=function(t){function i(){var r;return(r=t.call(this)||this).buffer="",r}return Va(i,t),i.prototype.push=function(r){var e;for(this.buffer+=r,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)},i}(Ga),yi=function(t){for(var i,r=t.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),e={},n=r.length;n--;)r[n]!==""&&((i=/([^=]*)=(.*)/.exec(r[n]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),e[i[0]]=i[1]);return e},df=function(t){function i(){var e;return(e=t.call(this)||this).customParsers=[],e.tagMappers=[],e}Va(i,t);var r=i.prototype;return r.push=function(e){var n,a,s=this;(e=e.trim()).length!==0&&(e[0]==="#"?this.tagMappers.reduce(function(o,u){var v=u(e);return v===e?o:o.concat([v])},[e]).forEach(function(o){for(var u=0;u<s.customParsers.length;u++)if(s.customParsers[u].call(s,o))return;if(o.indexOf("#EXT")===0)if(o=o.replace("\r",""),n=/^#EXTM3U/.exec(o))s.trigger("data",{type:"tag",tagType:"m3u"});else{if(n=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(o))return a={type:"tag",tagType:"inf"},n[1]&&(a.duration=parseFloat(n[1])),n[2]&&(a.title=n[2]),void s.trigger("data",a);if(n=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(o))return a={type:"tag",tagType:"targetduration"},n[1]&&(a.duration=parseInt(n[1],10)),void s.trigger("data",a);if(n=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(o))return a={type:"tag",tagType:"totalduration"},n[1]&&(a.duration=parseInt(n[1],10)),void s.trigger("data",a);if(n=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(o))return a={type:"tag",tagType:"version"},n[1]&&(a.version=parseInt(n[1],10)),void s.trigger("data",a);if(n=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(o))return a={type:"tag",tagType:"media-sequence"},n[1]&&(a.number=parseInt(n[1],10)),void s.trigger("data",a);if(n=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(o))return a={type:"tag",tagType:"discontinuity-sequence"},n[1]&&(a.number=parseInt(n[1],10)),void s.trigger("data",a);if(n=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(o))return a={type:"tag",tagType:"playlist-type"},n[1]&&(a.playlistType=n[1]),void s.trigger("data",a);if(n=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(o))return a={type:"tag",tagType:"byterange"},n[1]&&(a.length=parseInt(n[1],10)),n[2]&&(a.offset=parseInt(n[2],10)),void s.trigger("data",a);if(n=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(o))return a={type:"tag",tagType:"allow-cache"},n[1]&&(a.allowed=!/NO/.test(n[1])),void s.trigger("data",a);if(n=/^#EXT-X-MAP:?(.*)$/.exec(o)){if(a={type:"tag",tagType:"map"},n[1]){var v=yi(n[1]);if(v.URI&&(a.uri=v.URI),v.BYTERANGE){var C=v.BYTERANGE.split("@"),k=C[0],M=C[1];a.byterange={},k&&(a.byterange.length=parseInt(k,10)),M&&(a.byterange.offset=parseInt(M,10))}}s.trigger("data",a)}else if(n=/^#EXT-X-STREAM-INF:?(.*)$/.exec(o)){if(a={type:"tag",tagType:"stream-inf"},n[1]){if(a.attributes=yi(n[1]),a.attributes.RESOLUTION){var j=a.attributes.RESOLUTION.split("x"),G={};j[0]&&(G.width=parseInt(j[0],10)),j[1]&&(G.height=parseInt(j[1],10)),a.attributes.RESOLUTION=G}a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes["PROGRAM-ID"]&&(a.attributes["PROGRAM-ID"]=parseInt(a.attributes["PROGRAM-ID"],10))}s.trigger("data",a)}else{if(n=/^#EXT-X-MEDIA:?(.*)$/.exec(o))return a={type:"tag",tagType:"media"},n[1]&&(a.attributes=yi(n[1])),void s.trigger("data",a);if(n=/^#EXT-X-ENDLIST/.exec(o))s.trigger("data",{type:"tag",tagType:"endlist"});else if(n=/^#EXT-X-DISCONTINUITY/.exec(o))s.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(n=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(o))return a={type:"tag",tagType:"program-date-time"},n[1]&&(a.dateTimeString=n[1],a.dateTimeObject=new Date(n[1])),void s.trigger("data",a);if(n=/^#EXT-X-KEY:?(.*)$/.exec(o))return a={type:"tag",tagType:"key"},n[1]&&(a.attributes=yi(n[1]),a.attributes.IV&&(a.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(a.attributes.IV=a.attributes.IV.substring(2)),a.attributes.IV=a.attributes.IV.match(/.{8}/g),a.attributes.IV[0]=parseInt(a.attributes.IV[0],16),a.attributes.IV[1]=parseInt(a.attributes.IV[1],16),a.attributes.IV[2]=parseInt(a.attributes.IV[2],16),a.attributes.IV[3]=parseInt(a.attributes.IV[3],16),a.attributes.IV=new Uint32Array(a.attributes.IV))),void s.trigger("data",a);if(n=/^#EXT-X-START:?(.*)$/.exec(o))return a={type:"tag",tagType:"start"},n[1]&&(a.attributes=yi(n[1]),a.attributes["TIME-OFFSET"]=parseFloat(a.attributes["TIME-OFFSET"]),a.attributes.PRECISE=/YES/.test(a.attributes.PRECISE)),void s.trigger("data",a);if(n=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(o))return a={type:"tag",tagType:"cue-out-cont"},n[1]?a.data=n[1]:a.data="",void s.trigger("data",a);if(n=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(o))return a={type:"tag",tagType:"cue-out"},n[1]?a.data=n[1]:a.data="",void s.trigger("data",a);if(n=/^#EXT-X-CUE-IN:?(.*)?$/.exec(o))return a={type:"tag",tagType:"cue-in"},n[1]?a.data=n[1]:a.data="",void s.trigger("data",a);s.trigger("data",{type:"tag",data:o.slice(4)})}}}else s.trigger("data",{type:"comment",text:o.slice(1)})}):this.trigger("data",{type:"uri",uri:e}))},r.addParser=function(e){var n=this,a=e.expression,s=e.customType,o=e.dataParser,u=e.segment;typeof o!="function"&&(o=function(v){return v}),this.customParsers.push(function(v){if(a.exec(v))return n.trigger("data",{type:"custom",data:o(v),customType:s,segment:u}),!0})},r.addTagMapper=function(e){var n=e.expression,a=e.map;this.tagMappers.push(function(s){return n.test(s)?a(s):s})},i}(Ga),zu=function(t){function i(){var e;(e=t.call(this)||this).lineStream=new cf,e.parseStream=new df,e.lineStream.pipe(e.parseStream);var n,a,s=Hu(Hu(e)),o=[],u={},v={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},C=0;return e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},e.parseStream.on("data",function(k){var M,j;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=k.allowed,"allowed"in k||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var G={};"length"in k&&(u.byterange=G,G.length=k.length,"offset"in k||(this.trigger("info",{message:"defaulting offset to zero"}),k.offset=0)),"offset"in k&&(u.byterange=G,G.offset=k.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),k.duration>0&&(u.duration=k.duration),k.duration===0&&(u.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key:function(){k.attributes?k.attributes.METHOD!=="NONE"?k.attributes.URI?(k.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:k.attributes.METHOD||"AES-128",uri:k.attributes.URI},k.attributes.IV!==void 0&&(a.iv=k.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):a=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(k.number)?this.manifest.mediaSequence=k.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+k.number})},"discontinuity-sequence":function(){isFinite(k.number)?(this.manifest.discontinuitySequence=k.number,C=k.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+k.number})},"playlist-type":function(){/VOD|EVENT/.test(k.playlistType)?this.manifest.playlistType=k.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+k.playlist})},map:function(){n={},k.uri&&(n.uri=k.uri),k.byterange&&(n.byterange=k.byterange)},"stream-inf":function(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||v,k.attributes?(u.attributes||(u.attributes={}),Gu(u.attributes,k.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||v,k.attributes&&k.attributes.TYPE&&k.attributes["GROUP-ID"]&&k.attributes.NAME){var G=this.manifest.mediaGroups[k.attributes.TYPE];G[k.attributes["GROUP-ID"]]=G[k.attributes["GROUP-ID"]]||{},M=G[k.attributes["GROUP-ID"]],(j={default:/yes/i.test(k.attributes.DEFAULT)}).default?j.autoselect=!0:j.autoselect=/yes/i.test(k.attributes.AUTOSELECT),k.attributes.LANGUAGE&&(j.language=k.attributes.LANGUAGE),k.attributes.URI&&(j.uri=k.attributes.URI),k.attributes["INSTREAM-ID"]&&(j.instreamId=k.attributes["INSTREAM-ID"]),k.attributes.CHARACTERISTICS&&(j.characteristics=k.attributes.CHARACTERISTICS),k.attributes.FORCED&&(j.forced=/yes/i.test(k.attributes.FORCED)),M[k.attributes.NAME]=j}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){C+=1,u.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function(){this.manifest.dateTimeString===void 0&&(this.manifest.dateTimeString=k.dateTimeString,this.manifest.dateTimeObject=k.dateTimeObject),u.dateTimeString=k.dateTimeString,u.dateTimeObject=k.dateTimeObject},targetduration:function(){!isFinite(k.duration)||k.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+k.duration}):this.manifest.targetDuration=k.duration},totalduration:function(){!isFinite(k.duration)||k.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+k.duration}):this.manifest.totalDuration=k.duration},start:function(){k.attributes&&!isNaN(k.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:k.attributes["TIME-OFFSET"],precise:k.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){u.cueOut=k.data},"cue-out-cont":function(){u.cueOutCont=k.data},"cue-in":function(){u.cueIn=k.data}}[k.tagType]||function(){}).call(s)},uri:function(){u.uri=k.uri,o.push(u),!this.manifest.targetDuration||"duration"in u||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),u.duration=this.manifest.targetDuration),a&&(u.key=a),u.timeline=C,n&&(u.map=n),u={}},comment:function(){},custom:function(){k.segment?(u.custom=u.custom||{},u.custom[k.customType]=k.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[k.customType]=k.data)}})[k.type].call(s)}),e}Va(i,t);var r=i.prototype;return r.push=function(e){this.lineStream.push(e)},r.end=function(){this.lineStream.push(`
`)},r.addParser=function(e){this.parseStream.addParser(e)},r.addTagMapper=function(e){this.parseStream.addTagMapper(e)},i}(Ga),qu=function(t){return!!t&&typeof t=="object"},Mt=function t(){for(var i=arguments.length,r=new Array(i),e=0;e<i;e++)r[e]=arguments[e];return r.reduce(function(n,a){return Object.keys(a).forEach(function(s){Array.isArray(n[s])&&Array.isArray(a[s])?n[s]=n[s].concat(a[s]):qu(n[s])&&qu(a[s])?n[s]=t(n[s],a[s]):n[s]=a[s]}),n},{})},en=function(t){return t.reduce(function(i,r){return i.concat(r)},[])},Wu=function(t){if(!t.length)return[];for(var i=[],r=0;r<t.length;r++)i.push(t[r]);return i},hf="INVALID_NUMBER_OF_PERIOD",ff="DASH_EMPTY_MANIFEST",pf="DASH_INVALID_XML",mf="NO_BASE_URL",gf="SEGMENT_TIME_UNSPECIFIED",vf="UNSUPPORTED_UTC_TIMING_SCHEME",Ha,Ku=(function(t,i){var r,e,n,a,s;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,e=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(o,u,v){if(v=v||{},o=o.trim(),!(u=u.trim())){if(!v.alwaysNormalize)return o;var C=s.parseURL(o);if(!C)throw new Error("Error trying to parse base URL.");return C.path=s.normalizePath(C.path),s.buildURLFromParts(C)}var k=s.parseURL(u);if(!k)throw new Error("Error trying to parse relative URL.");if(k.scheme)return v.alwaysNormalize?(k.path=s.normalizePath(k.path),s.buildURLFromParts(k)):u;var M=s.parseURL(o);if(!M)throw new Error("Error trying to parse base URL.");if(!M.netLoc&&M.path&&M.path[0]!=="/"){var j=e.exec(M.path);M.netLoc=j[1],M.path=j[2]}M.netLoc&&!M.path&&(M.path="/");var G={scheme:M.scheme,netLoc:k.netLoc,path:null,params:k.params,query:k.query,fragment:k.fragment};if(!k.netLoc&&(G.netLoc=M.netLoc,k.path[0]!=="/"))if(k.path){var H=M.path,K=H.substring(0,H.lastIndexOf("/")+1)+k.path;G.path=s.normalizePath(K)}else G.path=M.path,k.params||(G.params=M.params,k.query||(G.query=M.query));return G.path===null&&(G.path=v.alwaysNormalize?s.normalizePath(k.path):k.path),s.buildURLFromParts(G)},parseURL:function(o){var u=r.exec(o);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(o){for(o=o.split("").reverse().join("").replace(n,"");o.length!==(o=o.replace(a,"")).length;);return o.split("").reverse().join("")},buildURLFromParts:function(o){return o.scheme+o.netLoc+o.path+o.params+o.query+o.fragment}},t.exports=s}(Ha={exports:{}},Ha.exports),Ha.exports),za=function(t,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(t)||(t=Ku.buildAbsoluteURL(L.location.href,t)),Ku.buildAbsoluteURL(t,i))},_i=function(t){var i=t.baseUrl,r=i===void 0?"":i,e=t.source,n=e===void 0?"":e,a=t.range,s=a===void 0?"":a,o=t.indexRange,u=o===void 0?"":o,v={uri:n,resolvedUri:za(r||"",n)};if(s||u){var C=(s||u).split("-"),k=parseInt(C[0],10),M=parseInt(C[1],10);v.byterange={length:M-k+1,offset:k}}return v},yf={static:function(t){var i=t.duration,r=t.timescale,e=r===void 0?1:r,n=t.sourceDuration;return{start:0,end:Math.ceil(n/(i/e))}},dynamic:function(t){var i=t.NOW,r=t.clientOffset,e=t.availabilityStartTime,n=t.timescale,a=n===void 0?1:n,s=t.duration,o=t.start,u=o===void 0?0:o,v=t.minimumUpdatePeriod,C=v===void 0?0:v,k=t.timeShiftBufferDepth,M=k===void 0?1/0:k,j=(i+r)/1e3,G=e+u,H=j+C-G,K=Math.ceil(H*a/s),W=Math.floor((j-G-M)*a/s),Y=Math.floor((j-G)*a/s);return{start:Math.max(0,W),end:Math.min(K,Y)}}},qa=function(t){var i=t.type,r=i===void 0?"static":i,e=t.duration,n=t.timescale,a=n===void 0?1:n,s=t.sourceDuration,o=yf[r](t),u=function(C,k){for(var M=[],j=C;j<k;j++)M.push(j);return M}(o.start,o.end).map(function(C){return function(k,M){var j=C.duration,G=C.timescale,H=G===void 0?1:G,K=C.periodIndex,W=C.startNumber;return{number:(W===void 0?1:W)+k,duration:j/H,timeline:K,time:M*j}}}(t));if(r==="static"){var v=u.length-1;u[v].duration=s-e/a*v}return u},$u=function(t){var i=t.baseUrl,r=t.initialization,e=r===void 0?{}:r,n=t.sourceDuration,a=t.timescale,s=a===void 0?1:a,o=t.indexRange,u=o===void 0?"":o,v=t.duration;if(!i)throw new Error(mf);var C=_i({baseUrl:i,source:e.sourceURL,range:e.range}),k=_i({baseUrl:i,source:i,indexRange:u});if(k.map=C,v){var M=qa(t);M.length&&(k.duration=M[0].duration,k.timeline=M[0].timeline)}else n&&(k.duration=n/s,k.timeline=0);return k.number=0,[k]},_f=function(t,i,r){for(var e=t.sidx.map?t.sidx.map:null,n=t.sidx.duration,a=t.timeline||0,s=t.sidx.byterange,o=s.offset+s.length,u=i.timescale,v=i.references.filter(function(W){return W.referenceType!==1}),C=[],k=o+i.firstOffset,M=0;M<v.length;M++){var j=i.references[M],G=j.referencedSize,H=j.subsegmentDuration,K=$u({baseUrl:r,timescale:u,timeline:a,periodIndex:a,duration:H,sourceDuration:n,indexRange:k+"-"+(k+G-1)})[0];e&&(K.map=e),C.push(K),k+=G}return t.segments=C,t},Xu=function(t){var i;return(i=t.reduce(function(r,e){var n,a=e.attributes.id+(e.attributes.lang||"");return r[a]?(e.segments[0]&&(e.segments[0].discontinuity=!0),(n=r[a].segments).push.apply(n,e.segments),e.attributes.contentProtection&&(r[a].attributes.contentProtection=e.attributes.contentProtection)):r[a]=e,r},{}),Object.keys(i).map(function(r){return i[r]})).map(function(r){var e,n;return r.discontinuityStarts=(e=r.segments,n="discontinuity",e.reduce(function(a,s,o){return s[n]&&a.push(o),a},[])),r})},Wa=function(t,i){if(i===void 0&&(i={}),!Object.keys(i).length)return t;for(var r in t){var e=t[r];if(e.sidx){var n=e.sidx.uri+"-"+(s=e.sidx.byterange,o=s.offset+s.length-1,s.offset+"-"+o),a=i[n]&&i[n].sidx;e.sidx&&a&&_f(e,a,e.sidx.resolvedUri)}}var s,o;return t},bf=function(t){var i,r=t.attributes,e=t.segments,n=t.sidx,a={attributes:(i={NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(r.type||"static")==="static",timeline:r.periodIndex,resolvedUri:"",targetDuration:r.duration,segments:e,mediaSequence:e.length?e[0].number:1};return r.contentProtection&&(a.contentProtection=r.contentProtection),n&&(a.sidx=n),a},Tf=function(t,i){var r;if(i===void 0&&(i={}),!t.length)return{};var e=t[0].attributes,n=e.sourceDuration,a=e.minimumUpdatePeriod,s=a===void 0?0:a,o=Xu(t.filter(function(k){var M=k.attributes;return M.mimeType==="video/mp4"||M.contentType==="video"})).map(bf),u=Xu(t.filter(function(k){var M=k.attributes;return M.mimeType==="audio/mp4"||M.contentType==="audio"})),v=t.filter(function(k){var M=k.attributes;return M.mimeType==="text/vtt"||M.contentType==="text"}),C={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(r={AUDIO:{},VIDEO:{}},r["CLOSED-CAPTIONS"]={},r.SUBTITLES={},r),uri:"",duration:n,playlists:Wa(o,i),minimumUpdatePeriod:1e3*s};return u.length&&(C.mediaGroups.AUDIO.audio=function(k,M){var j;M===void 0&&(M={});var G=k.reduce(function(H,K){var W=K.attributes.role&&K.attributes.role.value||"",Y=K.attributes.lang||"",ne="main";if(Y){var ie=W?" ("+W+")":"";ne=""+K.attributes.lang+ie}return H[ne]&&H[ne].playlists[0].attributes.BANDWIDTH>K.attributes.bandwidth||(H[ne]={language:Y,autoselect:!0,default:W==="main",playlists:Wa([function(le){var ge,Se=le.attributes,ce=le.segments,Ee=le.sidx,lt={attributes:(ge={NAME:Se.id,BANDWIDTH:Se.bandwidth,CODECS:Se.codecs},ge["PROGRAM-ID"]=1,ge),uri:"",endList:(Se.type||"static")==="static",timeline:Se.periodIndex,resolvedUri:"",targetDuration:Se.duration,segments:ce,mediaSequence:ce.length?ce[0].number:1};return Se.contentProtection&&(lt.contentProtection=Se.contentProtection),Ee&&(lt.sidx=Ee),lt}(K)],M),uri:""},j===void 0&&W==="main"&&((j=K).default=!0)),H},{});return j||(G[Object.keys(G)[0]].default=!0),G}(u,i)),v.length&&(C.mediaGroups.SUBTITLES.subs=function(k,M){return M===void 0&&(M={}),k.reduce(function(j,G){var H,K,W,Y,ne=G.attributes.lang||"text";return j[ne]||(j[ne]={language:ne,default:!1,autoselect:!1,playlists:Wa([(H=G,W=H.attributes,Y=H.segments,Y===void 0&&(Y=[{uri:W.baseUrl,timeline:W.periodIndex,resolvedUri:W.baseUrl||"",duration:W.sourceDuration,number:0}],W.duration=W.sourceDuration),{attributes:(K={NAME:W.id,BANDWIDTH:W.bandwidth},K["PROGRAM-ID"]=1,K),uri:"",endList:(W.type||"static")==="static",timeline:W.periodIndex,resolvedUri:W.baseUrl||"",targetDuration:W.duration,segments:Y,mediaSequence:Y.length?Y[0].number:1})],M),uri:""}),j},{})}(v,i)),C},Sf=function(t,i,r){var e=t.NOW,n=t.clientOffset,a=t.availabilityStartTime,s=t.timescale,o=s===void 0?1:s,u=t.start,v=u===void 0?0:u,C=t.minimumUpdatePeriod,k=(e+n)/1e3+(C===void 0?0:C)-(a+v);return Math.ceil((k*o-i)/r)},Yu=function(t,i){for(var r=t.type,e=r===void 0?"static":r,n=t.minimumUpdatePeriod,a=n===void 0?0:n,s=t.media,o=s===void 0?"":s,u=t.sourceDuration,v=t.timescale,C=v===void 0?1:v,k=t.startNumber,M=k===void 0?1:k,j=t.periodIndex,G=[],H=-1,K=0;K<i.length;K++){var W=i[K],Y=W.d,ne=W.r||0,ie=W.t||0;H<0&&(H=ie),ie&&ie>H&&(H=ie);var le=void 0;if(ne<0){var ge=K+1;le=ge===i.length?e==="dynamic"&&a>0&&o.indexOf("$Number$")>0?Sf(t,H,Y):(u*C-H)/Y:(i[ge].t-H)/Y}else le=ne+1;for(var Se=M+G.length+le,ce=M+G.length;ce<Se;)G.push({number:ce,duration:Y/C,time:H,timeline:j}),H+=Y,ce++}return G},kf=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Ju=function(t,i){return t.replace(kf,function(r){return function(e,n,a,s){if(e==="$$")return"$";if(r[n]===void 0)return e;var o=""+r[n];return n==="RepresentationID"?o:(s=a?parseInt(s,10):1,o.length>=s?o:""+new Array(s-o.length+1).join("0")+o)}}(i))},Ef=function(t,i){var r={RepresentationID:t.id,Bandwidth:t.bandwidth||0},e=t.initialization,n=e===void 0?{sourceURL:"",range:""}:e,a=_i({baseUrl:t.baseUrl,source:Ju(n.sourceURL,r),range:n.range});return function(s,o){return s.duration||o?s.duration?qa(s):Yu(s,o):[{number:s.startNumber||1,duration:s.sourceDuration,time:0,timeline:s.periodIndex}]}(t,i).map(function(s){r.Number=s.number,r.Time=s.time;var o=Ju(t.media||"",r);return{uri:o,timeline:s.timeline,duration:s.duration,resolvedUri:za(t.baseUrl||"",o),map:a,number:s.number}})},Cf=function(t,i){var r=t.duration,e=t.segmentUrls,n=e===void 0?[]:e;if(!r&&!i||r&&i)throw new Error(gf);var a,s=n.map(function(o){return function(u,v){var C=u.baseUrl,k=u.initialization,M=k===void 0?{}:k,j=_i({baseUrl:C,source:M.sourceURL,range:M.range}),G=_i({baseUrl:C,source:v.media,range:v.mediaRange});return G.map=j,G}(t,o)});return r&&(a=qa(t)),i&&(a=Yu(t,i)),a.map(function(o,u){if(s[u]){var v=s[u];return v.timeline=o.timeline,v.duration=o.duration,v.number=o.number,v}}).filter(function(o){return o})},wf=function(t){var i,r,e=t.attributes,n=t.segmentInfo;n.template?(r=Ef,i=Mt(e,n.template)):n.base?(r=$u,i=Mt(e,n.base)):n.list&&(r=Cf,i=Mt(e,n.list));var a={attributes:e};if(!r)return a;var s=r(i,n.timeline);if(i.duration){var o=i,u=o.duration,v=o.timescale,C=v===void 0?1:v;i.duration=u/C}else s.length?i.duration=s.reduce(function(k,M){return Math.max(k,Math.ceil(M.duration))},0):i.duration=0;return a.attributes=i,a.segments=s,n.base&&i.indexRange&&(a.sidx=s[0],a.segments=[]),a},pt=function(t,i){return Wu(t.childNodes).filter(function(r){return r.tagName===i})},Qu=function(t){return t.textContent.trim()},bi=function(t){var i=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(t);if(!i)return 0;var r=i.slice(1),e=r[0],n=r[1],a=r[2],s=r[3],o=r[4],u=r[5];return 31536e3*parseFloat(e||0)+2592e3*parseFloat(n||0)+86400*parseFloat(a||0)+3600*parseFloat(s||0)+60*parseFloat(o||0)+parseFloat(u||0)},Zu={mediaPresentationDuration:function(t){return bi(t)},availabilityStartTime:function(t){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(i=t)&&(i+="Z"),Date.parse(i)/1e3;var i},minimumUpdatePeriod:function(t){return bi(t)},timeShiftBufferDepth:function(t){return bi(t)},start:function(t){return bi(t)},width:function(t){return parseInt(t,10)},height:function(t){return parseInt(t,10)},bandwidth:function(t){return parseInt(t,10)},startNumber:function(t){return parseInt(t,10)},timescale:function(t){return parseInt(t,10)},duration:function(t){var i=parseInt(t,10);return isNaN(i)?bi(t):i},d:function(t){return parseInt(t,10)},t:function(t){return parseInt(t,10)},r:function(t){return parseInt(t,10)},DEFAULT:function(t){return t}},kt=function(t){return t&&t.attributes?Wu(t.attributes).reduce(function(i,r){var e=Zu[r.name]||Zu.DEFAULT;return i[r.name]=e(r.value),i},{}):{}},Xt,Ka,Pt,el,Be,tl,rl,il,nl,al,sl,$a,ol,ul,ll,cl,dl,hl,fl,pl,ml,gl,vl,yl,Xa,Ue,Ya,_l,bl,Tl,Sl,kl,El,Cl,wl,tn,Pl,Al,Rl,Ll,Ol,Il,xl,Ja,Pf={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},rn=function(t,i){return i.length?en(t.map(function(r){return i.map(function(e){return za(r,Qu(e))})})):t},Qa=function(t){var i=pt(t,"SegmentTemplate")[0],r=pt(t,"SegmentList")[0],e=r&&pt(r,"SegmentURL").map(function(k){return Mt({tag:"SegmentURL"},kt(k))}),n=pt(t,"SegmentBase")[0],a=r||i,s=a&&pt(a,"SegmentTimeline")[0],o=r||n||i,u=o&&pt(o,"Initialization")[0],v=i&&kt(i);v&&u?v.initialization=u&&kt(u):v&&v.initialization&&(v.initialization={sourceURL:v.initialization});var C={template:v,timeline:s&&pt(s,"S").map(function(k){return kt(k)}),list:r&&Mt(kt(r),{segmentUrls:e,initialization:kt(u)}),base:n&&Mt(kt(n),{initialization:kt(u)})};return Object.keys(C).forEach(function(k){C[k]||delete C[k]}),C},Af=function(t){return t.reduce(function(i,r){var e=kt(r),n=Pf[e.schemeIdUri];if(n){i[n]={attributes:e};var a=pt(r,"cenc:pssh")[0];if(a){var s=Qu(a),o=s&&function(u){for(var v=L.atob(u),C=new Uint8Array(v.length),k=0;k<v.length;k++)C[k]=v.charCodeAt(k);return C}(s);i[n].pssh=o}}return i},{})},Rf=function(t,i,r){return function(e){var n=kt(e),a=rn(i,pt(e,"BaseURL")),s=pt(e,"Role")[0],o={role:kt(s)},u=Mt(t,n,o),v=Af(pt(e,"ContentProtection"));Object.keys(v).length&&(u=Mt(u,{contentProtection:v}));var C=Qa(e),k=pt(e,"Representation"),M=Mt(r,C);return en(k.map(function(j,G,H){return function(K){var W=pt(K,"BaseURL"),Y=rn(G,W),ne=Mt(j,kt(K)),ie=Qa(K);return Y.map(function(le){return{segmentInfo:Mt(H,ie),attributes:Mt(ne,{baseUrl:le})}})}}(u,a,M)))}},Lf=function(t,i){i===void 0&&(i={});var r=i,e=r.manifestUri,n=e===void 0?"":e,a=r.NOW,s=a===void 0?Date.now():a,o=r.clientOffset,u=o===void 0?0:o,v=pt(t,"Period");if(!v.length)throw new Error(hf);var C=kt(t),k=rn([n],pt(t,"BaseURL"));return C.sourceDuration=C.mediaPresentationDuration||0,C.NOW=s,C.clientOffset=u,en(v.map(function(M,j){return function(G,H){var K=rn(j,pt(G,"BaseURL")),W=kt(G),Y=parseInt(W.id,10),ne=L.isNaN(Y)?H:Y,ie=Mt(M,{periodIndex:ne}),le=pt(G,"AdaptationSet"),ge=Qa(G);return en(le.map(Rf(ie,K,ge)))}}(C,k)))},Dl=function(t){if(t==="")throw new Error(ff);var i=new L.DOMParser().parseFromString(t,"application/xml"),r=i&&i.documentElement.tagName==="MPD"?i.documentElement:null;if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(pf);return r},Ml=function(t,i){return i===void 0&&(i={}),Tf(Lf(Dl(t),i).map(wf),i.sidxMapping)},Of=function(t){return function(i){var r=pt(i,"UTCTiming")[0];if(!r)return null;var e=kt(r);switch(e.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":e.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":e.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":e.method="DIRECT",e.value=Date.parse(e.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(vf)}return e}(Dl(t))},Xr=function(t){return t>>>0},Yt={findBox:Xt=function(t,i){var r,e,n,a,s,o=[];if(!i.length)return null;for(r=0;r<t.byteLength;)e=Xr(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]),n=Ka(t.subarray(r+4,r+8)),a=e>1?r+e:t.byteLength,n===i[0]&&(i.length===1?o.push(t.subarray(r+8,a)):(s=Xt(t.subarray(r+8,a),i.slice(1))).length&&(o=o.concat(s))),r=a;return o},parseType:Ka=function(t){var i="";return i+=String.fromCharCode(t[0]),i+=String.fromCharCode(t[1]),i+=String.fromCharCode(t[2]),i+=String.fromCharCode(t[3])},timescale:function(t){return Xt(t,["moov","trak"]).reduce(function(i,r){var e,n,a,s,o;return(e=Xt(r,["tkhd"])[0])?(n=e[0],s=Xr(e[a=n===0?12:20]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]),(o=Xt(r,["mdia","mdhd"])[0])?(a=(n=o[0])===0?12:20,i[s]=Xr(o[a]<<24|o[a+1]<<16|o[a+2]<<8|o[a+3]),i):null):null},{})},startTime:function(t,i){var r,e,n;return r=Xt(i,["moof","traf"]),e=[].concat.apply([],r.map(function(a){return Xt(a,["tfhd"]).map(function(s){var o,u;return o=Xr(s[4]<<24|s[5]<<16|s[6]<<8|s[7]),u=t[o]||9e4,(Xt(a,["tfdt"]).map(function(v){var C,k;return C=v[0],k=Xr(v[4]<<24|v[5]<<16|v[6]<<8|v[7]),C===1&&(k*=Math.pow(2,32),k+=Xr(v[8]<<24|v[9]<<16|v[10]<<8|v[11])),k})[0]||1/0)/u})})),n=Math.min.apply(null,e),isFinite(n)?n:0},videoTrackIds:function(t){var i=[];return Xt(t,["moov","trak"]).forEach(function(r){var e=Xt(r,["mdia","hdlr"]),n=Xt(r,["tkhd"]);e.forEach(function(a,s){var o,u,v=Ka(a.subarray(8,12)),C=n[s];v==="vide"&&(u=(o=new DataView(C.buffer,C.byteOffset,C.byteLength)).getUint8(0)===0?o.getUint32(12):o.getUint32(20),i.push(u))})}),i}},nn=Yt.parseType,Vt=function(t){return new Date(1e3*t-20828448e5)},Ul=function(t){return{isLeading:(12&t[0])>>>2,dependsOn:3&t[0],isDependedOn:(192&t[1])>>>6,hasRedundancy:(48&t[1])>>>4,paddingValue:(14&t[1])>>>1,isNonSyncSample:1&t[1],degradationPriority:t[2]<<8|t[3]}},Rr={avc1:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:i.getUint16(6),width:i.getUint16(24),height:i.getUint16(26),horizresolution:i.getUint16(28)+i.getUint16(30)/16,vertresolution:i.getUint16(32)+i.getUint16(34)/16,frameCount:i.getUint16(40),depth:i.getUint16(74),config:Pt(t.subarray(78,t.byteLength))}},avcC:function(t){var i,r,e,n,a=new DataView(t.buffer,t.byteOffset,t.byteLength),s={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:3&t[4],sps:[],pps:[]},o=31&t[5];for(e=6,n=0;n<o;n++)r=a.getUint16(e),e+=2,s.sps.push(new Uint8Array(t.subarray(e,e+r))),e+=r;for(i=t[e],e++,n=0;n<i;n++)r=a.getUint16(e),e+=2,s.pps.push(new Uint8Array(t.subarray(e,e+r))),e+=r;return s},btrt:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:i.getUint32(0),maxBitrate:i.getUint32(4),avgBitrate:i.getUint32(8)}},esds:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:31&t[8],decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(7&t[26])<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function(t){for(var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={majorBrand:nn(t.subarray(0,4)),minorVersion:i.getUint32(4),compatibleBrands:[]},e=8;e<t.byteLength;)r.compatibleBrands.push(nn(t.subarray(e,e+4))),e+=4;return r},dinf:function(t){return{boxes:Pt(t)}},dref:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:Pt(t.subarray(8))}},hdlr:function(t){var i={version:new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:nn(t.subarray(8,12)),name:""},r=8;for(r=24;r<t.byteLength;r++){if(t[r]===0){r++;break}i.name+=String.fromCharCode(t[r])}return i.name=decodeURIComponent(escape(i.name)),i},mdat:function(t){return{byteLength:t.byteLength,nals:function(i){var r,e,n=new DataView(i.buffer,i.byteOffset,i.byteLength),a=[];for(r=0;r+4<i.length;r+=e)if(e=n.getUint32(r),r+=4,e<=0)a.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&i[r]){case 1:a.push("slice_layer_without_partitioning_rbsp");break;case 5:a.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:a.push("sei_rbsp");break;case 7:a.push("seq_parameter_set_rbsp");break;case 8:a.push("pic_parameter_set_rbsp");break;case 9:a.push("access_unit_delimiter_rbsp");break;default:a.push("UNKNOWN NAL - "+i[r]&31)}return a}(t)}},mdhd:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e=4,n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};return n.version===1?(e+=4,n.creationTime=Vt(r.getUint32(e)),e+=8,n.modificationTime=Vt(r.getUint32(e)),e+=4,n.timescale=r.getUint32(e),e+=8,n.duration=r.getUint32(e)):(n.creationTime=Vt(r.getUint32(e)),e+=4,n.modificationTime=Vt(r.getUint32(e)),e+=4,n.timescale=r.getUint32(e),e+=4,n.duration=r.getUint32(e)),e+=4,i=r.getUint16(e),n.language+=String.fromCharCode(96+(i>>10)),n.language+=String.fromCharCode(96+((992&i)>>5)),n.language+=String.fromCharCode(96+(31&i)),n},mdia:function(t){return{boxes:Pt(t)}},mfhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function(t){return{boxes:Pt(t)}},mp4a:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r={dataReferenceIndex:i.getUint16(6),channelcount:i.getUint16(16),samplesize:i.getUint16(18),samplerate:i.getUint16(24)+i.getUint16(26)/65536};return t.byteLength>28&&(r.streamDescriptor=Pt(t.subarray(28))[0]),r},moof:function(t){return{boxes:Pt(t)}},moov:function(t){return{boxes:Pt(t)}},mvex:function(t){return{boxes:Pt(t)}},mvhd:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,e={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return e.version===1?(r+=4,e.creationTime=Vt(i.getUint32(r)),r+=8,e.modificationTime=Vt(i.getUint32(r)),r+=4,e.timescale=i.getUint32(r),r+=8,e.duration=i.getUint32(r)):(e.creationTime=Vt(i.getUint32(r)),r+=4,e.modificationTime=Vt(i.getUint32(r)),r+=4,e.timescale=i.getUint32(r),r+=4,e.duration=i.getUint32(r)),r+=4,e.rate=i.getUint16(r)+i.getUint16(r+2)/16,r+=4,e.volume=i.getUint8(r)+i.getUint8(r+1)/8,r+=2,r+=2,r+=8,e.matrix=new Uint32Array(t.subarray(r,r+36)),r+=36,r+=24,e.nextTrackId=i.getUint32(r),e},pdin:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:i.getUint32(4),initialDelay:i.getUint32(8)}},sdtp:function(t){var i,r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]};for(i=4;i<t.byteLength;i++)r.samples.push({dependsOn:(48&t[i])>>4,isDependedOn:(12&t[i])>>2,hasRedundancy:3&t[i]});return r},sidx:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:r.getUint32(4),timescale:r.getUint32(8),earliestPresentationTime:r.getUint32(12),firstOffset:r.getUint32(16)},n=r.getUint16(22);for(i=24;n;i+=12,n--)e.references.push({referenceType:(128&t[i])>>>7,referencedSize:2147483647&r.getUint32(i),subsegmentDuration:r.getUint32(i+4),startsWithSap:!!(128&t[i+8]),sapType:(112&t[i+8])>>>4,sapDeltaTime:268435455&r.getUint32(i+8)});return e},smhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function(t){return{boxes:Pt(t)}},stco:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},n=r.getUint32(4);for(i=8;n;i+=4,n--)e.chunkOffsets.push(r.getUint32(i));return e},stsc:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e=r.getUint32(4),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]};for(i=8;e;i+=12,e--)n.sampleToChunks.push({firstChunk:r.getUint32(i),samplesPerChunk:r.getUint32(i+4),sampleDescriptionIndex:r.getUint32(i+8)});return n},stsd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:Pt(t.subarray(8))}},stsz:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:r.getUint32(4),entries:[]};for(i=12;i<t.byteLength;i+=4)e.entries.push(r.getUint32(i));return e},stts:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},n=r.getUint32(4);for(i=8;n;i+=8,n--)e.timeToSamples.push({sampleCount:r.getUint32(i),sampleDelta:r.getUint32(i+4)});return e},styp:function(t){return Rr.ftyp(t)},tfdt:function(t){var i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};return i.version===1&&(i.baseMediaDecodeTime*=Math.pow(2,32),i.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]),i},tfhd:function(t){var i,r=new DataView(t.buffer,t.byteOffset,t.byteLength),e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4)},n=1&e.flags[2],a=2&e.flags[2],s=8&e.flags[2],o=16&e.flags[2],u=32&e.flags[2],v=65536&e.flags[0],C=131072&e.flags[0];return i=8,n&&(i+=4,e.baseDataOffset=r.getUint32(12),i+=4),a&&(e.sampleDescriptionIndex=r.getUint32(i),i+=4),s&&(e.defaultSampleDuration=r.getUint32(i),i+=4),o&&(e.defaultSampleSize=r.getUint32(i),i+=4),u&&(e.defaultSampleFlags=r.getUint32(i)),v&&(e.durationIsEmpty=!0),!n&&C&&(e.baseDataOffsetIsMoof=!0),e},tkhd:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,e={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return e.version===1?(r+=4,e.creationTime=Vt(i.getUint32(r)),r+=8,e.modificationTime=Vt(i.getUint32(r)),r+=4,e.trackId=i.getUint32(r),r+=4,r+=8,e.duration=i.getUint32(r)):(e.creationTime=Vt(i.getUint32(r)),r+=4,e.modificationTime=Vt(i.getUint32(r)),r+=4,e.trackId=i.getUint32(r),r+=4,r+=4,e.duration=i.getUint32(r)),r+=4,r+=8,e.layer=i.getUint16(r),r+=2,e.alternateGroup=i.getUint16(r),r+=2,e.volume=i.getUint8(r)+i.getUint8(r+1)/8,r+=2,r+=2,e.matrix=new Uint32Array(t.subarray(r,r+36)),r+=36,e.width=i.getUint16(r)+i.getUint16(r+2)/16,r+=4,e.height=i.getUint16(r)+i.getUint16(r+2)/16,e},traf:function(t){return{boxes:Pt(t)}},trak:function(t){return{boxes:Pt(t)}},trex:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4),defaultSampleDescriptionIndex:i.getUint32(8),defaultSampleDuration:i.getUint32(12),defaultSampleSize:i.getUint32(16),sampleDependsOn:3&t[20],sampleIsDependedOn:(192&t[21])>>6,sampleHasRedundancy:(48&t[21])>>4,samplePaddingValue:(14&t[21])>>1,sampleIsDifferenceSample:!!(1&t[21]),sampleDegradationPriority:i.getUint16(22)}},trun:function(t){var i,r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},e=new DataView(t.buffer,t.byteOffset,t.byteLength),n=1&r.flags[2],a=4&r.flags[2],s=1&r.flags[1],o=2&r.flags[1],u=4&r.flags[1],v=8&r.flags[1],C=e.getUint32(4),k=8;for(n&&(r.dataOffset=e.getInt32(k),k+=4),a&&C&&(i={flags:Ul(t.subarray(k,k+4))},k+=4,s&&(i.duration=e.getUint32(k),k+=4),o&&(i.size=e.getUint32(k),k+=4),v&&(i.compositionTimeOffset=e.getUint32(k),k+=4),r.samples.push(i),C--);C--;)i={},s&&(i.duration=e.getUint32(k),k+=4),o&&(i.size=e.getUint32(k),k+=4),u&&(i.flags=Ul(t.subarray(k,k+4)),k+=4),v&&(i.compositionTimeOffset=e.getUint32(k),k+=4),r.samples.push(i);return r},"url ":function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:i.getUint16(4),opcolor:new Uint16Array([i.getUint16(6),i.getUint16(8),i.getUint16(10)])}}},an={inspect:Pt=function(t){for(var i,r,e,n,a,s=0,o=[],u=new ArrayBuffer(t.length),v=new Uint8Array(u),C=0;C<t.length;++C)v[C]=t[C];for(i=new DataView(u);s<t.byteLength;)r=i.getUint32(s),e=nn(t.subarray(s+4,s+8)),n=r>1?s+r:t.byteLength,(a=(Rr[e]||function(k){return{data:k}})(t.subarray(s+8,n))).size=r,a.type=e,o.push(a),s=n;return o},textify:el=function(t,i){var r;return i=i||0,r=new Array(2*i+1).join(" "),t.map(function(e,n){return r+e.type+`
`+Object.keys(e).filter(function(a){return a!=="type"&&a!=="boxes"}).map(function(a){var s=r+"  "+a+": ",o=e[a];if(o instanceof Uint8Array||o instanceof Uint32Array){var u=Array.prototype.slice.call(new Uint8Array(o.buffer,o.byteOffset,o.byteLength)).map(function(v){return" "+("00"+v.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return u?u.length===1?s+"<"+u.join("").slice(1)+">":s+`<
`+u.map(function(v){return r+"  "+v}).join(`
`)+`
`+r+"  >":s+"<>"}return s+JSON.stringify(o,null,2).split(`
`).map(function(v,C){return C===0?v:r+"  "+v}).join(`
`)}).join(`
`)+(e.boxes?`
`+el(e.boxes,i+1):"")}).join(`
`)},parseTfdt:Rr.tfdt,parseHdlr:Rr.hdlr,parseTfhd:Rr.tfhd,parseTrun:Rr.trun,parseSidx:Rr.sidx},jl=Math.pow(2,32)-1;(function(){var t;if(Ue={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array<"u"){for(t in Ue)Ue.hasOwnProperty(t)&&(Ue[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);Ya=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),bl=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),_l=new Uint8Array([0,0,0,1]),Tl=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Sl=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),kl={video:Tl,audio:Sl},wl=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Cl=new Uint8Array([0,0,0,0,0,0,0,0]),tn=new Uint8Array([0,0,0,0,0,0,0,0]),Pl=tn,Al=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Rl=tn,El=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),Be=function(t){var i,r,e=[],n=0;for(i=1;i<arguments.length;i++)e.push(arguments[i]);for(i=e.length;i--;)n+=e[i].byteLength;for(r=new Uint8Array(n+8),new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,r.byteLength),r.set(t,4),i=0,n=8;i<e.length;i++)r.set(e[i],n),n+=e[i].byteLength;return r},tl=function(){return Be(Ue.dinf,Be(Ue.dref,wl))},rl=function(t){return Be(Ue.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},fl=function(t){return Be(Ue.hdlr,kl[t])},hl=function(t){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(i[12]=t.samplerate>>>24&255,i[13]=t.samplerate>>>16&255,i[14]=t.samplerate>>>8&255,i[15]=255&t.samplerate),Be(Ue.mdhd,i)},dl=function(t){return Be(Ue.mdia,hl(t),fl(t.type),al(t))},nl=function(t){return Be(Ue.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},al=function(t){return Be(Ue.minf,t.type==="video"?Be(Ue.vmhd,El):Be(Ue.smhd,Cl),tl(),ml(t))},sl=function(t,i){for(var r=[],e=i.length;e--;)r[e]=vl(i[e]);return Be.apply(null,[Ue.moof,nl(t)].concat(r))},$a=function(t){for(var i=t.length,r=[];i--;)r[i]=ll(t[i]);return Be.apply(null,[Ue.moov,ul(4294967295)].concat(r).concat(ol(t)))},ol=function(t){for(var i=t.length,r=[];i--;)r[i]=yl(t[i]);return Be.apply(null,[Ue.mvex].concat(r))},ul=function(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Be(Ue.mvhd,i)},pl=function(t){var i,r,e=t.samples||[],n=new Uint8Array(4+e.length);for(r=0;r<e.length;r++)i=e[r].flags,n[r+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return Be(Ue.sdtp,n)},ml=function(t){return Be(Ue.stbl,gl(t),Be(Ue.stts,Rl),Be(Ue.stsc,Pl),Be(Ue.stsz,Al),Be(Ue.stco,tn))},gl=function(t){return Be(Ue.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),t.type==="video"?Ll(t):Ol(t))},Ll=function(t){var i,r=t.sps||[],e=t.pps||[],n=[],a=[];for(i=0;i<r.length;i++)n.push((65280&r[i].byteLength)>>>8),n.push(255&r[i].byteLength),n=n.concat(Array.prototype.slice.call(r[i]));for(i=0;i<e.length;i++)a.push((65280&e[i].byteLength)>>>8),a.push(255&e[i].byteLength),a=a.concat(Array.prototype.slice.call(e[i]));return Be(Ue.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Be(Ue.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([r.length]).concat(n).concat([e.length]).concat(a))),Be(Ue.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},Ol=function(t){return Be(Ue.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),rl(t))},cl=function(t){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return Be(Ue.tkhd,i)},vl=function(t){var i,r,e,n,a,s;return i=Be(Ue.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(t.baseMediaDecodeTime/(jl+1)),s=Math.floor(t.baseMediaDecodeTime%(jl+1)),r=Be(Ue.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),t.type==="audio"?(e=Xa(t,92),Be(Ue.traf,i,r,e)):(n=pl(t),e=Xa(t,n.length+92),Be(Ue.traf,i,r,e,n))},ll=function(t){return t.duration=t.duration||4294967295,Be(Ue.trak,cl(t),dl(t))},yl=function(t){var i=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return t.type!=="video"&&(i[i.length-1]=0),Be(Ue.trex,i)},Ja=function(t,i){var r=0,e=0,n=0,a=0;return t.length&&(t[0].duration!==void 0&&(r=1),t[0].size!==void 0&&(e=2),t[0].flags!==void 0&&(n=4),t[0].compositionTimeOffset!==void 0&&(a=8)),[0,0,r|e|n|a,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&i)>>>24,(16711680&i)>>>16,(65280&i)>>>8,255&i]},xl=function(t,i){var r,e,n,a;for(i+=20+16*(e=t.samples||[]).length,r=Ja(e,i),a=0;a<e.length;a++)n=e[a],r=r.concat([(4278190080&n.duration)>>>24,(16711680&n.duration)>>>16,(65280&n.duration)>>>8,255&n.duration,(4278190080&n.size)>>>24,(16711680&n.size)>>>16,(65280&n.size)>>>8,255&n.size,n.flags.isLeading<<2|n.flags.dependsOn,n.flags.isDependedOn<<6|n.flags.hasRedundancy<<4|n.flags.paddingValue<<1|n.flags.isNonSyncSample,61440&n.flags.degradationPriority,15&n.flags.degradationPriority,(4278190080&n.compositionTimeOffset)>>>24,(16711680&n.compositionTimeOffset)>>>16,(65280&n.compositionTimeOffset)>>>8,255&n.compositionTimeOffset]);return Be(Ue.trun,new Uint8Array(r))},Il=function(t,i){var r,e,n,a;for(i+=20+8*(e=t.samples||[]).length,r=Ja(e,i),a=0;a<e.length;a++)n=e[a],r=r.concat([(4278190080&n.duration)>>>24,(16711680&n.duration)>>>16,(65280&n.duration)>>>8,255&n.duration,(4278190080&n.size)>>>24,(16711680&n.size)>>>16,(65280&n.size)>>>8,255&n.size]);return Be(Ue.trun,new Uint8Array(r))},Xa=function(t,i){return t.type==="audio"?Il(t,i):xl(t,i)};var Yr={ftyp:il=function(){return Be(Ue.ftyp,Ya,_l,Ya,bl)},mdat:function(t){return Be(Ue.mdat,t)},moof:sl,moov:$a,initSegment:function(t){var i,r=il(),e=$a(t);return(i=new Uint8Array(r.byteLength+e.byteLength)).set(r),i.set(e,r.byteLength),i}},sn=function(){this.init=function(){var t={};this.on=function(i,r){t[i]||(t[i]=[]),t[i]=t[i].concat(r)},this.off=function(i,r){var e;return!!t[i]&&(e=t[i].indexOf(r),t[i]=t[i].slice(),t[i].splice(e,1),e>-1)},this.trigger=function(i){var r,e,n,a;if(r=t[i])if(arguments.length===2)for(n=r.length,e=0;e<n;++e)r[e].call(this,arguments[1]);else{for(a=[],e=arguments.length,e=1;e<arguments.length;++e)a.push(arguments[e]);for(n=r.length,e=0;e<n;++e)r[e].apply(this,a)}},this.dispose=function(){t={}}}};sn.prototype.pipe=function(t){return this.on("data",function(i){t.push(i)}),this.on("done",function(i){t.flush(i)}),t},sn.prototype.push=function(t){this.trigger("data",t)},sn.prototype.flush=function(t){this.trigger("done",t)};var Za,Bl,Nl,Fl,Vl,Et=sn,If=function(t,i){var r={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return r.dataOffset=i,r.compositionTimeOffset=t.pts-t.dts,r.duration=t.duration,r.size=4*t.length,r.size+=t.byteLength,t.keyFrame&&(r.flags.dependsOn=2,r.flags.isNonSyncSample=0),r},xf=function(t){var i,r,e=[],n=[];for(e.byteLength=0,i=0;i<t.length;i++)(r=t[i]).nalUnitType==="access_unit_delimiter_rbsp"?(e.length&&(e.duration=r.dts-e.dts,n.push(e)),(e=[r]).byteLength=r.data.byteLength,e.pts=r.pts,e.dts=r.dts):(r.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(e.keyFrame=!0),e.duration=r.dts-e.dts,e.byteLength+=r.data.byteLength,e.push(r));return n.length&&(!e.duration||e.duration<=0)&&(e.duration=n[n.length-1].duration),n.push(e),n},Df=function(t){var i,r,e=[],n=[];for(e.byteLength=0,e.nalCount=0,e.duration=0,e.pts=t[0].pts,e.dts=t[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=t[0].pts,n.dts=t[0].dts,i=0;i<t.length;i++)(r=t[i]).keyFrame?(e.length&&(n.push(e),n.byteLength+=e.byteLength,n.nalCount+=e.nalCount,n.duration+=e.duration),(e=[r]).nalCount=r.length,e.byteLength=r.byteLength,e.pts=r.pts,e.dts=r.dts,e.duration=r.duration):(e.duration+=r.duration,e.nalCount+=r.length,e.byteLength+=r.byteLength,e.push(r));return n.length&&e.duration<=0&&(e.duration=n[n.length-1].duration),n.byteLength+=e.byteLength,n.nalCount+=e.nalCount,n.duration+=e.duration,n.push(e),n},Mf=function(t){var i;return!t[0][0].keyFrame&&t.length>1&&(i=t.shift(),t.byteLength-=i.byteLength,t.nalCount-=i.nalCount,t[0][0].dts=i.dts,t[0][0].pts=i.pts,t[0][0].duration+=i.duration),t},Uf=function(t,i){var r,e,n,a,s,o=i||0,u=[];for(r=0;r<t.length;r++)for(a=t[r],e=0;e<a.length;e++)s=a[e],o+=(n=If(s,o)).size,u.push(n);return u},jf=function(t){var i,r,e,n,a,s,o=0,u=t.byteLength,v=t.nalCount,C=new Uint8Array(u+4*v),k=new DataView(C.buffer);for(i=0;i<t.length;i++)for(n=t[i],r=0;r<n.length;r++)for(a=n[r],e=0;e<a.length;e++)s=a[e],k.setUint32(o,s.data.byteLength),o+=4,C.set(s.data,o),o+=s.data.byteLength;return C},dr=[33,16,5,32,164,27],es=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],We=function(t){for(var i=[];t--;)i.push(0);return i},Bf={96e3:[dr,[227,64],We(154),[56]],88200:[dr,[231],We(170),[56]],64e3:[dr,[248,192],We(240),[56]],48e3:[dr,[255,192],We(268),[55,148,128],We(54),[112]],44100:[dr,[255,192],We(268),[55,163,128],We(84),[112]],32e3:[dr,[255,192],We(268),[55,234],We(226),[112]],24e3:[dr,[255,192],We(268),[55,255,128],We(268),[111,112],We(126),[224]],16e3:[dr,[255,192],We(268),[55,255,128],We(268),[111,255],We(269),[223,108],We(195),[1,192]],12e3:[es,We(268),[3,127,248],We(268),[6,255,240],We(268),[13,255,224],We(268),[27,253,128],We(259),[56]],11025:[es,We(268),[3,127,248],We(268),[6,255,240],We(268),[13,255,224],We(268),[27,255,192],We(268),[55,175,128],We(108),[112]],8e3:[es,We(268),[3,121,16],We(47),[7]]},Nf=(Za=Bf,Object.keys(Za).reduce(function(t,i){return t[i]=new Uint8Array(Za[i].reduce(function(r,e){return r.concat(e)},[])),t},{})),Ff=(Bl=function(t){return 9e4*t},Nl=function(t,i){return t*i},Fl=function(t){return t/9e4},Vl=function(t,i){return t/i},function(t,i){return Bl(Vl(t,i))}),Vf=function(t,i){return Nl(Fl(t),i)},Gf=function(t,i,r,e){var n,a,s,o,u=0,v=0,C=0;if(i.length&&(n=Ff(t.baseMediaDecodeTime,t.samplerate),a=Math.ceil(9e4/(t.samplerate/1024)),r&&e&&(u=n-Math.max(r,e),C=(v=Math.floor(u/a))*a),!(v<1||C>45e3))){for((s=Nf[t.samplerate])||(s=i[0].data),o=0;o<v;o++)i.splice(o,0,{data:s});t.baseMediaDecodeTime-=Math.floor(Vf(C,t.samplerate))}},Hf=function(t,i,r){return i.minSegmentDts>=r?t:(i.minSegmentDts=1/0,t.filter(function(e){return e.dts>=r&&(i.minSegmentDts=Math.min(i.minSegmentDts,e.dts),i.minSegmentPts=i.minSegmentDts,!0)}))},zf=function(t){var i,r,e=[];for(i=0;i<t.length;i++)r=t[i],e.push({size:r.data.byteLength,duration:1024});return e},qf=function(t){var i,r,e=0,n=new Uint8Array(function(a){var s,o=0;for(s=0;s<a.length;s++)o+=a[s].data.byteLength;return o}(t));for(i=0;i<t.length;i++)r=t[i],n.set(r.data,e),e+=r.data.byteLength;return n},Ti=function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},Gl=function(t,i){var r,e=t.minSegmentDts;return i||(e-=t.timelineStartInfo.dts),r=t.timelineStartInfo.baseMediaDecodeTime,r+=e,r=Math.max(0,r),t.type==="audio"&&(r*=t.samplerate/9e4,r=Math.floor(r)),r},ts=function(t,i){typeof i.pts=="number"&&(t.timelineStartInfo.pts===void 0&&(t.timelineStartInfo.pts=i.pts),t.minSegmentPts===void 0?t.minSegmentPts=i.pts:t.minSegmentPts=Math.min(t.minSegmentPts,i.pts),t.maxSegmentPts===void 0?t.maxSegmentPts=i.pts:t.maxSegmentPts=Math.max(t.maxSegmentPts,i.pts)),typeof i.dts=="number"&&(t.timelineStartInfo.dts===void 0&&(t.timelineStartInfo.dts=i.dts),t.minSegmentDts===void 0?t.minSegmentDts=i.dts:t.minSegmentDts=Math.min(t.minSegmentDts,i.dts),t.maxSegmentDts===void 0?t.maxSegmentDts=i.dts:t.maxSegmentDts=Math.max(t.maxSegmentDts,i.dts))},Wf=function(t){for(var i=0,r={payloadType:-1,payloadSize:0},e=0,n=0;i<t.byteLength&&t[i]!==128;){for(;t[i]===255;)e+=255,i++;for(e+=t[i++];t[i]===255;)n+=255,i++;if(n+=t[i++],!r.payload&&e===4){r.payloadType=e,r.payloadSize=n,r.payload=t.subarray(i,i+n);break}i+=n,e=0,n=0}return r},Kf=function(t){return t.payload[0]!==181||(t.payload[1]<<8|t.payload[2])!=49||String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])!=="GA94"||t.payload[7]!==3?null:t.payload.subarray(8,t.payload.length-1)},$f=function(t,i){var r,e,n,a,s=[];if(!(64&i[0]))return s;for(e=31&i[0],r=0;r<e;r++)a={type:3&i[2+(n=3*r)],pts:t},4&i[n+2]&&(a.ccData=i[n+3]<<8|i[n+4],s.push(a));return s},Xf=function(t){for(var i,r,e=t.byteLength,n=[],a=1;a<e-2;)t[a]===0&&t[a+1]===0&&t[a+2]===3?(n.push(a+2),a+=2):a++;if(n.length===0)return t;i=e-n.length,r=new Uint8Array(i);var s=0;for(a=0;a<i;s++,a++)s===n[0]&&(s++,n.shift()),r[a]=t[s];return r},Yf=4,hr=function t(){t.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new it(0,0),new it(0,1),new it(1,0),new it(1,1)],this.reset(),this.ccStreams_.forEach(function(i){i.on("data",this.trigger.bind(this,"data")),i.on("done",this.trigger.bind(this,"done"))},this)};(hr.prototype=new Et).push=function(t){var i,r,e;if(t.nalUnitType==="sei_rbsp"&&(i=Wf(t.escapedRBSP)).payloadType===Yf&&(r=Kf(i)))if(t.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(t.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));e=$f(t.pts,r),this.captionPackets_=this.captionPackets_.concat(e),this.latestDts_!==t.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=t.dts}},hr.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(t,i){t.presortIndex=i}),this.captionPackets_.sort(function(t,i){return t.pts===i.pts?t.presortIndex-i.presortIndex:t.pts-i.pts}),this.captionPackets_.forEach(function(t){t.type<2&&this.dispatchCea608Packet(t)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(t){t.flush()},this)):this.ccStreams_.forEach(function(t){t.flush()},this)},hr.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(t){t.reset()})},hr.prototype.dispatchCea608Packet=function(t){this.setsTextOrXDSActive(t)?this.activeCea608Channel_[t.type]=null:this.setsChannel1Active(t)?this.activeCea608Channel_[t.type]=0:this.setsChannel2Active(t)&&(this.activeCea608Channel_[t.type]=1),this.activeCea608Channel_[t.type]!==null&&this.ccStreams_[(t.type<<1)+this.activeCea608Channel_[t.type]].push(t)},hr.prototype.setsChannel1Active=function(t){return(30720&t.ccData)==4096},hr.prototype.setsChannel2Active=function(t){return(30720&t.ccData)==6144},hr.prototype.setsTextOrXDSActive=function(t){return(28928&t.ccData)==256||(30974&t.ccData)==4138||(30974&t.ccData)==6186};var Jf={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},on=function(t){return t===null?"":(t=Jf[t]||t,String.fromCharCode(t))},Qf=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Lr=function(){for(var t=[],i=15;i--;)t.push("");return t},it=function t(i,r){t.prototype.init.call(this),this.field_=i||0,this.dataChannel_=r||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var n,a,s,o,u;if((n=32639&e.ccData)!==this.lastControlCode_){if((61440&n)==4096?this.lastControlCode_=n:n!==this.PADDING_&&(this.lastControlCode_=null),s=n>>>8,o=255&n,n!==this.PADDING_)if(n===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(n===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),a=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=a,this.startPts_=e.pts;else if(n===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(n===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(n===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(n===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(n===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(n===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Lr();else if(n===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Lr();else if(n===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(e.pts),this.displayed_=Lr()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(s,o))u=on((s=(3&s)<<8)|o),this[this.mode_](e.pts,u),this.column_++;else if(this.isExtCharacter(s,o))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),u=on((s=(3&s)<<8)|o),this[this.mode_](e.pts,u),this.column_++;else if(this.isMidRowCode(s,o))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,(14&o)==14&&this.addFormatting(e.pts,["i"]),(1&o)==1&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(s,o))this.column_+=3&o;else if(this.isPAC(s,o)){var v=Qf.indexOf(7968&n);this.mode_==="rollUp"&&(v-this.rollUpRows_+1<0&&(v=this.rollUpRows_-1),this.setRollUp(e.pts,v)),v!==this.row_&&(this.clearFormatting(e.pts),this.row_=v),1&o&&this.formatting_.indexOf("u")===-1&&this.addFormatting(e.pts,["u"]),(16&n)==16&&(this.column_=4*((14&n)>>1)),this.isColorPAC(o)&&(14&o)==14&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(s)&&(o===0&&(o=null),u=on(s),u+=on(o),this[this.mode_](e.pts,u),this.column_+=u.length)}else this.lastControlCode_=null}};it.prototype=new Et,it.prototype.flushDisplayed=function(t){var i=this.displayed_.map(function(r){try{return r.trim()}catch{return console.error("Skipping malformed caption."),""}}).join(`
`).replace(/^\n+|\n+$/g,"");i.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:i,stream:this.name_})},it.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Lr(),this.nonDisplayed_=Lr(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},it.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},it.prototype.isSpecialCharacter=function(t,i){return t===this.EXT_&&i>=48&&i<=63},it.prototype.isExtCharacter=function(t,i){return(t===this.EXT_+1||t===this.EXT_+2)&&i>=32&&i<=63},it.prototype.isMidRowCode=function(t,i){return t===this.EXT_&&i>=32&&i<=47},it.prototype.isOffsetControlCode=function(t,i){return t===this.OFFSET_&&i>=33&&i<=35},it.prototype.isPAC=function(t,i){return t>=this.BASE_&&t<this.BASE_+8&&i>=64&&i<=127},it.prototype.isColorPAC=function(t){return t>=64&&t<=79||t>=96&&t<=127},it.prototype.isNormalChar=function(t){return t>=32&&t<=127},it.prototype.setRollUp=function(t,i){if(this.mode_!=="rollUp"&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(t),this.nonDisplayed_=Lr(),this.displayed_=Lr()),i!==void 0&&i!==this.row_)for(var r=0;r<this.rollUpRows_;r++)this.displayed_[i-r]=this.displayed_[this.row_-r],this.displayed_[this.row_-r]="";i===void 0&&(i=this.row_),this.topRow_=i-this.rollUpRows_+1},it.prototype.addFormatting=function(t,i){this.formatting_=this.formatting_.concat(i);var r=i.reduce(function(e,n){return e+"<"+n+">"},"");this[this.mode_](t,r)},it.prototype.clearFormatting=function(t){if(this.formatting_.length){var i=this.formatting_.reverse().reduce(function(r,e){return r+"</"+e+">"},"");this.formatting_=[],this[this.mode_](t,i)}},it.prototype.popOn=function(t,i){var r=this.nonDisplayed_[this.row_];r+=i,this.nonDisplayed_[this.row_]=r},it.prototype.rollUp=function(t,i){var r=this.displayed_[this.row_];r+=i,this.displayed_[this.row_]=r},it.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.row_+1;t<15;t++)this.displayed_[t]="";for(t=this.topRow_;t<this.row_;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[this.row_]=""},it.prototype.paintOn=function(t,i){var r=this.displayed_[this.row_];r+=i,this.displayed_[this.row_]=r};var rs={CaptionStream:hr,Cea608Stream:it},mt={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},is=function(t,i){var r=1;for(t>i&&(r=-1);Math.abs(i-t)>4294967296;)t+=8589934592*r;return t},Hl=function t(i){var r,e;t.prototype.init.call(this),this.type_=i,this.push=function(n){n.type===this.type_&&(e===void 0&&(e=n.dts),n.dts=is(n.dts,e),n.pts=is(n.pts,e),r=n.dts,this.trigger("data",n))},this.flush=function(){e=r,this.trigger("done")},this.discontinuity=function(){e=void 0,r=void 0}};Hl.prototype=new Et;var ns,Zf=Hl,ep=is,zl=function(t,i,r){var e,n="";for(e=i;e<r;e++)n+="%"+("00"+t[e].toString(16)).slice(-2);return n},un=function(t,i,r){return decodeURIComponent(zl(t,i,r))},ln=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},ql={TXXX:function(t){var i;if(t.data[0]===3){for(i=1;i<t.data.length;i++)if(t.data[i]===0){t.description=un(t.data,1,i),t.value=un(t.data,i+1,t.data.length).replace(/\0*$/,"");break}t.data=t.value}},WXXX:function(t){var i;if(t.data[0]===3){for(i=1;i<t.data.length;i++)if(t.data[i]===0){t.description=un(t.data,1,i),t.url=un(t.data,i+1,t.data.length);break}}},PRIV:function(t){var i,r;for(i=0;i<t.data.length;i++)if(t.data[i]===0){t.owner=(r=t.data,unescape(zl(r,0,i)));break}t.privateData=t.data.subarray(i+1),t.data=t.privateData}};(ns=function(t){var i,r={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},e=0,n=[],a=0;if(ns.prototype.init.call(this),this.dispatchType=mt.METADATA_STREAM_TYPE.toString(16),r.descriptor)for(i=0;i<r.descriptor.length;i++)this.dispatchType+=("00"+r.descriptor[i].toString(16)).slice(-2);this.push=function(s){var o,u,v,C,k;if(s.type==="timed-metadata"){if(s.dataAlignmentIndicator&&(a=0,n.length=0),n.length===0&&(s.data.length<10||s.data[0]!=="I".charCodeAt(0)||s.data[1]!=="D".charCodeAt(0)||s.data[2]!=="3".charCodeAt(0)))r.debug&&console.log("Skipping unrecognized metadata packet");else if(n.push(s),a+=s.data.byteLength,n.length===1&&(e=ln(s.data.subarray(6,10)),e+=10),!(a<e)){for(o={data:new Uint8Array(e),frames:[],pts:n[0].pts,dts:n[0].dts},k=0;k<e;)o.data.set(n[0].data.subarray(0,e-k),k),k+=n[0].data.byteLength,a-=n[0].data.byteLength,n.shift();u=10,64&o.data[5]&&(u+=4,u+=ln(o.data.subarray(10,14)),e-=ln(o.data.subarray(16,20)));do{if((v=ln(o.data.subarray(u+4,u+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((C={id:String.fromCharCode(o.data[u],o.data[u+1],o.data[u+2],o.data[u+3]),data:o.data.subarray(u+10,u+v+10)}).key=C.id,ql[C.id]&&(ql[C.id](C),C.owner==="com.apple.streaming.transportStreamTimestamp")){var M=C.data,j=(1&M[3])<<30|M[4]<<22|M[5]<<14|M[6]<<6|M[7]>>>2;j*=4,j+=3&M[7],C.timeStamp=j,o.pts===void 0&&o.dts===void 0&&(o.pts=C.timeStamp,o.dts=C.timeStamp),this.trigger("timestamp",C)}o.frames.push(C),u+=10,u+=v}while(u<e);this.trigger("data",o)}}}}).prototype=new Et;var as,cn,ss,tp=ns,rp=Zf;(as=function(){var t=new Uint8Array(188),i=0;as.prototype.init.call(this),this.push=function(r){var e,n=0,a=188;for(i?((e=new Uint8Array(r.byteLength+i)).set(t.subarray(0,i)),e.set(r,i),i=0):e=r;a<e.byteLength;)e[n]!==71||e[a]!==71?(n++,a++):(this.trigger("data",e.subarray(n,a)),n+=188,a+=188);n<e.byteLength&&(t.set(e.subarray(n),0),i=e.byteLength-n)},this.flush=function(){i===188&&t[0]===71&&(this.trigger("data",t),i=0),this.trigger("done")}}).prototype=new Et,(cn=function(){var t,i,r,e;cn.prototype.init.call(this),e=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(n,a){var s=0;a.payloadUnitStartIndicator&&(s+=n[s]+1),a.type==="pat"?i(n.subarray(s),a):r(n.subarray(s),a)},i=function(n,a){a.section_number=n[7],a.last_section_number=n[8],e.pmtPid=(31&n[10])<<8|n[11],a.pmtPid=e.pmtPid},r=function(n,a){var s,o;if(1&n[5]){for(e.programMapTable={video:null,audio:null,"timed-metadata":{}},s=3+((15&n[1])<<8|n[2])-4,o=12+((15&n[10])<<8|n[11]);o<s;){var u=n[o],v=(31&n[o+1])<<8|n[o+2];u===mt.H264_STREAM_TYPE&&e.programMapTable.video===null?e.programMapTable.video=v:u===mt.ADTS_STREAM_TYPE&&e.programMapTable.audio===null?e.programMapTable.audio=v:u===mt.METADATA_STREAM_TYPE&&(e.programMapTable["timed-metadata"][v]=u),o+=5+((15&n[o+3])<<8|n[o+4])}a.programMapTable=e.programMapTable}},this.push=function(n){var a={},s=4;if(a.payloadUnitStartIndicator=!!(64&n[1]),a.pid=31&n[1],a.pid<<=8,a.pid|=n[2],(48&n[3])>>>4>1&&(s+=n[s]+1),a.pid===0)a.type="pat",t(n.subarray(s),a),this.trigger("data",a);else if(a.pid===this.pmtPid)for(a.type="pmt",t(n.subarray(s),a),this.trigger("data",a);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([n,s,a]):this.processPes_(n,s,a)},this.processPes_=function(n,a,s){s.pid===this.programMapTable.video?s.streamType=mt.H264_STREAM_TYPE:s.pid===this.programMapTable.audio?s.streamType=mt.ADTS_STREAM_TYPE:s.streamType=this.programMapTable["timed-metadata"][s.pid],s.type="pes",s.data=n.subarray(a),this.trigger("data",s)}}).prototype=new Et,cn.STREAM_TYPES={h264:27,adts:15},(ss=function(){var t=this,i={data:[],size:0},r={data:[],size:0},e={data:[],size:0},n=function(a,s,o){var u,v,C=new Uint8Array(a.size),k={type:s},M=0,j=0;if(a.data.length&&!(a.size<9)){for(k.trackId=a.data[0].pid,M=0;M<a.data.length;M++)v=a.data[M],C.set(v.data,j),j+=v.data.byteLength;var G,H,K;G=C,(H=k).packetLength=6+(G[4]<<8|G[5]),H.dataAlignmentIndicator=(4&G[6])!=0,192&(K=G[7])&&(H.pts=(14&G[9])<<27|(255&G[10])<<20|(254&G[11])<<12|(255&G[12])<<5|(254&G[13])>>>3,H.pts*=4,H.pts+=(6&G[13])>>>1,H.dts=H.pts,64&K&&(H.dts=(14&G[14])<<27|(255&G[15])<<20|(254&G[16])<<12|(255&G[17])<<5|(254&G[18])>>>3,H.dts*=4,H.dts+=(6&G[18])>>>1)),H.data=G.subarray(9+G[8]),u=s==="video"||k.packetLength<=a.size,(o||u)&&(a.size=0,a.data.length=0),u&&t.trigger("data",k)}};ss.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var s,o;switch(a.streamType){case mt.H264_STREAM_TYPE:case mt.H264_STREAM_TYPE:s=i,o="video";break;case mt.ADTS_STREAM_TYPE:s=r,o="audio";break;case mt.METADATA_STREAM_TYPE:s=e,o="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&n(s,o,!0),s.data.push(a),s.size+=a.data.byteLength},pmt:function(){var s={type:"metadata",tracks:[]},o=a.programMapTable;o.video!==null&&s.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),o.audio!==null&&s.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),t.trigger("data",s)}})[a.type]()},this.flush=function(){n(i,"video"),n(r,"audio"),n(e,"timed-metadata"),this.trigger("done")}}).prototype=new Et;var Wl={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:as,TransportParseStream:cn,ElementaryStream:ss,TimestampRolloverStream:rp,CaptionStream:rs.CaptionStream,Cea608Stream:rs.Cea608Stream,MetadataStream:tp};for(var os in mt)mt.hasOwnProperty(os)&&(Wl[os]=mt[os]);var us,Jt=Wl,Kl=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(us=function(){var t;us.prototype.init.call(this),this.push=function(i){var r,e,n,a,s,o,u=0,v=0;if(i.type==="audio")for(t?(a=t,(t=new Uint8Array(a.byteLength+i.data.byteLength)).set(a),t.set(i.data,a.byteLength)):t=i.data;u+5<t.length;)if(t[u]===255&&(246&t[u+1])==240){if(e=2*(1&~t[u+1]),r=(3&t[u+3])<<11|t[u+4]<<3|(224&t[u+5])>>5,o=9e4*(s=1024*(1+(3&t[u+6])))/Kl[(60&t[u+2])>>>2],n=u+r,t.byteLength<n)return;if(this.trigger("data",{pts:i.pts+v*o,dts:i.dts+v*o,sampleCount:s,audioobjecttype:1+(t[u+2]>>>6&3),channelcount:(1&t[u+2])<<2|(192&t[u+3])>>>6,samplerate:Kl[(60&t[u+2])>>>2],samplingfrequencyindex:(60&t[u+2])>>>2,samplesize:16,data:t.subarray(u+7+e,n)}),t.byteLength===n)return void(t=void 0);v++,t=t.subarray(n)}else u++},this.flush=function(){this.trigger("done")}}).prototype=new Et;var ls,dn,$l,Xl=us,ip=function(t){var i=t.byteLength,r=0,e=0;this.length=function(){return 8*i},this.bitsAvailable=function(){return 8*i+e},this.loadWord=function(){var n=t.byteLength-i,a=new Uint8Array(4),s=Math.min(4,i);if(s===0)throw new Error("no bytes available");a.set(t.subarray(n,n+s)),r=new DataView(a.buffer).getUint32(0),e=8*s,i-=s},this.skipBits=function(n){var a;e>n?(r<<=n,e-=n):(n-=e,n-=8*(a=Math.floor(n/8)),i-=a,this.loadWord(),r<<=n,e-=n)},this.readBits=function(n){var a=Math.min(e,n),s=r>>>32-a;return(e-=a)>0?r<<=a:i>0&&this.loadWord(),(a=n-a)>0?s<<a|this.readBits(a):s},this.skipLeadingZeros=function(){var n;for(n=0;n<e;++n)if(r&2147483648>>>n)return r<<=n,e-=n,n;return this.loadWord(),n+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var n=this.skipLeadingZeros();return this.readBits(n+1)-1},this.readExpGolomb=function(){var n=this.readUnsignedExpGolomb();return 1&n?1+n>>>1:-1*(n>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(dn=function(){var t,i,r=0;dn.prototype.init.call(this),this.push=function(e){var n;for(i?((n=new Uint8Array(i.byteLength+e.data.byteLength)).set(i),n.set(e.data,i.byteLength),i=n):i=e.data;r<i.byteLength-3;r++)if(i[r+2]===1){t=r+5;break}for(;t<i.byteLength;)switch(i[t]){case 0:if(i[t-1]!==0){t+=2;break}if(i[t-2]!==0){t++;break}r+3!==t-2&&this.trigger("data",i.subarray(r+3,t-2));do t++;while(i[t]!==1&&t<i.length);r=t-2,t+=3;break;case 1:if(i[t-1]!==0||i[t-2]!==0){t+=3;break}this.trigger("data",i.subarray(r+3,t-2)),r=t-2,t+=3;break;default:t+=3}i=i.subarray(r),t-=r,r=0},this.flush=function(){i&&i.byteLength>3&&this.trigger("data",i.subarray(r+3)),i=null,r=0,this.trigger("done")}}).prototype=new Et,$l={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(ls=function(){var t,i,r,e,n,a,s,o=new dn;ls.prototype.init.call(this),t=this,this.push=function(u){u.type==="video"&&(i=u.trackId,r=u.pts,e=u.dts,o.push(u))},o.on("data",function(u){var v={trackId:i,pts:r,dts:e,data:u};switch(31&u[0]){case 5:v.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:v.nalUnitType="sei_rbsp",v.escapedRBSP=n(u.subarray(1));break;case 7:v.nalUnitType="seq_parameter_set_rbsp",v.escapedRBSP=n(u.subarray(1)),v.config=a(v.escapedRBSP);break;case 8:v.nalUnitType="pic_parameter_set_rbsp";break;case 9:v.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",v)}),o.on("done",function(){t.trigger("done")}),this.flush=function(){o.flush()},s=function(u,v){var C,k=8,M=8;for(C=0;C<u;C++)M!==0&&(M=(k+v.readExpGolomb()+256)%256),k=M===0?k:M},n=function(u){for(var v,C,k=u.byteLength,M=[],j=1;j<k-2;)u[j]===0&&u[j+1]===0&&u[j+2]===3?(M.push(j+2),j+=2):j++;if(M.length===0)return u;v=k-M.length,C=new Uint8Array(v);var G=0;for(j=0;j<v;G++,j++)G===M[0]&&(G++,M.shift()),C[j]=u[G];return C},a=function(u){var v,C,k,M,j,G,H,K,W,Y,ne,ie,le,ge=0,Se=0,ce=0,Ee=0,lt=1;if(C=(v=new ip(u)).readUnsignedByte(),M=v.readUnsignedByte(),k=v.readUnsignedByte(),v.skipUnsignedExpGolomb(),$l[C]&&((j=v.readUnsignedExpGolomb())===3&&v.skipBits(1),v.skipUnsignedExpGolomb(),v.skipUnsignedExpGolomb(),v.skipBits(1),v.readBoolean()))for(ne=j!==3?8:12,le=0;le<ne;le++)v.readBoolean()&&s(le<6?16:64,v);if(v.skipUnsignedExpGolomb(),(G=v.readUnsignedExpGolomb())===0)v.readUnsignedExpGolomb();else if(G===1)for(v.skipBits(1),v.skipExpGolomb(),v.skipExpGolomb(),H=v.readUnsignedExpGolomb(),le=0;le<H;le++)v.skipExpGolomb();if(v.skipUnsignedExpGolomb(),v.skipBits(1),K=v.readUnsignedExpGolomb(),W=v.readUnsignedExpGolomb(),(Y=v.readBits(1))===0&&v.skipBits(1),v.skipBits(1),v.readBoolean()&&(ge=v.readUnsignedExpGolomb(),Se=v.readUnsignedExpGolomb(),ce=v.readUnsignedExpGolomb(),Ee=v.readUnsignedExpGolomb()),v.readBoolean()&&v.readBoolean()){switch(v.readUnsignedByte()){case 1:ie=[1,1];break;case 2:ie=[12,11];break;case 3:ie=[10,11];break;case 4:ie=[16,11];break;case 5:ie=[40,33];break;case 6:ie=[24,11];break;case 7:ie=[20,11];break;case 8:ie=[32,11];break;case 9:ie=[80,33];break;case 10:ie=[18,11];break;case 11:ie=[15,11];break;case 12:ie=[64,33];break;case 13:ie=[160,99];break;case 14:ie=[4,3];break;case 15:ie=[3,2];break;case 16:ie=[2,1];break;case 255:ie=[v.readUnsignedByte()<<8|v.readUnsignedByte(),v.readUnsignedByte()<<8|v.readUnsignedByte()]}ie&&(lt=ie[0]/ie[1])}return{profileIdc:C,levelIdc:k,profileCompatibility:M,width:Math.ceil((16*(K+1)-2*ge-2*Se)*lt),height:(2-Y)*(W+1)*16-2*ce-2*Ee}}}).prototype=new Et;var cs,np={H264Stream:ls,NalByteStream:dn},ap=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Yl=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},hn={isLikelyAacData:function(t){return t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)},parseId3TagSize:function(t,i){var r=t[i+6]<<21|t[i+7]<<14|t[i+8]<<7|t[i+9];return(16&t[i+5])>>4?r+20:r+10},parseAdtsSize:function(t,i){var r=(224&t[i+5])>>5,e=t[i+4]<<3;return 6144&t[i+3]|e|r},parseType:function(t,i){return t[i]==="I".charCodeAt(0)&&t[i+1]==="D".charCodeAt(0)&&t[i+2]==="3".charCodeAt(0)?"timed-metadata":!0&t[i]&&(240&t[i+1])==240?"audio":null},parseSampleRate:function(t){for(var i=0;i+5<t.length;){if(t[i]===255&&(246&t[i+1])==240)return ap[(60&t[i+2])>>>2];i++}return null},parseAacTimestamp:function(t){var i,r,e;i=10,64&t[5]&&(i+=4,i+=Yl(t.subarray(10,14)));do{if((r=Yl(t.subarray(i+4,i+8)))<1)return null;if(String.fromCharCode(t[i],t[i+1],t[i+2],t[i+3])==="PRIV"){e=t.subarray(i+10,i+r+10);for(var n=0;n<e.byteLength;n++)if(e[n]===0){if(unescape(function(o,u,v){var C,k="";for(C=u;C<v;C++)k+="%"+("00"+o[C].toString(16)).slice(-2);return k}(e,0,n))==="com.apple.streaming.transportStreamTimestamp"){var a=e.subarray(n+1),s=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return s*=4,s+=3&a[7]}break}}i+=10,i+=r}while(i<t.byteLength);return null}};(cs=function(){var t=new Uint8Array,i=0;cs.prototype.init.call(this),this.setTimestamp=function(r){i=r},this.push=function(r){var e,n,a,s,o=0,u=0;for(t.length?(s=t.length,(t=new Uint8Array(r.byteLength+s)).set(t.subarray(0,s)),t.set(r,s)):t=r;t.length-u>=3;)if(t[u]!=="I".charCodeAt(0)||t[u+1]!=="D".charCodeAt(0)||t[u+2]!=="3".charCodeAt(0))if((255&t[u])!=255||(240&t[u+1])!=240)u++;else{if(t.length-u<7||u+(o=hn.parseAdtsSize(t,u))>t.length)break;a={type:"audio",data:t.subarray(u,u+o),pts:i,dts:i},this.trigger("data",a),u+=o}else{if(t.length-u<10||u+(o=hn.parseId3TagSize(t,u))>t.length)break;n={type:"timed-metadata",data:t.subarray(u,u+o)},this.trigger("data",n),u+=o}e=t.length-u,t=e>0?t.subarray(u):new Uint8Array}}).prototype=new Et;var fn,Si,ds,ki,sp=cs,op=np.H264Stream,up=hn.isLikelyAacData,hs=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],fs=["width","height","profileIdc","levelIdc","profileCompatibility"],Jl=function(t,i){var r;if(t.length!==i.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==i[r])return!1;return!0},Ql=function(t,i,r,e,n,a){return{start:{dts:t,pts:t+(r-i)},end:{dts:t+(e-i),pts:t+(n-r)},prependedContentDuration:a,baseMediaDecodeTime:t}};(Si=function(t,i){var r=[],e=0,n=0,a=0,s=1/0;i=i||{},Si.prototype.init.call(this),this.push=function(o){ts(t,o),t&&hs.forEach(function(u){t[u]=o[u]}),r.push(o)},this.setEarliestDts=function(o){n=o-t.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(o){s=o},this.setAudioAppendStart=function(o){a=o},this.flush=function(){var o,u,v,C;r.length!==0?(o=Hf(r,t,n),t.baseMediaDecodeTime=Gl(t,i.keepOriginalTimestamps),Gf(t,o,a,s),t.samples=zf(o),v=Yr.mdat(qf(o)),r=[],u=Yr.moof(e,[t]),C=new Uint8Array(u.byteLength+v.byteLength),e++,C.set(u),C.set(v,u.byteLength),Ti(t),this.trigger("data",{track:t,boxes:C}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}}).prototype=new Et,(fn=function(t,i){var r,e,n=0,a=[],s=[];i=i||{},fn.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(o){ts(t,o),o.nalUnitType!=="seq_parameter_set_rbsp"||r||(r=o.config,t.sps=[o.data],fs.forEach(function(u){t[u]=r[u]},this)),o.nalUnitType!=="pic_parameter_set_rbsp"||e||(e=o.data,t.pps=[o.data]),a.push(o)},this.flush=function(){for(var o,u,v,C,k,M,j,G,H=0;a.length&&a[0].nalUnitType!=="access_unit_delimiter_rbsp";)a.shift();if(a.length===0)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(o=xf(a),(v=Df(o))[0][0].keyFrame||((u=this.getGopForFusion_(a[0],t))?(H=u.duration,v.unshift(u),v.byteLength+=u.byteLength,v.nalCount+=u.nalCount,v.pts=u.pts,v.dts=u.dts,v.duration+=u.duration):v=Mf(v)),s.length){var K;if(!(K=i.alignGopsAtEnd?this.alignGopsAtEnd_(v):this.alignGopsAtStart_(v)))return this.gopCache_.unshift({gop:v.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Ti(t),v=K}ts(t,v),t.samples=Uf(v),k=Yr.mdat(jf(v)),t.baseMediaDecodeTime=Gl(t,i.keepOriginalTimestamps),this.trigger("processedGopsInfo",v.map(function(W){return{pts:W.pts,dts:W.dts,byteLength:W.byteLength}})),j=v[0],G=v[v.length-1],this.trigger("segmentTimingInfo",Ql(t.baseMediaDecodeTime,j.dts,j.pts,G.dts+G.duration,G.pts+G.duration,H)),this.gopCache_.unshift({gop:v.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime),this.trigger("timelineStartInfo",t.timelineStartInfo),C=Yr.moof(n,[t]),M=new Uint8Array(C.byteLength+k.byteLength),n++,M.set(C),M.set(k,C.byteLength),this.trigger("data",{track:t,boxes:M}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){Ti(t),r=void 0,e=void 0},this.getGopForFusion_=function(o){var u,v,C,k,M,j=1/0;for(M=0;M<this.gopCache_.length;M++)C=(k=this.gopCache_[M]).gop,t.pps&&Jl(t.pps[0],k.pps[0])&&t.sps&&Jl(t.sps[0],k.sps[0])&&(C.dts<t.timelineStartInfo.dts||(u=o.dts-C.dts-C.duration)>=-1e4&&u<=45e3&&(!v||j>u)&&(v=k,j=u));return v?v.gop:null},this.alignGopsAtStart_=function(o){var u,v,C,k,M,j,G,H;for(M=o.byteLength,j=o.nalCount,G=o.duration,u=v=0;u<s.length&&v<o.length&&(C=s[u],k=o[v],C.pts!==k.pts);)k.pts>C.pts?u++:(v++,M-=k.byteLength,j-=k.nalCount,G-=k.duration);return v===0?o:v===o.length?null:((H=o.slice(v)).byteLength=M,H.duration=G,H.nalCount=j,H.pts=H[0].pts,H.dts=H[0].dts,H)},this.alignGopsAtEnd_=function(o){var u,v,C,k,M,j,G;for(u=s.length-1,v=o.length-1,M=null,j=!1;u>=0&&v>=0;){if(C=s[u],k=o[v],C.pts===k.pts){j=!0;break}C.pts>k.pts?u--:(u===s.length-1&&(M=v),v--)}if(!j&&M===null)return null;if((G=j?v:M)===0)return o;var H=o.slice(G),K=H.reduce(function(W,Y){return W.byteLength+=Y.byteLength,W.duration+=Y.duration,W.nalCount+=Y.nalCount,W},{byteLength:0,duration:0,nalCount:0});return H.byteLength=K.byteLength,H.duration=K.duration,H.nalCount=K.nalCount,H.pts=H[0].pts,H.dts=H[0].dts,H},this.alignGopsWith=function(o){s=o}}).prototype=new Et,(ki=function(t,i){this.numberOfTracks=0,this.metadataStream=i,(t=t||{}).remux!==void 0?this.remuxTracks=!!t.remux:this.remuxTracks=!0,typeof t.keepOriginalTimestamps=="boolean"&&(this.keepOriginalTimestamps=t.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,ki.prototype.init.call(this),this.push=function(r){return r.text?this.pendingCaptions.push(r):r.frames?this.pendingMetadata.push(r):(this.pendingTracks.push(r.track),this.pendingBoxes.push(r.boxes),this.pendingBytes+=r.boxes.byteLength,r.track.type==="video"&&(this.videoTrack=r.track),void(r.track.type==="audio"&&(this.audioTrack=r.track)))}}).prototype=new Et,ki.prototype.flush=function(t){var i,r,e,n,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if(t!=="VideoSegmentStream"&&t!=="AudioSegmentStream"||this.remuxTracks)return;if(this.pendingTracks.length===0)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,fs.forEach(function(u){s.info[u]=this.videoTrack[u]},this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,hs.forEach(function(u){s.info[u]=this.audioTrack[u]},this)),this.pendingTracks.length===1?s.type=this.pendingTracks[0].type:s.type="combined",this.emittedTracks+=this.pendingTracks.length,e=Yr.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(e.byteLength),s.initSegment.set(e),s.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)s.data.set(this.pendingBoxes[n],a),a+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)(i=this.pendingCaptions[n]).startTime=i.startPts,this.keepOriginalTimestamps||(i.startTime-=o),i.startTime/=9e4,i.endTime=i.endPts,this.keepOriginalTimestamps||(i.endTime-=o),i.endTime/=9e4,s.captionStreams[i.stream]=!0,s.captions.push(i);for(n=0;n<this.pendingMetadata.length;n++)(r=this.pendingMetadata[n]).cueTime=r.pts,this.keepOriginalTimestamps||(r.cueTime-=o),r.cueTime/=9e4,s.metadata.push(r);s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(ds=function(t){var i,r,e=this,n=!0;ds.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var a={};this.transmuxPipeline_=a,a.type="aac",a.metadataStream=new Jt.MetadataStream,a.aacStream=new sp,a.audioTimestampRolloverStream=new Jt.TimestampRolloverStream("audio"),a.timedMetadataTimestampRolloverStream=new Jt.TimestampRolloverStream("timed-metadata"),a.adtsStream=new Xl,a.coalesceStream=new ki(t,a.metadataStream),a.headOfPipeline=a.aacStream,a.aacStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream),a.aacStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream),a.metadataStream.on("timestamp",function(s){a.aacStream.setTimestamp(s.timeStamp)}),a.aacStream.on("data",function(s){s.type!=="timed-metadata"||a.audioSegmentStream||(r=r||{timelineStartInfo:{baseMediaDecodeTime:e.baseMediaDecodeTime},codec:"adts",type:"audio"},a.coalesceStream.numberOfTracks++,a.audioSegmentStream=new Si(r,t),a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream))}),a.coalesceStream.on("data",this.trigger.bind(this,"data")),a.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var a={};this.transmuxPipeline_=a,a.type="ts",a.metadataStream=new Jt.MetadataStream,a.packetStream=new Jt.TransportPacketStream,a.parseStream=new Jt.TransportParseStream,a.elementaryStream=new Jt.ElementaryStream,a.videoTimestampRolloverStream=new Jt.TimestampRolloverStream("video"),a.audioTimestampRolloverStream=new Jt.TimestampRolloverStream("audio"),a.timedMetadataTimestampRolloverStream=new Jt.TimestampRolloverStream("timed-metadata"),a.adtsStream=new Xl,a.h264Stream=new op,a.captionStream=new Jt.CaptionStream,a.coalesceStream=new ki(t,a.metadataStream),a.headOfPipeline=a.packetStream,a.packetStream.pipe(a.parseStream).pipe(a.elementaryStream),a.elementaryStream.pipe(a.videoTimestampRolloverStream).pipe(a.h264Stream),a.elementaryStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream),a.elementaryStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream),a.h264Stream.pipe(a.captionStream).pipe(a.coalesceStream),a.elementaryStream.on("data",function(s){var o;if(s.type==="metadata"){for(o=s.tracks.length;o--;)i||s.tracks[o].type!=="video"?r||s.tracks[o].type!=="audio"||((r=s.tracks[o]).timelineStartInfo.baseMediaDecodeTime=e.baseMediaDecodeTime):(i=s.tracks[o]).timelineStartInfo.baseMediaDecodeTime=e.baseMediaDecodeTime;i&&!a.videoSegmentStream&&(a.coalesceStream.numberOfTracks++,a.videoSegmentStream=new fn(i,t),a.videoSegmentStream.on("timelineStartInfo",function(u){r&&(r.timelineStartInfo=u,a.audioSegmentStream.setEarliestDts(u.dts))}),a.videoSegmentStream.on("processedGopsInfo",e.trigger.bind(e,"gopInfo")),a.videoSegmentStream.on("segmentTimingInfo",e.trigger.bind(e,"videoSegmentTimingInfo")),a.videoSegmentStream.on("baseMediaDecodeTime",function(u){r&&a.audioSegmentStream.setVideoBaseMediaDecodeTime(u)}),a.h264Stream.pipe(a.videoSegmentStream).pipe(a.coalesceStream)),r&&!a.audioSegmentStream&&(a.coalesceStream.numberOfTracks++,a.audioSegmentStream=new Si(r,t),a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream))}}),a.coalesceStream.on("data",this.trigger.bind(this,"data")),a.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(a){var s=this.transmuxPipeline_;t.keepOriginalTimestamps||(this.baseMediaDecodeTime=a),r&&(r.timelineStartInfo.dts=void 0,r.timelineStartInfo.pts=void 0,Ti(r),t.keepOriginalTimestamps||(r.timelineStartInfo.baseMediaDecodeTime=a),s.audioTimestampRolloverStream&&s.audioTimestampRolloverStream.discontinuity()),i&&(s.videoSegmentStream&&(s.videoSegmentStream.gopCache_=[],s.videoTimestampRolloverStream.discontinuity()),i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,Ti(i),s.captionStream.reset(),t.keepOriginalTimestamps||(i.timelineStartInfo.baseMediaDecodeTime=a)),s.timedMetadataTimestampRolloverStream&&s.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(a){r&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(a)},this.alignGopsWith=function(a){i&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(a)},this.push=function(a){if(n){var s=up(a);s&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():s||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline(),n=!1}this.transmuxPipeline_.headOfPipeline.push(a)},this.flush=function(){n=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new Et;var ps={Transmuxer:ds,VideoSegmentStream:fn,AudioSegmentStream:Si,AUDIO_PROPERTIES:hs,VIDEO_PROPERTIES:fs,generateVideoSegmentTimingInfo:Ql},lp=Xf,cp=rs.CaptionStream,dp=function(t,i){for(var r=t,e=0;e<i.length;e++){var n=i[e];if(r<n.size)return n;r-=n.size}return null},hp=function(t,i){var r=Yt.findBox(t,["moof","traf"]),e={},n=[];return Yt.findBox(t,["mdat"]).forEach(function(a,s){var o=r[s];n.push({mdat:a,traf:o})}),n.forEach(function(a){var s,o=a.mdat,u=a.traf,v=Yt.findBox(u,["tfhd"]),C=an.parseTfhd(v[0]),k=C.trackId,M=Yt.findBox(u,["tfdt"]),j=M.length>0?an.parseTfdt(M[0]).baseMediaDecodeTime:0,G=Yt.findBox(u,["trun"]);i===k&&G.length>0&&(s=function(H,K,W){var Y,ne,ie,le,ge=new DataView(H.buffer,H.byteOffset,H.byteLength),Se=[];for(ne=0;ne+4<H.length;ne+=ie)if(ie=ge.getUint32(ne),ne+=4,!(ie<=0))switch(31&H[ne]){case 6:var ce=H.subarray(ne+1,ne+1+ie),Ee=dp(ne,K);Y={nalUnitType:"sei_rbsp",size:ie,data:ce,escapedRBSP:lp(ce),trackId:W},Ee?(Y.pts=Ee.pts,Y.dts=Ee.dts,le=Ee):(Y.pts=le.pts,Y.dts=le.dts),Se.push(Y)}return Se}(o,function(H,K,W){var Y=K,ne=W.defaultSampleDuration||0,ie=W.defaultSampleSize||0,le=W.trackId,ge=[];return H.forEach(function(Se){var ce=an.parseTrun(Se).samples;ce.forEach(function(Ee){Ee.duration===void 0&&(Ee.duration=ne),Ee.size===void 0&&(Ee.size=ie),Ee.trackId=le,Ee.dts=Y,Ee.compositionTimeOffset===void 0&&(Ee.compositionTimeOffset=0),Ee.pts=Y+Ee.compositionTimeOffset,Y+=Ee.duration}),ge=ge.concat(ce)}),ge}(G,j,C),k),e[k]||(e[k]=[]),e[k]=e[k].concat(s))}),e},fp={generator:Yr,probe:Yt,Transmuxer:ps.Transmuxer,AudioSegmentStream:ps.AudioSegmentStream,VideoSegmentStream:ps.VideoSegmentStream,CaptionParser:function(){var t,i,r,e,n,a=!1;this.isInitialized=function(){return a},this.init=function(){t=new cp,a=!0,t.on("data",function(s){s.startTime=s.startPts/e,s.endTime=s.endPts/e,n.captions.push(s),n.captionStreams[s.stream]=!0})},this.isNewInit=function(s,o){return!(s&&s.length===0||o&&typeof o=="object"&&Object.keys(o).length===0||r===s[0]&&e===o[r])},this.parse=function(s,o,u){var v;if(!this.isInitialized()||!o||!u)return null;if(this.isNewInit(o,u))r=o[0],e=u[r];else if(!r||!e)return i.push(s),null;for(;i.length>0;){var C=i.shift();this.parse(C,o,u)}return(v=function(k,M,j){return M?{seiNals:hp(k,M)[M],timescale:j}:null}(s,r,e))!==null&&v.seiNals?(this.pushNals(v.seiNals),this.flushStream(),n):null},this.pushNals=function(s){if(!this.isInitialized()||!s||s.length===0)return null;s.forEach(function(o){t.push(o)})},this.flushStream=function(){if(!this.isInitialized())return null;t.flush()},this.clearParsedCaptions=function(){n.captions=[],n.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){i=[],r=null,e=null,n?this.clearParsedCaptions():n={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}}.CaptionParser,Zl=function(t){var i=31&t[1];return i<<=8,i|=t[2]},pn=function(t){return!!(64&t[1])},mn=function(t){var i=0;return(48&t[3])>>>4>1&&(i+=t[4]+1),i},ms=function(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},pp={parseType:function(t,i){var r=Zl(t);return r===0?"pat":r===i?"pmt":i?"pes":null},parsePat:function(t){var i=pn(t),r=4+mn(t);return i&&(r+=t[r]+1),(31&t[r+10])<<8|t[r+11]},parsePmt:function(t){var i={},r=pn(t),e=4+mn(t);if(r&&(e+=t[e]+1),1&t[e+5]){var n;n=3+((15&t[e+1])<<8|t[e+2])-4;for(var a=12+((15&t[e+10])<<8|t[e+11]);a<n;){var s=e+a;i[(31&t[s+1])<<8|t[s+2]]=t[s],a+=5+((15&t[s+3])<<8|t[s+4])}return i}},parsePayloadUnitStartIndicator:pn,parsePesType:function(t,i){switch(i[Zl(t)]){case mt.H264_STREAM_TYPE:return"video";case mt.ADTS_STREAM_TYPE:return"audio";case mt.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(t){if(!pn(t))return null;var i=4+mn(t);if(i>=t.byteLength)return null;var r,e=null;return 192&(r=t[i+7])&&((e={}).pts=(14&t[i+9])<<27|(255&t[i+10])<<20|(254&t[i+11])<<12|(255&t[i+12])<<5|(254&t[i+13])>>>3,e.pts*=4,e.pts+=(6&t[i+13])>>>1,e.dts=e.pts,64&r&&(e.dts=(14&t[i+14])<<27|(255&t[i+15])<<20|(254&t[i+16])<<12|(255&t[i+17])<<5|(254&t[i+18])>>>3,e.dts*=4,e.dts+=(6&t[i+18])>>>1)),e},videoPacketContainsKeyFrame:function(t){for(var i=4+mn(t),r=t.subarray(i),e=0,n=0,a=!1;n<r.byteLength-3;n++)if(r[n+2]===1){e=n+5;break}for(;e<r.byteLength;)switch(r[e]){case 0:if(r[e-1]!==0){e+=2;break}if(r[e-2]!==0){e++;break}n+3!==e-2&&ms(31&r[n+3])==="slice_layer_without_partitioning_rbsp_idr"&&(a=!0);do e++;while(r[e]!==1&&e<r.length);n=e-2,e+=3;break;case 1:if(r[e-1]!==0||r[e-2]!==0){e+=3;break}ms(31&r[n+3])==="slice_layer_without_partitioning_rbsp_idr"&&(a=!0),n=e-2,e+=3;break;default:e+=3}return r=r.subarray(n),e-=n,n=0,r&&r.byteLength>3&&ms(31&r[n+3])==="slice_layer_without_partitioning_rbsp_idr"&&(a=!0),a}},Jr=ep,Ke={};Ke.ts=pp,Ke.aac=hn;var mp=function(t,i,r){for(var e,n,a,s,o=0,u=188,v=!1;u<=t.byteLength;)if(t[o]!==71||t[u]!==71&&u!==t.byteLength)o++,u++;else{switch(e=t.subarray(o,u),Ke.ts.parseType(e,i.pid)){case"pes":n=Ke.ts.parsePesType(e,i.table),a=Ke.ts.parsePayloadUnitStartIndicator(e),n==="audio"&&a&&(s=Ke.ts.parsePesTime(e))&&(s.type="audio",r.audio.push(s),v=!0)}if(v)break;o+=188,u+=188}for(o=(u=t.byteLength)-188,v=!1;o>=0;)if(t[o]!==71||t[u]!==71&&u!==t.byteLength)o--,u--;else{switch(e=t.subarray(o,u),Ke.ts.parseType(e,i.pid)){case"pes":n=Ke.ts.parsePesType(e,i.table),a=Ke.ts.parsePayloadUnitStartIndicator(e),n==="audio"&&a&&(s=Ke.ts.parsePesTime(e))&&(s.type="audio",r.audio.push(s),v=!0)}if(v)break;o-=188,u-=188}},gp=function(t,i,r){for(var e,n,a,s,o,u,v,C=0,k=188,M=!1,j={data:[],size:0};k<t.byteLength;)if(t[C]!==71||t[k]!==71)C++,k++;else{switch(e=t.subarray(C,k),Ke.ts.parseType(e,i.pid)){case"pes":if(n=Ke.ts.parsePesType(e,i.table),a=Ke.ts.parsePayloadUnitStartIndicator(e),n==="video"&&(a&&!M&&(s=Ke.ts.parsePesTime(e))&&(s.type="video",r.video.push(s),M=!0),!r.firstKeyFrame)){if(a&&j.size!==0){for(o=new Uint8Array(j.size),u=0;j.data.length;)v=j.data.shift(),o.set(v,u),u+=v.byteLength;if(Ke.ts.videoPacketContainsKeyFrame(o)){var G=Ke.ts.parsePesTime(o);G?(r.firstKeyFrame=G,r.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}j.size=0}j.data.push(e),j.size+=e.byteLength}}if(M&&r.firstKeyFrame)break;C+=188,k+=188}for(C=(k=t.byteLength)-188,M=!1;C>=0;)if(t[C]!==71||t[k]!==71)C--,k--;else{switch(e=t.subarray(C,k),Ke.ts.parseType(e,i.pid)){case"pes":n=Ke.ts.parsePesType(e,i.table),a=Ke.ts.parsePayloadUnitStartIndicator(e),n==="video"&&a&&(s=Ke.ts.parsePesTime(e))&&(s.type="video",r.video.push(s),M=!0)}if(M)break;C-=188,k-=188}},vp=function(t){var i={pid:null,table:null},r={};for(var e in function(n,a){for(var s,o=0,u=188;u<n.byteLength;)if(n[o]!==71||n[u]!==71)o++,u++;else{switch(s=n.subarray(o,u),Ke.ts.parseType(s,a.pid)){case"pat":a.pid||(a.pid=Ke.ts.parsePat(s));break;case"pmt":a.table||(a.table=Ke.ts.parsePmt(s))}if(a.pid&&a.table)return;o+=188,u+=188}}(t,i),i.table)if(i.table.hasOwnProperty(e))switch(i.table[e]){case mt.H264_STREAM_TYPE:r.video=[],gp(t,i,r),r.video.length===0&&delete r.video;break;case mt.ADTS_STREAM_TYPE:r.audio=[],mp(t,i,r),r.audio.length===0&&delete r.audio}return r},yp=function(t,i){var r;return(r=Ke.aac.isLikelyAacData(t)?function(e){for(var n,a=!1,s=0,o=null,u=null,v=0,C=0;e.length-C>=3;){switch(Ke.aac.parseType(e,C)){case"timed-metadata":if(e.length-C<10){a=!0;break}if((v=Ke.aac.parseId3TagSize(e,C))>e.length){a=!0;break}u===null&&(n=e.subarray(C,C+v),u=Ke.aac.parseAacTimestamp(n)),C+=v;break;case"audio":if(e.length-C<7){a=!0;break}if((v=Ke.aac.parseAdtsSize(e,C))>e.length){a=!0;break}o===null&&(n=e.subarray(C,C+v),o=Ke.aac.parseSampleRate(n)),s++,C+=v;break;default:C++}if(a)return null}if(o===null||u===null)return null;var k=9e4/o;return{audio:[{type:"audio",dts:u,pts:u},{type:"audio",dts:u+1024*s*k,pts:u+1024*s*k}]}}(t):vp(t))&&(r.audio||r.video)?(function(e,n){if(e.audio&&e.audio.length){var a=n;a===void 0&&(a=e.audio[0].dts),e.audio.forEach(function(u){u.dts=Jr(u.dts,a),u.pts=Jr(u.pts,a),u.dtsTime=u.dts/9e4,u.ptsTime=u.pts/9e4})}if(e.video&&e.video.length){var s=n;if(s===void 0&&(s=e.video[0].dts),e.video.forEach(function(u){u.dts=Jr(u.dts,s),u.pts=Jr(u.pts,s),u.dtsTime=u.dts/9e4,u.ptsTime=u.pts/9e4}),e.firstKeyFrame){var o=e.firstKeyFrame;o.dts=Jr(o.dts,s),o.pts=Jr(o.pts,s),o.dtsTime=o.dts/9e4,o.ptsTime=o.dts/9e4}}}(r,i),r):null},gn=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},_p=function(){function t(i,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}return function(i,r,e){return r&&t(i.prototype,r),e&&t(i,e),i}}(),bp=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||typeof i!="object"&&typeof i!="function"?t:i},Tp=function(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]],i=t[0],r=t[1],e=i[4],n=r[4],a=void 0,s=void 0,o=void 0,u=[],v=[],C=void 0,k=void 0,M=void 0,j=void 0,G=void 0;for(a=0;a<256;a++)v[(u[a]=a<<1^283*(a>>7))^a]=a;for(s=o=0;!e[s];s^=C||1,o=v[o]||1)for(M=(M=o^o<<1^o<<2^o<<3^o<<4)>>8^255&M^99,e[s]=M,n[M]=s,G=16843009*u[k=u[C=u[s]]]^65537*k^257*C^16843008*s,j=257*u[M]^16843008*M,a=0;a<4;a++)i[a][s]=j=j<<24^j>>>8,r[a][M]=G=G<<24^G>>>8;for(a=0;a<5;a++)i[a]=i[a].slice(0),r[a]=r[a].slice(0);return t},Gt=null,Sp=function(){function t(i){gn(this,t),Gt||(Gt=Tp()),this._tables=[[Gt[0][0].slice(),Gt[0][1].slice(),Gt[0][2].slice(),Gt[0][3].slice(),Gt[0][4].slice()],[Gt[1][0].slice(),Gt[1][1].slice(),Gt[1][2].slice(),Gt[1][3].slice(),Gt[1][4].slice()]];var r=void 0,e=void 0,n=void 0,a=void 0,s=void 0,o=this._tables[0][4],u=this._tables[1],v=i.length,C=1;if(v!==4&&v!==6&&v!==8)throw new Error("Invalid aes key size");for(a=i.slice(0),s=[],this._key=[a,s],r=v;r<4*v+28;r++)n=a[r-1],(r%v==0||v===8&&r%v==4)&&(n=o[n>>>24]<<24^o[n>>16&255]<<16^o[n>>8&255]<<8^o[255&n],r%v==0&&(n=n<<8^n>>>24^C<<24,C=C<<1^283*(C>>7))),a[r]=a[r-v]^n;for(e=0;r;e++,r--)n=a[3&e?r:r-4],s[e]=r<=4||e<4?n:u[0][o[n>>>24]]^u[1][o[n>>16&255]]^u[2][o[n>>8&255]]^u[3][o[255&n]]}return t.prototype.decrypt=function(i,r,e,n,a,s){var o=this._key[1],u=i^o[0],v=n^o[1],C=e^o[2],k=r^o[3],M=void 0,j=void 0,G=void 0,H=o.length/4-2,K=void 0,W=4,Y=this._tables[1],ne=Y[0],ie=Y[1],le=Y[2],ge=Y[3],Se=Y[4];for(K=0;K<H;K++)M=ne[u>>>24]^ie[v>>16&255]^le[C>>8&255]^ge[255&k]^o[W],j=ne[v>>>24]^ie[C>>16&255]^le[k>>8&255]^ge[255&u]^o[W+1],G=ne[C>>>24]^ie[k>>16&255]^le[u>>8&255]^ge[255&v]^o[W+2],k=ne[k>>>24]^ie[u>>16&255]^le[v>>8&255]^ge[255&C]^o[W+3],W+=4,u=M,v=j,C=G;for(K=0;K<4;K++)a[(3&-K)+s]=Se[u>>>24]<<24^Se[v>>16&255]<<16^Se[C>>8&255]<<8^Se[255&k]^o[W++],M=u,u=v,v=C,C=k,k=M},t}(),ec=function(){function t(){gn(this,t),this.listeners={}}return t.prototype.on=function(i,r){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(r)},t.prototype.off=function(i,r){if(!this.listeners[i])return!1;var e=this.listeners[i].indexOf(r);return this.listeners[i].splice(e,1),e>-1},t.prototype.trigger=function(i){var r=this.listeners[i];if(r)if(arguments.length===2)for(var e=r.length,n=0;n<e;++n)r[n].call(this,arguments[1]);else for(var a=Array.prototype.slice.call(arguments,1),s=r.length,o=0;o<s;++o)r[o].apply(this,a)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(i){this.on("data",function(r){i.push(r)})},t}(),tc=function(t){function i(){gn(this,i);var r=bp(this,t.call(this,ec));return r.jobs=[],r.delay=1,r.timeout_=null,r}return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}(i,t),i.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},i.prototype.push=function(r){this.jobs.push(r),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},i}(ec),Ht=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},rc=function(t,i,r){var e=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),n=new Sp(Array.prototype.slice.call(i)),a=new Uint8Array(t.byteLength),s=new Int32Array(a.buffer),o=void 0,u=void 0,v=void 0,C=void 0,k=void 0,M=void 0,j=void 0,G=void 0,H=void 0;for(o=r[0],u=r[1],v=r[2],C=r[3],H=0;H<e.length;H+=4)k=Ht(e[H]),M=Ht(e[H+1]),j=Ht(e[H+2]),G=Ht(e[H+3]),n.decrypt(k,M,j,G,s,H),s[H]=Ht(s[H]^o),s[H+1]=Ht(s[H+1]^u),s[H+2]=Ht(s[H+2]^v),s[H+3]=Ht(s[H+3]^C),o=k,u=M,v=j,C=G;return a},kp=function(){function t(i,r,e,n){gn(this,t);var a=t.STEP,s=new Int32Array(i.buffer),o=new Uint8Array(i.byteLength),u=0;for(this.asyncStream_=new tc,this.asyncStream_.push(this.decryptChunk_(s.subarray(u,u+a),r,e,o)),u=a;u<s.length;u+=a)e=new Uint32Array([Ht(s[u-4]),Ht(s[u-3]),Ht(s[u-2]),Ht(s[u-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(u,u+a),r,e,o));this.asyncStream_.push(function(){var v;n(null,(v=o).subarray(0,v.byteLength-v[v.byteLength-1]))})}return t.prototype.decryptChunk_=function(i,r,e,n){return function(){var a=rc(i,r,e);n.set(a,i.byteOffset)}},_p(t,null,[{key:"STEP",get:function(){return 32e3}}]),t}(),Or=function(t,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(t)||(t=Vu.buildAbsoluteURL(L.location.href,t)),Vu.buildAbsoluteURL(t,i))},vn=function(t,i,r){return t&&r.responseURL&&i!==r.responseURL?r.responseURL:i},zt=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},Qt=function(){function t(i,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}return function(i,r,e){return r&&t(i.prototype,r),e&&t(i,e),i}}(),or=function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)},ar=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||typeof i!="object"&&typeof i!="function"?t:i},Ep=function(){return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(r,e){var n=[],a=!0,s=!1,o=void 0;try{for(var u,v=r[Symbol.iterator]();!(a=(u=v.next()).done)&&(n.push(u.value),!e||n.length!==e);a=!0);}catch(C){s=!0,o=C}finally{try{!a&&v.return&&v.return()}finally{if(s)throw o}}return n}(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),gs=J.mergeOptions,Cp=J.EventTarget,wp=J.log,yn=function(t,i){["AUDIO","SUBTITLES"].forEach(function(r){for(var e in t.mediaGroups[r])for(var n in t.mediaGroups[r][e]){var a=t.mediaGroups[r][e][n];i(a,r,e,n)}})},vs=function(t,i){var r=gs(t,{}),e=r.playlists[i.uri];if(!e||e.segments&&i.segments&&e.segments.length===i.segments.length&&e.endList===i.endList&&e.mediaSequence===i.mediaSequence)return null;var n=gs(e,i);e.segments&&(n.segments=function(s,o,u){var v=o.slice();u=u||0;for(var C=Math.min(s.length,o.length+u),k=u;k<C;k++)v[k-u]=gs(s[k],v[k-u]);return v}(e.segments,i.segments,i.mediaSequence-e.mediaSequence)),n.segments.forEach(function(s){(function(o,u){o.resolvedUri||(o.resolvedUri=Or(u,o.uri)),o.key&&!o.key.resolvedUri&&(o.key.resolvedUri=Or(u,o.key.uri)),o.map&&!o.map.resolvedUri&&(o.map.resolvedUri=Or(u,o.map.uri))})(s,n.resolvedUri)});for(var a=0;a<r.playlists.length;a++)r.playlists[a].uri===i.uri&&(r.playlists[a]=n);return r.playlists[i.uri]=n,r},ic=function(t){for(var i=t.playlists.length;i--;){var r=t.playlists[i];t.playlists[r.uri]=r,r.resolvedUri=Or(t.uri,r.uri),r.id=i,r.attributes||(r.attributes={},wp.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},nc=function(t){yn(t,function(i){i.uri&&(i.resolvedUri=Or(t.uri,i.uri))})},ac=function(t,i){var r=t.segments[t.segments.length-1];return i&&r&&r.duration?1e3*r.duration:500*(t.targetDuration||10)},_n=function(t){function i(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};zt(this,i);var a=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),s=n.withCredentials,o=s!==void 0&&s,u=n.handleManifestRedirects,v=u!==void 0&&u;a.srcUrl=r,a.hls_=e,a.withCredentials=o,a.handleManifestRedirects=v;var C=e.options_;if(a.customTagParsers=C&&C.customTagParsers||[],a.customTagMappers=C&&C.customTagMappers||[],!a.srcUrl)throw new Error("A non-empty playlist URL is required");return a.state="HAVE_NOTHING",a.on("mediaupdatetimeout",function(){a.state==="HAVE_METADATA"&&(a.state="HAVE_CURRENT_METADATA",a.request=a.hls_.xhr({uri:Or(a.master.uri,a.media().uri),withCredentials:a.withCredentials},function(k,M){if(a.request)return k?a.playlistRequestError(a.request,a.media().uri,"HAVE_METADATA"):void a.haveMetadata(a.request,a.media().uri)}))}),a}return or(i,Cp),Qt(i,[{key:"playlistRequestError",value:function(r,e,n){this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[e],status:r.status,message:"HLS playlist request error at URL: "+e+".",responseText:r.responseText,code:r.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(r,e){var n=this;this.request=null,this.state="HAVE_METADATA";var a=new zu;this.customTagParsers.forEach(function(o){return a.addParser(o)}),this.customTagMappers.forEach(function(o){return a.addTagMapper(o)}),a.push(r.responseText),a.end(),a.manifest.uri=e,a.manifest.attributes=a.manifest.attributes||{};var s=vs(this.master,a.manifest);this.targetDuration=a.manifest.targetDuration,s?(this.master=s,this.media_=this.master.playlists[a.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(L.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=L.setTimeout(function(){n.trigger("mediaupdatetimeout")},ac(this.media(),!!s))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),L.clearTimeout(this.mediaUpdateTimeout),L.clearTimeout(this.finalRenditionTimeout)}},{key:"stopRequest",value:function(){if(this.request){var r=this.request;this.request=null,r.onreadystatechange=null,r.abort()}}},{key:"media",value:function(r,e){var n=this;if(!r)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof r=="string"){if(!this.master.playlists[r])throw new Error("Unknown playlist URI: "+r);r=this.master.playlists[r]}if(L.clearTimeout(this.finalRenditionTimeout),e){var a=r.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=L.setTimeout(this.media.bind(this,r,!1),a)}else{var s=this.state,o=!this.media_||r.uri!==this.media_.uri;if(this.master.playlists[r.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=r,void(o&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(r.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:r.resolvedUri,withCredentials:this.withCredentials},function(u,v){if(n.request){if(r.resolvedUri=vn(n.handleManifestRedirects,r.resolvedUri,v),u)return n.playlistRequestError(n.request,r.uri,s);n.haveMetadata(v,r.uri),s==="HAVE_MASTER"?n.trigger("loadedmetadata"):n.trigger("mediachange")}})}}}},{key:"pause",value:function(){this.stopRequest(),L.clearTimeout(this.mediaUpdateTimeout),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}},{key:"load",value:function(r){var e=this;L.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(r){var a=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=L.setTimeout(function(){return e.load()},a)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var r=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,n){if(r.request){if(r.request=null,e)return r.error={status:n.status,message:"HLS playlist request error at URL: "+r.srcUrl+".",responseText:n.responseText,code:2},r.state==="HAVE_NOTHING"&&(r.started=!1),r.trigger("error");var a=new zu;return r.customTagParsers.forEach(function(s){return a.addParser(s)}),r.customTagMappers.forEach(function(s){return a.addTagMapper(s)}),a.push(n.responseText),a.end(),r.state="HAVE_MASTER",r.srcUrl=vn(r.handleManifestRedirects,r.srcUrl,n),a.manifest.uri=r.srcUrl,a.manifest.playlists?(r.master=a.manifest,ic(r.master),nc(r.master),r.trigger("loadedplaylist"),void(r.request||r.media(a.manifest.playlists[0]))):(r.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:L.location.href,playlists:[{uri:r.srcUrl,id:0,resolvedUri:r.srcUrl,attributes:{}}]},r.master.playlists[r.srcUrl]=r.master.playlists[0],r.haveMetadata(n,r.srcUrl),r.trigger("loadedmetadata"))}})}}]),i}(),sc=J.createTimeRange,oc=function(t,i,r){var e,n;return i===void 0&&(i=t.mediaSequence+t.segments.length),i<t.mediaSequence?0:(e=function(a,s){var o=0,u=s-a.mediaSequence,v=a.segments[u];if(v){if(v.start!==void 0)return{result:v.start,precise:!0};if(v.end!==void 0)return{result:v.end-v.duration,precise:!0}}for(;u--;){if((v=a.segments[u]).end!==void 0)return{result:o+v.end,precise:!0};if(o+=v.duration,v.start!==void 0)return{result:o+v.start,precise:!0}}return{result:o,precise:!1}}(t,i)).precise?e.result:(n=function(a,s){for(var o=0,u=void 0,v=s-a.mediaSequence;v<a.segments.length;v++){if((u=a.segments[v]).start!==void 0)return{result:u.start-o,precise:!0};if(o+=u.duration,u.end!==void 0)return{result:u.end-o,precise:!0}}return{result:-1,precise:!1}}(t,i)).precise?n.result:e.result+r},uc=function(t,i,r){if(!t)return 0;if(typeof r!="number"&&(r=0),i===void 0){if(t.totalDuration)return t.totalDuration;if(!t.endList)return L.Infinity}return oc(t,i,r)},Ei=function(t,i,r){var e=0;if(i>r){var n=[r,i];i=n[0],r=n[1]}if(i<0){for(var a=i;a<Math.min(0,r);a++)e+=t.targetDuration;i=0}for(var s=i;s<r;s++)e+=t.segments[s].duration;return e},lc=function(t){if(!t.segments.length)return 0;for(var i=t.segments.length-1,r=t.segments[i].duration||t.targetDuration,e=r+2*t.targetDuration;i--&&!((r+=t.segments[i].duration)>=e););return Math.max(0,i)},cc=function(t,i,r){if(!t||!t.segments)return null;if(t.endList)return uc(t);if(i===null)return null;i=i||0;var e=r?lc(t):t.segments.length;return oc(t,t.mediaSequence+e,i)},dc=function(t){return t-Math.floor(t)==0},hc=function(t,i){if(dc(i))return i+.1*t;for(var r=i.toString().split(".")[1].length,e=1;e<=r;e++){var n=Math.pow(10,e),a=i*n;if(dc(a)||e===r)return(a+t)/n}},Pp=hc.bind(null,1),Ap=hc.bind(null,-1),fc=function(t){return t.excludeUntil&&t.excludeUntil>Date.now()},ys=function(t){return t.excludeUntil&&t.excludeUntil===1/0},bn=function(t){var i=fc(t);return!t.disabled&&!i},pc=function(t,i){return i.attributes&&i.attributes[t]},_s=function(t,i){if(t.playlists.length===1)return!0;var r=i.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter(function(e){return!!bn(e)&&(e.attributes.BANDWIDTH||0)<r}).length===0},At={duration:uc,seekable:function(t,i){var r=i||0,e=cc(t,i,!0);return e===null?sc():sc(r,e)},safeLiveIndex:lc,getMediaInfoForTime:function(t,i,r,e){var n=void 0,a=void 0,s=t.segments.length,o=i-e;if(o<0){if(r>0){for(n=r-1;n>=0;n--)if(a=t.segments[n],(o+=Ap(a.duration))>0)return{mediaIndex:n,startTime:e-Ei(t,r,n)}}return{mediaIndex:0,startTime:i}}if(r<0){for(n=r;n<0;n++)if((o-=t.targetDuration)<0)return{mediaIndex:0,startTime:i};r=0}for(n=r;n<s;n++)if(a=t.segments[n],(o-=Pp(a.duration))<0)return{mediaIndex:n,startTime:e+Ei(t,r,n)};return{mediaIndex:s-1,startTime:i}},isEnabled:bn,isDisabled:function(t){return t.disabled},isBlacklisted:fc,isIncompatible:ys,playlistEnd:cc,isAes:function(t){for(var i=0;i<t.segments.length;i++)if(t.segments[i].key)return!0;return!1},isFmp4:function(t){for(var i=0;i<t.segments.length;i++)if(t.segments[i].map)return!0;return!1},hasAttribute:pc,estimateSegmentRequestTime:function(t,i,r){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return pc("BANDWIDTH",r)?(t*r.attributes.BANDWIDTH-8*e)/i:NaN},isLowestEnabledRendition:_s},Rp=J.xhr,Lp=J.mergeOptions,mc=function(){return function t(i,r){i=Lp({timeout:45e3},i);var e=t.beforeRequest||J.Hls.xhr.beforeRequest;if(e&&typeof e=="function"){var n=e(i);n&&(i=n)}var a=Rp(i,function(o,u){var v=a.response;!o&&v&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=v.byteLength||v.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),u.headers&&(a.responseHeaders=u.headers),o&&o.code==="ETIMEDOUT"&&(a.timedout=!0),o||a.aborted||u.statusCode===200||u.statusCode===206||u.statusCode===0||(o=new Error("XHR Failed with a response of: "+(a&&(v||a.responseText)))),r(o,a)}),s=a.abort;return a.abort=function(){return a.aborted=!0,s.apply(a,arguments)},a.uri=i.uri,a.requestTime=Date.now(),a}},bs=function(t){var i,r,e={};return t.byterange&&(e.Range=(i=t.byterange,r=i.offset+i.length-1,"bytes="+i.offset+"-"+r)),e},Op=function(t,i){return t.start(i)+"-"+t.end(i)},Ip=function(t,i){var r=t.toString(16);return"00".substring(0,2-r.length)+r+(i%2?" ":"")},xp=function(t){return t>=32&&t<126?String.fromCharCode(t):"."},gc=function(t){var i={};return Object.keys(t).forEach(function(r){var e=t[r];ArrayBuffer.isView(e)?i[r]={bytes:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength}:i[r]=e}),i},Tn=function(t){var i=t.byterange||{length:1/0,offset:0};return[i.length,i.offset,t.resolvedUri].join(",")},vc=function(t){return t.resolvedUri},yc=function(t){for(var i=Array.prototype.slice.call(t),r="",e=0;e<i.length/16;e++)r+=i.slice(16*e,16*e+16).map(Ip).join("")+" "+i.slice(16*e,16*e+16).map(xp).join("")+`
`;return r},Dp=Object.freeze({createTransferableMessage:gc,initSegmentId:Tn,segmentKeyId:vc,hexDump:yc,tagDump:function(t){var i=t.bytes;return yc(i)},textRanges:function(t){var i="",r=void 0;for(r=0;r<t.length;r++)i+=Op(t,r)+" ";return i}}),Mp=function(t){var i=t.playlist,r=t.time,e=r===void 0?void 0:r,n=t.callback;if(!n)throw new Error("getProgramTime: callback must be provided");if(!i||e===void 0)return n({message:"getProgramTime: playlist and time must be provided"});var a=function(u,v){if(!v||!v.segments||v.segments.length===0)return null;for(var C=0,k=void 0,M=0;M<v.segments.length&&!(u<=(C=(k=v.segments[M]).videoTimingInfo?k.videoTimingInfo.transmuxedPresentationEnd:C+k.duration));M++);var j=v.segments[v.segments.length-1];if(j.videoTimingInfo&&j.videoTimingInfo.transmuxedPresentationEnd<u)return null;if(u>C){if(u>C+.25*j.duration)return null;k=j}return{segment:k,estimatedStart:k.videoTimingInfo?k.videoTimingInfo.transmuxedPresentationStart:C-k.duration,type:k.videoTimingInfo?"accurate":"estimate"}}(e,i);if(!a)return n({message:"valid programTime was not found"});if(a.type==="estimate")return n({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var s={mediaSeconds:e},o=function(u,v){if(!v.dateTimeObject)return null;var C=v.videoTimingInfo.transmuxerPrependedSeconds,k=u-(v.videoTimingInfo.transmuxedPresentationStart+C);return new Date(v.dateTimeObject.getTime()+1e3*k)}(e,a.segment);return o&&(s.programDateTime=o.toISOString()),n(null,s)},Up=function t(i){var r=i.programTime,e=i.playlist,n=i.retryCount,a=n===void 0?2:n,s=i.seekTo,o=i.pauseAfterSeek,u=o===void 0||o,v=i.tech,C=i.callback;if(!C)throw new Error("seekToProgramTime: callback must be provided");if(r===void 0||!e||!s)return C({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!v.hasStarted_)return C({message:"player must be playing a live stream to start buffering"});if(!function(H){if(!H.segments||H.segments.length===0)return!1;for(var K=0;K<H.segments.length;K++)if(!H.segments[K].dateTimeObject)return!1;return!0}(e))return C({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});var k=function(H,K){var W=void 0;try{W=new Date(H)}catch{return null}if(!K||!K.segments||K.segments.length===0)return null;var Y=K.segments[0];if(W<Y.dateTimeObject)return null;for(var ne=0;ne<K.segments.length-1&&(Y=K.segments[ne],!(W<K.segments[ne+1].dateTimeObject));ne++);var ie,le=K.segments[K.segments.length-1],ge=le.dateTimeObject,Se=le.videoTimingInfo?(ie=le.videoTimingInfo).transmuxedPresentationEnd-ie.transmuxedPresentationStart-ie.transmuxerPrependedSeconds:le.duration+.25*le.duration;return W>new Date(ge.getTime()+1e3*Se)?null:(W>ge&&(Y=le),{segment:Y,estimatedStart:Y.videoTimingInfo?Y.videoTimingInfo.transmuxedPresentationStart:At.duration(K,K.mediaSequence+K.segments.indexOf(Y)),type:Y.videoTimingInfo?"accurate":"estimate"})}(r,e);if(!k)return C({message:r+" was not found in the stream"});var M=k.segment,j=function(H,K){var W=void 0,Y=void 0;try{W=new Date(H),Y=new Date(K)}catch{}var ne=W.getTime();return(Y.getTime()-ne)/1e3}(M.dateTimeObject,r);if(k.type==="estimate")return a===0?C({message:r+" is not buffered yet. Try again"}):(s(k.estimatedStart+j),void v.one("seeked",function(){t({programTime:r,playlist:e,retryCount:a-1,seekTo:s,pauseAfterSeek:u,tech:v,callback:C})}));var G=M.start+j;v.one("seeked",function(){return C(null,v.currentTime())}),u&&v.pause(),s(G)},_c=function(t,i){var r=[],e=void 0;if(t&&t.length)for(e=0;e<t.length;e++)i(t.start(e),t.end(e))&&r.push([t.start(e),t.end(e)]);return J.createTimeRanges(r)},bc=function(t,i){return _c(t,function(r,e){return r-1/30<=i&&e+1/30>=i})},Tc=function(t,i){return _c(t,function(r){return r-1/30>=i})},Ts=function(t){var i=[];if(!t||!t.length)return"";for(var r=0;r<t.length;r++)i.push(t.start(r)+" => "+t.end(r));return i.join(", ")},Sc=function(t){for(var i=[],r=0;r<t.length;r++)i.push({start:t.start(r),end:t.end(r)});return i},Qr=function(t,i,r){var e=void 0,n=void 0;if(r&&r.cues)for(e=r.cues.length;e--;)(n=r.cues[e]).startTime<=i&&n.endTime>=t&&r.removeCue(n)},kc=function(t){return isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t},jp=function(t,i,r){var e=L.WebKitDataCue||L.VTTCue;if(i&&i.forEach(function(C){var k=C.stream;this.inbandTextTracks_[k].addCue(new e(C.startTime+this.timestampOffset,C.endTime+this.timestampOffset,C.text))},t),r){var n=kc(t.mediaSource_.duration);if(r.forEach(function(C){var k=C.cueTime+this.timestampOffset;!(typeof k!="number"||L.isNaN(k)||k<0)&&k<1/0&&C.frames.forEach(function(M){var j=new e(k,k,M.value||M.url||M.data||"");j.frame=M,j.value=M,function(G){Object.defineProperties(G.frame,{id:{get:function(){return J.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),G.value.key}},value:{get:function(){return J.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),G.value.data}},privateData:{get:function(){return J.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),G.value.data}}})}(j),this.metadataTrack_.addCue(j)},this)},t),t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){for(var a=t.metadataTrack_.cues,s=[],o=0;o<a.length;o++)a[o]&&s.push(a[o]);var u=s.reduce(function(C,k){var M=C[k.startTime]||[];return M.push(k),C[k.startTime]=M,C},{}),v=Object.keys(u).sort(function(C,k){return Number(C)-Number(k)});v.forEach(function(C,k){var M=u[C],j=Number(v[k+1])||n;M.forEach(function(G){G.endTime=j})})}}},Ir=typeof window<"u"?window:{},Ss=typeof Symbol>"u"?"__target":Symbol(),Bp="application/javascript",Np=Ir.BlobBuilder||Ir.WebKitBlobBuilder||Ir.MozBlobBuilder||Ir.MSBlobBuilder,Zr=Ir.URL||Ir.webkitURL||Zr&&Zr.msURL,ei=Ir.Worker;function Ec(t,i){return function(r){var e=this;if(!i)return new ei(t);if(ei&&!r){var n=Pc(i.toString().replace(/^function.+?{/,"").slice(0,-1));return this[Ss]=new ei(n),function(s,o){if(!(!s||!o)){var u=s.terminate;s.objURL=o,s.terminate=function(){s.objURL&&Zr.revokeObjectURL(s.objURL),u.call(s)}}}(this[Ss],n),this[Ss]}var a={postMessage:function(s){e.onmessage&&setTimeout(function(){e.onmessage({data:s,target:a})})}};i.call(a),this.postMessage=function(s){setTimeout(function(){a.onmessage({data:s,target:e})})},this.isThisThread=!0}}if(ei){var ks,Cc=Pc("self.onmessage = function () {}"),wc=new Uint8Array(1);try{(ks=new ei(Cc)).postMessage(wc,[wc.buffer])}catch{ei=null}finally{Zr.revokeObjectURL(Cc),ks&&ks.terminate()}}function Pc(t){try{return Zr.createObjectURL(new Blob([t],{type:Bp}))}catch{var i=new Np;return i.append(t),Zr.createObjectURL(i.getBlob(type))}}var Fp=new Ec("./transmuxer-worker.worker.js",function(t,i){var r=this;(function(){var e,n,a,s,o,u,v,C,k,M,j,G,H,K,W,Y,ne,ie,le,ge,Se,ce,Ee,lt,Lt,pr,Ot,jt,qt,Zt,er,et,xr,Dr,ed,td,rd,id,nd,Ds,ad=Math.pow(2,32)-1;(function(){var h;if(ce={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array<"u"){for(h in ce)ce.hasOwnProperty(h)&&(ce[h]=[h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)]);Ee=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Lt=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),lt=new Uint8Array([0,0,0,1]),pr=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Ot=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),jt={video:pr,audio:Ot},er=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Zt=new Uint8Array([0,0,0,0,0,0,0,0]),et=new Uint8Array([0,0,0,0,0,0,0,0]),xr=et,Dr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ed=et,qt=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),e=function(h){var E,R,x=[],B=0;for(E=1;E<arguments.length;E++)x.push(arguments[E]);for(E=x.length;E--;)B+=x[E].byteLength;for(R=new Uint8Array(B+8),new DataView(R.buffer,R.byteOffset,R.byteLength).setUint32(0,R.byteLength),R.set(h,4),E=0,B=8;E<x.length;E++)R.set(x[E],B),B+=x[E].byteLength;return R},n=function(){return e(ce.dinf,e(ce.dref,er))},a=function(h){return e(ce.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,h.audioobjecttype<<3|h.samplingfrequencyindex>>>1,h.samplingfrequencyindex<<7|h.channelcount<<3,6,1,2]))},W=function(h){return e(ce.hdlr,jt[h])},K=function(h){var E=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,h.duration>>>24&255,h.duration>>>16&255,h.duration>>>8&255,255&h.duration,85,196,0,0]);return h.samplerate&&(E[12]=h.samplerate>>>24&255,E[13]=h.samplerate>>>16&255,E[14]=h.samplerate>>>8&255,E[15]=255&h.samplerate),e(ce.mdhd,E)},H=function(h){return e(ce.mdia,K(h),W(h.type),u(h))},o=function(h){return e(ce.mfhd,new Uint8Array([0,0,0,0,(4278190080&h)>>24,(16711680&h)>>16,(65280&h)>>8,255&h]))},u=function(h){return e(ce.minf,h.type==="video"?e(ce.vmhd,qt):e(ce.smhd,Zt),n(),ne(h))},v=function(h,E){for(var R=[],x=E.length;x--;)R[x]=le(E[x]);return e.apply(null,[ce.moof,o(h)].concat(R))},C=function(h){for(var E=h.length,R=[];E--;)R[E]=j(h[E]);return e.apply(null,[ce.moov,M(4294967295)].concat(R).concat(k(h)))},k=function(h){for(var E=h.length,R=[];E--;)R[E]=ge(h[E]);return e.apply(null,[ce.mvex].concat(R))},M=function(h){var E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&h)>>24,(16711680&h)>>16,(65280&h)>>8,255&h,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e(ce.mvhd,E)},Y=function(h){var E,R,x=h.samples||[],B=new Uint8Array(4+x.length);for(R=0;R<x.length;R++)E=x[R].flags,B[R+4]=E.dependsOn<<4|E.isDependedOn<<2|E.hasRedundancy;return e(ce.sdtp,B)},ne=function(h){return e(ce.stbl,ie(h),e(ce.stts,ed),e(ce.stsc,xr),e(ce.stsz,Dr),e(ce.stco,et))},ie=function(h){return e(ce.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),h.type==="video"?td(h):rd(h))},td=function(h){var E,R=h.sps||[],x=h.pps||[],B=[],F=[];for(E=0;E<R.length;E++)B.push((65280&R[E].byteLength)>>>8),B.push(255&R[E].byteLength),B=B.concat(Array.prototype.slice.call(R[E]));for(E=0;E<x.length;E++)F.push((65280&x[E].byteLength)>>>8),F.push(255&x[E].byteLength),F=F.concat(Array.prototype.slice.call(x[E]));return e(ce.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&h.width)>>8,255&h.width,(65280&h.height)>>8,255&h.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),e(ce.avcC,new Uint8Array([1,h.profileIdc,h.profileCompatibility,h.levelIdc,255].concat([R.length]).concat(B).concat([x.length]).concat(F))),e(ce.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},rd=function(h){return e(ce.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&h.channelcount)>>8,255&h.channelcount,(65280&h.samplesize)>>8,255&h.samplesize,0,0,0,0,(65280&h.samplerate)>>8,255&h.samplerate,0,0]),a(h))},G=function(h){var E=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&h.id)>>24,(16711680&h.id)>>16,(65280&h.id)>>8,255&h.id,0,0,0,0,(4278190080&h.duration)>>24,(16711680&h.duration)>>16,(65280&h.duration)>>8,255&h.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&h.width)>>8,255&h.width,0,0,(65280&h.height)>>8,255&h.height,0,0]);return e(ce.tkhd,E)},le=function(h){var E,R,x,B,F,$;return E=e(ce.tfhd,new Uint8Array([0,0,0,58,(4278190080&h.id)>>24,(16711680&h.id)>>16,(65280&h.id)>>8,255&h.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),F=Math.floor(h.baseMediaDecodeTime/(ad+1)),$=Math.floor(h.baseMediaDecodeTime%(ad+1)),R=e(ce.tfdt,new Uint8Array([1,0,0,0,F>>>24&255,F>>>16&255,F>>>8&255,255&F,$>>>24&255,$>>>16&255,$>>>8&255,255&$])),h.type==="audio"?(x=Se(h,92),e(ce.traf,E,R,x)):(B=Y(h),x=Se(h,B.length+92),e(ce.traf,E,R,x,B))},j=function(h){return h.duration=h.duration||4294967295,e(ce.trak,G(h),H(h))},ge=function(h){var E=new Uint8Array([0,0,0,0,(4278190080&h.id)>>24,(16711680&h.id)>>16,(65280&h.id)>>8,255&h.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.type!=="video"&&(E[E.length-1]=0),e(ce.trex,E)},Ds=function(h,E){var R=0,x=0,B=0,F=0;return h.length&&(h[0].duration!==void 0&&(R=1),h[0].size!==void 0&&(x=2),h[0].flags!==void 0&&(B=4),h[0].compositionTimeOffset!==void 0&&(F=8)),[0,0,R|x|B|F,1,(4278190080&h.length)>>>24,(16711680&h.length)>>>16,(65280&h.length)>>>8,255&h.length,(4278190080&E)>>>24,(16711680&E)>>>16,(65280&E)>>>8,255&E]},nd=function(h,E){var R,x,B,F;for(E+=20+16*(x=h.samples||[]).length,R=Ds(x,E),F=0;F<x.length;F++)B=x[F],R=R.concat([(4278190080&B.duration)>>>24,(16711680&B.duration)>>>16,(65280&B.duration)>>>8,255&B.duration,(4278190080&B.size)>>>24,(16711680&B.size)>>>16,(65280&B.size)>>>8,255&B.size,B.flags.isLeading<<2|B.flags.dependsOn,B.flags.isDependedOn<<6|B.flags.hasRedundancy<<4|B.flags.paddingValue<<1|B.flags.isNonSyncSample,61440&B.flags.degradationPriority,15&B.flags.degradationPriority,(4278190080&B.compositionTimeOffset)>>>24,(16711680&B.compositionTimeOffset)>>>16,(65280&B.compositionTimeOffset)>>>8,255&B.compositionTimeOffset]);return e(ce.trun,new Uint8Array(R))},id=function(h,E){var R,x,B,F;for(E+=20+8*(x=h.samples||[]).length,R=Ds(x,E),F=0;F<x.length;F++)B=x[F],R=R.concat([(4278190080&B.duration)>>>24,(16711680&B.duration)>>>16,(65280&B.duration)>>>8,255&B.duration,(4278190080&B.size)>>>24,(16711680&B.size)>>>16,(65280&B.size)>>>8,255&B.size]);return e(ce.trun,new Uint8Array(R))},Se=function(h,E){return h.type==="audio"?id(h,E):nd(h,E)};var tr,Ms,ri={ftyp:s=function(){return e(ce.ftyp,Ee,lt,Ee,Lt)},mdat:function(h){return e(ce.mdat,h)},moof:v,moov:C,initSegment:function(h){var E,R=s(),x=C(h);return(E=new Uint8Array(R.byteLength+x.byteLength)).set(R),E.set(x,R.byteLength),E}},ii=function(h){return h>>>0},Mr={findBox:tr=function(h,E){var R,x,B,F,$,X=[];if(!E.length)return null;for(R=0;R<h.byteLength;)x=ii(h[R]<<24|h[R+1]<<16|h[R+2]<<8|h[R+3]),B=Ms(h.subarray(R+4,R+8)),F=x>1?R+x:h.byteLength,B===E[0]&&(E.length===1?X.push(h.subarray(R+8,F)):($=tr(h.subarray(R+8,F),E.slice(1))).length&&(X=X.concat($))),R=F;return X},parseType:Ms=function(h){var E="";return E+=String.fromCharCode(h[0]),E+=String.fromCharCode(h[1]),E+=String.fromCharCode(h[2]),E+=String.fromCharCode(h[3])},timescale:function(h){return tr(h,["moov","trak"]).reduce(function(E,R){var x,B,F,$,X;return(x=tr(R,["tkhd"])[0])?(B=x[0],$=ii(x[F=B===0?12:20]<<24|x[F+1]<<16|x[F+2]<<8|x[F+3]),(X=tr(R,["mdia","mdhd"])[0])?(F=(B=X[0])===0?12:20,E[$]=ii(X[F]<<24|X[F+1]<<16|X[F+2]<<8|X[F+3]),E):null):null},{})},startTime:function(h,E){var R,x,B;return R=tr(E,["moof","traf"]),x=[].concat.apply([],R.map(function(F){return tr(F,["tfhd"]).map(function($){var X,Q;return X=ii($[4]<<24|$[5]<<16|$[6]<<8|$[7]),Q=h[X]||9e4,(tr(F,["tfdt"]).map(function(ee){var fe,me;return fe=ee[0],me=ii(ee[4]<<24|ee[5]<<16|ee[6]<<8|ee[7]),fe===1&&(me*=Math.pow(2,32),me+=ii(ee[8]<<24|ee[9]<<16|ee[10]<<8|ee[11])),me})[0]||1/0)/Q})})),B=Math.min.apply(null,x),isFinite(B)?B:0},videoTrackIds:function(h){var E=[];return tr(h,["moov","trak"]).forEach(function(R){var x=tr(R,["mdia","hdlr"]),B=tr(R,["tkhd"]);x.forEach(function(F,$){var X,Q,ee=Ms(F.subarray(8,12)),fe=B[$];ee==="vide"&&(Q=(X=new DataView(fe.buffer,fe.byteOffset,fe.byteLength)).getUint8(0)===0?X.getUint32(12):X.getUint32(20),E.push(Q))})}),E}},Cn=function(){this.init=function(){var h={};this.on=function(E,R){h[E]||(h[E]=[]),h[E]=h[E].concat(R)},this.off=function(E,R){var x;return!!h[E]&&(x=h[E].indexOf(R),h[E]=h[E].slice(),h[E].splice(x,1),x>-1)},this.trigger=function(E){var R,x,B,F;if(R=h[E])if(arguments.length===2)for(B=R.length,x=0;x<B;++x)R[x].call(this,arguments[1]);else{for(F=[],x=arguments.length,x=1;x<arguments.length;++x)F.push(arguments[x]);for(B=R.length,x=0;x<B;++x)R[x].apply(this,F)}},this.dispose=function(){h={}}}};Cn.prototype.pipe=function(h){return this.on("data",function(E){h.push(E)}),this.on("done",function(E){h.flush(E)}),h},Cn.prototype.push=function(h){this.trigger("data",h)},Cn.prototype.flush=function(h){this.trigger("done",h)};var Us,sd,od,ud,ld,Ct=Cn,fm=function(h,E){var R={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return R.dataOffset=E,R.compositionTimeOffset=h.pts-h.dts,R.duration=h.duration,R.size=4*h.length,R.size+=h.byteLength,h.keyFrame&&(R.flags.dependsOn=2,R.flags.isNonSyncSample=0),R},pm=function(h){var E,R,x=[],B=[];for(x.byteLength=0,E=0;E<h.length;E++)(R=h[E]).nalUnitType==="access_unit_delimiter_rbsp"?(x.length&&(x.duration=R.dts-x.dts,B.push(x)),(x=[R]).byteLength=R.data.byteLength,x.pts=R.pts,x.dts=R.dts):(R.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(x.keyFrame=!0),x.duration=R.dts-x.dts,x.byteLength+=R.data.byteLength,x.push(R));return B.length&&(!x.duration||x.duration<=0)&&(x.duration=B[B.length-1].duration),B.push(x),B},mm=function(h){var E,R,x=[],B=[];for(x.byteLength=0,x.nalCount=0,x.duration=0,x.pts=h[0].pts,x.dts=h[0].dts,B.byteLength=0,B.nalCount=0,B.duration=0,B.pts=h[0].pts,B.dts=h[0].dts,E=0;E<h.length;E++)(R=h[E]).keyFrame?(x.length&&(B.push(x),B.byteLength+=x.byteLength,B.nalCount+=x.nalCount,B.duration+=x.duration),(x=[R]).nalCount=R.length,x.byteLength=R.byteLength,x.pts=R.pts,x.dts=R.dts,x.duration=R.duration):(x.duration+=R.duration,x.nalCount+=R.length,x.byteLength+=R.byteLength,x.push(R));return B.length&&x.duration<=0&&(x.duration=B[B.length-1].duration),B.byteLength+=x.byteLength,B.nalCount+=x.nalCount,B.duration+=x.duration,B.push(x),B},gm=function(h){var E;return!h[0][0].keyFrame&&h.length>1&&(E=h.shift(),h.byteLength-=E.byteLength,h.nalCount-=E.nalCount,h[0][0].dts=E.dts,h[0][0].pts=E.pts,h[0][0].duration+=E.duration),h},vm=function(h,E){var R,x,B,F,$,X=E||0,Q=[];for(R=0;R<h.length;R++)for(F=h[R],x=0;x<F.length;x++)$=F[x],X+=(B=fm($,X)).size,Q.push(B);return Q},ym=function(h){var E,R,x,B,F,$,X=0,Q=h.byteLength,ee=h.nalCount,fe=new Uint8Array(Q+4*ee),me=new DataView(fe.buffer);for(E=0;E<h.length;E++)for(B=h[E],R=0;R<B.length;R++)for(F=B[R],x=0;x<F.length;x++)$=F[x],me.setUint32(X,$.data.byteLength),X+=4,fe.set($.data,X),X+=$.data.byteLength;return fe},mr=[33,16,5,32,164,27],js=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],$e=function(h){for(var E=[];h--;)E.push(0);return E},_m={96e3:[mr,[227,64],$e(154),[56]],88200:[mr,[231],$e(170),[56]],64e3:[mr,[248,192],$e(240),[56]],48e3:[mr,[255,192],$e(268),[55,148,128],$e(54),[112]],44100:[mr,[255,192],$e(268),[55,163,128],$e(84),[112]],32e3:[mr,[255,192],$e(268),[55,234],$e(226),[112]],24e3:[mr,[255,192],$e(268),[55,255,128],$e(268),[111,112],$e(126),[224]],16e3:[mr,[255,192],$e(268),[55,255,128],$e(268),[111,255],$e(269),[223,108],$e(195),[1,192]],12e3:[js,$e(268),[3,127,248],$e(268),[6,255,240],$e(268),[13,255,224],$e(268),[27,253,128],$e(259),[56]],11025:[js,$e(268),[3,127,248],$e(268),[6,255,240],$e(268),[13,255,224],$e(268),[27,255,192],$e(268),[55,175,128],$e(108),[112]],8e3:[js,$e(268),[3,121,16],$e(47),[7]]},bm=(Us=_m,Object.keys(Us).reduce(function(h,E){return h[E]=new Uint8Array(Us[E].reduce(function(R,x){return R.concat(x)},[])),h},{})),Tm=(sd=function(h){return 9e4*h},od=function(h,E){return h*E},ud=function(h){return h/9e4},ld=function(h,E){return h/E},function(h,E){return sd(ld(h,E))}),Sm=function(h,E){return od(ud(h),E)},km=function(h,E,R,x){var B,F,$,X,Q=0,ee=0,fe=0;if(E.length&&(B=Tm(h.baseMediaDecodeTime,h.samplerate),F=Math.ceil(9e4/(h.samplerate/1024)),R&&x&&(Q=B-Math.max(R,x),fe=(ee=Math.floor(Q/F))*F),!(ee<1||fe>45e3))){for(($=bm[h.samplerate])||($=E[0].data),X=0;X<ee;X++)E.splice(X,0,{data:$});h.baseMediaDecodeTime-=Math.floor(Sm(fe,h.samplerate))}},Em=function(h,E,R){return E.minSegmentDts>=R?h:(E.minSegmentDts=1/0,h.filter(function(x){return x.dts>=R&&(E.minSegmentDts=Math.min(E.minSegmentDts,x.dts),E.minSegmentPts=E.minSegmentDts,!0)}))},Cm=function(h){var E,R,x=[];for(E=0;E<h.length;E++)R=h[E],x.push({size:R.data.byteLength,duration:1024});return x},wm=function(h){var E,R,x=0,B=new Uint8Array(function(F){var $,X=0;for($=0;$<F.length;$++)X+=F[$].data.byteLength;return X}(h));for(E=0;E<h.length;E++)R=h[E],B.set(R.data,x),x+=R.data.byteLength;return B},Ri=function(h){delete h.minSegmentDts,delete h.maxSegmentDts,delete h.minSegmentPts,delete h.maxSegmentPts},cd=function(h,E){var R,x=h.minSegmentDts;return E||(x-=h.timelineStartInfo.dts),R=h.timelineStartInfo.baseMediaDecodeTime,R+=x,R=Math.max(0,R),h.type==="audio"&&(R*=h.samplerate/9e4,R=Math.floor(R)),R},Bs=function(h,E){typeof E.pts=="number"&&(h.timelineStartInfo.pts===void 0&&(h.timelineStartInfo.pts=E.pts),h.minSegmentPts===void 0?h.minSegmentPts=E.pts:h.minSegmentPts=Math.min(h.minSegmentPts,E.pts),h.maxSegmentPts===void 0?h.maxSegmentPts=E.pts:h.maxSegmentPts=Math.max(h.maxSegmentPts,E.pts)),typeof E.dts=="number"&&(h.timelineStartInfo.dts===void 0&&(h.timelineStartInfo.dts=E.dts),h.minSegmentDts===void 0?h.minSegmentDts=E.dts:h.minSegmentDts=Math.min(h.minSegmentDts,E.dts),h.maxSegmentDts===void 0?h.maxSegmentDts=E.dts:h.maxSegmentDts=Math.max(h.maxSegmentDts,E.dts))},Pm=function(h){for(var E=0,R={payloadType:-1,payloadSize:0},x=0,B=0;E<h.byteLength&&h[E]!==128;){for(;h[E]===255;)x+=255,E++;for(x+=h[E++];h[E]===255;)B+=255,E++;if(B+=h[E++],!R.payload&&x===4){R.payloadType=x,R.payloadSize=B,R.payload=h.subarray(E,E+B);break}E+=B,x=0,B=0}return R},Am=function(h){return h.payload[0]!==181||(h.payload[1]<<8|h.payload[2])!=49||String.fromCharCode(h.payload[3],h.payload[4],h.payload[5],h.payload[6])!=="GA94"||h.payload[7]!==3?null:h.payload.subarray(8,h.payload.length-1)},Rm=function(h,E){var R,x,B,F,$=[];if(!(64&E[0]))return $;for(x=31&E[0],R=0;R<x;R++)F={type:3&E[2+(B=3*R)],pts:h},4&E[B+2]&&(F.ccData=E[B+3]<<8|E[B+4],$.push(F));return $},Lm=function(h){for(var E,R,x=h.byteLength,B=[],F=1;F<x-2;)h[F]===0&&h[F+1]===0&&h[F+2]===3?(B.push(F+2),F+=2):F++;if(B.length===0)return h;E=x-B.length,R=new Uint8Array(E);var $=0;for(F=0;F<E;$++,F++)$===B[0]&&($++,B.shift()),R[F]=h[$];return R},Om=4,gr=function h(){h.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new nt(0,0),new nt(0,1),new nt(1,0),new nt(1,1)],this.reset(),this.ccStreams_.forEach(function(E){E.on("data",this.trigger.bind(this,"data")),E.on("done",this.trigger.bind(this,"done"))},this)};(gr.prototype=new Ct).push=function(h){var E,R,x;if(h.nalUnitType==="sei_rbsp"&&(E=Pm(h.escapedRBSP)).payloadType===Om&&(R=Am(E)))if(h.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(h.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));x=Rm(h.pts,R),this.captionPackets_=this.captionPackets_.concat(x),this.latestDts_!==h.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=h.dts}},gr.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(h,E){h.presortIndex=E}),this.captionPackets_.sort(function(h,E){return h.pts===E.pts?h.presortIndex-E.presortIndex:h.pts-E.pts}),this.captionPackets_.forEach(function(h){h.type<2&&this.dispatchCea608Packet(h)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(h){h.flush()},this)):this.ccStreams_.forEach(function(h){h.flush()},this)},gr.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(h){h.reset()})},gr.prototype.dispatchCea608Packet=function(h){this.setsTextOrXDSActive(h)?this.activeCea608Channel_[h.type]=null:this.setsChannel1Active(h)?this.activeCea608Channel_[h.type]=0:this.setsChannel2Active(h)&&(this.activeCea608Channel_[h.type]=1),this.activeCea608Channel_[h.type]!==null&&this.ccStreams_[(h.type<<1)+this.activeCea608Channel_[h.type]].push(h)},gr.prototype.setsChannel1Active=function(h){return(30720&h.ccData)==4096},gr.prototype.setsChannel2Active=function(h){return(30720&h.ccData)==6144},gr.prototype.setsTextOrXDSActive=function(h){return(28928&h.ccData)==256||(30974&h.ccData)==4138||(30974&h.ccData)==6186};var Im={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},wn=function(h){return h===null?"":(h=Im[h]||h,String.fromCharCode(h))},xm=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Ur=function(){for(var h=[],E=15;E--;)h.push("");return h},nt=function h(E,R){h.prototype.init.call(this),this.field_=E||0,this.dataChannel_=R||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(x){var B,F,$,X,Q;if((B=32639&x.ccData)!==this.lastControlCode_){if((61440&B)==4096?this.lastControlCode_=B:B!==this.PADDING_&&(this.lastControlCode_=null),$=B>>>8,X=255&B,B!==this.PADDING_)if(B===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(B===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(x.pts),this.flushDisplayed(x.pts),F=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=F,this.startPts_=x.pts;else if(B===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(x.pts);else if(B===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(x.pts);else if(B===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(x.pts);else if(B===this.CARRIAGE_RETURN_)this.clearFormatting(x.pts),this.flushDisplayed(x.pts),this.shiftRowsUp_(),this.startPts_=x.pts;else if(B===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(B===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(x.pts),this.displayed_=Ur();else if(B===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Ur();else if(B===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(x.pts),this.displayed_=Ur()),this.mode_="paintOn",this.startPts_=x.pts;else if(this.isSpecialCharacter($,X))Q=wn(($=(3&$)<<8)|X),this[this.mode_](x.pts,Q),this.column_++;else if(this.isExtCharacter($,X))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),Q=wn(($=(3&$)<<8)|X),this[this.mode_](x.pts,Q),this.column_++;else if(this.isMidRowCode($,X))this.clearFormatting(x.pts),this[this.mode_](x.pts," "),this.column_++,(14&X)==14&&this.addFormatting(x.pts,["i"]),(1&X)==1&&this.addFormatting(x.pts,["u"]);else if(this.isOffsetControlCode($,X))this.column_+=3&X;else if(this.isPAC($,X)){var ee=xm.indexOf(7968&B);this.mode_==="rollUp"&&(ee-this.rollUpRows_+1<0&&(ee=this.rollUpRows_-1),this.setRollUp(x.pts,ee)),ee!==this.row_&&(this.clearFormatting(x.pts),this.row_=ee),1&X&&this.formatting_.indexOf("u")===-1&&this.addFormatting(x.pts,["u"]),(16&B)==16&&(this.column_=4*((14&B)>>1)),this.isColorPAC(X)&&(14&X)==14&&this.addFormatting(x.pts,["i"])}else this.isNormalChar($)&&(X===0&&(X=null),Q=wn($),Q+=wn(X),this[this.mode_](x.pts,Q),this.column_+=Q.length)}else this.lastControlCode_=null}};nt.prototype=new Ct,nt.prototype.flushDisplayed=function(h){var E=this.displayed_.map(function(R){try{return R.trim()}catch{return console.error("Skipping malformed caption."),""}}).join(`
`).replace(/^\n+|\n+$/g,"");E.length&&this.trigger("data",{startPts:this.startPts_,endPts:h,text:E,stream:this.name_})},nt.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Ur(),this.nonDisplayed_=Ur(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},nt.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},nt.prototype.isSpecialCharacter=function(h,E){return h===this.EXT_&&E>=48&&E<=63},nt.prototype.isExtCharacter=function(h,E){return(h===this.EXT_+1||h===this.EXT_+2)&&E>=32&&E<=63},nt.prototype.isMidRowCode=function(h,E){return h===this.EXT_&&E>=32&&E<=47},nt.prototype.isOffsetControlCode=function(h,E){return h===this.OFFSET_&&E>=33&&E<=35},nt.prototype.isPAC=function(h,E){return h>=this.BASE_&&h<this.BASE_+8&&E>=64&&E<=127},nt.prototype.isColorPAC=function(h){return h>=64&&h<=79||h>=96&&h<=127},nt.prototype.isNormalChar=function(h){return h>=32&&h<=127},nt.prototype.setRollUp=function(h,E){if(this.mode_!=="rollUp"&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(h),this.nonDisplayed_=Ur(),this.displayed_=Ur()),E!==void 0&&E!==this.row_)for(var R=0;R<this.rollUpRows_;R++)this.displayed_[E-R]=this.displayed_[this.row_-R],this.displayed_[this.row_-R]="";E===void 0&&(E=this.row_),this.topRow_=E-this.rollUpRows_+1},nt.prototype.addFormatting=function(h,E){this.formatting_=this.formatting_.concat(E);var R=E.reduce(function(x,B){return x+"<"+B+">"},"");this[this.mode_](h,R)},nt.prototype.clearFormatting=function(h){if(this.formatting_.length){var E=this.formatting_.reverse().reduce(function(R,x){return R+"</"+x+">"},"");this.formatting_=[],this[this.mode_](h,E)}},nt.prototype.popOn=function(h,E){var R=this.nonDisplayed_[this.row_];R+=E,this.nonDisplayed_[this.row_]=R},nt.prototype.rollUp=function(h,E){var R=this.displayed_[this.row_];R+=E,this.displayed_[this.row_]=R},nt.prototype.shiftRowsUp_=function(){var h;for(h=0;h<this.topRow_;h++)this.displayed_[h]="";for(h=this.row_+1;h<15;h++)this.displayed_[h]="";for(h=this.topRow_;h<this.row_;h++)this.displayed_[h]=this.displayed_[h+1];this.displayed_[this.row_]=""},nt.prototype.paintOn=function(h,E){var R=this.displayed_[this.row_];R+=E,this.displayed_[this.row_]=R};var Ns={CaptionStream:gr,Cea608Stream:nt},Bt={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},dd=function(h,E){var R=1;for(h>E&&(R=-1);Math.abs(E-h)>4294967296;)h+=8589934592*R;return h},hd=function h(E){var R,x;h.prototype.init.call(this),this.type_=E,this.push=function(B){B.type===this.type_&&(x===void 0&&(x=B.dts),B.dts=dd(B.dts,x),B.pts=dd(B.pts,x),R=B.dts,this.trigger("data",B))},this.flush=function(){x=R,this.trigger("done")},this.discontinuity=function(){x=void 0,R=void 0}};hd.prototype=new Ct;var Fs,Dm=hd,fd=function(h,E,R){var x,B="";for(x=E;x<R;x++)B+="%"+("00"+h[x].toString(16)).slice(-2);return B},Pn=function(h,E,R){return decodeURIComponent(fd(h,E,R))},An=function(h){return h[0]<<21|h[1]<<14|h[2]<<7|h[3]},pd={TXXX:function(h){var E;if(h.data[0]===3){for(E=1;E<h.data.length;E++)if(h.data[E]===0){h.description=Pn(h.data,1,E),h.value=Pn(h.data,E+1,h.data.length).replace(/\0*$/,"");break}h.data=h.value}},WXXX:function(h){var E;if(h.data[0]===3){for(E=1;E<h.data.length;E++)if(h.data[E]===0){h.description=Pn(h.data,1,E),h.url=Pn(h.data,E+1,h.data.length);break}}},PRIV:function(h){var E,R;for(E=0;E<h.data.length;E++)if(h.data[E]===0){h.owner=(R=h.data,unescape(fd(R,0,E)));break}h.privateData=h.data.subarray(E+1),h.data=h.privateData}};(Fs=function(h){var E,R={debug:!(!h||!h.debug),descriptor:h&&h.descriptor},x=0,B=[],F=0;if(Fs.prototype.init.call(this),this.dispatchType=Bt.METADATA_STREAM_TYPE.toString(16),R.descriptor)for(E=0;E<R.descriptor.length;E++)this.dispatchType+=("00"+R.descriptor[E].toString(16)).slice(-2);this.push=function($){var X,Q,ee,fe,me;if($.type==="timed-metadata"){if($.dataAlignmentIndicator&&(F=0,B.length=0),B.length===0&&($.data.length<10||$.data[0]!=="I".charCodeAt(0)||$.data[1]!=="D".charCodeAt(0)||$.data[2]!=="3".charCodeAt(0)))R.debug&&console.log("Skipping unrecognized metadata packet");else if(B.push($),F+=$.data.byteLength,B.length===1&&(x=An($.data.subarray(6,10)),x+=10),!(F<x)){for(X={data:new Uint8Array(x),frames:[],pts:B[0].pts,dts:B[0].dts},me=0;me<x;)X.data.set(B[0].data.subarray(0,x-me),me),me+=B[0].data.byteLength,F-=B[0].data.byteLength,B.shift();Q=10,64&X.data[5]&&(Q+=4,Q+=An(X.data.subarray(10,14)),x-=An(X.data.subarray(16,20)));do{if((ee=An(X.data.subarray(Q+4,Q+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((fe={id:String.fromCharCode(X.data[Q],X.data[Q+1],X.data[Q+2],X.data[Q+3]),data:X.data.subarray(Q+10,Q+ee+10)}).key=fe.id,pd[fe.id]&&(pd[fe.id](fe),fe.owner==="com.apple.streaming.transportStreamTimestamp")){var Ae=fe.data,xe=(1&Ae[3])<<30|Ae[4]<<22|Ae[5]<<14|Ae[6]<<6|Ae[7]>>>2;xe*=4,xe+=3&Ae[7],fe.timeStamp=xe,X.pts===void 0&&X.dts===void 0&&(X.pts=fe.timeStamp,X.dts=fe.timeStamp),this.trigger("timestamp",fe)}X.frames.push(fe),Q+=10,Q+=ee}while(Q<x);this.trigger("data",X)}}}}).prototype=new Ct;var Vs,Rn,Gs,Mm=Fs,Um=Dm;(Vs=function(){var h=new Uint8Array(188),E=0;Vs.prototype.init.call(this),this.push=function(R){var x,B=0,F=188;for(E?((x=new Uint8Array(R.byteLength+E)).set(h.subarray(0,E)),x.set(R,E),E=0):x=R;F<x.byteLength;)x[B]!==71||x[F]!==71?(B++,F++):(this.trigger("data",x.subarray(B,F)),B+=188,F+=188);B<x.byteLength&&(h.set(x.subarray(B),0),E=x.byteLength-B)},this.flush=function(){E===188&&h[0]===71&&(this.trigger("data",h),E=0),this.trigger("done")}}).prototype=new Ct,(Rn=function(){var h,E,R,x;Rn.prototype.init.call(this),x=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,h=function(B,F){var $=0;F.payloadUnitStartIndicator&&($+=B[$]+1),F.type==="pat"?E(B.subarray($),F):R(B.subarray($),F)},E=function(B,F){F.section_number=B[7],F.last_section_number=B[8],x.pmtPid=(31&B[10])<<8|B[11],F.pmtPid=x.pmtPid},R=function(B,F){var $,X;if(1&B[5]){for(x.programMapTable={video:null,audio:null,"timed-metadata":{}},$=3+((15&B[1])<<8|B[2])-4,X=12+((15&B[10])<<8|B[11]);X<$;){var Q=B[X],ee=(31&B[X+1])<<8|B[X+2];Q===Bt.H264_STREAM_TYPE&&x.programMapTable.video===null?x.programMapTable.video=ee:Q===Bt.ADTS_STREAM_TYPE&&x.programMapTable.audio===null?x.programMapTable.audio=ee:Q===Bt.METADATA_STREAM_TYPE&&(x.programMapTable["timed-metadata"][ee]=Q),X+=5+((15&B[X+3])<<8|B[X+4])}F.programMapTable=x.programMapTable}},this.push=function(B){var F={},$=4;if(F.payloadUnitStartIndicator=!!(64&B[1]),F.pid=31&B[1],F.pid<<=8,F.pid|=B[2],(48&B[3])>>>4>1&&($+=B[$]+1),F.pid===0)F.type="pat",h(B.subarray($),F),this.trigger("data",F);else if(F.pid===this.pmtPid)for(F.type="pmt",h(B.subarray($),F),this.trigger("data",F);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([B,$,F]):this.processPes_(B,$,F)},this.processPes_=function(B,F,$){$.pid===this.programMapTable.video?$.streamType=Bt.H264_STREAM_TYPE:$.pid===this.programMapTable.audio?$.streamType=Bt.ADTS_STREAM_TYPE:$.streamType=this.programMapTable["timed-metadata"][$.pid],$.type="pes",$.data=B.subarray(F),this.trigger("data",$)}}).prototype=new Ct,Rn.STREAM_TYPES={h264:27,adts:15},(Gs=function(){var h=this,E={data:[],size:0},R={data:[],size:0},x={data:[],size:0},B=function(F,$,X){var Q,ee,fe=new Uint8Array(F.size),me={type:$},Ae=0,xe=0;if(F.data.length&&!(F.size<9)){for(me.trackId=F.data[0].pid,Ae=0;Ae<F.data.length;Ae++)ee=F.data[Ae],fe.set(ee.data,xe),xe+=ee.data.byteLength;var Ie,Le,_t;Ie=fe,(Le=me).packetLength=6+(Ie[4]<<8|Ie[5]),Le.dataAlignmentIndicator=(4&Ie[6])!=0,192&(_t=Ie[7])&&(Le.pts=(14&Ie[9])<<27|(255&Ie[10])<<20|(254&Ie[11])<<12|(255&Ie[12])<<5|(254&Ie[13])>>>3,Le.pts*=4,Le.pts+=(6&Ie[13])>>>1,Le.dts=Le.pts,64&_t&&(Le.dts=(14&Ie[14])<<27|(255&Ie[15])<<20|(254&Ie[16])<<12|(255&Ie[17])<<5|(254&Ie[18])>>>3,Le.dts*=4,Le.dts+=(6&Ie[18])>>>1)),Le.data=Ie.subarray(9+Ie[8]),Q=$==="video"||me.packetLength<=F.size,(X||Q)&&(F.size=0,F.data.length=0),Q&&h.trigger("data",me)}};Gs.prototype.init.call(this),this.push=function(F){({pat:function(){},pes:function(){var $,X;switch(F.streamType){case Bt.H264_STREAM_TYPE:case Bt.H264_STREAM_TYPE:$=E,X="video";break;case Bt.ADTS_STREAM_TYPE:$=R,X="audio";break;case Bt.METADATA_STREAM_TYPE:$=x,X="timed-metadata";break;default:return}F.payloadUnitStartIndicator&&B($,X,!0),$.data.push(F),$.size+=F.data.byteLength},pmt:function(){var $={type:"metadata",tracks:[]},X=F.programMapTable;X.video!==null&&$.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+X.video,codec:"avc",type:"video"}),X.audio!==null&&$.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+X.audio,codec:"adts",type:"audio"}),h.trigger("data",$)}})[F.type]()},this.flush=function(){B(E,"video"),B(R,"audio"),B(x,"timed-metadata"),this.trigger("done")}}).prototype=new Ct;var md={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Vs,TransportParseStream:Rn,ElementaryStream:Gs,TimestampRolloverStream:Um,CaptionStream:Ns.CaptionStream,Cea608Stream:Ns.Cea608Stream,MetadataStream:Mm};for(var Hs in Bt)Bt.hasOwnProperty(Hs)&&(md[Hs]=Bt[Hs]);var zs,rr=md,gd=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(zs=function(){var h;zs.prototype.init.call(this),this.push=function(E){var R,x,B,F,$,X,Q=0,ee=0;if(E.type==="audio")for(h?(F=h,(h=new Uint8Array(F.byteLength+E.data.byteLength)).set(F),h.set(E.data,F.byteLength)):h=E.data;Q+5<h.length;)if(h[Q]===255&&(246&h[Q+1])==240){if(x=2*(1&~h[Q+1]),R=(3&h[Q+3])<<11|h[Q+4]<<3|(224&h[Q+5])>>5,X=9e4*($=1024*(1+(3&h[Q+6])))/gd[(60&h[Q+2])>>>2],B=Q+R,h.byteLength<B)return;if(this.trigger("data",{pts:E.pts+ee*X,dts:E.dts+ee*X,sampleCount:$,audioobjecttype:1+(h[Q+2]>>>6&3),channelcount:(1&h[Q+2])<<2|(192&h[Q+3])>>>6,samplerate:gd[(60&h[Q+2])>>>2],samplingfrequencyindex:(60&h[Q+2])>>>2,samplesize:16,data:h.subarray(Q+7+x,B)}),h.byteLength===B)return void(h=void 0);ee++,h=h.subarray(B)}else Q++},this.flush=function(){this.trigger("done")}}).prototype=new Ct;var qs,Ln,vd,yd=zs,jm=function(h){var E=h.byteLength,R=0,x=0;this.length=function(){return 8*E},this.bitsAvailable=function(){return 8*E+x},this.loadWord=function(){var B=h.byteLength-E,F=new Uint8Array(4),$=Math.min(4,E);if($===0)throw new Error("no bytes available");F.set(h.subarray(B,B+$)),R=new DataView(F.buffer).getUint32(0),x=8*$,E-=$},this.skipBits=function(B){var F;x>B?(R<<=B,x-=B):(B-=x,B-=8*(F=Math.floor(B/8)),E-=F,this.loadWord(),R<<=B,x-=B)},this.readBits=function(B){var F=Math.min(x,B),$=R>>>32-F;return(x-=F)>0?R<<=F:E>0&&this.loadWord(),(F=B-F)>0?$<<F|this.readBits(F):$},this.skipLeadingZeros=function(){var B;for(B=0;B<x;++B)if(R&2147483648>>>B)return R<<=B,x-=B,B;return this.loadWord(),B+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var B=this.skipLeadingZeros();return this.readBits(B+1)-1},this.readExpGolomb=function(){var B=this.readUnsignedExpGolomb();return 1&B?1+B>>>1:-1*(B>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(Ln=function(){var h,E,R=0;Ln.prototype.init.call(this),this.push=function(x){var B;for(E?((B=new Uint8Array(E.byteLength+x.data.byteLength)).set(E),B.set(x.data,E.byteLength),E=B):E=x.data;R<E.byteLength-3;R++)if(E[R+2]===1){h=R+5;break}for(;h<E.byteLength;)switch(E[h]){case 0:if(E[h-1]!==0){h+=2;break}if(E[h-2]!==0){h++;break}R+3!==h-2&&this.trigger("data",E.subarray(R+3,h-2));do h++;while(E[h]!==1&&h<E.length);R=h-2,h+=3;break;case 1:if(E[h-1]!==0||E[h-2]!==0){h+=3;break}this.trigger("data",E.subarray(R+3,h-2)),R=h-2,h+=3;break;default:h+=3}E=E.subarray(R),h-=R,R=0},this.flush=function(){E&&E.byteLength>3&&this.trigger("data",E.subarray(R+3)),E=null,R=0,this.trigger("done")}}).prototype=new Ct,vd={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(qs=function(){var h,E,R,x,B,F,$,X=new Ln;qs.prototype.init.call(this),h=this,this.push=function(Q){Q.type==="video"&&(E=Q.trackId,R=Q.pts,x=Q.dts,X.push(Q))},X.on("data",function(Q){var ee={trackId:E,pts:R,dts:x,data:Q};switch(31&Q[0]){case 5:ee.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:ee.nalUnitType="sei_rbsp",ee.escapedRBSP=B(Q.subarray(1));break;case 7:ee.nalUnitType="seq_parameter_set_rbsp",ee.escapedRBSP=B(Q.subarray(1)),ee.config=F(ee.escapedRBSP);break;case 8:ee.nalUnitType="pic_parameter_set_rbsp";break;case 9:ee.nalUnitType="access_unit_delimiter_rbsp"}h.trigger("data",ee)}),X.on("done",function(){h.trigger("done")}),this.flush=function(){X.flush()},$=function(Q,ee){var fe,me=8,Ae=8;for(fe=0;fe<Q;fe++)Ae!==0&&(Ae=(me+ee.readExpGolomb()+256)%256),me=Ae===0?me:Ae},B=function(Q){for(var ee,fe,me=Q.byteLength,Ae=[],xe=1;xe<me-2;)Q[xe]===0&&Q[xe+1]===0&&Q[xe+2]===3?(Ae.push(xe+2),xe+=2):xe++;if(Ae.length===0)return Q;ee=me-Ae.length,fe=new Uint8Array(ee);var Ie=0;for(xe=0;xe<ee;Ie++,xe++)Ie===Ae[0]&&(Ie++,Ae.shift()),fe[xe]=Q[Ie];return fe},F=function(Q){var ee,fe,me,Ae,xe,Ie,Le,_t,vt,yt,xt,Ye,Nt,vr=0,Br=0,yr=0,dt=0,Ed=1;if(fe=(ee=new jm(Q)).readUnsignedByte(),Ae=ee.readUnsignedByte(),me=ee.readUnsignedByte(),ee.skipUnsignedExpGolomb(),vd[fe]&&((xe=ee.readUnsignedExpGolomb())===3&&ee.skipBits(1),ee.skipUnsignedExpGolomb(),ee.skipUnsignedExpGolomb(),ee.skipBits(1),ee.readBoolean()))for(xt=xe!==3?8:12,Nt=0;Nt<xt;Nt++)ee.readBoolean()&&$(Nt<6?16:64,ee);if(ee.skipUnsignedExpGolomb(),(Ie=ee.readUnsignedExpGolomb())===0)ee.readUnsignedExpGolomb();else if(Ie===1)for(ee.skipBits(1),ee.skipExpGolomb(),ee.skipExpGolomb(),Le=ee.readUnsignedExpGolomb(),Nt=0;Nt<Le;Nt++)ee.skipExpGolomb();if(ee.skipUnsignedExpGolomb(),ee.skipBits(1),_t=ee.readUnsignedExpGolomb(),vt=ee.readUnsignedExpGolomb(),(yt=ee.readBits(1))===0&&ee.skipBits(1),ee.skipBits(1),ee.readBoolean()&&(vr=ee.readUnsignedExpGolomb(),Br=ee.readUnsignedExpGolomb(),yr=ee.readUnsignedExpGolomb(),dt=ee.readUnsignedExpGolomb()),ee.readBoolean()&&ee.readBoolean()){switch(ee.readUnsignedByte()){case 1:Ye=[1,1];break;case 2:Ye=[12,11];break;case 3:Ye=[10,11];break;case 4:Ye=[16,11];break;case 5:Ye=[40,33];break;case 6:Ye=[24,11];break;case 7:Ye=[20,11];break;case 8:Ye=[32,11];break;case 9:Ye=[80,33];break;case 10:Ye=[18,11];break;case 11:Ye=[15,11];break;case 12:Ye=[64,33];break;case 13:Ye=[160,99];break;case 14:Ye=[4,3];break;case 15:Ye=[3,2];break;case 16:Ye=[2,1];break;case 255:Ye=[ee.readUnsignedByte()<<8|ee.readUnsignedByte(),ee.readUnsignedByte()<<8|ee.readUnsignedByte()]}Ye&&(Ed=Ye[0]/Ye[1])}return{profileIdc:fe,levelIdc:me,profileCompatibility:Ae,width:Math.ceil((16*(_t+1)-2*vr-2*Br)*Ed),height:(2-yt)*(vt+1)*16-2*yr-2*dt}}}).prototype=new Ct;var Ws,Bm={H264Stream:qs,NalByteStream:Ln},Nm=function(h){return h[0]==="I".charCodeAt(0)&&h[1]==="D".charCodeAt(0)&&h[2]==="3".charCodeAt(0)},Fm=function(h,E){var R=h[E+6]<<21|h[E+7]<<14|h[E+8]<<7|h[E+9];return(16&h[E+5])>>4?R+20:R+10},Vm=function(h,E){var R=(224&h[E+5])>>5,x=h[E+4]<<3;return 6144&h[E+3]|x|R};(Ws=function(){var h=new Uint8Array,E=0;Ws.prototype.init.call(this),this.setTimestamp=function(R){E=R},this.push=function(R){var x,B,F,$,X=0,Q=0;for(h.length?($=h.length,(h=new Uint8Array(R.byteLength+$)).set(h.subarray(0,$)),h.set(R,$)):h=R;h.length-Q>=3;)if(h[Q]!=="I".charCodeAt(0)||h[Q+1]!=="D".charCodeAt(0)||h[Q+2]!=="3".charCodeAt(0))if((255&h[Q])!=255||(240&h[Q+1])!=240)Q++;else{if(h.length-Q<7||Q+(X=Vm(h,Q))>h.length)break;F={type:"audio",data:h.subarray(Q,Q+X),pts:E,dts:E},this.trigger("data",F),Q+=X}else{if(h.length-Q<10||Q+(X=Fm(h,Q))>h.length)break;B={type:"timed-metadata",data:h.subarray(Q,Q+X)},this.trigger("data",B),Q+=X}x=h.length-Q,h=x>0?h.subarray(Q):new Uint8Array}}).prototype=new Ct;var On,Li,Ks,Oi,Gm=Ws,Hm=Bm.H264Stream,zm=Nm,$s=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Xs=["width","height","profileIdc","levelIdc","profileCompatibility"],_d=function(h,E){var R;if(h.length!==E.length)return!1;for(R=0;R<h.length;R++)if(h[R]!==E[R])return!1;return!0},bd=function(h,E,R,x,B,F){return{start:{dts:h,pts:h+(R-E)},end:{dts:h+(x-E),pts:h+(B-R)},prependedContentDuration:F,baseMediaDecodeTime:h}};(Li=function(h,E){var R=[],x=0,B=0,F=0,$=1/0;E=E||{},Li.prototype.init.call(this),this.push=function(X){Bs(h,X),h&&$s.forEach(function(Q){h[Q]=X[Q]}),R.push(X)},this.setEarliestDts=function(X){B=X-h.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(X){$=X},this.setAudioAppendStart=function(X){F=X},this.flush=function(){var X,Q,ee,fe;R.length!==0?(X=Em(R,h,B),h.baseMediaDecodeTime=cd(h,E.keepOriginalTimestamps),km(h,X,F,$),h.samples=Cm(X),ee=ri.mdat(wm(X)),R=[],Q=ri.moof(x,[h]),fe=new Uint8Array(Q.byteLength+ee.byteLength),x++,fe.set(Q),fe.set(ee,Q.byteLength),Ri(h),this.trigger("data",{track:h,boxes:fe}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}}).prototype=new Ct,(On=function(h,E){var R,x,B=0,F=[],$=[];E=E||{},On.prototype.init.call(this),delete h.minPTS,this.gopCache_=[],this.push=function(X){Bs(h,X),X.nalUnitType!=="seq_parameter_set_rbsp"||R||(R=X.config,h.sps=[X.data],Xs.forEach(function(Q){h[Q]=R[Q]},this)),X.nalUnitType!=="pic_parameter_set_rbsp"||x||(x=X.data,h.pps=[X.data]),F.push(X)},this.flush=function(){for(var X,Q,ee,fe,me,Ae,xe,Ie,Le=0;F.length&&F[0].nalUnitType!=="access_unit_delimiter_rbsp";)F.shift();if(F.length===0)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(X=pm(F),(ee=mm(X))[0][0].keyFrame||((Q=this.getGopForFusion_(F[0],h))?(Le=Q.duration,ee.unshift(Q),ee.byteLength+=Q.byteLength,ee.nalCount+=Q.nalCount,ee.pts=Q.pts,ee.dts=Q.dts,ee.duration+=Q.duration):ee=gm(ee)),$.length){var _t;if(!(_t=E.alignGopsAtEnd?this.alignGopsAtEnd_(ee):this.alignGopsAtStart_(ee)))return this.gopCache_.unshift({gop:ee.pop(),pps:h.pps,sps:h.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),F=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Ri(h),ee=_t}Bs(h,ee),h.samples=vm(ee),me=ri.mdat(ym(ee)),h.baseMediaDecodeTime=cd(h,E.keepOriginalTimestamps),this.trigger("processedGopsInfo",ee.map(function(vt){return{pts:vt.pts,dts:vt.dts,byteLength:vt.byteLength}})),xe=ee[0],Ie=ee[ee.length-1],this.trigger("segmentTimingInfo",bd(h.baseMediaDecodeTime,xe.dts,xe.pts,Ie.dts+Ie.duration,Ie.pts+Ie.duration,Le)),this.gopCache_.unshift({gop:ee.pop(),pps:h.pps,sps:h.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),F=[],this.trigger("baseMediaDecodeTime",h.baseMediaDecodeTime),this.trigger("timelineStartInfo",h.timelineStartInfo),fe=ri.moof(B,[h]),Ae=new Uint8Array(fe.byteLength+me.byteLength),B++,Ae.set(fe),Ae.set(me,fe.byteLength),this.trigger("data",{track:h,boxes:Ae}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){Ri(h),R=void 0,x=void 0},this.getGopForFusion_=function(X){var Q,ee,fe,me,Ae,xe=1/0;for(Ae=0;Ae<this.gopCache_.length;Ae++)fe=(me=this.gopCache_[Ae]).gop,h.pps&&_d(h.pps[0],me.pps[0])&&h.sps&&_d(h.sps[0],me.sps[0])&&(fe.dts<h.timelineStartInfo.dts||(Q=X.dts-fe.dts-fe.duration)>=-1e4&&Q<=45e3&&(!ee||xe>Q)&&(ee=me,xe=Q));return ee?ee.gop:null},this.alignGopsAtStart_=function(X){var Q,ee,fe,me,Ae,xe,Ie,Le;for(Ae=X.byteLength,xe=X.nalCount,Ie=X.duration,Q=ee=0;Q<$.length&&ee<X.length&&(fe=$[Q],me=X[ee],fe.pts!==me.pts);)me.pts>fe.pts?Q++:(ee++,Ae-=me.byteLength,xe-=me.nalCount,Ie-=me.duration);return ee===0?X:ee===X.length?null:((Le=X.slice(ee)).byteLength=Ae,Le.duration=Ie,Le.nalCount=xe,Le.pts=Le[0].pts,Le.dts=Le[0].dts,Le)},this.alignGopsAtEnd_=function(X){var Q,ee,fe,me,Ae,xe,Ie;for(Q=$.length-1,ee=X.length-1,Ae=null,xe=!1;Q>=0&&ee>=0;){if(fe=$[Q],me=X[ee],fe.pts===me.pts){xe=!0;break}fe.pts>me.pts?Q--:(Q===$.length-1&&(Ae=ee),ee--)}if(!xe&&Ae===null)return null;if((Ie=xe?ee:Ae)===0)return X;var Le=X.slice(Ie),_t=Le.reduce(function(vt,yt){return vt.byteLength+=yt.byteLength,vt.duration+=yt.duration,vt.nalCount+=yt.nalCount,vt},{byteLength:0,duration:0,nalCount:0});return Le.byteLength=_t.byteLength,Le.duration=_t.duration,Le.nalCount=_t.nalCount,Le.pts=Le[0].pts,Le.dts=Le[0].dts,Le},this.alignGopsWith=function(X){$=X}}).prototype=new Ct,(Oi=function(h,E){this.numberOfTracks=0,this.metadataStream=E,(h=h||{}).remux!==void 0?this.remuxTracks=!!h.remux:this.remuxTracks=!0,typeof h.keepOriginalTimestamps=="boolean"&&(this.keepOriginalTimestamps=h.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Oi.prototype.init.call(this),this.push=function(R){return R.text?this.pendingCaptions.push(R):R.frames?this.pendingMetadata.push(R):(this.pendingTracks.push(R.track),this.pendingBoxes.push(R.boxes),this.pendingBytes+=R.boxes.byteLength,R.track.type==="video"&&(this.videoTrack=R.track),void(R.track.type==="audio"&&(this.audioTrack=R.track)))}}).prototype=new Ct,Oi.prototype.flush=function(h){var E,R,x,B,F=0,$={captions:[],captionStreams:{},metadata:[],info:{}},X=0;if(this.pendingTracks.length<this.numberOfTracks){if(h!=="VideoSegmentStream"&&h!=="AudioSegmentStream"||this.remuxTracks)return;if(this.pendingTracks.length===0)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(X=this.videoTrack.timelineStartInfo.pts,Xs.forEach(function(Q){$.info[Q]=this.videoTrack[Q]},this)):this.audioTrack&&(X=this.audioTrack.timelineStartInfo.pts,$s.forEach(function(Q){$.info[Q]=this.audioTrack[Q]},this)),this.pendingTracks.length===1?$.type=this.pendingTracks[0].type:$.type="combined",this.emittedTracks+=this.pendingTracks.length,x=ri.initSegment(this.pendingTracks),$.initSegment=new Uint8Array(x.byteLength),$.initSegment.set(x),$.data=new Uint8Array(this.pendingBytes),B=0;B<this.pendingBoxes.length;B++)$.data.set(this.pendingBoxes[B],F),F+=this.pendingBoxes[B].byteLength;for(B=0;B<this.pendingCaptions.length;B++)(E=this.pendingCaptions[B]).startTime=E.startPts,this.keepOriginalTimestamps||(E.startTime-=X),E.startTime/=9e4,E.endTime=E.endPts,this.keepOriginalTimestamps||(E.endTime-=X),E.endTime/=9e4,$.captionStreams[E.stream]=!0,$.captions.push(E);for(B=0;B<this.pendingMetadata.length;B++)(R=this.pendingMetadata[B]).cueTime=R.pts,this.keepOriginalTimestamps||(R.cueTime-=X),R.cueTime/=9e4,$.metadata.push(R);$.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",$),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(Ks=function(h){var E,R,x=this,B=!0;Ks.prototype.init.call(this),h=h||{},this.baseMediaDecodeTime=h.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var F={};this.transmuxPipeline_=F,F.type="aac",F.metadataStream=new rr.MetadataStream,F.aacStream=new Gm,F.audioTimestampRolloverStream=new rr.TimestampRolloverStream("audio"),F.timedMetadataTimestampRolloverStream=new rr.TimestampRolloverStream("timed-metadata"),F.adtsStream=new yd,F.coalesceStream=new Oi(h,F.metadataStream),F.headOfPipeline=F.aacStream,F.aacStream.pipe(F.audioTimestampRolloverStream).pipe(F.adtsStream),F.aacStream.pipe(F.timedMetadataTimestampRolloverStream).pipe(F.metadataStream).pipe(F.coalesceStream),F.metadataStream.on("timestamp",function($){F.aacStream.setTimestamp($.timeStamp)}),F.aacStream.on("data",function($){$.type!=="timed-metadata"||F.audioSegmentStream||(R=R||{timelineStartInfo:{baseMediaDecodeTime:x.baseMediaDecodeTime},codec:"adts",type:"audio"},F.coalesceStream.numberOfTracks++,F.audioSegmentStream=new Li(R,h),F.adtsStream.pipe(F.audioSegmentStream).pipe(F.coalesceStream))}),F.coalesceStream.on("data",this.trigger.bind(this,"data")),F.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var F={};this.transmuxPipeline_=F,F.type="ts",F.metadataStream=new rr.MetadataStream,F.packetStream=new rr.TransportPacketStream,F.parseStream=new rr.TransportParseStream,F.elementaryStream=new rr.ElementaryStream,F.videoTimestampRolloverStream=new rr.TimestampRolloverStream("video"),F.audioTimestampRolloverStream=new rr.TimestampRolloverStream("audio"),F.timedMetadataTimestampRolloverStream=new rr.TimestampRolloverStream("timed-metadata"),F.adtsStream=new yd,F.h264Stream=new Hm,F.captionStream=new rr.CaptionStream,F.coalesceStream=new Oi(h,F.metadataStream),F.headOfPipeline=F.packetStream,F.packetStream.pipe(F.parseStream).pipe(F.elementaryStream),F.elementaryStream.pipe(F.videoTimestampRolloverStream).pipe(F.h264Stream),F.elementaryStream.pipe(F.audioTimestampRolloverStream).pipe(F.adtsStream),F.elementaryStream.pipe(F.timedMetadataTimestampRolloverStream).pipe(F.metadataStream).pipe(F.coalesceStream),F.h264Stream.pipe(F.captionStream).pipe(F.coalesceStream),F.elementaryStream.on("data",function($){var X;if($.type==="metadata"){for(X=$.tracks.length;X--;)E||$.tracks[X].type!=="video"?R||$.tracks[X].type!=="audio"||((R=$.tracks[X]).timelineStartInfo.baseMediaDecodeTime=x.baseMediaDecodeTime):(E=$.tracks[X]).timelineStartInfo.baseMediaDecodeTime=x.baseMediaDecodeTime;E&&!F.videoSegmentStream&&(F.coalesceStream.numberOfTracks++,F.videoSegmentStream=new On(E,h),F.videoSegmentStream.on("timelineStartInfo",function(Q){R&&(R.timelineStartInfo=Q,F.audioSegmentStream.setEarliestDts(Q.dts))}),F.videoSegmentStream.on("processedGopsInfo",x.trigger.bind(x,"gopInfo")),F.videoSegmentStream.on("segmentTimingInfo",x.trigger.bind(x,"videoSegmentTimingInfo")),F.videoSegmentStream.on("baseMediaDecodeTime",function(Q){R&&F.audioSegmentStream.setVideoBaseMediaDecodeTime(Q)}),F.h264Stream.pipe(F.videoSegmentStream).pipe(F.coalesceStream)),R&&!F.audioSegmentStream&&(F.coalesceStream.numberOfTracks++,F.audioSegmentStream=new Li(R,h),F.adtsStream.pipe(F.audioSegmentStream).pipe(F.coalesceStream))}}),F.coalesceStream.on("data",this.trigger.bind(this,"data")),F.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(F){var $=this.transmuxPipeline_;h.keepOriginalTimestamps||(this.baseMediaDecodeTime=F),R&&(R.timelineStartInfo.dts=void 0,R.timelineStartInfo.pts=void 0,Ri(R),h.keepOriginalTimestamps||(R.timelineStartInfo.baseMediaDecodeTime=F),$.audioTimestampRolloverStream&&$.audioTimestampRolloverStream.discontinuity()),E&&($.videoSegmentStream&&($.videoSegmentStream.gopCache_=[],$.videoTimestampRolloverStream.discontinuity()),E.timelineStartInfo.dts=void 0,E.timelineStartInfo.pts=void 0,Ri(E),$.captionStream.reset(),h.keepOriginalTimestamps||(E.timelineStartInfo.baseMediaDecodeTime=F)),$.timedMetadataTimestampRolloverStream&&$.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(F){R&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(F)},this.alignGopsWith=function(F){E&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(F)},this.push=function(F){if(B){var $=zm(F);$&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():$||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline(),B=!1}this.transmuxPipeline_.headOfPipeline.push(F)},this.flush=function(){B=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new Ct;var It,Td,Ys={Transmuxer:Ks,VideoSegmentStream:On,AudioSegmentStream:Li,AUDIO_PROPERTIES:$s,VIDEO_PROPERTIES:Xs,generateVideoSegmentTimingInfo:bd},In=Mr.parseType,Wt=function(h){return new Date(1e3*h-20828448e5)},Sd=function(h){return{isLeading:(12&h[0])>>>2,dependsOn:3&h[0],isDependedOn:(192&h[1])>>>6,hasRedundancy:(48&h[1])>>>4,paddingValue:(14&h[1])>>>1,isNonSyncSample:1&h[1],degradationPriority:h[2]<<8|h[3]}},jr={avc1:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength);return{dataReferenceIndex:E.getUint16(6),width:E.getUint16(24),height:E.getUint16(26),horizresolution:E.getUint16(28)+E.getUint16(30)/16,vertresolution:E.getUint16(32)+E.getUint16(34)/16,frameCount:E.getUint16(40),depth:E.getUint16(74),config:It(h.subarray(78,h.byteLength))}},avcC:function(h){var E,R,x,B,F=new DataView(h.buffer,h.byteOffset,h.byteLength),$={configurationVersion:h[0],avcProfileIndication:h[1],profileCompatibility:h[2],avcLevelIndication:h[3],lengthSizeMinusOne:3&h[4],sps:[],pps:[]},X=31&h[5];for(x=6,B=0;B<X;B++)R=F.getUint16(x),x+=2,$.sps.push(new Uint8Array(h.subarray(x,x+R))),x+=R;for(E=h[x],x++,B=0;B<E;B++)R=F.getUint16(x),x+=2,$.pps.push(new Uint8Array(h.subarray(x,x+R))),x+=R;return $},btrt:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength);return{bufferSizeDB:E.getUint32(0),maxBitrate:E.getUint32(4),avgBitrate:E.getUint32(8)}},esds:function(h){return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),esId:h[6]<<8|h[7],streamPriority:31&h[8],decoderConfig:{objectProfileIndication:h[11],streamType:h[12]>>>2&63,bufferSize:h[13]<<16|h[14]<<8|h[15],maxBitrate:h[16]<<24|h[17]<<16|h[18]<<8|h[19],avgBitrate:h[20]<<24|h[21]<<16|h[22]<<8|h[23],decoderConfigDescriptor:{tag:h[24],length:h[25],audioObjectType:h[26]>>>3&31,samplingFrequencyIndex:(7&h[26])<<1|h[27]>>>7&1,channelConfiguration:h[27]>>>3&15}}}},ftyp:function(h){for(var E=new DataView(h.buffer,h.byteOffset,h.byteLength),R={majorBrand:In(h.subarray(0,4)),minorVersion:E.getUint32(4),compatibleBrands:[]},x=8;x<h.byteLength;)R.compatibleBrands.push(In(h.subarray(x,x+4))),x+=4;return R},dinf:function(h){return{boxes:It(h)}},dref:function(h){return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),dataReferences:It(h.subarray(8))}},hdlr:function(h){var E={version:new DataView(h.buffer,h.byteOffset,h.byteLength).getUint8(0),flags:new Uint8Array(h.subarray(1,4)),handlerType:In(h.subarray(8,12)),name:""},R=8;for(R=24;R<h.byteLength;R++){if(h[R]===0){R++;break}E.name+=String.fromCharCode(h[R])}return E.name=decodeURIComponent(escape(E.name)),E},mdat:function(h){return{byteLength:h.byteLength,nals:function(E){var R,x,B=new DataView(E.buffer,E.byteOffset,E.byteLength),F=[];for(R=0;R+4<E.length;R+=x)if(x=B.getUint32(R),R+=4,x<=0)F.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&E[R]){case 1:F.push("slice_layer_without_partitioning_rbsp");break;case 5:F.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:F.push("sei_rbsp");break;case 7:F.push("seq_parameter_set_rbsp");break;case 8:F.push("pic_parameter_set_rbsp");break;case 9:F.push("access_unit_delimiter_rbsp");break;default:F.push("UNKNOWN NAL - "+E[R]&31)}return F}(h)}},mdhd:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x=4,B={version:R.getUint8(0),flags:new Uint8Array(h.subarray(1,4)),language:""};return B.version===1?(x+=4,B.creationTime=Wt(R.getUint32(x)),x+=8,B.modificationTime=Wt(R.getUint32(x)),x+=4,B.timescale=R.getUint32(x),x+=8,B.duration=R.getUint32(x)):(B.creationTime=Wt(R.getUint32(x)),x+=4,B.modificationTime=Wt(R.getUint32(x)),x+=4,B.timescale=R.getUint32(x),x+=4,B.duration=R.getUint32(x)),x+=4,E=R.getUint16(x),B.language+=String.fromCharCode(96+(E>>10)),B.language+=String.fromCharCode(96+((992&E)>>5)),B.language+=String.fromCharCode(96+(31&E)),B},mdia:function(h){return{boxes:It(h)}},mfhd:function(h){return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),sequenceNumber:h[4]<<24|h[5]<<16|h[6]<<8|h[7]}},minf:function(h){return{boxes:It(h)}},mp4a:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength),R={dataReferenceIndex:E.getUint16(6),channelcount:E.getUint16(16),samplesize:E.getUint16(18),samplerate:E.getUint16(24)+E.getUint16(26)/65536};return h.byteLength>28&&(R.streamDescriptor=It(h.subarray(28))[0]),R},moof:function(h){return{boxes:It(h)}},moov:function(h){return{boxes:It(h)}},mvex:function(h){return{boxes:It(h)}},mvhd:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength),R=4,x={version:E.getUint8(0),flags:new Uint8Array(h.subarray(1,4))};return x.version===1?(R+=4,x.creationTime=Wt(E.getUint32(R)),R+=8,x.modificationTime=Wt(E.getUint32(R)),R+=4,x.timescale=E.getUint32(R),R+=8,x.duration=E.getUint32(R)):(x.creationTime=Wt(E.getUint32(R)),R+=4,x.modificationTime=Wt(E.getUint32(R)),R+=4,x.timescale=E.getUint32(R),R+=4,x.duration=E.getUint32(R)),R+=4,x.rate=E.getUint16(R)+E.getUint16(R+2)/16,R+=4,x.volume=E.getUint8(R)+E.getUint8(R+1)/8,R+=2,R+=2,R+=8,x.matrix=new Uint32Array(h.subarray(R,R+36)),R+=36,R+=24,x.nextTrackId=E.getUint32(R),x},pdin:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength);return{version:E.getUint8(0),flags:new Uint8Array(h.subarray(1,4)),rate:E.getUint32(4),initialDelay:E.getUint32(8)}},sdtp:function(h){var E,R={version:h[0],flags:new Uint8Array(h.subarray(1,4)),samples:[]};for(E=4;E<h.byteLength;E++)R.samples.push({dependsOn:(48&h[E])>>4,isDependedOn:(12&h[E])>>2,hasRedundancy:3&h[E]});return R},sidx:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x={version:h[0],flags:new Uint8Array(h.subarray(1,4)),references:[],referenceId:R.getUint32(4),timescale:R.getUint32(8),earliestPresentationTime:R.getUint32(12),firstOffset:R.getUint32(16)},B=R.getUint16(22);for(E=24;B;E+=12,B--)x.references.push({referenceType:(128&h[E])>>>7,referencedSize:2147483647&R.getUint32(E),subsegmentDuration:R.getUint32(E+4),startsWithSap:!!(128&h[E+8]),sapType:(112&h[E+8])>>>4,sapDeltaTime:268435455&R.getUint32(E+8)});return x},smhd:function(h){return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),balance:h[4]+h[5]/256}},stbl:function(h){return{boxes:It(h)}},stco:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x={version:h[0],flags:new Uint8Array(h.subarray(1,4)),chunkOffsets:[]},B=R.getUint32(4);for(E=8;B;E+=4,B--)x.chunkOffsets.push(R.getUint32(E));return x},stsc:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x=R.getUint32(4),B={version:h[0],flags:new Uint8Array(h.subarray(1,4)),sampleToChunks:[]};for(E=8;x;E+=12,x--)B.sampleToChunks.push({firstChunk:R.getUint32(E),samplesPerChunk:R.getUint32(E+4),sampleDescriptionIndex:R.getUint32(E+8)});return B},stsd:function(h){return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),sampleDescriptions:It(h.subarray(8))}},stsz:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x={version:h[0],flags:new Uint8Array(h.subarray(1,4)),sampleSize:R.getUint32(4),entries:[]};for(E=12;E<h.byteLength;E+=4)x.entries.push(R.getUint32(E));return x},stts:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x={version:h[0],flags:new Uint8Array(h.subarray(1,4)),timeToSamples:[]},B=R.getUint32(4);for(E=8;B;E+=8,B--)x.timeToSamples.push({sampleCount:R.getUint32(E),sampleDelta:R.getUint32(E+4)});return x},styp:function(h){return jr.ftyp(h)},tfdt:function(h){var E={version:h[0],flags:new Uint8Array(h.subarray(1,4)),baseMediaDecodeTime:h[4]<<24|h[5]<<16|h[6]<<8|h[7]};return E.version===1&&(E.baseMediaDecodeTime*=Math.pow(2,32),E.baseMediaDecodeTime+=h[8]<<24|h[9]<<16|h[10]<<8|h[11]),E},tfhd:function(h){var E,R=new DataView(h.buffer,h.byteOffset,h.byteLength),x={version:h[0],flags:new Uint8Array(h.subarray(1,4)),trackId:R.getUint32(4)},B=1&x.flags[2],F=2&x.flags[2],$=8&x.flags[2],X=16&x.flags[2],Q=32&x.flags[2],ee=65536&x.flags[0],fe=131072&x.flags[0];return E=8,B&&(E+=4,x.baseDataOffset=R.getUint32(12),E+=4),F&&(x.sampleDescriptionIndex=R.getUint32(E),E+=4),$&&(x.defaultSampleDuration=R.getUint32(E),E+=4),X&&(x.defaultSampleSize=R.getUint32(E),E+=4),Q&&(x.defaultSampleFlags=R.getUint32(E)),ee&&(x.durationIsEmpty=!0),!B&&fe&&(x.baseDataOffsetIsMoof=!0),x},tkhd:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength),R=4,x={version:E.getUint8(0),flags:new Uint8Array(h.subarray(1,4))};return x.version===1?(R+=4,x.creationTime=Wt(E.getUint32(R)),R+=8,x.modificationTime=Wt(E.getUint32(R)),R+=4,x.trackId=E.getUint32(R),R+=4,R+=8,x.duration=E.getUint32(R)):(x.creationTime=Wt(E.getUint32(R)),R+=4,x.modificationTime=Wt(E.getUint32(R)),R+=4,x.trackId=E.getUint32(R),R+=4,R+=4,x.duration=E.getUint32(R)),R+=4,R+=8,x.layer=E.getUint16(R),R+=2,x.alternateGroup=E.getUint16(R),R+=2,x.volume=E.getUint8(R)+E.getUint8(R+1)/8,R+=2,R+=2,x.matrix=new Uint32Array(h.subarray(R,R+36)),R+=36,x.width=E.getUint16(R)+E.getUint16(R+2)/16,R+=4,x.height=E.getUint16(R)+E.getUint16(R+2)/16,x},traf:function(h){return{boxes:It(h)}},trak:function(h){return{boxes:It(h)}},trex:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength);return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),trackId:E.getUint32(4),defaultSampleDescriptionIndex:E.getUint32(8),defaultSampleDuration:E.getUint32(12),defaultSampleSize:E.getUint32(16),sampleDependsOn:3&h[20],sampleIsDependedOn:(192&h[21])>>6,sampleHasRedundancy:(48&h[21])>>4,samplePaddingValue:(14&h[21])>>1,sampleIsDifferenceSample:!!(1&h[21]),sampleDegradationPriority:E.getUint16(22)}},trun:function(h){var E,R={version:h[0],flags:new Uint8Array(h.subarray(1,4)),samples:[]},x=new DataView(h.buffer,h.byteOffset,h.byteLength),B=1&R.flags[2],F=4&R.flags[2],$=1&R.flags[1],X=2&R.flags[1],Q=4&R.flags[1],ee=8&R.flags[1],fe=x.getUint32(4),me=8;for(B&&(R.dataOffset=x.getInt32(me),me+=4),F&&fe&&(E={flags:Sd(h.subarray(me,me+4))},me+=4,$&&(E.duration=x.getUint32(me),me+=4),X&&(E.size=x.getUint32(me),me+=4),ee&&(E.compositionTimeOffset=x.getUint32(me),me+=4),R.samples.push(E),fe--);fe--;)E={},$&&(E.duration=x.getUint32(me),me+=4),X&&(E.size=x.getUint32(me),me+=4),Q&&(E.flags=Sd(h.subarray(me,me+4)),me+=4),ee&&(E.compositionTimeOffset=x.getUint32(me),me+=4),R.samples.push(E);return R},"url ":function(h){return{version:h[0],flags:new Uint8Array(h.subarray(1,4))}},vmhd:function(h){var E=new DataView(h.buffer,h.byteOffset,h.byteLength);return{version:h[0],flags:new Uint8Array(h.subarray(1,4)),graphicsmode:E.getUint16(4),opcolor:new Uint16Array([E.getUint16(6),E.getUint16(8),E.getUint16(10)])}}},Js={inspect:It=function(h){for(var E,R,x,B,F,$=0,X=[],Q=new ArrayBuffer(h.length),ee=new Uint8Array(Q),fe=0;fe<h.length;++fe)ee[fe]=h[fe];for(E=new DataView(Q);$<h.byteLength;)R=E.getUint32($),x=In(h.subarray($+4,$+8)),B=R>1?$+R:h.byteLength,(F=(jr[x]||function(me){return{data:me}})(h.subarray($+8,B))).size=R,F.type=x,X.push(F),$=B;return X},textify:Td=function(h,E){var R;return E=E||0,R=new Array(2*E+1).join(" "),h.map(function(x,B){return R+x.type+`
`+Object.keys(x).filter(function(F){return F!=="type"&&F!=="boxes"}).map(function(F){var $=R+"  "+F+": ",X=x[F];if(X instanceof Uint8Array||X instanceof Uint32Array){var Q=Array.prototype.slice.call(new Uint8Array(X.buffer,X.byteOffset,X.byteLength)).map(function(ee){return" "+("00"+ee.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return Q?Q.length===1?$+"<"+Q.join("").slice(1)+">":$+`<
`+Q.map(function(ee){return R+"  "+ee}).join(`
`)+`
`+R+"  >":$+"<>"}return $+JSON.stringify(X,null,2).split(`
`).map(function(ee,fe){return fe===0?ee:R+"  "+ee}).join(`
`)}).join(`
`)+(x.boxes?`
`+Td(x.boxes,E+1):"")}).join(`
`)},parseTfdt:jr.tfdt,parseHdlr:jr.hdlr,parseTfhd:jr.tfhd,parseTrun:jr.trun,parseSidx:jr.sidx},qm=Lm,Wm=Ns.CaptionStream,Km=function(h,E){for(var R=h,x=0;x<E.length;x++){var B=E[x];if(R<B.size)return B;R-=B.size}return null},$m=function(h,E){var R=Mr.findBox(h,["moof","traf"]),x={},B=[];return Mr.findBox(h,["mdat"]).forEach(function(F,$){var X=R[$];B.push({mdat:F,traf:X})}),B.forEach(function(F){var $,X=F.mdat,Q=F.traf,ee=Mr.findBox(Q,["tfhd"]),fe=Js.parseTfhd(ee[0]),me=fe.trackId,Ae=Mr.findBox(Q,["tfdt"]),xe=Ae.length>0?Js.parseTfdt(Ae[0]).baseMediaDecodeTime:0,Ie=Mr.findBox(Q,["trun"]);E===me&&Ie.length>0&&($=function(Le,_t,vt){var yt,xt,Ye,Nt,vr=new DataView(Le.buffer,Le.byteOffset,Le.byteLength),Br=[];for(xt=0;xt+4<Le.length;xt+=Ye)if(Ye=vr.getUint32(xt),xt+=4,!(Ye<=0))switch(31&Le[xt]){case 6:var yr=Le.subarray(xt+1,xt+1+Ye),dt=Km(xt,_t);yt={nalUnitType:"sei_rbsp",size:Ye,data:yr,escapedRBSP:qm(yr),trackId:vt},dt?(yt.pts=dt.pts,yt.dts=dt.dts,Nt=dt):(yt.pts=Nt.pts,yt.dts=Nt.dts),Br.push(yt)}return Br}(X,function(Le,_t,vt){var yt=_t,xt=vt.defaultSampleDuration||0,Ye=vt.defaultSampleSize||0,Nt=vt.trackId,vr=[];return Le.forEach(function(Br){var yr=Js.parseTrun(Br).samples;yr.forEach(function(dt){dt.duration===void 0&&(dt.duration=xt),dt.size===void 0&&(dt.size=Ye),dt.trackId=Nt,dt.dts=yt,dt.compositionTimeOffset===void 0&&(dt.compositionTimeOffset=0),dt.pts=yt+dt.compositionTimeOffset,yt+=dt.duration}),vr=vr.concat(yr)}),vr}(Ie,xe,fe),me),x[me]||(x[me]=[]),x[me]=x[me].concat($))}),x},Xm={generator:ri,probe:Mr,Transmuxer:Ys.Transmuxer,AudioSegmentStream:Ys.AudioSegmentStream,VideoSegmentStream:Ys.VideoSegmentStream,CaptionParser:function(){var h,E,R,x,B,F=!1;this.isInitialized=function(){return F},this.init=function(){h=new Wm,F=!0,h.on("data",function($){$.startTime=$.startPts/x,$.endTime=$.endPts/x,B.captions.push($),B.captionStreams[$.stream]=!0})},this.isNewInit=function($,X){return!($&&$.length===0||X&&typeof X=="object"&&Object.keys(X).length===0||R===$[0]&&x===X[R])},this.parse=function($,X,Q){var ee;if(!this.isInitialized()||!X||!Q)return null;if(this.isNewInit(X,Q))R=X[0],x=Q[R];else if(!R||!x)return E.push($),null;for(;E.length>0;){var fe=E.shift();this.parse(fe,X,Q)}return(ee=function(me,Ae,xe){return Ae?{seiNals:$m(me,Ae)[Ae],timescale:xe}:null}($,R,x))!==null&&ee.seiNals?(this.pushNals(ee.seiNals),this.flushStream(),B):null},this.pushNals=function($){if(!this.isInitialized()||!$||$.length===0)return null;$.forEach(function(X){h.push(X)})},this.flushStream=function(){if(!this.isInitialized())return null;h.flush()},this.clearParsedCaptions=function(){B.captions=[],B.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;h.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){E=[],R=null,x=null,B?this.clearParsedCaptions():B={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},Ym=function(h,E){if(!(h instanceof E))throw new TypeError("Cannot call a class as a function")},Jm=function(){function h(E,R){for(var x=0;x<R.length;x++){var B=R[x];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(E,B.key,B)}}return function(E,R,x){return R&&h(E.prototype,R),x&&h(E,x),E}}(),kd=function(){function h(E,R){Ym(this,h),this.options=R||{},this.self=E,this.init()}return Jm(h,[{key:"init",value:function(){var E,R;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Xm.Transmuxer(this.options),E=this.self,(R=this.transmuxer).on("data",function(x){var B=x.initSegment;x.initSegment={data:B.buffer,byteOffset:B.byteOffset,byteLength:B.byteLength};var F=x.data;x.data=F.buffer,E.postMessage({action:"data",segment:x,byteOffset:F.byteOffset,byteLength:F.byteLength},[x.data])}),R.captionStream&&R.captionStream.on("data",function(x){E.postMessage({action:"caption",data:x})}),R.on("done",function(x){E.postMessage({action:"done"})}),R.on("gopInfo",function(x){E.postMessage({action:"gopInfo",gopInfo:x})}),R.on("videoSegmentTimingInfo",function(x){E.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:x})})}},{key:"push",value:function(E){var R=new Uint8Array(E.data,E.byteOffset,E.byteLength);this.transmuxer.push(R)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(E){var R=E.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*R))}},{key:"setAudioAppendStart",value:function(E){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*E.appendStart))}},{key:"flush",value:function(E){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(E){this.transmuxer.alignGopsWith(E.gopsToAlignWith.slice())}}]),h}();new function(h){h.onmessage=function(E){E.data.action==="init"&&E.data.options?this.messageHandlers=new kd(h,E.data.options):(this.messageHandlers||(this.messageHandlers=new kd(h)),E.data&&E.data.action&&E.data.action!=="init"&&this.messageHandlers[E.data.action]&&this.messageHandlers[E.data.action](E.data))}}(r)})()}),Ac={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},Rc=function(t){return t.map(function(i){return i.replace(/avc1\.(\d+)\.(\d+)/i,function(r,e,n){return"avc1."+("00"+Number(e).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)})})},Ci=function(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r={codecCount:0};return r.codecCount=i.split(",").length,r.codecCount=r.codecCount||2,(t=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(i))&&(r.videoCodec=t[2],r.videoObjectTypeIndicator=t[3]),r.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(i),r.audioProfile=r.audioProfile&&r.audioProfile[2],r},Es=function(t,i,r){return t+"/"+i+'; codecs="'+r.filter(function(e){return!!e}).join(", ")+'"'},Vp=function(t,i){var r=function(j){return j.segments&&j.segments.length&&j.segments[0].map?"mp4":"mp2t"}(i),e=function(j){var G=j.attributes||{};return G.CODECS?Ci(G.CODECS):Ac}(i),n=i.attributes||{},a=!0,s=!1;if(!i)return[];if(t.mediaGroups.AUDIO&&n.AUDIO){var o=t.mediaGroups.AUDIO[n.AUDIO];if(o){for(var u in s=!0,a=!1,o)if(!o[u].uri&&!o[u].playlists){a=!0;break}}}s&&!e.audioProfile&&(a||(e.audioProfile=function(j,G){if(!j.mediaGroups.AUDIO||!G)return null;var H=j.mediaGroups.AUDIO[G];if(!H)return null;for(var K in H){var W=H[K];if(W.default&&W.playlists)return Ci(W.playlists[0].attributes.CODECS).audioProfile}return null}(t,n.AUDIO)),e.audioProfile||(J.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),e.audioProfile=Ac.audioProfile));var v={};e.videoCodec&&(v.video=""+e.videoCodec+e.videoObjectTypeIndicator),e.audioProfile&&(v.audio="mp4a.40."+e.audioProfile);var C=Es("audio",r,[v.audio]),k=Es("video",r,[v.video]),M=Es("video",r,[v.video,v.audio]);return s?!a&&v.video?[k,C]:a||v.video?[M,C]:[C,C]:v.video?[M]:[C]},Lc=function(t){return/mp4a\.\d+.\d+/i.test(t)},Oc=function(t){return/avc1\.[\da-f]+/i.test(t)},Gp=function(t,i,r){var e=null,n=null,a=0,s=[],o=[];if(!t&&!i)return J.createTimeRange();if(!t)return i.buffered;if(!i||r)return t.buffered;if(t.buffered.length===0&&i.buffered.length===0)return J.createTimeRange();for(var u=t.buffered,v=i.buffered,C=u.length;C--;)s.push({time:u.start(C),type:"start"}),s.push({time:u.end(C),type:"end"});for(C=v.length;C--;)s.push({time:v.start(C),type:"start"}),s.push({time:v.end(C),type:"end"});for(s.sort(function(k,M){return k.time-M.time}),C=0;C<s.length;C++)s[C].type==="start"?++a===2&&(e=s[C].time):s[C].type==="end"&&--a===1&&(n=s[C].time),e!==null&&n!==null&&(o.push([e,n]),e=null,n=null);return J.createTimeRanges(o)},Hp=function(t){function i(r,e){zt(this,i);var n=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,J.EventTarget));n.timestampOffset_=0,n.pendingBuffers_=[],n.bufferUpdating_=!1,n.mediaSource_=r,n.codecs_=e,n.audioCodec_=null,n.videoCodec_=null,n.audioDisabled_=!1,n.appendAudioInitSegment_=!0,n.gopBuffer_=[],n.timeMapping_=0,n.safeAppend_=J.browser.IE_VERSION>=11;var a={remux:!1,alignGopsAtEnd:n.safeAppend_};return n.codecs_.forEach(function(s){Lc(s)?n.audioCodec_=s:Oc(s)&&(n.videoCodec_=s)}),n.transmuxer_=new Fp,n.transmuxer_.postMessage({action:"init",options:a}),n.transmuxer_.onmessage=function(s){return s.data.action==="data"?n.data_(s):s.data.action==="done"?n.done_(s):s.data.action==="gopInfo"?n.appendGopInfo_(s):s.data.action==="videoSegmentTimingInfo"?n.videoSegmentTimingInfo_(s.data.videoSegmentTimingInfo):void 0},Object.defineProperty(n,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(s){typeof s=="number"&&s>=0&&(this.timestampOffset_=s,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:s}))}}),Object.defineProperty(n,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(s){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=s),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=s)}}),Object.defineProperty(n,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(n,"buffered",{get:function(){return Gp(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),n}return or(i,t),Qt(i,[{key:"data_",value:function(r){var e=r.data.segment;e.data=new Uint8Array(e.data,r.data.byteOffset,r.data.byteLength),e.initSegment=new Uint8Array(e.initSegment.data,e.initSegment.byteOffset,e.initSegment.byteLength),function(n,a,s){var o=a.player_;if(s.captions&&s.captions.length){for(var u in n.inbandTextTracks_||(n.inbandTextTracks_={}),s.captionStreams)if(!n.inbandTextTracks_[u]){o.tech_.trigger({type:"usage",name:"hls-608"});var v=o.textTracks().getTrackById(u);n.inbandTextTracks_[u]=v||o.addRemoteTextTrack({kind:"captions",id:u,label:u},!1).track}}s.metadata&&s.metadata.length&&!n.metadataTrack_&&(n.metadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,n.metadataTrack_.inBandMetadataTrackDispatchType=s.metadata.dispatchType)}(this,this.mediaSource_,e),this.pendingBuffers_.push(e)}},{key:"done_",value:function(r){this.mediaSource_.readyState!=="closed"?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(r){var e={start:{decode:r.start.dts/9e4,presentation:r.start.pts/9e4},end:{decode:r.end.dts/9e4,presentation:r.end.pts/9e4},baseMediaDecodeTime:r.baseMediaDecodeTime/9e4};r.prependedContentDuration&&(e.prependedContentDuration=r.prependedContentDuration/9e4),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:e})}},{key:"createRealSourceBuffers_",value:function(){var r=this,e=["audio","video"];e.forEach(function(n){if(r[n+"Codec_"]&&!r[n+"Buffer_"]){var a=null;if(r.mediaSource_[n+"Buffer_"])(a=r.mediaSource_[n+"Buffer_"]).updating=!1;else{var s=n+'/mp4;codecs="'+r[n+"Codec_"]+'"';a=function(o,u){var v=o.addSourceBuffer(u),C=Object.create(null);C.updating=!1,C.realBuffer_=v;var k=function(j){typeof v[j]=="function"?C[j]=function(){return v[j].apply(v,arguments)}:C[j]===void 0&&Object.defineProperty(C,j,{get:function(){return v[j]},set:function(G){return v[j]=G}})};for(var M in v)k(M);return C}(r.mediaSource_.nativeMediaSource_,s),r.mediaSource_[n+"Buffer_"]=a}r[n+"Buffer_"]=a,["update","updatestart","updateend"].forEach(function(o){a.addEventListener(o,function(){if(n!=="audio"||!r.audioDisabled_)return o==="updateend"&&(r[n+"Buffer_"].updating=!1),e.every(function(u){return!(u!=="audio"||!r.audioDisabled_)||n===u||!r[u+"Buffer_"]||!r[u+"Buffer_"].updating})?r.trigger(o):void 0})})}})}},{key:"appendBuffer",value:function(r){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var e=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:e.end(e.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:function(n,a,s){if(a==null||!n.length)return[];var o=Math.ceil(9e4*(a-s+3)),u=void 0;for(u=0;u<n.length&&!(n[u].pts>o);u++);return n.slice(u)}(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength},[r.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(r){this.gopBuffer_=function(e,n,a){if(!n.length)return e;if(a)return n.slice();for(var s=n[0].pts,o=0;o<e.length&&!(e[o].pts>=s);o++);return e.slice(0,o).concat(n)}(this.gopBuffer_,r.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(r,e){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(r,e),this.gopBuffer_=function(a,s,o,u){for(var v=Math.ceil(9e4*(s-u)),C=Math.ceil(9e4*(o-u)),k=a.slice(),M=a.length;M--&&!(a[M].pts<=C););if(M===-1)return k;for(var j=M+1;j--&&!(a[j].pts<=v););return j=Math.max(j,0),k.splice(j,M-j+1),k}(this.gopBuffer_,r,e,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(r,e)),Qr(r,e,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Qr(r,e,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var r={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};r=this.pendingBuffers_.reduce(function(n,a){var s=a.type,o=a.data,u=a.initSegment;return n[s].segments.push(o),n[s].bytes+=o.byteLength,n[s].initSegment=u,a.captions&&(n.captions=n.captions.concat(a.captions)),a.info&&(n[s].info=a.info),a.metadata&&(n.metadata=n.metadata.concat(a.metadata)),n},r),this.videoBuffer_||this.audioBuffer_||(r.video.bytes===0&&(this.videoCodec_=null),r.audio.bytes===0&&(this.audioCodec_=null),this.createRealSourceBuffers_()),r.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:r.audio.info}),r.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:r.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(r.audio.segments.unshift(r.audio.initSegment),r.audio.bytes+=r.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var e=!1;this.videoBuffer_&&r.video.bytes?(r.video.segments.unshift(r.video.initSegment),r.video.bytes+=r.video.initSegment.byteLength,this.concatAndAppendSegments_(r.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(e=!0),jp(this,r.captions,r.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(r.audio,this.audioBuffer_),this.pendingBuffers_.length=0,e&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(r,e){var n=0,a=void 0;if(r.bytes){a=new Uint8Array(r.bytes),r.segments.forEach(function(s){a.set(s,n),n+=s.byteLength});try{e.updating=!0,e.appendBuffer(a)}catch(s){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:s.message,originalError:s})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),i}(J.EventTarget),Cs=function(t){function i(){zt(this,i);var r=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),e=void 0;for(e in r.nativeMediaSource_=new L.MediaSource,r.nativeMediaSource_)e in i.prototype||typeof r.nativeMediaSource_[e]!="function"||(r[e]=r.nativeMediaSource_[e].bind(r.nativeMediaSource_));return r.duration_=NaN,Object.defineProperty(r,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(n){this.duration_=n,n===1/0||(this.nativeMediaSource_.duration=n)}}),Object.defineProperty(r,"seekable",{get:function(){return this.duration_===1/0?J.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(r,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(r,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),r.sourceBuffers=[],r.activeSourceBuffers_=[],r.updateActiveSourceBuffers_=function(){if(r.activeSourceBuffers_.length=0,r.sourceBuffers.length===1){var n=r.sourceBuffers[0];return n.appendAudioInitSegment_=!0,n.audioDisabled_=!n.audioCodec_,void r.activeSourceBuffers_.push(n)}for(var a=!1,s=!0,o=0;o<r.player_.audioTracks().length;o++){var u=r.player_.audioTracks()[o];if(u.enabled&&u.kind!=="main"){a=!0,s=!1;break}}r.sourceBuffers.forEach(function(v,C){if(v.appendAudioInitSegment_=!0,v.videoCodec_&&v.audioCodec_)v.audioDisabled_=a;else if(v.videoCodec_&&!v.audioCodec_)v.audioDisabled_=!0,s=!1;else if(!v.videoCodec_&&v.audioCodec_&&(v.audioDisabled_=C?s:!s,v.audioDisabled_))return;r.activeSourceBuffers_.push(v)})},r.onPlayerMediachange_=function(){r.sourceBuffers.forEach(function(n){n.appendAudioInitSegment_=!0})},r.onHlsReset_=function(){r.sourceBuffers.forEach(function(n){n.transmuxer_&&n.transmuxer_.postMessage({action:"resetCaptions"})})},r.onHlsSegmentTimeMapping_=function(n){r.sourceBuffers.forEach(function(a){return a.timeMapping_=n.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(n){this.nativeMediaSource_.addEventListener(n,this.trigger.bind(this))},r),r.on("sourceopen",function(n){var a=q.querySelector('[src="'+r.url_+'"]');a&&(r.player_=J(a.parentNode),r.player_&&(r.player_.tech_.on("hls-reset",r.onHlsReset_),r.player_.tech_.on("hls-segment-time-mapping",r.onHlsSegmentTimeMapping_),r.player_.audioTracks&&r.player_.audioTracks()&&(r.player_.audioTracks().on("change",r.updateActiveSourceBuffers_),r.player_.audioTracks().on("addtrack",r.updateActiveSourceBuffers_),r.player_.audioTracks().on("removetrack",r.updateActiveSourceBuffers_)),r.player_.on("mediachange",r.onPlayerMediachange_)))}),r.on("sourceended",function(n){for(var a=kc(r.duration),s=0;s<r.sourceBuffers.length;s++){var o=r.sourceBuffers[s],u=o.metadataTrack_&&o.metadataTrack_.cues;u&&u.length&&(u[u.length-1].endTime=a)}}),r.on("sourceclose",function(n){this.sourceBuffers.forEach(function(a){a.transmuxer_&&a.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),r}return or(i,t),Qt(i,[{key:"addSeekableRange_",value:function(r,e){var n=void 0;if(this.duration!==1/0)throw(n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",n.code=11,n;(e>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=e)}},{key:"addSourceBuffer",value:function(r){var e=void 0,n=function(s){var o={type:"",parameters:{}},u=s.trim().split(";");return o.type=u.shift().trim(),u.forEach(function(v){var C=v.trim().split("=");if(C.length>1){var k=C[0].replace(/"/g,"").trim(),M=C[1].replace(/"/g,"").trim();o.parameters[k]=M}}),o}(r);if(/^(video|audio)\/mp2t$/i.test(n.type)){var a=[];n.parameters&&n.parameters.codecs&&(a=n.parameters.codecs.split(","),a=(a=Rc(a)).filter(function(s){return Lc(s)||Oc(s)})),a.length===0&&(a=["avc1.4d400d","mp4a.40.2"]),e=new Hp(this,a),this.sourceBuffers.length!==0&&(this.sourceBuffers[0].createRealSourceBuffers_(),e.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else e=this.nativeMediaSource_.addSourceBuffer(r);return this.sourceBuffers.push(e),e}}]),i}(J.EventTarget),Ic=0;J.mediaSources={};var xc=function(t,i){var r=J.mediaSources[t];if(!r)throw new Error("Media Source not found (Video.js)");r.trigger({type:"sourceopen",swfId:i})},ws=function(){return!!L.MediaSource&&!!L.MediaSource.isTypeSupported&&L.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},wi=function(){if(this.MediaSource={open:xc,supportsNativeMediaSources:ws},ws())return new Cs;throw new Error("Cannot use create a virtual MediaSource for this video")};wi.open=xc,wi.supportsNativeMediaSources=ws;var Dc={createObjectURL:function(t){var i=void 0;return t instanceof Cs?(i=L.URL.createObjectURL(t.nativeMediaSource_),t.url_=i,i):t instanceof Cs?(i="blob:vjs-media-source/"+Ic,Ic++,J.mediaSources[i]=t,i):(i=L.URL.createObjectURL(t),t.url_=i,i)}};J.MediaSource=wi,J.URL=Dc;var zp=J.EventTarget,Mc=J.mergeOptions,Uc=function(t,i){for(var r=void 0,e=Mc(t,{duration:i.duration,minimumUpdatePeriod:i.minimumUpdatePeriod}),n=0;n<i.playlists.length;n++){var a=vs(e,i.playlists[n]);a?e=a:r=!0}return yn(i,function(s,o,u,v){if(s.playlists&&s.playlists.length){var C=s.playlists[0].uri,k=vs(e,s.playlists[0]);k&&((e=k).mediaGroups[o][u][v].playlists[0]=e.playlists[C],r=!1)}}),r?null:e},Ps=function(t){var i=t.byterange.offset+t.byterange.length-1;return t.uri+"-"+t.byterange.offset+"-"+i},jc=function(t,i){var r,e,n={};for(var a in t){var s=t[a].sidx;if(s){var o=Ps(s);if(!i[o])break;var u=i[o].sidxInfo;r=u,e=s,(!r.map&&!e.map||r.map&&e.map&&r.map.byterange.offset===e.map.byterange.offset&&r.map.byterange.length===e.map.byterange.length)&&r.uri===e.uri&&r.byterange.offset===e.byterange.offset&&r.byterange.length===e.byterange.length&&(n[o]=i[o])}}return n},Bc=function(t,i,r,e,n){var a={uri:vn(e.handleManifestRedirects,t.resolvedUri),byterange:t.byterange,playlist:i};return r(J.mergeOptions(a,{responseType:"arraybuffer",headers:bs(a)}),n)},As=function(t){function i(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments[3];zt(this,i);var s=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),o=n.withCredentials,u=o!==void 0&&o,v=n.handleManifestRedirects,C=v!==void 0&&v;if(s.hls_=e,s.withCredentials=u,s.handleManifestRedirects=C,!r)throw new Error("A non-empty playlist URL or playlist is required");return s.on("minimumUpdatePeriod",function(){s.refreshXml_()}),s.on("mediaupdatetimeout",function(){s.refreshMedia_(s.media().uri)}),s.state="HAVE_NOTHING",s.loadedPlaylists_={},typeof r=="string"?(s.srcUrl=r,s.sidxMapping_={},ar(s)):(s.setupChildLoader(a,r),s)}return or(i,zp),Qt(i,[{key:"setupChildLoader",value:function(r,e){this.masterPlaylistLoader_=r,this.childPlaylist_=e}},{key:"dispose",value:function(){this.stopRequest(),this.loadedPlaylists_={},L.clearTimeout(this.minimumUpdatePeriodTimeout_),L.clearTimeout(this.mediaRequest_),L.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var r=this.request;this.request=null,r.onreadystatechange=null,r.abort()}}},{key:"sidxRequestFinished_",value:function(r,e,n,a){var s=this;return function(o,u){if(s.request){if(s.request=null,o)return s.error={status:u.status,message:"DASH playlist request error at URL: "+r.uri,response:u.response,code:2},n&&(s.state=n),s.trigger("error"),a(e,null);var v=new Uint8Array(u.response),C=an.parseSidx(v.subarray(8));return a(e,C)}}}},{key:"media",value:function(r){var e=this;if(!r)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if(typeof r=="string"){if(!this.master.playlists[r])throw new Error("Unknown playlist URI: "+r);r=this.master.playlists[r]}var a=!this.media_||r.uri!==this.media_.uri;if(a&&this.loadedPlaylists_[r.uri]&&this.loadedPlaylists_[r.uri].endList)return this.state="HAVE_METADATA",this.media_=r,void(a&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(a)if(this.media_&&this.trigger("mediachanging"),r.sidx){var s=void 0,o=void 0;this.masterPlaylistLoader_?(s=this.masterPlaylistLoader_.master,o=this.masterPlaylistLoader_.sidxMapping_):(s=this.master,o=this.sidxMapping_);var u=Ps(r.sidx);o[u]={sidxInfo:r.sidx},this.request=Bc(r.sidx,r,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(r,s,n,function(v,C){if(!v||!C)throw new Error("failed to request sidx");o[u].sidx=C,e.haveMetadata({startingState:n,playlist:v.playlists[r.uri]})}))}else this.mediaRequest_=L.setTimeout(this.haveMetadata.bind(this,{startingState:n,playlist:r}),0)}},{key:"haveMetadata",value:function(r){var e=r.startingState,n=r.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.uri]=n,this.mediaRequest_=null,this.refreshMedia_(n.uri),e==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),L.clearTimeout(this.mediaUpdateTimeout),L.clearTimeout(this.minimumUpdatePeriodTimeout_),this.state==="HAVE_NOTHING"&&(this.started=!1)}},{key:"load",value:function(r){var e=this;L.clearTimeout(this.mediaUpdateTimeout),L.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(r){var a=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=L.setTimeout(function(){return e.load()},a)}else this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var r=Ml(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});r.uri=this.srcUrl;for(var e=0;e<r.playlists.length;e++){var n="placeholder-uri-"+e;r.playlists[e].uri=n,r.playlists[n]=r.playlists[e]}return yn(r,function(a,s,o,u){if(a.playlists&&a.playlists.length){var v="placeholder-uri-"+s+"-"+o+"-"+u;a.playlists[0].uri=v,r.playlists[v]=a.playlists[0]}}),ic(r),nc(r),r}},{key:"start",value:function(){var r=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=L.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,n){if(r.request){if(r.request=null,e)return r.error={status:n.status,message:"DASH playlist request error at URL: "+r.srcUrl,responseText:n.responseText,code:2},r.state==="HAVE_NOTHING"&&(r.started=!1),r.trigger("error");r.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?r.masterLoaded_=Date.parse(n.responseHeaders.date):r.masterLoaded_=Date.now(),r.srcUrl=vn(r.handleManifestRedirects,r.srcUrl,n),r.syncClientServerClock_(r.onClientServerClockSync_.bind(r))}})}},{key:"syncClientServerClock_",value:function(r){var e=this,n=Of(this.masterXml_);return n===null?(this.clientOffset_=this.masterLoaded_-Date.now(),r()):n.method==="DIRECT"?(this.clientOffset_=n.value-Date.now(),r()):void(this.request=this.hls_.xhr({uri:Or(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},function(a,s){if(e.request){if(a)return e.clientOffset_=e.masterLoaded_-Date.now(),r();var o=void 0;o=n.method==="HEAD"?s.responseHeaders&&s.responseHeaders.date?Date.parse(s.responseHeaders.date):e.masterLoaded_:Date.parse(s.responseText),e.clientOffset_=o-Date.now(),r()}}))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var r=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=L.setTimeout(function(){r.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var r=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,n){if(r.request){if(r.request=null,e)return r.error={status:n.status,message:"DASH playlist request error at URL: "+r.srcUrl,responseText:n.responseText,code:2},r.state==="HAVE_NOTHING"&&(r.started=!1),r.trigger("error");r.masterXml_=n.responseText,r.sidxMapping_=function(v,C,k,M){var j=Ml(v,{manifestUri:C,clientOffset:k}),G=jc(j.playlists,M);return yn(j,function(H,K,W,Y){if(H.playlists&&H.playlists.length){var ne=H.playlists;G=Mc(G,jc(ne,M))}}),G}(r.masterXml_,r.srcUrl,r.clientOffset_,r.sidxMapping_);var a=r.parseMasterXml(),s=Uc(r.master,a);if(s){var o=Ps(r.media().sidx);if(r.sidxMapping_[o])r.master=s;else{var u=r.media();r.request=Bc(u.sidx,u,r.hls_.xhr,{handleManifestRedirects:r.handleManifestRedirects},r.sidxRequestFinished_(u,a,r.state,function(v,C){if(!v||!C)throw new Error("failed to request sidx on minimumUpdatePeriod");r.sidxMapping_[o].sidx=C,r.minimumUpdatePeriodTimeout_=L.setTimeout(function(){r.trigger("minimumUpdatePeriod")},r.master.minimumUpdatePeriod),r.refreshMedia_(r.media().uri)}))}}r.minimumUpdatePeriodTimeout_=L.setTimeout(function(){r.trigger("minimumUpdatePeriod")},r.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(r){var e=this;if(!r)throw new Error("refreshMedia_ must take a media uri");var n=void 0,a=void 0;this.masterPlaylistLoader_?(n=this.masterPlaylistLoader_.master,a=this.masterPlaylistLoader_.parseMasterXml()):(n=this.master,a=this.parseMasterXml());var s=Uc(n,a);s?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=s:this.master=s,this.media_=s.playlists[r]):(this.media_=a.playlists[r],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=L.setTimeout(function(){e.trigger("mediaupdatetimeout")},ac(this.media(),!!s))),this.trigger("loadedplaylist")}}]),i}(),Pi=function(t){return J.log.debug?J.log.debug.bind(J,"VHS:",t+" >"):function(){}};function ti(){}var qp=function(){function t(i,r,e,n){zt(this,t),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=i,this.processedAppend_=!1,this.type_=e,this.mimeType_=r,this.logger_=Pi("SourceUpdater["+e+"]["+r+"]"),i.readyState==="closed"?i.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,r,n)):this.createSourceBuffer_(r,n)}return Qt(t,[{key:"createSourceBuffer_",value:function(i,r){var e=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(i),this.logger_("created SourceBuffer"),r&&(r.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?r.on("sourcebufferadded",function(){e.start_()}):this.start_()}},{key:"start_",value:function(){var i=this;this.started_=!0,this.onUpdateendCallback_=function(){var r=i.pendingCallback_;i.pendingCallback_=null,i.sourceBuffer_.removing=!1,i.logger_("buffered ["+Ts(i.buffered())+"]"),r&&r(),i.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(i){var r=this;this.processedAppend_&&this.queueCallback_(function(){r.sourceBuffer_.abort()},i)}},{key:"appendBuffer",value:function(i,r){var e=this;this.processedAppend_=!0,this.queueCallback_(function(){i.videoSegmentTimingInfoCallback&&e.sourceBuffer_.addEventListener("videoSegmentTimingInfo",i.videoSegmentTimingInfoCallback),e.sourceBuffer_.appendBuffer(i.bytes)},function(){i.videoSegmentTimingInfoCallback&&e.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",i.videoSegmentTimingInfoCallback),r()})}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:J.createTimeRanges()}},{key:"remove",value:function(i,r){var e=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ti;this.processedAppend_&&this.queueCallback_(function(){e.logger_("remove ["+i+" => "+r+"]"),e.sourceBuffer_.removing=!0,e.sourceBuffer_.remove(i,r)},n)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==ti}},{key:"timestampOffset",value:function(i){var r=this;return i!==void 0&&(this.queueCallback_(function(){r.sourceBuffer_.timestampOffset=i,r.runCallback_()}),this.timestampOffset_=i),this.timestampOffset_}},{key:"queueCallback_",value:function(i,r){this.callbacks_.push([i.bind(this),r]),this.runCallback_()}},{key:"runCallback_",value:function(){var i=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(i=this.callbacks_.shift(),this.pendingCallback_=i[1],i[0]())}},{key:"dispose",value:function(){var i=this,r=function e(){i.sourceBuffer_&&i.mediaSource.readyState==="open"&&i.sourceBuffer_.abort(),i.sourceBuffer_.removeEventListener("updateend",e)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",r):r()}}]),t}(),Ut={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Sn=2,Nc=-101,Fc=-102,Vc=function(t){t.forEach(function(i){i.abort()})},Rs=function(t,i){return i.timedout?{status:i.status,message:"HLS request timed-out at URL: "+i.uri,code:Nc,xhr:i}:i.aborted?{status:i.status,message:"HLS request aborted at URL: "+i.uri,code:Fc,xhr:i}:t?{status:i.status,message:"HLS request errored at URL: "+i.uri,code:Sn,xhr:i}:null},Wp=function(t,i,r){var e=0,n=!1;return function(a,s){if(!n)return a?(n=!0,Vc(t),r(a,s)):(e+=1)===t.length?(s.endOfAllRequests=Date.now(),s.encryptedBytes?function(o,u,v){o.addEventListener("message",function k(M){if(M.data.source===u.requestId){o.removeEventListener("message",k);var j=M.data.decrypted;return u.bytes=new Uint8Array(j.bytes,j.byteOffset,j.byteLength),v(null,u)}});var C=void 0;C=u.key.bytes.slice?u.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(u.key.bytes)),o.postMessage(gc({source:u.requestId,encrypted:u.encryptedBytes,key:C,iv:u.key.iv}),[u.encryptedBytes.buffer,C.buffer])}(i,s,r):r(null,s)):void 0}},Kp=function(t,i){return function(r){var e,n,a;return t.stats=J.mergeOptions(t.stats,(n=(e=r).target,(a={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-n.requestTime||0}).bytesReceived=e.loaded,a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3),a)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),i(r,t)}},$p=function(t,i,r,e,n,a,s){var o=[],u=Wp(o,r,s);if(n.key&&!n.key.bytes){var v=t(J.mergeOptions(i,{uri:n.key.resolvedUri,responseType:"arraybuffer"}),function(M,j){return function(G,H){var K=H.response,W=Rs(G,H);if(W)return j(W,M);if(K.byteLength!==16)return j({status:H.status,message:"Invalid HLS key at URL: "+H.uri,code:Sn,xhr:H},M);var Y=new DataView(K);return M.key.bytes=new Uint32Array([Y.getUint32(0),Y.getUint32(4),Y.getUint32(8),Y.getUint32(12)]),j(null,M)}}(n,u));o.push(v)}if(n.map&&!n.map.bytes){var C=t(J.mergeOptions(i,{uri:n.map.resolvedUri,responseType:"arraybuffer",headers:bs(n.map)}),function(M,j,G){return function(H,K){var W=K.response,Y=Rs(H,K);return Y?G(Y,M):W.byteLength===0?G({status:K.status,message:"Empty HLS segment content at URL: "+K.uri,code:Sn,xhr:K},M):(M.map.bytes=new Uint8Array(K.response),j&&!j.isInitialized()&&j.init(),M.map.timescales=Yt.timescale(M.map.bytes),M.map.videoTrackIds=Yt.videoTrackIds(M.map.bytes),G(null,M))}}(n,e,u));o.push(C)}var k=t(J.mergeOptions(i,{uri:n.resolvedUri,responseType:"arraybuffer",headers:bs(n)}),function(M,j,G){return function(H,K){var W=K.response,Y=Rs(H,K),ne=void 0;return Y?G(Y,M):W.byteLength===0?G({status:K.status,message:"Empty HLS segment content at URL: "+K.uri,code:Sn,xhr:K},M):(M.stats=function(ie){return{bandwidth:ie.bandwidth,bytesReceived:ie.bytesReceived||0,roundTripTime:ie.roundTripTime||0}}(K),M.key?M.encryptedBytes=new Uint8Array(K.response):M.bytes=new Uint8Array(K.response),j&&M.map&&M.map.bytes&&(j.isInitialized()||j.init(),(ne=j.parse(M.bytes,M.map.videoTrackIds,M.map.timescales))&&ne.captions&&(M.captionStreams=ne.captionStreams,M.fmp4Captions=ne.captions)),G(null,M))}}(n,e,u));return k.addEventListener("progress",Kp(n,a)),o.push(k),function(){return Vc(o)}},Gc=function(t,i){var r;return t&&(r=L.getComputedStyle(t))?r[i]:""},Ai=function(t,i){var r=t.slice();t.sort(function(e,n){var a=i(e,n);return a===0?r.indexOf(e)-r.indexOf(n):a})},Ls=function(t,i){var r=void 0,e=void 0;return t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),r=r||L.Number.MAX_VALUE,i.attributes.BANDWIDTH&&(e=i.attributes.BANDWIDTH),r-(e=e||L.Number.MAX_VALUE)},Hc=function(t){return typeof t=="number"&&isFinite(t)},Os=function(t){function i(r){zt(this,i);var e=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));if(!r)throw new TypeError("Initialization settings are required");if(typeof r.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!r.mediaSource)throw new TypeError("No MediaSource specified");return e.bandwidth=r.bandwidth,e.throughput={rate:0,count:0},e.roundTrip=NaN,e.resetStats_(),e.mediaIndex=null,e.hasPlayed_=r.hasPlayed,e.currentTime_=r.currentTime,e.seekable_=r.seekable,e.seeking_=r.seeking,e.duration_=r.duration,e.mediaSource_=r.mediaSource,e.hls_=r.hls,e.loaderType_=r.loaderType,e.startingMedia_=void 0,e.segmentMetadataTrack_=r.segmentMetadataTrack,e.goalBufferLength_=r.goalBufferLength,e.sourceType_=r.sourceType,e.inbandTextTracks_=r.inbandTextTracks,e.state_="INIT",e.checkBufferTimeout_=null,e.error_=void 0,e.currentTimeline_=-1,e.pendingSegment_=null,e.mimeType_=null,e.sourceUpdater_=null,e.xhrOptions_=null,e.activeInitSegmentId_=null,e.initSegments_={},e.cacheEncryptionKeys_=r.cacheEncryptionKeys,e.keyCache_={},e.loaderType_==="main"?e.captionParser_=new fp:e.captionParser_=null,e.decrypter_=r.decrypter,e.syncController_=r.syncController,e.syncPoint_={segmentIndex:0,time:0},e.syncController_.on("syncinfoupdate",function(){return e.trigger("syncinfoupdate")}),e.mediaSource_.addEventListener("sourceopen",function(){return e.ended_=!1}),e.fetchAtBuffer_=!1,e.logger_=Pi("SegmentLoader["+e.loaderType_+"]"),Object.defineProperty(e,"state",{get:function(){return this.state_},set:function(n){n!==this.state_&&(this.logger_(this.state_+" -> "+n),this.state_=n)}}),e}return or(i,t),Qt(i,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset()}},{key:"abort",value:function(){this.state==="WAITING"?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(r){return r!==void 0&&(this.error_=r),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():J.createTimeRanges()}},{key:"initSegment",value:function(r){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!r)return null;var n=Tn(r),a=this.initSegments_[n];return e&&!a&&r.bytes&&(this.initSegments_[n]=a={resolvedUri:r.resolvedUri,byterange:r.byterange,bytes:r.bytes,timescales:r.timescales,videoTrackIds:r.videoTrackIds}),a||r}},{key:"segmentKey",value:function(r){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!r)return null;var n=vc(r),a=this.keyCache_[n];this.cacheEncryptionKeys_&&e&&!a&&r.bytes&&(this.keyCache_[n]=a={resolvedUri:r.resolvedUri,bytes:r.bytes});var s={resolvedUri:(a||r).resolvedUri};return a&&(s.bytes=a.bytes),s}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&this.state==="INIT")&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new qp(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r){var n=this.playlist_,a=this.pendingSegment_;this.playlist_=r,this.xhrOptions_=e,this.hasPlayed_()||(r.syncInfo={mediaSequence:r.mediaSequence,time:0});var s=null;if(n&&(n.id?s=n.id:n.uri&&(s=n.uri)),this.logger_("playlist update ["+s+" => "+(r.id||r.uri)+"]"),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===r.uri){var o=r.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+o+"]"),this.mediaIndex!==null&&(this.mediaIndex-=o),a&&(a.mediaIndex-=o,a.mediaIndex>=0&&(a.segment=r.segments[a.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,r)}else this.mediaIndex!==null&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(L.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return this.checkBufferTimeout_===null}},{key:"mimeType",value:function(r,e){this.mimeType_||(this.mimeType_=r,this.sourceBufferEmitter_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(r){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_(),r),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(r,e,n){if(this.sourceUpdater_&&this.sourceUpdater_.remove(r,e,n),Qr(r,e,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var a in this.inbandTextTracks_)Qr(r,e,this.inbandTextTracks_[a])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&L.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=L.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&L.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=L.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var r=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);r&&(this.isEndOfStream_(r.mediaIndex)?this.endOfStream():(r.mediaIndex!==this.playlist_.segments.length-1||this.mediaSource_.readyState!=="ended"||this.seeking_())&&(r.timeline!==this.currentTimeline_&&(this.syncController_.reset(),r.timestampOffset=r.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(r)))}}},{key:"isEndOfStream_",value:function(r){return function(e,n,a){if(!e||!n)return!1;var s=a===e.segments.length;return e.endList&&n.readyState==="open"&&s}(arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.playlist_,this.mediaSource_,r)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(r,e,n,a,s,o){var u=0,v=void 0;r.length&&(u=r.end(r.length-1));var C=Math.max(0,u-s);if(!e.segments.length||C>=this.goalBufferLength_()||!a&&C>=1)return null;if(o===null)return n=this.getSyncSegmentCandidate_(e),this.generateSegmentInfo_(e,n,null,!0);if(n!==null){var k=e.segments[n];return v=k&&k.end?k.end:u,this.generateSegmentInfo_(e,n+1,v,!1)}if(this.fetchAtBuffer_){var M=At.getMediaInfoForTime(e,u,o.segmentIndex,o.time);n=M.mediaIndex,v=M.startTime}else{var j=At.getMediaInfoForTime(e,s,o.segmentIndex,o.time);n=j.mediaIndex,v=j.startTime}return this.generateSegmentInfo_(e,n,v,!1)}},{key:"getSyncSegmentCandidate_",value:function(r){var e=this;if(this.currentTimeline_===-1)return 0;var n=r.segments.map(function(a,s){return{timeline:a.timeline,segmentIndex:s}}).filter(function(a){return a.timeline===e.currentTimeline_});return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(r.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(r,e,n,a){if(e<0||e>=r.segments.length)return null;var s=r.segments[e];return{requestId:"segment-loader-"+Math.random(),uri:s.resolvedUri,mediaIndex:e,isSyncRequest:a,startOfSegment:n,playlist:r,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:s.timeline,duration:s.duration,segment:s}}},{key:"abortRequestEarly_",value:function(r){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(r.firstBytesReceivedAt||Date.now())<1e3)return!1;var e=this.currentTime_(),n=r.bandwidth,a=this.pendingSegment_.duration,s=At.estimateSegmentRequestTime(a,n,this.playlist_,r.bytesReceived),o=function(k,M){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return((k.length?k.end(k.length-1):0)-M)/j}(this.buffered_(),e,this.hls_.tech_.playbackRate())-1;if(s<=o)return!1;var u=function(k){var M=k.master,j=k.currentTime,G=k.bandwidth,H=k.duration,K=k.segmentDuration,W=k.timeUntilRebuffer,Y=k.currentTimeline,ne=k.syncController,ie=M.playlists.filter(function(ce){return!At.isIncompatible(ce)}),le=ie.filter(At.isEnabled);le.length||(le=ie.filter(function(ce){return!At.isDisabled(ce)}));var ge=le.filter(At.hasAttribute.bind(null,"BANDWIDTH")).map(function(ce){var Ee=ne.getSyncPoint(ce,H,Y,j)?1:2;return{playlist:ce,rebufferingImpact:At.estimateSegmentRequestTime(K,G,ce)*Ee-W}}),Se=ge.filter(function(ce){return ce.rebufferingImpact<=0});return Ai(Se,function(ce,Ee){return Ls(Ee.playlist,ce.playlist)}),Se.length?Se[0]:(Ai(ge,function(ce,Ee){return ce.rebufferingImpact-Ee.rebufferingImpact}),ge[0]||null)}({master:this.hls_.playlists.master,currentTime:e,bandwidth:n,duration:this.duration_(),segmentDuration:a,timeUntilRebuffer:o,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(u){var v=s-o-u.rebufferingImpact,C=.5;return o<=1/30&&(C=1),!u.playlist||u.playlist.uri===this.playlist_.uri||v<C?!1:(this.bandwidth=u.playlist.attributes.BANDWIDTH*Ut.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(r,e){this.pendingSegment_&&e.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(e.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(r){this.state="WAITING",this.pendingSegment_=r,this.trimBackBuffer_(r),r.abortRequests=$p(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(r),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(r){var e=function(n,a,s){var o=void 0;return o=n.length&&n.start(0)>0&&n.start(0)<a?n.start(0):a-30,Math.min(o,a-s)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);e>0&&this.remove(0,e)}},{key:"createSimplifiedSegmentObj_",value:function(r){var e=r.segment,n={resolvedUri:e.resolvedUri,byterange:e.byterange,requestId:r.requestId};if(e.key){var a=e.key.iv||new Uint32Array([0,0,0,r.mediaIndex+r.playlist.mediaSequence]);n.key=this.segmentKey(e.key),n.key.iv=a}return e.map&&(n.map=this.initSegment(e.map)),n}},{key:"segmentRequestFinished_",value:function(r,e){if(this.mediaRequests+=1,e.stats&&(this.mediaBytesTransferred+=e.stats.bytesReceived,this.mediaTransferDuration+=e.stats.roundTripTime),this.pendingSegment_){if(e.requestId===this.pendingSegment_.requestId){if(r)return this.pendingSegment_=null,this.state="READY",r.code===Fc?void(this.mediaRequestsAborted+=1):(this.pause(),r.code===Nc?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(r),void this.trigger("error")));this.bandwidth=e.stats.bandwidth,this.roundTrip=e.stats.roundTripTime,e.map&&(e.map=this.initSegment(e.map,!0)),e.key&&this.segmentKey(e.key,!0),this.processSegmentResponse_(e)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(r){var e=this.pendingSegment_;e.bytes=r.bytes,r.map&&(e.segment.map.bytes=r.map.bytes),e.endOfAllRequests=r.endOfAllRequests,r.fmp4Captions&&(function(n,a,s){for(var o in s)if(!n[o]){a.trigger({type:"usage",name:"hls-608"});var u=a.textTracks().getTrackById(o);n[o]=u||a.addRemoteTextTrack({kind:"captions",id:o,label:o},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,r.captionStreams),function(n){var a=n.inbandTextTracks,s=n.captionArray,o=n.timestampOffset;if(s){var u=window.WebKitDataCue||window.VTTCue;s.forEach(function(v){var C=v.stream,k=v.startTime,M=v.endTime;a[C]&&(k+=o,M+=o,a[C].addCue(new u(k,M,v.text)))})}}({inbandTextTracks:this.inbandTextTracks_,captionArray:r.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var r=this;if(this.pendingSegment_){var e=this.pendingSegment_,n=e.segment,a=this.syncController_.probeSegmentInfo(e);this.startingMedia_===void 0&&a&&(a.containsAudio||a.containsVideo)&&(this.startingMedia_={containsAudio:a.containsAudio,containsVideo:a.containsVideo});var s,o,u,v=(s=this.loaderType_,o=this.startingMedia_,u=a,s==="main"&&o&&u?u.containsAudio||u.containsVideo?o.containsVideo&&!u.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!o.containsVideo&&u.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null);if(v)return this.error({message:v,blacklistDuration:1/0}),void this.trigger("error");if(e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");e.timestampOffset!==null&&e.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(e.timestampOffset),this.trigger("timestampoffset"));var C=this.syncController_.mappingForTimeline(e.timeline);if(C!==null&&this.trigger({type:"segmenttimemapping",mapping:C}),this.state="APPENDING",n.map){var k=Tn(n.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==k){var M=this.initSegment(n.map);this.sourceUpdater_.appendBuffer({bytes:M.bytes},function(){r.activeInitSegmentId_=k})}}e.byteLength=e.bytes.byteLength,typeof n.start=="number"&&typeof n.end=="number"?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration,this.logger_(function(j){var G=j.segment,H=G.start,K=G.end,W=j.playlist,Y=W.mediaSequence,ne=W.id,ie=W.segments,le=ie===void 0?[]:ie,ge=j.mediaIndex,Se=j.timeline;return["appending ["+ge+"] of ["+Y+", "+(Y+le.length)+"] from playlist ["+ne+"]","["+H+" => "+K+"] in timeline ["+Se+"]"].join(" ")}(e)),this.sourceUpdater_.appendBuffer({bytes:e.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,e.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(r,e){if(this.pendingSegment_&&r===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=e.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=e.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=e.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=e.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var r=this.pendingSegment_,e=r.segment,n=this.mediaIndex!==null;this.pendingSegment_=null,this.recordThroughput_(r),this.addSegmentMetadataCue_(r),this.state="READY",this.mediaIndex=r.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=r.timeline,this.trigger("syncinfoupdate"),e.end&&this.currentTime_()-e.end>3*r.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(r.mediaIndex+1,r.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(r){var e=this.throughput.rate,n=Date.now()-r.endOfAllRequests+1,a=Math.floor(r.byteLength/n*8*1e3);this.throughput.rate+=(a-e)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(r){if(this.segmentMetadataTrack_){var e=r.segment,n=e.start,a=e.end;if(Hc(n)&&Hc(a)){Qr(n,a,this.segmentMetadataTrack_);var s=L.WebKitDataCue||L.VTTCue,o={custom:e.custom,dateTimeObject:e.dateTimeObject,dateTimeString:e.dateTimeString,bandwidth:r.playlist.attributes.BANDWIDTH,resolution:r.playlist.attributes.RESOLUTION,codecs:r.playlist.attributes.CODECS,byteLength:r.byteLength,uri:r.uri,timeline:r.timeline,playlist:r.playlist.uri,start:n,end:a},u=new s(n,a,JSON.stringify(o));u.value=o,this.segmentMetadataTrack_.addCue(u)}}}}]),i}(J.EventTarget),zc=function(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))},qc=new Uint8Array(`

`.split("").map(function(t){return t.charCodeAt(0)})),Xp=function(t){function i(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};zt(this,i);var n=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,r,e));return n.mediaSource_=null,n.subtitlesTrack_=null,n}return or(i,Os),Qt(i,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return J.createTimeRanges();var r=this.subtitlesTrack_.cues,e=r[0].startTime,n=r[r.length-1].startTime;return J.createTimeRanges([[e,n]])}},{key:"initSegment",value:function(r){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!r)return null;var n=Tn(r),a=this.initSegments_[n];if(e&&!a&&r.bytes){var s=qc.byteLength+r.bytes.byteLength,o=new Uint8Array(s);o.set(r.bytes),o.set(qc,r.bytes.byteLength),this.initSegments_[n]=a={resolvedUri:r.resolvedUri,byterange:r.byterange,bytes:o}}return a||r}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(r){return r===void 0?this.subtitlesTrack_:(this.subtitlesTrack_=r,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}},{key:"remove",value:function(r,e){Qr(r,e,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var r=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(e=this.skipEmptySegments_(e)){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null)return this.syncController_.one("timestampoffset",function(){r.state="READY",r.paused()||r.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(e)}}},{key:"skipEmptySegments_",value:function(r){for(;r&&r.segment.empty;)r=this.generateSegmentInfo_(r.playlist,r.mediaIndex+1,r.startOfSegment+r.duration,r.isSyncRequest);return r}},{key:"handleSegment_",value:function(){var r=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var e=this.pendingSegment_,n=e.segment;if(typeof L.WebVTT!="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var a=void 0,s=function(){r.subtitlesTrack_.tech_.off("vttjsloaded",a),r.error({message:"Error loading vtt.js"}),r.state="READY",r.pause(),r.trigger("error")};return a=function(){r.subtitlesTrack_.tech_.off("vttjserror",s),r.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",a),void this.subtitlesTrack_.tech_.one("vttjserror",s)}n.requested=!0;try{this.parseVTTCues_(e)}catch(o){return this.error({message:o.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],this.playlist_),e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,e.cues.length&&this.remove(e.cues[0].endTime,e.cues[e.cues.length-1].endTime),e.cues.forEach(function(o){r.subtitlesTrack_.addCue(o)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(r){var e=void 0,n=!1;typeof L.TextDecoder=="function"?e=new L.TextDecoder("utf8"):(e=L.WebVTT.StringDecoder(),n=!0);var a=new L.WebVTT.Parser(L,L.vttjs,e);if(r.cues=[],r.timestampmap={MPEGTS:0,LOCAL:0},a.oncue=r.cues.push.bind(r.cues),a.ontimestampmap=function(u){return r.timestampmap=u},a.onparsingerror=function(u){J.log.warn("Error encountered when parsing cues: "+u.message)},r.segment.map){var s=r.segment.map.bytes;n&&(s=zc(s)),a.parse(s)}var o=r.bytes;n&&(o=zc(o)),a.parse(o),a.flush()}},{key:"updateTimeMapping_",value:function(r,e,n){var a=r.segment;if(e)if(r.cues.length){var s=r.timestampmap,o=s.MPEGTS/9e4-s.LOCAL+e.mapping;if(r.cues.forEach(function(C){C.startTime+=o,C.endTime+=o}),!n.syncInfo){var u=r.cues[0].startTime,v=r.cues[r.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+r.mediaIndex,time:Math.min(u,v-a.duration)}}}else a.empty=!0}}]),i}(),Yp=function(t,i){for(var r=t.cues,e=0;e<r.length;e++){var n=r[e];if(i>=n.adStartTime&&i<=n.adEndTime)return n}return null},Jp=yp,Wc=[{name:"VOD",run:function(t,i,r,e,n){return r!==1/0?{time:0,segmentIndex:0}:null}},{name:"ProgramDateTime",run:function(t,i,r,e,n){if(!t.datetimeToDisplayTime)return null;var a=i.segments||[],s=null,o=null;n=n||0;for(var u=0;u<a.length;u++){var v=a[u];if(v.dateTimeObject){var C=v.dateTimeObject.getTime()/1e3+t.datetimeToDisplayTime,k=Math.abs(n-C);if(o!==null&&(k===0||o<k))break;o=k,s={time:C,segmentIndex:u}}}return s}},{name:"Segment",run:function(t,i,r,e,n){var a=i.segments||[],s=null,o=null;n=n||0;for(var u=0;u<a.length;u++){var v=a[u];if(v.timeline===e&&v.start!==void 0){var C=Math.abs(n-v.start);if(o!==null&&o<C)break;(!s||o===null||o>=C)&&(o=C,s={time:v.start,segmentIndex:u})}}return s}},{name:"Discontinuity",run:function(t,i,r,e,n){var a=null;if(n=n||0,i.discontinuityStarts&&i.discontinuityStarts.length)for(var s=null,o=0;o<i.discontinuityStarts.length;o++){var u=i.discontinuityStarts[o],v=i.discontinuitySequence+o+1,C=t.discontinuities[v];if(C){var k=Math.abs(n-C.time);if(s!==null&&s<k)break;(!a||s===null||s>=k)&&(s=k,a={time:C.time,segmentIndex:u})}}return a}},{name:"Playlist",run:function(t,i,r,e,n){return i.syncInfo?{time:i.syncInfo.time,segmentIndex:i.syncInfo.mediaSequence-i.mediaSequence}:null}}],Qp=function(t){function i(){zt(this,i);var r=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return r.inspectCache_=void 0,r.timelines=[],r.discontinuities=[],r.datetimeToDisplayTime=null,r.logger_=Pi("SyncController"),r}return or(i,t),Qt(i,[{key:"getSyncPoint",value:function(r,e,n,a){var s=this.runStrategies_(r,e,n,a);return s.length?this.selectSyncPoint_(s,{key:"time",value:a}):null}},{key:"getExpiredTime",value:function(r,e){if(!r||!r.segments)return null;var n=this.runStrategies_(r,e,r.discontinuitySequence,0);if(!n.length)return null;var a=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return a.segmentIndex>0&&(a.time*=-1),Math.abs(a.time+Ei(r,a.segmentIndex,0))}},{key:"runStrategies_",value:function(r,e,n,a){for(var s=[],o=0;o<Wc.length;o++){var u=Wc[o],v=u.run(this,r,e,n,a);v&&(v.strategy=u.name,s.push({strategy:u.name,syncPoint:v}))}return s}},{key:"selectSyncPoint_",value:function(r,e){for(var n=r[0].syncPoint,a=Math.abs(r[0].syncPoint[e.key]-e.value),s=r[0].strategy,o=1;o<r.length;o++){var u=Math.abs(r[o].syncPoint[e.key]-e.value);u<a&&(a=u,n=r[o].syncPoint,s=r[o].strategy)}return this.logger_("syncPoint for ["+e.key+": "+e.value+"] chosen with strategy ["+s+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(r,e){for(var n=e.mediaSequence-r.mediaSequence-1;n>=0;n--){var a=r.segments[n];if(a&&a.start!==void 0){e.syncInfo={mediaSequence:r.mediaSequence+n,time:a.start},this.logger_("playlist refresh sync: [time:"+e.syncInfo.time+", mediaSequence: "+e.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(r){if(!this.datetimeToDisplayTime&&r.segments&&r.segments.length&&r.segments[0].dateTimeObject){var e=r.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-e}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(r){var e=r.segment,n=r.playlist,a=void 0;return(a=e.map?this.probeMp4Segment_(r):this.probeTsSegment_(r))&&this.calculateSegmentTimeMapping_(r,a)&&(this.saveDiscontinuitySyncInfo_(r),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+r.mediaIndex,time:e.start})),a}},{key:"probeMp4Segment_",value:function(r){var e=r.segment,n=Yt.timescale(e.map.bytes),a=Yt.startTime(n,r.bytes);return r.timestampOffset!==null&&(r.timestampOffset-=a),{start:a,end:a+e.duration}}},{key:"probeTsSegment_",value:function(r){var e=Jp(r.bytes,this.inspectCache_),n=void 0,a=void 0;return e?(e.video&&e.video.length===2?(this.inspectCache_=e.video[1].dts,n=e.video[0].dtsTime,a=e.video[1].dtsTime):e.audio&&e.audio.length===2&&(this.inspectCache_=e.audio[1].dts,n=e.audio[0].dtsTime,a=e.audio[1].dtsTime),{start:n,end:a,containsVideo:e.video&&e.video.length===2,containsAudio:e.audio&&e.audio.length===2}):null}},{key:"timestampOffsetForTimeline",value:function(r){return this.timelines[r]===void 0?null:this.timelines[r].time}},{key:"mappingForTimeline",value:function(r){return this.timelines[r]===void 0?null:this.timelines[r].mapping}},{key:"calculateSegmentTimeMapping_",value:function(r,e){var n=r.segment,a=this.timelines[r.timeline];if(r.timestampOffset!==null)a={time:r.startOfSegment,mapping:r.startOfSegment-e.start},this.timelines[r.timeline]=a,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+r.timeline+": [time: "+a.time+"] [mapping: "+a.mapping+"]"),n.start=r.startOfSegment,n.end=e.end+a.mapping;else{if(!a)return!1;n.start=e.start+a.mapping,n.end=e.end+a.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(r){var e=r.playlist,n=r.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(e.discontinuityStarts&&e.discontinuityStarts.length)for(var a=0;a<e.discontinuityStarts.length;a++){var s=e.discontinuityStarts[a],o=e.discontinuitySequence+a+1,u=s-r.mediaIndex,v=Math.abs(u);if(!this.discontinuities[o]||this.discontinuities[o].accuracy>v){var C=void 0;C=u<0?n.start-Ei(e,r.mediaIndex,s):n.end+Ei(e,r.mediaIndex+1,s),this.discontinuities[o]={time:C,accuracy:v}}}}}]),i}(J.EventTarget),Zp=new Ec("./decrypter-worker.worker.js",function(t,i){var r=this;(function(){var e=function(j,G){if(!(j instanceof G))throw new TypeError("Cannot call a class as a function")},n=function(){function j(G,H){for(var K=0;K<H.length;K++){var W=H[K];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(G,W.key,W)}}return function(G,H,K){return H&&j(G.prototype,H),K&&j(G,K),G}}(),a=function(j,G){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!G||typeof G!="object"&&typeof G!="function"?j:G},s=function(){var j=[[[],[],[],[],[]],[[],[],[],[],[]]],G=j[0],H=j[1],K=G[4],W=H[4],Y=void 0,ne=void 0,ie=void 0,le=[],ge=[],Se=void 0,ce=void 0,Ee=void 0,lt=void 0,Lt=void 0;for(Y=0;Y<256;Y++)ge[(le[Y]=Y<<1^283*(Y>>7))^Y]=Y;for(ne=ie=0;!K[ne];ne^=Se||1,ie=ge[ie]||1)for(Ee=(Ee=ie^ie<<1^ie<<2^ie<<3^ie<<4)>>8^255&Ee^99,K[ne]=Ee,W[Ee]=ne,Lt=16843009*le[ce=le[Se=le[ne]]]^65537*ce^257*Se^16843008*ne,lt=257*le[Ee]^16843008*Ee,Y=0;Y<4;Y++)G[Y][ne]=lt=lt<<24^lt>>>8,H[Y][Ee]=Lt=Lt<<24^Lt>>>8;for(Y=0;Y<5;Y++)G[Y]=G[Y].slice(0),H[Y]=H[Y].slice(0);return j},o=null,u=function(){function j(G){e(this,j),o||(o=s()),this._tables=[[o[0][0].slice(),o[0][1].slice(),o[0][2].slice(),o[0][3].slice(),o[0][4].slice()],[o[1][0].slice(),o[1][1].slice(),o[1][2].slice(),o[1][3].slice(),o[1][4].slice()]];var H=void 0,K=void 0,W=void 0,Y=void 0,ne=void 0,ie=this._tables[0][4],le=this._tables[1],ge=G.length,Se=1;if(ge!==4&&ge!==6&&ge!==8)throw new Error("Invalid aes key size");for(Y=G.slice(0),ne=[],this._key=[Y,ne],H=ge;H<4*ge+28;H++)W=Y[H-1],(H%ge==0||ge===8&&H%ge==4)&&(W=ie[W>>>24]<<24^ie[W>>16&255]<<16^ie[W>>8&255]<<8^ie[255&W],H%ge==0&&(W=W<<8^W>>>24^Se<<24,Se=Se<<1^283*(Se>>7))),Y[H]=Y[H-ge]^W;for(K=0;H;K++,H--)W=Y[3&K?H:H-4],ne[K]=H<=4||K<4?W:le[0][ie[W>>>24]]^le[1][ie[W>>16&255]]^le[2][ie[W>>8&255]]^le[3][ie[255&W]]}return j.prototype.decrypt=function(G,H,K,W,Y,ne){var ie=this._key[1],le=G^ie[0],ge=W^ie[1],Se=K^ie[2],ce=H^ie[3],Ee=void 0,lt=void 0,Lt=void 0,pr=ie.length/4-2,Ot=void 0,jt=4,qt=this._tables[1],Zt=qt[0],er=qt[1],et=qt[2],xr=qt[3],Dr=qt[4];for(Ot=0;Ot<pr;Ot++)Ee=Zt[le>>>24]^er[ge>>16&255]^et[Se>>8&255]^xr[255&ce]^ie[jt],lt=Zt[ge>>>24]^er[Se>>16&255]^et[ce>>8&255]^xr[255&le]^ie[jt+1],Lt=Zt[Se>>>24]^er[ce>>16&255]^et[le>>8&255]^xr[255&ge]^ie[jt+2],ce=Zt[ce>>>24]^er[le>>16&255]^et[ge>>8&255]^xr[255&Se]^ie[jt+3],jt+=4,le=Ee,ge=lt,Se=Lt;for(Ot=0;Ot<4;Ot++)Y[(3&-Ot)+ne]=Dr[le>>>24]<<24^Dr[ge>>16&255]<<16^Dr[Se>>8&255]<<8^Dr[255&ce]^ie[jt++],Ee=le,le=ge,ge=Se,Se=ce,ce=Ee},j}(),v=function(){function j(){e(this,j),this.listeners={}}return j.prototype.on=function(G,H){this.listeners[G]||(this.listeners[G]=[]),this.listeners[G].push(H)},j.prototype.off=function(G,H){if(!this.listeners[G])return!1;var K=this.listeners[G].indexOf(H);return this.listeners[G].splice(K,1),K>-1},j.prototype.trigger=function(G){var H=this.listeners[G];if(H)if(arguments.length===2)for(var K=H.length,W=0;W<K;++W)H[W].call(this,arguments[1]);else for(var Y=Array.prototype.slice.call(arguments,1),ne=H.length,ie=0;ie<ne;++ie)H[ie].apply(this,Y)},j.prototype.dispose=function(){this.listeners={}},j.prototype.pipe=function(G){this.on("data",function(H){G.push(H)})},j}(),C=function(j){function G(){e(this,G);var H=a(this,j.call(this,v));return H.jobs=[],H.delay=1,H.timeout_=null,H}return function(H,K){if(typeof K!="function"&&K!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof K);H.prototype=Object.create(K&&K.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),K&&(Object.setPrototypeOf?Object.setPrototypeOf(H,K):H.__proto__=K)}(G,j),G.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},G.prototype.push=function(H){this.jobs.push(H),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},G}(v),k=function(j){return j<<24|(65280&j)<<8|(16711680&j)>>8|j>>>24},M=function(){function j(G,H,K,W){e(this,j);var Y=j.STEP,ne=new Int32Array(G.buffer),ie=new Uint8Array(G.byteLength),le=0;for(this.asyncStream_=new C,this.asyncStream_.push(this.decryptChunk_(ne.subarray(le,le+Y),H,K,ie)),le=Y;le<ne.length;le+=Y)K=new Uint32Array([k(ne[le-4]),k(ne[le-3]),k(ne[le-2]),k(ne[le-1])]),this.asyncStream_.push(this.decryptChunk_(ne.subarray(le,le+Y),H,K,ie));this.asyncStream_.push(function(){var ge;W(null,(ge=ie).subarray(0,ge.byteLength-ge[ge.byteLength-1]))})}return j.prototype.decryptChunk_=function(G,H,K,W){return function(){var Y=function(ne,ie,le){var ge=new Int32Array(ne.buffer,ne.byteOffset,ne.byteLength>>2),Se=new u(Array.prototype.slice.call(ie)),ce=new Uint8Array(ne.byteLength),Ee=new Int32Array(ce.buffer),lt=void 0,Lt=void 0,pr=void 0,Ot=void 0,jt=void 0,qt=void 0,Zt=void 0,er=void 0,et=void 0;for(lt=le[0],Lt=le[1],pr=le[2],Ot=le[3],et=0;et<ge.length;et+=4)jt=k(ge[et]),qt=k(ge[et+1]),Zt=k(ge[et+2]),er=k(ge[et+3]),Se.decrypt(jt,qt,Zt,er,Ee,et),Ee[et]=k(Ee[et]^lt),Ee[et+1]=k(Ee[et+1]^Lt),Ee[et+2]=k(Ee[et+2]^pr),Ee[et+3]=k(Ee[et+3]^Ot),lt=jt,Lt=qt,pr=Zt,Ot=er;return ce}(G,H,K);W.set(Y,G.byteOffset)}},n(j,null,[{key:"STEP",get:function(){return 32e3}}]),j}();new function(j){j.onmessage=function(G){var H=G.data,K=new Uint8Array(H.encrypted.bytes,H.encrypted.byteOffset,H.encrypted.byteLength),W=new Uint32Array(H.key.bytes,H.key.byteOffset,H.key.byteLength/4),Y=new Uint32Array(H.iv.bytes,H.iv.byteOffset,H.iv.byteLength/4);new M(K,W,Y,function(ne,ie){var le,ge;j.postMessage((le={source:H.source,decrypted:ie},ge={},Object.keys(le).forEach(function(Se){var ce=le[Se];ArrayBuffer.isView(ce)?ge[Se]={bytes:ce.buffer,byteOffset:ce.byteOffset,byteLength:ce.byteLength}:ge[Se]=ce}),ge),[ie.buffer])})}}(r)})()}),em=function(t){var i=t.default?"main":"alternative";return t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0&&(i="main-desc"),i},kn=function(t,i){t.abort(),t.pause(),i&&i.activePlaylistLoader&&(i.activePlaylistLoader.pause(),i.activePlaylistLoader=null)},Is=function(t,i){i.activePlaylistLoader=t,t.load()},En={AUDIO:function(t,i){return function(){var r=i.segmentLoaders[t],e=i.mediaTypes[t],n=i.blacklistCurrentPlaylist;kn(r,e);var a=e.activeTrack(),s=e.activeGroup(),o=(s.filter(function(C){return C.default})[0]||s[0]).id,u=e.tracks[o];if(a!==u){for(var v in J.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),e.tracks)e.tracks[v].enabled=e.tracks[v]===u;e.onTrackChanged()}else n({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(t,i){return function(){var r=i.segmentLoaders[t],e=i.mediaTypes[t];J.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),kn(r,e);var n=e.activeTrack();n&&(n.mode="disabled"),e.onTrackChanged()}}},Kc={AUDIO:function(t,i,r){if(i){var e=r.tech,n=r.requestOptions,a=r.segmentLoaders[t];i.on("loadedmetadata",function(){var s=i.media();a.playlist(s,n),(!e.paused()||s.endList&&e.preload()!=="none")&&a.load()}),i.on("loadedplaylist",function(){a.playlist(i.media(),n),e.paused()||a.load()}),i.on("error",En[t](t,r))}},SUBTITLES:function(t,i,r){var e=r.tech,n=r.requestOptions,a=r.segmentLoaders[t],s=r.mediaTypes[t];i.on("loadedmetadata",function(){var o=i.media();a.playlist(o,n),a.track(s.activeTrack()),(!e.paused()||o.endList&&e.preload()!=="none")&&a.load()}),i.on("loadedplaylist",function(){a.playlist(i.media(),n),e.paused()||a.load()}),i.on("error",En[t](t,r))}},tm={AUDIO:function(t,i){var r=i.hls,e=i.sourceType,n=i.segmentLoaders[t],a=i.requestOptions,s=i.master.mediaGroups,o=i.mediaTypes[t],u=o.groups,v=o.tracks,C=i.masterPlaylistLoader;for(var k in s[t]&&Object.keys(s[t]).length!==0||(s[t]={main:{default:{default:!0}}}),s[t])for(var M in u[k]||(u[k]=[]),s[t][k]){var j=s[t][k][M],G=void 0;if(G=j.resolvedUri?new _n(j.resolvedUri,r,a):j.playlists&&e==="dash"?new As(j.playlists[0],r,a,C):null,j=J.mergeOptions({id:M,playlistLoader:G},j),Kc[t](t,j.playlistLoader,i),u[k].push(j),v[M]===void 0){var H=new J.AudioTrack({id:M,kind:em(j),enabled:!1,language:j.language,default:j.default,label:M});v[M]=H}}n.on("error",En[t](t,i))},SUBTITLES:function(t,i){var r=i.tech,e=i.hls,n=i.sourceType,a=i.segmentLoaders[t],s=i.requestOptions,o=i.master.mediaGroups,u=i.mediaTypes[t],v=u.groups,C=u.tracks,k=i.masterPlaylistLoader;for(var M in o[t])for(var j in v[M]||(v[M]=[]),o[t][M])if(!o[t][M][j].forced){var G=o[t][M][j],H=void 0;if(n==="hls"?H=new _n(G.resolvedUri,e,s):n==="dash"&&(H=new As(G.playlists[0],e,s,k)),G=J.mergeOptions({id:j,playlistLoader:H},G),Kc[t](t,G.playlistLoader,i),v[M].push(G),C[j]===void 0){var K=r.addRemoteTextTrack({id:j,kind:"subtitles",default:G.default&&G.autoselect,language:G.language,label:j},!1).track;C[j]=K}}a.on("error",En[t](t,i))},"CLOSED-CAPTIONS":function(t,i){var r=i.tech,e=i.master.mediaGroups,n=i.mediaTypes[t],a=n.groups,s=n.tracks;for(var o in e[t])for(var u in a[o]||(a[o]=[]),e[t][o]){var v=e[t][o][u];if(v.instreamId.match(/CC\d/)&&(a[o].push(J.mergeOptions({id:u},v)),s[u]===void 0)){var C=r.addRemoteTextTrack({id:v.instreamId,kind:"captions",default:v.default&&v.autoselect,language:v.language,label:u},!1).track;s[u]=C}}}},rm={AUDIO:function(t,i){return function(){var r=i.mediaTypes[t].tracks;for(var e in r)if(r[e].enabled)return r[e];return null}},SUBTITLES:function(t,i){return function(){var r=i.mediaTypes[t].tracks;for(var e in r)if(r[e].mode==="showing")return r[e];return null}}},im=function(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(v){tm[v](v,t)});var i=t.mediaTypes,r=t.masterPlaylistLoader,e=t.tech,n=t.hls;["AUDIO","SUBTITLES"].forEach(function(v){i[v].activeGroup=function(C,k){return function(M){var j=k.masterPlaylistLoader,G=k.mediaTypes[C].groups,H=j.media();if(!H)return null;var K=null;return H.attributes[C]&&(K=G[H.attributes[C]]),K=K||G.main,M===void 0?K:M===null?null:K.filter(function(W){return W.id===M.id})[0]||null}}(v,t),i[v].activeTrack=rm[v](v,t),i[v].onGroupChanged=function(C,k){return function(){var M=k.segmentLoaders,j=M[C],G=M.main,H=k.mediaTypes[C],K=H.activeTrack(),W=H.activeGroup(K),Y=H.activePlaylistLoader;kn(j,H),W&&(W.playlistLoader?(j.resyncLoader(),Is(W.playlistLoader,H)):Y&&G.resetEverything())}}(v,t),i[v].onTrackChanged=function(C,k){return function(){var M=k.segmentLoaders,j=M[C],G=M.main,H=k.mediaTypes[C],K=H.activeTrack(),W=H.activeGroup(K),Y=H.activePlaylistLoader;kn(j,H),W&&(W.playlistLoader?(Y!==W.playlistLoader&&(j.track&&j.track(K),j.resetEverything()),Is(W.playlistLoader,H)):G.resetEverything())}}(v,t)});var a=i.AUDIO.activeGroup(),s=(a.filter(function(v){return v.default})[0]||a[0]).id;i.AUDIO.tracks[s].enabled=!0,i.AUDIO.onTrackChanged(),r.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(v){return i[v].onGroupChanged()})});var o=function(){i.AUDIO.onTrackChanged(),e.trigger({type:"usage",name:"hls-audio-change"})};for(var u in e.audioTracks().addEventListener("change",o),e.remoteTextTracks().addEventListener("change",i.SUBTITLES.onTrackChanged),n.on("dispose",function(){e.audioTracks().removeEventListener("change",o),e.remoteTextTracks().removeEventListener("change",i.SUBTITLES.onTrackChanged)}),e.clearTracks("audio"),i.AUDIO.tracks)e.audioTracks().addTrack(i.AUDIO.tracks[u])},nm=function(){var t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(i){t[i]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ti,activeTrack:ti,onGroupChanged:ti,onTrackChanged:ti}}),t},fr=void 0,am=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],sm=function(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]},om=function(t){function i(r){zt(this,i);var e=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),n=r.url,a=r.handleManifestRedirects,s=r.withCredentials,o=r.tech,u=r.bandwidth,v=r.externHls,C=r.useCueTags,k=r.blacklistDuration,M=r.enableLowInitialPlaylist,j=r.sourceType,G=r.seekTo,H=r.cacheEncryptionKeys;if(!n)throw new Error("A non-empty playlist URL is required");fr=v,e.withCredentials=s,e.tech_=o,e.hls_=o.hls,e.seekTo_=G,e.sourceType_=j,e.useCueTags_=C,e.blacklistDuration=k,e.enableLowInitialPlaylist=M,e.useCueTags_&&(e.cueTagsTrack_=e.tech_.addTextTrack("metadata","ad-cues"),e.cueTagsTrack_.inBandMetadataTrackDispatchType=""),e.requestOptions_={withCredentials:s,handleManifestRedirects:a,timeout:null},e.mediaTypes_=nm(),e.mediaSource=new J.MediaSource,e.mediaSource.addEventListener("sourceopen",e.handleSourceOpen_.bind(e)),e.seekable_=J.createTimeRanges(),e.hasPlayed_=function(){return!1},e.syncController_=new Qp(r),e.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,e.decrypter_=new Zp,e.inbandTextTracks_={};var K={hls:e.hls_,mediaSource:e.mediaSource,currentTime:e.tech_.currentTime.bind(e.tech_),seekable:function(){return e.seekable()},seeking:function(){return e.tech_.seeking()},duration:function(){return e.mediaSource.duration},hasPlayed:function(){return e.hasPlayed_()},goalBufferLength:function(){return e.goalBufferLength()},bandwidth:u,syncController:e.syncController_,decrypter:e.decrypter_,sourceType:e.sourceType_,inbandTextTracks:e.inbandTextTracks_,cacheEncryptionKeys:H};return e.masterPlaylistLoader_=e.sourceType_==="dash"?new As(n,e.hls_,e.requestOptions_):new _n(n,e.hls_,e.requestOptions_),e.setupMasterPlaylistLoaderListeners_(),e.mainSegmentLoader_=new Os(J.mergeOptions(K,{segmentMetadataTrack:e.segmentMetadataTrack_,loaderType:"main"}),r),e.audioSegmentLoader_=new Os(J.mergeOptions(K,{loaderType:"audio"}),r),e.subtitleSegmentLoader_=new Xp(J.mergeOptions(K,{loaderType:"vtt"}),r),e.setupSegmentLoaderListeners_(),am.forEach(function(W){e[W+"_"]=sm.bind(e,W)}),e.logger_=Pi("MPC"),e.masterPlaylistLoader_.load(),e}return or(i,t),Qt(i,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var r=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=r.masterPlaylistLoader_.media(),n=1.5*e.targetDuration*1e3;_s(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.media())?r.requestOptions_.timeout=0:r.requestOptions_.timeout=n,e.endList&&r.tech_.preload()!=="none"&&(r.mainSegmentLoader_.playlist(e,r.requestOptions_),r.mainSegmentLoader_.load()),im({sourceType:r.sourceType_,segmentLoaders:{AUDIO:r.audioSegmentLoader_,SUBTITLES:r.subtitleSegmentLoader_,main:r.mainSegmentLoader_},tech:r.tech_,requestOptions:r.requestOptions_,masterPlaylistLoader:r.masterPlaylistLoader_,hls:r.hls_,master:r.master(),mediaTypes:r.mediaTypes_,blacklistCurrentPlaylist:r.blacklistCurrentPlaylist.bind(r)}),r.triggerPresenceUsage_(r.master(),e);try{r.setupSourceBuffers_()}catch(a){return J.log.warn("Failed to create SourceBuffers",a),r.mediaSource.endOfStream("decode")}r.setupFirstPlay(),!r.mediaTypes_.AUDIO.activePlaylistLoader||r.mediaTypes_.AUDIO.activePlaylistLoader.media()?r.trigger("selectedinitialmedia"):r.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){r.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=r.masterPlaylistLoader_.media();if(!e){r.excludeUnsupportedVariants_();var n=void 0;return r.enableLowInitialPlaylist&&(n=r.selectInitialPlaylist()),n||(n=r.selectPlaylist()),r.initialMedia_=n,void r.masterPlaylistLoader_.media(r.initialMedia_)}if(r.useCueTags_&&r.updateAdCues_(e),r.mainSegmentLoader_.playlist(e,r.requestOptions_),r.updateDuration(),r.tech_.paused()||(r.mainSegmentLoader_.load(),r.audioSegmentLoader_&&r.audioSegmentLoader_.load()),!e.endList){var a=function(){var s=r.seekable();s.length!==0&&r.mediaSource.addSeekableRange_(s.start(0),s.end(0))};r.duration()!==1/0?r.tech_.one("durationchange",function s(){r.duration()===1/0?a():r.tech_.one("durationchange",s)}):a()}}),this.masterPlaylistLoader_.on("error",function(){r.blacklistCurrentPlaylist(r.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){r.mainSegmentLoader_.abort(),r.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var e=r.masterPlaylistLoader_.media(),n=1.5*e.targetDuration*1e3;_s(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.media())?r.requestOptions_.timeout=0:r.requestOptions_.timeout=n,r.mainSegmentLoader_.playlist(e,r.requestOptions_),r.mainSegmentLoader_.load(),r.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=r.masterPlaylistLoader_.media();r.stuckAtPlaylistEnd_(e)&&(r.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),r.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){r.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){r.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(r,e){var n=r.mediaGroups||{},a=!0,s=Object.keys(n.AUDIO);for(var o in n.AUDIO)for(var u in n.AUDIO[o])n.AUDIO[o][u].uri||(a=!1);a&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),fr.Playlist.isAes(e)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),fr.Playlist.isFmp4(e)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),s.length&&Object.keys(n.AUDIO[s[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var r=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=r.selectPlaylist(),n=r.masterPlaylistLoader_.media(),a=r.tech_.buffered(),s=a.length?a.end(a.length-1)-r.tech_.currentTime():0,o=r.bufferLowWaterLine();(!n.endList||r.duration()<Ut.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<n.attributes.BANDWIDTH||s>=o)&&r.masterPlaylistLoader_.media(e),r.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){r.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){r.blacklistCurrentPlaylist(r.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){r.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){r.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){r.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){r.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){r.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){r.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(e){r.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})}),this.audioSegmentLoader_.on("ended",function(){r.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var r=this.selectPlaylist();r!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(r),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var r=this,e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetEverything(function(){J.browser.IE_VERSION||J.browser.IS_EDGE?r.tech_.setCurrentTime(r.tech_.currentTime()+.04):r.tech_.setCurrentTime(r.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.seekTo_(0),this.hasPlayed_()&&this.load();var r=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<r.start(0)?this.seekTo_(r.end(r.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var r=this,e=this.masterPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_())return!1;if(!e.endList){var n=this.seekable();if(!n.length)return!1;if(J.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",function(){r.trigger("firstplay"),r.seekTo_(n.end(0)),r.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.seekTo_(n.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return J.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var r=this.tech_.play();r!==void 0&&typeof r.then=="function"&&r.then(null,function(e){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var r=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(r=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?r&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),r){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){J.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(r){if(!this.seekable().length)return!1;var e=this.syncController_.getExpiredTime(r,this.mediaSource.duration);if(e===null)return!1;var n=fr.Playlist.playlistEnd(r,e),a=this.tech_.currentTime(),s=this.tech_.buffered();if(!s.length)return n-a<=.1;var o=s.end(s.length-1);return o-a<=.1&&n-o<=.1}},{key:"blacklistCurrentPlaylist",value:function(){var r,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments[1],a=void 0;if(a=e.playlist||this.masterPlaylistLoader_.media(),n=n||e.blacklistDuration||this.blacklistDuration,!a){this.error=e;try{return this.mediaSource.endOfStream("network")}catch{return this.trigger("error")}}var s=this.masterPlaylistLoader_.master.playlists.filter(bn).length===1,o=this.masterPlaylistLoader_.master.playlists;return o.length===1?(J.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(s)):(s&&(J.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),o.forEach(function(u){u.excludeUntil!==1/0&&delete u.excludeUntil}),this.tech_.trigger("retryplaylist")),a.excludeUntil=Date.now()+1e3*n,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),r=this.selectPlaylist(),J.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(r,s))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(r){var e=bc(this.tech_.buffered(),r);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?e&&e.length?r:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:fr.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var r=void 0,e=void 0;if(this.masterPlaylistLoader_){var n=this.masterPlaylistLoader_.media();if(n){var a=this.syncController_.getExpiredTime(n,this.mediaSource.duration);if(a!==null&&(r=fr.Playlist.seekable(n,a)).length!==0){if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(n=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),(a=this.syncController_.getExpiredTime(n,this.mediaSource.duration))===null||(e=fr.Playlist.seekable(n,a)).length===0))return;var s=void 0,o=void 0;this.seekable_&&this.seekable_.length&&(s=this.seekable_.end(0),o=this.seekable_.start(0)),e?e.start(0)>r.end(0)||r.start(0)>e.end(0)?this.seekable_=r:this.seekable_=J.createTimeRanges([[e.start(0)>r.start(0)?e.start(0):r.start(0),e.end(0)<r.end(0)?e.end(0):r.end(0)]]):this.seekable_=r,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===s&&this.seekable_.start(0)===o||(this.logger_("seekable updated ["+Ts(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},{key:"updateDuration",value:function(){var r=this,e=this.mediaSource.duration,n=fr.Playlist.duration(this.masterPlaylistLoader_.media()),a=this.tech_.buffered(),s=function o(){r.logger_("Setting duration from "+r.mediaSource.duration+" => "+n);try{r.mediaSource.duration=n}catch(u){J.log.warn("Failed to set media source duration",u)}r.tech_.trigger("durationchange"),r.mediaSource.removeEventListener("sourceopen",o)};a.length>0&&(n=Math.max(n,a.end(a.length-1))),e!==n&&(this.mediaSource.readyState!=="open"?this.mediaSource.addEventListener("sourceopen",s):s())}},{key:"dispose",value:function(){var r=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(e){var n=r.mediaTypes_[e].groups;for(var a in n)n[a].forEach(function(s){s.playlistLoader&&s.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var r,e=this.masterPlaylistLoader_.media();if(e&&this.mediaSource.readyState==="open"){if((r=Vp(this.masterPlaylistLoader_.master,e)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(r),this.excludeIncompatibleVariants_(e)}}},{key:"configureLoaderMimeTypes_",value:function(r){var e=r.length>1&&r[0].indexOf(",")===-1&&r[0]!==r[1]?new J.EventTarget:null;this.mainSegmentLoader_.mimeType(r[0],e),r[1]&&this.audioSegmentLoader_.mimeType(r[1],e)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(r){var e;r.attributes.CODECS&&L.MediaSource&&L.MediaSource.isTypeSupported&&!L.MediaSource.isTypeSupported('video/mp4; codecs="'+(e=r.attributes.CODECS,e.replace(/avc1\.(\d+)\.(\d+)/i,function(n){return Rc([n])[0]}))+'"')&&(r.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(r){var e=2,n=null,a=void 0;r.attributes.CODECS&&(a=Ci(r.attributes.CODECS),n=a.videoCodec,e=a.codecCount),this.master().playlists.forEach(function(s){var o={codecCount:2,videoCodec:null};s.attributes.CODECS&&(o=Ci(s.attributes.CODECS)),o.codecCount!==e&&(s.excludeUntil=1/0),o.videoCodec!==n&&(s.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(r){var e=0,n=this.seekable();n.length&&(e=n.start(0)),function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(a.segments)for(var u=o,v=void 0,C=0;C<a.segments.length;C++){var k=a.segments[C];if(v||(v=Yp(s,u+k.duration/2)),v){if("cueIn"in k){v.endTime=u,v.adEndTime=u,u+=k.duration,v=null;continue}if(u<v.endTime){u+=k.duration;continue}v.endTime+=k.duration}else if("cueOut"in k&&((v=new L.VTTCue(u,u+k.duration,k.cueOut)).adStartTime=u,v.adEndTime=u+parseFloat(k.cueOut),s.addCue(v)),"cueOutCont"in k){var M,j,G=k.cueOutCont.split("/").map(parseFloat),H=Ep(G,2);M=H[0],j=H[1],(v=new L.VTTCue(u,u+k.duration,"")).adStartTime=u-M,v.adEndTime=v.adStartTime+j,s.addCue(v)}u+=k.duration}}(r,this.cueTagsTrack_,e)}},{key:"goalBufferLength",value:function(){var r=this.tech_.currentTime(),e=Ut.GOAL_BUFFER_LENGTH,n=Ut.GOAL_BUFFER_LENGTH_RATE,a=Math.max(e,Ut.MAX_GOAL_BUFFER_LENGTH);return Math.min(e+r*n,a)}},{key:"bufferLowWaterLine",value:function(){var r=this.tech_.currentTime(),e=Ut.BUFFER_LOW_WATER_LINE,n=Ut.BUFFER_LOW_WATER_LINE_RATE,a=Math.max(e,Ut.MAX_BUFFER_LOW_WATER_LINE);return Math.min(e+r*n,a)}}]),i}(J.EventTarget),um=function t(i,r,e){zt(this,t);var n,a,s,o=i.masterPlaylistController_,u=o[(i.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(o);if(r.attributes.RESOLUTION){var v=r.attributes.RESOLUTION;this.width=v.width,this.height=v.height}this.bandwidth=r.attributes.BANDWIDTH,this.id=e,this.enabled=(n=i.playlists,a=r.uri,s=u,function(C){var k=n.master.playlists[a],M=ys(k),j=bn(k);return C===void 0?j:(C?delete k.disabled:k.disabled=!0,C===j||M||(s(),C?n.trigger("renditionenabled"):n.trigger("renditiondisabled")),C)})},$c=["seeking","seeked","pause","playing","error"],lm=function(){function t(i){var r=this;zt(this,t),this.tech_=i.tech,this.seekable=i.seekable,this.seekTo=i.seekTo,this.allowSeeksWithinUnsafeLiveWindow=i.allowSeeksWithinUnsafeLiveWindow,this.media=i.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Pi("PlaybackWatcher"),this.logger_("initialize");var e=function(){return r.monitorCurrentTime_()},n=function(){return r.techWaiting_()},a=function(){return r.cancelTimer_()},s=function(){return r.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",n),this.tech_.on($c,a),this.tech_.on("canplay",e),this.dispose=function(){r.logger_("dispose"),r.tech_.off("seekablechanged",s),r.tech_.off("waiting",n),r.tech_.off($c,a),r.tech_.off("canplay",e),r.checkCurrentTimeTimeout_&&L.clearTimeout(r.checkCurrentTimeTimeout_),r.cancelTimer_()}}return Qt(t,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&L.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=L.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var i=this.tech_.currentTime(),r=this.tech_.buffered();if(this.lastRecordedTime===i&&(!r.length||i+.1>=r.end(r.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&i===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):i===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=i)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var i=this.seekable(),r=this.tech_.currentTime(),e=void 0;return this.afterSeekableWindow_(i,r,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(e=i.end(i.length-1)),this.beforeSeekableWindow_(i,r)&&(e=i.start(0)+.1),e!==void 0&&(this.logger_("Trying to seek outside of seekable at time "+r+" with seekable range "+Ts(i)+". Seeking to "+e+"."),this.seekTo(e),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var i=this.tech_.currentTime(),r=this.tech_.buffered(),e=bc(r,i);return e.length&&i+3<=e.end(0)?(this.cancelTimer_(),this.seekTo(i),this.logger_("Stopped at "+i+" while inside a buffered region ["+e.start(0)+" -> "+e.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var i=this.seekable(),r=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_()||this.tech_.seeking()||this.timer_!==null)return!0;if(this.beforeSeekableWindow_(i,r)){var e=i.end(i.length-1);return this.logger_("Fell out of live window at time "+r+". Seeking to live point (seekable end) "+e),this.cancelTimer_(),this.seekTo(e),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var n=this.tech_.buffered(),a=Tc(n,r);if(this.videoUnderflow_(a,n,r))return this.cancelTimer_(),this.seekTo(r),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(a.length>0){var s=a.start(0)-r;return this.logger_("Stopped at "+r+", setting timer for "+s+", seeking to "+a.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*s,r),!0}return!1}},{key:"afterSeekableWindow_",value:function(i,r,e){var n=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(!i.length)return!1;var a=i.end(i.length-1)+.1;return!e.endList&&n&&(a=i.end(i.length-1)+3*e.targetDuration),r>a}},{key:"beforeSeekableWindow_",value:function(i,r){return!!(i.length&&i.start(0)>0&&r<i.start(0)-.1)}},{key:"videoUnderflow_",value:function(i,r,e){if(i.length===0){var n=this.gapFromVideoUnderflow_(r,e);if(n)return this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". Seeking to current time "+e),!0}return!1}},{key:"skipTheGap_",value:function(i){var r=this.tech_.buffered(),e=this.tech_.currentTime(),n=Tc(r,e);this.cancelTimer_(),n.length!==0&&e===i&&(this.logger_("skipTheGap_:","currentTime:",e,"scheduled currentTime:",i,"nextRange start:",n.start(0)),this.seekTo(n.start(0)+1/30),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(i,r){for(var e=function(o){if(o.length<2)return J.createTimeRanges();for(var u=[],v=1;v<o.length;v++){var C=o.end(v-1),k=o.start(v);u.push([C,k])}return J.createTimeRanges(u)}(i),n=0;n<e.length;n++){var a=e.start(n),s=e.end(n);if(r-a<4&&r-a>2)return{start:a,end:s}}return null}}]),t}(),cm={errorInterval:30,getSource:function(t){return t(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}},Xc=function(t){(function i(r,e){var n=0,a=0,s=J.mergeOptions(cm,e);r.ready(function(){r.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){a&&r.currentTime(a)},u=function(k){k!=null&&(a=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",o),r.src(k),r.trigger({type:"usage",name:"hls-error-reload"}),r.play())},v=function(){if(Date.now()-n<1e3*s.errorInterval)r.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(s.getSource&&typeof s.getSource=="function")return n=Date.now(),s.getSource.call(r,u);J.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},C=function k(){r.off("loadedmetadata",o),r.off("error",v),r.off("dispose",k)};r.on("error",v),r.on("dispose",C),r.reloadSourceOnError=function(k){C(),i(r,k)}})(this,t)};J.use("*",function(t){return{setSource:function(i,r){r(null,i)},setCurrentTime:function(i){return t.vhs&&t.currentSource().src===t.vhs.source_.src&&t.vhs.setCurrentTime(i),i},play:function(){t.vhs&&t.currentSource().src===t.vhs.source_.src&&t.vhs.setCurrentTime(t.tech_.currentTime())}}});var Rt={PlaylistLoader:_n,Playlist:At,Decrypter:kp,AsyncStream:tc,decrypt:rc,utils:Dp,STANDARD_PLAYLIST_SELECTOR:function(){return function(t,i,r,e,n){var a=t.playlists.map(function(Y){var ne,ie;return ne=Y.attributes.RESOLUTION&&Y.attributes.RESOLUTION.width,ie=Y.attributes.RESOLUTION&&Y.attributes.RESOLUTION.height,{bandwidth:Y.attributes.BANDWIDTH||L.Number.MAX_VALUE,width:ne,height:ie,playlist:Y}});Ai(a,function(Y,ne){return Y.bandwidth-ne.bandwidth});var s=(a=a.filter(function(Y){return!At.isIncompatible(Y.playlist)})).filter(function(Y){return At.isEnabled(Y.playlist)});s.length||(s=a.filter(function(Y){return!At.isDisabled(Y.playlist)}));var o=s.filter(function(Y){return Y.bandwidth*Ut.BANDWIDTH_VARIANCE<i}),u=o[o.length-1],v=o.filter(function(Y){return Y.bandwidth===u.bandwidth})[0];if(n===!1){var C=v||s[0]||a[0];return C?C.playlist:null}var k=o.filter(function(Y){return Y.width&&Y.height});Ai(k,function(Y,ne){return Y.width-ne.width});var M=k.filter(function(Y){return Y.width===r&&Y.height===e});u=M[M.length-1];var j=M.filter(function(Y){return Y.bandwidth===u.bandwidth})[0],G=void 0,H=void 0,K=void 0;j||(H=(G=k.filter(function(Y){return Y.width>r||Y.height>e})).filter(function(Y){return Y.width===G[0].width&&Y.height===G[0].height}),u=H[H.length-1],K=H.filter(function(Y){return Y.bandwidth===u.bandwidth})[0]);var W=K||j||v||s[0]||a[0];return W?W.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(Gc(this.tech_.el(),"width"),10),parseInt(Gc(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var t=this.playlists.master.playlists.filter(At.isEnabled);return Ai(t,function(i,r){return Ls(i,r)}),t.filter(function(i){return Ci(i.attributes.CODECS).videoCodec})[0]||null},comparePlaylistBandwidth:Ls,comparePlaylistResolution:function(t,i){var r=void 0,e=void 0;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),r=r||L.Number.MAX_VALUE,i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width&&(e=i.attributes.RESOLUTION.width),r===(e=e||L.Number.MAX_VALUE)&&t.attributes.BANDWIDTH&&i.attributes.BANDWIDTH?t.attributes.BANDWIDTH-i.attributes.BANDWIDTH:r-e},xhr:mc()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(Rt,t,{get:function(){return J.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),Ut[t]},set:function(i){J.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),typeof i!="number"||i<0?J.log.warn("value of Hls."+t+" must be greater than or equal to 0"):Ut[t]=i}})});var Yc=function(t){return/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(t)?"hls":/^application\/dash\+xml/i.test(t)?"dash":null},Jc=function(t,i){for(var r=i.media(),e=-1,n=0;n<t.length;n++)if(t[n].id===r.uri){e=n;break}t.selectedIndex_=e,t.trigger({selectedIndex:e,type:"change"})};Rt.canPlaySource=function(){return J.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var dm=function(t){if(t.options_.sourceType==="dash"){var i=J.players[t.tech_.options_.playerId];if(i.eme){var r=function(e,n,a){if(!e)return e;var s={};for(var o in e)s[o]={audioContentType:'audio/mp4; codecs="'+a.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+n.attributes.CODECS+'"'},n.contentProtection&&n.contentProtection[o]&&n.contentProtection[o].pssh&&(s[o].pssh=n.contentProtection[o].pssh),typeof e[o]=="string"&&(s[o].url=e[o]);return J.mergeOptions(e,s)}(t.source_.keySystems,t.playlists.media(),t.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());r&&(i.currentSource().keySystems=r,i.eme.initializeMediaKeys&&i.eme.initializeMediaKeys())}}},Qc=function(){if(!window.localStorage)return null;var t=window.localStorage.getItem("videojs-vhs");if(!t)return null;try{return JSON.parse(t)}catch{return null}};Rt.supportsNativeHls=function(){var t=q.createElement("video");return J.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(i){return/maybe|probably/i.test(t.canPlayType(i))}):!1}(),Rt.supportsNativeDash=!!J.getTech("Html5").isSupported()&&/maybe|probably/i.test(q.createElement("video").canPlayType("application/dash+xml")),Rt.supportsTypeNatively=function(t){return t==="hls"?Rt.supportsNativeHls:t==="dash"&&Rt.supportsNativeDash},Rt.isSupported=function(){return J.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var hm=J.getComponent("Component"),Zc=function(t){function i(r,e,n){zt(this,i);var a=ar(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,n.hls));if(e.options_&&e.options_.playerId){var s=J(e.options_.playerId);s.hasOwnProperty("hls")||Object.defineProperty(s,"hls",{get:function(){return J.log.warn("player.hls is deprecated. Use player.tech().hls instead."),e.trigger({type:"usage",name:"hls-player-access"}),a},configurable:!0}),s.vhs=a,s.dash=a,a.player_=s}if(a.tech_=e,a.source_=r,a.stats={},a.setOptions_(),a.options_.overrideNative&&e.overrideNativeAudioTracks&&e.overrideNativeVideoTracks)e.overrideNativeAudioTracks(!0),e.overrideNativeVideoTracks(!0);else if(a.options_.overrideNative&&(e.featuresNativeVideoTracks||e.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return a.on(q,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(o){var u=q.fullscreenElement||q.webkitFullscreenElement||q.mozFullScreenElement||q.msFullscreenElement;u&&u.contains(a.tech_.el())&&a.masterPlaylistController_.smoothQualityChange_()}),a.on(a.tech_,"seeking",function(){this.tech_.currentTime()===0&&this.tech_.player_.loop()&&this.setCurrentTime(0)}),a.on(a.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),a.on(a.tech_,"play",a.play),a}return or(i,hm),Qt(i,[{key:"setOptions_",value:function(){var r=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=this.source_.useBandwidthFromLocalStorage!==void 0?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,typeof this.options_.blacklistDuration!="number"&&(this.options_.blacklistDuration=300),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){var e=Qc();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Ut.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ut.INITIAL_BANDWIDTH,["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(n){r.source_[n]!==void 0&&(r.options_[n]=r.source_[n])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(r,e){var n=this;r&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Rt,this.options_.sourceType=Yc(e),this.options_.seekTo=function(a){n.tech_.setCurrentTime(a),n.setCurrentTime(a)},this.masterPlaylistController_=new om(this.options_),this.playbackWatcher_=new lm(J.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",function(){J.players[n.tech_.options_.playerId].error(n.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Rt.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Rt.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(a){this.masterPlaylistController_.selectPlaylist=a.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(a){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=a,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(a){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=a,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var a=1/(this.bandwidth||1),s=void 0;return s=this.throughput>0?1/this.throughput:0,Math.floor(1/(a+s))},set:function(){J.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Sc(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Sc(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){n.options_.useBandwidthFromLocalStorage&&function(a){if(!window.localStorage)return!1;var s=Qc();s=s?J.mergeOptions(s,a):a;try{window.localStorage.setItem("videojs-vhs",JSON.stringify(s))}catch{return!1}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){var a,s;s=(a=n).playlists,a.representations=function(){return s.master.playlists.filter(function(o){return!ys(o)}).map(function(o,u){return new um(a,o,o.uri)})},dm(n)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.tech_.ready(function(){return n.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(J.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var r=this,e=J.players[this.tech_.options_.playerId];e&&e.qualityLevels&&(this.qualityLevels_=e.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){var n,a;n=r.qualityLevels_,(a=r).representations().forEach(function(s){n.addQualityLevel(s)}),Jc(n,a.playlists)}),this.playlists.on("mediachange",function(){Jc(r.qualityLevels_,r.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(r){this.masterPlaylistController_.setCurrentTime(r)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function r(e,n,a){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,n);if(s===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:r(o,n,a)}if("value"in s)return s.value;var u=s.get;return u!==void 0?u.call(a):void 0}(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(r,e){return Mp({playlist:this.masterPlaylistController_.media(),time:r,callback:e})}},{key:"seekToProgramTime",value:function(r,e){var n=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:2;return Up({programTime:r,playlist:this.masterPlaylistController_.media(),retryCount:a,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:e})}}]),i}(),xs={name:"videojs-http-streaming",VERSION:"1.10.3",canHandleSource:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=J.mergeOptions(J.options,i);return xs.canPlayType(t.type,r)},handleSource:function(t,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=J.mergeOptions(J.options,r);return i.hls=new Zc(t,i,e),i.hls.xhr=mc(),i.hls.src(t.src,t.type),i.hls},canPlayType:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=J.mergeOptions(J.options,i).hls.overrideNative,e=Yc(t);return e&&(!Rt.supportsTypeNatively(e)||r)?"maybe":""}};return J.MediaSource!==void 0&&J.URL!==void 0||(J.MediaSource=wi,J.URL=Dc),wi.supportsNativeMediaSources()&&J.getTech("Html5").registerSourceHandler(xs,0),J.HlsHandler=Zc,J.HlsSourceHandler=xs,J.Hls=Rt,J.use||J.registerComponent("Hls",Rt),J.options.hls=J.options.hls||{},J.registerPlugin?J.registerPlugin("reloadSourceOnError",Xc):J.plugin("reloadSourceOnError",Xc),J}),function(L,q){typeof exports=="object"&&typeof module<"u"?module.exports=q(require("video.js")):typeof define=="function"&&define.amd?define(["video.js"],q):L.videojsSnapshot=q(L.videojs)}(this,function(L){"use strict";L="default"in L?L.default:L;var q,N=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};return function(D){var I,b;I=N,b=function(_){var f,m,c={},T=_.registerPlugin||_.plugin,S=_.getComponent("Component"),w=_.getComponent("Button");_.SnapshoterBaseComponent=_.extend(S,{constructor:function(d,l){S.call(this,d,l)},dispose:function(){}}),_.SnapshoterComponent=_.extend(_.SnapshoterBaseComponent,{constructor:function(d,l){S.call(this,d,l),this.loadOptions(),this.resetState(),this.player().one("ready",this.setupUI.bind(this));var p=_.ImageCaptureEngine;try{this.engine=new p(this.player())}catch{throw new Error("Could not load "+_.ImageCaptureEngine+" plugin")}},loadOptions:function(){},setupUI:function(){this.player().controlBar.addChild(this.player().cameraButton),this.player().controlBar.el().appendChild(this.player().cameraButton.el()),this.player().options_.controls&&(this.player().controlBar.show(),this.player().controlBar.el().style.display="flex")},isSnapshoting:function(){return this._snapshoting},isProcessing:function(){return this._processing},isDestroyed:function(){return this.player()&&this.player().children()===null},start:function(){this.isProcessing()||(this._snapshoting=!0,this._processing=!0,this.player().controlBar.playToggle.hide(),this.createSnapshot())},stop:function(){this.isProcessing()&&(this._snapshoting=!1,this._processing=!1),this.player().controlBar.playToggle.show()},destroy:function(){this.stop(),this.player().dispose(),this.resetState()},reset:function(){this.stop(),this.loadOptions(),this.resetState(),this.player().reset(),this.player().snapshotCanvas.hide(),this.player().cameraButton.hide()},resetState:function(){this._snapshoting=!1,this._processing=!1},createSnapshot:function(){var d=this;this.captureFrame().then(function(l){d.player().trigger("snap",l),d.stop()}).catch(function(l){console.log(l)})},retrySnapshot:function(){this._processing=!1,this.player().snapshotCanvas.hide()},captureFrame:function(){var d=this,l=this.player().snapshotCanvas.el().firstChild;return l.width=this.player().videoWidth(),l.height=this.player().videoHeight(),new Promise(function(p,y){return p(d.engine.imageCaptureByIdAndCanvasDom(d.player().id(),l))})}}),m=_.extend(S),(f=_.extend(w,{constructor:function(d,l){w.call(this,d,l),this.on("click",this.onClick),this.on("tap",this.onClick)}})).prototype.onClick=function(d){d.stopImmediatePropagation();var l=this.player().snapshoter;l.isProcessing()?(l.retrySnapshot(),this.onStop()):l.start()},f.prototype.onStart=function(){this.removeClass("vjs-icon-photo-camera"),this.addClass("vjs-icon-photo-retry"),this.el().firstChild.firstChild.innerHTML=this.localize("Retry")},f.prototype.onStop=function(){this.removeClass("vjs-icon-photo-retry"),this.addClass("vjs-icon-photo-camera"),this.el().firstChild.firstChild.innerHTML=this.localize("Image")};var g=function(d){var l,p,y=this,A=_.mergeOptions(c,d),P=this;P.ready(function(){var U;U=y,_.mergeOptions(c,d),U.addClass("vjs-snapshot")}),P.on("play",function(){try{P.tech_.el_.setAttribute("crossorigin","anonymous")}catch{}}),P.snapshoter=new _.SnapshoterComponent(this,{options:A}),P.addChild(P.snapshoter),P.snapshotCanvas=new m(P,{el:(l="snapshot",p={className:"vjs-"+l+"-canvas",innerHTML:"<canvas></canvas>"},S.prototype.createEl("div",p))}),P.snapshotCanvas.hide(),P.snapshoter.addChild(P.snapshotCanvas),P.cameraButton=new f(P,{el:function(U,O,V){var z={className:"vjs-"+U+"-control vjs-control vjs-button",innerHTML:'<span aria-hidden="true" class="vjs-icon-'+V+'"></span><span class="vjs-control-text" aria-live="polite">'+O+"</span>"},Z={title:O,type:"button","aria-disabled":"false"};return S.prototype.createEl("button",z,Z)}("snapshot",P.localize("Snapshot"),"spinner")}),P.cameraButton.show()};return T("snapshot",g),g},D.exports?D.exports=b(L):I.returnExports=b(I.videojs),function(_,f){D.exports?D.exports=f(L):_.returnExports=f(_.videojs)}(N,function(_){var f=_.getComponent("Component");_.ImageCaptureEngine=_.extend(f,{constructor:function(m,c){f.call(this,m,c)},formatTag:function(m){if(m&&(m=m.trim()).length!==0)return m},getDomByIdAndTag:function(m,c){c=this.formatTag(c);var T=document.getElementById(m);if(c&&c.trim().length!==0)return T.tagName.toUpperCase()===c.toUpperCase()?T:T.getElementsByTagName(c)[0]},getScreenContainerDomByIdAndTag:function(m,c){if(c=this.formatTag(c))return this.getDomByIdAndTag(m,c);var T=this.getDomByIdAndTag(m,"object");return T||this.getDomByIdAndTag(m,"video")},drawCanvas:function(m,c){m.width=c.videoWidth,m.height=c.videoHeight,m.getContext("2d").drawImage(c,0,0,m.width,m.height)},imageCaptureByDom:function(m,c){var T;return m&&m.tagName.toUpperCase()==="object".toUpperCase()?T=m.vjs_snap():(this.drawCanvas(c,m),T=c.toDataURL("image/png")),T},imageCaptureById:function(m,c){return this.imageCaptureByDom(this.getScreenContainerDomByIdAndTag(m),this.getDomByIdAndTag(c,"canvas"))},imageCaptureByIdAndCanvasDom:function(m,c){return this.imageCaptureByDom(this.getScreenContainerDomByIdAndTag(m),c)}})})}(q={exports:{}},q.exports),q.exports}),function(L){typeof exports=="object"&&typeof module<"u"?module.exports=L():typeof define=="function"&&define.amd?define([],L):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).flvjs=L()}(function(){return function(){return function L(q,N,D){function I(f,m){if(!N[f]){if(!q[f]){var c=typeof require=="function"&&require;if(!m&&c)return c(f,!0);if(b)return b(f,!0);var T=new Error("Cannot find module '"+f+"'");throw T.code="MODULE_NOT_FOUND",T}var S=N[f]={exports:{}};q[f][0].call(S.exports,function(w){return I(q[f][1][w]||w)},S,S.exports,L,q,N,D)}return N[f].exports}for(var b=typeof require=="function"&&require,_=0;_<D.length;_++)I(D[_]);return I}}()({1:[function(L,q,N){(function(D,I){(function(b,_){typeof N=="object"&&q!==void 0?q.exports=_():b.ES6Promise=_()})(this,function(){"use strict";function b(re){return typeof re=="function"}var _=Array.isArray?Array.isArray:function(re){return Object.prototype.toString.call(re)==="[object Array]"},f=0,m=void 0,c=void 0,T=function(re,ae){y[f]=re,y[f+1]=ae,(f+=2)===2&&(c?c(A):z())},S=typeof window<"u"?window:void 0,w=S||{},g=w.MutationObserver||w.WebKitMutationObserver,d=typeof self>"u"&&D!==void 0&&{}.toString.call(D)==="[object process]",l=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function p(){var re=setTimeout;return function(){return re(A,1)}}var y=new Array(1e3);function A(){for(var re=0;re<f;re+=2)(0,y[re])(y[re+1]),y[re]=void 0,y[re+1]=void 0;f=0}var P,U,O,V,z=void 0;function Z(re,ae){var be=this,_e=new this.constructor(ue);_e[se]===void 0&&He(_e);var Pe=be._state;if(Pe){var we=arguments[Pe-1];T(function(){return ct(Pe,_e,we,be._result)})}else ze(be,_e,re,ae);return _e}function te(re){if(re&&typeof re=="object"&&re.constructor===this)return re;var ae=new this(ue);return Fe(ae,re),ae}d?z=function(){return D.nextTick(A)}:g?(U=0,O=new g(A),V=document.createTextNode(""),O.observe(V,{characterData:!0}),z=function(){V.data=U=++U%2}):l?((P=new MessageChannel).port1.onmessage=A,z=function(){return P.port2.postMessage(0)}):z=S===void 0&&typeof L=="function"?function(){try{var re=Function("return this")().require("vertx");return(m=re.runOnLoop||re.runOnContext)!==void 0?function(){m(A)}:p()}catch{return p()}}():p();var se=Math.random().toString(36).substring(2);function ue(){}var de=void 0,ke=1,Te=2,he={error:null};function Ne(re){try{return re.then}catch(ae){return he.error=ae,he}}function ve(re,ae,be){ae.constructor===re.constructor&&be===Z&&ae.constructor.resolve===te?function(_e,Pe){Pe._state===ke?Ve(_e,Pe._result):Pe._state===Te?Ce(_e,Pe._result):ze(Pe,void 0,function(we){return Fe(_e,we)},function(we){return Ce(_e,we)})}(re,ae):be===he?(Ce(re,he.error),he.error=null):be===void 0?Ve(re,ae):b(be)?function(_e,Pe,we){T(function(Je){var st=!1,wt=function(Xe,qe,ot,ir){try{Xe.call(qe,ot,ir)}catch(_r){return _r}}(we,Pe,function(Xe){st||(st=!0,Pe!==Xe?Fe(Je,Xe):Ve(Je,Xe))},function(Xe){st||(st=!0,Ce(Je,Xe))},Je._label);!st&&wt&&(st=!0,Ce(Je,wt))},_e)}(re,ae,be):Ve(re,ae)}function Fe(re,ae){var be,_e;re===ae?Ce(re,new TypeError("You cannot resolve a promise with itself")):(_e=typeof(be=ae),be===null||_e!=="object"&&_e!=="function"?Ve(re,ae):ve(re,ae,Ne(ae)))}function Oe(re){re._onerror&&re._onerror(re._result),tt(re)}function Ve(re,ae){re._state===de&&(re._result=ae,re._state=ke,re._subscribers.length!==0&&T(tt,re))}function Ce(re,ae){re._state===de&&(re._state=Te,re._result=ae,T(Oe,re))}function ze(re,ae,be,_e){var Pe=re._subscribers,we=Pe.length;re._onerror=null,Pe[we]=ae,Pe[we+ke]=be,Pe[we+Te]=_e,we===0&&re._state&&T(tt,re)}function tt(re){var ae=re._subscribers,be=re._state;if(ae.length!==0){for(var _e=void 0,Pe=void 0,we=re._result,Je=0;Je<ae.length;Je+=3)_e=ae[Je],Pe=ae[Je+be],_e?ct(be,_e,Pe,we):Pe(we);re._subscribers.length=0}}function ct(re,ae,be,_e){var Pe=b(be),we=void 0,Je=void 0,st=void 0,wt=void 0;if(Pe){if((we=function(Xe,qe){try{return Xe(qe)}catch(ot){return he.error=ot,he}}(be,_e))===he?(wt=!0,Je=we.error,we.error=null):st=!0,ae===we)return void Ce(ae,new TypeError("A promises callback cannot return that same promise."))}else we=_e,st=!0;ae._state!==de||(Pe&&st?Fe(ae,we):wt?Ce(ae,Je):re===ke?Ve(ae,we):re===Te&&Ce(ae,we))}var Ge=0;function He(re){re[se]=Ge++,re._state=void 0,re._result=void 0,re._subscribers=[]}var rt=function(){function re(ae,be){this._instanceConstructor=ae,this.promise=new ae(ue),this.promise[se]||He(this.promise),_(be)?(this.length=be.length,this._remaining=be.length,this._result=new Array(this.length),this.length===0?Ve(this.promise,this._result):(this.length=this.length||0,this._enumerate(be),this._remaining===0&&Ve(this.promise,this._result))):Ce(this.promise,new Error("Array Methods must be provided an Array"))}return re.prototype._enumerate=function(ae){for(var be=0;this._state===de&&be<ae.length;be++)this._eachEntry(ae[be],be)},re.prototype._eachEntry=function(ae,be){var _e=this._instanceConstructor,Pe=_e.resolve;if(Pe===te){var we=Ne(ae);if(we===Z&&ae._state!==de)this._settledAt(ae._state,be,ae._result);else if(typeof we!="function")this._remaining--,this._result[be]=ae;else if(_e===De){var Je=new _e(ue);ve(Je,ae,we),this._willSettleAt(Je,be)}else this._willSettleAt(new _e(function(st){return st(ae)}),be)}else this._willSettleAt(Pe(ae),be)},re.prototype._settledAt=function(ae,be,_e){var Pe=this.promise;Pe._state===de&&(this._remaining--,ae===Te?Ce(Pe,_e):this._result[be]=_e),this._remaining===0&&Ve(Pe,this._result)},re.prototype._willSettleAt=function(ae,be){var _e=this;ze(ae,void 0,function(Pe){return _e._settledAt(ke,be,Pe)},function(Pe){return _e._settledAt(Te,be,Pe)})},re}(),De=function(){function re(ae){this[se]=Ge++,this._result=this._state=void 0,this._subscribers=[],ue!==ae&&(typeof ae!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof re?function(be,_e){try{_e(function(Pe){Fe(be,Pe)},function(Pe){Ce(be,Pe)})}catch(Pe){Ce(be,Pe)}}(this,ae):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return re.prototype.catch=function(ae){return this.then(null,ae)},re.prototype.finally=function(ae){var be=this.constructor;return b(ae)?this.then(function(_e){return be.resolve(ae()).then(function(){return _e})},function(_e){return be.resolve(ae()).then(function(){throw _e})}):this.then(ae,ae)},re}();return De.prototype.then=Z,De.all=function(re){return new rt(this,re).promise},De.race=function(re){var ae=this;return _(re)?new ae(function(be,_e){for(var Pe=re.length,we=0;we<Pe;we++)ae.resolve(re[we]).then(be,_e)}):new ae(function(be,_e){return _e(new TypeError("You must pass an array to race."))})},De.resolve=te,De.reject=function(re){var ae=new this(ue);return Ce(ae,re),ae},De._setScheduler=function(re){c=re},De._setAsap=function(re){T=re},De._asap=T,De.polyfill=function(){var re=void 0;if(I!==void 0)re=I;else if(typeof self<"u")re=self;else try{re=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var ae=re.Promise;if(ae){var be=null;try{be=Object.prototype.toString.call(ae.resolve())}catch{}if(be==="[object Promise]"&&!ae.cast)return}re.Promise=De},De.Promise=De,De})}).call(this,L("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:3}],2:[function(L,q,N){function D(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function I(f){return typeof f=="function"}function b(f){return typeof f=="object"&&f!==null}function _(f){return f===void 0}q.exports=D,D.EventEmitter=D,D.prototype._events=void 0,D.prototype._maxListeners=void 0,D.defaultMaxListeners=10,D.prototype.setMaxListeners=function(f){if(typeof f!="number"||f<0||isNaN(f))throw TypeError("n must be a positive number");return this._maxListeners=f,this},D.prototype.emit=function(f){var m,c,T,S,w,g;if(this._events||(this._events={}),f==="error"&&(!this._events.error||b(this._events.error)&&!this._events.error.length)){if((m=arguments[1])instanceof Error)throw m;var d=new Error('Uncaught, unspecified "error" event. ('+m+")");throw d.context=m,d}if(_(c=this._events[f]))return!1;if(I(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:S=Array.prototype.slice.call(arguments,1),c.apply(this,S)}else if(b(c))for(S=Array.prototype.slice.call(arguments,1),T=(g=c.slice()).length,w=0;w<T;w++)g[w].apply(this,S);return!0},D.prototype.addListener=function(f,m){var c;if(!I(m))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",f,I(m.listener)?m.listener:m),this._events[f]?b(this._events[f])?this._events[f].push(m):this._events[f]=[this._events[f],m]:this._events[f]=m,b(this._events[f])&&!this._events[f].warned&&(c=_(this._maxListeners)?D.defaultMaxListeners:this._maxListeners)&&c>0&&this._events[f].length>c&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),typeof console.trace=="function"&&console.trace()),this},D.prototype.on=D.prototype.addListener,D.prototype.once=function(f,m){if(!I(m))throw TypeError("listener must be a function");var c=!1;function T(){this.removeListener(f,T),c||(c=!0,m.apply(this,arguments))}return T.listener=m,this.on(f,T),this},D.prototype.removeListener=function(f,m){var c,T,S,w;if(!I(m))throw TypeError("listener must be a function");if(!this._events||!this._events[f])return this;if(S=(c=this._events[f]).length,T=-1,c===m||I(c.listener)&&c.listener===m)delete this._events[f],this._events.removeListener&&this.emit("removeListener",f,m);else if(b(c)){for(w=S;w-- >0;)if(c[w]===m||c[w].listener&&c[w].listener===m){T=w;break}if(T<0)return this;c.length===1?(c.length=0,delete this._events[f]):c.splice(T,1),this._events.removeListener&&this.emit("removeListener",f,m)}return this},D.prototype.removeAllListeners=function(f){var m,c;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[f]&&delete this._events[f],this;if(arguments.length===0){for(m in this._events)m!=="removeListener"&&this.removeAllListeners(m);return this.removeAllListeners("removeListener"),this._events={},this}if(I(c=this._events[f]))this.removeListener(f,c);else if(c)for(;c.length;)this.removeListener(f,c[c.length-1]);return delete this._events[f],this},D.prototype.listeners=function(f){return this._events&&this._events[f]?I(this._events[f])?[this._events[f]]:this._events[f].slice():[]},D.prototype.listenerCount=function(f){if(this._events){var m=this._events[f];if(I(m))return 1;if(m)return m.length}return 0},D.listenerCount=function(f,m){return f.listenerCount(m)}},{}],3:[function(L,q,N){var D,I,b=q.exports={};function _(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}function m(y){if(D===setTimeout)return setTimeout(y,0);if((D===_||!D)&&setTimeout)return D=setTimeout,setTimeout(y,0);try{return D(y,0)}catch{try{return D.call(null,y,0)}catch{return D.call(this,y,0)}}}(function(){try{D=typeof setTimeout=="function"?setTimeout:_}catch{D=_}try{I=typeof clearTimeout=="function"?clearTimeout:f}catch{I=f}})();var c,T=[],S=!1,w=-1;function g(){S&&c&&(S=!1,c.length?T=c.concat(T):w=-1,T.length&&d())}function d(){if(!S){var y=m(g);S=!0;for(var A=T.length;A;){for(c=T,T=[];++w<A;)c&&c[w].run();w=-1,A=T.length}c=null,S=!1,function(P){if(I===clearTimeout)return clearTimeout(P);if((I===f||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(P);try{I(P)}catch{try{return I.call(null,P)}catch{return I.call(this,P)}}}(y)}}function l(y,A){this.fun=y,this.array=A}function p(){}b.nextTick=function(y){var A=new Array(arguments.length-1);if(arguments.length>1)for(var P=1;P<arguments.length;P++)A[P-1]=arguments[P];T.push(new l(y,A)),T.length!==1||S||m(d)},l.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=p,b.addListener=p,b.once=p,b.off=p,b.removeListener=p,b.removeAllListeners=p,b.emit=p,b.prependListener=p,b.prependOnceListener=p,b.listeners=function(y){return[]},b.binding=function(y){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(y){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],4:[function(L,q,N){var D=arguments[3],I=arguments[4],b=arguments[5],_=JSON.stringify;q.exports=function(f,m){for(var c,T=Object.keys(b),S=0,w=T.length;S<w;S++){var g=T[S],d=b[g].exports;if(d===f||d&&d.default===f){c=g;break}}if(!c){c=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var l={};for(S=0,w=T.length;S<w;S++)l[g=T[S]]=g;I[c]=["function(require,module,exports){"+f+"(self); }",l]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),y={};y[c]=c,I[p]=["function(require,module,exports){var f = require("+_(c)+");(f.default ? f.default : f)(self);}",y];var A={};(function Z(te){A[te]=!0;for(var se in I[te][1]){var ue=I[te][1][se];A[ue]||Z(ue)}})(p);var P="("+D+")({"+Object.keys(A).map(function(Z){return _(Z)+":["+I[Z][0]+","+_(I[Z][1])+"]"}).join(",")+"},{},["+_(p)+"])",U=window.URL||window.webkitURL||window.mozURL||window.msURL,O=new Blob([P],{type:"text/javascript"});if(m&&m.bare)return O;var V=U.createObjectURL(O),z=new Worker(V);return z.objectURL=V,z}},{}],5:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.createDefaultConfig=function(){return Object.assign({},D)};var D=N.defaultConfig={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0}},{}],6:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D,I=function(){function c(T,S){for(var w=0;w<S.length;w++){var g=S[w];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(T,g.key,g)}}return function(T,S,w){return S&&c(T.prototype,S),w&&c(T,w),T}}(),b=L("../io/io-controller.js"),_=(D=b)&&D.__esModule?D:{default:D},f=L("../config.js"),m=function(){function c(){(function(T,S){if(!(T instanceof S))throw new TypeError("Cannot call a class as a function")})(this,c)}return I(c,null,[{key:"supportMSEH264Playback",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"supportNetworkStreamIO",value:function(){var T=new _.default({},(0,f.createDefaultConfig)()),S=T.loaderType;return T.destroy(),S=="fetch-stream-loader"||S=="xhr-moz-chunked-loader"}},{key:"getNetworkLoaderTypeName",value:function(){var T=new _.default({},(0,f.createDefaultConfig)()),S=T.loaderType;return T.destroy(),S}},{key:"supportNativeMediaPlayback",value:function(T){c.videoElement==null&&(c.videoElement=window.document.createElement("video"));var S=c.videoElement.canPlayType(T);return S==="probably"||S=="maybe"}},{key:"getFeatureList",value:function(){var T={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return T.mseFlvPlayback=c.supportMSEH264Playback(),T.networkStreamIO=c.supportNetworkStreamIO(),T.networkLoaderName=c.getNetworkLoaderTypeName(),T.mseLiveFlvPlayback=T.mseFlvPlayback&&T.networkStreamIO,T.nativeMP4H264Playback=c.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),T.nativeWebmVP8Playback=c.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),T.nativeWebmVP9Playback=c.supportNativeMediaPlayback('video/webm; codecs="vp9"'),T}}]),c}();N.default=m},{"../config.js":5,"../io/io-controller.js":23}],7:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(){(function(_,f){if(!(_ instanceof f))throw new TypeError("Cannot call a class as a function")})(this,b),this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return D(b,[{key:"isComplete",value:function(){var _=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,f=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&_&&f}},{key:"isSeekable",value:function(){return this.hasKeyframesIndex===!0}},{key:"getNearestKeyframe",value:function(_){if(this.keyframesIndex==null)return null;var f=this.keyframesIndex,m=this._search(f.times,_);return{index:m,milliseconds:f.times[m],fileposition:f.filepositions[m]}}},{key:"_search",value:function(_,f){var m=0,c=_.length-1,T=0,S=0,w=c;for(f<_[0]&&(m=0,S=w+1);S<=w;){if((T=S+Math.floor((w-S)/2))===c||f>=_[T]&&f<_[T+1]){m=T;break}_[T]<f?S=T+1:w=T-1}return m}}]),b}();N.default=I},{}],8:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}();function I(b,_){if(!(b instanceof _))throw new TypeError("Cannot call a class as a function")}N.SampleInfo=function b(_,f,m,c,T){I(this,b),this.dts=_,this.pts=f,this.duration=m,this.originalDts=c,this.isSyncPoint=T,this.fileposition=null},N.MediaSegmentInfo=function(){function b(){I(this,b),this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return D(b,[{key:"appendSyncPoint",value:function(_){_.isSyncPoint=!0,this.syncPoints.push(_)}}]),b}(),N.IDRSampleList=function(){function b(){I(this,b),this._list=[]}return D(b,[{key:"clear",value:function(){this._list=[]}},{key:"appendArray",value:function(_){var f=this._list;_.length!==0&&(f.length>0&&_[0].originalDts<f[f.length-1].originalDts&&this.clear(),Array.prototype.push.apply(f,_))}},{key:"getLastSyncPointBeforeDts",value:function(_){if(this._list.length==0)return null;var f=this._list,m=0,c=f.length-1,T=0,S=0,w=c;for(_<f[0].dts&&(m=0,S=w+1);S<=w;){if((T=S+Math.floor((w-S)/2))===c||_>=f[T].dts&&_<f[T+1].dts){m=T;break}f[T].dts<_?S=T+1:w=T-1}return this._list[m]}}]),b}(),N.MediaSegmentInfoList=function(){function b(_){I(this,b),this._type=_,this._list=[],this._lastAppendLocation=-1}return D(b,[{key:"isEmpty",value:function(){return this._list.length===0}},{key:"clear",value:function(){this._list=[],this._lastAppendLocation=-1}},{key:"_searchNearestSegmentBefore",value:function(_){var f=this._list;if(f.length===0)return-2;var m=f.length-1,c=0,T=0,S=m,w=0;if(_<f[0].originalBeginDts)return w=-1;for(;T<=S;){if((c=T+Math.floor((S-T)/2))===m||_>f[c].lastSample.originalDts&&_<f[c+1].originalBeginDts){w=c;break}f[c].originalBeginDts<_?T=c+1:S=c-1}return w}},{key:"_searchNearestSegmentAfter",value:function(_){return this._searchNearestSegmentBefore(_)+1}},{key:"append",value:function(_){var f=this._list,m=_,c=this._lastAppendLocation,T=0;c!==-1&&c<f.length&&m.originalBeginDts>=f[c].lastSample.originalDts&&(c===f.length-1||c<f.length-1&&m.originalBeginDts<f[c+1].originalBeginDts)?T=c+1:f.length>0&&(T=this._searchNearestSegmentBefore(m.originalBeginDts)+1),this._lastAppendLocation=T,this._list.splice(T,0,m)}},{key:"getLastSegmentBefore",value:function(_){var f=this._searchNearestSegmentBefore(_);return f>=0?this._list[f]:null}},{key:"getLastSampleBefore",value:function(_){var f=this.getLastSegmentBefore(_);return f!=null?f.lastSample:null}},{key:"getLastSyncPointBefore",value:function(_){for(var f=this._searchNearestSegmentBefore(_),m=this._list[f].syncPoints;m.length===0&&f>0;)f--,m=this._list[f].syncPoints;return m.length>0?m[m.length-1]:null}},{key:"type",get:function(){return this._type}},{key:"length",get:function(){return this._list.length}}]),b}()},{}],9:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function w(g,d){for(var l=0;l<d.length;l++){var p=d[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}return function(g,d,l){return d&&w(g.prototype,d),l&&w(g,l),g}}(),I=T(L("events")),b=T(L("../utils/logger.js")),_=T(L("../utils/browser.js")),f=T(L("./mse-events.js")),m=L("./media-segment-info.js"),c=L("../utils/exception.js");function T(w){return w&&w.__esModule?w:{default:w}}var S=function(){function w(g){(function(d,l){if(!(d instanceof l))throw new TypeError("Cannot call a class as a function")})(this,w),this.TAG="MSEController",this._config=g,this._emitter=new I.default,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new m.IDRSampleList}return D(w,[{key:"destroy",value:function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(g,d){this._emitter.addListener(g,d)}},{key:"off",value:function(g,d){this._emitter.removeListener(g,d)}},{key:"attachMediaElement",value:function(g){if(this._mediaSource)throw new c.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var d=this._mediaSource=new window.MediaSource;d.addEventListener("sourceopen",this.e.onSourceOpen),d.addEventListener("sourceended",this.e.onSourceEnded),d.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=g,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),g.src=this._mediaSourceObjectURL}},{key:"detachMediaElement",value:function(){if(this._mediaSource){var g=this._mediaSource;for(var d in this._sourceBuffers){var l=this._pendingSegments[d];l.splice(0,l.length),this._pendingSegments[d]=null,this._pendingRemoveRanges[d]=null,this._lastInitSegments[d]=null;var p=this._sourceBuffers[d];if(p){if(g.readyState!=="closed"){try{g.removeSourceBuffer(p)}catch(y){b.default.e(this.TAG,y.message)}p.removeEventListener("error",this.e.onSourceBufferError),p.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[d]=null,this._sourceBuffers[d]=null}}if(g.readyState==="open")try{g.endOfStream()}catch(y){b.default.e(this.TAG,y.message)}g.removeEventListener("sourceopen",this.e.onSourceOpen),g.removeEventListener("sourceended",this.e.onSourceEnded),g.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)}},{key:"appendInitSegment",value:function(g,d){if(!this._mediaSource||this._mediaSource.readyState!=="open")return this._pendingSourceBufferInit.push(g),void this._pendingSegments[g.type].push(g);var l=g,p=""+l.container;l.codec&&l.codec.length>0&&(p+=";codecs="+l.codec);var y=!1;if(b.default.v(this.TAG,"Received Initialization Segment, mimeType: "+p),this._lastInitSegments[l.type]=l,p!==this._mimeTypes[l.type]){if(this._mimeTypes[l.type])b.default.v(this.TAG,"Notice: "+l.type+" mimeType changed, origin: "+this._mimeTypes[l.type]+", target: "+p);else{y=!0;try{var A=this._sourceBuffers[l.type]=this._mediaSource.addSourceBuffer(p);A.addEventListener("error",this.e.onSourceBufferError),A.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(P){return b.default.e(this.TAG,P.message),void this._emitter.emit(f.default.ERROR,{code:P.code,msg:P.message})}}this._mimeTypes[l.type]=p}d||this._pendingSegments[l.type].push(l),y||this._sourceBuffers[l.type]&&!this._sourceBuffers[l.type].updating&&this._doAppendSegments(),_.default.safari&&l.container==="audio/mpeg"&&l.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=l.mediaDuration/1e3,this._updateMediaSourceDuration())}},{key:"appendMediaSegment",value:function(g){var d=g;this._pendingSegments[d.type].push(d),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var l=this._sourceBuffers[d.type];!l||l.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}},{key:"seek",value:function(g){for(var d in this._sourceBuffers)if(this._sourceBuffers[d]){var l=this._sourceBuffers[d];if(this._mediaSource.readyState==="open")try{l.abort()}catch(O){b.default.e(this.TAG,O.message)}this._idrList.clear();var p=this._pendingSegments[d];if(p.splice(0,p.length),this._mediaSource.readyState!=="closed"){for(var y=0;y<l.buffered.length;y++){var A=l.buffered.start(y),P=l.buffered.end(y);this._pendingRemoveRanges[d].push({start:A,end:P})}if(l.updating||this._doRemoveRanges(),_.default.safari){var U=this._lastInitSegments[d];U&&(this._pendingSegments[d].push(U),l.updating||this._doAppendSegments())}}}}},{key:"endOfStream",value:function(){var g=this._mediaSource,d=this._sourceBuffers;g&&g.readyState==="open"?d.video&&d.video.updating||d.audio&&d.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,g.endOfStream()):g&&g.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)}},{key:"getNearestKeyframe",value:function(g){return this._idrList.getLastSyncPointBeforeDts(g)}},{key:"_needCleanupSourceBuffer",value:function(){if(!this._config.autoCleanupSourceBuffer)return!1;var g=this._mediaElement.currentTime;for(var d in this._sourceBuffers){var l=this._sourceBuffers[d];if(l){var p=l.buffered;if(p.length>=1&&g-p.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1}},{key:"_doCleanupSourceBuffer",value:function(){var g=this._mediaElement.currentTime;for(var d in this._sourceBuffers){var l=this._sourceBuffers[d];if(l){for(var p=l.buffered,y=!1,A=0;A<p.length;A++){var P=p.start(A),U=p.end(A);if(P<=g&&g<U+3){if(g-P>=this._config.autoCleanupMaxBackwardDuration){y=!0;var O=g-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[d].push({start:P,end:O})}}else U<g&&(y=!0,this._pendingRemoveRanges[d].push({start:P,end:U}))}y&&!l.updating&&this._doRemoveRanges()}}}},{key:"_updateMediaSourceDuration",value:function(){var g=this._sourceBuffers;if(this._mediaElement.readyState!==0&&this._mediaSource.readyState==="open"&&!(g.video&&g.video.updating||g.audio&&g.audio.updating)){var d=this._mediaSource.duration,l=this._pendingMediaDuration;l>0&&(isNaN(d)||l>d)&&(b.default.v(this.TAG,"Update MediaSource duration from "+d+" to "+l),this._mediaSource.duration=l),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}}},{key:"_doRemoveRanges",value:function(){for(var g in this._pendingRemoveRanges)if(this._sourceBuffers[g]&&!this._sourceBuffers[g].updating)for(var d=this._sourceBuffers[g],l=this._pendingRemoveRanges[g];l.length&&!d.updating;){var p=l.shift();d.remove(p.start,p.end)}}},{key:"_doAppendSegments",value:function(){var g=this._pendingSegments;for(var d in g)if(this._sourceBuffers[d]&&!this._sourceBuffers[d].updating&&g[d].length>0){var l=g[d].shift();if(l.timestampOffset){var p=this._sourceBuffers[d].timestampOffset,y=l.timestampOffset/1e3;Math.abs(p-y)>.1&&(b.default.v(this.TAG,"Update MPEG audio timestampOffset from "+p+" to "+y),this._sourceBuffers[d].timestampOffset=y),delete l.timestampOffset}if(!l.data||l.data.byteLength===0)continue;try{this._sourceBuffers[d].appendBuffer(l.data),this._isBufferFull=!1,d==="video"&&l.hasOwnProperty("info")&&this._idrList.appendArray(l.info.syncPoints)}catch(A){this._pendingSegments[d].unshift(l),A.code===22?(this._isBufferFull||this._emitter.emit(f.default.BUFFER_FULL),this._isBufferFull=!0):(b.default.e(this.TAG,A.message),this._emitter.emit(f.default.ERROR,{code:A.code,msg:A.message}))}}}},{key:"_onSourceOpen",value:function(){if(b.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var g=this._pendingSourceBufferInit;g.length;){var d=g.shift();this.appendInitSegment(d,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(f.default.SOURCE_OPEN)}},{key:"_onSourceEnded",value:function(){b.default.v(this.TAG,"MediaSource onSourceEnded")}},{key:"_onSourceClose",value:function(){b.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))}},{key:"_hasPendingSegments",value:function(){var g=this._pendingSegments;return g.video.length>0||g.audio.length>0}},{key:"_hasPendingRemoveRanges",value:function(){var g=this._pendingRemoveRanges;return g.video.length>0||g.audio.length>0}},{key:"_onSourceBufferUpdateEnd",value:function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(f.default.UPDATE_END)}},{key:"_onSourceBufferError",value:function(g){b.default.e(this.TAG,"SourceBuffer Error: "+g)}}]),w}();N.default=S},{"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./media-segment-info.js":8,"./mse-events.js":10,events:2}],10:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.default={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"}},{}],11:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function g(d,l){for(var p=0;p<l.length;p++){var y=l[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(d,y.key,y)}}return function(d,l,p){return l&&g(d.prototype,l),p&&g(d,p),d}}(),I=S(L("events")),b=S(L("../utils/logger.js")),_=S(L("../utils/logging-control.js")),f=S(L("./transmuxing-controller.js")),m=S(L("./transmuxing-events.js")),c=S(L("./transmuxing-worker.js")),T=S(L("./media-info.js"));function S(g){return g&&g.__esModule?g:{default:g}}var w=function(){function g(d,l){if(function(A,P){if(!(A instanceof P))throw new TypeError("Cannot call a class as a function")}(this,g),this.TAG="Transmuxer",this._emitter=new I.default,l.enableWorker&&typeof Worker<"u")try{var p=L("webworkify");this._worker=p(c.default),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[d,l]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},_.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:_.default.getConfig()})}catch{b.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new f.default(d,l)}else this._controller=new f.default(d,l);if(this._controller){var y=this._controller;y.on(m.default.IO_ERROR,this._onIOError.bind(this)),y.on(m.default.DEMUX_ERROR,this._onDemuxError.bind(this)),y.on(m.default.INIT_SEGMENT,this._onInitSegment.bind(this)),y.on(m.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),y.on(m.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),y.on(m.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),y.on(m.default.MEDIA_INFO,this._onMediaInfo.bind(this)),y.on(m.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),y.on(m.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),y.on(m.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),y.on(m.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return D(g,[{key:"destroy",value:function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),_.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(d,l){this._emitter.addListener(d,l)}},{key:"off",value:function(d,l){this._emitter.removeListener(d,l)}},{key:"hasWorker",value:function(){return this._worker!=null}},{key:"open",value:function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()}},{key:"close",value:function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()}},{key:"seek",value:function(d){this._worker?this._worker.postMessage({cmd:"seek",param:d}):this._controller.seek(d)}},{key:"pause",value:function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()}},{key:"resume",value:function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()}},{key:"_onInitSegment",value:function(d,l){var p=this;Promise.resolve().then(function(){p._emitter.emit(m.default.INIT_SEGMENT,d,l)}).catch(function(){})}},{key:"_onMediaSegment",value:function(d,l){var p=this;Promise.resolve().then(function(){p._emitter.emit(m.default.MEDIA_SEGMENT,d,l)}).catch(function(){})}},{key:"_onLoadingComplete",value:function(){var d=this;Promise.resolve().then(function(){d._emitter.emit(m.default.LOADING_COMPLETE)}).catch(function(){})}},{key:"_onRecoveredEarlyEof",value:function(){var d=this;Promise.resolve().then(function(){d._emitter.emit(m.default.RECOVERED_EARLY_EOF)}).catch(function(){})}},{key:"_onMediaInfo",value:function(d){var l=this;Promise.resolve().then(function(){l._emitter.emit(m.default.MEDIA_INFO,d)}).catch(function(){})}},{key:"_onMetaDataArrived",value:function(d){var l=this;Promise.resolve().then(function(){l._emitter.emit(m.default.METADATA_ARRIVED,d)}).catch(function(){})}},{key:"_onScriptDataArrived",value:function(d){var l=this;Promise.resolve().then(function(){l._emitter.emit(m.default.SCRIPTDATA_ARRIVED,d)}).catch(function(){})}},{key:"_onStatisticsInfo",value:function(d){var l=this;Promise.resolve().then(function(){l._emitter.emit(m.default.STATISTICS_INFO,d)}).catch(function(){})}},{key:"_onIOError",value:function(d,l){var p=this;Promise.resolve().then(function(){p._emitter.emit(m.default.IO_ERROR,d,l)}).catch(function(){})}},{key:"_onDemuxError",value:function(d,l){var p=this;Promise.resolve().then(function(){p._emitter.emit(m.default.DEMUX_ERROR,d,l)}).catch(function(){})}},{key:"_onRecommendSeekpoint",value:function(d){var l=this;Promise.resolve().then(function(){l._emitter.emit(m.default.RECOMMEND_SEEKPOINT,d)}).catch(function(){})}},{key:"_onLoggingConfigChanged",value:function(d){this._worker&&this._worker.postMessage({cmd:"logging_config",param:d})}},{key:"_onWorkerMessage",value:function(d){var l=d.data,p=l.data;if(l.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(l.msg){case m.default.INIT_SEGMENT:case m.default.MEDIA_SEGMENT:this._emitter.emit(l.msg,p.type,p.data);break;case m.default.LOADING_COMPLETE:case m.default.RECOVERED_EARLY_EOF:this._emitter.emit(l.msg);break;case m.default.MEDIA_INFO:Object.setPrototypeOf(p,T.default.prototype),this._emitter.emit(l.msg,p);break;case m.default.METADATA_ARRIVED:case m.default.SCRIPTDATA_ARRIVED:case m.default.STATISTICS_INFO:this._emitter.emit(l.msg,p);break;case m.default.IO_ERROR:case m.default.DEMUX_ERROR:this._emitter.emit(l.msg,p.type,p.info);break;case m.default.RECOMMEND_SEEKPOINT:this._emitter.emit(l.msg,p);break;case"logcat_callback":b.default.emitter.emit("log",p.type,p.logcat)}}}]),g}();N.default=w},{"../utils/logger.js":41,"../utils/logging-control.js":42,"./media-info.js":7,"./transmuxing-controller.js":12,"./transmuxing-events.js":13,"./transmuxing-worker.js":14,events:2,webworkify:4}],12:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function l(p,y){for(var A=0;A<y.length;A++){var P=y[A];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(p,P.key,P)}}return function(p,y,A){return y&&l(p.prototype,y),A&&l(p,A),p}}(),I=g(L("events")),b=g(L("../utils/logger.js")),_=g(L("../utils/browser.js")),f=g(L("./media-info.js")),m=g(L("../demux/flv-demuxer.js")),c=g(L("../remux/mp4-remuxer.js")),T=g(L("../demux/demux-errors.js")),S=g(L("../io/io-controller.js")),w=g(L("./transmuxing-events.js"));L("../io/loader.js");function g(l){return l&&l.__esModule?l:{default:l}}var d=function(){function l(p,y){(function(P,U){if(!(P instanceof U))throw new TypeError("Cannot call a class as a function")})(this,l),this.TAG="TransmuxingController",this._emitter=new I.default,this._config=y,p.segments||(p.segments=[{duration:p.duration,filesize:p.filesize,url:p.url}]),typeof p.cors!="boolean"&&(p.cors=!0),typeof p.withCredentials!="boolean"&&(p.withCredentials=!1),this._mediaDataSource=p,this._currentSegmentIndex=0;var A=0;this._mediaDataSource.segments.forEach(function(P){P.timestampBase=A,A+=P.duration,P.cors=p.cors,P.withCredentials=p.withCredentials,y.referrerPolicy&&(P.referrerPolicy=y.referrerPolicy)}),isNaN(A)||this._mediaDataSource.duration===A||(this._mediaDataSource.duration=A),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return D(l,[{key:"destroy",value:function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(p,y){this._emitter.addListener(p,y)}},{key:"off",value:function(p,y){this._emitter.removeListener(p,y)}},{key:"start",value:function(){this._loadSegment(0),this._enableStatisticsReporter()}},{key:"_loadSegment",value:function(p,y){this._currentSegmentIndex=p;var A=this._mediaDataSource.segments[p],P=this._ioctl=new S.default(A,this._config,p);P.onError=this._onIOException.bind(this),P.onSeeked=this._onIOSeeked.bind(this),P.onComplete=this._onIOComplete.bind(this),P.onRedirect=this._onIORedirect.bind(this),P.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),y?this._demuxer.bindDataSource(this._ioctl):P.onDataArrival=this._onInitChunkArrival.bind(this),P.open(y)}},{key:"stop",value:function(){this._internalAbort(),this._disableStatisticsReporter()}},{key:"_internalAbort",value:function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)}},{key:"pause",value:function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())}},{key:"resume",value:function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())}},{key:"seek",value:function(p){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var y=this._searchSegmentIndexContains(p);if(y===this._currentSegmentIndex){var A=this._mediaInfo.segments[y];if(A==null)this._pendingSeekTime=p;else{var P=A.getNearestKeyframe(p);this._remuxer.seek(P.milliseconds),this._ioctl.seek(P.fileposition),this._pendingResolveSeekPoint=P.milliseconds}}else{var U=this._mediaInfo.segments[y];if(U==null)this._pendingSeekTime=p,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(y);else{var O=U.getNearestKeyframe(p);this._internalAbort(),this._remuxer.seek(p),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[y].timestampBase,this._loadSegment(y,O.fileposition),this._pendingResolveSeekPoint=O.milliseconds,this._reportSegmentMediaInfo(y)}}this._enableStatisticsReporter()}}},{key:"_searchSegmentIndexContains",value:function(p){for(var y=this._mediaDataSource.segments,A=y.length-1,P=0;P<y.length;P++)if(p<y[P].timestampBase){A=P-1;break}return A}},{key:"_onInitChunkArrival",value:function(p,y){var A=this,P=null,U=0;if(y>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,U=this._demuxer.parseChunks(p,y);else if((P=m.default.probe(p)).match){this._demuxer=new m.default(P,this._config),this._remuxer||(this._remuxer=new c.default(this._config));var O=this._mediaDataSource;O.duration==null||isNaN(O.duration)||(this._demuxer.overridedDuration=O.duration),typeof O.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=O.hasAudio),typeof O.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=O.hasVideo),this._demuxer.timestampBase=O.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),U=this._demuxer.parseChunks(p,y)}else P=null,b.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){A._internalAbort()}),this._emitter.emit(w.default.DEMUX_ERROR,T.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),U=0;return U}},{key:"_onMediaInfo",value:function(p){var y=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},p),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,f.default.prototype));var A=Object.assign({},p);Object.setPrototypeOf(A,f.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=A,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var P=y._pendingSeekTime;y._pendingSeekTime=null,y.seek(P)})}},{key:"_onMetaDataArrived",value:function(p){this._emitter.emit(w.default.METADATA_ARRIVED,p)}},{key:"_onScriptDataArrived",value:function(p){this._emitter.emit(w.default.SCRIPTDATA_ARRIVED,p)}},{key:"_onIOSeeked",value:function(){this._remuxer.insertDiscontinuity()}},{key:"_onIOComplete",value:function(p){var y=p+1;y<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(y)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(w.default.LOADING_COMPLETE),this._disableStatisticsReporter())}},{key:"_onIORedirect",value:function(p){var y=this._ioctl.extraData;this._mediaDataSource.segments[y].redirectedURL=p}},{key:"_onIORecoveredEarlyEof",value:function(){this._emitter.emit(w.default.RECOVERED_EARLY_EOF)}},{key:"_onIOException",value:function(p,y){b.default.e(this.TAG,"IOException: type = "+p+", code = "+y.code+", msg = "+y.msg),this._emitter.emit(w.default.IO_ERROR,p,y),this._disableStatisticsReporter()}},{key:"_onDemuxException",value:function(p,y){b.default.e(this.TAG,"DemuxException: type = "+p+", info = "+y),this._emitter.emit(w.default.DEMUX_ERROR,p,y)}},{key:"_onRemuxerInitSegmentArrival",value:function(p,y){this._emitter.emit(w.default.INIT_SEGMENT,p,y)}},{key:"_onRemuxerMediaSegmentArrival",value:function(p,y){if(this._pendingSeekTime==null&&(this._emitter.emit(w.default.MEDIA_SEGMENT,p,y),this._pendingResolveSeekPoint!=null&&p==="video")){var A=y.info.syncPoints,P=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,_.default.safari&&A.length>0&&A[0].originalDts===P&&(P=A[0].pts),this._emitter.emit(w.default.RECOMMEND_SEEKPOINT,P)}}},{key:"_enableStatisticsReporter",value:function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))}},{key:"_disableStatisticsReporter",value:function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:"_reportSegmentMediaInfo",value:function(p){var y=this._mediaInfo.segments[p],A=Object.assign({},y);A.duration=this._mediaInfo.duration,A.segmentCount=this._mediaInfo.segmentCount,delete A.segments,delete A.keyframesIndex,this._emitter.emit(w.default.MEDIA_INFO,A)}},{key:"_reportStatisticsInfo",value:function(){var p={};p.url=this._ioctl.currentURL,p.hasRedirect=this._ioctl.hasRedirect,p.hasRedirect&&(p.redirectedURL=this._ioctl.currentRedirectedURL),p.speed=this._ioctl.currentSpeed,p.loaderType=this._ioctl.loaderType,p.currentSegmentIndex=this._currentSegmentIndex,p.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(w.default.STATISTICS_INFO,p)}}]),l}();N.default=d},{"../demux/demux-errors.js":16,"../demux/flv-demuxer.js":18,"../io/io-controller.js":23,"../io/loader.js":24,"../remux/mp4-remuxer.js":38,"../utils/browser.js":39,"../utils/logger.js":41,"./media-info.js":7,"./transmuxing-events.js":13,events:2}],13:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.default={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},{}],14:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),f(L("../utils/logger.js"));var D=f(L("../utils/logging-control.js")),I=f(L("../utils/polyfill.js")),b=f(L("./transmuxing-controller.js")),_=f(L("./transmuxing-events.js"));function f(m){return m&&m.__esModule?m:{default:m}}N.default=function(m){var c=null,T=function(S,w){m.postMessage({msg:"logcat_callback",data:{type:S,logcat:w}})}.bind(this);I.default.install(),m.addEventListener("message",function(S){switch(S.data.cmd){case"init":(c=new b.default(S.data.param[0],S.data.param[1])).on(_.default.IO_ERROR,function(g,d){m.postMessage({msg:_.default.IO_ERROR,data:{type:g,info:d}})}.bind(this)),c.on(_.default.DEMUX_ERROR,function(g,d){m.postMessage({msg:_.default.DEMUX_ERROR,data:{type:g,info:d}})}.bind(this)),c.on(_.default.INIT_SEGMENT,function(g,d){var l={msg:_.default.INIT_SEGMENT,data:{type:g,data:d}};m.postMessage(l,[d.data])}.bind(this)),c.on(_.default.MEDIA_SEGMENT,function(g,d){var l={msg:_.default.MEDIA_SEGMENT,data:{type:g,data:d}};m.postMessage(l,[d.data])}.bind(this)),c.on(_.default.LOADING_COMPLETE,function(){var g={msg:_.default.LOADING_COMPLETE};m.postMessage(g)}.bind(this)),c.on(_.default.RECOVERED_EARLY_EOF,function(){var g={msg:_.default.RECOVERED_EARLY_EOF};m.postMessage(g)}.bind(this)),c.on(_.default.MEDIA_INFO,function(g){var d={msg:_.default.MEDIA_INFO,data:g};m.postMessage(d)}.bind(this)),c.on(_.default.METADATA_ARRIVED,function(g){var d={msg:_.default.METADATA_ARRIVED,data:g};m.postMessage(d)}.bind(this)),c.on(_.default.SCRIPTDATA_ARRIVED,function(g){var d={msg:_.default.SCRIPTDATA_ARRIVED,data:g};m.postMessage(d)}.bind(this)),c.on(_.default.STATISTICS_INFO,function(g){var d={msg:_.default.STATISTICS_INFO,data:g};m.postMessage(d)}.bind(this)),c.on(_.default.RECOMMEND_SEEKPOINT,function(g){m.postMessage({msg:_.default.RECOMMEND_SEEKPOINT,data:g})}.bind(this));break;case"destroy":c&&(c.destroy(),c=null),m.postMessage({msg:"destroyed"});break;case"start":c.start();break;case"stop":c.stop();break;case"seek":c.seek(S.data.param);break;case"pause":c.pause();break;case"resume":c.resume();break;case"logging_config":var w=S.data.param;D.default.applyConfig(w),w.enableCallback===!0?D.default.addLogListener(T):D.default.removeLogListener(T)}})}},{"../utils/logger.js":41,"../utils/logging-control.js":42,"../utils/polyfill.js":43,"./transmuxing-controller.js":12,"./transmuxing-events.js":13}],15:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function S(w,g){for(var d=0;d<g.length;d++){var l=g[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(w,l.key,l)}}return function(w,g,d){return g&&S(w.prototype,g),d&&S(w,d),w}}(),I=f(L("../utils/logger.js")),b=f(L("../utils/utf8-conv.js")),_=L("../utils/exception.js");function f(S){return S&&S.__esModule?S:{default:S}}var m,c=(m=new ArrayBuffer(2),new DataView(m).setInt16(0,256,!0),new Int16Array(m)[0]===256),T=function(){function S(){(function(w,g){if(!(w instanceof g))throw new TypeError("Cannot call a class as a function")})(this,S)}return D(S,null,[{key:"parseScriptData",value:function(w,g,d){var l={};try{var p=S.parseValue(w,g,d),y=S.parseValue(w,g+p.size,d-p.size);l[p.data]=y.data}catch{}return l}},{key:"parseObject",value:function(w,g,d){if(d<3)throw new _.IllegalStateException("Data not enough when parse ScriptDataObject");var l=S.parseString(w,g,d),p=S.parseValue(w,g+l.size,d-l.size),y=p.objectEnd;return{data:{name:l.data,value:p.data},size:l.size+p.size,objectEnd:y}}},{key:"parseVariable",value:function(w,g,d){return S.parseObject(w,g,d)}},{key:"parseString",value:function(w,g,d){if(d<2)throw new _.IllegalStateException("Data not enough when parse String");var l=new DataView(w,g,d).getUint16(0,!c);return{data:l>0?(0,b.default)(new Uint8Array(w,g+2,l)):"",size:2+l}}},{key:"parseLongString",value:function(w,g,d){if(d<4)throw new _.IllegalStateException("Data not enough when parse LongString");var l=new DataView(w,g,d).getUint32(0,!c);return{data:l>0?(0,b.default)(new Uint8Array(w,g+4,l)):"",size:4+l}}},{key:"parseDate",value:function(w,g,d){if(d<10)throw new _.IllegalStateException("Data size invalid when parse Date");var l=new DataView(w,g,d),p=l.getFloat64(0,!c),y=l.getInt16(8,!c);return{data:new Date(p+=60*y*1e3),size:10}}},{key:"parseValue",value:function(w,g,d){if(d<1)throw new _.IllegalStateException("Data not enough when parse Value");var l=new DataView(w,g,d),p=1,y=l.getUint8(0),A=void 0,P=!1;try{switch(y){case 0:A=l.getFloat64(1,!c),p+=8;break;case 1:A=!!l.getUint8(1),p+=1;break;case 2:var U=S.parseString(w,g+1,d-1);A=U.data,p+=U.size;break;case 3:A={};var O=0;for((16777215&l.getUint32(d-4,!c))==9&&(O=3);p<d-4;){var V=S.parseObject(w,g+p,d-p-O);if(V.objectEnd)break;A[V.data.name]=V.data.value,p+=V.size}p<=d-3&&(16777215&l.getUint32(p-1,!c))===9&&(p+=3);break;case 8:A={},p+=4;var z=0;for((16777215&l.getUint32(d-4,!c))==9&&(z=3);p<d-8;){var Z=S.parseVariable(w,g+p,d-p-z);if(Z.objectEnd)break;A[Z.data.name]=Z.data.value,p+=Z.size}p<=d-3&&(16777215&l.getUint32(p-1,!c))===9&&(p+=3);break;case 9:A=void 0,p=1,P=!0;break;case 10:A=[];var te=l.getUint32(1,!c);p+=4;for(var se=0;se<te;se++){var ue=S.parseValue(w,g+p,d-p);A.push(ue.data),p+=ue.size}break;case 11:var de=S.parseDate(w,g+1,d-1);A=de.data,p+=de.size;break;case 12:var ke=S.parseString(w,g+1,d-1);A=ke.data,p+=ke.size;break;default:p=d,I.default.w("AMF","Unsupported AMF value type "+y)}}catch(Te){I.default.e("AMF",Te.toString())}return{data:A,size:p,objectEnd:P}}}]),S}();N.default=T},{"../utils/exception.js":40,"../utils/logger.js":41,"../utils/utf8-conv.js":44}],16:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.default={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},{}],17:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function _(f,m){for(var c=0;c<m.length;c++){var T=m[c];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(f,T.key,T)}}return function(f,m,c){return m&&_(f.prototype,m),c&&_(f,c),f}}(),I=L("../utils/exception.js"),b=function(){function _(f){(function(m,c){if(!(m instanceof c))throw new TypeError("Cannot call a class as a function")})(this,_),this.TAG="ExpGolomb",this._buffer=f,this._buffer_index=0,this._total_bytes=f.byteLength,this._total_bits=8*f.byteLength,this._current_word=0,this._current_word_bits_left=0}return D(_,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var f=this._total_bytes-this._buffer_index;if(f<=0)throw new I.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var m=Math.min(4,f),c=new Uint8Array(4);c.set(this._buffer.subarray(this._buffer_index,this._buffer_index+m)),this._current_word=new DataView(c.buffer).getUint32(0,!1),this._buffer_index+=m,this._current_word_bits_left=8*m}},{key:"readBits",value:function(f){if(f>32)throw new I.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(f<=this._current_word_bits_left){var m=this._current_word>>>32-f;return this._current_word<<=f,this._current_word_bits_left-=f,m}var c=this._current_word_bits_left?this._current_word:0;c>>>=32-this._current_word_bits_left;var T=f-this._current_word_bits_left;this._fillCurrentWord();var S=Math.min(T,this._current_word_bits_left),w=this._current_word>>>32-S;return this._current_word<<=S,this._current_word_bits_left-=S,c=c<<S|w}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var f=void 0;for(f=0;f<this._current_word_bits_left;f++)if(this._current_word&2147483648>>>f)return this._current_word<<=f,this._current_word_bits_left-=f,f;return this._fillCurrentWord(),f+this._skipLeadingZero()}},{key:"readUEG",value:function(){var f=this._skipLeadingZero();return this.readBits(f+1)-1}},{key:"readSEG",value:function(){var f=this.readUEG();return 1&f?f+1>>>1:-1*(f>>>1)}}]),_}();N.default=b},{"../utils/exception.js":40}],18:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},I=function(){function g(d,l){for(var p=0;p<l.length;p++){var y=l[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(d,y.key,y)}}return function(d,l,p){return l&&g(d.prototype,l),p&&g(d,p),d}}(),b=S(L("../utils/logger.js")),_=S(L("./amf-parser.js")),f=S(L("./sps-parser.js")),m=S(L("./demux-errors.js")),c=S(L("../core/media-info.js")),T=L("../utils/exception.js");function S(g){return g&&g.__esModule?g:{default:g}}var w=function(){function g(d,l){var p;(function(y,A){if(!(y instanceof A))throw new TypeError("Cannot call a class as a function")})(this,g),this.TAG="FLVDemuxer",this._config=l,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=d.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=d.hasAudioTrack,this._hasVideo=d.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new c.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=(p=new ArrayBuffer(2),new DataView(p).setInt16(0,256,!0),new Int16Array(p)[0]===256)}return I(g,[{key:"destroy",value:function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null}},{key:"bindDataSource",value:function(d){return d.onDataArrival=this.parseChunks.bind(this),this}},{key:"resetMediaInfo",value:function(){this._mediaInfo=new c.default}},{key:"_isInitialMetadataDispatched",value:function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched}},{key:"parseChunks",value:function(d,l){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new T.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var p=0,y=this._littleEndian;if(l===0){if(!(d.byteLength>13))return 0;p=g.probe(d).dataOffset}for(this._firstParse&&(this._firstParse=!1,l+p!==this._dataOffset&&b.default.w(this.TAG,"First time parsing but chunk byteStart invalid!"),new DataView(d,p).getUint32(0,!y)!==0&&b.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),p+=4);p<d.byteLength;){this._dispatch=!0;var A=new DataView(d,p);if(p+11+4>d.byteLength)break;var P=A.getUint8(0),U=16777215&A.getUint32(0,!y);if(p+11+U+4>d.byteLength)break;if(P===8||P===9||P===18){var O=A.getUint8(4),V=A.getUint8(5),z=A.getUint8(6)|V<<8|O<<16|A.getUint8(7)<<24;16777215&A.getUint32(7,!y)&&b.default.w(this.TAG,"Meet tag which has StreamID != 0!");var Z=p+11;switch(P){case 8:this._parseAudioData(d,Z,U,z);break;case 9:this._parseVideoData(d,Z,U,z,l+p);break;case 18:this._parseScriptData(d,Z,U)}var te=A.getUint32(11+U,!y);te!==11+U&&b.default.w(this.TAG,"Invalid PrevTagSize "+te),p+=11+U+4}else b.default.w(this.TAG,"Unsupported tag type "+P+", skipped"),p+=11+U+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),p}},{key:"_parseScriptData",value:function(d,l,p){var y=_.default.parseScriptData(d,l,p);if(y.hasOwnProperty("onMetaData")){if(y.onMetaData==null||D(y.onMetaData)!=="object")return void b.default.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&b.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=y;var A=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},A)),typeof A.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=A.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof A.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=A.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof A.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=A.audiodatarate),typeof A.videodatarate=="number"&&(this._mediaInfo.videoDataRate=A.videodatarate),typeof A.width=="number"&&(this._mediaInfo.width=A.width),typeof A.height=="number"&&(this._mediaInfo.height=A.height),typeof A.duration=="number"){if(!this._durationOverrided){var P=Math.floor(A.duration*this._timescale);this._duration=P,this._mediaInfo.duration=P}}else this._mediaInfo.duration=0;if(typeof A.framerate=="number"){var U=Math.floor(1e3*A.framerate);if(U>0){var O=U/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=O,this._referenceFrameRate.fps_num=U,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=O}}if(D(A.keyframes)==="object"){this._mediaInfo.hasKeyframesIndex=!0;var V=A.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(V),A.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=A,b.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(y).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},y))}},{key:"_parseKeyframesIndex",value:function(d){for(var l=[],p=[],y=1;y<d.times.length;y++){var A=this._timestampBase+Math.floor(1e3*d.times[y]);l.push(A),p.push(d.filepositions[y])}return{times:l,filepositions:p}}},{key:"_parseAudioData",value:function(d,l,p,y){if(p<=1)b.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var A=new DataView(d,l,p).getUint8(0),P=A>>>4;if(P===2||P===10){var U=0,O=(12&A)>>>2;if(O>=0&&O<=4){U=this._flvSoundRateTable[O];var V=1&A,z=this._audioMetadata,Z=this._audioTrack;if(z||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(z=this._audioMetadata={}).type="audio",z.id=Z.id,z.timescale=this._timescale,z.duration=this._duration,z.audioSampleRate=U,z.channelCount=V===0?1:2),P===10){var te=this._parseAACAudioData(d,l+1,p-1);if(te==null)return;if(te.packetType===0){if(z.config)return void b.default.w(this.TAG,"Found another AudioSpecificConfig!");var se=te.data;z.audioSampleRate=se.samplingRate,z.channelCount=se.channelCount,z.codec=se.codec,z.originalCodec=se.originalCodec,z.config=se.config,z.refSampleDuration=1024/z.audioSampleRate*z.timescale,b.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",z);var ue=this._mediaInfo;ue.audioCodec=z.originalCodec,ue.audioSampleRate=z.audioSampleRate,ue.audioChannelCount=z.channelCount,ue.hasVideo?ue.videoCodec!=null&&(ue.mimeType='video/x-flv; codecs="'+ue.videoCodec+","+ue.audioCodec+'"'):ue.mimeType='video/x-flv; codecs="'+ue.audioCodec+'"',ue.isComplete()&&this._onMediaInfo(ue)}else if(te.packetType===1){var de=this._timestampBase+y,ke={unit:te.data,length:te.data.byteLength,dts:de,pts:de};Z.samples.push(ke),Z.length+=te.data.length}else b.default.e(this.TAG,"Flv: Unsupported AAC data type "+te.packetType)}else if(P===2){if(!z.codec){var Te=this._parseMP3AudioData(d,l+1,p-1,!0);if(Te==null)return;z.audioSampleRate=Te.samplingRate,z.channelCount=Te.channelCount,z.codec=Te.codec,z.originalCodec=Te.originalCodec,z.refSampleDuration=1152/z.audioSampleRate*z.timescale,b.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",z);var he=this._mediaInfo;he.audioCodec=z.codec,he.audioSampleRate=z.audioSampleRate,he.audioChannelCount=z.channelCount,he.audioDataRate=Te.bitRate,he.hasVideo?he.videoCodec!=null&&(he.mimeType='video/x-flv; codecs="'+he.videoCodec+","+he.audioCodec+'"'):he.mimeType='video/x-flv; codecs="'+he.audioCodec+'"',he.isComplete()&&this._onMediaInfo(he)}var Ne=this._parseMP3AudioData(d,l+1,p-1,!1);if(Ne==null)return;var ve=this._timestampBase+y,Fe={unit:Ne,length:Ne.byteLength,dts:ve,pts:ve};Z.samples.push(Fe),Z.length+=Ne.length}}else this._onError(m.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+O)}else this._onError(m.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+P)}}},{key:"_parseAACAudioData",value:function(d,l,p){if(!(p<=1)){var y={},A=new Uint8Array(d,l,p);return y.packetType=A[0],A[0]===0?y.data=this._parseAACAudioSpecificConfig(d,l+1,p-1):y.data=A.subarray(1),y}b.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")}},{key:"_parseAACAudioSpecificConfig",value:function(d,l,p){var y,A,P=new Uint8Array(d,l,p),U=null,O=0,V=null;if(O=y=P[0]>>>3,(A=(7&P[0])<<1|P[1]>>>7)<0||A>=this._mpegSamplingRates.length)this._onError(m.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var z=this._mpegSamplingRates[A],Z=(120&P[1])>>>3;if(!(Z<0||Z>=8)){O===5&&(V=(7&P[1])<<1|P[2]>>>7,(124&P[2])>>>2);var te=self.navigator.userAgent.toLowerCase();return te.indexOf("firefox")!==-1?A>=6?(O=5,U=new Array(4),V=A-3):(O=2,U=new Array(2),V=A):te.indexOf("android")!==-1?(O=2,U=new Array(2),V=A):(O=5,V=A,U=new Array(4),A>=6?V=A-3:Z===1&&(O=2,U=new Array(2),V=A)),U[0]=O<<3,U[0]|=(15&A)>>>1,U[1]=(15&A)<<7,U[1]|=(15&Z)<<3,O===5&&(U[1]|=(15&V)>>>1,U[2]=(1&V)<<7,U[2]|=8,U[3]=0),{config:U,samplingRate:z,channelCount:Z,codec:"mp4a.40."+O,originalCodec:"mp4a.40."+y}}this._onError(m.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}}},{key:"_parseMP3AudioData",value:function(d,l,p,y){if(!(p<4)){this._littleEndian;var A=new Uint8Array(d,l,p),P=null;if(y){if(A[0]!==255)return;var U=A[1]>>>3&3,O=(6&A[1])>>1,V=(240&A[2])>>>4,z=(12&A[2])>>>2,Z=(A[3]>>>6&3)!==3?2:1,te=0,se=0;switch(U){case 0:te=this._mpegAudioV25SampleRateTable[z];break;case 2:te=this._mpegAudioV20SampleRateTable[z];break;case 3:te=this._mpegAudioV10SampleRateTable[z]}switch(O){case 1:V<this._mpegAudioL3BitRateTable.length&&(se=this._mpegAudioL3BitRateTable[V]);break;case 2:V<this._mpegAudioL2BitRateTable.length&&(se=this._mpegAudioL2BitRateTable[V]);break;case 3:V<this._mpegAudioL1BitRateTable.length&&(se=this._mpegAudioL1BitRateTable[V])}P={bitRate:se,samplingRate:te,channelCount:Z,codec:"mp3",originalCodec:"mp3"}}else P=A;return P}b.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")}},{key:"_parseVideoData",value:function(d,l,p,y,A){if(p<=1)b.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var P=new Uint8Array(d,l,p)[0],U=(240&P)>>>4,O=15&P;O===7?this._parseAVCVideoPacket(d,l+1,p-1,y,A,U):this._onError(m.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+O)}}},{key:"_parseAVCVideoPacket",value:function(d,l,p,y,A,P){if(p<4)b.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var U=this._littleEndian,O=new DataView(d,l,p),V=O.getUint8(0),z=(16777215&O.getUint32(0,!U))<<8>>8;if(V===0)this._parseAVCDecoderConfigurationRecord(d,l+4,p-4);else if(V===1)this._parseAVCVideoData(d,l+4,p-4,y,A,P,z);else if(V!==2)return void this._onError(m.default.FORMAT_ERROR,"Flv: Invalid video packet type "+V)}}},{key:"_parseAVCDecoderConfigurationRecord",value:function(d,l,p){if(p<7)b.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var y=this._videoMetadata,A=this._videoTrack,P=this._littleEndian,U=new DataView(d,l,p);if(y){if(y.avcc!==void 0)return void b.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!")}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(y=this._videoMetadata={}).type="video",y.id=A.id,y.timescale=this._timescale,y.duration=this._duration;var O=U.getUint8(0),V=U.getUint8(1);if(U.getUint8(2),U.getUint8(3),O===1&&V!==0)if(this._naluLengthSize=1+(3&U.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var z=31&U.getUint8(5);if(z!==0){z>1&&b.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+z);for(var Z=6,te=0;te<z;te++){var se=U.getUint16(Z,!P);if(Z+=2,se!==0){var ue=new Uint8Array(d,l+Z,se);Z+=se;var de=f.default.parseSPS(ue);if(te===0){y.codecWidth=de.codec_size.width,y.codecHeight=de.codec_size.height,y.presentWidth=de.present_size.width,y.presentHeight=de.present_size.height,y.profile=de.profile_string,y.level=de.level_string,y.bitDepth=de.bit_depth,y.chromaFormat=de.chroma_format,y.sarRatio=de.sar_ratio,y.frameRate=de.frame_rate,de.frame_rate.fixed!==!1&&de.frame_rate.fps_num!==0&&de.frame_rate.fps_den!==0||(y.frameRate=this._referenceFrameRate);var ke=y.frameRate.fps_den,Te=y.frameRate.fps_num;y.refSampleDuration=y.timescale*(ke/Te);for(var he=ue.subarray(1,4),Ne="avc1.",ve=0;ve<3;ve++){var Fe=he[ve].toString(16);Fe.length<2&&(Fe="0"+Fe),Ne+=Fe}y.codec=Ne;var Oe=this._mediaInfo;Oe.width=y.codecWidth,Oe.height=y.codecHeight,Oe.fps=y.frameRate.fps,Oe.profile=y.profile,Oe.level=y.level,Oe.refFrames=de.ref_frames,Oe.chromaFormat=de.chroma_format_string,Oe.sarNum=y.sarRatio.width,Oe.sarDen=y.sarRatio.height,Oe.videoCodec=Ne,Oe.hasAudio?Oe.audioCodec!=null&&(Oe.mimeType='video/x-flv; codecs="'+Oe.videoCodec+","+Oe.audioCodec+'"'):Oe.mimeType='video/x-flv; codecs="'+Oe.videoCodec+'"',Oe.isComplete()&&this._onMediaInfo(Oe)}}}var Ve=U.getUint8(Z);if(Ve!==0){Ve>1&&b.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Ve),Z++;for(var Ce=0;Ce<Ve;Ce++){var ze=U.getUint16(Z,!P);Z+=2,ze!==0&&(Z+=ze)}y.avcc=new Uint8Array(p),y.avcc.set(new Uint8Array(d,l,p),0),b.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",y)}else this._onError(m.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(m.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(m.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}}},{key:"_parseAVCVideoData",value:function(d,l,p,y,A,P,U){for(var O=this._littleEndian,V=new DataView(d,l,p),z=[],Z=0,te=0,se=this._naluLengthSize,ue=this._timestampBase+y,de=P===1;te<p;){if(te+4>=p){b.default.w(this.TAG,"Malformed Nalu near timestamp "+ue+", offset = "+te+", dataSize = "+p);break}var ke=V.getUint32(te,!O);if(se===3&&(ke>>>=8),ke>p-se)return void b.default.w(this.TAG,"Malformed Nalus near timestamp "+ue+", NaluSize > DataSize!");var Te=31&V.getUint8(te+se);Te===5&&(de=!0);var he=new Uint8Array(d,l+te,se+ke),Ne={type:Te,data:he};z.push(Ne),Z+=he.byteLength,te+=se+ke}if(z.length){var ve=this._videoTrack,Fe={units:z,length:Z,isKeyframe:de,dts:ue,cts:U,pts:ue+U};de&&(Fe.fileposition=A),ve.samples.push(Fe),ve.length+=Z}}},{key:"onTrackMetadata",get:function(){return this._onTrackMetadata},set:function(d){this._onTrackMetadata=d}},{key:"onMediaInfo",get:function(){return this._onMediaInfo},set:function(d){this._onMediaInfo=d}},{key:"onMetaDataArrived",get:function(){return this._onMetaDataArrived},set:function(d){this._onMetaDataArrived=d}},{key:"onScriptDataArrived",get:function(){return this._onScriptDataArrived},set:function(d){this._onScriptDataArrived=d}},{key:"onError",get:function(){return this._onError},set:function(d){this._onError=d}},{key:"onDataAvailable",get:function(){return this._onDataAvailable},set:function(d){this._onDataAvailable=d}},{key:"timestampBase",get:function(){return this._timestampBase},set:function(d){this._timestampBase=d}},{key:"overridedDuration",get:function(){return this._duration},set:function(d){this._durationOverrided=!0,this._duration=d,this._mediaInfo.duration=d}},{key:"overridedHasAudio",set:function(d){this._hasAudioFlagOverrided=!0,this._hasAudio=d,this._mediaInfo.hasAudio=d}},{key:"overridedHasVideo",set:function(d){this._hasVideoFlagOverrided=!0,this._hasVideo=d,this._mediaInfo.hasVideo=d}}],[{key:"probe",value:function(d){var l=new Uint8Array(d),p={match:!1};if(l[0]!==70||l[1]!==76||l[2]!==86||l[3]!==1)return p;var y,A,P=(4&l[4])>>>2!=0,U=(1&l[4])!=0,O=(y=l)[A=5]<<24|y[A+1]<<16|y[A+2]<<8|y[A+3];return O<9?p:{match:!0,consumed:O,dataOffset:O,hasAudioTrack:P,hasVideoTrack:U}}}]),g}();N.default=w},{"../core/media-info.js":7,"../utils/exception.js":40,"../utils/logger.js":41,"./amf-parser.js":15,"./demux-errors.js":16,"./sps-parser.js":19}],19:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D,I=function(){function m(c,T){for(var S=0;S<T.length;S++){var w=T[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}return function(c,T,S){return T&&m(c.prototype,T),S&&m(c,S),c}}(),b=L("./exp-golomb.js"),_=(D=b)&&D.__esModule?D:{default:D},f=function(){function m(){(function(c,T){if(!(c instanceof T))throw new TypeError("Cannot call a class as a function")})(this,m)}return I(m,null,[{key:"_ebsp2rbsp",value:function(c){for(var T=c,S=T.byteLength,w=new Uint8Array(S),g=0,d=0;d<S;d++)d>=2&&T[d]===3&&T[d-1]===0&&T[d-2]===0||(w[g]=T[d],g++);return new Uint8Array(w.buffer,0,g)}},{key:"parseSPS",value:function(c){var T=m._ebsp2rbsp(c),S=new _.default(T);S.readByte();var w=S.readByte();S.readByte();var g=S.readByte();S.readUEG();var d=m.getProfileString(w),l=m.getLevelString(g),p=1,y=420,A=8;if((w===100||w===110||w===122||w===244||w===44||w===83||w===86||w===118||w===128||w===138||w===144)&&((p=S.readUEG())===3&&S.readBits(1),p<=3&&(y=[0,420,422,444][p]),A=S.readUEG()+8,S.readUEG(),S.readBits(1),S.readBool()))for(var P=p!==3?8:12,U=0;U<P;U++)S.readBool()&&(U<6?m._skipScalingList(S,16):m._skipScalingList(S,64));S.readUEG();var O=S.readUEG();if(O===0)S.readUEG();else if(O===1){S.readBits(1),S.readSEG(),S.readSEG();for(var V=S.readUEG(),z=0;z<V;z++)S.readSEG()}var Z=S.readUEG();S.readBits(1);var te=S.readUEG(),se=S.readUEG(),ue=S.readBits(1);ue===0&&S.readBits(1),S.readBits(1);var de=0,ke=0,Te=0,he=0;S.readBool()&&(de=S.readUEG(),ke=S.readUEG(),Te=S.readUEG(),he=S.readUEG());var Ne=1,ve=1,Fe=0,Oe=!0,Ve=0,Ce=0;if(S.readBool()){if(S.readBool()){var ze=S.readByte();ze>0&&ze<16?(Ne=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][ze-1],ve=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][ze-1]):ze===255&&(Ne=S.readByte()<<8|S.readByte(),ve=S.readByte()<<8|S.readByte())}if(S.readBool()&&S.readBool(),S.readBool()&&(S.readBits(4),S.readBool()&&S.readBits(24)),S.readBool()&&(S.readUEG(),S.readUEG()),S.readBool()){var tt=S.readBits(32),ct=S.readBits(32);Oe=S.readBool(),Fe=(Ve=ct)/(Ce=2*tt)}}var Ge=1;Ne===1&&ve===1||(Ge=Ne/ve);var He=0,rt=0;p===0?(He=1,rt=2-ue):(He=p===3?1:2,rt=(p===1?2:1)*(2-ue));var De=16*(te+1),re=16*(se+1)*(2-ue);De-=(de+ke)*He,re-=(Te+he)*rt;var ae=Math.ceil(De*Ge);return S.destroy(),S=null,{profile_string:d,level_string:l,bit_depth:A,ref_frames:Z,chroma_format:y,chroma_format_string:m.getChromaFormatString(y),frame_rate:{fixed:Oe,fps:Fe,fps_den:Ce,fps_num:Ve},sar_ratio:{width:Ne,height:ve},codec_size:{width:De,height:re},present_size:{width:ae,height:re}}}},{key:"_skipScalingList",value:function(c,T){for(var S=8,w=8,g=0;g<T;g++)w!==0&&(w=(S+c.readSEG()+256)%256),S=w===0?S:w}},{key:"getProfileString",value:function(c){switch(c){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(c){return(c/10).toFixed(1)}},{key:"getChromaFormatString",value:function(c){switch(c){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}}]),m}();N.default=f},{"./exp-golomb.js":17}],20:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},I=g(L("./utils/polyfill.js")),b=g(L("./core/features.js")),_=L("./io/loader.js"),f=g(L("./player/flv-player.js")),m=g(L("./player/native-player.js")),c=g(L("./player/player-events.js")),T=L("./player/player-errors.js"),S=g(L("./utils/logging-control.js")),w=L("./utils/exception.js");function g(l){return l&&l.__esModule?l:{default:l}}I.default.install();var d={createPlayer:function(l,p){var y=l;if(y==null||(y===void 0?"undefined":D(y))!=="object")throw new w.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!y.hasOwnProperty("type"))throw new w.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(y.type){case"flv":return new f.default(y,p);default:return new m.default(y,p)}},isSupported:function(){return b.default.supportMSEH264Playback()},getFeatureList:function(){return b.default.getFeatureList()}};d.BaseLoader=_.BaseLoader,d.LoaderStatus=_.LoaderStatus,d.LoaderErrors=_.LoaderErrors,d.Events=c.default,d.ErrorTypes=T.ErrorTypes,d.ErrorDetails=T.ErrorDetails,d.FlvPlayer=f.default,d.NativePlayer=m.default,d.LoggingControl=S.default,d.reconnect=!1,Object.defineProperty(d,"version",{enumerable:!0,get:function(){return"1.4.2"}}),N.default=d},{"./core/features.js":6,"./io/loader.js":24,"./player/flv-player.js":32,"./player/native-player.js":33,"./player/player-errors.js":34,"./player/player-events.js":35,"./utils/exception.js":40,"./utils/logging-control.js":42,"./utils/polyfill.js":43}],21:[function(L,q,N){"use strict";q.exports=L("./flv.js").default},{"./flv.js":20}],22:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},I=function(){function T(S,w){for(var g=0;g<w.length;g++){var d=w[g];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(S,d.key,d)}}return function(S,w,g){return w&&T(S.prototype,w),g&&T(S,g),S}}(),b=(m(L("../utils/logger.js")),m(L("../utils/browser.js"))),_=L("./loader.js"),f=L("../utils/exception.js");function m(T){return T&&T.__esModule?T:{default:T}}var c=function(T){function S(w,g){(function(l,p){if(!(l instanceof p))throw new TypeError("Cannot call a class as a function")})(this,S);var d=function(l,p){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!p||typeof p!="object"&&typeof p!="function"?l:p}(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,"fetch-stream-loader"));return d.TAG="FetchStreamLoader",d._seekHandler=w,d._config=g,d._needStash=!0,d._requestAbort=!1,d._contentLength=null,d._receivedLength=0,d}return function(w,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);w.prototype=Object.create(g&&g.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(w,g):w.__proto__=g)}(S,_.BaseLoader),I(S,null,[{key:"isSupported",value:function(){try{var w=b.default.msedge&&b.default.version.minor>=15048,g=!b.default.msedge||w;return self.fetch&&self.ReadableStream&&g}catch{return!1}}}]),I(S,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),function w(g,d,l){g===null&&(g=Function.prototype);var p=Object.getOwnPropertyDescriptor(g,d);if(p===void 0){var y=Object.getPrototypeOf(g);return y===null?void 0:w(y,d,l)}if("value"in p)return p.value;var A=p.get;return A!==void 0?A.call(l):void 0}(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"destroy",this).call(this)}},{key:"open",value:function(w,g){var d=this;this._dataSource=w,this._range=g;var l=w.url;this._config.reuseRedirectedURL&&w.redirectedURL!=null&&(l=w.redirectedURL);var p=this._seekHandler.getConfig(l,g),y=new self.Headers;if(D(p.headers)==="object"){var A=p.headers;for(var P in A)A.hasOwnProperty(P)&&y.append(P,A[P])}var U={method:"GET",headers:y,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(D(this._config.headers)==="object")for(var O in this._config.headers)y.append(O,this._config.headers[O]);w.cors===!1&&(U.mode="same-origin"),w.withCredentials&&(U.credentials="include"),w.referrerPolicy&&(U.referrerPolicy=w.referrerPolicy),this._status=_.LoaderStatus.kConnecting,self.fetch(p.url,U).then(function(V){if(d._requestAbort){try{var z=V.body.getReader();z&&z.cancel()}catch{}return d._requestAbort=!1,void(d._status=_.LoaderStatus.kIdle)}if(V.ok&&V.status>=200&&V.status<=299){if(V.url!==p.url&&d._onURLRedirect){var Z=d._seekHandler.removeURLParameters(V.url);d._onURLRedirect(Z)}var te=V.headers.get("Content-Length");return te!=null&&(d._contentLength=parseInt(te),d._contentLength!==0&&d._onContentLengthKnown&&d._onContentLengthKnown(d._contentLength)),d._pump.call(d,V.body.getReader())}if(d._status=_.LoaderStatus.kError,!d._onError)throw new f.RuntimeException("FetchStreamLoader: Http code invalid, "+V.status+" "+V.statusText);d._onError(_.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:V.status,msg:V.statusText})}).catch(function(V){if(d._status=_.LoaderStatus.kError,!d._onError)throw V;d._onError(_.LoaderErrors.EXCEPTION,{code:-1,msg:V.message})})}},{key:"abort",value:function(){this._requestAbort=!0}},{key:"_pump",value:function(w){var g=this;return w.read().then(function(d){if(d.done)if(g._contentLength!==null&&g._receivedLength<g._contentLength){g._status=_.LoaderStatus.kError;var l=_.LoaderErrors.EARLY_EOF,p={code:-1,msg:"Fetch stream meet Early-EOF"};if(!g._onError)throw new f.RuntimeException(p.msg);g._onError(l,p)}else g._status=_.LoaderStatus.kComplete,g._onComplete&&g._onComplete(g._range.from,g._range.from+g._receivedLength-1);else{if(g._requestAbort===!0)return g._requestAbort=!1,g._status=_.LoaderStatus.kComplete,w.cancel();g._status=_.LoaderStatus.kBuffering;var y=d.value.buffer,A=g._range.from+g._receivedLength;g._receivedLength+=y.byteLength,g._onDataArrival&&g._onDataArrival(y,A,g._receivedLength),g._pump(w)}}).catch(function(d){if(d.code!==11||!b.default.msedge){g._status=_.LoaderStatus.kError;var l=0,p=null;if(d.code!==19&&d.message!=="network error"||!(g._contentLength===null||g._contentLength!==null&&g._receivedLength<g._contentLength)?(l=_.LoaderErrors.EXCEPTION,p={code:d.code,msg:d.message}):(l=_.LoaderErrors.EARLY_EOF,p={code:d.code,msg:"Fetch stream meet Early-EOF"}),!g._onError)throw new f.RuntimeException(p.msg);g._onError(l,p)}})}}]),S}();N.default=c},{"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],23:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function p(y,A){for(var P=0;P<A.length;P++){var U=A[P];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(y,U.key,U)}}return function(y,A,P){return A&&p(y.prototype,A),P&&p(y,P),y}}(),I=d(L("../utils/logger.js")),b=d(L("./speed-sampler.js")),_=L("./loader.js"),f=d(L("./fetch-stream-loader.js")),m=d(L("./xhr-moz-chunked-loader.js")),c=(d(L("./xhr-msstream-loader.js")),d(L("./xhr-range-loader.js"))),T=d(L("./websocket-loader.js")),S=d(L("./range-seek-handler.js")),w=d(L("./param-seek-handler.js")),g=L("../utils/exception.js");function d(p){return p&&p.__esModule?p:{default:p}}var l=function(){function p(y,A,P){(function(U,O){if(!(U instanceof O))throw new TypeError("Cannot call a class as a function")})(this,p),this.TAG="IOController",this._config=A,this._extraData=P,this._stashInitialSize=393216,A.stashInitialSize!=null&&A.stashInitialSize>0&&(this._stashInitialSize=A.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,A.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=y,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(y.url),this._refTotalLength=y.filesize?y.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new b.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return D(p,[{key:"destroy",value:function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null}},{key:"isWorking",value:function(){return this._loader&&this._loader.isWorking()&&!this._paused}},{key:"isPaused",value:function(){return this._paused}},{key:"_selectSeekHandler",value:function(){var y=this._config;if(y.seekType==="range")this._seekHandler=new S.default(this._config.rangeLoadZeroStart);else if(y.seekType==="param"){var A=y.seekParamStart||"bstart",P=y.seekParamEnd||"bend";this._seekHandler=new w.default(A,P)}else{if(y.seekType!=="custom")throw new g.InvalidArgumentException("Invalid seekType in config: "+y.seekType);if(typeof y.customSeekHandler!="function")throw new g.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new y.customSeekHandler}}},{key:"_selectLoader",value:function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=T.default;else if(f.default.isSupported())this._loaderClass=f.default;else if(m.default.isSupported())this._loaderClass=m.default;else{if(!c.default.isSupported())throw new g.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=c.default}}},{key:"_createLoader",value:function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)}},{key:"open",value:function(y){this._currentRange={from:0,to:-1},y&&(this._currentRange.from=y),this._speedSampler.reset(),y||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))}},{key:"abort",value:function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)}},{key:"pause",value:function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)}},{key:"resume",value:function(){if(this._paused){this._paused=!1;var y=this._resumeFrom;this._resumeFrom=0,this._internalSeek(y,!0)}}},{key:"seek",value:function(y){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(y,!0)}},{key:"_internalSeek",value:function(y,A){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(A),this._loader.destroy(),this._loader=null;var P={from:y,to:-1};this._currentRange={from:P.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,P),this._onSeeked&&this._onSeeked()}},{key:"updateUrl",value:function(y){if(!y||typeof y!="string"||y.length===0)throw new g.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=y}},{key:"_expandBuffer",value:function(y){for(var A=this._stashSize;A+1048576<y;)A*=2;if((A+=1048576)!==this._bufferSize){var P=new ArrayBuffer(A);if(this._stashUsed>0){var U=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(P,0,A).set(U,0)}this._stashBuffer=P,this._bufferSize=A}}},{key:"_normalizeSpeed",value:function(y){var A=this._speedNormalizeList,P=A.length-1,U=0,O=0,V=P;if(y<A[0])return A[0];for(;O<=V;){if((U=O+Math.floor((V-O)/2))===P||y>=A[U]&&y<A[U+1])return A[U];A[U]<y?O=U+1:V=U-1}}},{key:"_adjustStashSize",value:function(y){var A=0;(A=this._config.isLive||y<512?y:y>=512&&y<=1024?Math.floor(1.5*y):2*y)>8192&&(A=8192);var P=1024*A+1048576;this._bufferSize<P&&this._expandBuffer(P),this._stashSize=1024*A}},{key:"_dispatchChunks",value:function(y,A){return this._currentRange.to=A+y.byteLength-1,this._onDataArrival(y,A)}},{key:"_onURLRedirect",value:function(y){this._redirectedURL=y,this._onRedirect&&this._onRedirect(y)}},{key:"_onContentLengthKnown",value:function(y){y&&this._fullRequestFlag&&(this._totalLength=y,this._fullRequestFlag=!1)}},{key:"_onLoaderChunkArrival",value:function(y,A,P){if(!this._onDataArrival)throw new g.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(y.byteLength);var U=this._speedSampler.lastSecondKBps;if(U!==0){var O=this._normalizeSpeed(U);this._speedNormalized!==O&&(this._speedNormalized=O,this._adjustStashSize(O))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=A),this._stashUsed+y.byteLength<=this._stashSize)new Uint8Array(this._stashBuffer,0,this._stashSize).set(new Uint8Array(y),this._stashUsed),this._stashUsed+=y.byteLength;else{var V=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var z=this._stashBuffer.slice(0,this._stashUsed),Z=this._dispatchChunks(z,this._stashByteStart);if(Z<z.byteLength){if(Z>0){var te=new Uint8Array(z,Z);V.set(te,0),this._stashUsed=te.byteLength,this._stashByteStart+=Z}}else this._stashUsed=0,this._stashByteStart+=Z;this._stashUsed+y.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+y.byteLength),V=new Uint8Array(this._stashBuffer,0,this._bufferSize)),V.set(new Uint8Array(y),this._stashUsed),this._stashUsed+=y.byteLength}else{var se=this._dispatchChunks(y,A);if(se<y.byteLength){var ue=y.byteLength-se;ue>this._bufferSize&&(this._expandBuffer(ue),V=new Uint8Array(this._stashBuffer,0,this._bufferSize)),V.set(new Uint8Array(y,se),0),this._stashUsed+=ue,this._stashByteStart=A+se}}}else if(this._stashUsed===0){var de=this._dispatchChunks(y,A);if(de<y.byteLength){var ke=y.byteLength-de;ke>this._bufferSize&&this._expandBuffer(ke),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(y,de),0),this._stashUsed+=ke,this._stashByteStart=A+de}}else{this._stashUsed+y.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+y.byteLength);var Te=new Uint8Array(this._stashBuffer,0,this._bufferSize);Te.set(new Uint8Array(y),this._stashUsed),this._stashUsed+=y.byteLength;var he=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(he<this._stashUsed&&he>0){var Ne=new Uint8Array(this._stashBuffer,he);Te.set(Ne,0)}this._stashUsed-=he,this._stashByteStart+=he}}}},{key:"_flushStashBuffer",value:function(y){if(this._stashUsed>0){var A=this._stashBuffer.slice(0,this._stashUsed),P=this._dispatchChunks(A,this._stashByteStart),U=A.byteLength-P;if(P<A.byteLength){if(!y){if(P>0){var O=new Uint8Array(this._stashBuffer,0,this._bufferSize),V=new Uint8Array(A,P);O.set(V,0),this._stashUsed=V.byteLength,this._stashByteStart+=P}return 0}I.default.w(this.TAG,U+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,U}return 0}},{key:"_onLoaderComplete",value:function(y,A){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)}},{key:"_onLoaderError",value:function(y,A){switch(I.default.e(this.TAG,"Loader error, code = "+A.code+", msg = "+A.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,y=_.LoaderErrors.UNRECOVERABLE_EARLY_EOF),y){case _.LoaderErrors.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var P=this._currentRange.to+1;return void(P<this._totalLength&&(I.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(P,!1)))}y=_.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break;case _.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case _.LoaderErrors.CONNECTING_TIMEOUT:case _.LoaderErrors.HTTP_STATUS_CODE_INVALID:case _.LoaderErrors.EXCEPTION:}if(!this._onError)throw new g.RuntimeException("IOException: "+A.msg);this._onError(y,A)}},{key:"status",get:function(){return this._loader.status}},{key:"extraData",get:function(){return this._extraData},set:function(y){this._extraData=y}},{key:"onDataArrival",get:function(){return this._onDataArrival},set:function(y){this._onDataArrival=y}},{key:"onSeeked",get:function(){return this._onSeeked},set:function(y){this._onSeeked=y}},{key:"onError",get:function(){return this._onError},set:function(y){this._onError=y}},{key:"onComplete",get:function(){return this._onComplete},set:function(y){this._onComplete=y}},{key:"onRedirect",get:function(){return this._onRedirect},set:function(y){this._onRedirect=y}},{key:"onRecoveredEarlyEof",get:function(){return this._onRecoveredEarlyEof},set:function(y){this._onRecoveredEarlyEof=y}},{key:"currentURL",get:function(){return this._dataSource.url}},{key:"hasRedirect",get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null}},{key:"currentRedirectedURL",get:function(){return this._redirectedURL||this._dataSource.redirectedURL}},{key:"currentSpeed",get:function(){return this._loaderClass===c.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps}},{key:"loaderType",get:function(){return this._loader.type}}]),p}();N.default=l},{"../utils/exception.js":40,"../utils/logger.js":41,"./fetch-stream-loader.js":22,"./loader.js":24,"./param-seek-handler.js":25,"./range-seek-handler.js":26,"./speed-sampler.js":27,"./websocket-loader.js":28,"./xhr-moz-chunked-loader.js":29,"./xhr-msstream-loader.js":30,"./xhr-range-loader.js":31}],24:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.BaseLoader=N.LoaderErrors=N.LoaderStatus=void 0;var D=function(){function _(f,m){for(var c=0;c<m.length;c++){var T=m[c];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(f,T.key,T)}}return function(f,m,c){return m&&_(f.prototype,m),c&&_(f,c),f}}(),I=L("../utils/exception.js"),b=N.LoaderStatus={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4};N.LoaderErrors={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},N.BaseLoader=function(){function _(f){(function(m,c){if(!(m instanceof c))throw new TypeError("Cannot call a class as a function")})(this,_),this._type=f||"undefined",this._status=b.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return D(_,[{key:"destroy",value:function(){this._status=b.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}},{key:"isWorking",value:function(){return this._status===b.kConnecting||this._status===b.kBuffering}},{key:"open",value:function(f,m){throw new I.NotImplementedException("Unimplemented abstract function!")}},{key:"abort",value:function(){throw new I.NotImplementedException("Unimplemented abstract function!")}},{key:"type",get:function(){return this._type}},{key:"status",get:function(){return this._status}},{key:"needStashBuffer",get:function(){return this._needStash}},{key:"onContentLengthKnown",get:function(){return this._onContentLengthKnown},set:function(f){this._onContentLengthKnown=f}},{key:"onURLRedirect",get:function(){return this._onURLRedirect},set:function(f){this._onURLRedirect=f}},{key:"onDataArrival",get:function(){return this._onDataArrival},set:function(f){this._onDataArrival=f}},{key:"onError",get:function(){return this._onError},set:function(f){this._onError=f}},{key:"onComplete",get:function(){return this._onComplete},set:function(f){this._onComplete=f}}]),_}()},{"../utils/exception.js":40}],25:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(_,f){(function(m,c){if(!(m instanceof c))throw new TypeError("Cannot call a class as a function")})(this,b),this._startName=_,this._endName=f}return D(b,[{key:"getConfig",value:function(_,f){var m=_;if(f.from!==0||f.to!==-1){var c=!0;m.indexOf("?")===-1&&(m+="?",c=!1),c&&(m+="&"),m+=this._startName+"="+f.from.toString(),f.to!==-1&&(m+="&"+this._endName+"="+f.to.toString())}return{url:m,headers:{}}}},{key:"removeURLParameters",value:function(_){var f=_.split("?")[0],m=void 0,c=_.indexOf("?");c!==-1&&(m=_.substring(c+1));var T="";if(m!=null&&m.length>0)for(var S=m.split("&"),w=0;w<S.length;w++){var g=S[w].split("="),d=w>0;g[0]!==this._startName&&g[0]!==this._endName&&(d&&(T+="&"),T+=S[w])}return T.length===0?f:f+"?"+T}}]),b}();N.default=I},{}],26:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(_){(function(f,m){if(!(f instanceof m))throw new TypeError("Cannot call a class as a function")})(this,b),this._zeroStart=_||!1}return D(b,[{key:"getConfig",value:function(_,f){var m={};if(f.from!==0||f.to!==-1){var c=void 0;c=f.to!==-1?"bytes="+f.from.toString()+"-"+f.to.toString():"bytes="+f.from.toString()+"-",m.Range=c}else this._zeroStart&&(m.Range="bytes=0-");return{url:_,headers:m}}},{key:"removeURLParameters",value:function(_){return _}}]),b}();N.default=I},{}],27:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(){(function(_,f){if(!(_ instanceof f))throw new TypeError("Cannot call a class as a function")})(this,b),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return D(b,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}},{key:"addBytes",value:function(_){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=_,this._totalBytes+=_):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=_,this._totalBytes+=_):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=_,this._totalBytes+=_,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var _=(this._now()-this._lastCheckpoint)/1e3;return _==0&&(_=1),this._intervalBytes/_/1024}},{key:"lastSecondKBps",get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}},{key:"averageKBps",get:function(){var _=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/_/1024}}]),b}();N.default=I},{}],28:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D,I=function(){function c(T,S){for(var w=0;w<S.length;w++){var g=S[w];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(T,g.key,g)}}return function(T,S,w){return S&&c(T.prototype,S),w&&c(T,w),T}}(),b=L("../utils/logger.js"),_=((D=b)&&D.__esModule,L("./loader.js")),f=L("../utils/exception.js"),m=function(c){function T(){(function(w,g){if(!(w instanceof g))throw new TypeError("Cannot call a class as a function")})(this,T);var S=function(w,g){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||typeof g!="object"&&typeof g!="function"?w:g}(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,"websocket-loader"));return S.TAG="WebSocketLoader",S._needStash=!0,S._ws=null,S._requestAbort=!1,S._receivedLength=0,S}return function(S,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);S.prototype=Object.create(w&&w.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(S,w):S.__proto__=w)}(T,_.BaseLoader),I(T,null,[{key:"isSupported",value:function(){try{return self.WebSocket!==void 0}catch{return!1}}}]),I(T,[{key:"destroy",value:function(){this._ws&&this.abort(),function S(w,g,d){w===null&&(w=Function.prototype);var l=Object.getOwnPropertyDescriptor(w,g);if(l===void 0){var p=Object.getPrototypeOf(w);return p===null?void 0:S(p,g,d)}if("value"in l)return l.value;var y=l.get;return y!==void 0?y.call(d):void 0}(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"destroy",this).call(this)}},{key:"open",value:function(S){try{var w=this._ws=new self.WebSocket(S.url);w.binaryType="arraybuffer",w.onopen=this._onWebSocketOpen.bind(this),w.onclose=this._onWebSocketClose.bind(this),w.onmessage=this._onWebSocketMessage.bind(this),w.onerror=this._onWebSocketError.bind(this),this._status=_.LoaderStatus.kConnecting}catch(d){this._status=_.LoaderStatus.kError;var g={code:d.code,msg:d.message};if(!this._onError)throw new f.RuntimeException(g.msg);this._onError(_.LoaderErrors.EXCEPTION,g)}}},{key:"abort",value:function(){var S=this._ws;!S||S.readyState!==0&&S.readyState!==1||(this._requestAbort=!0,S.close()),this._ws=null,this._status=_.LoaderStatus.kComplete}},{key:"_onWebSocketOpen",value:function(S){this._status=_.LoaderStatus.kBuffering}},{key:"_onWebSocketClose",value:function(S){this._requestAbort!==!0?(this._status=_.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1}},{key:"_onWebSocketMessage",value:function(S){var w=this;if(S.data instanceof ArrayBuffer)this._dispatchArrayBuffer(S.data);else if(S.data instanceof Blob){var g=new FileReader;g.onload=function(){w._dispatchArrayBuffer(g.result)},g.readAsArrayBuffer(S.data)}else{this._status=_.LoaderStatus.kError;var d={code:-1,msg:"Unsupported WebSocket message type: "+S.data.constructor.name};if(!this._onError)throw new f.RuntimeException(d.msg);this._onError(_.LoaderErrors.EXCEPTION,d)}}},{key:"_dispatchArrayBuffer",value:function(S){var w=S,g=this._receivedLength;this._receivedLength+=w.byteLength,this._onDataArrival&&this._onDataArrival(w,g,this._receivedLength)}},{key:"_onWebSocketError",value:function(S){this._status=_.LoaderStatus.kError;var w={code:S.code,msg:S.message};if(!this._onError)throw new f.RuntimeException(w.msg);this._onError(_.LoaderErrors.EXCEPTION,w)}}]),T}();N.default=m},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],29:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D,I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},b=function(){function S(w,g){for(var d=0;d<g.length;d++){var l=g[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(w,l.key,l)}}return function(w,g,d){return g&&S(w.prototype,g),d&&S(w,d),w}}(),_=L("../utils/logger.js"),f=(D=_)&&D.__esModule?D:{default:D},m=L("./loader.js"),c=L("../utils/exception.js"),T=function(S){function w(g,d){(function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")})(this,w);var l=function(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?p:y}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,"xhr-moz-chunked-loader"));return l.TAG="MozChunkedLoader",l._seekHandler=g,l._config=d,l._needStash=!0,l._xhr=null,l._requestAbort=!1,l._contentLength=null,l._receivedLength=0,l}return function(g,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);g.prototype=Object.create(d&&d.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(g,d):g.__proto__=d)}(w,m.BaseLoader),b(w,null,[{key:"isSupported",value:function(){try{var g=new XMLHttpRequest;return g.open("GET","https://example.com",!0),g.responseType="moz-chunked-arraybuffer",g.responseType==="moz-chunked-arraybuffer"}catch(d){return f.default.w("MozChunkedLoader",d.message),!1}}}]),b(w,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),function g(d,l,p){d===null&&(d=Function.prototype);var y=Object.getOwnPropertyDescriptor(d,l);if(y===void 0){var A=Object.getPrototypeOf(d);return A===null?void 0:g(A,l,p)}if("value"in y)return y.value;var P=y.get;return P!==void 0?P.call(p):void 0}(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"destroy",this).call(this)}},{key:"open",value:function(g,d){this._dataSource=g,this._range=d;var l=g.url;this._config.reuseRedirectedURL&&g.redirectedURL!=null&&(l=g.redirectedURL);var p=this._seekHandler.getConfig(l,d);this._requestURL=p.url;var y=this._xhr=new XMLHttpRequest;if(y.open("GET",p.url,!0),y.responseType="moz-chunked-arraybuffer",y.onreadystatechange=this._onReadyStateChange.bind(this),y.onprogress=this._onProgress.bind(this),y.onloadend=this._onLoadEnd.bind(this),y.onerror=this._onXhrError.bind(this),g.withCredentials&&(y.withCredentials=!0),I(p.headers)==="object"){var A=p.headers;for(var P in A)A.hasOwnProperty(P)&&y.setRequestHeader(P,A[P])}if(I(this._config.headers)==="object"){var U=this._config.headers;for(var O in U)U.hasOwnProperty(O)&&y.setRequestHeader(O,U[O])}this._status=m.LoaderStatus.kConnecting,y.send()}},{key:"abort",value:function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=m.LoaderStatus.kComplete}},{key:"_onReadyStateChange",value:function(g){var d=g.target;if(d.readyState===2){if(d.responseURL!=null&&d.responseURL!==this._requestURL&&this._onURLRedirect){var l=this._seekHandler.removeURLParameters(d.responseURL);this._onURLRedirect(l)}if(d.status!==0&&(d.status<200||d.status>299)){if(this._status=m.LoaderStatus.kError,!this._onError)throw new c.RuntimeException("MozChunkedLoader: Http code invalid, "+d.status+" "+d.statusText);this._onError(m.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:d.status,msg:d.statusText})}else this._status=m.LoaderStatus.kBuffering}}},{key:"_onProgress",value:function(g){if(this._status!==m.LoaderStatus.kError){this._contentLength===null&&g.total!==null&&g.total!==0&&(this._contentLength=g.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var d=g.target.response,l=this._range.from+this._receivedLength;this._receivedLength+=d.byteLength,this._onDataArrival&&this._onDataArrival(d,l,this._receivedLength)}}},{key:"_onLoadEnd",value:function(g){this._requestAbort!==!0?this._status!==m.LoaderStatus.kError&&(this._status=m.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1}},{key:"_onXhrError",value:function(g){this._status=m.LoaderStatus.kError;var d=0,l=null;if(this._contentLength&&g.loaded<this._contentLength?(d=m.LoaderErrors.EARLY_EOF,l={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(d=m.LoaderErrors.EXCEPTION,l={code:-1,msg:g.constructor.name+" "+g.type}),!this._onError)throw new c.RuntimeException(l.msg);this._onError(d,l)}}]),w}();N.default=T},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],30:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D,I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},b=function(){function S(w,g){for(var d=0;d<g.length;d++){var l=g[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(w,l.key,l)}}return function(w,g,d){return g&&S(w.prototype,g),d&&S(w,d),w}}(),_=L("../utils/logger.js"),f=(D=_)&&D.__esModule?D:{default:D},m=L("./loader.js"),c=L("../utils/exception.js"),T=function(S){function w(g,d){(function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")})(this,w);var l=function(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?p:y}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,"xhr-msstream-loader"));return l.TAG="MSStreamLoader",l._seekHandler=g,l._config=d,l._needStash=!0,l._xhr=null,l._reader=null,l._totalRange=null,l._currentRange=null,l._currentRequestURL=null,l._currentRedirectedURL=null,l._contentLength=null,l._receivedLength=0,l._bufferLimit=16777216,l._lastTimeBufferSize=0,l._isReconnecting=!1,l}return function(g,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);g.prototype=Object.create(d&&d.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(g,d):g.__proto__=d)}(w,m.BaseLoader),b(w,null,[{key:"isSupported",value:function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var g=new XMLHttpRequest;return g.open("GET","https://example.com",!0),g.responseType="ms-stream",g.responseType==="ms-stream"}catch(d){return f.default.w("MSStreamLoader",d.message),!1}}}]),b(w,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),function g(d,l,p){d===null&&(d=Function.prototype);var y=Object.getOwnPropertyDescriptor(d,l);if(y===void 0){var A=Object.getPrototypeOf(d);return A===null?void 0:g(A,l,p)}if("value"in y)return y.value;var P=y.get;return P!==void 0?P.call(p):void 0}(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"destroy",this).call(this)}},{key:"open",value:function(g,d){this._internalOpen(g,d,!1)}},{key:"_internalOpen",value:function(g,d,l){this._dataSource=g,l?this._currentRange=d:this._totalRange=d;var p=g.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?p=this._currentRedirectedURL:g.redirectedURL!=null&&(p=g.redirectedURL));var y=this._seekHandler.getConfig(p,d);this._currentRequestURL=y.url;var A=this._reader=new self.MSStreamReader;A.onprogress=this._msrOnProgress.bind(this),A.onload=this._msrOnLoad.bind(this),A.onerror=this._msrOnError.bind(this);var P=this._xhr=new XMLHttpRequest;if(P.open("GET",y.url,!0),P.responseType="ms-stream",P.onreadystatechange=this._xhrOnReadyStateChange.bind(this),P.onerror=this._xhrOnError.bind(this),g.withCredentials&&(P.withCredentials=!0),I(y.headers)==="object"){var U=y.headers;for(var O in U)U.hasOwnProperty(O)&&P.setRequestHeader(O,U[O])}if(I(this._config.headers)==="object"){var V=this._config.headers;for(var z in V)V.hasOwnProperty(z)&&P.setRequestHeader(z,V[z])}this._isReconnecting?this._isReconnecting=!1:this._status=m.LoaderStatus.kConnecting,P.send()}},{key:"abort",value:function(){this._internalAbort(),this._status=m.LoaderStatus.kComplete}},{key:"_internalAbort",value:function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)}},{key:"_xhrOnReadyStateChange",value:function(g){var d=g.target;if(d.readyState===2)if(d.status>=200&&d.status<=299){if(this._status=m.LoaderStatus.kBuffering,d.responseURL!=null){var l=this._seekHandler.removeURLParameters(d.responseURL);d.responseURL!==this._currentRequestURL&&l!==this._currentRedirectedURL&&(this._currentRedirectedURL=l,this._onURLRedirect&&this._onURLRedirect(l))}var p=d.getResponseHeader("Content-Length");if(p!=null&&this._contentLength==null){var y=parseInt(p);y>0&&(this._contentLength=y,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=m.LoaderStatus.kError,!this._onError)throw new c.RuntimeException("MSStreamLoader: Http code invalid, "+d.status+" "+d.statusText);this._onError(m.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:d.status,msg:d.statusText})}else if(d.readyState===3&&d.status>=200&&d.status<=299){this._status=m.LoaderStatus.kBuffering;var A=d.response;this._reader.readAsArrayBuffer(A)}}},{key:"_xhrOnError",value:function(g){this._status=m.LoaderStatus.kError;var d=m.LoaderErrors.EXCEPTION,l={code:-1,msg:g.constructor.name+" "+g.type};if(!this._onError)throw new c.RuntimeException(l.msg);this._onError(d,l)}},{key:"_msrOnProgress",value:function(g){var d=g.target.result;if(d!=null){var l=d.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=d.byteLength;var p=this._totalRange.from+this._receivedLength;this._receivedLength+=l.byteLength,this._onDataArrival&&this._onDataArrival(l,p,this._receivedLength),d.byteLength>=this._bufferLimit&&(f.default.v(this.TAG,"MSStream buffer exceeded max size near "+(p+l.byteLength)+", reconnecting..."),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()}},{key:"_doReconnectIfNeeded",value:function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var g={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,g,!0)}}},{key:"_msrOnLoad",value:function(g){this._status=m.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)}},{key:"_msrOnError",value:function(g){this._status=m.LoaderStatus.kError;var d=0,l=null;if(this._contentLength&&this._receivedLength<this._contentLength?(d=m.LoaderErrors.EARLY_EOF,l={code:-1,msg:"MSStream meet Early-Eof"}):(d=m.LoaderErrors.EARLY_EOF,l={code:-1,msg:g.constructor.name+" "+g.type}),!this._onError)throw new c.RuntimeException(l.msg);this._onError(d,l)}}]),w}();N.default=T},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24}],31:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},I=function(){function S(w,g){for(var d=0;d<g.length;d++){var l=g[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(w,l.key,l)}}return function(w,g,d){return g&&S(w.prototype,g),d&&S(w,d),w}}(),b=c(L("../utils/logger.js")),_=c(L("./speed-sampler.js")),f=L("./loader.js"),m=L("../utils/exception.js");function c(S){return S&&S.__esModule?S:{default:S}}var T=function(S){function w(g,d){(function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")})(this,w);var l=function(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?p:y}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,"xhr-range-loader"));return l.TAG="RangeLoader",l._seekHandler=g,l._config=d,l._needStash=!1,l._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],l._currentChunkSizeKB=384,l._currentSpeedNormalized=0,l._zeroSpeedChunkCount=0,l._xhr=null,l._speedSampler=new _.default,l._requestAbort=!1,l._waitForTotalLength=!1,l._totalLengthReceived=!1,l._currentRequestURL=null,l._currentRedirectedURL=null,l._currentRequestRange=null,l._totalLength=null,l._contentLength=null,l._receivedLength=0,l._lastTimeLoaded=0,l}return function(g,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);g.prototype=Object.create(d&&d.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(g,d):g.__proto__=d)}(w,f.BaseLoader),I(w,null,[{key:"isSupported",value:function(){try{var g=new XMLHttpRequest;return g.open("GET","https://example.com",!0),g.responseType="arraybuffer",g.responseType==="arraybuffer"}catch(d){return b.default.w("RangeLoader",d.message),!1}}}]),I(w,[{key:"destroy",value:function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),function g(d,l,p){d===null&&(d=Function.prototype);var y=Object.getOwnPropertyDescriptor(d,l);if(y===void 0){var A=Object.getPrototypeOf(d);return A===null?void 0:g(A,l,p)}if("value"in y)return y.value;var P=y.get;return P!==void 0?P.call(p):void 0}(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"destroy",this).call(this)}},{key:"open",value:function(g,d){this._dataSource=g,this._range=d,this._status=f.LoaderStatus.kConnecting;var l=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(l=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||l?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))}},{key:"_openSubRange",value:function(){var g=1024*this._currentChunkSizeKB,d=this._range.from+this._receivedLength,l=d+g;this._contentLength!=null&&l-this._range.from>=this._contentLength&&(l=this._range.from+this._contentLength-1),this._currentRequestRange={from:d,to:l},this._internalOpen(this._dataSource,this._currentRequestRange)}},{key:"_internalOpen",value:function(g,d){this._lastTimeLoaded=0;var l=g.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?l=this._currentRedirectedURL:g.redirectedURL!=null&&(l=g.redirectedURL));var p=this._seekHandler.getConfig(l,d);this._currentRequestURL=p.url;var y=this._xhr=new XMLHttpRequest;if(y.open("GET",p.url,!0),y.responseType="arraybuffer",y.onreadystatechange=this._onReadyStateChange.bind(this),y.onprogress=this._onProgress.bind(this),y.onload=this._onLoad.bind(this),y.onerror=this._onXhrError.bind(this),g.withCredentials&&(y.withCredentials=!0),D(p.headers)==="object"){var A=p.headers;for(var P in A)A.hasOwnProperty(P)&&y.setRequestHeader(P,A[P])}if(D(this._config.headers)==="object"){var U=this._config.headers;for(var O in U)U.hasOwnProperty(O)&&y.setRequestHeader(O,U[O])}y.send()}},{key:"abort",value:function(){this._requestAbort=!0,this._internalAbort(),this._status=f.LoaderStatus.kComplete}},{key:"_internalAbort",value:function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)}},{key:"_onReadyStateChange",value:function(g){var d=g.target;if(d.readyState===2){if(d.responseURL!=null){var l=this._seekHandler.removeURLParameters(d.responseURL);d.responseURL!==this._currentRequestURL&&l!==this._currentRedirectedURL&&(this._currentRedirectedURL=l,this._onURLRedirect&&this._onURLRedirect(l))}if(d.status>=200&&d.status<=299){if(this._waitForTotalLength)return;this._status=f.LoaderStatus.kBuffering}else{if(this._status=f.LoaderStatus.kError,!this._onError)throw new m.RuntimeException("RangeLoader: Http code invalid, "+d.status+" "+d.statusText);this._onError(f.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:d.status,msg:d.statusText})}}}},{key:"_onProgress",value:function(g){if(this._status!==f.LoaderStatus.kError){if(this._contentLength===null){var d=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,d=!0;var l=g.total;this._internalAbort(),l!=null&l!==0&&(this._totalLength=l)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,d)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var p=g.loaded-this._lastTimeLoaded;this._lastTimeLoaded=g.loaded,this._speedSampler.addBytes(p)}}},{key:"_normalizeSpeed",value:function(g){var d=this._chunkSizeKBList,l=d.length-1,p=0,y=0,A=l;if(g<d[0])return d[0];for(;y<=A;){if((p=y+Math.floor((A-y)/2))===l||g>=d[p]&&g<d[p+1])return d[p];d[p]<g?y=p+1:A=p-1}}},{key:"_onLoad",value:function(g){if(this._status!==f.LoaderStatus.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var d=this._speedSampler.lastSecondKBps;if(d===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(d=this._speedSampler.currentKBps)),d!==0){var l=this._normalizeSpeed(d);this._currentSpeedNormalized!==l&&(this._currentSpeedNormalized=l,this._currentChunkSizeKB=l)}var p=g.target.response,y=this._range.from+this._receivedLength;this._receivedLength+=p.byteLength;var A=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():A=!0,this._onDataArrival&&this._onDataArrival(p,y,this._receivedLength),A&&(this._status=f.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}}},{key:"_onXhrError",value:function(g){this._status=f.LoaderStatus.kError;var d=0,l=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(d=f.LoaderErrors.EARLY_EOF,l={code:-1,msg:"RangeLoader meet Early-Eof"}):(d=f.LoaderErrors.EXCEPTION,l={code:-1,msg:g.constructor.name+" "+g.type}),!this._onError)throw new m.RuntimeException(l.msg);this._onError(d,l)}},{key:"currentSpeed",get:function(){return this._speedSampler.lastSecondKBps}}]),w}();N.default=T},{"../utils/exception.js":40,"../utils/logger.js":41,"./loader.js":24,"./speed-sampler.js":27}],32:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},I=function(){function A(P,U){for(var O=0;O<U.length;O++){var V=U[O];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(P,V.key,V)}}return function(P,U,O){return U&&A(P.prototype,U),O&&A(P,O),P}}(),b=p(L("events")),_=p(L("../utils/logger.js")),f=p(L("../utils/browser.js")),m=p(L("./player-events.js")),c=p(L("../core/transmuxer.js")),T=p(L("../core/transmuxing-events.js")),S=p(L("../core/mse-controller.js")),w=p(L("../core/mse-events.js")),g=L("./player-errors.js"),d=L("../config.js"),l=L("../utils/exception.js");function p(A){return A&&A.__esModule?A:{default:A}}var y=function(){function A(P,U){if(function(V,z){if(!(V instanceof z))throw new TypeError("Cannot call a class as a function")}(this,A),this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new b.default,this._config=(0,d.createDefaultConfig)(),(U===void 0?"undefined":D(U))==="object"&&Object.assign(this._config,U),P.type.toLowerCase()!=="flv")throw new l.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");P.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=P,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var O=f.default.chrome&&(f.default.version.major<50||f.default.version.major===50&&f.default.version.build<2661);this._alwaysSeekKeyframe=!!(O||f.default.msedge||f.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return I(A,[{key:"destroy",value:function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(P,U){var O=this;P===m.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){O._emitter.emit(m.default.MEDIA_INFO,O.mediaInfo)}):P===m.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){O._emitter.emit(m.default.STATISTICS_INFO,O.statisticsInfo)}),this._emitter.addListener(P,U)}},{key:"off",value:function(P,U){this._emitter.removeListener(P,U)}},{key:"attachMediaElement",value:function(P){var U=this;if(this._mediaElement=P,P.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),P.addEventListener("seeking",this.e.onvSeeking),P.addEventListener("canplay",this.e.onvCanPlay),P.addEventListener("stalled",this.e.onvStalled),P.addEventListener("progress",this.e.onvProgress),this._msectl=new S.default(this._config),this._msectl.on(w.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(w.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(w.default.SOURCE_OPEN,function(){U._mseSourceOpened=!0,U._hasPendingLoad&&(U._hasPendingLoad=!1,U.load())}),this._msectl.on(w.default.ERROR,function(O){U._emitter.emit(m.default.ERROR,g.ErrorTypes.MEDIA_ERROR,g.ErrorDetails.MEDIA_MSE_ERROR,O)}),this._msectl.attachMediaElement(P),this._pendingSeekTime!=null)try{P.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}}},{key:"detachMediaElement",value:function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)}},{key:"load",value:function(){var P=this,U=!1,O=0;if(!this._mediaElement)throw new l.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new l.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new c.default(this._mediaDataSource,this._config),this._transmuxer.on(T.default.INIT_SEGMENT,function(V,z){P._msectl.appendInitSegment(z)}),this._transmuxer.on(T.default.MEDIA_SEGMENT,function(V,z){if(P._msectl.appendMediaSegment(z),P._config.isLive&&z.type=="video"){flvjs.reconnect&&(P.dataRetryTimer&&(clearTimeout(P.dataRetryTimer),P.dataRetryTimer=0),P.dataRetryTimer=setTimeout(function(){P._mediaElement&&(P.unload(),P.load(),setTimeout(function(){P.play().catch(function(){})},1e3),console.log("reconnect"))},1e3));var Z=P._mediaElement.currentTime,te=P._mediaElement.paused,se=z.info.beginPts-1e3*Z;if(se>=3e3&&!U&&!te){if(O&&O==Z)return void(se>=5e3&&P._emitter.emit(m.default.ERROR,g.ErrorTypes.OTHER_ERROR,"got wrong timestamp ",z.info.beginPts));var ue=z.info.beginPts/1e3-1;_.default.w(P.TAG,"Live seems stuck at "+Z+", try seek to "+ue),U=!0,P._requestSetTime=!0,P.currentTime=ue,O=Z}else z.info.beginPts-1e3*Z>=2e3&&U&&(U=!1)}P._config.lazyLoad&&!P._config.isLive&&(Z=P._mediaElement.currentTime,z.info.endDts>=1e3*(Z+P._config.lazyLoadMaxDuration)&&P._progressChecker==null&&(_.default.v(P.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),P._suspendTransmuxer()))}),this._transmuxer.on(T.default.LOADING_COMPLETE,function(){P._msectl.endOfStream(),P._emitter.emit(m.default.LOADING_COMPLETE)}),this._transmuxer.on(T.default.RECOVERED_EARLY_EOF,function(){P._emitter.emit(m.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(T.default.IO_ERROR,function(V,z){P._emitter.emit(m.default.ERROR,g.ErrorTypes.NETWORK_ERROR,V,z)}),this._transmuxer.on(T.default.DEMUX_ERROR,function(V,z){P._emitter.emit(m.default.ERROR,g.ErrorTypes.MEDIA_ERROR,V,{code:-1,msg:z})}),this._transmuxer.on(T.default.MEDIA_INFO,function(V){P._mediaInfo=V,P._emitter.emit(m.default.MEDIA_INFO,Object.assign({},V))}),this._transmuxer.on(T.default.METADATA_ARRIVED,function(V){P._emitter.emit(m.default.METADATA_ARRIVED,V)}),this._transmuxer.on(T.default.SCRIPTDATA_ARRIVED,function(V){P._emitter.emit(m.default.SCRIPTDATA_ARRIVED,V)}),this._transmuxer.on(T.default.STATISTICS_INFO,function(V){P._statisticsInfo=P._fillStatisticsInfo(V),P._emitter.emit(m.default.STATISTICS_INFO,Object.assign({},P._statisticsInfo))}),this._transmuxer.on(T.default.RECOMMEND_SEEKPOINT,function(V){P._mediaElement&&!P._config.accurateSeek&&(console.log("recommend seekpoint",V/1e3),P._requestSetTime=!0,P._mediaElement.currentTime=V/1e3)}),this._transmuxer.open()))}},{key:"unload",value:function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)}},{key:"play",value:function(){return this._mediaElement.play()}},{key:"pause",value:function(){this._mediaElement.pause()}},{key:"_fillStatisticsInfo",value:function(P){if(P.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return P;var U=!0,O=0,V=0;if(this._mediaElement.getVideoPlaybackQuality){var z=this._mediaElement.getVideoPlaybackQuality();O=z.totalVideoFrames,V=z.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(O=this._mediaElement.webkitDecodedFrameCount,V=this._mediaElement.webkitDroppedFrameCount):U=!1;return U&&(P.decodedFrames=O,P.droppedFrames=V),P}},{key:"_onmseUpdateEnd",value:function(){if(this._config.lazyLoad&&!this._config.isLive){for(var P=this._mediaElement.buffered,U=this._mediaElement.currentTime,O=0,V=0;V<P.length;V++){var z=P.start(V),Z=P.end(V);if(z<=U&&U<Z){O=Z;break}}O>=U+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(_.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}}},{key:"_onmseBufferFull",value:function(){_.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()}},{key:"_suspendTransmuxer",value:function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))}},{key:"_checkProgressAndResume",value:function(){for(var P=this._mediaElement.currentTime,U=this._mediaElement.buffered,O=!1,V=0;V<U.length;V++){var z=U.start(V),Z=U.end(V);if(P>=z&&P<Z){P>=Z-this._config.lazyLoadRecoverDuration&&(O=!0);break}}O&&(window.clearInterval(this._progressChecker),this._progressChecker=null,O&&(_.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))}},{key:"_isTimepointBuffered",value:function(P){for(var U=this._mediaElement.buffered,O=0;O<U.length;O++){var V=U.start(O),z=U.end(O);if(P>=V&&P<z)return!0}return!1}},{key:"_internalSeek",value:function(P){var U=this._isTimepointBuffered(P),O=!1,V=0;if(P<1&&this._mediaElement.buffered.length>0){var z=this._mediaElement.buffered.start(0);(z<1&&P<z||f.default.safari)&&(O=!0,V=f.default.safari?.1:z)}if(O)this._requestSetTime=!0,this._mediaElement.currentTime=V;else if(U){if(this._alwaysSeekKeyframe){var Z=this._msectl.getNearestKeyframe(Math.floor(1e3*P));this._requestSetTime=!0,this._mediaElement.currentTime=Z!=null?Z.dts/1e3:P}else this._requestSetTime=!0,this._mediaElement.currentTime=P;this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(P),this._transmuxer.seek(Math.floor(1e3*P)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=P)}},{key:"_checkAndApplyUnbufferedSeekpoint",value:function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var P=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(P)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(P),this._transmuxer.seek(Math.floor(1e3*P)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=P))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},{key:"_checkAndResumeStuckPlayback",value:function(P){var U=this._mediaElement;if(P||!this._receivedCanPlay||U.readyState<2){var O=U.buffered;if(O.length>0&&U.currentTime<O.end(0)){if(this._config.isLive&&O.end(0)-U.currentTime>3600)return _.default.w(this.TAG,"Playback seems stuck at "+U.currentTime+", try seek to "+O.end(0)+", cancle"),this._mediaElement.removeEventListener("progress",this.e.onvProgress),void this._emitter.emit(m.default.ERROR,g.ErrorTypes.MEDIA_ERROR,"got wrong timestamp ",O.end(0));_.default.w(this.TAG,"Playback seems stuck at "+U.currentTime+", seek to "+O.end(0)),this._requestSetTime=!0,this._mediaElement.currentTime=O.end(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress)}}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)}},{key:"_onvLoadedMetadata",value:function(P){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)}},{key:"_onvSeeking",value:function(P){var U=this._mediaElement.currentTime,O=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(U<1&&O.length>0){var V=O.start(0);if(V<1&&U<V||f.default.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=f.default.safari?.1:V)}if(this._isTimepointBuffered(U)){if(this._alwaysSeekKeyframe){var z=this._msectl.getNearestKeyframe(Math.floor(1e3*U));z!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=z.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:U,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}}},{key:"_onvCanPlay",value:function(P){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)}},{key:"_onvStalled",value:function(P){this._checkAndResumeStuckPlayback(!0)}},{key:"_onvProgress",value:function(P){this._checkAndResumeStuckPlayback()}},{key:"type",get:function(){return this._type}},{key:"buffered",get:function(){return this._mediaElement.buffered}},{key:"duration",get:function(){return this._mediaElement.duration}},{key:"volume",get:function(){return this._mediaElement.volume},set:function(P){this._mediaElement.volume=P}},{key:"muted",get:function(){return this._mediaElement.muted},set:function(P){this._mediaElement.muted=P}},{key:"currentTime",get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(P){this._mediaElement?this._internalSeek(P):this._pendingSeekTime=P}},{key:"mediaInfo",get:function(){return Object.assign({},this._mediaInfo)}},{key:"statisticsInfo",get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)}}]),A}();N.default=y},{"../config.js":5,"../core/mse-controller.js":9,"../core/mse-events.js":10,"../core/transmuxer.js":11,"../core/transmuxing-events.js":13,"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./player-errors.js":34,"./player-events.js":35,events:2}],33:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},I=function(){function S(w,g){for(var d=0;d<g.length;d++){var l=g[d];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(w,l.key,l)}}return function(w,g,d){return g&&S(w.prototype,g),d&&S(w,d),w}}(),b=c(L("events")),_=c(L("./player-events.js")),f=L("../config.js"),m=L("../utils/exception.js");function c(S){return S&&S.__esModule?S:{default:S}}var T=function(){function S(w,g){if(function(d,l){if(!(d instanceof l))throw new TypeError("Cannot call a class as a function")}(this,S),this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new b.default,this._config=(0,f.createDefaultConfig)(),(g===void 0?"undefined":D(g))==="object"&&Object.assign(this._config,g),w.type.toLowerCase()==="flv")throw new m.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(w.hasOwnProperty("segments"))throw new m.InvalidArgumentException("NativePlayer("+w.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=w,this._mediaElement=null}return I(S,[{key:"destroy",value:function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}},{key:"on",value:function(w,g){var d=this;w===_.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){d._emitter.emit(_.default.MEDIA_INFO,d.mediaInfo)}):w===_.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){d._emitter.emit(_.default.STATISTICS_INFO,d.statisticsInfo)}),this._emitter.addListener(w,g)}},{key:"off",value:function(w,g){this._emitter.removeListener(w,g)}},{key:"attachMediaElement",value:function(w){if(this._mediaElement=w,w.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{w.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}}},{key:"detachMediaElement",value:function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:"load",value:function(){if(!this._mediaElement)throw new m.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)}},{key:"unload",value:function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}},{key:"play",value:function(){return this._mediaElement.play()}},{key:"pause",value:function(){this._mediaElement.pause()}},{key:"_onvLoadedMetadata",value:function(w){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(_.default.MEDIA_INFO,this.mediaInfo)}},{key:"_reportStatisticsInfo",value:function(){this._emitter.emit(_.default.STATISTICS_INFO,this.statisticsInfo)}},{key:"type",get:function(){return this._type}},{key:"buffered",get:function(){return this._mediaElement.buffered}},{key:"duration",get:function(){return this._mediaElement.duration}},{key:"volume",get:function(){return this._mediaElement.volume},set:function(w){this._mediaElement.volume=w}},{key:"muted",get:function(){return this._mediaElement.muted},set:function(w){this._mediaElement.muted=w}},{key:"currentTime",get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(w){this._mediaElement?this._mediaElement.currentTime=w:this._pendingSeekTime=w}},{key:"mediaInfo",get:function(){var w={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(w.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(w.width=this._mediaElement.videoWidth,w.height=this._mediaElement.videoHeight)),w}},{key:"statisticsInfo",get:function(){var w={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return w;var g=!0,d=0,l=0;if(this._mediaElement.getVideoPlaybackQuality){var p=this._mediaElement.getVideoPlaybackQuality();d=p.totalVideoFrames,l=p.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(d=this._mediaElement.webkitDecodedFrameCount,l=this._mediaElement.webkitDroppedFrameCount):g=!1;return g&&(w.decodedFrames=d,w.droppedFrames=l),w}}]),S}();N.default=T},{"../config.js":5,"../utils/exception.js":40,"./player-events.js":35,events:2}],34:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.ErrorDetails=N.ErrorTypes=void 0;var D,I=L("../io/loader.js"),b=L("../demux/demux-errors.js"),_=(D=b)&&D.__esModule?D:{default:D};N.ErrorTypes={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},N.ErrorDetails={NETWORK_EXCEPTION:I.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:I.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:I.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:I.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:_.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:_.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:_.default.CODEC_UNSUPPORTED}},{"../demux/demux-errors.js":16,"../io/loader.js":24}],35:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.default={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"}},{}],36:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(){(function(_,f){if(!(_ instanceof f))throw new TypeError("Cannot call a class as a function")})(this,b)}return D(b,null,[{key:"getSilentFrame",value:function(_,f){if(_==="mp4a.40.2"){if(f===1)return new Uint8Array([0,200,0,128,35,128]);if(f===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(f===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(f===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(f===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(f===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(f===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(f===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),b}();N.default=I},{}],37:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(){(function(_,f){if(!(_ instanceof f))throw new TypeError("Cannot call a class as a function")})(this,b)}return D(b,null,[{key:"init",value:function(){for(var _ in b.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]},b.types)b.types.hasOwnProperty(_)&&(b.types[_]=[_.charCodeAt(0),_.charCodeAt(1),_.charCodeAt(2),_.charCodeAt(3)]);var f=b.constants={};f.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),f.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),f.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),f.STSC=f.STCO=f.STTS,f.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),f.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),f.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),f.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),f.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}},{key:"box",value:function(_){for(var f=8,m=null,c=Array.prototype.slice.call(arguments,1),T=c.length,S=0;S<T;S++)f+=c[S].byteLength;(m=new Uint8Array(f))[0]=f>>>24&255,m[1]=f>>>16&255,m[2]=f>>>8&255,m[3]=255&f,m.set(_,4);for(var w=8,g=0;g<T;g++)m.set(c[g],w),w+=c[g].byteLength;return m}},{key:"generateInitSegment",value:function(_){var f=b.box(b.types.ftyp,b.constants.FTYP),m=b.moov(_),c=new Uint8Array(f.byteLength+m.byteLength);return c.set(f,0),c.set(m,f.byteLength),c}},{key:"moov",value:function(_){var f=b.mvhd(_.timescale,_.duration),m=b.trak(_),c=b.mvex(_);return b.box(b.types.moov,f,m,c)}},{key:"mvhd",value:function(_,f){return b.box(b.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,_>>>24&255,_>>>16&255,_>>>8&255,255&_,f>>>24&255,f>>>16&255,f>>>8&255,255&f,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(_){return b.box(b.types.trak,b.tkhd(_),b.mdia(_))}},{key:"tkhd",value:function(_){var f=_.id,m=_.duration,c=_.presentWidth,T=_.presentHeight;return b.box(b.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,255&f,0,0,0,0,m>>>24&255,m>>>16&255,m>>>8&255,255&m,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,c>>>8&255,255&c,0,0,T>>>8&255,255&T,0,0]))}},{key:"mdia",value:function(_){return b.box(b.types.mdia,b.mdhd(_),b.hdlr(_),b.minf(_))}},{key:"mdhd",value:function(_){var f=_.timescale,m=_.duration;return b.box(b.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,255&f,m>>>24&255,m>>>16&255,m>>>8&255,255&m,85,196,0,0]))}},{key:"hdlr",value:function(_){var f=null;return f=_.type==="audio"?b.constants.HDLR_AUDIO:b.constants.HDLR_VIDEO,b.box(b.types.hdlr,f)}},{key:"minf",value:function(_){var f=null;return f=_.type==="audio"?b.box(b.types.smhd,b.constants.SMHD):b.box(b.types.vmhd,b.constants.VMHD),b.box(b.types.minf,f,b.dinf(),b.stbl(_))}},{key:"dinf",value:function(){return b.box(b.types.dinf,b.box(b.types.dref,b.constants.DREF))}},{key:"stbl",value:function(_){return b.box(b.types.stbl,b.stsd(_),b.box(b.types.stts,b.constants.STTS),b.box(b.types.stsc,b.constants.STSC),b.box(b.types.stsz,b.constants.STSZ),b.box(b.types.stco,b.constants.STCO))}},{key:"stsd",value:function(_){return _.type==="audio"?_.codec==="mp3"?b.box(b.types.stsd,b.constants.STSD_PREFIX,b.mp3(_)):b.box(b.types.stsd,b.constants.STSD_PREFIX,b.mp4a(_)):b.box(b.types.stsd,b.constants.STSD_PREFIX,b.avc1(_))}},{key:"mp3",value:function(_){var f=_.channelCount,m=_.audioSampleRate,c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f,0,16,0,0,0,0,m>>>8&255,255&m,0,0]);return b.box(b.types[".mp3"],c)}},{key:"mp4a",value:function(_){var f=_.channelCount,m=_.audioSampleRate,c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,f,0,16,0,0,0,0,m>>>8&255,255&m,0,0]);return b.box(b.types.mp4a,c,b.esds(_))}},{key:"esds",value:function(_){var f=_.config||[],m=f.length,c=new Uint8Array([0,0,0,0,3,23+m,0,1,0,4,15+m,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([m]).concat(f).concat([6,1,2]));return b.box(b.types.esds,c)}},{key:"avc1",value:function(_){var f=_.avcc,m=_.codecWidth,c=_.codecHeight,T=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>>8&255,255&m,c>>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return b.box(b.types.avc1,T,b.box(b.types.avcC,f))}},{key:"mvex",value:function(_){return b.box(b.types.mvex,b.trex(_))}},{key:"trex",value:function(_){var f=_.id,m=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,255&f,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return b.box(b.types.trex,m)}},{key:"moof",value:function(_,f){return b.box(b.types.moof,b.mfhd(_.sequenceNumber),b.traf(_,f))}},{key:"mfhd",value:function(_){var f=new Uint8Array([0,0,0,0,_>>>24&255,_>>>16&255,_>>>8&255,255&_]);return b.box(b.types.mfhd,f)}},{key:"traf",value:function(_,f){var m=_.id,c=b.box(b.types.tfhd,new Uint8Array([0,0,0,0,m>>>24&255,m>>>16&255,m>>>8&255,255&m])),T=b.box(b.types.tfdt,new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,255&f])),S=b.sdtp(_),w=b.trun(_,S.byteLength+16+16+8+16+8+8);return b.box(b.types.traf,c,T,w,S)}},{key:"sdtp",value:function(_){for(var f=_.samples||[],m=f.length,c=new Uint8Array(4+m),T=0;T<m;T++){var S=f[T].flags;c[T+4]=S.isLeading<<6|S.dependsOn<<4|S.isDependedOn<<2|S.hasRedundancy}return b.box(b.types.sdtp,c)}},{key:"trun",value:function(_,f){var m=_.samples||[],c=m.length,T=12+16*c,S=new Uint8Array(T);f+=8+T,S.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,f>>>24&255,f>>>16&255,f>>>8&255,255&f],0);for(var w=0;w<c;w++){var g=m[w].duration,d=m[w].size,l=m[w].flags,p=m[w].cts;S.set([g>>>24&255,g>>>16&255,g>>>8&255,255&g,d>>>24&255,d>>>16&255,d>>>8&255,255&d,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.isNonSync,0,0,p>>>24&255,p>>>16&255,p>>>8&255,255&p],12+16*w)}return b.box(b.types.trun,S)}},{key:"mdat",value:function(_){return b.box(b.types.mdat,_)}}]),b}();I.init(),N.default=I},{}],38:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function w(g,d){for(var l=0;l<d.length;l++){var p=d[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}return function(g,d,l){return d&&w(g.prototype,d),l&&w(g,l),g}}(),I=T(L("../utils/logger.js")),b=T(L("./mp4-generator.js")),_=T(L("./aac-silent.js")),f=T(L("../utils/browser.js")),m=L("../core/media-segment-info.js"),c=L("../utils/exception.js");function T(w){return w&&w.__esModule?w:{default:w}}var S=function(){function w(g){(function(d,l){if(!(d instanceof l))throw new TypeError("Cannot call a class as a function")})(this,w),this.TAG="MP4Remuxer",this._config=g,this._isLive=g.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new m.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new m.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!f.default.chrome||!(f.default.version.major<50||f.default.version.major===50&&f.default.version.build<2661)),this._fillSilentAfterSeek=f.default.msedge||f.default.msie,this._mp3UseMpegAudio=!f.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return D(w,[{key:"destroy",value:function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null}},{key:"bindDataSource",value:function(g){return g.onDataAvailable=this.remux.bind(this),g.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this}},{key:"insertDiscontinuity",value:function(){this._audioNextDts=this._videoNextDts=void 0}},{key:"seek",value:function(g){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()}},{key:"remux",value:function(g,d){if(!this._onMediaSegment)throw new c.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(g,d),this._remuxVideo(d),this._remuxAudio(g)}},{key:"_onTrackMetadataReceived",value:function(g,d){var l=null,p="mp4",y=d.codec;if(g==="audio")this._audioMeta=d,d.codec==="mp3"&&this._mp3UseMpegAudio?(p="mpeg",y="",l=new Uint8Array):l=b.default.generateInitSegment(d);else{if(g!=="video")return;this._videoMeta=d,l=b.default.generateInitSegment(d)}if(!this._onInitSegment)throw new c.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(g,{type:g,data:l.buffer,codec:y,container:g+"/"+p,mediaDuration:d.duration})}},{key:"_calculateDtsBase",value:function(g,d){this._dtsBaseInited||(g.samples&&g.samples.length&&(this._audioDtsBase=g.samples[0].dts),d.samples&&d.samples.length&&(this._videoDtsBase=d.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)}},{key:"flushStashedSamples",value:function(){var g=this._videoStashedLastSample,d=this._audioStashedLastSample,l={type:"video",id:1,sequenceNumber:0,samples:[],length:0};g!=null&&(l.samples.push(g),l.length=g.length);var p={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};d!=null&&(p.samples.push(d),p.length=d.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(l,!0),this._remuxAudio(p,!0)}},{key:"_remuxAudio",value:function(g,d){if(this._audioMeta!=null){var l,p=g,y=p.samples,A=void 0,P=-1,U=this._audioMeta.refSampleDuration,O=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,V=this._dtsBaseInited&&this._audioNextDts===void 0,z=!1;if(y&&y.length!==0&&(y.length!==1||d)){var Z=0,te=null,se=0;O?(Z=0,se=p.length):(Z=8,se=8+p.length);var ue=null;if(y.length>1&&(se-=(ue=y.pop()).length),this._audioStashedLastSample!=null){var de=this._audioStashedLastSample;this._audioStashedLastSample=null,y.unshift(de),se+=de.length}ue!=null&&(this._audioStashedLastSample=ue);var ke=y[0].dts-this._dtsBase;if(this._audioNextDts)A=ke-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())A=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(z=!0);else{var Te=this._audioSegmentInfoList.getLastSampleBefore(ke);if(Te!=null){var he=ke-(Te.originalDts+Te.duration);he<=3&&(he=0),A=ke-(Te.dts+Te.duration+he)}else A=0}if(z){var Ne=ke-A,ve=this._videoSegmentInfoList.getLastSegmentBefore(ke);if(ve!=null&&ve.beginDts<Ne){var Fe=_.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(Fe){var Oe=ve.beginDts,Ve=Ne-ve.beginDts;I.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+Oe+", duration: "+Ve),y.unshift({unit:Fe,dts:Oe,pts:Oe}),se+=Fe.byteLength}}else z=!1}for(var Ce=[],ze=0;ze<y.length;ze++){var tt=y[ze],ct=tt.unit,Ge=tt.dts-this._dtsBase,He=Ge,rt=!1,De=null,re=0;if(!(Ge<-.001)){if(this._audioMeta.codec!=="mp3"){var ae=Ge;if(this._audioNextDts&&(ae=this._audioNextDts),(A=Ge-ae)<=-3*U){I.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+Ge+" ms ,curRefDts: "+ae+" ms)  due to dtsCorrection: "+A+" ms overlap.");continue}if(A>=3*U&&this._fillAudioTimestampGap&&!f.default.safari){rt=!0;var be=Math.floor(A/U);I.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
originalDts: `+Ge+" ms, curRefDts: "+ae+" ms, dtsCorrection: "+Math.round(A)+" ms, generate: "+be+" frames"),He=Math.floor(ae),re=Math.floor(ae+U)-He;var _e=_.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);_e==null&&(I.default.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),_e=ct),De=[];for(var Pe=0;Pe<be;Pe++){ae+=U;var we=Math.floor(ae),Je=Math.floor(ae+U)-we,st={dts:we,pts:we,cts:0,unit:_e,size:_e.byteLength,duration:Je,originalDts:Ge,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};De.push(st),se+=st.size}this._audioNextDts=ae+U}else He=Math.floor(ae),re=Math.floor(ae+U)-He,this._audioNextDts=ae+U}else He=Ge-A,ze!==y.length-1?re=y[ze+1].dts-this._dtsBase-A-He:ue!=null?re=ue.dts-this._dtsBase-A-He:re=Ce.length>=1?Ce[Ce.length-1].duration:Math.floor(U),this._audioNextDts=He+re;P===-1&&(P=He),Ce.push({dts:He,pts:He,cts:0,unit:tt.unit,size:tt.unit.byteLength,duration:re,originalDts:Ge,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),rt&&Ce.push.apply(Ce,De)}}if(Ce.length===0)return p.samples=[],void(p.length=0);O?te=new Uint8Array(se):((te=new Uint8Array(se))[0]=se>>>24&255,te[1]=se>>>16&255,te[2]=se>>>8&255,te[3]=255&se,te.set(b.default.types.mdat,4));for(var wt=0;wt<Ce.length;wt++){var Xe=Ce[wt].unit;te.set(Xe,Z),Z+=Xe.byteLength}var qe=Ce[Ce.length-1];l=qe.dts+qe.duration;var ot=new m.MediaSegmentInfo;ot.beginDts=P,ot.endDts=l,ot.beginPts=P,ot.endPts=l,ot.originalBeginDts=Ce[0].originalDts,ot.originalEndDts=qe.originalDts+qe.duration,ot.firstSample=new m.SampleInfo(Ce[0].dts,Ce[0].pts,Ce[0].duration,Ce[0].originalDts,!1),ot.lastSample=new m.SampleInfo(qe.dts,qe.pts,qe.duration,qe.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ot),p.samples=Ce,p.sequenceNumber++;var ir=null;ir=O?new Uint8Array:b.default.moof(p,P),p.samples=[],p.length=0;var _r={type:"audio",data:this._mergeBoxes(ir,te).buffer,sampleCount:Ce.length,info:ot};O&&V&&(_r.timestampOffset=P),this._onMediaSegment("audio",_r)}}}},{key:"_remuxVideo",value:function(g,d){if(this._videoMeta!=null){var l,p,y=g,A=y.samples,P=void 0,U=-1,O=-1;if(A&&A.length!==0&&(A.length!==1||d)){var V=8,z=null,Z=8+g.length,te=null;if(A.length>1&&(Z-=(te=A.pop()).length),this._videoStashedLastSample!=null){var se=this._videoStashedLastSample;this._videoStashedLastSample=null,A.unshift(se),Z+=se.length}te!=null&&(this._videoStashedLastSample=te);var ue=A[0].dts-this._dtsBase;if(this._videoNextDts)P=ue-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())P=0;else{var de=this._videoSegmentInfoList.getLastSampleBefore(ue);if(de!=null){var ke=ue-(de.originalDts+de.duration);ke<=3&&(ke=0),P=ue-(de.dts+de.duration+ke)}else P=0}for(var Te=new m.MediaSegmentInfo,he=[],Ne=0;Ne<A.length;Ne++){var ve=A[Ne],Fe=ve.dts-this._dtsBase,Oe=ve.isKeyframe,Ve=Fe-P,Ce=ve.cts,ze=Ve+Ce;U===-1&&(U=Ve,O=ze);var tt=0;if(Ne!==A.length-1?tt=A[Ne+1].dts-this._dtsBase-P-Ve:te!=null?tt=te.dts-this._dtsBase-P-Ve:tt=he.length>=1?he[he.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),Oe){var ct=new m.SampleInfo(Ve,ze,tt,ve.dts,!0);ct.fileposition=ve.fileposition,Te.appendSyncPoint(ct)}he.push({dts:Ve,pts:ze,cts:Ce,units:ve.units,size:ve.length,isKeyframe:Oe,duration:tt,originalDts:Fe,flags:{isLeading:0,dependsOn:Oe?2:1,isDependedOn:Oe?1:0,hasRedundancy:0,isNonSync:Oe?0:1}})}(z=new Uint8Array(Z))[0]=Z>>>24&255,z[1]=Z>>>16&255,z[2]=Z>>>8&255,z[3]=255&Z,z.set(b.default.types.mdat,4);for(var Ge=0;Ge<he.length;Ge++)for(var He=he[Ge].units;He.length;){var rt=He.shift().data;z.set(rt,V),V+=rt.byteLength}var De=he[he.length-1];if(l=De.dts+De.duration,p=De.pts+De.duration,this._videoNextDts=l,Te.beginDts=U,Te.endDts=l,Te.beginPts=O,Te.endPts=p,Te.originalBeginDts=he[0].originalDts,Te.originalEndDts=De.originalDts+De.duration,Te.firstSample=new m.SampleInfo(he[0].dts,he[0].pts,he[0].duration,he[0].originalDts,he[0].isKeyframe),Te.lastSample=new m.SampleInfo(De.dts,De.pts,De.duration,De.originalDts,De.isKeyframe),this._isLive||this._videoSegmentInfoList.append(Te),y.samples=he,y.sequenceNumber++,this._forceFirstIDR){var re=he[0].flags;re.dependsOn=2,re.isNonSync=0}var ae=b.default.moof(y,U);y.samples=[],y.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(ae,z).buffer,sampleCount:he.length,info:Te})}}}},{key:"_mergeBoxes",value:function(g,d){var l=new Uint8Array(g.byteLength+d.byteLength);return l.set(g,0),l.set(d,g.byteLength),l}},{key:"onInitSegment",get:function(){return this._onInitSegment},set:function(g){this._onInitSegment=g}},{key:"onMediaSegment",get:function(){return this._onMediaSegment},set:function(g){this._onMediaSegment=g}}]),w}();N.default=S},{"../core/media-segment-info.js":8,"../utils/browser.js":39,"../utils/exception.js":40,"../utils/logger.js":41,"./aac-silent.js":36,"./mp4-generator.js":37}],39:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D={};(function(){var I=self.navigator.userAgent.toLowerCase(),b=/(edge)\/([\w.]+)/.exec(I)||/(opr)[\/]([\w.]+)/.exec(I)||/(chrome)[ \/]([\w.]+)/.exec(I)||/(iemobile)[\/]([\w.]+)/.exec(I)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(I)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(I)||/(webkit)[ \/]([\w.]+)/.exec(I)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(I)||/(msie) ([\w.]+)/.exec(I)||I.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(I)||I.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(I)||[],_=/(ipad)/.exec(I)||/(ipod)/.exec(I)||/(windows phone)/.exec(I)||/(iphone)/.exec(I)||/(kindle)/.exec(I)||/(android)/.exec(I)||/(windows)/.exec(I)||/(mac)/.exec(I)||/(linux)/.exec(I)||/(cros)/.exec(I)||[],f={browser:b[5]||b[3]||b[1]||"",version:b[2]||b[4]||"0",majorVersion:b[4]||b[2]||"0",platform:_[0]||""},m={};if(f.browser){m[f.browser]=!0;var c=f.majorVersion.split(".");m.version={major:parseInt(f.majorVersion,10),string:f.version},c.length>1&&(m.version.minor=parseInt(c[1],10)),c.length>2&&(m.version.build=parseInt(c[2],10))}f.platform&&(m[f.platform]=!0),(m.chrome||m.opr||m.safari)&&(m.webkit=!0),(m.rv||m.iemobile)&&(m.rv&&delete m.rv,f.browser="msie",m.msie=!0),m.edge&&(delete m.edge,f.browser="msedge",m.msedge=!0),m.opr&&(f.browser="opera",m.opera=!0),m.safari&&m.android&&(f.browser="android",m.android=!0);for(var T in m.name=f.browser,m.platform=f.platform,D)D.hasOwnProperty(T)&&delete D[T];Object.assign(D,m)})(),N.default=D},{}],40:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function m(c,T){for(var S=0;S<T.length;S++){var w=T[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}return function(c,T,S){return T&&m(c.prototype,T),S&&m(c,S),c}}();function I(m,c){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!c||typeof c!="object"&&typeof c!="function"?m:c}function b(m,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);m.prototype=Object.create(c&&c.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(m,c):m.__proto__=c)}function _(m,c){if(!(m instanceof c))throw new TypeError("Cannot call a class as a function")}var f=N.RuntimeException=function(){function m(c){_(this,m),this._message=c}return D(m,[{key:"toString",value:function(){return this.name+": "+this.message}},{key:"name",get:function(){return"RuntimeException"}},{key:"message",get:function(){return this._message}}]),m}();N.IllegalStateException=function(m){function c(T){return _(this,c),I(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,T))}return b(c,f),D(c,[{key:"name",get:function(){return"IllegalStateException"}}]),c}(),N.InvalidArgumentException=function(m){function c(T){return _(this,c),I(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,T))}return b(c,f),D(c,[{key:"name",get:function(){return"InvalidArgumentException"}}]),c}(),N.NotImplementedException=function(m){function c(T){return _(this,c),I(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,T))}return b(c,f),D(c,[{key:"name",get:function(){return"NotImplementedException"}}]),c}()},{}],41:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D,I=function(){function m(c,T){for(var S=0;S<T.length;S++){var w=T[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}return function(c,T,S){return T&&m(c.prototype,T),S&&m(c,S),c}}(),b=L("events"),_=(D=b)&&D.__esModule?D:{default:D},f=function(){function m(){(function(c,T){if(!(c instanceof T))throw new TypeError("Cannot call a class as a function")})(this,m)}return I(m,null,[{key:"e",value:function(c,T){c&&!m.FORCE_GLOBAL_TAG||(c=m.GLOBAL_TAG);var S="["+c+"] > "+T;m.ENABLE_CALLBACK&&m.emitter.emit("log","error",S),m.ENABLE_ERROR&&(console.error?console.error(S):console.warn?console.warn(S):console.log(S))}},{key:"i",value:function(c,T){c&&!m.FORCE_GLOBAL_TAG||(c=m.GLOBAL_TAG);var S="["+c+"] > "+T;m.ENABLE_CALLBACK&&m.emitter.emit("log","info",S),m.ENABLE_INFO&&(console.info?console.info(S):console.log(S))}},{key:"w",value:function(c,T){c&&!m.FORCE_GLOBAL_TAG||(c=m.GLOBAL_TAG);var S="["+c+"] > "+T;m.ENABLE_CALLBACK&&m.emitter.emit("log","warn",S),m.ENABLE_WARN&&(console.warn?console.warn(S):console.log(S))}},{key:"d",value:function(c,T){c&&!m.FORCE_GLOBAL_TAG||(c=m.GLOBAL_TAG);var S="["+c+"] > "+T;m.ENABLE_CALLBACK&&m.emitter.emit("log","debug",S),m.ENABLE_DEBUG&&(console.debug?console.debug(S):console.log(S))}},{key:"v",value:function(c,T){c&&!m.FORCE_GLOBAL_TAG||(c=m.GLOBAL_TAG);var S="["+c+"] > "+T;m.ENABLE_CALLBACK&&m.emitter.emit("log","verbose",S),m.ENABLE_VERBOSE&&console.log(S)}}]),m}();f.GLOBAL_TAG="flv.js",f.FORCE_GLOBAL_TAG=!1,f.ENABLE_ERROR=!0,f.ENABLE_INFO=!0,f.ENABLE_WARN=!0,f.ENABLE_DEBUG=!0,f.ENABLE_VERBOSE=!0,f.ENABLE_CALLBACK=!1,f.emitter=new _.default,N.default=f},{events:2}],42:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function m(c,T){for(var S=0;S<T.length;S++){var w=T[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(c,w.key,w)}}return function(c,T,S){return T&&m(c.prototype,T),S&&m(c,S),c}}(),I=_(L("events")),b=_(L("./logger.js"));function _(m){return m&&m.__esModule?m:{default:m}}var f=function(){function m(){(function(c,T){if(!(c instanceof T))throw new TypeError("Cannot call a class as a function")})(this,m)}return D(m,null,[{key:"getConfig",value:function(){return{globalTag:b.default.GLOBAL_TAG,forceGlobalTag:b.default.FORCE_GLOBAL_TAG,enableVerbose:b.default.ENABLE_VERBOSE,enableDebug:b.default.ENABLE_DEBUG,enableInfo:b.default.ENABLE_INFO,enableWarn:b.default.ENABLE_WARN,enableError:b.default.ENABLE_ERROR,enableCallback:b.default.ENABLE_CALLBACK}}},{key:"applyConfig",value:function(c){b.default.GLOBAL_TAG=c.globalTag,b.default.FORCE_GLOBAL_TAG=c.forceGlobalTag,b.default.ENABLE_VERBOSE=c.enableVerbose,b.default.ENABLE_DEBUG=c.enableDebug,b.default.ENABLE_INFO=c.enableInfo,b.default.ENABLE_WARN=c.enableWarn,b.default.ENABLE_ERROR=c.enableError,b.default.ENABLE_CALLBACK=c.enableCallback}},{key:"_notifyChange",value:function(){var c=m.emitter;if(c.listenerCount("change")>0){var T=m.getConfig();c.emit("change",T)}}},{key:"registerListener",value:function(c){m.emitter.addListener("change",c)}},{key:"removeListener",value:function(c){m.emitter.removeListener("change",c)}},{key:"addLogListener",value:function(c){b.default.emitter.addListener("log",c),b.default.emitter.listenerCount("log")>0&&(b.default.ENABLE_CALLBACK=!0,m._notifyChange())}},{key:"removeLogListener",value:function(c){b.default.emitter.removeListener("log",c),b.default.emitter.listenerCount("log")===0&&(b.default.ENABLE_CALLBACK=!1,m._notifyChange())}},{key:"forceGlobalTag",get:function(){return b.default.FORCE_GLOBAL_TAG},set:function(c){b.default.FORCE_GLOBAL_TAG=c,m._notifyChange()}},{key:"globalTag",get:function(){return b.default.GLOBAL_TAG},set:function(c){b.default.GLOBAL_TAG=c,m._notifyChange()}},{key:"enableAll",get:function(){return b.default.ENABLE_VERBOSE&&b.default.ENABLE_DEBUG&&b.default.ENABLE_INFO&&b.default.ENABLE_WARN&&b.default.ENABLE_ERROR},set:function(c){b.default.ENABLE_VERBOSE=c,b.default.ENABLE_DEBUG=c,b.default.ENABLE_INFO=c,b.default.ENABLE_WARN=c,b.default.ENABLE_ERROR=c,m._notifyChange()}},{key:"enableDebug",get:function(){return b.default.ENABLE_DEBUG},set:function(c){b.default.ENABLE_DEBUG=c,m._notifyChange()}},{key:"enableVerbose",get:function(){return b.default.ENABLE_VERBOSE},set:function(c){b.default.ENABLE_VERBOSE=c,m._notifyChange()}},{key:"enableInfo",get:function(){return b.default.ENABLE_INFO},set:function(c){b.default.ENABLE_INFO=c,m._notifyChange()}},{key:"enableWarn",get:function(){return b.default.ENABLE_WARN},set:function(c){b.default.ENABLE_WARN=c,m._notifyChange()}},{key:"enableError",get:function(){return b.default.ENABLE_ERROR},set:function(c){b.default.ENABLE_ERROR=c,m._notifyChange()}}]),m}();f.emitter=new I.default,N.default=f},{"./logger.js":41,events:2}],43:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=function(){function b(_,f){for(var m=0;m<f.length;m++){var c=f[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(_,c.key,c)}}return function(_,f,m){return f&&b(_.prototype,f),m&&b(_,m),_}}(),I=function(){function b(){(function(_,f){if(!(_ instanceof f))throw new TypeError("Cannot call a class as a function")})(this,b)}return D(b,null,[{key:"install",value:function(){Object.setPrototypeOf=Object.setPrototypeOf||function(_,f){return _.__proto__=f,_},Object.assign=Object.assign||function(_){if(_==null)throw new TypeError("Cannot convert undefined or null to object");for(var f=Object(_),m=1;m<arguments.length;m++){var c=arguments[m];if(c!=null)for(var T in c)c.hasOwnProperty(T)&&(f[T]=c[T])}return f},typeof self.Promise!="function"&&L("es6-promise").polyfill()}}]),b}();I.install(),N.default=I},{"es6-promise":1}],44:[function(L,q,N){"use strict";function D(I,b,_){var f=I;if(b+_<f.length){for(;_--;)if((192&f[++b])!=128)return!1;return!0}return!1}Object.defineProperty(N,"__esModule",{value:!0}),N.default=function(I){for(var b=[],_=I,f=0,m=I.length;f<m;)if(_[f]<128)b.push(String.fromCharCode(_[f])),++f;else{if(!(_[f]<192)){if(_[f]<224){if(D(_,f,1)){var c=(31&_[f])<<6|63&_[f+1];if(c>=128){b.push(String.fromCharCode(65535&c)),f+=2;continue}}}else if(_[f]<240){if(D(_,f,2)){var T=(15&_[f])<<12|(63&_[f+1])<<6|63&_[f+2];if(T>=2048&&(63488&T)!=55296){b.push(String.fromCharCode(65535&T)),f+=3;continue}}}else if(_[f]<248&&D(_,f,3)){var S=(7&_[f])<<18|(63&_[f+1])<<12|(63&_[f+2])<<6|63&_[f+3];if(S>65536&&S<1114112){S-=65536,b.push(String.fromCharCode(S>>>10|55296)),b.push(String.fromCharCode(1023&S|56320)),f+=4;continue}}}b.push(String.fromCharCode(65533)),++f}return b.join("")}},{}]},{},[21])(21)}),function(L,q){typeof exports=="object"&&typeof module<"u"?module.exports=q(require("video.js")):typeof define=="function"&&define.amd?define(["video.js"],q):L.videojsFlash=q(L.videojs)}(this,function(L){"use strict";L=L&&L.hasOwnProperty("default")?L.default:L;var q=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N=typeof window<"u"?window:q!==void 0?q:typeof self<"u"?self:{},D=function(P,U){if(!(P instanceof U))throw new TypeError("Cannot call a class as a function")},I=function(P,U){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!U||typeof U!="object"&&typeof U!="function"?P:U},b=L.getComponent("Tech"),_=L.dom,f=L.url,m=L.createTimeRange,c=L.mergeOptions,T=N&&N.navigator||{},S=function(P){function U(O,V){D(this,U);var z=I(this,P.call(this,O,V));return O.source&&z.ready(function(){this.setSource(O.source)},!0),O.startTime&&z.ready(function(){this.load(),this.play(),this.currentTime(O.startTime)},!0),N.videojs=N.videojs||{},N.videojs.Flash=N.videojs.Flash||{},N.videojs.Flash.onReady=U.onReady,N.videojs.Flash.onEvent=U.onEvent,N.videojs.Flash.onError=U.onError,z.on("seeked",function(){this.lastSeekTarget_=void 0}),z}return function(O,V){if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof V);O.prototype=Object.create(V&&V.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),V&&(Object.setPrototypeOf?Object.setPrototypeOf(O,V):O.__proto__=V)}(U,P),U.prototype.createEl=function(){var O=this.options_;O.swf||(O.swf="https://vjs.zencdn.net/swf/5.4.2/video-js.swf");var V=O.techId,z=c({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:O.autoplay,stretch:O.stretch||!1,fluent:O.fluent||!1,preload:O.preload,loop:O.loop,muted:O.muted},O.flashVars),Z=c({wmode:"opaque",bgcolor:"#000000"},O.params),te=c({id:V,name:V,class:"vjs-tech"},O.attributes);return this.el_=U.embed(O.swf,z,Z,te),this.el_.tech=this,this.el_},U.prototype.play=function(){this.ended()&&this.setCurrentTime(0),this.el_.vjs_play()},U.prototype.pause=function(){this.el_.vjs_pause()},U.prototype.src=function(O){return O===void 0?this.currentSrc():this.setSrc(O)},U.prototype.setSrc=function(O){var V=this;O=f.getAbsoluteURL(O),this.el_.vjs_src(O),this.autoplay()&&this.setTimeout(function(){return V.play()},0)},U.prototype.seeking=function(){return this.lastSeekTarget_!==void 0},U.prototype.setCurrentTime=function(O){var V=this.seekable();V.length&&(O=(O=O>V.start(0)?O:V.start(0))<V.end(V.length-1)?O:V.end(V.length-1),this.lastSeekTarget_=O,this.trigger("seeking"),this.el_.vjs_setProperty("currentTime",O),P.prototype.setCurrentTime.call(this))},U.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},U.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},U.prototype.duration=function(){if(this.readyState()===0)return NaN;var O=this.el_.vjs_getProperty("duration");return O>=0?O:1/0},U.prototype.load=function(){this.el_.vjs_load()},U.prototype.poster=function(){this.el_.vjs_getProperty("poster")},U.prototype.setPoster=function(){},U.prototype.seekable=function(){var O=this.duration();return O===0?m():m(0,O)},U.prototype.buffered=function(){var O=this.el_.vjs_getProperty("buffered");return O.length===0?m():m(O[0][0],O[0][1])},U.prototype.supportsFullScreen=function(){return!1},U.prototype.enterFullScreen=function(){return!1},U.prototype.getVideoPlaybackQuality=function(){var O=this.el_.vjs_getProperty("getVideoPlaybackQuality");return N.performance&&typeof N.performance.now=="function"?O.creationTime=N.performance.now():N.performance&&N.performance.timing&&typeof N.performance.timing.navigationStart=="number"&&(O.creationTime=N.Date.now()-N.performance.timing.navigationStart),O},U}(b),w=["rtmpConnection","rtmpStream","preload","defaultPlaybackRate","playbackRate","autoplay","stretch","fluent","loop","controls","volume","muted","defaultMuted"],g=["networkState","readyState","initialTime","startOffsetTime","paused","ended","videoWidth","videoHeight"],d=S.prototype;function l(P){var U=P.charAt(0).toUpperCase()+P.slice(1);d["set"+U]=function(O){return this.el_.vjs_setProperty(P,O)}}function p(P){d[P]=function(){return this.el_.vjs_getProperty(P)}}for(var y=0;y<w.length;y++)p(w[y]),l(w[y]);for(var A=0;A<g.length;A++)p(g[A]);return S.isSupported=function(){return!!(L.browser.IS_CHROME&&!L.browser.IS_ANDROID||L.browser.IS_SAFARI&&!L.browser.IS_IOS)||S.version()[0]>=10},b.withSourceHandlers(S),S.nativeSourceHandler={},S.nativeSourceHandler.canPlayType=function(P){return P in S.formats?"maybe":""},S.nativeSourceHandler.canHandleSource=function(P,U){var O,V,z=void 0;return P.type?z=P.type.replace(/;.*/,"").toLowerCase():(O=P.src,z=(V=f.getFileExtension(O))?"video/"+V:""),S.nativeSourceHandler.canPlayType(z)},S.nativeSourceHandler.handleSource=function(P,U,O){U.setSrc(P.src)},S.nativeSourceHandler.dispose=function(){},S.registerSourceHandler(S.nativeSourceHandler),S.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},S.onReady=function(P){var U=_.$("#"+P),O=U&&U.tech;O&&O.el()&&S.checkReady(O)},S.checkReady=function(P){P.el()&&(P.el().vjs_getProperty?P.triggerReady():this.setTimeout(function(){S.checkReady(P)},50))},S.onEvent=function(P,U){var O=_.$("#"+P).tech,V=Array.prototype.slice.call(arguments,2);O.setTimeout(function(){O.trigger(U,V)},1)},S.onError=function(P,U){var O=_.$("#"+P).tech;if(U==="srcnotfound")return O.error(4);typeof U=="string"?O.error("FLASH: "+U):(U.origin="flash",O.error(U))},S.version=function(){var P="0,0,0";try{P=new N.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch{try{T.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(P=(T.plugins["Shockwave Flash 2.0"]||T.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch{}}return P.split(",")},S.embed=function(P,U,O,V){var z=S.getEmbedCode(P,U,O,V);return _.createEl("div",{innerHTML:z}).childNodes[0]},S.getEmbedCode=function(P,U,O,V){var z="",Z="",te="";return U&&Object.getOwnPropertyNames(U).forEach(function(se){z+=se+"="+U[se]+"&amp;"}),O=c({movie:P,flashvars:z,allowScriptAccess:"always",allowNetworking:"all"},O),Object.getOwnPropertyNames(O).forEach(function(se){Z+='<param name="'+se+'" value="'+O[se]+'" />'}),V=c({data:P,width:"100%",height:"100%"},V),Object.getOwnPropertyNames(V).forEach(function(se){te+=se+'="'+V[se]+'" '}),'<object type="application/x-shockwave-flash" '+te+">"+Z+"</object>"},function(P){P.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},P.streamFromParts=function(U,O){return U+"&"+O},P.streamToParts=function(U){var O={connection:"",stream:""};if(!U)return O;var V=U.search(/&(?![\w-]+=)/),z=void 0;return V!==-1?z=V+1:(V=z=U.lastIndexOf("/")+1)===0&&(V=z=U.length),O.connection=U.substring(0,V),O.stream=U.substring(z,U.length),O},P.isStreamingType=function(U){return U in P.streamingFormats},P.RTMP_RE=/^rtmp[set]?:\/\//i,P.isStreamingSrc=function(U){return P.RTMP_RE.test(U)},P.rtmpSourceHandler={},P.rtmpSourceHandler.canPlayType=function(U){return P.isStreamingType(U)?"maybe":""},P.rtmpSourceHandler.canHandleSource=function(U,O){var V=P.rtmpSourceHandler.canPlayType(U.type);return V||(P.isStreamingSrc(U.src)?"maybe":"")},P.rtmpSourceHandler.handleSource=function(U,O,V){var z=P.streamToParts(U.src);O.setRtmpConnection(z.connection),O.setRtmpStream(z.stream)},P.registerSourceHandler(P.rtmpSourceHandler)}(S),b.getTech("Flash")?(L.log.warn("Not using videojs-flash as it appears to already be registered"),L.log.warn("videojs-flash should only be used with video.js@6 and above")):L.registerTech("Flash",S),S.VERSION="2.1.2",S}),function(L){typeof exports=="object"&&typeof module<"u"?module.exports=L():typeof define=="function"&&define.amd?define([],L):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).videojsFlvjs=L()}(function(){return function L(q,N,D){function I(f,m){if(!N[f]){if(!q[f]){var c=typeof require=="function"&&require;if(!m&&c)return c(f,!0);if(b)return b(f,!0);var T=new Error("Cannot find module '"+f+"'");throw T.code="MODULE_NOT_FOUND",T}var S=N[f]={exports:{}};q[f][0].call(S.exports,function(w){var g=q[f][1][w];return I(g||w)},S,S.exports,L,q,N,D)}return N[f].exports}for(var b=typeof require=="function"&&require,_=0;_<D.length;_++)I(D[_]);return I}({1:[function(L,q,N){(function(D){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var I,b=function(){function w(g,d){for(var l=0;l<d.length;l++){var p=d[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}return function(g,d,l){return d&&w(g.prototype,d),l&&w(g,l),g}}(),_=typeof window<"u"?window.videojs:D!==void 0?D.videojs:null,f=(I=_)&&I.__esModule?I:{default:I},m=f.default.getTech("Html5"),c=f.default.mergeOptions||f.default.util.mergeOptions,T={mediaDataSource:{},config:{}},S=function(w){function g(d,l){return function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")}(this,g),d=c(T,d),function(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?p:y}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,d,l))}return function(d,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof l);d.prototype=Object.create(l&&l.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(d,l):d.__proto__=l)}(g,m),b(g,[{key:"setSrc",value:function(d){this.flvPlayer&&(this.flvPlayer.unload(),this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy());var l=this.options_.mediaDataSource,p=this.options_.config;l.type=l.type===void 0?"flv":l.type,l.url=d,this.flvPlayer=window.flvjs.createPlayer(l,p),this.flvPlayer.attachMediaElement(this.el_),this.flvPlayer.load()}},{key:"dispose",value:function(){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.unload(),this.flvPlayer.destroy(),this.flvPlayer=null),function d(l,p,y){l===null&&(l=Function.prototype);var A=Object.getOwnPropertyDescriptor(l,p);if(A===void 0){var P=Object.getPrototypeOf(l);return P===null?void 0:d(P,p,y)}if("value"in A)return A.value;var U=A.get;return U!==void 0?U.call(y):void 0}(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"dispose",this).call(this)}}]),g}();S.isSupported=function(){return window.flvjs&&window.flvjs.isSupported()},S.formats={"video/flv":"FLV","video/x-flv":"FLV"},S.canPlayType=function(w){return S.isSupported()&&w in S.formats?"maybe":""},S.canPlaySource=function(w,g){return S.canPlayType(w.type)},S.VERSION="0.2.0",f.default.registerTech("Flvjs",S),N.default=S}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[1])(1)}),function(L){typeof exports=="object"&&typeof module<"u"?module.exports=L():typeof define=="function"&&define.amd?define([],L):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).adapter=L()}(function(){return function(){return function L(q,N,D){function I(f,m){if(!N[f]){if(!q[f]){var c=typeof require=="function"&&require;if(!m&&c)return c(f,!0);if(b)return b(f,!0);var T=new Error("Cannot find module '"+f+"'");throw T.code="MODULE_NOT_FOUND",T}var S=N[f]={exports:{}};q[f][0].call(S.exports,function(w){return I(q[f][1][w]||w)},S,S.exports,L,q,N,D)}return N[f].exports}for(var b=typeof require=="function"&&require,_=0;_<D.length;_++)I(D[_]);return I}}()({1:[function(L,q,N){"use strict";var D=(0,L("./adapter_factory.js").adapterFactory)({window:typeof window>"u"?void 0:window});q.exports=D},{"./adapter_factory.js":2}],2:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.adapterFactory=function(){var T=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).window,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},w=D.log,g=D.detectBrowser(T),d={browserDetails:g,commonShim:m,extractVersion:D.extractVersion,disableLog:D.disableLog,disableWarnings:D.disableWarnings};switch(g.browser){case"chrome":if(!I||!I.shimPeerConnection||!S.shimChrome)return w("Chrome shim is not included in this adapter release."),d;if(g.version===null)return w("Chrome shim can not determine version, not shimming."),d;w("adapter.js shimming chrome."),d.browserShim=I,I.shimGetUserMedia(T),I.shimMediaStream(T),I.shimPeerConnection(T),I.shimOnTrack(T),I.shimAddTrackRemoveTrack(T),I.shimGetSendersWithDtmf(T),I.shimGetStats(T),I.shimSenderReceiverGetStats(T),I.fixNegotiationNeeded(T),m.shimRTCIceCandidate(T),m.shimConnectionState(T),m.shimMaxMessageSize(T),m.shimSendThrowTypeError(T),m.removeAllowExtmapMixed(T);break;case"firefox":if(!_||!_.shimPeerConnection||!S.shimFirefox)return w("Firefox shim is not included in this adapter release."),d;w("adapter.js shimming firefox."),d.browserShim=_,_.shimGetUserMedia(T),_.shimPeerConnection(T),_.shimOnTrack(T),_.shimRemoveStream(T),_.shimSenderGetStats(T),_.shimReceiverGetStats(T),_.shimRTCDataChannel(T),_.shimAddTransceiver(T),_.shimGetParameters(T),_.shimCreateOffer(T),_.shimCreateAnswer(T),m.shimRTCIceCandidate(T),m.shimConnectionState(T),m.shimMaxMessageSize(T),m.shimSendThrowTypeError(T);break;case"edge":if(!b||!b.shimPeerConnection||!S.shimEdge)return w("MS edge shim is not included in this adapter release."),d;w("adapter.js shimming edge."),d.browserShim=b,b.shimGetUserMedia(T),b.shimGetDisplayMedia(T),b.shimPeerConnection(T),b.shimReplaceTrack(T),m.shimMaxMessageSize(T),m.shimSendThrowTypeError(T);break;case"safari":if(!f||!S.shimSafari)return w("Safari shim is not included in this adapter release."),d;w("adapter.js shimming safari."),d.browserShim=f,f.shimRTCIceServerUrls(T),f.shimCreateOfferLegacy(T),f.shimCallbacksAPI(T),f.shimLocalStreamsAPI(T),f.shimRemoteStreamsAPI(T),f.shimTrackEventTransceiver(T),f.shimGetUserMedia(T),f.shimAudioContext(T),m.shimRTCIceCandidate(T),m.shimMaxMessageSize(T),m.shimSendThrowTypeError(T),m.removeAllowExtmapMixed(T);break;default:w("Unsupported browser!")}return d};var D=c(L("./utils")),I=c(L("./chrome/chrome_shim")),b=c(L("./edge/edge_shim")),_=c(L("./firefox/firefox_shim")),f=c(L("./safari/safari_shim")),m=c(L("./common_shim"));function c(T){if(T&&T.__esModule)return T;var S={};if(T!=null)for(var w in T)Object.prototype.hasOwnProperty.call(T,w)&&(S[w]=T[w]);return S.default=T,S}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetDisplayMedia=N.shimGetUserMedia=void 0;var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},I=L("./getusermedia");Object.defineProperty(N,"shimGetUserMedia",{enumerable:!0,get:function(){return I.shimGetUserMedia}});var b=L("./getdisplaymedia");Object.defineProperty(N,"shimGetDisplayMedia",{enumerable:!0,get:function(){return b.shimGetDisplayMedia}}),N.shimMediaStream=function(c){c.MediaStream=c.MediaStream||c.webkitMediaStream},N.shimOnTrack=function(c){if((c===void 0?"undefined":D(c))!=="object"||!c.RTCPeerConnection||"ontrack"in c.RTCPeerConnection.prototype)_.wrapPeerConnectionEvent(c,"track",function(S){return S.transceiver||Object.defineProperty(S,"transceiver",{value:{receiver:S.receiver}}),S});else{Object.defineProperty(c.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(S){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=S)},enumerable:!0,configurable:!0});var T=c.RTCPeerConnection.prototype.setRemoteDescription;c.RTCPeerConnection.prototype.setRemoteDescription=function(){var S=this;return this._ontrackpoly||(this._ontrackpoly=function(w){w.stream.addEventListener("addtrack",function(g){var d=void 0;d=c.RTCPeerConnection.prototype.getReceivers?S.getReceivers().find(function(p){return p.track&&p.track.id===g.track.id}):{track:g.track};var l=new Event("track");l.track=g.track,l.receiver=d,l.transceiver={receiver:d},l.streams=[w.stream],S.dispatchEvent(l)}),w.stream.getTracks().forEach(function(g){var d=void 0;d=c.RTCPeerConnection.prototype.getReceivers?S.getReceivers().find(function(p){return p.track&&p.track.id===g.id}):{track:g};var l=new Event("track");l.track=g,l.receiver=d,l.transceiver={receiver:d},l.streams=[w.stream],S.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),T.apply(this,arguments)}}},N.shimGetSendersWithDtmf=function(c){if((c===void 0?"undefined":D(c))==="object"&&c.RTCPeerConnection&&!("getSenders"in c.RTCPeerConnection.prototype)&&"createDTMFSender"in c.RTCPeerConnection.prototype){var T=function(p,y){return{track:y,get dtmf(){return this._dtmf===void 0&&(y.kind==="audio"?this._dtmf=p.createDTMFSender(y):this._dtmf=null),this._dtmf},_pc:p}};if(!c.RTCPeerConnection.prototype.getSenders){c.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var S=c.RTCPeerConnection.prototype.addTrack;c.RTCPeerConnection.prototype.addTrack=function(p,y){var A=S.apply(this,arguments);return A||(A=T(this,p),this._senders.push(A)),A};var w=c.RTCPeerConnection.prototype.removeTrack;c.RTCPeerConnection.prototype.removeTrack=function(p){w.apply(this,arguments);var y=this._senders.indexOf(p);y!==-1&&this._senders.splice(y,1)}}var g=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(p){var y=this;this._senders=this._senders||[],g.apply(this,[p]),p.getTracks().forEach(function(A){y._senders.push(T(y,A))})};var d=c.RTCPeerConnection.prototype.removeStream;c.RTCPeerConnection.prototype.removeStream=function(p){var y=this;this._senders=this._senders||[],d.apply(this,[p]),p.getTracks().forEach(function(A){var P=y._senders.find(function(U){return U.track===A});P&&y._senders.splice(y._senders.indexOf(P),1)})}}else if((c===void 0?"undefined":D(c))==="object"&&c.RTCPeerConnection&&"getSenders"in c.RTCPeerConnection.prototype&&"createDTMFSender"in c.RTCPeerConnection.prototype&&c.RTCRtpSender&&!("dtmf"in c.RTCRtpSender.prototype)){var l=c.RTCPeerConnection.prototype.getSenders;c.RTCPeerConnection.prototype.getSenders=function(){var p=this,y=l.apply(this,[]);return y.forEach(function(A){return A._pc=p}),y},Object.defineProperty(c.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},N.shimGetStats=function(c){if(c.RTCPeerConnection){var T=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(){var S=this,w=Array.prototype.slice.call(arguments),g=w[0],d=w[1],l=w[2];if(arguments.length>0&&typeof g=="function")return T.apply(this,arguments);if(T.length===0&&(arguments.length===0||typeof g!="function"))return T.apply(this,[]);var p=function(A){var P={},U=A.result();return U.forEach(function(O){var V={id:O.id,timestamp:O.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[O.type]||O.type};O.names().forEach(function(z){V[z]=O.stat(z)}),P[V.id]=V}),P},y=function(A){return new Map(Object.keys(A).map(function(P){return[P,A[P]]}))};return arguments.length>=2?T.apply(this,[function(A){d(y(p(A)))},g]):new Promise(function(A,P){T.apply(S,[function(U){A(y(p(U)))},P])}).then(d,l)}}},N.shimSenderReceiverGetStats=function(c){if((c===void 0?"undefined":D(c))==="object"&&c.RTCPeerConnection&&c.RTCRtpSender&&c.RTCRtpReceiver){if(!("getStats"in c.RTCRtpSender.prototype)){var T=c.RTCPeerConnection.prototype.getSenders;T&&(c.RTCPeerConnection.prototype.getSenders=function(){var d=this,l=T.apply(this,[]);return l.forEach(function(p){return p._pc=d}),l});var S=c.RTCPeerConnection.prototype.addTrack;S&&(c.RTCPeerConnection.prototype.addTrack=function(){var d=S.apply(this,arguments);return d._pc=this,d}),c.RTCRtpSender.prototype.getStats=function(){var d=this;return this._pc.getStats().then(function(l){return _.filterStats(l,d.track,!0)})}}if(!("getStats"in c.RTCRtpReceiver.prototype)){var w=c.RTCPeerConnection.prototype.getReceivers;w&&(c.RTCPeerConnection.prototype.getReceivers=function(){var d=this,l=w.apply(this,[]);return l.forEach(function(p){return p._pc=d}),l}),_.wrapPeerConnectionEvent(c,"track",function(d){return d.receiver._pc=d.srcElement,d}),c.RTCRtpReceiver.prototype.getStats=function(){var d=this;return this._pc.getStats().then(function(l){return _.filterStats(l,d.track,!1)})}}if("getStats"in c.RTCRtpSender.prototype&&"getStats"in c.RTCRtpReceiver.prototype){var g=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof c.MediaStreamTrack){var d=arguments[0],l=void 0,p=void 0,y=void 0;return this.getSenders().forEach(function(A){A.track===d&&(l?y=!0:l=A)}),this.getReceivers().forEach(function(A){return A.track===d&&(p?y=!0:p=A),A.track===d}),y||l&&p?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):l?l.getStats():p?p.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return g.apply(this,arguments)}}}},N.shimAddTrackRemoveTrackWithNative=m,N.shimAddTrackRemoveTrack=function(c){if(!c.RTCPeerConnection)return;var T=_.detectBrowser(c);if(c.RTCPeerConnection.prototype.addTrack&&T.version>=65)return m(c);var S=c.RTCPeerConnection.prototype.getLocalStreams;c.RTCPeerConnection.prototype.getLocalStreams=function(){var y=this,A=S.apply(this);return this._reverseStreams=this._reverseStreams||{},A.map(function(P){return y._reverseStreams[P.id]})};var w=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(y){var A=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},y.getTracks().forEach(function(U){var O=A.getSenders().find(function(V){return V.track===U});if(O)throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[y.id]){var P=new c.MediaStream(y.getTracks());this._streams[y.id]=P,this._reverseStreams[P.id]=y,y=P}w.apply(this,[y])};var g=c.RTCPeerConnection.prototype.removeStream;function d(y,A){var P=A.sdp;return Object.keys(y._reverseStreams||[]).forEach(function(U){var O=y._reverseStreams[U],V=y._streams[O.id];P=P.replace(new RegExp(V.id,"g"),O.id)}),new RTCSessionDescription({type:A.type,sdp:P})}c.RTCPeerConnection.prototype.removeStream=function(y){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.apply(this,[this._streams[y.id]||y]),delete this._reverseStreams[this._streams[y.id]?this._streams[y.id].id:y.id],delete this._streams[y.id]},c.RTCPeerConnection.prototype.addTrack=function(y,A){var P=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var U=[].slice.call(arguments,1);if(U.length!==1||!U[0].getTracks().find(function(Z){return Z===y}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var O=this.getSenders().find(function(Z){return Z.track===y});if(O)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var V=this._streams[A.id];if(V)V.addTrack(y),Promise.resolve().then(function(){P.dispatchEvent(new Event("negotiationneeded"))});else{var z=new c.MediaStream([y]);this._streams[A.id]=z,this._reverseStreams[z.id]=A,this.addStream(z)}return this.getSenders().find(function(Z){return Z.track===y})},["createOffer","createAnswer"].forEach(function(y){var A=c.RTCPeerConnection.prototype[y],P=f({},y,function(){var U=this,O=arguments,V=arguments.length&&typeof arguments[0]=="function";return V?A.apply(this,[function(z){var Z=d(U,z);O[0].apply(null,[Z])},function(z){O[1]&&O[1].apply(null,z)},arguments[2]]):A.apply(this,arguments).then(function(z){return d(U,z)})});c.RTCPeerConnection.prototype[y]=P[y]});var l=c.RTCPeerConnection.prototype.setLocalDescription;c.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(y=this,A=arguments[0],P=A.sdp,Object.keys(y._reverseStreams||[]).forEach(function(U){var O=y._reverseStreams[U],V=y._streams[O.id];P=P.replace(new RegExp(O.id,"g"),V.id)}),new RTCSessionDescription({type:A.type,sdp:P})),l.apply(this,arguments)):l.apply(this,arguments);var y,A,P};var p=Object.getOwnPropertyDescriptor(c.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(c.RTCPeerConnection.prototype,"localDescription",{get:function(){var y=p.get.apply(this);return y.type===""?y:d(this,y)}}),c.RTCPeerConnection.prototype.removeTrack=function(y){var A=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!y._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var P=y._pc===this;if(!P)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var U=void 0;Object.keys(this._streams).forEach(function(O){var V=A._streams[O].getTracks().find(function(z){return y.track===z});V&&(U=A._streams[O])}),U&&(U.getTracks().length===1?this.removeStream(this._reverseStreams[U.id]):U.removeTrack(y.track),this.dispatchEvent(new Event("negotiationneeded")))}},N.shimPeerConnection=function(c){var T=_.detectBrowser(c);if(!c.RTCPeerConnection&&c.webkitRTCPeerConnection&&(c.RTCPeerConnection=c.webkitRTCPeerConnection),!!c.RTCPeerConnection){var S=c.RTCPeerConnection.prototype.addIceCandidate.length===0;T.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(g){var d=c.RTCPeerConnection.prototype[g],l=f({},g,function(){return arguments[0]=new(g==="addIceCandidate"?c.RTCIceCandidate:c.RTCSessionDescription)(arguments[0]),d.apply(this,arguments)});c.RTCPeerConnection.prototype[g]=l[g]});var w=c.RTCPeerConnection.prototype.addIceCandidate;c.RTCPeerConnection.prototype.addIceCandidate=function(){return S||arguments[0]?T.version<78&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():w.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},N.fixNegotiationNeeded=function(c){var T=_.detectBrowser(c);_.wrapPeerConnectionEvent(c,"negotiationneeded",function(S){var w=S.target;if(!(T.version<72||w.getConfiguration&&w.getConfiguration().sdpSemantics==="plan-b")||w.signalingState==="stable")return S})};var _=function(c){if(c&&c.__esModule)return c;var T={};if(c!=null)for(var S in c)Object.prototype.hasOwnProperty.call(c,S)&&(T[S]=c[S]);return T.default=c,T}(L("../utils.js"));function f(c,T,S){return T in c?Object.defineProperty(c,T,{value:S,enumerable:!0,configurable:!0,writable:!0}):c[T]=S,c}function m(c){c.RTCPeerConnection.prototype.getLocalStreams=function(){var d=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(l){return d._shimmedLocalStreams[l][0]})};var T=c.RTCPeerConnection.prototype.addTrack;c.RTCPeerConnection.prototype.addTrack=function(d,l){if(!l)return T.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var p=T.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(p)===-1&&this._shimmedLocalStreams[l.id].push(p):this._shimmedLocalStreams[l.id]=[l,p],p};var S=c.RTCPeerConnection.prototype.addStream;c.RTCPeerConnection.prototype.addStream=function(d){var l=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},d.getTracks().forEach(function(A){if(l.getSenders().find(function(P){return P.track===A}))throw new DOMException("Track already exists.","InvalidAccessError")});var p=this.getSenders();S.apply(this,arguments);var y=this.getSenders().filter(function(A){return p.indexOf(A)===-1});this._shimmedLocalStreams[d.id]=[d].concat(y)};var w=c.RTCPeerConnection.prototype.removeStream;c.RTCPeerConnection.prototype.removeStream=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[d.id],w.apply(this,arguments)};var g=c.RTCPeerConnection.prototype.removeTrack;c.RTCPeerConnection.prototype.removeTrack=function(d){var l=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},d&&Object.keys(this._shimmedLocalStreams).forEach(function(p){var y=l._shimmedLocalStreams[p].indexOf(d);y!==-1&&l._shimmedLocalStreams[p].splice(y,1),l._shimmedLocalStreams[p].length===1&&delete l._shimmedLocalStreams[p]}),g.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetDisplayMedia=function(D,I){if(!(D.navigator.mediaDevices&&"getDisplayMedia"in D.navigator.mediaDevices)&&D.navigator.mediaDevices){if(typeof I!="function")return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");D.navigator.mediaDevices.getDisplayMedia=function(b){return I(b).then(function(_){var f=b.video&&b.video.width,m=b.video&&b.video.height,c=b.video&&b.video.frameRate;return b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:_,maxFrameRate:c||3}},f&&(b.video.mandatory.maxWidth=f),m&&(b.video.mandatory.maxHeight=m),D.navigator.mediaDevices.getUserMedia(b)})}}}},{}],5:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _};N.shimGetUserMedia=function(_){var f=_&&_.navigator;if(f.mediaDevices){var m=I.detectBrowser(_),c=function(g){if((g===void 0?"undefined":D(g))!=="object"||g.mandatory||g.optional)return g;var d={};return Object.keys(g).forEach(function(l){if(l!=="require"&&l!=="advanced"&&l!=="mediaSource"){var p=D(g[l])==="object"?g[l]:{ideal:g[l]};p.exact!==void 0&&typeof p.exact=="number"&&(p.min=p.max=p.exact);var y=function(P,U){return P?P+U.charAt(0).toUpperCase()+U.slice(1):U==="deviceId"?"sourceId":U};if(p.ideal!==void 0){d.optional=d.optional||[];var A={};typeof p.ideal=="number"?(A[y("min",l)]=p.ideal,d.optional.push(A),(A={})[y("max",l)]=p.ideal,d.optional.push(A)):(A[y("",l)]=p.ideal,d.optional.push(A))}p.exact!==void 0&&typeof p.exact!="number"?(d.mandatory=d.mandatory||{},d.mandatory[y("",l)]=p.exact):["min","max"].forEach(function(P){p[P]!==void 0&&(d.mandatory=d.mandatory||{},d.mandatory[y(P,l)]=p[P])})}}),g.advanced&&(d.optional=(d.optional||[]).concat(g.advanced)),d},T=function(g,d){if(m.version>=61)return d(g);if((g=JSON.parse(JSON.stringify(g)))&&D(g.audio)==="object"){var l=function(P,U,O){U in P&&!(O in P)&&(P[O]=P[U],delete P[U])};g=JSON.parse(JSON.stringify(g)),l(g.audio,"autoGainControl","googAutoGainControl"),l(g.audio,"noiseSuppression","googNoiseSuppression"),g.audio=c(g.audio)}if(g&&D(g.video)==="object"){var p=g.video.facingMode;p=p&&((p===void 0?"undefined":D(p))==="object"?p:{ideal:p});var y=m.version<66;if(p&&(p.exact==="user"||p.exact==="environment"||p.ideal==="user"||p.ideal==="environment")&&(!f.mediaDevices.getSupportedConstraints||!f.mediaDevices.getSupportedConstraints().facingMode||y)){delete g.video.facingMode;var A=void 0;if(p.exact==="environment"||p.ideal==="environment"?A=["back","rear"]:p.exact!=="user"&&p.ideal!=="user"||(A=["front"]),A)return f.mediaDevices.enumerateDevices().then(function(P){var U=(P=P.filter(function(O){return O.kind==="videoinput"})).find(function(O){return A.some(function(V){return O.label.toLowerCase().includes(V)})});return!U&&P.length&&A.includes("back")&&(U=P[P.length-1]),U&&(g.video.deviceId=p.exact?{exact:U.deviceId}:{ideal:U.deviceId}),g.video=c(g.video),b("chrome: "+JSON.stringify(g)),d(g)})}g.video=c(g.video)}return b("chrome: "+JSON.stringify(g)),d(g)},S=function(g){return m.version>=64?g:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[g.name]||g.name,message:g.message,constraint:g.constraint||g.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(f.getUserMedia=function(g,d,l){T(g,function(p){f.webkitGetUserMedia(p,d,function(y){l&&l(S(y))})})}.bind(f),f.mediaDevices.getUserMedia){var w=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=function(g){return T(g,function(d){return w(d).then(function(l){if(d.audio&&!l.getAudioTracks().length||d.video&&!l.getVideoTracks().length)throw l.getTracks().forEach(function(p){p.stop()}),new DOMException("","NotFoundError");return l},function(l){return Promise.reject(S(l))})})}}}};var I=function(_){if(_&&_.__esModule)return _;var f={};if(_!=null)for(var m in _)Object.prototype.hasOwnProperty.call(_,m)&&(f[m]=_[m]);return f.default=_,f}(L("../utils.js")),b=I.log},{"../utils.js":15}],6:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m};N.shimRTCIceCandidate=function(m){if(!(!m.RTCIceCandidate||m.RTCIceCandidate&&"foundation"in m.RTCIceCandidate.prototype)){var c=m.RTCIceCandidate;m.RTCIceCandidate=function(T){if((T===void 0?"undefined":D(T))==="object"&&T.candidate&&T.candidate.indexOf("a=")===0&&((T=JSON.parse(JSON.stringify(T))).candidate=T.candidate.substr(2)),T.candidate&&T.candidate.length){var S=new c(T),w=_.default.parseCandidate(T.candidate),g=Object.assign(S,w);return g.toJSON=function(){return{candidate:g.candidate,sdpMid:g.sdpMid,sdpMLineIndex:g.sdpMLineIndex,usernameFragment:g.usernameFragment}},g}return new c(T)},m.RTCIceCandidate.prototype=c.prototype,f.wrapPeerConnectionEvent(m,"icecandidate",function(T){return T.candidate&&Object.defineProperty(T,"candidate",{value:new m.RTCIceCandidate(T.candidate),writable:"false"}),T})}},N.shimMaxMessageSize=function(m){if(m.RTCPeerConnection){var c=f.detectBrowser(m);"sctp"in m.RTCPeerConnection.prototype||Object.defineProperty(m.RTCPeerConnection.prototype,"sctp",{get:function(){return this._sctp===void 0?null:this._sctp}});var T=m.RTCPeerConnection.prototype.setRemoteDescription;m.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,c.browser==="chrome"&&c.version>=76){var S=this.getConfiguration(),w=S.sdpSemantics;w==="plan-b"&&Object.defineProperty(this,"sctp",{get:function(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(A){if(!A||!A.sdp)return!1;var P=_.default.splitSections(A.sdp);return P.shift(),P.some(function(U){var O=_.default.parseMLine(U);return O&&O.kind==="application"&&O.protocol.indexOf("SCTP")!==-1})}(arguments[0])){var g=function(A){var P=A.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(P===null||P.length<2)return-1;var U=parseInt(P[1],10);return U!=U?-1:U}(arguments[0]),d=function(A){var P=65536;return c.browser==="firefox"&&(P=c.version<57?A===-1?16384:2147483637:c.version<60?c.version===57?65535:65536:2147483637),P}(g),l=function(A,P){var U=65536;c.browser==="firefox"&&c.version===57&&(U=65535);var O=_.default.matchPrefix(A.sdp,"a=max-message-size:");return O.length>0?U=parseInt(O[0].substr(19),10):c.browser==="firefox"&&P!==-1&&(U=2147483637),U}(arguments[0],g),p=void 0;p=d===0&&l===0?Number.POSITIVE_INFINITY:d===0||l===0?Math.max(d,l):Math.min(d,l);var y={};Object.defineProperty(y,"maxMessageSize",{get:function(){return p}}),this._sctp=y}return T.apply(this,arguments)}}},N.shimSendThrowTypeError=function(m){if(!(m.RTCPeerConnection&&"createDataChannel"in m.RTCPeerConnection.prototype))return;function c(S,w){var g=S.send;S.send=function(){var d=arguments[0],l=d.length||d.size||d.byteLength;if(S.readyState==="open"&&w.sctp&&l>w.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+w.sctp.maxMessageSize+" bytes)");return g.apply(S,arguments)}}var T=m.RTCPeerConnection.prototype.createDataChannel;m.RTCPeerConnection.prototype.createDataChannel=function(){var S=T.apply(this,arguments);return c(S,this),S},f.wrapPeerConnectionEvent(m,"datachannel",function(S){return c(S.channel,S.target),S})},N.shimConnectionState=function(m){if(!(!m.RTCPeerConnection||"connectionState"in m.RTCPeerConnection.prototype)){var c=m.RTCPeerConnection.prototype;Object.defineProperty(c,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(c,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(T){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),T&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=T)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(T){var S=c[T];c[T]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(w){var g=w.target;if(g._lastConnectionState!==g.connectionState){g._lastConnectionState=g.connectionState;var d=new Event("connectionstatechange",w);g.dispatchEvent(d)}return w},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),S.apply(this,arguments)}})}},N.removeAllowExtmapMixed=function(m){if(m.RTCPeerConnection){var c=f.detectBrowser(m);if(!(c.browser==="chrome"&&c.version>=71)&&!(c.browser==="safari"&&c.version>=605)){var T=m.RTCPeerConnection.prototype.setRemoteDescription;m.RTCPeerConnection.prototype.setRemoteDescription=function(S){return S&&S.sdp&&S.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1&&(S.sdp=S.sdp.split(`
`).filter(function(w){return w.trim()!=="a=extmap-allow-mixed"}).join(`
`)),T.apply(this,arguments)}}}};var I,b=L("sdp"),_=(I=b)&&I.__esModule?I:{default:I},f=function(m){if(m&&m.__esModule)return m;var c={};if(m!=null)for(var T in m)Object.prototype.hasOwnProperty.call(m,T)&&(c[T]=m[T]);return c.default=m,c}(L("./utils"))},{"./utils":15,sdp:17}],7:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetDisplayMedia=N.shimGetUserMedia=void 0;var D=L("./getusermedia");Object.defineProperty(N,"shimGetUserMedia",{enumerable:!0,get:function(){return D.shimGetUserMedia}});var I=L("./getdisplaymedia");Object.defineProperty(N,"shimGetDisplayMedia",{enumerable:!0,get:function(){return I.shimGetDisplayMedia}}),N.shimPeerConnection=function(T){var S=_.detectBrowser(T);if(T.RTCIceGatherer&&(T.RTCIceCandidate||(T.RTCIceCandidate=function(d){return d}),T.RTCSessionDescription||(T.RTCSessionDescription=function(d){return d}),S.version<15025)){var w=Object.getOwnPropertyDescriptor(T.MediaStreamTrack.prototype,"enabled");Object.defineProperty(T.MediaStreamTrack.prototype,"enabled",{set:function(d){w.set.call(this,d);var l=new Event("enabled");l.enabled=d,this.dispatchEvent(l)}})}!T.RTCRtpSender||"dtmf"in T.RTCRtpSender.prototype||Object.defineProperty(T.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new T.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),T.RTCDtmfSender&&!T.RTCDTMFSender&&(T.RTCDTMFSender=T.RTCDtmfSender);var g=(0,c.default)(T,S.version);T.RTCPeerConnection=function(d){return d&&d.iceServers&&(d.iceServers=(0,f.filterIceServers)(d.iceServers,S.version),_.log("ICE servers after filtering:",d.iceServers)),new g(d)},T.RTCPeerConnection.prototype=g.prototype},N.shimReplaceTrack=function(T){!T.RTCRtpSender||"replaceTrack"in T.RTCRtpSender.prototype||(T.RTCRtpSender.prototype.replaceTrack=T.RTCRtpSender.prototype.setTrack)};var b,_=function(T){if(T&&T.__esModule)return T;var S={};if(T!=null)for(var w in T)Object.prototype.hasOwnProperty.call(T,w)&&(S[w]=T[w]);return S.default=T,S}(L("../utils")),f=L("./filtericeservers"),m=L("rtcpeerconnection-shim"),c=(b=m)&&b.__esModule?b:{default:b}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.filterIceServers=function(I,b){var _=!1;return(I=JSON.parse(JSON.stringify(I))).filter(function(f){if(f&&(f.urls||f.url)){var m=f.urls||f.url;f.url&&!f.urls&&D.deprecated("RTCIceServer.url","RTCIceServer.urls");var c=typeof m=="string";return c&&(m=[m]),m=m.filter(function(T){if(T.indexOf("stun:")===0)return!1;var S=T.startsWith("turn")&&!T.startsWith("turn:[")&&T.includes("transport=udp");return S&&!_?(_=!0,!0):S&&!_}),delete f.url,f.urls=c?m[0]:m,!!m.length}})};var D=function(I){if(I&&I.__esModule)return I;var b={};if(I!=null)for(var _ in I)Object.prototype.hasOwnProperty.call(I,_)&&(b[_]=I[_]);return b.default=I,b}(L("../utils"))},{"../utils":15}],9:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetDisplayMedia=function(D){"getDisplayMedia"in D.navigator&&D.navigator.mediaDevices&&(D.navigator.mediaDevices&&"getDisplayMedia"in D.navigator.mediaDevices||(D.navigator.mediaDevices.getDisplayMedia=D.navigator.getDisplayMedia.bind(D.navigator)))}},{}],10:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetUserMedia=function(D){var I=D&&D.navigator,b=I.mediaDevices.getUserMedia.bind(I.mediaDevices);I.mediaDevices.getUserMedia=function(_){return b(_).catch(function(f){return Promise.reject(function(m){return{name:{PermissionDeniedError:"NotAllowedError"}[m.name]||m.name,message:m.message,constraint:m.constraint,toString:function(){return this.name}}}(f))})}}},{}],11:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetDisplayMedia=N.shimGetUserMedia=void 0;var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},I=L("./getusermedia");Object.defineProperty(N,"shimGetUserMedia",{enumerable:!0,get:function(){return I.shimGetUserMedia}});var b=L("./getdisplaymedia");Object.defineProperty(N,"shimGetDisplayMedia",{enumerable:!0,get:function(){return b.shimGetDisplayMedia}}),N.shimOnTrack=function(f){(f===void 0?"undefined":D(f))==="object"&&f.RTCTrackEvent&&"receiver"in f.RTCTrackEvent.prototype&&!("transceiver"in f.RTCTrackEvent.prototype)&&Object.defineProperty(f.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},N.shimPeerConnection=function(f){var m=_.detectBrowser(f);if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCPeerConnection&&!f.mozRTCPeerConnection)){if(!f.RTCPeerConnection&&f.mozRTCPeerConnection&&(f.RTCPeerConnection=f.mozRTCPeerConnection),m.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(w){var g=f.RTCPeerConnection.prototype[w],d=function(l,p,y){return p in l?Object.defineProperty(l,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):l[p]=y,l}({},w,function(){return arguments[0]=new(w==="addIceCandidate"?f.RTCIceCandidate:f.RTCSessionDescription)(arguments[0]),g.apply(this,arguments)});f.RTCPeerConnection.prototype[w]=d[w]}),m.version<68){var c=f.RTCPeerConnection.prototype.addIceCandidate;f.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&arguments[0].candidate===""?Promise.resolve():c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var T={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},S=f.RTCPeerConnection.prototype.getStats;f.RTCPeerConnection.prototype.getStats=function(){var w=Array.prototype.slice.call(arguments),g=w[0],d=w[1],l=w[2];return S.apply(this,[g||null]).then(function(p){if(m.version<53&&!d)try{p.forEach(function(y){y.type=T[y.type]||y.type})}catch(y){if(y.name!=="TypeError")throw y;p.forEach(function(A,P){p.set(P,Object.assign({},A,{type:T[A.type]||A.type}))})}return p}).then(d,l)}}},N.shimSenderGetStats=function(f){if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCPeerConnection||!f.RTCRtpSender)&&!(f.RTCRtpSender&&"getStats"in f.RTCRtpSender.prototype)){var m=f.RTCPeerConnection.prototype.getSenders;m&&(f.RTCPeerConnection.prototype.getSenders=function(){var T=this,S=m.apply(this,[]);return S.forEach(function(w){return w._pc=T}),S});var c=f.RTCPeerConnection.prototype.addTrack;c&&(f.RTCPeerConnection.prototype.addTrack=function(){var T=c.apply(this,arguments);return T._pc=this,T}),f.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},N.shimReceiverGetStats=function(f){if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCPeerConnection||!f.RTCRtpSender)&&!(f.RTCRtpSender&&"getStats"in f.RTCRtpReceiver.prototype)){var m=f.RTCPeerConnection.prototype.getReceivers;m&&(f.RTCPeerConnection.prototype.getReceivers=function(){var c=this,T=m.apply(this,[]);return T.forEach(function(S){return S._pc=c}),T}),_.wrapPeerConnectionEvent(f,"track",function(c){return c.receiver._pc=c.srcElement,c}),f.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},N.shimRemoveStream=function(f){!f.RTCPeerConnection||"removeStream"in f.RTCPeerConnection.prototype||(f.RTCPeerConnection.prototype.removeStream=function(m){var c=this;_.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(T){T.track&&m.getTracks().includes(T.track)&&c.removeTrack(T)})})},N.shimRTCDataChannel=function(f){f.DataChannel&&!f.RTCDataChannel&&(f.RTCDataChannel=f.DataChannel)},N.shimAddTransceiver=function(f){if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCPeerConnection)){var m=f.RTCPeerConnection.prototype.addTransceiver;m&&(f.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var c=arguments[1],T=c&&"sendEncodings"in c;T&&c.sendEncodings.forEach(function(d){if("rid"in d&&!/^[a-z0-9]{0,16}$/i.test(d.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in d&&!(parseFloat(d.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in d&&!(parseFloat(d.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var S=m.apply(this,arguments);if(T){var w=S.sender,g=w.getParameters();"encodings"in g&&(g.encodings.length!==1||Object.keys(g.encodings[0]).length!==0)||(g.encodings=c.sendEncodings,w.sendEncodings=c.sendEncodings,this.setParametersPromises.push(w.setParameters(g).then(function(){delete w.sendEncodings}).catch(function(){delete w.sendEncodings})))}return S})}},N.shimGetParameters=function(f){if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCRtpSender)){var m=f.RTCRtpSender.prototype.getParameters;m&&(f.RTCRtpSender.prototype.getParameters=function(){var c=m.apply(this,arguments);return"encodings"in c||(c.encodings=[].concat(this.sendEncodings||[{}])),c})}},N.shimCreateOffer=function(f){if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCPeerConnection)){var m=f.RTCPeerConnection.prototype.createOffer;f.RTCPeerConnection.prototype.createOffer=function(){var c=this,T=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return m.apply(c,T)}).finally(function(){c.setParametersPromises=[]}):m.apply(this,arguments)}}},N.shimCreateAnswer=function(f){if(!((f===void 0?"undefined":D(f))!=="object"||!f.RTCPeerConnection)){var m=f.RTCPeerConnection.prototype.createAnswer;f.RTCPeerConnection.prototype.createAnswer=function(){var c=this,T=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return m.apply(c,T)}).finally(function(){c.setParametersPromises=[]}):m.apply(this,arguments)}}};var _=function(f){if(f&&f.__esModule)return f;var m={};if(f!=null)for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(m[c]=f[c]);return m.default=f,m}(L("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0}),N.shimGetDisplayMedia=function(D,I){D.navigator.mediaDevices&&"getDisplayMedia"in D.navigator.mediaDevices||D.navigator.mediaDevices&&(D.navigator.mediaDevices.getDisplayMedia=function(b){if(!b||!b.video){var _=new DOMException("getDisplayMedia without video constraints is undefined");return _.name="NotFoundError",_.code=8,Promise.reject(_)}return b.video===!0?b.video={mediaSource:I}:b.video.mediaSource=I,D.navigator.mediaDevices.getUserMedia(b)})}},{}],13:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b};N.shimGetUserMedia=function(b){var _=I.detectBrowser(b),f=b&&b.navigator,m=b&&b.MediaStreamTrack;if(f.getUserMedia=function(g,d,l){I.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),f.mediaDevices.getUserMedia(g).then(d,l)},!(_.version>55&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var c=function(g,d,l){d in g&&!(l in g)&&(g[l]=g[d],delete g[d])},T=f.mediaDevices.getUserMedia.bind(f.mediaDevices);if(f.mediaDevices.getUserMedia=function(g){return(g===void 0?"undefined":D(g))==="object"&&D(g.audio)==="object"&&(g=JSON.parse(JSON.stringify(g)),c(g.audio,"autoGainControl","mozAutoGainControl"),c(g.audio,"noiseSuppression","mozNoiseSuppression")),T(g)},m&&m.prototype.getSettings){var S=m.prototype.getSettings;m.prototype.getSettings=function(){var g=S.apply(this,arguments);return c(g,"mozAutoGainControl","autoGainControl"),c(g,"mozNoiseSuppression","noiseSuppression"),g}}if(m&&m.prototype.applyConstraints){var w=m.prototype.applyConstraints;m.prototype.applyConstraints=function(g){return this.kind==="audio"&&(g===void 0?"undefined":D(g))==="object"&&(g=JSON.parse(JSON.stringify(g)),c(g,"autoGainControl","mozAutoGainControl"),c(g,"noiseSuppression","mozNoiseSuppression")),w.apply(this,[g])}}}};var I=function(b){if(b&&b.__esModule)return b;var _={};if(b!=null)for(var f in b)Object.prototype.hasOwnProperty.call(b,f)&&(_[f]=b[f]);return _.default=b,_}(L("../utils"))},{"../utils":15}],14:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _};N.shimLocalStreamsAPI=function(_){if(!((_===void 0?"undefined":D(_))!=="object"||!_.RTCPeerConnection)){if("getLocalStreams"in _.RTCPeerConnection.prototype||(_.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in _.RTCPeerConnection.prototype)){var f=_.RTCPeerConnection.prototype.addTrack;_.RTCPeerConnection.prototype.addStream=function(m){var c=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(m)||this._localStreams.push(m),m.getAudioTracks().forEach(function(T){return f.call(c,T,m)}),m.getVideoTracks().forEach(function(T){return f.call(c,T,m)})},_.RTCPeerConnection.prototype.addTrack=function(m){for(var c=this,T=arguments.length,S=Array(T>1?T-1:0),w=1;w<T;w++)S[w-1]=arguments[w];return S&&S.forEach(function(g){c._localStreams?c._localStreams.includes(g)||c._localStreams.push(g):c._localStreams=[g]}),f.apply(this,arguments)}}"removeStream"in _.RTCPeerConnection.prototype||(_.RTCPeerConnection.prototype.removeStream=function(m){var c=this;this._localStreams||(this._localStreams=[]);var T=this._localStreams.indexOf(m);if(T!==-1){this._localStreams.splice(T,1);var S=m.getTracks();this.getSenders().forEach(function(w){S.includes(w.track)&&c.removeTrack(w)})}})}},N.shimRemoteStreamsAPI=function(_){if(!((_===void 0?"undefined":D(_))!=="object"||!_.RTCPeerConnection)&&("getRemoteStreams"in _.RTCPeerConnection.prototype||(_.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in _.RTCPeerConnection.prototype))){Object.defineProperty(_.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(m){var c=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=m),this.addEventListener("track",this._onaddstreampoly=function(T){T.streams.forEach(function(S){if(c._remoteStreams||(c._remoteStreams=[]),!c._remoteStreams.includes(S)){c._remoteStreams.push(S);var w=new Event("addstream");w.stream=S,c.dispatchEvent(w)}})})}});var f=_.RTCPeerConnection.prototype.setRemoteDescription;_.RTCPeerConnection.prototype.setRemoteDescription=function(){var m=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(function(T){if(m._remoteStreams||(m._remoteStreams=[]),!(m._remoteStreams.indexOf(T)>=0)){m._remoteStreams.push(T);var S=new Event("addstream");S.stream=T,m.dispatchEvent(S)}})}),f.apply(m,arguments)}}},N.shimCallbacksAPI=function(_){if(!((_===void 0?"undefined":D(_))!=="object"||!_.RTCPeerConnection)){var f=_.RTCPeerConnection.prototype,m=f.createOffer,c=f.createAnswer,T=f.setLocalDescription,S=f.setRemoteDescription,w=f.addIceCandidate;f.createOffer=function(d,l){var p=arguments.length>=2?arguments[2]:arguments[0],y=m.apply(this,[p]);return l?(y.then(d,l),Promise.resolve()):y},f.createAnswer=function(d,l){var p=arguments.length>=2?arguments[2]:arguments[0],y=c.apply(this,[p]);return l?(y.then(d,l),Promise.resolve()):y};var g=function(d,l,p){var y=T.apply(this,[d]);return p?(y.then(l,p),Promise.resolve()):y};f.setLocalDescription=g,g=function(d,l,p){var y=S.apply(this,[d]);return p?(y.then(l,p),Promise.resolve()):y},f.setRemoteDescription=g,g=function(d,l,p){var y=w.apply(this,[d]);return p?(y.then(l,p),Promise.resolve()):y},f.addIceCandidate=g}},N.shimGetUserMedia=function(_){var f=_&&_.navigator;if(f.mediaDevices&&f.mediaDevices.getUserMedia){var m=f.mediaDevices,c=m.getUserMedia.bind(m);f.mediaDevices.getUserMedia=function(T){return c(b(T))}}!f.getUserMedia&&f.mediaDevices&&f.mediaDevices.getUserMedia&&(f.getUserMedia=function(T,S,w){f.mediaDevices.getUserMedia(T).then(S,w)}.bind(f))},N.shimConstraints=b,N.shimRTCIceServerUrls=function(_){if(_.RTCPeerConnection){var f=_.RTCPeerConnection;_.RTCPeerConnection=function(m,c){if(m&&m.iceServers){for(var T=[],S=0;S<m.iceServers.length;S++){var w=m.iceServers[S];!w.hasOwnProperty("urls")&&w.hasOwnProperty("url")?(I.deprecated("RTCIceServer.url","RTCIceServer.urls"),(w=JSON.parse(JSON.stringify(w))).urls=w.url,delete w.url,T.push(w)):T.push(m.iceServers[S])}m.iceServers=T}return new f(m,c)},_.RTCPeerConnection.prototype=f.prototype,"generateCertificate"in f&&Object.defineProperty(_.RTCPeerConnection,"generateCertificate",{get:function(){return f.generateCertificate}})}},N.shimTrackEventTransceiver=function(_){(_===void 0?"undefined":D(_))==="object"&&_.RTCTrackEvent&&"receiver"in _.RTCTrackEvent.prototype&&!("transceiver"in _.RTCTrackEvent.prototype)&&Object.defineProperty(_.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},N.shimCreateOfferLegacy=function(_){var f=_.RTCPeerConnection.prototype.createOffer;_.RTCPeerConnection.prototype.createOffer=function(m){if(m){m.offerToReceiveAudio!==void 0&&(m.offerToReceiveAudio=!!m.offerToReceiveAudio);var c=this.getTransceivers().find(function(S){return S.receiver.track.kind==="audio"});m.offerToReceiveAudio===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):m.offerToReceiveAudio!==!0||c||this.addTransceiver("audio"),m.offerToReceiveVideo!==void 0&&(m.offerToReceiveVideo=!!m.offerToReceiveVideo);var T=this.getTransceivers().find(function(S){return S.receiver.track.kind==="video"});m.offerToReceiveVideo===!1&&T?T.direction==="sendrecv"?T.setDirection?T.setDirection("sendonly"):T.direction="sendonly":T.direction==="recvonly"&&(T.setDirection?T.setDirection("inactive"):T.direction="inactive"):m.offerToReceiveVideo!==!0||T||this.addTransceiver("video")}return f.apply(this,arguments)}},N.shimAudioContext=function(_){(_===void 0?"undefined":D(_))!=="object"||_.AudioContext||(_.AudioContext=_.webkitAudioContext)};var I=function(_){if(_&&_.__esModule)return _;var f={};if(_!=null)for(var m in _)Object.prototype.hasOwnProperty.call(_,m)&&(f[m]=_[m]);return f.default=_,f}(L("../utils"));function b(_){return _&&_.video!==void 0?Object.assign({},_,{video:I.compactObject(_.video)}):_}},{"../utils":15}],15:[function(L,q,N){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c};N.extractVersion=_,N.wrapPeerConnectionEvent=function(c,T,S){if(c.RTCPeerConnection){var w=c.RTCPeerConnection.prototype,g=w.addEventListener;w.addEventListener=function(l,p){if(l!==T)return g.apply(this,arguments);var y=function(A){var P=S(A);P&&(p.handleEvent?p.handleEvent(P):p(P))};return this._eventMap=this._eventMap||{},this._eventMap[T]||(this._eventMap[T]=new Map),this._eventMap[T].set(p,y),g.apply(this,[l,y])};var d=w.removeEventListener;w.removeEventListener=function(l,p){if(l!==T||!this._eventMap||!this._eventMap[T])return d.apply(this,arguments);if(!this._eventMap[T].has(p))return d.apply(this,arguments);var y=this._eventMap[T].get(p);return this._eventMap[T].delete(p),this._eventMap[T].size===0&&delete this._eventMap[T],Object.keys(this._eventMap).length===0&&delete this._eventMap,d.apply(this,[l,y])},Object.defineProperty(w,"on"+T,{get:function(){return this["_on"+T]},set:function(l){this["_on"+T]&&(this.removeEventListener(T,this["_on"+T]),delete this["_on"+T]),l&&this.addEventListener(T,this["_on"+T]=l)},enumerable:!0,configurable:!0})}},N.disableLog=function(c){return typeof c!="boolean"?new Error("Argument type: "+(c===void 0?"undefined":D(c))+". Please use a boolean."):(I=c,c?"adapter.js logging disabled":"adapter.js logging enabled")},N.disableWarnings=function(c){return typeof c!="boolean"?new Error("Argument type: "+(c===void 0?"undefined":D(c))+". Please use a boolean."):(b=!c,"adapter.js deprecation warnings "+(c?"disabled":"enabled"))},N.log=function(){if((typeof window>"u"?"undefined":D(window))==="object"){if(I)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}},N.deprecated=function(c,T){b&&console.warn(c+" is deprecated, please use "+T+" instead.")},N.detectBrowser=function(c){var T={browser:null,version:null};if(c===void 0||!c.navigator)return T.browser="Not a browser.",T;var S=c.navigator;if(S.mozGetUserMedia)T.browser="firefox",T.version=_(S.userAgent,/Firefox\/(\d+)\./,1);else if(S.webkitGetUserMedia||c.isSecureContext===!1&&c.webkitRTCPeerConnection&&!c.RTCIceGatherer)T.browser="chrome",T.version=_(S.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(S.mediaDevices&&S.userAgent.match(/Edge\/(\d+).(\d+)$/))T.browser="edge",T.version=_(S.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!c.RTCPeerConnection||!S.userAgent.match(/AppleWebKit\/(\d+)\./))return T.browser="Not a supported browser.",T;T.browser="safari",T.version=_(S.userAgent,/AppleWebKit\/(\d+)\./,1),T.supportsUnifiedPlan=c.RTCRtpTransceiver&&"currentDirection"in c.RTCRtpTransceiver.prototype}return T},N.compactObject=function c(T){return f(T)?Object.keys(T).reduce(function(S,w){var g=f(T[w]),d=g?c(T[w]):T[w],l=g&&!Object.keys(d).length;return d===void 0||l?S:Object.assign(S,function(p,y,A){return y in p?Object.defineProperty(p,y,{value:A,enumerable:!0,configurable:!0,writable:!0}):p[y]=A,p}({},w,d))},{}):T},N.walkStats=m,N.filterStats=function(c,T,S){var w=S?"outbound-rtp":"inbound-rtp",g=new Map;if(T===null)return g;var d=[];return c.forEach(function(l){l.type==="track"&&l.trackIdentifier===T.id&&d.push(l)}),d.forEach(function(l){c.forEach(function(p){p.type===w&&p.trackId===l.id&&m(c,p,g)})}),g};var I=!0,b=!0;function _(c,T,S){var w=c.match(T);return w&&w.length>=S&&parseInt(w[S],10)}function f(c){return Object.prototype.toString.call(c)==="[object Object]"}function m(c,T,S){T&&!S.has(T.id)&&(S.set(T.id,T),Object.keys(T).forEach(function(w){w.endsWith("Id")?m(c,c.get(T[w]),S):w.endsWith("Ids")&&T[w].forEach(function(g){m(c,c.get(g),S)})}))}},{}],16:[function(L,q,N){"use strict";var D=L("sdp");function I(c,T,S,w,g){var d=D.writeRtpDescription(c.kind,T);if(d+=D.writeIceParameters(c.iceGatherer.getLocalParameters()),d+=D.writeDtlsParameters(c.dtlsTransport.getLocalParameters(),S==="offer"?"actpass":g||"active"),d+="a=mid:"+c.mid+`\r
`,c.rtpSender&&c.rtpReceiver?d+=`a=sendrecv\r
`:c.rtpSender?d+=`a=sendonly\r
`:c.rtpReceiver?d+=`a=recvonly\r
`:d+=`a=inactive\r
`,c.rtpSender){var l=c.rtpSender._initialTrackId||c.rtpSender.track.id;c.rtpSender._initialTrackId=l;var p="msid:"+(w?w.id:"-")+" "+l+`\r
`;d+="a="+p,d+="a=ssrc:"+c.sendEncodingParameters[0].ssrc+" "+p,c.sendEncodingParameters[0].rtx&&(d+="a=ssrc:"+c.sendEncodingParameters[0].rtx.ssrc+" "+p,d+="a=ssrc-group:FID "+c.sendEncodingParameters[0].ssrc+" "+c.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return d+="a=ssrc:"+c.sendEncodingParameters[0].ssrc+" cname:"+D.localCName+`\r
`,c.rtpSender&&c.sendEncodingParameters[0].rtx&&(d+="a=ssrc:"+c.sendEncodingParameters[0].rtx.ssrc+" cname:"+D.localCName+`\r
`),d}function b(c,T){var S={codecs:[],headerExtensions:[],fecMechanisms:[]},w=function(d,l){d=parseInt(d,10);for(var p=0;p<l.length;p++)if(l[p].payloadType===d||l[p].preferredPayloadType===d)return l[p]},g=function(d,l,p,y){var A=w(d.parameters.apt,p),P=w(l.parameters.apt,y);return A&&P&&A.name.toLowerCase()===P.name.toLowerCase()};return c.codecs.forEach(function(d){for(var l=0;l<T.codecs.length;l++){var p=T.codecs[l];if(d.name.toLowerCase()===p.name.toLowerCase()&&d.clockRate===p.clockRate){if(d.name.toLowerCase()==="rtx"&&d.parameters&&p.parameters.apt&&!g(d,p,c.codecs,T.codecs))continue;(p=JSON.parse(JSON.stringify(p))).numChannels=Math.min(d.numChannels,p.numChannels),S.codecs.push(p),p.rtcpFeedback=p.rtcpFeedback.filter(function(y){for(var A=0;A<d.rtcpFeedback.length;A++)if(d.rtcpFeedback[A].type===y.type&&d.rtcpFeedback[A].parameter===y.parameter)return!0;return!1});break}}}),c.headerExtensions.forEach(function(d){for(var l=0;l<T.headerExtensions.length;l++){var p=T.headerExtensions[l];if(d.uri===p.uri){S.headerExtensions.push(p);break}}}),S}function _(c,T,S){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[T][c].indexOf(S)!==-1}function f(c,T){var S=c.getRemoteCandidates().find(function(w){return T.foundation===w.foundation&&T.ip===w.ip&&T.port===w.port&&T.priority===w.priority&&T.protocol===w.protocol&&T.type===w.type});return S||c.addRemoteCandidate(T),!S}function m(c,T){var S=new Error(T);return S.name=c,S.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[c],S}q.exports=function(c,T){function S(l,p){p.addTrack(l),p.dispatchEvent(new c.MediaStreamTrackEvent("addtrack",{track:l}))}function w(l,p,y,A){var P=new Event("track");P.track=p,P.receiver=y,P.transceiver={receiver:y},P.streams=A,c.setTimeout(function(){l._dispatchEvent("track",P)})}var g=function(l){var p=this,y=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(P){p[P]=y[P].bind(y)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",l=JSON.parse(JSON.stringify(l||{})),this.usingBundle=l.bundlePolicy==="max-bundle",l.rtcpMuxPolicy==="negotiate")throw m("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(l.rtcpMuxPolicy||(l.rtcpMuxPolicy="require"),l.iceTransportPolicy){case"all":case"relay":break;default:l.iceTransportPolicy="all"}switch(l.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:l.bundlePolicy="balanced"}if(l.iceServers=function(P,U){var O=!1;return(P=JSON.parse(JSON.stringify(P))).filter(function(V){if(V&&(V.urls||V.url)){var z=V.urls||V.url;V.url&&!V.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var Z=typeof z=="string";return Z&&(z=[z]),z=z.filter(function(te){return te.indexOf("turn:")!==0||te.indexOf("transport=udp")===-1||te.indexOf("turn:[")!==-1||O?te.indexOf("stun:")===0&&U>=14393&&te.indexOf("?transport=udp")===-1:(O=!0,!0)}),delete V.url,V.urls=Z?z[0]:z,!!z.length}})}(l.iceServers||[],T),this._iceGatherers=[],l.iceCandidatePoolSize)for(var A=l.iceCandidatePoolSize;A>0;A--)this._iceGatherers.push(new c.RTCIceGatherer({iceServers:l.iceServers,gatherPolicy:l.iceTransportPolicy}));else l.iceCandidatePoolSize=0;this._config=l,this.transceivers=[],this._sdpSessionId=D.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(g.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(g.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),g.prototype.onicecandidate=null,g.prototype.onaddstream=null,g.prototype.ontrack=null,g.prototype.onremovestream=null,g.prototype.onsignalingstatechange=null,g.prototype.oniceconnectionstatechange=null,g.prototype.onconnectionstatechange=null,g.prototype.onicegatheringstatechange=null,g.prototype.onnegotiationneeded=null,g.prototype.ondatachannel=null,g.prototype._dispatchEvent=function(l,p){this._isClosed||(this.dispatchEvent(p),typeof this["on"+l]=="function"&&this["on"+l](p))},g.prototype._emitGatheringStateChange=function(){var l=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",l)},g.prototype.getConfiguration=function(){return this._config},g.prototype.getLocalStreams=function(){return this.localStreams},g.prototype.getRemoteStreams=function(){return this.remoteStreams},g.prototype._createTransceiver=function(l,p){var y=this.transceivers.length>0,A={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:l,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&y)A.iceTransport=this.transceivers[0].iceTransport,A.dtlsTransport=this.transceivers[0].dtlsTransport;else{var P=this._createIceAndDtlsTransports();A.iceTransport=P.iceTransport,A.dtlsTransport=P.dtlsTransport}return p||this.transceivers.push(A),A},g.prototype.addTrack=function(l,p){if(this._isClosed)throw m("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var y;if(this.transceivers.find(function(P){return P.track===l}))throw m("InvalidAccessError","Track already exists.");for(var A=0;A<this.transceivers.length;A++)this.transceivers[A].track||this.transceivers[A].kind!==l.kind||(y=this.transceivers[A]);return y||(y=this._createTransceiver(l.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(p)===-1&&this.localStreams.push(p),y.track=l,y.stream=p,y.rtpSender=new c.RTCRtpSender(l,y.dtlsTransport),y.rtpSender},g.prototype.addStream=function(l){var p=this;if(T>=15025)l.getTracks().forEach(function(A){p.addTrack(A,l)});else{var y=l.clone();l.getTracks().forEach(function(A,P){var U=y.getTracks()[P];A.addEventListener("enabled",function(O){U.enabled=O.enabled})}),y.getTracks().forEach(function(A){p.addTrack(A,y)})}},g.prototype.removeTrack=function(l){if(this._isClosed)throw m("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(l instanceof c.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var p=this.transceivers.find(function(A){return A.rtpSender===l});if(!p)throw m("InvalidAccessError","Sender was not created by this connection.");var y=p.stream;p.rtpSender.stop(),p.rtpSender=null,p.track=null,p.stream=null,this.transceivers.map(function(A){return A.stream}).indexOf(y)===-1&&this.localStreams.indexOf(y)>-1&&this.localStreams.splice(this.localStreams.indexOf(y),1),this._maybeFireNegotiationNeeded()},g.prototype.removeStream=function(l){var p=this;l.getTracks().forEach(function(y){var A=p.getSenders().find(function(P){return P.track===y});A&&p.removeTrack(A)})},g.prototype.getSenders=function(){return this.transceivers.filter(function(l){return!!l.rtpSender}).map(function(l){return l.rtpSender})},g.prototype.getReceivers=function(){return this.transceivers.filter(function(l){return!!l.rtpReceiver}).map(function(l){return l.rtpReceiver})},g.prototype._createIceGatherer=function(l,p){var y=this;if(p&&l>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var A=new c.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(A,"state",{value:"new",writable:!0}),this.transceivers[l].bufferedCandidateEvents=[],this.transceivers[l].bufferCandidates=function(P){var U=!P.candidate||Object.keys(P.candidate).length===0;A.state=U?"completed":"gathering",y.transceivers[l].bufferedCandidateEvents!==null&&y.transceivers[l].bufferedCandidateEvents.push(P)},A.addEventListener("localcandidate",this.transceivers[l].bufferCandidates),A},g.prototype._gather=function(l,p){var y=this,A=this.transceivers[p].iceGatherer;if(!A.onlocalcandidate){var P=this.transceivers[p].bufferedCandidateEvents;this.transceivers[p].bufferedCandidateEvents=null,A.removeEventListener("localcandidate",this.transceivers[p].bufferCandidates),A.onlocalcandidate=function(U){if(!(y.usingBundle&&p>0)){var O=new Event("icecandidate");O.candidate={sdpMid:l,sdpMLineIndex:p};var V=U.candidate,z=!V||Object.keys(V).length===0;if(z)A.state!=="new"&&A.state!=="gathering"||(A.state="completed");else{A.state==="new"&&(A.state="gathering"),V.component=1,V.ufrag=A.getLocalParameters().usernameFragment;var Z=D.writeCandidate(V);O.candidate=Object.assign(O.candidate,D.parseCandidate(Z)),O.candidate.candidate=Z,O.candidate.toJSON=function(){return{candidate:O.candidate.candidate,sdpMid:O.candidate.sdpMid,sdpMLineIndex:O.candidate.sdpMLineIndex,usernameFragment:O.candidate.usernameFragment}}}var te=D.getMediaSections(y._localDescription.sdp);te[O.candidate.sdpMLineIndex]+=z?`a=end-of-candidates\r
`:"a="+O.candidate.candidate+`\r
`,y._localDescription.sdp=D.getDescription(y._localDescription.sdp)+te.join("");var se=y.transceivers.every(function(ue){return ue.iceGatherer&&ue.iceGatherer.state==="completed"});y.iceGatheringState!=="gathering"&&(y.iceGatheringState="gathering",y._emitGatheringStateChange()),z||y._dispatchEvent("icecandidate",O),se&&(y._dispatchEvent("icecandidate",new Event("icecandidate")),y.iceGatheringState="complete",y._emitGatheringStateChange())}},c.setTimeout(function(){P.forEach(function(U){A.onlocalcandidate(U)})},0)}},g.prototype._createIceAndDtlsTransports=function(){var l=this,p=new c.RTCIceTransport(null);p.onicestatechange=function(){l._updateIceConnectionState(),l._updateConnectionState()};var y=new c.RTCDtlsTransport(p);return y.ondtlsstatechange=function(){l._updateConnectionState()},y.onerror=function(){Object.defineProperty(y,"state",{value:"failed",writable:!0}),l._updateConnectionState()},{iceTransport:p,dtlsTransport:y}},g.prototype._disposeIceAndDtlsTransports=function(l){var p=this.transceivers[l].iceGatherer;p&&(delete p.onlocalcandidate,delete this.transceivers[l].iceGatherer);var y=this.transceivers[l].iceTransport;y&&(delete y.onicestatechange,delete this.transceivers[l].iceTransport);var A=this.transceivers[l].dtlsTransport;A&&(delete A.ondtlsstatechange,delete A.onerror,delete this.transceivers[l].dtlsTransport)},g.prototype._transceive=function(l,p,y){var A=b(l.localCapabilities,l.remoteCapabilities);p&&l.rtpSender&&(A.encodings=l.sendEncodingParameters,A.rtcp={cname:D.localCName,compound:l.rtcpParameters.compound},l.recvEncodingParameters.length&&(A.rtcp.ssrc=l.recvEncodingParameters[0].ssrc),l.rtpSender.send(A)),y&&l.rtpReceiver&&A.codecs.length>0&&(l.kind==="video"&&l.recvEncodingParameters&&T<15019&&l.recvEncodingParameters.forEach(function(P){delete P.rtx}),l.recvEncodingParameters.length?A.encodings=l.recvEncodingParameters:A.encodings=[{}],A.rtcp={compound:l.rtcpParameters.compound},l.rtcpParameters.cname&&(A.rtcp.cname=l.rtcpParameters.cname),l.sendEncodingParameters.length&&(A.rtcp.ssrc=l.sendEncodingParameters[0].ssrc),l.rtpReceiver.receive(A))},g.prototype.setLocalDescription=function(l){var p,y,A=this;if(["offer","answer"].indexOf(l.type)===-1)return Promise.reject(m("TypeError",'Unsupported type "'+l.type+'"'));if(!_("setLocalDescription",l.type,A.signalingState)||A._isClosed)return Promise.reject(m("InvalidStateError","Can not set local "+l.type+" in state "+A.signalingState));if(l.type==="offer")p=D.splitSections(l.sdp),y=p.shift(),p.forEach(function(U,O){var V=D.parseRtpParameters(U);A.transceivers[O].localCapabilities=V}),A.transceivers.forEach(function(U,O){A._gather(U.mid,O)});else if(l.type==="answer"){p=D.splitSections(A._remoteDescription.sdp),y=p.shift();var P=D.matchPrefix(y,"a=ice-lite").length>0;p.forEach(function(U,O){var V=A.transceivers[O],z=V.iceGatherer,Z=V.iceTransport,te=V.dtlsTransport,se=V.localCapabilities,ue=V.remoteCapabilities;if(!(D.isRejected(U)&&D.matchPrefix(U,"a=bundle-only").length===0)&&!V.rejected){var de=D.getIceParameters(U,y),ke=D.getDtlsParameters(U,y);P&&(ke.role="server"),A.usingBundle&&O!==0||(A._gather(V.mid,O),Z.state==="new"&&Z.start(z,de,P?"controlling":"controlled"),te.state==="new"&&te.start(ke));var Te=b(se,ue);A._transceive(V,Te.codecs.length>0,!1)}})}return A._localDescription={type:l.type,sdp:l.sdp},l.type==="offer"?A._updateSignalingState("have-local-offer"):A._updateSignalingState("stable"),Promise.resolve()},g.prototype.setRemoteDescription=function(l){var p=this;if(["offer","answer"].indexOf(l.type)===-1)return Promise.reject(m("TypeError",'Unsupported type "'+l.type+'"'));if(!_("setRemoteDescription",l.type,p.signalingState)||p._isClosed)return Promise.reject(m("InvalidStateError","Can not set remote "+l.type+" in state "+p.signalingState));var y={};p.remoteStreams.forEach(function(Z){y[Z.id]=Z});var A=[],P=D.splitSections(l.sdp),U=P.shift(),O=D.matchPrefix(U,"a=ice-lite").length>0,V=D.matchPrefix(U,"a=group:BUNDLE ").length>0;p.usingBundle=V;var z=D.matchPrefix(U,"a=ice-options:")[0];return p.canTrickleIceCandidates=!!z&&z.substr(14).split(" ").indexOf("trickle")>=0,P.forEach(function(Z,te){var se=D.splitLines(Z),ue=D.getKind(Z),de=D.isRejected(Z)&&D.matchPrefix(Z,"a=bundle-only").length===0,ke=se[0].substr(2).split(" ")[2],Te=D.getDirection(Z,U),he=D.parseMsid(Z),Ne=D.getMid(Z)||D.generateIdentifier();if(de||ue==="application"&&(ke==="DTLS/SCTP"||ke==="UDP/DTLS/SCTP"))p.transceivers[te]={mid:Ne,kind:ue,protocol:ke,rejected:!0};else{var ve,Fe,Oe,Ve,Ce,ze,tt,ct,Ge;!de&&p.transceivers[te]&&p.transceivers[te].rejected&&(p.transceivers[te]=p._createTransceiver(ue,!0));var He,rt,De=D.parseRtpParameters(Z);de||(He=D.getIceParameters(Z,U),(rt=D.getDtlsParameters(Z,U)).role="client"),tt=D.parseRtpEncodingParameters(Z);var re=D.parseRtcpParameters(Z),ae=D.matchPrefix(Z,"a=end-of-candidates",U).length>0,be=D.matchPrefix(Z,"a=candidate:").map(function(we){return D.parseCandidate(we)}).filter(function(we){return we.component===1});if((l.type==="offer"||l.type==="answer")&&!de&&V&&te>0&&p.transceivers[te]&&(p._disposeIceAndDtlsTransports(te),p.transceivers[te].iceGatherer=p.transceivers[0].iceGatherer,p.transceivers[te].iceTransport=p.transceivers[0].iceTransport,p.transceivers[te].dtlsTransport=p.transceivers[0].dtlsTransport,p.transceivers[te].rtpSender&&p.transceivers[te].rtpSender.setTransport(p.transceivers[0].dtlsTransport),p.transceivers[te].rtpReceiver&&p.transceivers[te].rtpReceiver.setTransport(p.transceivers[0].dtlsTransport)),l.type!=="offer"||de)l.type==="answer"&&!de&&(Fe=(ve=p.transceivers[te]).iceGatherer,Oe=ve.iceTransport,Ve=ve.dtlsTransport,Ce=ve.rtpReceiver,ze=ve.sendEncodingParameters,ct=ve.localCapabilities,p.transceivers[te].recvEncodingParameters=tt,p.transceivers[te].remoteCapabilities=De,p.transceivers[te].rtcpParameters=re,be.length&&Oe.state==="new"&&(!O&&!ae||V&&te!==0?be.forEach(function(we){f(ve.iceTransport,we)}):Oe.setRemoteCandidates(be)),V&&te!==0||(Oe.state==="new"&&Oe.start(Fe,He,"controlling"),Ve.state==="new"&&Ve.start(rt)),!b(ve.localCapabilities,ve.remoteCapabilities).codecs.filter(function(we){return we.name.toLowerCase()==="rtx"}).length&&ve.sendEncodingParameters[0].rtx&&delete ve.sendEncodingParameters[0].rtx,p._transceive(ve,Te==="sendrecv"||Te==="recvonly",Te==="sendrecv"||Te==="sendonly"),!Ce||Te!=="sendrecv"&&Te!=="sendonly"?delete ve.rtpReceiver:(Ge=Ce.track,he?(y[he.stream]||(y[he.stream]=new c.MediaStream),S(Ge,y[he.stream]),A.push([Ge,Ce,y[he.stream]])):(y.default||(y.default=new c.MediaStream),S(Ge,y.default),A.push([Ge,Ce,y.default]))));else{(ve=p.transceivers[te]||p._createTransceiver(ue)).mid=Ne,ve.iceGatherer||(ve.iceGatherer=p._createIceGatherer(te,V)),be.length&&ve.iceTransport.state==="new"&&(!ae||V&&te!==0?be.forEach(function(we){f(ve.iceTransport,we)}):ve.iceTransport.setRemoteCandidates(be)),ct=c.RTCRtpReceiver.getCapabilities(ue),T<15019&&(ct.codecs=ct.codecs.filter(function(we){return we.name!=="rtx"})),ze=ve.sendEncodingParameters||[{ssrc:1001*(2*te+2)}];var _e,Pe=!1;Te==="sendrecv"||Te==="sendonly"?(Pe=!ve.rtpReceiver,Ce=ve.rtpReceiver||new c.RTCRtpReceiver(ve.dtlsTransport,ue),Pe&&(Ge=Ce.track,he&&he.stream==="-"||(he?(y[he.stream]||(y[he.stream]=new c.MediaStream,Object.defineProperty(y[he.stream],"id",{get:function(){return he.stream}})),Object.defineProperty(Ge,"id",{get:function(){return he.track}}),_e=y[he.stream]):(y.default||(y.default=new c.MediaStream),_e=y.default)),_e&&(S(Ge,_e),ve.associatedRemoteMediaStreams.push(_e)),A.push([Ge,Ce,_e]))):ve.rtpReceiver&&ve.rtpReceiver.track&&(ve.associatedRemoteMediaStreams.forEach(function(we){var Je,st,wt=we.getTracks().find(function(Xe){return Xe.id===ve.rtpReceiver.track.id});wt&&(Je=wt,(st=we).removeTrack(Je),st.dispatchEvent(new c.MediaStreamTrackEvent("removetrack",{track:Je})))}),ve.associatedRemoteMediaStreams=[]),ve.localCapabilities=ct,ve.remoteCapabilities=De,ve.rtpReceiver=Ce,ve.rtcpParameters=re,ve.sendEncodingParameters=ze,ve.recvEncodingParameters=tt,p._transceive(p.transceivers[te],!1,Pe)}}}),p._dtlsRole===void 0&&(p._dtlsRole=l.type==="offer"?"active":"passive"),p._remoteDescription={type:l.type,sdp:l.sdp},l.type==="offer"?p._updateSignalingState("have-remote-offer"):p._updateSignalingState("stable"),Object.keys(y).forEach(function(Z){var te=y[Z];if(te.getTracks().length){if(p.remoteStreams.indexOf(te)===-1){p.remoteStreams.push(te);var se=new Event("addstream");se.stream=te,c.setTimeout(function(){p._dispatchEvent("addstream",se)})}A.forEach(function(ue){var de=ue[0],ke=ue[1];te.id===ue[2].id&&w(p,de,ke,[te])})}}),A.forEach(function(Z){Z[2]||w(p,Z[0],Z[1],[])}),c.setTimeout(function(){p&&p.transceivers&&p.transceivers.forEach(function(Z){Z.iceTransport&&Z.iceTransport.state==="new"&&Z.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),Z.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},g.prototype.close=function(){this.transceivers.forEach(function(l){l.iceTransport&&l.iceTransport.stop(),l.dtlsTransport&&l.dtlsTransport.stop(),l.rtpSender&&l.rtpSender.stop(),l.rtpReceiver&&l.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},g.prototype._updateSignalingState=function(l){this.signalingState=l;var p=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",p)},g.prototype._maybeFireNegotiationNeeded=function(){var l=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,c.setTimeout(function(){if(l.needNegotiation){l.needNegotiation=!1;var p=new Event("negotiationneeded");l._dispatchEvent("negotiationneeded",p)}},0))},g.prototype._updateIceConnectionState=function(){var l,p={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(A){A.iceTransport&&!A.rejected&&p[A.iceTransport.state]++}),l="new",p.failed>0?l="failed":p.checking>0?l="checking":p.disconnected>0?l="disconnected":p.new>0?l="new":p.connected>0?l="connected":p.completed>0&&(l="completed"),l!==this.iceConnectionState){this.iceConnectionState=l;var y=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",y)}},g.prototype._updateConnectionState=function(){var l,p={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(A){A.iceTransport&&A.dtlsTransport&&!A.rejected&&(p[A.iceTransport.state]++,p[A.dtlsTransport.state]++)}),p.connected+=p.completed,l="new",p.failed>0?l="failed":p.connecting>0?l="connecting":p.disconnected>0?l="disconnected":p.new>0?l="new":p.connected>0&&(l="connected"),l!==this.connectionState){this.connectionState=l;var y=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",y)}},g.prototype.createOffer=function(){var l=this;if(l._isClosed)return Promise.reject(m("InvalidStateError","Can not call createOffer after close"));var p=l.transceivers.filter(function(O){return O.kind==="audio"}).length,y=l.transceivers.filter(function(O){return O.kind==="video"}).length,A=arguments[0];if(A){if(A.mandatory||A.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");A.offerToReceiveAudio!==void 0&&(p=A.offerToReceiveAudio===!0?1:A.offerToReceiveAudio===!1?0:A.offerToReceiveAudio),A.offerToReceiveVideo!==void 0&&(y=A.offerToReceiveVideo===!0?1:A.offerToReceiveVideo===!1?0:A.offerToReceiveVideo)}for(l.transceivers.forEach(function(O){O.kind==="audio"?--p<0&&(O.wantReceive=!1):O.kind==="video"&&--y<0&&(O.wantReceive=!1)});p>0||y>0;)p>0&&(l._createTransceiver("audio"),p--),y>0&&(l._createTransceiver("video"),y--);var P=D.writeSessionBoilerplate(l._sdpSessionId,l._sdpSessionVersion++);l.transceivers.forEach(function(O,V){var z=O.track,Z=O.kind,te=O.mid||D.generateIdentifier();O.mid=te,O.iceGatherer||(O.iceGatherer=l._createIceGatherer(V,l.usingBundle));var se=c.RTCRtpSender.getCapabilities(Z);T<15019&&(se.codecs=se.codecs.filter(function(de){return de.name!=="rtx"})),se.codecs.forEach(function(de){de.name==="H264"&&de.parameters["level-asymmetry-allowed"]===void 0&&(de.parameters["level-asymmetry-allowed"]="1"),O.remoteCapabilities&&O.remoteCapabilities.codecs&&O.remoteCapabilities.codecs.forEach(function(ke){de.name.toLowerCase()===ke.name.toLowerCase()&&de.clockRate===ke.clockRate&&(de.preferredPayloadType=ke.payloadType)})}),se.headerExtensions.forEach(function(de){(O.remoteCapabilities&&O.remoteCapabilities.headerExtensions||[]).forEach(function(ke){de.uri===ke.uri&&(de.id=ke.id)})});var ue=O.sendEncodingParameters||[{ssrc:1001*(2*V+1)}];z&&T>=15019&&Z==="video"&&!ue[0].rtx&&(ue[0].rtx={ssrc:ue[0].ssrc+1}),O.wantReceive&&(O.rtpReceiver=new c.RTCRtpReceiver(O.dtlsTransport,Z)),O.localCapabilities=se,O.sendEncodingParameters=ue}),l._config.bundlePolicy!=="max-compat"&&(P+="a=group:BUNDLE "+l.transceivers.map(function(O){return O.mid}).join(" ")+`\r
`),P+=`a=ice-options:trickle\r
`,l.transceivers.forEach(function(O,V){P+=I(O,O.localCapabilities,"offer",O.stream,l._dtlsRole),P+=`a=rtcp-rsize\r
`,!O.iceGatherer||l.iceGatheringState==="new"||V!==0&&l.usingBundle||(O.iceGatherer.getLocalCandidates().forEach(function(z){z.component=1,P+="a="+D.writeCandidate(z)+`\r
`}),O.iceGatherer.state==="completed"&&(P+=`a=end-of-candidates\r
`))});var U=new c.RTCSessionDescription({type:"offer",sdp:P});return Promise.resolve(U)},g.prototype.createAnswer=function(){var l=this;if(l._isClosed)return Promise.reject(m("InvalidStateError","Can not call createAnswer after close"));if(l.signalingState!=="have-remote-offer"&&l.signalingState!=="have-local-pranswer")return Promise.reject(m("InvalidStateError","Can not call createAnswer in signalingState "+l.signalingState));var p=D.writeSessionBoilerplate(l._sdpSessionId,l._sdpSessionVersion++);l.usingBundle&&(p+="a=group:BUNDLE "+l.transceivers.map(function(P){return P.mid}).join(" ")+`\r
`),p+=`a=ice-options:trickle\r
`;var y=D.getMediaSections(l._remoteDescription.sdp).length;l.transceivers.forEach(function(P,U){if(!(U+1>y)){if(P.rejected)return P.kind==="application"?P.protocol==="DTLS/SCTP"?p+=`m=application 0 DTLS/SCTP 5000\r
`:p+="m=application 0 "+P.protocol+` webrtc-datachannel\r
`:P.kind==="audio"?p+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:P.kind==="video"&&(p+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(p+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+P.mid+`\r
`);var O;P.stream&&(P.kind==="audio"?O=P.stream.getAudioTracks()[0]:P.kind==="video"&&(O=P.stream.getVideoTracks()[0]),O&&T>=15019&&P.kind==="video"&&!P.sendEncodingParameters[0].rtx&&(P.sendEncodingParameters[0].rtx={ssrc:P.sendEncodingParameters[0].ssrc+1}));var V=b(P.localCapabilities,P.remoteCapabilities);!V.codecs.filter(function(z){return z.name.toLowerCase()==="rtx"}).length&&P.sendEncodingParameters[0].rtx&&delete P.sendEncodingParameters[0].rtx,p+=I(P,V,"answer",P.stream,l._dtlsRole),P.rtcpParameters&&P.rtcpParameters.reducedSize&&(p+=`a=rtcp-rsize\r
`)}});var A=new c.RTCSessionDescription({type:"answer",sdp:p});return Promise.resolve(A)},g.prototype.addIceCandidate=function(l){var p,y=this;return l&&l.sdpMLineIndex===void 0&&!l.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(A,P){if(!y._remoteDescription)return P(m("InvalidStateError","Can not add ICE candidate without a remote description"));if(l&&l.candidate!==""){var U=l.sdpMLineIndex;if(l.sdpMid){for(var O=0;O<y.transceivers.length;O++)if(y.transceivers[O].mid===l.sdpMid){U=O;break}}var V=y.transceivers[U];if(!V)return P(m("OperationError","Can not add ICE candidate"));if(V.rejected)return A();var z=Object.keys(l.candidate).length>0?D.parseCandidate(l.candidate):{};if(z.protocol==="tcp"&&(z.port===0||z.port===9)||z.component&&z.component!==1)return A();if((U===0||U>0&&V.iceTransport!==y.transceivers[0].iceTransport)&&!f(V.iceTransport,z))return P(m("OperationError","Can not add ICE candidate"));var Z=l.candidate.trim();Z.indexOf("a=")===0&&(Z=Z.substr(2)),(p=D.getMediaSections(y._remoteDescription.sdp))[U]+="a="+(z.type?Z:"end-of-candidates")+`\r
`,y._remoteDescription.sdp=D.getDescription(y._remoteDescription.sdp)+p.join("")}else for(var te=0;te<y.transceivers.length&&(y.transceivers[te].rejected||(y.transceivers[te].iceTransport.addRemoteCandidate({}),(p=D.getMediaSections(y._remoteDescription.sdp))[te]+=`a=end-of-candidates\r
`,y._remoteDescription.sdp=D.getDescription(y._remoteDescription.sdp)+p.join(""),!y.usingBundle));te++);A()})},g.prototype.getStats=function(l){if(l&&l instanceof c.MediaStreamTrack){var p=null;if(this.transceivers.forEach(function(A){A.rtpSender&&A.rtpSender.track===l?p=A.rtpSender:A.rtpReceiver&&A.rtpReceiver.track===l&&(p=A.rtpReceiver)}),!p)throw m("InvalidAccessError","Invalid selector.");return p.getStats()}var y=[];return this.transceivers.forEach(function(A){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(P){A[P]&&y.push(A[P].getStats())})}),Promise.all(y).then(function(A){var P=new Map;return A.forEach(function(U){U.forEach(function(O){P.set(O.id,O)})}),P})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(l){var p=c[l];if(p&&p.prototype&&p.prototype.getStats){var y=p.prototype.getStats;p.prototype.getStats=function(){return y.apply(this).then(function(A){var P=new Map;return Object.keys(A).forEach(function(U){var O;A[U].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(O=A[U]).type]||O.type,P.set(U,A[U])}),P})}}});var d=["createOffer","createAnswer"];return d.forEach(function(l){var p=g.prototype[l];g.prototype[l]=function(){var y=arguments;return typeof y[0]=="function"||typeof y[1]=="function"?p.apply(this,[arguments[2]]).then(function(A){typeof y[0]=="function"&&y[0].apply(null,[A])},function(A){typeof y[1]=="function"&&y[1].apply(null,[A])}):p.apply(this,arguments)}}),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(l){var p=g.prototype[l];g.prototype[l]=function(){var y=arguments;return typeof y[1]=="function"||typeof y[2]=="function"?p.apply(this,arguments).then(function(){typeof y[1]=="function"&&y[1].apply(null)},function(A){typeof y[2]=="function"&&y[2].apply(null,[A])}):p.apply(this,arguments)}}),["getStats"].forEach(function(l){var p=g.prototype[l];g.prototype[l]=function(){var y=arguments;return typeof y[1]=="function"?p.apply(this,arguments).then(function(){typeof y[1]=="function"&&y[1].apply(null)}):p.apply(this,arguments)}}),g}},{sdp:17}],17:[function(L,q,N){"use strict";var D={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};D.localCName=D.generateIdentifier(),D.splitLines=function(I){return I.trim().split(`
`).map(function(b){return b.trim()})},D.splitSections=function(I){return I.split(`
m=`).map(function(b,_){return(_>0?"m="+b:b).trim()+`\r
`})},D.getDescription=function(I){var b=D.splitSections(I);return b&&b[0]},D.getMediaSections=function(I){var b=D.splitSections(I);return b.shift(),b},D.matchPrefix=function(I,b){return D.splitLines(I).filter(function(_){return _.indexOf(b)===0})},D.parseCandidate=function(I){for(var b,_={foundation:(b=I.indexOf("a=candidate:")===0?I.substring(12).split(" "):I.substring(10).split(" "))[0],component:parseInt(b[1],10),protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],address:b[4],port:parseInt(b[5],10),type:b[7]},f=8;f<b.length;f+=2)switch(b[f]){case"raddr":_.relatedAddress=b[f+1];break;case"rport":_.relatedPort=parseInt(b[f+1],10);break;case"tcptype":_.tcpType=b[f+1];break;case"ufrag":_.ufrag=b[f+1],_.usernameFragment=b[f+1];break;default:_[b[f]]=b[f+1]}return _},D.writeCandidate=function(I){var b=[];b.push(I.foundation),b.push(I.component),b.push(I.protocol.toUpperCase()),b.push(I.priority),b.push(I.address||I.ip),b.push(I.port);var _=I.type;return b.push("typ"),b.push(_),_!=="host"&&I.relatedAddress&&I.relatedPort&&(b.push("raddr"),b.push(I.relatedAddress),b.push("rport"),b.push(I.relatedPort)),I.tcpType&&I.protocol.toLowerCase()==="tcp"&&(b.push("tcptype"),b.push(I.tcpType)),(I.usernameFragment||I.ufrag)&&(b.push("ufrag"),b.push(I.usernameFragment||I.ufrag)),"candidate:"+b.join(" ")},D.parseIceOptions=function(I){return I.substr(14).split(" ")},D.parseRtpMap=function(I){var b=I.substr(9).split(" "),_={payloadType:parseInt(b.shift(),10)};return b=b[0].split("/"),_.name=b[0],_.clockRate=parseInt(b[1],10),_.channels=b.length===3?parseInt(b[2],10):1,_.numChannels=_.channels,_},D.writeRtpMap=function(I){var b=I.payloadType;I.preferredPayloadType!==void 0&&(b=I.preferredPayloadType);var _=I.channels||I.numChannels||1;return"a=rtpmap:"+b+" "+I.name+"/"+I.clockRate+(_!==1?"/"+_:"")+`\r
`},D.parseExtmap=function(I){var b=I.substr(9).split(" ");return{id:parseInt(b[0],10),direction:b[0].indexOf("/")>0?b[0].split("/")[1]:"sendrecv",uri:b[1]}},D.writeExtmap=function(I){return"a=extmap:"+(I.id||I.preferredId)+(I.direction&&I.direction!=="sendrecv"?"/"+I.direction:"")+" "+I.uri+`\r
`},D.parseFmtp=function(I){for(var b,_={},f=I.substr(I.indexOf(" ")+1).split(";"),m=0;m<f.length;m++)_[(b=f[m].trim().split("="))[0].trim()]=b[1];return _},D.writeFmtp=function(I){var b="",_=I.payloadType;if(I.preferredPayloadType!==void 0&&(_=I.preferredPayloadType),I.parameters&&Object.keys(I.parameters).length){var f=[];Object.keys(I.parameters).forEach(function(m){I.parameters[m]?f.push(m+"="+I.parameters[m]):f.push(m)}),b+="a=fmtp:"+_+" "+f.join(";")+`\r
`}return b},D.parseRtcpFb=function(I){var b=I.substr(I.indexOf(" ")+1).split(" ");return{type:b.shift(),parameter:b.join(" ")}},D.writeRtcpFb=function(I){var b="",_=I.payloadType;return I.preferredPayloadType!==void 0&&(_=I.preferredPayloadType),I.rtcpFeedback&&I.rtcpFeedback.length&&I.rtcpFeedback.forEach(function(f){b+="a=rtcp-fb:"+_+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`}),b},D.parseSsrcMedia=function(I){var b=I.indexOf(" "),_={ssrc:parseInt(I.substr(7,b-7),10)},f=I.indexOf(":",b);return f>-1?(_.attribute=I.substr(b+1,f-b-1),_.value=I.substr(f+1)):_.attribute=I.substr(b+1),_},D.parseSsrcGroup=function(I){var b=I.substr(13).split(" ");return{semantics:b.shift(),ssrcs:b.map(function(_){return parseInt(_,10)})}},D.getMid=function(I){var b=D.matchPrefix(I,"a=mid:")[0];if(b)return b.substr(6)},D.parseFingerprint=function(I){var b=I.substr(14).split(" ");return{algorithm:b[0].toLowerCase(),value:b[1]}},D.getDtlsParameters=function(I,b){return{role:"auto",fingerprints:D.matchPrefix(I+b,"a=fingerprint:").map(D.parseFingerprint)}},D.writeDtlsParameters=function(I,b){var _="a=setup:"+b+`\r
`;return I.fingerprints.forEach(function(f){_+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`}),_},D.parseCryptoLine=function(I){var b=I.substr(9).split(" ");return{tag:parseInt(b[0],10),cryptoSuite:b[1],keyParams:b[2],sessionParams:b.slice(3)}},D.writeCryptoLine=function(I){return"a=crypto:"+I.tag+" "+I.cryptoSuite+" "+(typeof I.keyParams=="object"?D.writeCryptoKeyParams(I.keyParams):I.keyParams)+(I.sessionParams?" "+I.sessionParams.join(" "):"")+`\r
`},D.parseCryptoKeyParams=function(I){if(I.indexOf("inline:")!==0)return null;var b=I.substr(7).split("|");return{keyMethod:"inline",keySalt:b[0],lifeTime:b[1],mkiValue:b[2]?b[2].split(":")[0]:void 0,mkiLength:b[2]?b[2].split(":")[1]:void 0}},D.writeCryptoKeyParams=function(I){return I.keyMethod+":"+I.keySalt+(I.lifeTime?"|"+I.lifeTime:"")+(I.mkiValue&&I.mkiLength?"|"+I.mkiValue+":"+I.mkiLength:"")},D.getCryptoParameters=function(I,b){return D.matchPrefix(I+b,"a=crypto:").map(D.parseCryptoLine)},D.getIceParameters=function(I,b){var _=D.matchPrefix(I+b,"a=ice-ufrag:")[0],f=D.matchPrefix(I+b,"a=ice-pwd:")[0];return _&&f?{usernameFragment:_.substr(12),password:f.substr(10)}:null},D.writeIceParameters=function(I){return"a=ice-ufrag:"+I.usernameFragment+`\r
a=ice-pwd:`+I.password+`\r
`},D.parseRtpParameters=function(I){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},_=D.splitLines(I)[0].split(" "),f=3;f<_.length;f++){var m=_[f],c=D.matchPrefix(I,"a=rtpmap:"+m+" ")[0];if(c){var T=D.parseRtpMap(c),S=D.matchPrefix(I,"a=fmtp:"+m+" ");switch(T.parameters=S.length?D.parseFmtp(S[0]):{},T.rtcpFeedback=D.matchPrefix(I,"a=rtcp-fb:"+m+" ").map(D.parseRtcpFb),b.codecs.push(T),T.name.toUpperCase()){case"RED":case"ULPFEC":b.fecMechanisms.push(T.name.toUpperCase())}}}return D.matchPrefix(I,"a=extmap:").forEach(function(w){b.headerExtensions.push(D.parseExtmap(w))}),b},D.writeRtpDescription=function(I,b){var _="";_+="m="+I+" ",_+=b.codecs.length>0?"9":"0",_+=" UDP/TLS/RTP/SAVPF ",_+=b.codecs.map(function(m){return m.preferredPayloadType!==void 0?m.preferredPayloadType:m.payloadType}).join(" ")+`\r
`,_+=`c=IN IP4 0.0.0.0\r
`,_+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,b.codecs.forEach(function(m){_+=D.writeRtpMap(m),_+=D.writeFmtp(m),_+=D.writeRtcpFb(m)});var f=0;return b.codecs.forEach(function(m){m.maxptime>f&&(f=m.maxptime)}),f>0&&(_+="a=maxptime:"+f+`\r
`),_+=`a=rtcp-mux\r
`,b.headerExtensions&&b.headerExtensions.forEach(function(m){_+=D.writeExtmap(m)}),_},D.parseRtpEncodingParameters=function(I){var b,_=[],f=D.parseRtpParameters(I),m=f.fecMechanisms.indexOf("RED")!==-1,c=f.fecMechanisms.indexOf("ULPFEC")!==-1,T=D.matchPrefix(I,"a=ssrc:").map(function(d){return D.parseSsrcMedia(d)}).filter(function(d){return d.attribute==="cname"}),S=T.length>0&&T[0].ssrc,w=D.matchPrefix(I,"a=ssrc-group:FID").map(function(d){return d.substr(17).split(" ").map(function(l){return parseInt(l,10)})});w.length>0&&w[0].length>1&&w[0][0]===S&&(b=w[0][1]),f.codecs.forEach(function(d){if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){var l={ssrc:S,codecPayloadType:parseInt(d.parameters.apt,10)};S&&b&&(l.rtx={ssrc:b}),_.push(l),m&&((l=JSON.parse(JSON.stringify(l))).fec={ssrc:S,mechanism:c?"red+ulpfec":"red"},_.push(l))}}),_.length===0&&S&&_.push({ssrc:S});var g=D.matchPrefix(I,"b=");return g.length&&(g=g[0].indexOf("b=TIAS:")===0?parseInt(g[0].substr(7),10):g[0].indexOf("b=AS:")===0?1e3*parseInt(g[0].substr(5),10)*.95-16e3:void 0,_.forEach(function(d){d.maxBitrate=g})),_},D.parseRtcpParameters=function(I){var b={},_=D.matchPrefix(I,"a=ssrc:").map(function(c){return D.parseSsrcMedia(c)}).filter(function(c){return c.attribute==="cname"})[0];_&&(b.cname=_.value,b.ssrc=_.ssrc);var f=D.matchPrefix(I,"a=rtcp-rsize");b.reducedSize=f.length>0,b.compound=f.length===0;var m=D.matchPrefix(I,"a=rtcp-mux");return b.mux=m.length>0,b},D.parseMsid=function(I){var b,_=D.matchPrefix(I,"a=msid:");if(_.length===1)return{stream:(b=_[0].substr(7).split(" "))[0],track:b[1]};var f=D.matchPrefix(I,"a=ssrc:").map(function(m){return D.parseSsrcMedia(m)}).filter(function(m){return m.attribute==="msid"});return f.length>0?{stream:(b=f[0].value.split(" "))[0],track:b[1]}:void 0},D.parseSctpDescription=function(I){var b,_=D.parseMLine(I),f=D.matchPrefix(I,"a=max-message-size:");f.length>0&&(b=parseInt(f[0].substr(19),10)),isNaN(b)&&(b=65536);var m=D.matchPrefix(I,"a=sctp-port:");if(m.length>0)return{port:parseInt(m[0].substr(12),10),protocol:_.fmt,maxMessageSize:b};if(D.matchPrefix(I,"a=sctpmap:").length>0){var c=D.matchPrefix(I,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:b}}},D.writeSctpDescription=function(I,b){var _=[];return _=I.protocol!=="DTLS/SCTP"?["m="+I.kind+" 9 "+I.protocol+" "+b.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+b.port+`\r
`]:["m="+I.kind+" 9 "+I.protocol+" "+b.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+b.port+" "+b.protocol+` 65535\r
`],b.maxMessageSize!==void 0&&_.push("a=max-message-size:"+b.maxMessageSize+`\r
`),_.join("")},D.generateSessionId=function(){return Math.random().toString().substr(2,21)},D.writeSessionBoilerplate=function(I,b,_){var f,m=b!==void 0?b:2;return f=I||D.generateSessionId(),`v=0\r
o=`+(_||"thisisadapterortc")+" "+f+" "+m+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},D.writeMediaSection=function(I,b,_,f){var m=D.writeRtpDescription(I.kind,b);if(m+=D.writeIceParameters(I.iceGatherer.getLocalParameters()),m+=D.writeDtlsParameters(I.dtlsTransport.getLocalParameters(),_==="offer"?"actpass":"active"),m+="a=mid:"+I.mid+`\r
`,I.direction?m+="a="+I.direction+`\r
`:I.rtpSender&&I.rtpReceiver?m+=`a=sendrecv\r
`:I.rtpSender?m+=`a=sendonly\r
`:I.rtpReceiver?m+=`a=recvonly\r
`:m+=`a=inactive\r
`,I.rtpSender){var c="msid:"+f.id+" "+I.rtpSender.track.id+`\r
`;m+="a="+c,m+="a=ssrc:"+I.sendEncodingParameters[0].ssrc+" "+c,I.sendEncodingParameters[0].rtx&&(m+="a=ssrc:"+I.sendEncodingParameters[0].rtx.ssrc+" "+c,m+="a=ssrc-group:FID "+I.sendEncodingParameters[0].ssrc+" "+I.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return m+="a=ssrc:"+I.sendEncodingParameters[0].ssrc+" cname:"+D.localCName+`\r
`,I.rtpSender&&I.sendEncodingParameters[0].rtx&&(m+="a=ssrc:"+I.sendEncodingParameters[0].rtx.ssrc+" cname:"+D.localCName+`\r
`),m},D.getDirection=function(I,b){for(var _=D.splitLines(I),f=0;f<_.length;f++)switch(_[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return _[f].substr(2)}return b?D.getDirection(b):"sendrecv"},D.getKind=function(I){return D.splitLines(I)[0].split(" ")[0].substr(2)},D.isRejected=function(I){return I.split(" ",2)[1]==="0"},D.parseMLine=function(I){var b=D.splitLines(I)[0].substr(2).split(" ");return{kind:b[0],port:parseInt(b[1],10),protocol:b[2],fmt:b.slice(3).join(" ")}},D.parseOLine=function(I){var b=D.matchPrefix(I,"o=")[0].substr(2).split(" ");return{username:b[0],sessionId:b[1],sessionVersion:parseInt(b[2],10),netType:b[3],addressType:b[4],address:b[5]}},D.isValidSDP=function(I){if(typeof I!="string"||I.length===0)return!1;for(var b=D.splitLines(I),_=0;_<b.length;_++)if(b[_].length<2||b[_].charAt(1)!=="=")return!1;return!0},typeof q=="object"&&(q.exports=D)},{}]},{},[1])(1)}),function(L){typeof exports=="object"&&typeof module<"u"?module.exports=L():typeof define=="function"&&define.amd?define([],L):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).videojsFlvjs=L()}(function(){return function L(q,N,D){function I(f,m){if(!N[f]){if(!q[f]){var c=typeof require=="function"&&require;if(!m&&c)return c(f,!0);if(b)return b(f,!0);var T=new Error("Cannot find module '"+f+"'");throw T.code="MODULE_NOT_FOUND",T}var S=N[f]={exports:{}};q[f][0].call(S.exports,function(w){var g=q[f][1][w];return I(g||w)},S,S.exports,L,q,N,D)}return N[f].exports}for(var b=typeof require=="function"&&require,_=0;_<D.length;_++)I(D[_]);return I}({1:[function(L,q,N){(function(D){"use strict";Object.defineProperty(N,"__esModule",{value:!0});var I,b=function(){function w(g,d){for(var l=0;l<d.length;l++){var p=d[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}return function(g,d,l){return d&&w(g.prototype,d),l&&w(g,l),g}}(),_=typeof window<"u"?window.videojs:D!==void 0?D.videojs:null,f=(I=_)&&I.__esModule?I:{default:I},m=f.default.getTech("Html5"),c=f.default.mergeOptions||f.default.util.mergeOptions,T={dataInterval:3e3},S=function(w){function g(d,l){return function(p,y){if(!(p instanceof y))throw new TypeError("Cannot call a class as a function")}(this,g),d=c(T,d),function(p,y){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?p:y}(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,d,l))}return function(d,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof l);d.prototype=Object.create(l&&l.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(d,l):d.__proto__=l)}(g,m),b(g,[{key:"setSrc",value:function(d){var l=this,p=!!this.options_.debug;this.options_.autoplay,this.debug=p;var y=this.options_.dataInterval;p&&console.log("rtc debug on"),this.src=d,this.stream=new MediaStream,this.pc=new RTCPeerConnection,this.pc.ontrack=function(A){l.stream.addTrack(A.track),l.el_.srcObject!=l.stream&&(l.el_.srcObject=l.stream),p&&console.log(A.streams.length,"track",A.track.kind,"is delivered")},this.pc.oniceconnectionstatechange=function(A){l.pc.iceConnectionState=="disconnected"&&l.sendChannelTicker&&(l.trigger({type:"error",name:"ice disconnected"}),clearInterval(l.sendChannelTicker),l.sendChannelTicker=0),p&&console.log("ice connection state change: "+l.pc.iceConnectionState)},this.sendChannel=this.pc.createDataChannel("keepalive"),this.sendChannel.onclose=function(){l.sendChannelTicker&&(l.trigger({type:"error",name:"send channel closed"}),clearInterval(l.sendChannelTicker),l.sendChannelTicker=0),p&&console.log("sendChannel has closed")},this.sendChannel.onopen=function(){p&&console.log("sendChannel has opened"),l.sendChannel.send("ping"),l.sendChannelTicker=setInterval(function(){p&&console.log("sendChannel ping..."),l.sendChannel.send("ping")},y)},this.sendChannel.onmessage=function(A){p&&console.log("sendChannel message",A.data)},this.pc.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!0}).then(function(A){l.pc.setLocalDescription(A).then(function(){var P=new XMLHttpRequest;P.open("POST",d.replace("webrtc","http"),!0),P.onreadystatechange=function(){if(P.readyState==4)if(P.status>=200&&P.status<300||P.status===304)try{l.pc.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:atob(P.responseText)}))}catch(U){l.trigger({type:"error",name:"set rtc remote sdp failed"}),p&&console.log("set rtc remote sdp error",U)}else l.trigger({type:"error",name:"post rtc status "+P.status}),p&&console.log("post rtc status",P.status,P.statusText)},P.send(btoa(l.pc.localDescription.sdp))}).catch(function(P){p&&console.log("pc setLocalDescription error",P)})}).catch(function(A){p&&console.log("pc createOffer error",A)})}},{key:"dispose",value:function(){this.sendChannelTicker&&(clearInterval(this.sendChannelTicker),this.sendChannelTicker=0),this.sendChannel&&(this.sendChannel.close(),this.sendChannel=null),this.pc&&(this.pc.close(),this.pc=null),this.el_.srcObject&&(this.el_.srcObject=null),function d(l,p,y){l===null&&(l=Function.prototype);var A=Object.getOwnPropertyDescriptor(l,p);if(A===void 0){var P=Object.getPrototypeOf(l);return P===null?void 0:d(P,p,y)}if("value"in A)return A.value;var U=A.get;return U!==void 0?U.call(y):void 0}(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"dispose",this).call(this)}},{key:"reload",value:function(){this.sendChannelTicker&&(clearInterval(this.sendChannelTicker),this.sendChannelTicker=0),this.sendChannel&&(this.sendChannel.close(),this.sendChannel=null),this.pc&&(this.pc.close(),this.pc=null),this.el_.srcObject&&(this.el_.srcObject=null),this.src?this.setSrc(this.src):this.debug&&console.log("reload error, src not found")}}]),g}();S.isSupported=function(){return!!window.RTCPeerConnection},S.formats={"video/webrtc":"RTC"},S.canPlayType=function(w){return S.isSupported()?"maybe":""},S.canPlaySource=function(w,g){return S.canPlayType(w.type)},S.VERSION="0.2.0",f.default.registerTech("Webrtc",S),N.default=S}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[1])(1)}),function(){"use strict";var L=null;L=window.videojs===void 0&&typeof require=="function"?require("video.js"):window.videojs,function(q,N){var D,I={},b={},_={};function f(w,g,d,l){return b={label:d,sources:g},typeof l=="function"?l(w,g,d):w.src(g.map(function(p){return{src:p.src,type:p.type,res:p.res}}))}var m=N.getComponent("MenuItem"),c=N.extend(m,{constructor:function(w,g,d,l){this.onClickListener=d,this.label=l,m.call(this,w,g),this.src=g.src,this.on("click",this.onClick),this.on("touchstart",this.onClick),g.initialySelected&&(this.showAsLabel(),this.selected(!0),this.addClass("vjs-selected"))},showAsLabel:function(){this.label&&(this.label.innerHTML=this.options_.label)},onClick:function(w){this.onClickListener(this);var g=this.player_.currentTime(),d=this.player_.paused();this.showAsLabel(),this.addClass("vjs-selected"),d||this.player_.bigPlayButton.hide(),typeof w!="function"&&typeof this.options_.customSourcePicker=="function"&&(w=this.options_.customSourcePicker);var l="loadeddata";this.player_.techName_!=="Youtube"&&this.player_.preload()==="none"&&this.player_.techName_!=="Flash"&&(l="timeupdate"),f(this.player_,this.src,this.options_.label,w),this.player_.one(l,function(){this.player_.currentTime(g),this.player_.handleTechSeeked_(),this.player_.trigger("resolutionchange")})}}),T=N.getComponent("MenuButton"),S=N.extend(T,{constructor:function(w,g,d,l){if(this.sources=g.sources,this.label=l,this.label.innerHTML=g.initialySelectedLabel,T.call(this,w,g,d),this.controlText("Quality"),d.dynamicLabel)this.el().appendChild(l);else{var p=document.createElement("span");N.dom.addClass(p,"vjs-resolution-button-staticlabel"),this.el().appendChild(p)}},createItems:function(){var w=[],g=this.sources&&this.sources.label||{},d=function(p){w.map(function(y){y.selected(y===p),y.removeClass("vjs-selected")})};for(var l in g)g.hasOwnProperty(l)&&(w.push(new c(this.player_,{label:l,src:g[l],initialySelected:l===this.options_.initialySelectedLabel,customSourcePicker:this.options_.customSourcePicker},d,this.label)),_[l]=w[w.length-1]);return w}});D=function(w){var g=N.mergeOptions(I,w),d=this,l=document.createElement("span"),p={};function y(O,V){return O.res&&V.res?+V.res-+O.res:0}function A(O){var V={label:{},res:{},type:{}};return O.map(function(z){P(V,"label",z),P(V,"res",z),P(V,"type",z),U(V,"label",z),U(V,"res",z),U(V,"type",z)}),V}function P(O,V,z){O[V][z[V]]==null&&(O[V][z[V]]=[])}function U(O,V,z){O[V][z[V]].push(z)}N.dom.addClass(l,"vjs-menu"),N.browser.IE_VERSION?N.dom.addClass(l,"vjs-resolution-button-label-ie"):N.dom.addClass(l,"vjs-resolution-button-label"),d.updateSrc=function(O){if(!O)return d.src();d.controlBar.resolutionSwitcher&&(d.controlBar.resolutionSwitcher.dispose(),delete d.controlBar.resolutionSwitcher),O=O.sort(y);var V=function(Z,te){var se=g.default,ue="";return se==="high"?(se=te[0].res,ue=te[0].label):se!=="low"&&se!=null&&Z.res[se]?Z.res[se]&&(ue=Z.res[se][0].label):(se=te[te.length-1].res,ue=te[te.length-1].label),{res:se,label:ue,sources:Z.res[se]}}(p=A(O),O),z=new S(d,{sources:p,initialySelectedLabel:V.label,initialySelectedRes:V.res,customSourcePicker:g.customSourcePicker},g,l);return N.dom.addClass(z.el(),"vjs-resolution-button"),d.controlBar.resolutionSwitcher=d.controlBar.el_.insertBefore(z.el_,d.controlBar.getChild("fullscreenToggle").el_),d.controlBar.resolutionSwitcher.dispose=function(){this.parentNode.removeChild(this)},f(d,V.sources,V.label)},d.currentResolution=function(O,V){return O==null?b:(_[O]!=null&&_[O].onClick(V),d)},d.getGroupedSrc=function(){return p},d.ready(function(){d.options_.sources.length>1&&d.updateSrc(d.options_.sources),d.techName_==="Youtube"&&function(O){O.tech_.ytPlayer.setPlaybackQuality("default"),O.tech_.ytPlayer.addEventListener("onPlaybackQualityChange",function(){O.trigger("resolutionchange")}),O.one("play",function(){var V={highres:{res:1080,label:"1080",yt:"highres"},hd1080:{res:1080,label:"1080",yt:"hd1080"},hd720:{res:720,label:"720",yt:"hd720"},large:{res:480,label:"480",yt:"large"},medium:{res:360,label:"360",yt:"medium"},small:{res:240,label:"240",yt:"small"},tiny:{res:144,label:"144",yt:"tiny"},auto:{res:0,label:"auto",yt:"default"}},z=[];O.tech_.ytPlayer.getAvailableQualityLevels().map(function(ue){z.push({src:O.src().src,type:O.src().type,label:V[ue].label,res:V[ue].res,_yt:V[ue].yt})});var Z="auto",te=0,se=((p=A(z)).label.auto,new S(O,{sources:p,initialySelectedLabel:Z,initialySelectedRes:te,customSourcePicker:function(ue,de,ke){return O.tech_.ytPlayer.setPlaybackQuality(de[0]._yt),O}},g,l));se.el().classList.add("vjs-resolution-button"),O.controlBar.resolutionSwitcher=O.controlBar.addChild(se)})}(d)})},N.registerPlugin("videoJsResolutionSwitcher",D)}(window,L)}(),function(L,q){typeof window<"u"&&window.videojs?q(window.videojs):typeof define=="function"&&define.amd?define("videojs-hotkeys",["video.js"],function(N){return q(N.default||N)}):typeof module<"u"&&module.exports&&(module.exports=q(require("video.js")))}(0,function(L){"use strict";typeof window<"u"&&(window.videojs_hotkeys={version:"0.2.22"}),(L.registerPlugin||L.plugin)("hotkeys",function(q){var N=this,D=N.el(),I=document,b={volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!1,enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:function(O){return O.which===32||O.which===179},rewindKey:function(O){return O.which===37||O.which===177},forwardKey:function(O){return O.which===39||O.which===176},volumeUpKey:function(O){return O.which===38},volumeDownKey:function(O){return O.which===40},muteKey:function(O){return O.which===77},fullscreenKey:function(O){return O.which===70},customKeys:{}},_=L.mergeOptions||L.util.mergeOptions,f=(q=_(b,q||{})).volumeStep,m=q.seekStep,c=q.enableMute,T=q.enableVolumeScroll,S=q.enableFullscreen,w=q.enableNumbers,g=q.enableJogStyle,d=q.alwaysCaptureHotkeys,l=q.enableModifiersForNumbers,p=q.enableInactiveFocus,y=q.skipInitialFocus;D.hasAttribute("tabIndex")||D.setAttribute("tabIndex","-1"),D.style.outline="none",!d&&N.autoplay()||y||N.one("play",function(){D.focus({preventScroll:!0})}),p&&N.on("userinactive",function(){var O=function(){clearTimeout(V)},V=setTimeout(function(){N.off("useractive",O);var z=I.activeElement,Z=D.querySelector(".vjs-control-bar");z&&z.parentElement==Z&&D.focus()},10);N.one("useractive",O)}),N.on("play",function(){var O=D.querySelector(".iframeblocker");O&&O.style.display===""&&(O.style.display="block",O.style.bottom="39px")});var A=function(O){if(N.controls()){var V=I.activeElement;if((d||V==D||V==D.querySelector(".vjs-tech")||V==D.querySelector(".iframeblocker")||V==D.querySelector(".vjs-control-bar"))&&T){O=window.event||O;var z=Math.max(-1,Math.min(1,O.wheelDelta||-O.detail));O.preventDefault(),z==1?N.volume(N.volume()+f):z==-1&&N.volume(N.volume()-f)}}},P=function(O,V){return q.playPauseKey(O,V)?1:q.rewindKey(O,V)?2:q.forwardKey(O,V)?3:q.volumeUpKey(O,V)?4:q.volumeDownKey(O,V)?5:q.muteKey(O,V)?6:q.fullscreenKey(O,V)?7:void 0};function U(O){return typeof m=="function"?m(O):m}return N.on("keydown",function(O){var V,z,Z=O.which,te=O.preventDefault,se=N.duration();if(N.controls()){var ue=I.activeElement;if(d||ue==D||ue==D.querySelector(".vjs-tech")||ue==D.querySelector(".vjs-control-bar")||ue==D.querySelector(".iframeblocker"))switch(P(O,N)){case 1:te(),d&&O.stopPropagation(),N.paused()?N.play():N.pause();break;case 2:V=!N.paused(),te(),V&&N.pause(),(z=N.currentTime()-U(O))<=0&&(z=0),N.currentTime(z),V&&N.play();break;case 3:V=!N.paused(),te(),V&&N.pause(),(z=N.currentTime()+U(O))>=se&&(z=V?se-.001:se),N.currentTime(z),V&&N.play();break;case 5:te(),g?(z=N.currentTime()-1,N.currentTime()<=1&&(z=0),N.currentTime(z)):N.volume(N.volume()-f);break;case 4:te(),g?((z=N.currentTime()+1)>=se&&(z=se),N.currentTime(z)):N.volume(N.volume()+f);break;case 6:c&&N.muted(!N.muted());break;case 7:S&&(N.isFullscreen()?N.exitFullscreen():N.requestFullscreen());break;default:if((Z>47&&Z<59||Z>95&&Z<106)&&(l||!(O.metaKey||O.ctrlKey||O.altKey))&&w){var de=48;Z>95&&(de=96);var ke=Z-de;te(),N.currentTime(N.duration()*ke*.1)}for(var Te in q.customKeys){var he=q.customKeys[Te];he&&he.key&&he.handler&&he.key(O)&&(te(),he.handler(N,q,O))}}}}),N.on("mousewheel",A),N.on("DOMMouseScroll",A),this})}),function(L){L.URL=L.URL||L.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var q=function(N,D){(D=D||{}).sampleBits=D.sampleBits||8,D.sampleRate=D.sampleRate||8e3;var I=new(L.webkitAudioContext||L.AudioContext),b=I.createMediaStreamSource(N),_=(I.createScriptProcessor||I.createJavaScriptNode).apply(I,[4096,1,1]),f=!1,m={size:0,buffer:[],inputSampleRate:I.sampleRate,inputSampleBits:16,outputSampleRate:D.sampleRate,oututSampleBits:D.sampleBits,input:function(c){this.buffer.push(new Float32Array(c)),this.size+=c.length,D.pcmCallback&&(D.pcmCallback(this.encodePCM()),this.buffer.splice(0,this.size),this.size=0)},compress:function(){for(var c=new Float32Array(this.size),T=0,S=0;S<this.buffer.length;S++)c.set(this.buffer[S],T),T+=this.buffer[S].length;for(var w=parseInt(this.inputSampleRate/this.outputSampleRate),g=c.length/w,d=new Float32Array(g),l=0,p=0;l<g;)d[l]=c[p],p+=w,l++;return d},encodePCM:function(){var c=Math.min(this.inputSampleBits,this.oututSampleBits),T=this.compress(),S=T.length*(c/8),w=new ArrayBuffer(S),g=new DataView(w),d=0;if(c===8)for(var l=0;l<T.length;l++,d++){var p=(y=Math.max(-1,Math.min(1,T[l])))<0?32768*y:32767*y;p=parseInt(255/(65535/(p+32768))),g.setInt8(d,p,!0)}else for(l=0;l<T.length;l++,d+=2){var y=Math.max(-1,Math.min(1,T[l]));g.setInt16(d,y<0?32768*y:32767*y,!0)}return new Blob([g],{type:"audio/pcm"})},encodeWAV:function(){var c=Math.min(this.inputSampleRate,this.outputSampleRate),T=Math.min(this.inputSampleBits,this.oututSampleBits),S=this.compress(),w=S.length*(T/8),g=new ArrayBuffer(44+w),d=new DataView(g),l=0,p=function(U){for(var O=0;O<U.length;O++)d.setUint8(l+O,U.charCodeAt(O))};if(p("RIFF"),l+=4,d.setUint32(l,36+w,!0),l+=4,p("WAVE"),l+=4,p("fmt "),l+=4,d.setUint32(l,16,!0),l+=4,d.setUint16(l,1,!0),l+=2,d.setUint16(l,1,!0),l+=2,d.setUint32(l,c,!0),l+=4,d.setUint32(l,1*c*(T/8),!0),l+=4,d.setUint16(l,T/8*1,!0),l+=2,d.setUint16(l,T,!0),l+=2,p("data"),l+=4,d.setUint32(l,w,!0),l+=4,T===8)for(var y=0;y<S.length;y++,l++){var A=(P=Math.max(-1,Math.min(1,S[y])))<0?32768*P:32767*P;A=parseInt(255/(65535/(A+32768))),d.setInt8(l,A,!0)}else for(y=0;y<S.length;y++,l+=2){var P=Math.max(-1,Math.min(1,S[y]));d.setInt16(l,P<0?32768*P:32767*P,!0)}return new Blob([d],{type:"audio/wav"})}};this.start=function(){f||(b.connect(_),_.connect(I.destination),f=!0)},this.stop=function(){f&&(_.disconnect(),f=!1)},this.destroy=function(){this.stop(),I&&(I.close(),I=null)},this.getBlob=function(){return this.stop(),m.encodeWAV()},this.getPCMBlob=function(){return this.stop(),m.encodePCM()},this.play=function(c){c.src=L.URL.createObjectURL(this.getBlob())},this.recording=function(){return f},this.upload=function(c,T){var S=new FormData;S.append("audioData",this.getBlob()),S.append("pcmData",this.getPCMBlob());var w=new XMLHttpRequest;T&&(w.upload.addEventListener("progress",function(g){T("uploading",g)},!1),w.addEventListener("load",function(g){T("ok",g)},!1),w.addEventListener("error",function(g){T("error",g)},!1),w.addEventListener("abort",function(g){T("cancel",g)},!1)),w.open("POST",c),w.send(S)},_.onaudioprocess=function(c){m.input(c.inputBuffer.getChannelData(0))}};q.canRecording=navigator.getUserMedia!=null,q.get=function(N,D){if(N){if(!navigator.getUserMedia)return String(location.protocol).toLowerCase()!="https:"?void N(null,"\u5F53\u524D\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u5F55\u97F3\u529F\u80FD, \u8BF7\u786E\u8BA4\u5F53\u524D\u662F\u5426\u8BBF\u95EE HTTPS \u670D\u52A1!"):void N(null,"\u5F53\u524D\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u5F55\u97F3\u529F\u80FD\u3002");navigator.getUserMedia({audio:!0},function(I){var b=new q(I,D);N(b,null)},function(I){switch(I.name||I.code){case"PERMISSION_DENIED":case"PermissionDeniedError":N(null,"\u7528\u6237\u62D2\u7EDD\u63D0\u4F9B\u4FE1\u606F\u3002");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":N(null,"\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u786C\u4EF6\u8BBE\u5907\u3002");break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":N(null,"\u65E0\u6CD5\u53D1\u73B0\u6307\u5B9A\u7684\u786C\u4EF6\u8BBE\u5907\u3002");break;default:N(null,"\u65E0\u6CD5\u6253\u5F00\u9EA6\u514B\u98CE\u3002\u5F02\u5E38\u4FE1\u606F:"+(I.name||I.code))}})}},L.LiveRecorder=q}(window),videojs.addLanguage("zh-CN",{Play:"\u64AD\u653E",Pause:"\u6682\u505C","Current Time":"\u5F53\u524D\u65F6\u95F4",Duration:"\u65F6\u957F","Remaining Time":"\u5269\u4F59\u65F6\u95F4","Stream Type":"\u5A92\u4F53\u6D41\u7C7B\u578B",LIVE:"\u76F4\u64AD",Loaded:"\u52A0\u8F7D\u5B8C\u6BD5",Progress:"\u8FDB\u5EA6",Fullscreen:"\u5168\u5C4F","Non-Fullscreen":"\u9000\u51FA\u5168\u5C4F",Mute:"\u9759\u97F3",Unmute:"\u53D6\u6D88\u9759\u97F3","Playback Rate":"\u64AD\u653E\u901F\u5EA6",Subtitles:"\u5B57\u5E55","subtitles off":"\u5173\u95ED\u5B57\u5E55",Captions:"\u5185\u5D4C\u5B57\u5E55","captions off":"\u5173\u95ED\u5185\u5D4C\u5B57\u5E55",Chapters:"\u8282\u76EE\u6BB5\u843D","Close Modal Dialog":"\u5173\u95ED\u5F39\u7A97",Descriptions:"\u63CF\u8FF0","descriptions off":"\u5173\u95ED\u63CF\u8FF0","Audio Track":"\u97F3\u8F68","You aborted the media playback":"\u89C6\u9891\u64AD\u653E\u88AB\u7EC8\u6B62","A network error caused the media download to fail part-way.":"\u7F51\u7EDC\u9519\u8BEF\u5BFC\u81F4\u89C6\u9891\u4E0B\u8F7D\u4E2D\u9014\u5931\u8D25\u3002","The media could not be loaded, either because the server or network failed or because the format is not supported.":"\u89C6\u9891\u56E0\u683C\u5F0F\u4E0D\u652F\u6301\u6216\u8005\u670D\u52A1\u5668\u6216\u7F51\u7EDC\u7684\u95EE\u9898\u65E0\u6CD5\u52A0\u8F7D\u3002","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"\u7531\u4E8E\u89C6\u9891\u6587\u4EF6\u635F\u574F\u6216\u662F\u8BE5\u89C6\u9891\u4F7F\u7528\u4E86\u4F60\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u7684\u529F\u80FD\uFF0C\u64AD\u653E\u7EC8\u6B62\u3002","No compatible source was found for this media.":"\u65E0\u6CD5\u627E\u5230\u6B64\u89C6\u9891\u517C\u5BB9\u7684\u6E90\u3002","The media is encrypted and we do not have the keys to decrypt it.":"\u89C6\u9891\u5DF2\u52A0\u5BC6\uFF0C\u65E0\u6CD5\u89E3\u5BC6\u3002","Play Video":"\u64AD\u653E\u89C6\u9891",Close:"\u5173\u95ED","Modal Window":"\u5F39\u7A97","This is a modal window":"\u8FD9\u662F\u4E00\u4E2A\u5F39\u7A97","This modal can be closed by pressing the Escape key or activating the close button.":"\u53EF\u4EE5\u6309ESC\u6309\u952E\u6216\u542F\u7528\u5173\u95ED\u6309\u94AE\u6765\u5173\u95ED\u6B64\u5F39\u7A97\u3002",", opens captions settings dialog":", \u5F00\u542F\u6807\u9898\u8BBE\u7F6E\u5F39\u7A97",", opens subtitles settings dialog":", \u5F00\u542F\u5B57\u5E55\u8BBE\u7F6E\u5F39\u7A97",", opens descriptions settings dialog":", \u5F00\u542F\u63CF\u8FF0\u8BBE\u7F6E\u5F39\u7A97",", selected":", \u9009\u62E9","captions settings":"\u5B57\u5E55\u8BBE\u5B9A","Audio Player":"\u97F3\u9891\u64AD\u653E\u5668","Video Player":"\u89C6\u9891\u64AD\u653E\u5668",Replay:"\u91CD\u64AD","Progress Bar":"\u8FDB\u5EA6\u6761","Volume Level":"\u97F3\u91CF","subtitles settings":"\u5B57\u5E55\u8BBE\u5B9A","descriptions settings":"\u63CF\u8FF0\u8BBE\u5B9A",Text:"\u6587\u5B57",White:"\u767D",Black:"\u9ED1",Red:"\u7EA2",Green:"\u7EFF",Blue:"\u84DD",Yellow:"\u9EC4",Magenta:"\u7D2B\u7EA2",Cyan:"\u9752",Background:"\u80CC\u666F",Window:"\u89C6\u7A97",Transparent:"\u900F\u660E","Semi-Transparent":"\u534A\u900F\u660E",Opaque:"\u4E0D\u900F\u660E","Font Size":"\u5B57\u4F53\u5C3A\u5BF8","Text Edge Style":"\u5B57\u4F53\u8FB9\u7F18\u6837\u5F0F",None:"\u65E0",Raised:"\u6D6E\u96D5",Depressed:"\u538B\u4F4E",Uniform:"\u5747\u5300",Dropshadow:"\u4E0B\u9634\u5F71","Font Family":"\u5B57\u4F53\u5E93","Proportional Sans-Serif":"\u6BD4\u4F8B\u65E0\u7EC6\u4F53","Monospace Sans-Serif":"\u5355\u95F4\u9694\u65E0\u7EC6\u4F53","Proportional Serif":"\u6BD4\u4F8B\u7EC6\u4F53","Monospace Serif":"\u5355\u95F4\u9694\u7EC6\u4F53",Casual:"\u8212\u9002",Script:"\u624B\u5199\u4F53","Small Caps":"\u5C0F\u578B\u5927\u5199\u5B57\u4F53",Reset:"\u91CD\u7F6E","restore all settings to the default values":"\u6062\u590D\u5168\u90E8\u8BBE\u5B9A\u81F3\u9884\u8BBE\u503C",Done:"\u5B8C\u6210","Caption Settings Dialog":"\u5B57\u5E55\u8BBE\u5B9A\u89C6\u7A97","Beginning of dialog window. Escape will cancel and close the window.":"\u5F00\u59CB\u5BF9\u8BDD\u89C6\u7A97\u3002\u79BB\u5F00\u4F1A\u53D6\u6D88\u53CA\u5173\u95ED\u89C6\u7A97","End of dialog window.":"\u7ED3\u675F\u5BF9\u8BDD\u89C6\u7A97","Seek to live, currently behind live":"\u8BD5\u56FE\u76F4\u64AD\uFF0C\u5F53\u524D\u5EF6\u65F6\u64AD\u653E","Seek to live, currently playing live":"\u8BD5\u56FE\u76F4\u64AD\uFF0C\u5F53\u524D\u5B9E\u65F6\u64AD\u653E","progress bar timing: currentTime={1} duration={2}":"{1}/{2}","{1} is loading.":"\u6B63\u5728\u52A0\u8F7D {1}\u3002","Picture-in-Picture":"\u753B\u4E2D\u753B","Exit Picture-in-Picture":"\u9000\u51FA\u753B\u4E2D\u753B",Snapshot:"\u622A\u56FE",STD:"\u6807\u51C6",STR:"\u62C9\u4F38","Click switch to standard display":"\u70B9\u51FB\u5207\u6362\u5230\u6807\u51C6\u663E\u793A","Click switch to stretch display":"\u70B9\u51FB\u5207\u6362\u5230\u62C9\u4F38\u663E\u793A",Fluent:"\u6D41\u7545",Fast:"\u6781\u901F","Click switch to fast play":"\u70B9\u51FB\u5207\u6362\u5230\u6781\u901F\u64AD\u653E","Click switch to fluent play":"\u70B9\u51FB\u5207\u6362\u5230\u6D41\u7545\u64AD\u653E"});
