/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.99.9
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */define(["exports","./Transforms-5b74e989","./Matrix3-2955527a","./Matrix2-462b83d3","./ComponentDatatype-f9ac3ed8","./defaultValue-ebbd2e4d","./GeometryAttribute-9c756444","./GeometryAttributes-ca309b71","./Math-1fe079f3","./Plane-7e97483e","./VertexFormat-5b02b45a"],function(N,v,r,m,q,f,k,$,b,G,R){"use strict";function M(e){this.planes=f.defaultValue(e,[])}const B=[new r.Cartesian3,new r.Cartesian3,new r.Cartesian3];r.Cartesian3.clone(r.Cartesian3.UNIT_X,B[0]),r.Cartesian3.clone(r.Cartesian3.UNIT_Y,B[1]),r.Cartesian3.clone(r.Cartesian3.UNIT_Z,B[2]);const S=new r.Cartesian3,ee=new r.Cartesian3,Y=new G.Plane(new r.Cartesian3(1,0,0),0);function V(e){e=f.defaultValue(e,f.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=f.defaultValue(e.near,1),this._near=this.near,this.far=f.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new M,this._orthographicMatrix=new m.Matrix4}function J(e){e.top===e._top&&e.bottom===e._bottom&&e.left===e._left&&e.right===e._right&&e.near===e._near&&e.far===e._far||(e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=m.Matrix4.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix))}M.fromBoundingSphere=function(e,t){f.defined(t)||(t=new M);const n=B.length,s=t.planes;s.length=2*n;const l=e.center,p=e.radius;let c=0;for(let _=0;_<n;++_){const i=B[_];let o=s[c],d=s[c+1];f.defined(o)||(o=s[c]=new m.Cartesian4),f.defined(d)||(d=s[c+1]=new m.Cartesian4),r.Cartesian3.multiplyByScalar(i,-p,S),r.Cartesian3.add(l,S,S),o.x=i.x,o.y=i.y,o.z=i.z,o.w=-r.Cartesian3.dot(i,S),r.Cartesian3.multiplyByScalar(i,p,S),r.Cartesian3.add(l,S,S),d.x=-i.x,d.y=-i.y,d.z=-i.z,d.w=-r.Cartesian3.dot(r.Cartesian3.negate(i,ee),S),c+=2}return t},M.prototype.computeVisibility=function(e){const t=this.planes;let n=!1;for(let s=0,l=t.length;s<l;++s){const p=e.intersectPlane(G.Plane.fromCartesian4(t[s],Y));if(p===v.Intersect.OUTSIDE)return v.Intersect.OUTSIDE;p===v.Intersect.INTERSECTING&&(n=!0)}return n?v.Intersect.INTERSECTING:v.Intersect.INSIDE},M.prototype.computeVisibilityWithPlaneMask=function(e,t){if(t===M.MASK_OUTSIDE||t===M.MASK_INSIDE)return t;let n=M.MASK_INSIDE;const s=this.planes;for(let l=0,p=s.length;l<p;++l){const c=l<31?1<<l:0;if(l<31&&!(t&c))continue;const _=e.intersectPlane(G.Plane.fromCartesian4(s[l],Y));if(_===v.Intersect.OUTSIDE)return M.MASK_OUTSIDE;_===v.Intersect.INTERSECTING&&(n|=c)}return n},M.MASK_OUTSIDE=4294967295,M.MASK_INSIDE=0,M.MASK_INDETERMINATE=2147483647,Object.defineProperties(V.prototype,{projectionMatrix:{get:function(){return J(this),this._orthographicMatrix}}});const te=new r.Cartesian3,ne=new r.Cartesian3,ie=new r.Cartesian3,j=new r.Cartesian3;function g(e){e=f.defaultValue(e,f.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new V,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=f.defaultValue(e.near,1),this._near=this.near,this.far=f.defaultValue(e.far,5e8),this._far=this.far}function A(e){const t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;const n=1/e.aspectRatio;t.right=.5*e.width,t.left=-t.right,t.top=n*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}function E(e){e=f.defaultValue(e,f.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=f.defaultValue(e.near,1),this._near=this.near,this.far=f.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new M,this._perspectiveMatrix=new m.Matrix4,this._infinitePerspective=new m.Matrix4}function U(e){const t=e.top,n=e.bottom,s=e.right,l=e.left,p=e.near,c=e.far;t===e._top&&n===e._bottom&&l===e._left&&s===e._right&&p===e._near&&c===e._far||(e._left=l,e._right=s,e._top=t,e._bottom=n,e._near=p,e._far=c,e._perspectiveMatrix=m.Matrix4.computePerspectiveOffCenter(l,s,n,t,p,c,e._perspectiveMatrix),e._infinitePerspective=m.Matrix4.computeInfinitePerspectiveOffCenter(l,s,n,t,p,e._infinitePerspective))}V.prototype.computeCullingVolume=function(e,t,n){const s=this._cullingVolume.planes,l=this.top,p=this.bottom,c=this.right,_=this.left,i=this.near,o=this.far,d=r.Cartesian3.cross(t,n,te);r.Cartesian3.normalize(d,d);const y=ne;r.Cartesian3.multiplyByScalar(t,i,y),r.Cartesian3.add(e,y,y);const h=ie;r.Cartesian3.multiplyByScalar(d,_,h),r.Cartesian3.add(y,h,h);let a=s[0];return f.defined(a)||(a=s[0]=new m.Cartesian4),a.x=d.x,a.y=d.y,a.z=d.z,a.w=-r.Cartesian3.dot(d,h),r.Cartesian3.multiplyByScalar(d,c,h),r.Cartesian3.add(y,h,h),a=s[1],f.defined(a)||(a=s[1]=new m.Cartesian4),a.x=-d.x,a.y=-d.y,a.z=-d.z,a.w=-r.Cartesian3.dot(r.Cartesian3.negate(d,j),h),r.Cartesian3.multiplyByScalar(n,p,h),r.Cartesian3.add(y,h,h),a=s[2],f.defined(a)||(a=s[2]=new m.Cartesian4),a.x=n.x,a.y=n.y,a.z=n.z,a.w=-r.Cartesian3.dot(n,h),r.Cartesian3.multiplyByScalar(n,l,h),r.Cartesian3.add(y,h,h),a=s[3],f.defined(a)||(a=s[3]=new m.Cartesian4),a.x=-n.x,a.y=-n.y,a.z=-n.z,a.w=-r.Cartesian3.dot(r.Cartesian3.negate(n,j),h),a=s[4],f.defined(a)||(a=s[4]=new m.Cartesian4),a.x=t.x,a.y=t.y,a.z=t.z,a.w=-r.Cartesian3.dot(t,y),r.Cartesian3.multiplyByScalar(t,o,h),r.Cartesian3.add(e,h,h),a=s[5],f.defined(a)||(a=s[5]=new m.Cartesian4),a.x=-t.x,a.y=-t.y,a.z=-t.z,a.w=-r.Cartesian3.dot(r.Cartesian3.negate(t,j),h),this._cullingVolume},V.prototype.getPixelDimensions=function(e,t,n,s,l){J(this);const p=s*(this.right-this.left)/e,c=s*(this.top-this.bottom)/t;return l.x=p,l.y=c,l},V.prototype.clone=function(e){return f.defined(e)||(e=new V),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},V.prototype.equals=function(e){return f.defined(e)&&e instanceof V&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},V.prototype.equalsEpsilon=function(e,t,n){return e===this||f.defined(e)&&e instanceof V&&b.CesiumMath.equalsEpsilon(this.right,e.right,t,n)&&b.CesiumMath.equalsEpsilon(this.left,e.left,t,n)&&b.CesiumMath.equalsEpsilon(this.top,e.top,t,n)&&b.CesiumMath.equalsEpsilon(this.bottom,e.bottom,t,n)&&b.CesiumMath.equalsEpsilon(this.near,e.near,t,n)&&b.CesiumMath.equalsEpsilon(this.far,e.far,t,n)},g.packedLength=4,g.pack=function(e,t,n){return n=f.defaultValue(n,0),t[n++]=e.width,t[n++]=e.aspectRatio,t[n++]=e.near,t[n]=e.far,t},g.unpack=function(e,t,n){return t=f.defaultValue(t,0),f.defined(n)||(n=new g),n.width=e[t++],n.aspectRatio=e[t++],n.near=e[t++],n.far=e[t],n},Object.defineProperties(g.prototype,{projectionMatrix:{get:function(){return A(this),this._offCenterFrustum.projectionMatrix}}}),g.prototype.computeCullingVolume=function(e,t,n){return A(this),this._offCenterFrustum.computeCullingVolume(e,t,n)},g.prototype.getPixelDimensions=function(e,t,n,s,l){return A(this),this._offCenterFrustum.getPixelDimensions(e,t,n,s,l)},g.prototype.clone=function(e){return f.defined(e)||(e=new g),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},g.prototype.equals=function(e){return!!(f.defined(e)&&e instanceof g)&&(A(this),A(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},g.prototype.equalsEpsilon=function(e,t,n){return!!(f.defined(e)&&e instanceof g)&&(A(this),A(e),b.CesiumMath.equalsEpsilon(this.width,e.width,t,n)&&b.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,n)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,n))},Object.defineProperties(E.prototype,{projectionMatrix:{get:function(){return U(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return U(this),this._infinitePerspective}}});const ae=new r.Cartesian3,re=new r.Cartesian3,oe=new r.Cartesian3,se=new r.Cartesian3;function w(e){e=f.defaultValue(e,f.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new E,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=f.defaultValue(e.near,1),this._near=this.near,this.far=f.defaultValue(e.far,5e8),this._far=this.far,this.xOffset=f.defaultValue(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=f.defaultValue(e.yOffset,0),this._yOffset=this.yOffset,this.adaptFov=!0}function O(e){const t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.adaptFov&&e.aspectRatio>1?2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio):e.fov,e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}E.prototype.computeCullingVolume=function(e,t,n){const s=this._cullingVolume.planes,l=this.top,p=this.bottom,c=this.right,_=this.left,i=this.near,o=this.far,d=r.Cartesian3.cross(t,n,ae),y=re;r.Cartesian3.multiplyByScalar(t,i,y),r.Cartesian3.add(e,y,y);const h=oe;r.Cartesian3.multiplyByScalar(t,o,h),r.Cartesian3.add(e,h,h);const a=se;r.Cartesian3.multiplyByScalar(d,_,a),r.Cartesian3.add(y,a,a),r.Cartesian3.subtract(a,e,a),r.Cartesian3.normalize(a,a),r.Cartesian3.cross(a,n,a),r.Cartesian3.normalize(a,a);let u=s[0];return f.defined(u)||(u=s[0]=new m.Cartesian4),u.x=a.x,u.y=a.y,u.z=a.z,u.w=-r.Cartesian3.dot(a,e),r.Cartesian3.multiplyByScalar(d,c,a),r.Cartesian3.add(y,a,a),r.Cartesian3.subtract(a,e,a),r.Cartesian3.cross(n,a,a),r.Cartesian3.normalize(a,a),u=s[1],f.defined(u)||(u=s[1]=new m.Cartesian4),u.x=a.x,u.y=a.y,u.z=a.z,u.w=-r.Cartesian3.dot(a,e),r.Cartesian3.multiplyByScalar(n,p,a),r.Cartesian3.add(y,a,a),r.Cartesian3.subtract(a,e,a),r.Cartesian3.cross(d,a,a),r.Cartesian3.normalize(a,a),u=s[2],f.defined(u)||(u=s[2]=new m.Cartesian4),u.x=a.x,u.y=a.y,u.z=a.z,u.w=-r.Cartesian3.dot(a,e),r.Cartesian3.multiplyByScalar(n,l,a),r.Cartesian3.add(y,a,a),r.Cartesian3.subtract(a,e,a),r.Cartesian3.cross(a,d,a),r.Cartesian3.normalize(a,a),u=s[3],f.defined(u)||(u=s[3]=new m.Cartesian4),u.x=a.x,u.y=a.y,u.z=a.z,u.w=-r.Cartesian3.dot(a,e),u=s[4],f.defined(u)||(u=s[4]=new m.Cartesian4),u.x=t.x,u.y=t.y,u.z=t.z,u.w=-r.Cartesian3.dot(t,y),r.Cartesian3.negate(t,a),u=s[5],f.defined(u)||(u=s[5]=new m.Cartesian4),u.x=a.x,u.y=a.y,u.z=a.z,u.w=-r.Cartesian3.dot(a,h),this._cullingVolume},E.prototype.getPixelDimensions=function(e,t,n,s,l){U(this);const p=1/this.near;let c=this.top*p;const _=2*s*n*c/t;c=this.right*p;const i=2*s*n*c/e;return l.x=i,l.y=_,l},E.prototype.clone=function(e){return f.defined(e)||(e=new E),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},E.prototype.equals=function(e){return f.defined(e)&&e instanceof E&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},E.prototype.equalsEpsilon=function(e,t,n){return e===this||f.defined(e)&&e instanceof E&&b.CesiumMath.equalsEpsilon(this.right,e.right,t,n)&&b.CesiumMath.equalsEpsilon(this.left,e.left,t,n)&&b.CesiumMath.equalsEpsilon(this.top,e.top,t,n)&&b.CesiumMath.equalsEpsilon(this.bottom,e.bottom,t,n)&&b.CesiumMath.equalsEpsilon(this.near,e.near,t,n)&&b.CesiumMath.equalsEpsilon(this.far,e.far,t,n)},w.packedLength=7,w.pack=function(e,t,n){return n=f.defaultValue(n,0),t[n++]=e.fov,t[n++]=e.aspectRatio,t[n++]=e.near,t[n++]=e.far,t[n++]=e.xOffset,t[n++]=e.yOffset,t[n]=e.adaptFov,t},w.unpack=function(e,t,n){return t=f.defaultValue(t,0),f.defined(n)||(n=new w),n.fov=e[t++],n.aspectRatio=e[t++],n.near=e[t++],n.far=e[t++],n.xOffset=e[t++],n.yOffset=e[t++],n.adaptFov=e[t],n},Object.defineProperties(w.prototype,{projectionMatrix:{get:function(){return O(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return O(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return O(this),this._fovy}},sseDenominator:{get:function(){return O(this),this._sseDenominator}}}),w.prototype.computeCullingVolume=function(e,t,n){return O(this),this._offCenterFrustum.computeCullingVolume(e,t,n)},w.prototype.getPixelDimensions=function(e,t,n,s,l){return O(this),this._offCenterFrustum.getPixelDimensions(e,t,n,s,l)},w.prototype.clone=function(e){return f.defined(e)||(e=new w),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e.adaptFov=this.adaptFov,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},w.prototype.equals=function(e){return!!(f.defined(e)&&e instanceof w)&&(O(this),O(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},w.prototype.equalsEpsilon=function(e,t,n){return!!(f.defined(e)&&e instanceof w)&&(O(this),O(e),b.CesiumMath.equalsEpsilon(this.fov,e.fov,t,n)&&b.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,n)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,n))};function D(e){const t=e.frustum,n=e.orientation,s=e.origin,l=f.defaultValue(e.vertexFormat,R.VertexFormat.DEFAULT),p=f.defaultValue(e._drawNearPlane,!0);let c,_;t instanceof w?(c=0,_=w.packedLength):t instanceof g&&(c=1,_=g.packedLength),this._frustumType=c,this._frustum=t.clone(),this._origin=r.Cartesian3.clone(s),this._orientation=v.Quaternion.clone(n),this._drawNearPlane=p,this._vertexFormat=l,this._workerName="createFrustumGeometry",this.packedLength=2+_+r.Cartesian3.packedLength+v.Quaternion.packedLength+R.VertexFormat.packedLength}D.pack=function(e,t,n){n=f.defaultValue(n,0);const s=e._frustumType,l=e._frustum;return t[n++]=s,s===0?(w.pack(l,t,n),n+=w.packedLength):(g.pack(l,t,n),n+=g.packedLength),r.Cartesian3.pack(e._origin,t,n),n+=r.Cartesian3.packedLength,v.Quaternion.pack(e._orientation,t,n),n+=v.Quaternion.packedLength,R.VertexFormat.pack(e._vertexFormat,t,n),t[n+=R.VertexFormat.packedLength]=e._drawNearPlane?1:0,t};const fe=new w,ue=new g,le=new v.Quaternion,ce=new r.Cartesian3,he=new R.VertexFormat;function I(e,t,n,s,l,p,c,_){const i=e/3*2;for(let o=0;o<4;++o)f.defined(t)&&(t[e]=p.x,t[e+1]=p.y,t[e+2]=p.z),f.defined(n)&&(n[e]=c.x,n[e+1]=c.y,n[e+2]=c.z),f.defined(s)&&(s[e]=_.x,s[e+1]=_.y,s[e+2]=_.z),e+=3;l[i]=0,l[i+1]=0,l[i+2]=1,l[i+3]=0,l[i+4]=1,l[i+5]=1,l[i+6]=0,l[i+7]=1}D.unpack=function(e,t,n){t=f.defaultValue(t,0);const s=e[t++];let l;s===0?(l=w.unpack(e,t,fe),t+=w.packedLength):(l=g.unpack(e,t,ue),t+=g.packedLength);const p=r.Cartesian3.unpack(e,t,ce);t+=r.Cartesian3.packedLength;const c=v.Quaternion.unpack(e,t,le);t+=v.Quaternion.packedLength;const _=R.VertexFormat.unpack(e,t,he),i=e[t+=R.VertexFormat.packedLength]===1;if(!f.defined(n))return new D({frustum:l,origin:p,orientation:c,vertexFormat:_,_drawNearPlane:i});const o=s===n._frustumType?n._frustum:void 0;return n._frustum=l.clone(o),n._frustumType=s,n._origin=r.Cartesian3.clone(p,n._origin),n._orientation=v.Quaternion.clone(c,n._orientation),n._vertexFormat=R.VertexFormat.clone(_,n._vertexFormat),n._drawNearPlane=i,n};const pe=new r.Matrix3,de=new m.Matrix4,Q=new m.Matrix4,W=new r.Cartesian3,X=new r.Cartesian3,Z=new r.Cartesian3,me=new r.Cartesian3,Ce=new r.Cartesian3,_e=new r.Cartesian3,T=new Array(3),L=new Array(4);L[0]=new m.Cartesian4(-1,-1,1,1),L[1]=new m.Cartesian4(1,-1,1,1),L[2]=new m.Cartesian4(1,1,1,1),L[3]=new m.Cartesian4(-1,1,1,1);const H=new Array(4);for(let e=0;e<4;++e)H[e]=new m.Cartesian4;D._computeNearFarPlanes=function(e,t,n,s,l,p,c,_){const i=r.Matrix3.fromQuaternion(t,pe);let o=f.defaultValue(p,W),d=f.defaultValue(c,X),y=f.defaultValue(_,Z);o=r.Matrix3.getColumn(i,0,o),d=r.Matrix3.getColumn(i,1,d),y=r.Matrix3.getColumn(i,2,y),r.Cartesian3.normalize(o,o),r.Cartesian3.normalize(d,d),r.Cartesian3.normalize(y,y),r.Cartesian3.negate(o,o);const h=m.Matrix4.computeView(e,y,d,o,de);let a,u;if(n===0){const x=s.projectionMatrix,F=m.Matrix4.multiply(x,h,Q);u=m.Matrix4.inverse(F,Q)}else a=m.Matrix4.inverseTransformation(h,Q);f.defined(u)?(T[0]=s.near,T[1]=s.far):(T[0]=0,T[1]=s.near,T[2]=s.far);for(let x=0;x<2;++x)for(let F=0;F<4;++F){let C=m.Cartesian4.clone(L[F],H[F]);if(f.defined(u)){C=m.Matrix4.multiplyByVector(u,C,C);const P=1/C.w;r.Cartesian3.multiplyByScalar(C,P,C),r.Cartesian3.subtract(C,e,C),r.Cartesian3.normalize(C,C);const z=r.Cartesian3.dot(y,C);r.Cartesian3.multiplyByScalar(C,T[x]/z,C),r.Cartesian3.add(C,e,C)}else{f.defined(s._offCenterFrustum)&&(s=s._offCenterFrustum);const P=T[x],z=T[x+1];C.x=.5*(C.x*(s.right-s.left)+s.left+s.right),C.y=.5*(C.y*(s.top-s.bottom)+s.bottom+s.top),C.z=.5*(C.z*(P-z)-P-z),C.w=1,m.Matrix4.multiplyByVector(a,C,C)}l[12*x+3*F]=C.x,l[12*x+3*F+1]=C.y,l[12*x+3*F+2]=C.z}},D.createGeometry=function(e){const t=e._frustumType,n=e._frustum,s=e._origin,l=e._orientation,p=e._drawNearPlane,c=e._vertexFormat,_=p?6:5;let i=new Float64Array(72);D._computeNearFarPlanes(s,l,t,n,i);let o=24;i[o]=i[12],i[o+1]=i[13],i[o+2]=i[14],i[o+3]=i[0],i[o+4]=i[1],i[o+5]=i[2],i[o+6]=i[9],i[o+7]=i[10],i[o+8]=i[11],i[o+9]=i[21],i[o+10]=i[22],i[o+11]=i[23],o+=12,i[o]=i[15],i[o+1]=i[16],i[o+2]=i[17],i[o+3]=i[3],i[o+4]=i[4],i[o+5]=i[5],i[o+6]=i[0],i[o+7]=i[1],i[o+8]=i[2],i[o+9]=i[12],i[o+10]=i[13],i[o+11]=i[14],o+=12,i[o]=i[3],i[o+1]=i[4],i[o+2]=i[5],i[o+3]=i[15],i[o+4]=i[16],i[o+5]=i[17],i[o+6]=i[18],i[o+7]=i[19],i[o+8]=i[20],i[o+9]=i[6],i[o+10]=i[7],i[o+11]=i[8],o+=12,i[o]=i[6],i[o+1]=i[7],i[o+2]=i[8],i[o+3]=i[18],i[o+4]=i[19],i[o+5]=i[20],i[o+6]=i[21],i[o+7]=i[22],i[o+8]=i[23],i[o+9]=i[9],i[o+10]=i[10],i[o+11]=i[11],p||(i=i.subarray(12));const d=new $.GeometryAttributes({position:new k.GeometryAttribute({componentDatatype:q.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:i})});if(f.defined(c.normal)||f.defined(c.tangent)||f.defined(c.bitangent)||f.defined(c.st)){const h=f.defined(c.normal)?new Float32Array(12*_):void 0,a=f.defined(c.tangent)?new Float32Array(12*_):void 0,u=f.defined(c.bitangent)?new Float32Array(12*_):void 0,x=f.defined(c.st)?new Float32Array(8*_):void 0,F=W,C=X,P=Z,z=r.Cartesian3.negate(F,me),ye=r.Cartesian3.negate(C,Ce),K=r.Cartesian3.negate(P,_e);o=0,p&&(I(o,h,a,u,x,K,F,C),o+=12),I(o,h,a,u,x,P,z,C),o+=12,I(o,h,a,u,x,z,K,C),o+=12,I(o,h,a,u,x,ye,K,z),o+=12,I(o,h,a,u,x,F,P,C),o+=12,I(o,h,a,u,x,C,P,z),f.defined(h)&&(d.normal=new k.GeometryAttribute({componentDatatype:q.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:h})),f.defined(a)&&(d.tangent=new k.GeometryAttribute({componentDatatype:q.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:a})),f.defined(u)&&(d.bitangent=new k.GeometryAttribute({componentDatatype:q.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:u})),f.defined(x)&&(d.st=new k.GeometryAttribute({componentDatatype:q.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:x}))}const y=new Uint16Array(6*_);for(let h=0;h<_;++h){const a=6*h,u=4*h;y[a]=u,y[a+1]=u+1,y[a+2]=u+2,y[a+3]=u,y[a+4]=u+2,y[a+5]=u+3}return new k.Geometry({attributes:d,indices:y,primitiveType:k.PrimitiveType.TRIANGLES,boundingSphere:v.BoundingSphere.fromVertices(i)})},N.FrustumGeometry=D,N.OrthographicFrustum=g,N.PerspectiveFrustum=w});
